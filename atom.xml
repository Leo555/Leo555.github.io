<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>lizhen&#39;s blog</title>
  <icon>https://www.gravatar.com/avatar/fad0a72a117d3a0a737be35e0a93c727</icon>
  <subtitle>äººç”Ÿè‹¦çŸ­ï¼Œæˆ‘å†ç¡ä¼š</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://lz5z.com/"/>
  <updated>2020-04-21T10:23:54.831Z</updated>
  <id>https://lz5z.com/</id>
  
  <author>
    <name>lizhen</name>
    <email>lizhen55521@gmail.com</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>[çœŸ] Nodeå¤šçº¿ç¨‹</title>
    <link href="https://lz5z.com/%E7%9C%9F-Node%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    <id>https://lz5z.com/çœŸ-Nodeå¤šçº¿ç¨‹/</id>
    <published>2019-01-31T19:52:19.000Z</published>
    <updated>2020-04-21T10:23:54.831Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æœ¬æ–‡æµ‹è¯•ä½¿ç”¨ç¯å¢ƒï¼š<br>ç³»ç»Ÿï¼šmacOS Mojave 10.14.2<br>CPUï¼š4 æ ¸ 2.3 GHz<br>Node: 10.15.1</p></blockquote><h2>ä» Node çº¿ç¨‹è¯´èµ·</h2><p>ä¸€èˆ¬äººç†è§£ Node æ˜¯å•çº¿ç¨‹çš„ï¼Œæ‰€ä»¥ Node å¯åŠ¨åçº¿ç¨‹æ•°åº”è¯¥ä¸º 1ï¼Œæˆ‘ä»¬åšå®éªŒçœ‹ä¸€ä¸‹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">new</span> <span class="built_in">Date</span>().getTime())</span><br><span class="line">&#125;, <span class="number">3000</span>)</span><br></pre></td></tr></table></figure><img src="/assets/img/node_thread.png" alt="node_thread" style="max-width: 650px"><p>å¯ä»¥çœ‹åˆ° Node è¿›ç¨‹å ç”¨äº† 7 ä¸ªçº¿ç¨‹ã€‚ä¸ºä»€ä¹ˆä¼šæœ‰ 7 ä¸ªçº¿ç¨‹å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼ŒNode ä¸­æœ€æ ¸å¿ƒçš„æ˜¯ v8 å¼•æ“ï¼Œåœ¨ Node å¯åŠ¨åï¼Œä¼šåˆ›å»º v8 çš„å®ä¾‹ï¼Œè¿™ä¸ªå®ä¾‹æ˜¯å¤šçº¿ç¨‹çš„ã€‚</p><ul><li>ä¸»çº¿ç¨‹ï¼šç¼–è¯‘ã€æ‰§è¡Œä»£ç ã€‚</li><li>ç¼–è¯‘/ä¼˜åŒ–çº¿ç¨‹ï¼šåœ¨ä¸»çº¿ç¨‹æ‰§è¡Œçš„æ—¶å€™ï¼Œå¯ä»¥ä¼˜åŒ–ä»£ç ã€‚</li><li>åˆ†æå™¨çº¿ç¨‹ï¼šè®°å½•åˆ†æä»£ç è¿è¡Œæ—¶é—´ï¼Œä¸º Crankshaft ä¼˜åŒ–ä»£ç æ‰§è¡Œæä¾›ä¾æ®ã€‚</li><li>åƒåœ¾å›æ”¶çš„å‡ ä¸ªçº¿ç¨‹ã€‚</li></ul><a id="more"></a><p>æ‰€ä»¥å¤§å®¶å¸¸è¯´çš„ Node æ˜¯å•çº¿ç¨‹çš„æŒ‡çš„æ˜¯ JavaScript çš„æ‰§è¡Œæ˜¯å•çº¿ç¨‹çš„ï¼Œä½† Javascript çš„å®¿ä¸»ç¯å¢ƒï¼Œæ— è®ºæ˜¯ Node è¿˜æ˜¯æµè§ˆå™¨éƒ½æ˜¯å¤šçº¿ç¨‹çš„ã€‚</p><blockquote><p>Node æœ‰ä¸¤ä¸ªç¼–è¯‘å™¨ï¼š<br>full-codegenï¼šç®€å•å¿«é€Ÿåœ°å°† js ç¼–è¯‘æˆç®€å•ä½†æ˜¯å¾ˆæ…¢çš„æœºæ¢°ç ã€‚<br>Crankshaftï¼šæ¯”è¾ƒå¤æ‚çš„å®æ—¶ä¼˜åŒ–ç¼–è¯‘å™¨ï¼Œç¼–è¯‘é«˜æ€§èƒ½çš„å¯æ‰§è¡Œä»£ç ã€‚</p></blockquote><h3>æŸäº›å¼‚æ­¥ IO ä¼šå ç”¨é¢å¤–çš„çº¿ç¨‹</h3><p>è¿˜æ˜¯ä¸Šé¢é‚£ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬åœ¨å®šæ—¶å™¨æ‰§è¡Œçš„åŒæ—¶ï¼Œå»è¯»ä¸€ä¸ªæ–‡ä»¶ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line">setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">new</span> <span class="built_in">Date</span>().getTime())</span><br><span class="line">&#125;, <span class="number">3000</span>)</span><br><span class="line"></span><br><span class="line">fs.readFile(<span class="string">'./index.html'</span>, () =&gt; &#123;&#125;)</span><br></pre></td></tr></table></figure><img src="/assets/img/node_thread_1.png" alt="node_thread" style="max-width: 650px"><p>çº¿ç¨‹æ•°é‡å˜æˆäº† 11 ä¸ªï¼Œè¿™æ˜¯å› ä¸ºåœ¨ Node ä¸­æœ‰ä¸€äº› IO æ“ä½œï¼ˆDNSï¼ŒFSï¼‰å’Œä¸€äº› CPU å¯†é›†è®¡ç®—ï¼ˆZlibï¼ŒCryptoï¼‰ä¼šå¯ç”¨ Node çš„çº¿ç¨‹æ± ï¼Œè€Œçº¿ç¨‹æ± é»˜è®¤å¤§å°ä¸º 4ï¼Œå› ä¸ºçº¿ç¨‹æ•°å˜æˆäº† 11ã€‚</p><p>æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨æ›´æ”¹çº¿ç¨‹æ± é»˜è®¤å¤§å°ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">process.env.UV_THREADPOOL_SIZE = <span class="number">64</span></span><br></pre></td></tr></table></figure><p>ä¸€è¡Œä»£ç è½»æ¾æŠŠçº¿ç¨‹å˜æˆ 71 ğŸ˜Š</p><img src="/assets/img/node_thread_2.png" alt="node_thread" style="max-width: 850px"><h2>cluster æ˜¯å¤šçº¿ç¨‹å—ï¼Ÿ</h2><p>Node çš„å•çº¿ç¨‹ä¹Ÿå¸¦æ¥äº†ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚å¯¹ cpu åˆ©ç”¨ä¸è¶³ï¼ŒæŸä¸ªæœªæ•è·çš„å¼‚å¸¸å¯èƒ½ä¼šå¯¼è‡´æ•´ä¸ªç¨‹åºçš„é€€å‡ºç­‰ç­‰ã€‚å› ä¸º Node ä¸­æä¾›äº† cluster æ¨¡å—ï¼Œcluster å®ç°äº†å¯¹ child_process çš„å°è£…ï¼Œé€šè¿‡ fork æ–¹æ³•åˆ›å»ºå­è¿›ç¨‹çš„æ–¹å¼å®ç°äº†å¤šè¿›ç¨‹æ¨¡å‹ã€‚æ¯”å¦‚æˆ‘ä»¬æœ€å¸¸ç”¨åˆ°çš„ pm2 å°±æ˜¯å…¶ä¸­æœ€ä¼˜ç§€çš„ä»£è¡¨ã€‚</p><p>æˆ‘ä»¬çœ‹ä¸€ä¸ª cluster çš„ demoï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> cluster = <span class="built_in">require</span>(<span class="string">'cluster'</span>);</span><br><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"><span class="keyword">const</span> numCPUs = <span class="built_in">require</span>(<span class="string">'os'</span>).cpus().length;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (cluster.isMaster) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`ä¸»è¿›ç¨‹ <span class="subst">$&#123;process.pid&#125;</span> æ­£åœ¨è¿è¡Œ`</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; numCPUs; i++) &#123;</span><br><span class="line">    cluster.fork();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  cluster.on(<span class="string">'exit'</span>, (worker, code, signal) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`å·¥ä½œè¿›ç¨‹ <span class="subst">$&#123;worker.process.pid&#125;</span> å·²é€€å‡º`</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;  </span><br><span class="line">  <span class="comment">// å·¥ä½œè¿›ç¨‹å¯ä»¥å…±äº«ä»»ä½• TCP è¿æ¥ã€‚</span></span><br><span class="line">  <span class="comment">// åœ¨æœ¬ä¾‹å­ä¸­ï¼Œå…±äº«çš„æ˜¯ HTTP æœåŠ¡å™¨ã€‚</span></span><br><span class="line">  http.createServer(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.writeHead(<span class="number">200</span>);</span><br><span class="line">    res.end(<span class="string">'Hello World'</span>);</span><br><span class="line">  &#125;).listen(<span class="number">8000</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`å·¥ä½œè¿›ç¨‹ <span class="subst">$&#123;process.pid&#125;</span> å·²å¯åŠ¨`</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ—¶å€™çœ‹ä¸‹æ´»åŠ¨ç›‘è§†å™¨ï¼š</p><img src="/assets/img/node_thread_3.png" alt="node_thread" style="max-width: 600px"><p>ä¸€å…±æœ‰ 9 ä¸ªè¿›ç¨‹ï¼Œå…¶ä¸­ä¸€ä¸ªä¸»è¿›ç¨‹ï¼Œcpu ä¸ªæ•° * cpu æ ¸æ•° = 2 * 4 = 8 ä¸ª å­è¿›ç¨‹ã€‚</p><p>æ‰€ä»¥æ— è®º child_process è¿˜æ˜¯ clusterï¼Œéƒ½ä¸æ˜¯å¤šçº¿ç¨‹æ¨¡å‹ï¼Œè€Œæ˜¯å¤šè¿›ç¨‹æ¨¡å‹ã€‚è™½ç„¶å¼€å‘è€…æ„è¯†åˆ°äº†å•çº¿ç¨‹æ¨¡å‹çš„é—®é¢˜ï¼Œä½†æ˜¯æ²¡æœ‰ä»æ ¹æœ¬ä¸Šè§£å†³é—®é¢˜ï¼Œè€Œä¸”æä¾›äº†ä¸€ä¸ªå¤šè¿›ç¨‹çš„æ–¹å¼æ¥æ¨¡æ‹Ÿå¤šçº¿ç¨‹ã€‚ä»å‰é¢çš„å®éªŒå¯ä»¥çœ‹å‡ºï¼Œè™½ç„¶ Node ï¼ˆV8ï¼‰æœ¬èº«æ˜¯å…·æœ‰å¤šçº¿ç¨‹çš„èƒ½åŠ›çš„ï¼Œä½†æ˜¯å¼€å‘è€…å¹¶ä¸èƒ½å¾ˆå¥½çš„åˆ©ç”¨è¿™ä¸ªèƒ½åŠ›ï¼Œæ›´å¤šçš„æ˜¯ç”± Node åº•å±‚æä¾›çš„ä¸€äº›æ–¹å¼æ¥ä½¿ç”¨å¤šçº¿ç¨‹ã€‚Node å®˜æ–¹è¯´ï¼š</p><blockquote><p>You can use the built-in Node Worker Pool by developing a C++ addon. On older versions of Node, build your C++ addon using NAN, and on newer versions use N-API. node-webworker-threads offers a JavaScript-only way to access Nodeâ€™s Worker Pool.</p></blockquote><p>ä½†æ˜¯å¯¹äº JavaScript å¼€å‘è€…ï¼Œä¸€ç›´æ²¡æœ‰ä¸€ä¸ªæ ‡å‡†çš„ã€å¥½ç”¨çš„æ–¹å¼æ¥ä½¿ç”¨ Node çš„å¤šçº¿ç¨‹èƒ½åŠ›ã€‚</p><h2>çœŸ - Node å¤šçº¿ç¨‹</h2><p>ç›´åˆ° Node 10.5.0 çš„å‘å¸ƒï¼Œå®˜æ–¹æ‰ç»™å‡ºäº†ä¸€ä¸ªå®éªŒæ€§è´¨çš„æ¨¡å— <a href="http://nodejs.cn/api/worker_threads.html" target="_blank" rel="noopener">worker_threads</a> ç»™ Node æä¾›çœŸæ­£çš„å¤šçº¿ç¨‹èƒ½åŠ›ã€‚</p><p>å…ˆçœ‹ä¸‹ç®€å•çš„ demoï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;</span><br><span class="line">  isMainThread,</span><br><span class="line">  parentPort,</span><br><span class="line">  workerData,</span><br><span class="line">  threadId,</span><br><span class="line">  MessageChannel,</span><br><span class="line">  MessagePort,</span><br><span class="line">  Worker</span><br><span class="line">&#125; = <span class="built_in">require</span>(<span class="string">'worker_threads'</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mainThread</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">const</span> worker = <span class="keyword">new</span> Worker(__filename, &#123; <span class="attr">workerData</span>: i &#125;);</span><br><span class="line">    worker.on(<span class="string">'exit'</span>, code =&gt; &#123; <span class="built_in">console</span>.log(<span class="string">`main: worker stopped with exit code <span class="subst">$&#123;code&#125;</span>`</span>); &#125;);</span><br><span class="line">    worker.on(<span class="string">'message'</span>, msg =&gt; &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">`main: receive <span class="subst">$&#123;msg&#125;</span>`</span>);</span><br><span class="line">      worker.postMessage(msg + <span class="number">1</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">workerThread</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`worker: workerDate <span class="subst">$&#123;workerData&#125;</span>`</span>);</span><br><span class="line">  parentPort.on(<span class="string">'message'</span>, msg =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`worker: receive <span class="subst">$&#123;msg&#125;</span>`</span>);</span><br><span class="line">  &#125;),</span><br><span class="line">  parentPort.postMessage(workerData);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (isMainThread) &#123;</span><br><span class="line">  mainThread();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  workerThread();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç åœ¨ä¸»çº¿ç¨‹ä¸­å¼€å¯äº”ä¸ªå­çº¿ç¨‹ï¼Œå¹¶ä¸”ä¸»çº¿ç¨‹å‘å­çº¿ç¨‹å‘é€ç®€å•çš„æ¶ˆæ¯ã€‚</p><p>ç”±äº worker_thread ç›®å‰ä»ç„¶å¤„äºå®éªŒé˜¶æ®µï¼Œæ‰€ä»¥å¯åŠ¨æ—¶éœ€è¦å¢åŠ  <code>--experimental-worker</code> flagï¼Œè¿è¡Œåè§‚å¯Ÿæ´»åŠ¨ç›‘è§†å™¨ï¼š</p><img src="/assets/img/node_thread_4.png" alt="node_thread" style="max-width: 600px"><p>ä¸å¤šä¸å°‘ï¼Œæ­£å¥½å¤šäº†äº”ä¸ªå­çº¿ç¨‹ã€‚ğŸ˜Š</p><h3><a href="https://nodejs.org/api/worker_threads.html" target="_blank" rel="noopener">worker_thread</a> æ¨¡å—</h3><p>worker_thread <a href="https://github.com/nodejs/node/blob/master/lib/worker_threads.js" target="_blank" rel="noopener">æ ¸å¿ƒä»£ç </a></p><p>worker_thread æ¨¡å—ä¸­æœ‰ 4 ä¸ªå¯¹è±¡å’Œ 2 ä¸ªç±»ã€‚</p><ul><li>isMainThread: æ˜¯å¦æ˜¯ä¸»çº¿ç¨‹ï¼Œæºç ä¸­æ˜¯é€šè¿‡ <code>threadId === 0</code> è¿›è¡Œåˆ¤æ–­çš„ã€‚</li><li>MessagePort: ç”¨äºçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼Œç»§æ‰¿è‡ª EventEmitterã€‚</li><li>MessageChannel: ç”¨äºåˆ›å»ºå¼‚æ­¥ã€åŒå‘é€šä¿¡çš„é€šé“å®ä¾‹ã€‚</li><li>threadId: çº¿ç¨‹ IDã€‚</li><li>Worker: ç”¨äºåœ¨ä¸»çº¿ç¨‹ä¸­åˆ›å»ºå­çº¿ç¨‹ã€‚ç¬¬ä¸€ä¸ªå‚æ•°ä¸º filenameï¼Œè¡¨ç¤ºå­çº¿ç¨‹æ‰§è¡Œçš„å…¥å£ã€‚</li><li>parentPort: åœ¨ worker çº¿ç¨‹é‡Œæ˜¯è¡¨ç¤ºçˆ¶è¿›ç¨‹çš„ MessagePort ç±»å‹çš„å¯¹è±¡ï¼Œåœ¨ä¸»çº¿ç¨‹é‡Œä¸º null</li><li>workerData: ç”¨äºåœ¨ä¸»è¿›ç¨‹ä¸­å‘å­è¿›ç¨‹ä¼ é€’æ•°æ®ï¼ˆdata å‰¯æœ¬ï¼‰</li></ul><p>æ¥çœ‹ä¸€ä¸ªè¿›ç¨‹é€šä¿¡çš„ä¾‹å­ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> assert = <span class="built_in">require</span>(<span class="string">'assert'</span>);</span><br><span class="line"><span class="keyword">const</span> &#123;</span><br><span class="line">  Worker,</span><br><span class="line">  MessageChannel,</span><br><span class="line">  MessagePort,</span><br><span class="line">  isMainThread,</span><br><span class="line">  parentPort</span><br><span class="line">&#125; = <span class="built_in">require</span>(<span class="string">'worker_threads'</span>);</span><br><span class="line"><span class="keyword">if</span> (isMainThread) &#123;</span><br><span class="line">  <span class="keyword">const</span> worker = <span class="keyword">new</span> Worker(__filename);</span><br><span class="line">  <span class="keyword">const</span> subChannel = <span class="keyword">new</span> MessageChannel();</span><br><span class="line">  worker.postMessage(&#123; <span class="attr">hereIsYourPort</span>: subChannel.port1 &#125;, [subChannel.port1]);</span><br><span class="line">  subChannel.port2.on(<span class="string">'message'</span>, (value) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'received:'</span>, value);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  parentPort.once(<span class="string">'message'</span>, (value) =&gt; &#123;</span><br><span class="line">    assert(value.hereIsYourPort <span class="keyword">instanceof</span> MessagePort);</span><br><span class="line">    value.hereIsYourPort.postMessage(<span class="string">'the worker is sending this'</span>);</span><br><span class="line">    value.hereIsYourPort.close();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ›´å¤šè¯¦ç»†ç”¨æ³•å¯ä»¥æŸ¥çœ‹<a href="https://nodejs.org/api/worker_threads.html" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p><h3>å¤šè¿›ç¨‹ vs å¤šçº¿ç¨‹</h3><p>æ ¹æ®å¤§å­¦è¯¾æœ¬ä¸Šçš„è¯´æ³•ï¼šâ€œè¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„æœ€å°å•ä½ï¼Œçº¿ç¨‹æ˜¯CPUè°ƒåº¦çš„æœ€å°å•ä½â€ï¼Œè¿™å¥è¯åº”ä»˜è€ƒè¯•å°±å¤Ÿäº†ï¼Œä½†æ˜¯åœ¨å®é™…å·¥ä½œä¸­ï¼Œæˆ‘ä»¬è¿˜æ˜¯è¦æ ¹æ®éœ€æ±‚åˆç†é€‰æ‹©ã€‚</p><p>ä¸‹é¢å¯¹æ¯”ä¸€ä¸‹å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ï¼š</p><table><thead><tr><th style="text-align:left">å±æ€§</th><th style="text-align:center">å¤šè¿›ç¨‹</th><th style="text-align:center">å¤šçº¿ç¨‹</th><th style="text-align:left">æ¯”è¾ƒ</th></tr></thead><tbody><tr><td style="text-align:left">æ•°æ®</td><td style="text-align:center">æ•°æ®å…±äº«å¤æ‚ï¼Œéœ€è¦ç”¨IPCï¼›æ•°æ®æ˜¯åˆ†å¼€çš„ï¼ŒåŒæ­¥ç®€å•</td><td style="text-align:center">å› ä¸ºå…±äº«è¿›ç¨‹æ•°æ®ï¼Œæ•°æ®å…±äº«ç®€å•ï¼ŒåŒæ­¥å¤æ‚</td><td style="text-align:left">å„æœ‰åƒç§‹</td></tr><tr><td style="text-align:left">CPUã€å†…å­˜</td><td style="text-align:center">å ç”¨å†…å­˜å¤šï¼Œåˆ‡æ¢å¤æ‚ï¼ŒCPUåˆ©ç”¨ç‡ä½</td><td style="text-align:center">å ç”¨å†…å­˜å°‘ï¼Œåˆ‡æ¢ç®€å•ï¼ŒCPUåˆ©ç”¨ç‡é«˜</td><td style="text-align:left">å¤šçº¿ç¨‹æ›´å¥½</td></tr><tr><td style="text-align:left">é”€æ¯ã€åˆ‡æ¢</td><td style="text-align:center">åˆ›å»ºé”€æ¯ã€åˆ‡æ¢å¤æ‚ï¼Œé€Ÿåº¦æ…¢</td><td style="text-align:center">åˆ›å»ºé”€æ¯ã€åˆ‡æ¢ç®€å•ï¼Œé€Ÿåº¦å¾ˆå¿«</td><td style="text-align:left">å¤šçº¿ç¨‹æ›´å¥½</td></tr><tr><td style="text-align:left">coding</td><td style="text-align:center">ç¼–ç ç®€å•ã€è°ƒè¯•æ–¹ä¾¿</td><td style="text-align:center">ç¼–ç ã€è°ƒè¯•å¤æ‚</td><td style="text-align:left">å¤šè¿›ç¨‹æ›´å¥½</td></tr><tr><td style="text-align:left">å¯é æ€§</td><td style="text-align:center">è¿›ç¨‹ç‹¬ç«‹è¿è¡Œï¼Œä¸ä¼šç›¸äº’å½±å“</td><td style="text-align:center">çº¿ç¨‹åŒå‘¼å¸å…±å‘½è¿</td><td style="text-align:left">å¤šè¿›ç¨‹æ›´å¥½</td></tr><tr><td style="text-align:left">åˆ†å¸ƒå¼</td><td style="text-align:center">å¯ç”¨äºå¤šæœºå¤šæ ¸åˆ†å¸ƒå¼ï¼Œæ˜“äºæ‰©å±•</td><td style="text-align:center">åªèƒ½ç”¨äºå¤šæ ¸åˆ†å¸ƒå¼</td><td style="text-align:left">å¤šè¿›ç¨‹æ›´å¥½</td></tr></tbody></table><p>ä¸Šè¿°æ¯”è¾ƒä»…è¡¨ç¤ºä¸€èˆ¬æƒ…å†µï¼Œå¹¶ä¸ç»å¯¹ã€‚</p><p>work_thread è®© Node æœ‰äº†çœŸæ­£çš„å¤šçº¿ç¨‹èƒ½åŠ›ï¼Œç®—æ˜¯ä¸å°çš„è¿›æ­¥ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;æœ¬æ–‡æµ‹è¯•ä½¿ç”¨ç¯å¢ƒï¼š&lt;br&gt;
ç³»ç»Ÿï¼šmacOS Mojave 10.14.2&lt;br&gt;
CPUï¼š4 æ ¸ 2.3 GHz&lt;br&gt;
Node: 10.15.1&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;ä» Node çº¿ç¨‹è¯´èµ·&lt;/h2&gt;
&lt;p&gt;ä¸€èˆ¬äººç†è§£ Node æ˜¯å•çº¿ç¨‹çš„ï¼Œæ‰€ä»¥ Node å¯åŠ¨åçº¿ç¨‹æ•°åº”è¯¥ä¸º 1ï¼Œæˆ‘ä»¬åšå®éªŒçœ‹ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;setInterval(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; =&amp;gt;&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Date&lt;/span&gt;().getTime())&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;, &lt;span class=&quot;number&quot;&gt;3000&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img src=&quot;/assets/img/node_thread.png&quot; alt=&quot;node_thread&quot; style=&quot;max-width: 650px&quot;&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ° Node è¿›ç¨‹å ç”¨äº† 7 ä¸ªçº¿ç¨‹ã€‚ä¸ºä»€ä¹ˆä¼šæœ‰ 7 ä¸ªçº¿ç¨‹å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬éƒ½çŸ¥é“ï¼ŒNode ä¸­æœ€æ ¸å¿ƒçš„æ˜¯ v8 å¼•æ“ï¼Œåœ¨ Node å¯åŠ¨åï¼Œä¼šåˆ›å»º v8 çš„å®ä¾‹ï¼Œè¿™ä¸ªå®ä¾‹æ˜¯å¤šçº¿ç¨‹çš„ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸»çº¿ç¨‹ï¼šç¼–è¯‘ã€æ‰§è¡Œä»£ç ã€‚&lt;/li&gt;
&lt;li&gt;ç¼–è¯‘/ä¼˜åŒ–çº¿ç¨‹ï¼šåœ¨ä¸»çº¿ç¨‹æ‰§è¡Œçš„æ—¶å€™ï¼Œå¯ä»¥ä¼˜åŒ–ä»£ç ã€‚&lt;/li&gt;
&lt;li&gt;åˆ†æå™¨çº¿ç¨‹ï¼šè®°å½•åˆ†æä»£ç è¿è¡Œæ—¶é—´ï¼Œä¸º Crankshaft ä¼˜åŒ–ä»£ç æ‰§è¡Œæä¾›ä¾æ®ã€‚&lt;/li&gt;
&lt;li&gt;åƒåœ¾å›æ”¶çš„å‡ ä¸ªçº¿ç¨‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="Node" scheme="https://lz5z.com/categories/Node/"/>
    
    
      <category term="cluster" scheme="https://lz5z.com/tags/cluster/"/>
    
      <category term="worker_threads" scheme="https://lz5z.com/tags/worker-threads/"/>
    
  </entry>
  
  <entry>
    <title>React Hooks æ˜¯ä»€ä¹ˆ</title>
    <link href="https://lz5z.com/React-Hooks/"/>
    <id>https://lz5z.com/React-Hooks/</id>
    <published>2019-01-07T22:34:24.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨é‡æ„ BadJS çš„ç®¡ç†é¡µé¢ï¼Œä½¿ç”¨ TypeScript + React Hooks çš„æŠ€æœ¯æ ˆï¼Œè¶è¿™ä¸ªæœºä¼šå¥½å¥½ç†ä¸€ç† React Hooks é‚£äº›äº‹å„¿ã€‚</p><p>React Hooks æ˜¯ 16.7.0-alpha ç‰ˆæœ¬çš„æ–°ç‰¹æ€§ï¼Œå®‰è£…å³å¯äº«ç”¨ã€‚</p><h2>React Hooks ç®€ä»‹</h2><p>React Hooks æ˜¯å¯¹ React function ç»„ä»¶çš„ä¸€ç§æ‰©å±•ï¼Œé€šè¿‡ä¸€äº›ç‰¹æ®Šçš„å‡½æ•°ï¼Œè®©æ— çŠ¶æ€ç»„ä»¶æ‹¥æœ‰çŠ¶æ€ç»„ä»¶æ‰æ‹¥æœ‰çš„èƒ½åŠ›ã€‚</p><p>Hooks æ˜¯ React å‡½æ•°ç»„ä»¶ä¸­çš„ä¸€ç±»ç‰¹æ®Šå‡½æ•°ï¼Œé€šå¸¸ä»¥ use å¼€å¤´ï¼Œæ¯”å¦‚ useRefï¼ŒuseStateï¼ŒuseReducer ç­‰ã€‚é€šå¸¸åœ¨æˆ‘ä»¬å†™ React ç»„ä»¶çš„æ—¶å€™ï¼Œå¦‚æœè¿™ä¸ªç»„ä»¶æ¯”è¾ƒå¤æ‚ï¼Œæ‹¥æœ‰è‡ªå·±çš„ç”Ÿå‘½å‘¨æœŸæˆ–è€… stateï¼Œå°±å°†å…¶å†™æˆ class ç»„ä»¶ï¼›å¦‚æœè¿™ä¸ªç»„ä»¶ä»…ä»…ç”¨æ¥å±•ç¤ºï¼Œå°±å°†å…¶å†™æˆ function ç»„ä»¶ã€‚</p><p>React Hooks ä½¿ç”¨ function ç»„ä»¶çš„å†™æ³•ï¼Œé€šè¿‡ useState è¿™æ ·çš„ API è§£å†³äº† function ç»„ä»¶æ²¡æœ‰ state çš„é—®é¢˜ï¼Œé€šè¿‡ useEffect æ¥è§£å†³ç”Ÿå‘½å‘¨æœŸçš„é—®é¢˜ï¼Œé€šè¿‡è‡ªå®šä¹‰ hooks æ¥å¤ç”¨ä¸šåŠ¡é€»è¾‘ã€‚</p><h3>Hooks è§£å†³å“ªäº›é—®é¢˜</h3><ul><li>å¤ç”¨ä¸çŠ¶æ€æœ‰å…³çš„é€»è¾‘ï¼Œä¹‹å‰å¼•ç”³å‡ºæ¥ HOC çš„æ¦‚å¿µï¼Œä½†æ˜¯ HOC ä¼šå¯¼è‡´ç»„ä»¶æ ‘çš„è‡ƒè‚¿ã€‚</li><li>è§£å†³ç»„ä»¶éšç€ä¸šåŠ¡æ‰©å±•å˜å¾—éš¾ä»¥ç»´æŠ¤çš„é—®é¢˜ã€‚</li><li>ä½¿ç”¨æ›´å®¹æ˜“ç†è§£å¹¶ä¸”å¯¹åˆå­¦è€…æ›´å‹å¥½çš„ function ç»„ä»¶ã€‚</li></ul><a id="more"></a><h2>ç”¨æ³•</h2><p>Hooks ä¸»è¦åˆ†ä¸‰ç§ï¼š</p><ul><li>State hooks: å…è®¸å¼€å‘è€…åœ¨ function ç»„ä»¶ä¸­ä½¿ç”¨ stateã€‚</li><li>Effect hooks: å…è®¸å¼€å‘è€…åœ¨ function ç»„ä»¶ä¸­ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸå’Œ side effectã€‚</li><li>Custom hooks: è‡ªå®šä¹‰ hooksï¼Œå¯ä»¥åœ¨é‡Œé¢ä½¿ç”¨ State Hooks å’Œ Effect Hooksï¼Œè¾¾åˆ°ç»„ä»¶ä¹‹é—´é€»è¾‘å¤ç”¨ã€‚</li></ul><h3>State Hooks</h3><p>çœ‹ä¸€ä¸‹å®˜æ–¹ç»™å‡ºçš„ demo</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useState &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Example</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = useState(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;p&gt;You clicked &#123;count&#125; times&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">      &lt;button onClick=&#123;() =&gt; setCount(count + 1)&#125;&gt;</span></span><br><span class="line"><span class="regexp">        Click me</span></span><br><span class="line"><span class="regexp">      &lt;/</span>button&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„ useState å°±æ˜¯ä¸€ä¸ª hookï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œç¬¬ä¸€ä¸ª count è¡¨ç¤ºä¸€ä¸ª stateï¼Œé»˜è®¤å€¼ä¸º 0ï¼›ç¬¬äºŒä¸ª setCount ç›¸å½“äº class function ä¸­çš„ setStateï¼Œè¡¨ç¤ºå¯¹ count çš„æ›´æ–°æ“ä½œã€‚</p><p>è¿™æ ·å†™çš„å¥½å¤„æ˜¯æ¯ä¸ª state ç‹¬ç«‹ç®¡ç†ï¼Œé¿å…çŠ¶æ€å¤æ‚çš„æ—¶å€™ state è‡ƒè‚¿ã€‚</p><p>åŸºæœ¬ç”¨æ³•æè¿°å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [state, setState] = useState(initialState);</span><br><span class="line">setState(newState);</span><br></pre></td></tr></table></figure><p>useState è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œç¬¬ä¸€ä¸ªå€¼æ˜¯ä¸€ä¸ª statefulï¼ˆæœ‰çŠ¶æ€ï¼‰çš„å€¼ï¼Œç¬¬äºŒä¸ªå€¼æ˜¯æ›´æ–°è¿™ä¸ªçŠ¶æ€å€¼çš„å‡½æ•°ã€‚åœ¨åˆå§‹æ¸²æŸ“çš„æ—¶å€™ï¼Œè¿”å›çš„ state ä¸ initialState ç›¸åŒï¼Œåœ¨åç»­é‡æ–°æ¸²æŸ“æ—¶ï¼ŒuseState è¿”å›çš„ç¬¬ä¸€ä¸ªå€¼å°†å§‹ç»ˆæ˜¯åº”ç”¨æ›´æ–°åçš„æœ€æ–° state(çŠ¶æ€) ã€‚</p><p>setState å‡½æ•°ç”¨äºæ›´æ–° state(çŠ¶æ€) ï¼Œå®ƒæ¥å—ä¸€ä¸ªæ–°çš„ state(çŠ¶æ€) å€¼ï¼Œå¹¶å°†ç»„ä»¶æ’å…¥é‡æ–°æ¸²æŸ“çš„é˜Ÿåˆ—ã€‚</p><p>ç”±äº setState ä½¿ç”¨å‡½æ•°å¼çš„æ›´æ–°æ–¹å¼ï¼Œæ‰€ä»¥å¯ä»¥ä¼ é€’å‡½æ•°ç»™ setStateï¼Œè¯¥å‡½æ•°å°†æ¥æ”¶å…ˆå‰çš„å€¼ï¼Œå¹¶è¿”å›æ›´æ–°çš„å€¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Counter</span>(<span class="params">&#123;initialCount&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = useState(initialCount);</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      Count: &#123;count&#125;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; setCount(<span class="number">0</span>)&#125;&gt;Reset&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;button onClick=&#123;() =&gt; setCount(prevCount =&gt; prevCount + 1)&#125;&gt;+&lt;/</span>button&gt;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; setCount(<span class="function"><span class="params">prevCount</span> =&gt;</span> prevCount - <span class="number">1</span>)&#125;&gt;-&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç å¯ä»¥ä½¿ç”¨ä¸Šæ¬¡çš„ state æ¥è®¡ç®—æ–°çš„ stateã€‚ä¸ React ç±»ç»„ä»¶ä¸­çš„ setState ä¸åŒï¼ŒuseState ä¸ä¼šè‡ªåŠ¨åˆå¹¶æ›´æ–°å¯¹è±¡ã€‚æ‰€ä»¥å¦‚æœè¦æ›´æ–°çš„ state ä¾èµ–å‰ä¸€ä¸ª state çš„æ—¶å€™ï¼Œéœ€è¦ä½¿ç”¨å¯¹è±¡æ‰©å±•çš„æ–¹å¼ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">setState(<span class="function"><span class="params">prevState</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// Object.assign ä¹Ÿæ˜¯å¯è¡Œçš„</span></span><br><span class="line">  <span class="keyword">return</span> &#123;...prevState, ...updatedValues&#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>initialState å‚æ•°æ—¢å¯ä»¥æ˜¯ä¸€ä¸ªå€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå¦‚æœåˆå§‹çŠ¶æ€æ˜¯é«˜å¼€é”€çš„è®¡ç®—ç»“æœï¼Œåˆ™å¯ä»¥æ”¹ä¸ºæä¾›å‡½æ•°ï¼Œè¯¥å‡½æ•°ä»…åœ¨åˆå§‹æ¸²æŸ“æ—¶æ‰§è¡Œï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [state, setState] = useState(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> initialState = someExpensiveComputation(props);</span><br><span class="line">  <span class="keyword">return</span> initialState;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>initialState å‚æ•°åªæœ‰åœ¨åˆå§‹æ¸²æŸ“æœŸé—´æ‰ä¼šä½¿ç”¨ï¼Œåœ¨éšåçš„æ¸²æŸ“ä¸­ï¼Œå®ƒä¼šè¢«å¿½ç•¥ã€‚</p><h3>Effect Hooks</h3><p>Effect Hooks å…è®¸åœ¨ç»„ä»¶ä¸­æ‰§è¡Œå‰¯ä½œç”¨ï¼ˆside effectsï¼‰ï¼Œç±»ä¼¼äºç±»ä¸­çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚é€šå¸¸æˆ‘ä»¬éœ€è¦åœ¨ componentDidMount å’Œ componentDidUpdate å†™ä¸€äº›æ“ä½œï¼Œå¯èƒ½æ˜¯æ›´æ–°æ•°æ®ï¼Œä¹Ÿå¯èƒ½æ˜¯æ›´æ–° Domã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜ä¼šåœ¨ componentWillUnmount çš„æ—¶å€™è§£ç»‘ä¸€äº›äº‹ä»¶ç›‘å¬é˜²æ­¢å†…å­˜æ³„éœ²ã€‚è¿™äº›éƒ½å¯¼è‡´äº†ç»„ä»¶ç»´æŠ¤æˆæœ¬çš„å¢å¤§ã€‚è€Œåœ¨ function ç»„ä»¶ä¸­ï¼Œåˆæ²¡æœ‰è¿™äº›ç”Ÿå‘½å‘¨æœŸï¼Œå› æ­¤ Hooks ä½¿ç”¨ Effect Hooks æ¥å–ä»£è¿™äº›ç”Ÿå‘½å‘¨æœŸï¼Œå®Œæˆä¸€éƒ¨åˆ†èƒ½åŠ›ã€‚</p><p>çœ‹ä¸€ä¸‹å®˜æ–¹ç»™å‡ºçš„åŠ¨æ€æ›´æ”¹ title çš„ demoï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useState, useEffect &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Example</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = useState(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Similar to componentDidMount and componentDidUpdate:</span></span><br><span class="line">  useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// Update the document title using the browser API</span></span><br><span class="line">    <span class="built_in">document</span>.title = <span class="string">`You clicked <span class="subst">$&#123;count&#125;</span> times`</span>;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;p&gt;You clicked &#123;count&#125; times&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">      &lt;button onClick=&#123;() =&gt; setCount(count + 1)&#125;&gt;</span></span><br><span class="line"><span class="regexp">        Click me</span></span><br><span class="line"><span class="regexp">      &lt;/</span>button&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure><p>åœ¨ useEffect ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ componentDidMount å’Œ componentDidUpdate ä¸­åŒæ—¶å»è°ƒç”¨æ›´æ”¹ title çš„æ–¹æ³•ï¼Œä»¥å®Œæˆç»„ä»¶åˆå§‹åŒ–çš„çŠ¶æ€å’Œæ•°æ®æ›´æ–°çš„çŠ¶æ€ã€‚useEffect ä¼ é€’ä¸€ä¸ªå‡½æ•°ç»™ Reactï¼ŒReact åœ¨ç»„ä»¶æ¸²æŸ“å®Œæˆåå’Œæ›´æ–°åè°ƒç”¨è¿™ä¸ªå‡½æ•°æ¥å®Œæˆä¸Šè¿°åŠŸèƒ½ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒåœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“ä¹‹åå’Œæ¯æ¬¡æ›´æ–°ä¹‹åéƒ½è¿è¡Œã€‚</p><p>å¯ä»¥å°† useEffect Hook è§†ä¸º componentDidMountï¼ŒcomponentDidUpdate å’Œ componentWillUnmount çš„ç»„åˆã€‚</p><p>é‚£ useEffect ä»€ä¹ˆæ—¶å€™æ‰§è¡Œ componentWillUnmount çš„æ“ä½œå‘¢ï¼Ÿ</p><p>å¦‚æœ useEffect ä¸­è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨ React å¸è½½å½“å‰çš„ç»„ä»¶çš„æ—¶å€™ï¼Œä¼šæ‰§è¡Œè¿™ä¸ªå‡½æ•°ï¼Œç”¨äºæ¸…ç† effectã€‚</p><p>å¯¹æ¯”éœ€è¦æ¸…ç† effect å’Œä¸éœ€è¦æ¸…ç† effect çš„ä¸¤ç§å†™æ³•ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">FriendStatusWithCounter</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = useState(<span class="number">0</span>);</span><br><span class="line">  useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">document</span>.title = <span class="string">`You clicked <span class="subst">$&#123;count&#125;</span> times`</span>;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [isOnline, setIsOnline] = useState(<span class="literal">null</span>);</span><br><span class="line">  useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    ChatAPI.subscribeToFriendStatus(props.friend.id, handleStatusChange);</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      ChatAPI.unsubscribeFromFriendStatus(props.friend.id, handleStatusChange);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">handleStatusChange</span>(<span class="params">status</span>) </span>&#123;</span><br><span class="line">    setIsOnline(status.isOnline);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (<span class="comment">/*...*/</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡è·³è¿‡ Effect æ¥ä¼˜åŒ–æ€§èƒ½ã€‚</p><p>é€šå¸¸ï¼Œæ¯æ¬¡ç»„ä»¶æ¸²æŸ“æˆ–è€…æ›´æ–°éƒ½å»æ‰§è¡ŒæŸäº›é€»è¾‘ä¼šå¸¦æ¥æ— è°“çš„æ¶ˆè€—ï¼Œæ‰€ä»¥æˆ‘ä»¬ç»å¸¸ä¼šå†™è¿™æ ·çš„ä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">componentDidUpdate(prevProps, prevState) &#123;</span><br><span class="line">  <span class="keyword">if</span> (prevState.count !== <span class="keyword">this</span>.state.count) &#123;</span><br><span class="line">    <span class="built_in">document</span>.title = <span class="string">`You clicked <span class="subst">$&#123;<span class="keyword">this</span>.state.count&#125;</span> times`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åªæœ‰ç»„ä»¶æ›´æ–°å‰åçš„ state.count å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œæ‰å»æ›´æ–° titleã€‚</p><p>ç”¨ Hooks å¯ä»¥æ›´ç®€å•åœ°å¤„ç†è¿™ä¸ªé—®é¢˜</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">document</span>.title = <span class="string">`You clicked <span class="subst">$&#123;count&#125;</span> times`</span>;</span><br><span class="line">&#125;, [count]); <span class="comment">// Only re-run the effect if count changes</span></span><br></pre></td></tr></table></figure><p>ç»™ useEffect ä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°ï¼Œè¿™ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚å¦‚æœç»„ä»¶é‡æ–°æ¸²æŸ“ï¼Œåªæœ‰è¿™ä¸ª count å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ React æ‰ä¼šæ‰§è¡Œå‡½æ•° ä¸­çš„å†…å®¹ï¼Œå¦åˆ™ä¼šç›´æ¥è·³è¿‡è¿™ä¸ª effectã€‚å¦‚æœæ•°ç»„ä¸­æ˜¯å¤šä¸ªå‚æ•°ï¼Œé‚£ä¹ˆåªè¦å…¶ä¸­ä¸€ä¸ªå‘ç”Ÿå˜åŒ–ï¼ŒReact éƒ½ä¼šæ‰§è¡Œå‡½æ•°ä¸­çš„å†…å®¹ã€‚</p><p>è¿™ä¹Ÿé€‚ç”¨äºå…·æœ‰æ¸…ç†é˜¶æ®µçš„ effect ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  ChatAPI.subscribeToFriendStatus(props.friend.id, handleStatusChange);</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    ChatAPI.unsubscribeFromFriendStatus(props.friend.id, handleStatusChange);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;, [props.friend.id]); <span class="comment">// Only re-subscribe if props.friend.id changes</span></span><br></pre></td></tr></table></figure><p>å¦‚æœå¸Œæœ› effect åªåœ¨ç»„ä»¶ componentDidMount å’Œ componentWillUnmount çš„æ—¶å€™æ‰§è¡Œï¼Œåˆ™åªéœ€è¦ç»™ç¬¬äºŒä¸ªå‚æ•°ä¼ ä¸€ä¸ªç©ºæ•°ç»„å³å¯ã€‚ä¼ å…¥ä¸€ä¸ªç©ºæ•°ç»„ [] è¾“å…¥å‘Šè¯‰ React ä½ çš„ effect ä¸ä¾èµ–äºç»„ä»¶ä¸­çš„ä»»ä½•å€¼ï¼Œå› æ­¤è¯¥ effect ä»…åœ¨ mount æ—¶è¿è¡Œï¼Œå¹¶ä¸”åœ¨ unmount æ—¶æ‰§è¡Œæ¸…ç†ï¼Œä»ä¸åœ¨æ›´æ–°æ—¶è¿è¡Œã€‚</p><h2>Hooks çš„è§„åˆ™</h2><p>React Hooks å…¶å®ä¸ä»…ä»…æ˜¯åŠŸèƒ½å±‚é¢çš„å¢å¼ºï¼Œä¹Ÿç»™ React æ³¨å…¥äº†æ–°çš„è½¯ä»¶æ€æƒ³ã€‚è¿™å°±æ˜¯æœ€è¿‘å‡ å¹´å¼€å§‹æµè¡Œçš„ â€œçº¦å®šå¤§äºé…ç½®â€ï¼Œæ¯”å¦‚ Hooks å‡½æ•°å¿…é¡»ä½¿ç”¨ use å¼€å¤´ï¼Œè¿˜æœ‰æ¥ä¸‹æ¥è¦è®²çš„è§„åˆ™ã€‚å‰é¢åœ¨æˆ‘çš„æ–‡ç«  <a href="https://lz5z.com/webpack4-new/">webpack4 æ–°ç‰¹æ€§</a> ä¹Ÿæåˆ°äº†è¿™ä¸ªå†…å®¹ã€‚</p><h3>åªåœ¨é¡¶å±‚è°ƒç”¨ Hooks</h3><p>Hooks åªèƒ½åœ¨é¡¶å±‚è°ƒç”¨ï¼Œä¸è¦åœ¨å¾ªç¯ï¼Œæ¡ä»¶æˆ–åµŒå¥—å‡½æ•°ä¸­è°ƒç”¨ Hookã€‚åŸå› æ˜¯ React éœ€è¦ä¿è¯æ¯æ¬¡ç»„ä»¶æ¸²æŸ“çš„æ—¶å€™éƒ½ä»¥ç›¸åŒçš„é¡ºåºè°ƒç”¨ Hooksã€‚</p><p>å‡å¦‚ä¸€ä¸ªç»„ä»¶ä¸­æœ‰å¤šä¸ª Hooksï¼ŒReact å¦‚ä½•çŸ¥é“å“ªä¸ª state(çŠ¶æ€) å¯¹åº”äºå“ªä¸ª useState è°ƒç”¨å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ React ä¾èµ–äºè°ƒç”¨ Hooks çš„é¡ºåºã€‚æœ¬è´¨ä¸Šæ¥è¯´ Hooks å°±æ˜¯æ•°ç»„ï¼ˆ<a href="https://medium.com/@ryardley/react-hooks-not-magic-just-arrays-cd4f1857236e" target="_blank" rel="noopener">React hooks: not magic, just arrays</a>ï¼‰ã€‚æ¯æ¬¡æ‰§è¡Œ useState éƒ½ä¼šæ”¹å˜ä¸‹æ ‡ï¼Œå¦‚æœ useState è¢«åŒ…è£¹åœ¨ condition ä¸­ï¼Œé‚£æ¯æ¬¡æ‰§è¡Œçš„ä¸‹æ ‡å°±å¯èƒ½å¯¹ä¸ä¸Šï¼Œå¯¼è‡´ useState æ›´æ–°é”™æ•°æ®ã€‚</p><h3>åªèƒ½åœ¨ React Function ä¸­è°ƒç”¨ Hooks</h3><p>Hooks åªèƒ½åœ¨ React function ç»„ä»¶ä¸­è°ƒç”¨ï¼Œæˆ–è€…åœ¨è‡ªå®šä¹‰ Hooks ä¸­è°ƒç”¨ã€‚é€šè¿‡éµå¾ªæ­¤è§„åˆ™ï¼Œå¯ä»¥ç¡®ä¿ç»„ä»¶ä¸­çš„æ‰€æœ‰ stateful ï¼ˆæœ‰çŠ¶æ€ï¼‰é€»è¾‘åœ¨å…¶æºä»£ç ä¸­æ¸…æ™°å¯è§ã€‚</p><h3>eslint</h3><p><a href="https://www.npmjs.com/package/eslint-plugin-react-hooks" target="_blank" rel="noopener">eslint-plugin-react-hooks</a> å¯ä»¥ä¿è¯å¼ºåˆ¶æ‰§è¡Œä¸Šè¿°ä¸¤ä¸ªè§„åˆ™ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npm install eslint-plugin-react-hooks@next</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Your ESLint configuration</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"plugins"</span>: [</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="string">"react-hooks"</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="string">"rules"</span>: &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="string">"react-hooks/rules-of-hooks"</span>: <span class="string">"error"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2>è‡ªå®šä¹‰ Hooks</h2><p>è‡ªå®šä¹‰ Hooks å°±æ˜¯å°†ç»„ä»¶ä¹‹é—´éœ€è¦å…±æœ‰çš„é€»è¾‘æŠ½å‡ºæ¥å†™æˆå•ç‹¬çš„å‡½æ•°ã€‚ä¸ä¸€èˆ¬çš„å‡½æ•°çš„åŒºåˆ«æ˜¯ï¼Œè‡ªå®šä¹‰ Hooks æ˜¯ä¸€ä¸ªä»¥ use å¼€å¤´çš„å‡½æ•°ï¼Œå†…éƒ¨å¯ä»¥è°ƒç”¨å…¶å®ƒçš„ Hooksã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useState, useEffect &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">useFriendStatus</span>(<span class="params">friendID</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [isOnline, setIsOnline] = useState(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">handleStatusChange</span>(<span class="params">status</span>) </span>&#123;</span><br><span class="line">    setIsOnline(status.isOnline);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    ChatAPI.subscribeToFriendStatus(friendID, handleStatusChange);</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      ChatAPI.unsubscribeFromFriendStatus(friendID, handleStatusChange);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> isOnline;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> useFriendStatus;</span><br></pre></td></tr></table></figure><p>åœ¨å¦å¤–ä¸€ä¸ªç»„ä»¶ä¸­ï¼Œå°†å…¶å¼•å…¥åï¼Œå°±å¯ä»¥ä½¿ç”¨äº†</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useFriendStatus&#125; <span class="keyword">from</span> <span class="string">'hooks/xxx.js'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">FriendListItem</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> isOnline = useFriendStatus(props.friend.id);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;li style=&#123;&#123; <span class="attr">color</span>: isOnline ? <span class="string">'green'</span> : <span class="string">'black'</span> &#125;&#125;&gt;</span><br><span class="line">      &#123;props.friend.name&#125;</span><br><span class="line">    &lt;<span class="regexp">/li&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œè‡ªå®šä¹‰ Hooks å°±æ˜¯ä¸€ä¸ª JavaScript å‡½æ•°è€Œå·²ï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«ã€‚ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè‡ªå®šä¹‰ Hooks å‡½æ•°ä¹Ÿå¿…é¡»ä»¥ use å¼€å¤´ï¼ˆè§„çº¦ä¼˜å…ˆï¼‰ã€‚</p><h3>useContext</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> context = useContext(Context);</span><br></pre></td></tr></table></figure><p>æ¥å—ä¸€ä¸ª contextï¼ˆä¸Šä¸‹æ–‡ï¼‰å¯¹è±¡ï¼ˆä» React.createContext è¿”å›çš„å€¼ï¼‰å¹¶è¿”å›å½“å‰ context å€¼ï¼Œå½“æä¾›ç¨‹åºæ›´æ–°æ—¶ï¼Œæ­¤ Hook å°†ä½¿ç”¨æœ€æ–°çš„ context å€¼è§¦å‘é‡æ–°æ¸²æŸ“ã€‚</p><h3>useReducer</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [state, dispatch] = useReducer(reducer, initialState);</span><br></pre></td></tr></table></figure><p>useReducer å¯ä»¥ç†è§£ä¸º Redux çš„ Hooksï¼Œæ¥å—çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ <code>(state, action) =&gt; newState</code> çš„ reducerï¼Œå¹¶è¿”å›ä¸ dispatch æ–¹æ³•é…å¯¹çš„å½“å‰çŠ¶æ€ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> initialState = &#123;<span class="attr">count</span>: <span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reducer</span>(<span class="params">state, action</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'reset'</span>:</span><br><span class="line">      <span class="keyword">return</span> initialState;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'increment'</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123;<span class="attr">count</span>: state.count + <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'decrement'</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123;<span class="attr">count</span>: state.count - <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="comment">// A reducer must always return a valid state.</span></span><br><span class="line">      <span class="comment">// Alternatively you can throw an error if an invalid action is dispatched.</span></span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Counter</span>(<span class="params">&#123;initialCount&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [state, dispatch] = useReducer(reducer, &#123;<span class="attr">count</span>: initialCount&#125;);</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      Count: &#123;state.count&#125;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; dispatch(&#123;<span class="attr">type</span>: <span class="string">'reset'</span>&#125;)&#125;&gt;</span><br><span class="line">        Reset</span><br><span class="line">      &lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;button onClick=&#123;() =&gt; dispatch(&#123;type: 'increment'&#125;)&#125;&gt;+&lt;/</span>button&gt;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; dispatch(&#123;<span class="attr">type</span>: <span class="string">'decrement'</span>&#125;)&#125;&gt;-&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>useReducer æ¥å—å¯é€‰çš„ç¬¬ä¸‰ä¸ªå‚æ•° initialActionï¼Œè¡¨ç¤ºåœ¨ç»„ä»¶åˆå§‹åŒ–æœŸé—´æ‰§è¡Œçš„æ“ä½œã€‚æ¯”å¦‚åˆ©ç”¨ props ä¼ é€’çš„å€¼æ¥åˆå§‹åŒ– state çš„æ“ä½œã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> initialState = &#123;<span class="attr">count</span>: <span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reducer</span>(<span class="params">state, action</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'reset'</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123;<span class="attr">count</span>: action.payload&#125;;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'increment'</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123;<span class="attr">count</span>: state.count + <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'decrement'</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123;<span class="attr">count</span>: state.count - <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="comment">// A reducer must always return a valid state.</span></span><br><span class="line">      <span class="comment">// Alternatively you can throw an error if an invalid action is dispatched.</span></span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Counter</span>(<span class="params">&#123;initialCount&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [state, dispatch] = useReducer(</span><br><span class="line">    reducer,</span><br><span class="line">    initialState,</span><br><span class="line">    &#123;<span class="attr">type</span>: <span class="string">'reset'</span>, <span class="attr">payload</span>: initialCount&#125;,</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      Count: &#123;state.count&#125;</span><br><span class="line">      &lt;button</span><br><span class="line">        onClick=&#123;() =&gt; dispatch(&#123;<span class="attr">type</span>: <span class="string">'reset'</span>, <span class="attr">payload</span>: initialCount&#125;)&#125;&gt;</span><br><span class="line">        Reset</span><br><span class="line">      &lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;button onClick=&#123;() =&gt; dispatch(&#123;type: 'increment'&#125;)&#125;&gt;+&lt;/</span>button&gt;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; dispatch(&#123;<span class="attr">type</span>: <span class="string">'decrement'</span>&#125;)&#125;&gt;-&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3>useRef</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> refContainer = useRef(initialValue);</span><br></pre></td></tr></table></figure><p>useRef è¿”å›ä¸€ä¸ªå¯å˜çš„ ref å¯¹è±¡ï¼Œé€šè¿‡ <code>.current</code> å±æ€§å¯¹å…¶è¿›è¡Œè®¿é—®ï¼Œè¿”å›çš„å¯¹è±¡å°†å­˜ç•™åœ¨æ•´ä¸ªç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸä¸­ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">TextInputWithFocusButton</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> inputEl = useRef(<span class="literal">null</span>);</span><br><span class="line">  <span class="keyword">const</span> onButtonClick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// `current` points to the mounted text input element</span></span><br><span class="line">    inputEl.current.focus();</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      &lt;input ref=&#123;inputEl&#125; type=<span class="string">"text"</span> /&gt;</span><br><span class="line">      &lt;button onClick=&#123;onButtonClick&#125;&gt;Focus the input&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3>useImperativeMethods</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">useImperativeMethods(ref, createInstance, [inputs]);</span><br></pre></td></tr></table></figure><p>useImperativeMethods ä¸ forwardRef å…±åŒä½¿ç”¨ï¼Œè¡¨ç¤ºå¼ºåˆ¶æ–¹æ³•ã€‚é€šè¿‡ ref å°†å­ç»„ä»¶çš„æŸä¸ªæ–¹æ³•æš´éœ²ç»™çˆ¶ç»„ä»¶ã€‚</p><p>å­ç»„ä»¶ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">FancyInput</span>(<span class="params">props, ref</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> inputRef = useRef();</span><br><span class="line">  useImperativeMethods(ref, () =&gt; (&#123;</span><br><span class="line">    focus: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      inputRef.current.focus();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;));</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span>=<span class="string">&#123;inputRef&#125;</span> <span class="attr">...</span> /&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line">FancyInput = forwardRef(FancyInput);</span><br></pre></td></tr></table></figure><p>çˆ¶ç»„ä»¶ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">FancyParent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> fancyInputRef = useRef(<span class="literal">null</span>);</span><br><span class="line">  useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    fancyInputRef.current.focus(); </span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;FancyInput ref=&#123;fancyInputRef&#125; /&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3>useLayoutEffect</h3><p>ç”¨æ³•ä¸ useEffect ç›¸åŒï¼Œä½†åœ¨æ‰€æœ‰ DOM å˜åŒ–ååŒæ­¥è§¦å‘ã€‚ä½¿ç”¨å®ƒæ¥ä» DOM è¯»å–å¸ƒå±€å¹¶åŒæ­¥é‡æ–°æ¸²æŸ“ã€‚ åœ¨æµè§ˆå™¨ç»˜åˆ¶ä¹‹å‰ useLayoutEffect å°†åŒæ­¥åˆ·æ–°ã€‚</p><p>useEffect ä¸­çš„å‡½æ•°ä¼šåœ¨ layout(å¸ƒå±€) å’Œ paint(ç»˜åˆ¶) åè§¦å‘ã€‚ è¿™ä½¿å¾—å®ƒé€‚ç”¨äºè®¸å¤šå¸¸è§çš„ side effects ï¼Œä¾‹å¦‚è®¾ç½®è®¢é˜…å’Œäº‹ä»¶å¤„ç†ç¨‹åºï¼Œå› ä¸ºå¤§å¤šæ•°ç±»å‹çš„å·¥ä½œä¸åº”é˜»æ­¢æµè§ˆå™¨æ›´æ–°å±å¹•ã€‚</p><p>ä½†æ˜¯å¦‚æœ effect ä¸èƒ½å¤Ÿæ¨è¿Ÿï¼Œæ¯”å¦‚è¦ DOM æ”¹å˜å¿…é¡»åœ¨ä¸‹ä¸€æ¬¡ç»˜åˆ¶ä¹‹å‰åŒæ­¥è§¦å‘ï¼Œä½¿ç”¨ useLayoutEffect ä¼šæ›´åŠ åˆé€‚ã€‚</p><h2>Hooks API</h2><p>å‚è€ƒ <a href="https://reactjs.org/docs/hooks-reference.html" target="_blank" rel="noopener">Hooks API Reference</a></p><h2>æ€»ç»“</h2><p>Hooks é€šè¿‡è®¾å®šæŸäº›ç‰¹æ®Šå‡½æ•°ï¼Œåœ¨ React ç»„ä»¶å†…éƒ¨â€œé’©ä½â€å…¶ç”Ÿå‘½å‘¨æœŸå’Œ stateï¼Œå¸®åŠ©å¼€å‘è€…è§£å†³ä¸€äº›é€»è¾‘å¤ç”¨çš„é—®é¢˜ï¼Œé€šè¿‡è‡ªå®šä¹‰çš„ Hooks å¯¹ä»£ç è¿›è¡ŒæŠ½è±¡ï¼Œè®©æˆ‘ä»¬å†™å‡ºæ›´åŠ ç¬¦åˆå‡½æ•°å¼ç¼–ç¨‹çš„è§„èŒƒï¼ŒåŒæ—¶ä¹Ÿå‡å°‘äº†å±‚å±‚åµŒå¥—å¸¦æ¥çš„é—®é¢˜ã€‚</p><h2>å‚è€ƒæ–‡æ¡£</h2><ul><li><a href="https://juejin.im/post/5be8d3def265da611a476231" target="_blank" rel="noopener">ç²¾è¯»ã€ŠReact Hooksã€‹</a></li><li><a href="https://reactjs.org/docs/hooks-intro.html" target="_blank" rel="noopener">React docs - Introducing Hooks<br></a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ€è¿‘åœ¨é‡æ„ BadJS çš„ç®¡ç†é¡µé¢ï¼Œä½¿ç”¨ TypeScript + React Hooks çš„æŠ€æœ¯æ ˆï¼Œè¶è¿™ä¸ªæœºä¼šå¥½å¥½ç†ä¸€ç† React Hooks é‚£äº›äº‹å„¿ã€‚&lt;/p&gt;
&lt;p&gt;React Hooks æ˜¯ 16.7.0-alpha ç‰ˆæœ¬çš„æ–°ç‰¹æ€§ï¼Œå®‰è£…å³å¯äº«ç”¨ã€‚&lt;/p&gt;
&lt;h2&gt;React Hooks ç®€ä»‹&lt;/h2&gt;
&lt;p&gt;React Hooks æ˜¯å¯¹ React function ç»„ä»¶çš„ä¸€ç§æ‰©å±•ï¼Œé€šè¿‡ä¸€äº›ç‰¹æ®Šçš„å‡½æ•°ï¼Œè®©æ— çŠ¶æ€ç»„ä»¶æ‹¥æœ‰çŠ¶æ€ç»„ä»¶æ‰æ‹¥æœ‰çš„èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;p&gt;Hooks æ˜¯ React å‡½æ•°ç»„ä»¶ä¸­çš„ä¸€ç±»ç‰¹æ®Šå‡½æ•°ï¼Œé€šå¸¸ä»¥ use å¼€å¤´ï¼Œæ¯”å¦‚ useRefï¼ŒuseStateï¼ŒuseReducer ç­‰ã€‚é€šå¸¸åœ¨æˆ‘ä»¬å†™ React ç»„ä»¶çš„æ—¶å€™ï¼Œå¦‚æœè¿™ä¸ªç»„ä»¶æ¯”è¾ƒå¤æ‚ï¼Œæ‹¥æœ‰è‡ªå·±çš„ç”Ÿå‘½å‘¨æœŸæˆ–è€… stateï¼Œå°±å°†å…¶å†™æˆ class ç»„ä»¶ï¼›å¦‚æœè¿™ä¸ªç»„ä»¶ä»…ä»…ç”¨æ¥å±•ç¤ºï¼Œå°±å°†å…¶å†™æˆ function ç»„ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;React Hooks ä½¿ç”¨ function ç»„ä»¶çš„å†™æ³•ï¼Œé€šè¿‡ useState è¿™æ ·çš„ API è§£å†³äº† function ç»„ä»¶æ²¡æœ‰ state çš„é—®é¢˜ï¼Œé€šè¿‡ useEffect æ¥è§£å†³ç”Ÿå‘½å‘¨æœŸçš„é—®é¢˜ï¼Œé€šè¿‡è‡ªå®šä¹‰ hooks æ¥å¤ç”¨ä¸šåŠ¡é€»è¾‘ã€‚&lt;/p&gt;
&lt;h3&gt;Hooks è§£å†³å“ªäº›é—®é¢˜&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å¤ç”¨ä¸çŠ¶æ€æœ‰å…³çš„é€»è¾‘ï¼Œä¹‹å‰å¼•ç”³å‡ºæ¥ HOC çš„æ¦‚å¿µï¼Œä½†æ˜¯ HOC ä¼šå¯¼è‡´ç»„ä»¶æ ‘çš„è‡ƒè‚¿ã€‚&lt;/li&gt;
&lt;li&gt;è§£å†³ç»„ä»¶éšç€ä¸šåŠ¡æ‰©å±•å˜å¾—éš¾ä»¥ç»´æŠ¤çš„é—®é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨æ›´å®¹æ˜“ç†è§£å¹¶ä¸”å¯¹åˆå­¦è€…æ›´å‹å¥½çš„ function ç»„ä»¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="React" scheme="https://lz5z.com/categories/React/"/>
    
    
      <category term="React" scheme="https://lz5z.com/tags/React/"/>
    
      <category term="Hooks" scheme="https://lz5z.com/tags/Hooks/"/>
    
  </entry>
  
  <entry>
    <title>Koa æºç ç ”è¯»</title>
    <link href="https://lz5z.com/Koa-Source/"/>
    <id>https://lz5z.com/Koa-Source/</id>
    <published>2018-12-05T23:06:57.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h2>ç®€ä»‹</h2><p><a href="https://koajs.com/" target="_blank" rel="noopener">Koa</a> æ˜¯ä¸€ä¸ªéå¸¸è½»é‡çš„ web å¼€å‘æ¡†æ¶ï¼Œç”± Express å›¢é˜Ÿæ‰“é€ ã€‚ç›¸è¾ƒäº Expressï¼ŒKoa ä½¿ç”¨ async å‡½æ•°è§£å†³å¼‚æ­¥çš„é—®é¢˜ï¼Œå¹¶ä¸”å®Œå…¨è„±ç¦»ä¸­é—´ä»¶ï¼Œéå¸¸ä¼˜é›…ï¼Œè€Œä¸” Koa ä»£ç ç®€æ´å‹å¥½ï¼Œå¾ˆé€‚åˆåˆå­¦è€…é˜…è¯»ã€‚</p><h3>Koa ä»£ç ç»“æ„</h3><img src="/assets/img/koa-source.png" alt="koa-source" style="max-width: 300px;display: block;"><a id="more"></a><p>å¯ä»¥çœ‹åˆ° Koa çš„ç»“æ„éå¸¸ç®€å•ï¼Œlib æ–‡ä»¶å¤¹ä¸‹é¢æ”¾ç€ koa çš„æ ¸å¿ƒæ–‡ä»¶ï¼š</p><h3>application.js</h3><p>application æ˜¯ koa çš„å…¥å£æ–‡ä»¶ï¼Œexport å‡ºä¸€ä¸ª Application çš„ç±»ï¼ˆç»§æ‰¿è‡ª events.Emitterï¼‰ã€‚application æœ‰ä»¥ä¸‹å‡ ä¸ªä¸»è¦ï¼ˆpublicï¼‰çš„ apiï¼š</p><ul><li><p>listen: å®ç°å¯¹ http.createServer() çš„å°è£…ï¼Œä¼ å…¥çš„å‚æ•° callback ä¸­å®Œæˆä¸­é—´ä»¶åˆå¹¶ï¼Œé”™è¯¯ç›‘å¬ä»¥åŠä¸Šä¸‹æ–‡çš„åˆ›å»ºå’Œ request çš„å¤„ç†ã€‚</p></li><li><p>use: æˆ‘ä»¬é€šå¸¸ä½¿ç”¨ app.use(function) å°†ä¸­é—´ä»¶æ·»åŠ åˆ°åº”ç”¨ç¨‹åºã€‚use æ–¹æ³•ä¸­ï¼Œkoa å°†ä¸­é—´ä»¶ï¼ˆå‡½æ•°ï¼‰æ·»åŠ åˆ° this.middleware æ•°ç»„ä¸­ã€‚</p></li><li><p>callback: koa-compose å°†ä¸­é—´ä»¶ç»„åˆåœ¨ä¸€èµ·, ç„¶åè¿”å›ä¸€ä¸ª request å›è°ƒå‡½æ•°ï¼ŒåŒæ—¶ç»™ listen ä½œä¸ºå›è°ƒã€‚</p></li><li><p>toJSON: è¿”å›ä¸€ä¸ªå»é™¤ç§æœ‰å±æ€§ï¼ˆ<code>_</code>å¼€å¤´ï¼‰çš„å¯¹è±¡ã€‚</p></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="class"><span class="keyword">class</span> <span class="title">Application</span> <span class="keyword">extends</span> <span class="title">Emitter</span> </span>&#123;</span><br><span class="line">  listen(...args) &#123;</span><br><span class="line">    debug(<span class="string">'listen'</span>);</span><br><span class="line">    <span class="keyword">const</span> server = http.createServer(<span class="keyword">this</span>.callback());</span><br><span class="line">    <span class="keyword">return</span> server.listen(...args);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  use(fn) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> fn !== <span class="string">'function'</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'middleware must be a function!'</span>);</span><br><span class="line">    <span class="keyword">this</span>.middleware.push(fn);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  callback() &#123;</span><br><span class="line">    <span class="keyword">const</span> fn = compose(<span class="keyword">this</span>.middleware);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">this</span>.listenerCount(<span class="string">'error'</span>)) <span class="keyword">this</span>.on(<span class="string">'error'</span>, <span class="keyword">this</span>.onerror);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> handleRequest = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> ctx = <span class="keyword">this</span>.createContext(req, res);</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.handleRequest(ctx, fn);</span><br><span class="line">    &#125;;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">return</span> handleRequest;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3>context.js</h3><p>context æ˜¯æˆ‘ä»¬åœ¨ä½¿ç”¨ koa ä¸­æœ€å¸¸æ¥è§¦åˆ°çš„ ctxï¼Œå°±æ˜¯ä¸€ä¸ªæš´éœ²å‡ºæ¥çš„å¯¹è±¡ã€‚context ä¸­å®ç°äº†å¯¹ cookie çš„ get set æ“ä½œï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ ctx å¯¹ cookie æ“ä½œçš„åŸç†ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œctx ä¸­æœ€é‡è¦çš„æ˜¯ delegateï¼Œä¹Ÿå°±æ˜¯å§”æ‰˜ã€‚æˆ‘ä»¬ç®€å•çœ‹ä¸€ä¸‹ä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">delegate(proto, <span class="string">'response'</span>)</span><br><span class="line">  .method(<span class="string">'attachment'</span>)</span><br><span class="line">  .method(<span class="string">'redirect'</span>)</span><br><span class="line">  .method(<span class="string">'remove'</span>)</span><br><span class="line">  .method(<span class="string">'vary'</span>)</span><br><span class="line">  .method(<span class="string">'set'</span>)</span><br><span class="line">  .method(<span class="string">'append'</span>)</span><br><span class="line">  .method(<span class="string">'flushHeaders'</span>)</span><br><span class="line">  .access(<span class="string">'status'</span>)</span><br><span class="line">  .access(<span class="string">'message'</span>)</span><br><span class="line">  .access(<span class="string">'body'</span>)</span><br><span class="line">  .access(<span class="string">'length'</span>)</span><br><span class="line">  .access(<span class="string">'type'</span>)</span><br><span class="line">  .access(<span class="string">'lastModified'</span>)</span><br><span class="line">  .access(<span class="string">'etag'</span>)</span><br><span class="line">  .getter(<span class="string">'headerSent'</span>)</span><br><span class="line">  .getter(<span class="string">'writable'</span>);</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šçš„ proto å°±æ˜¯ ctxï¼Œå®ç°äº†å¯¹ response å¯¹è±¡çš„ä»£ç†ï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨ ctx.status æ¥è®¿é—® ctx.response.statusã€‚</p><p>åŒæ ·çš„ï¼Œrequest ä¸Šé¢çš„å±æ€§å’Œæ–¹æ³•ä¹Ÿè¢«ä»£ç†åˆ°äº† ctx ä¸­ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">delegate(proto, <span class="string">'request'</span>)</span><br><span class="line">  .method(<span class="string">'acceptsLanguages'</span>)</span><br><span class="line">  .method(<span class="string">'acceptsEncodings'</span>)</span><br><span class="line">  .method(<span class="string">'acceptsCharsets'</span>)</span><br><span class="line">  .method(<span class="string">'accepts'</span>)</span><br><span class="line">  .method(<span class="string">'get'</span>)</span><br><span class="line">  .method(<span class="string">'is'</span>)</span><br><span class="line">  .access(<span class="string">'querystring'</span>)</span><br><span class="line">  .access(<span class="string">'idempotent'</span>)</span><br><span class="line">  .access(<span class="string">'socket'</span>)</span><br><span class="line">  .access(<span class="string">'search'</span>)</span><br><span class="line">  .access(<span class="string">'method'</span>)</span><br><span class="line">  .access(<span class="string">'query'</span>)</span><br><span class="line">  .access(<span class="string">'path'</span>)</span><br><span class="line">  .access(<span class="string">'url'</span>)</span><br><span class="line">  .access(<span class="string">'accept'</span>)</span><br><span class="line">  .getter(<span class="string">'origin'</span>)</span><br><span class="line">  .getter(<span class="string">'href'</span>)</span><br><span class="line">  .getter(<span class="string">'subdomains'</span>)</span><br><span class="line">  .getter(<span class="string">'protocol'</span>)</span><br><span class="line">  .getter(<span class="string">'host'</span>)</span><br><span class="line">  .getter(<span class="string">'hostname'</span>)</span><br><span class="line">  .getter(<span class="string">'URL'</span>)</span><br><span class="line">  .getter(<span class="string">'header'</span>)</span><br><span class="line">  .getter(<span class="string">'headers'</span>)</span><br><span class="line">  .getter(<span class="string">'secure'</span>)</span><br><span class="line">  .getter(<span class="string">'stale'</span>)</span><br><span class="line">  .getter(<span class="string">'fresh'</span>)</span><br><span class="line">  .getter(<span class="string">'ips'</span>)</span><br><span class="line">  .getter(<span class="string">'ip'</span>);</span><br></pre></td></tr></table></figure><p>ctx.hostname å³æ˜¯ ctx.request.hostnameã€‚</p><h3>request.js &amp;&amp; response.js</h3><p>request.js å’Œ response.js ä¸­å®Œæˆå¯¹ Koa Request/Response å¯¹è±¡çš„å°è£…ï¼Œå¯ä»¥é€šè¿‡ <a href="http://request.xxx/response.xxx" target="_blank" rel="noopener">request.xxx/response.xxx</a> å¯¹å…¶è¿›è¡Œæ“ä½œã€‚å…¶ä¸­ä½¿ç”¨äº†å¾ˆå¤š get å’Œ set æ–¹æ³•ã€‚</p><h2>å®ç°ä¸€ä¸ªç®€å•çš„ moa</h2><ul><li>é¦–å…ˆéœ€è¦å®Œæˆå¯¹ http æ¨¡å—çš„å°è£…ï¼Œå¯ä»¥ä½¿ç”¨åˆ›å»ºæœåŠ¡å™¨ã€‚</li><li>ç„¶åå®Œæˆ request å’Œ response å¯¹è±¡çš„å°è£…ï¼Œä»¥åŠå°†å…¶ä»£ç†åˆ° context å¯¹è±¡ä¸Šã€‚</li><li>ç„¶åéœ€è¦å¤„ç†ä¸­é—´ä»¶ä»¥åŠå®ç°æ´‹è‘±æ¨¡å‹ã€‚</li><li>æœ€åéœ€è¦å®Œæˆå¯¹é”™è¯¯çš„å¤„ç†å’Œå¼‚å¸¸æ•è·ã€‚</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;ç®€ä»‹&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://koajs.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Koa&lt;/a&gt; æ˜¯ä¸€ä¸ªéå¸¸è½»é‡çš„ web å¼€å‘æ¡†æ¶ï¼Œç”± Express å›¢é˜Ÿæ‰“é€ ã€‚ç›¸è¾ƒäº Expressï¼ŒKoa ä½¿ç”¨ async å‡½æ•°è§£å†³å¼‚æ­¥çš„é—®é¢˜ï¼Œå¹¶ä¸”å®Œå…¨è„±ç¦»ä¸­é—´ä»¶ï¼Œéå¸¸ä¼˜é›…ï¼Œè€Œä¸” Koa ä»£ç ç®€æ´å‹å¥½ï¼Œå¾ˆé€‚åˆåˆå­¦è€…é˜…è¯»ã€‚&lt;/p&gt;
&lt;h3&gt;Koa ä»£ç ç»“æ„&lt;/h3&gt;
&lt;img src=&quot;/assets/img/koa-source.png&quot; alt=&quot;koa-source&quot; style=&quot;max-width: 300px;display: block;&quot;&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="Koa" scheme="https://lz5z.com/tags/Koa/"/>
    
      <category term="node" scheme="https://lz5z.com/tags/node/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨ SRI è§£å†³ CDN åŠ«æŒ</title>
    <link href="https://lz5z.com/SRI-CDN/"/>
    <id>https://lz5z.com/SRI-CDN/</id>
    <published>2018-11-25T13:05:48.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h2>SRI ç®€ä»‹</h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/Security/%E5%AD%90%E8%B5%84%E6%BA%90%E5%AE%8C%E6%95%B4%E6%80%A7" target="_blank" rel="noopener">SRI</a> å…¨ç§° Subresource Integrity - å­èµ„æºå®Œæ•´æ€§ï¼Œæ˜¯æŒ‡æµè§ˆå™¨é€šè¿‡éªŒè¯èµ„æºçš„å®Œæ•´æ€§ï¼ˆé€šå¸¸ä» CDN è·å–ï¼‰æ¥åˆ¤æ–­å…¶æ˜¯å¦è¢«ç¯¡æ”¹çš„å®‰å…¨ç‰¹æ€§ã€‚</p><p>é€šè¿‡ç»™ link æ ‡ç­¾æˆ–è€… script æ ‡ç­¾å¢åŠ  integrity å±æ€§å³å¯å¼€å¯ SRI åŠŸèƒ½ï¼Œæ¯”å¦‚ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"//s.url.cn/xxxx/xxx.js?_offline=1"</span> <span class="attr">integrity</span>=<span class="string">"sha256-mY9nzNMPPf8oL3CJss7THIEoXAC2ToW1tEX0NBhMvuw= sha384-ncIKElSEk2OR3YfjNLRSY35mzt0CUwrpNDVS//iD3dF9vxrWeZ7WPlAPJTqGkSai"</span> <span class="attr">crossorigin</span>=<span class="string">"anonymous"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>integrity å€¼åˆ†æˆä¸¤ä¸ªéƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ†æŒ‡å®šå“ˆå¸Œå€¼çš„ç”Ÿæˆç®—æ³•ï¼ˆsha256ã€sha384 åŠ sha512ï¼‰ï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯ç»è¿‡ base64 ç¼–ç çš„å®é™…å“ˆå¸Œå€¼ï¼Œä¸¤è€…ä¹‹é—´é€šè¿‡ä¸€ä¸ªçŸ­æ¨ªï¼ˆ-ï¼‰åˆ†å‰²ã€‚integrity å€¼å¯ä»¥åŒ…å«å¤šä¸ªç”±ç©ºæ ¼åˆ†éš”çš„å“ˆå¸Œå€¼ï¼Œåªè¦æ–‡ä»¶åŒ¹é…å…¶ä¸­ä»»æ„ä¸€ä¸ªå“ˆå¸Œå€¼ï¼Œå°±å¯ä»¥é€šè¿‡æ ¡éªŒå¹¶åŠ è½½è¯¥èµ„æºã€‚ä¸Šè¿°ä¾‹å­ä¸­æˆ‘ä½¿ç”¨äº† sha256 å’Œ sha384 ä¸¤å¼  hash æ–¹æ¡ˆã€‚</p><a id="more"></a><blockquote><p>å¤‡æ³¨ï¼š<code>crossorigin=&quot;anonymous&quot;</code> çš„ä½œç”¨æ˜¯å¼•å…¥è·¨åŸŸè„šæœ¬ï¼Œåœ¨ HTML5 ä¸­æœ‰ä¸€ç§æ–¹å¼å¯ä»¥è·å–åˆ°è·¨åŸŸè„šæœ¬çš„é”™è¯¯ä¿¡æ¯ï¼Œé¦–å…ˆè·¨åŸŸè„šæœ¬çš„æœåŠ¡å™¨å¿…é¡»é€šè¿‡ Access-Controll-Allow-Origin å¤´ä¿¡æ¯å…è®¸å½“å‰åŸŸåå¯ä»¥è·å–é”™è¯¯ä¿¡æ¯ï¼Œç„¶åæ˜¯å½“å‰åŸŸåçš„ script æ ‡ç­¾ä¹Ÿå¿…é¡»å£°æ˜æ”¯æŒè·¨åŸŸï¼Œä¹Ÿå°±æ˜¯ crossorigin å±æ€§ã€‚linkã€img ç­‰æ ‡ç­¾å‡æ”¯æŒè·¨åŸŸè„šæœ¬ã€‚å¦‚æœä¸Šè¿°ä¸¤ä¸ªæ¡ä»¶æ— æ³•æ»¡è¶³çš„è¯ï¼Œ å¯ä»¥ä½¿ç”¨ <code>try catch</code> æ–¹æ¡ˆã€‚</p></blockquote><h2>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ SRI</h2><p>åœ¨ Web å¼€å‘ä¸­ï¼Œä½¿ç”¨ CDN èµ„æºå¯ä»¥æœ‰æ•ˆå‡å°‘ç½‘ç»œè¯·æ±‚æ—¶é—´ï¼Œä½†æ˜¯ä½¿ç”¨ CDN èµ„æºä¹Ÿå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼ŒCDN èµ„æºå­˜åœ¨äºç¬¬ä¸‰æ–¹æœåŠ¡å™¨ï¼Œåœ¨å®‰å…¨æ€§ä¸Šå¹¶ä¸å®Œå…¨å¯æ§ã€‚</p><p>CDN åŠ«æŒæ˜¯ä¸€ç§éå¸¸éš¾ä»¥å®šä½çš„é—®é¢˜ï¼Œé¦–å…ˆåŠ«æŒè€…ä¼šåˆ©ç”¨æŸç§ç®—æ³•æˆ–è€…éšæœºçš„æ–¹å¼è¿›è¡ŒåŠ«æŒï¼ˆç‹¡çŒ¾å¤§å¤§æ»´ï¼‰ï¼Œæ‰€ä»¥éå¸¸éš¾ä»¥å¤ç°ï¼Œå¾ˆå¤šç”¨æˆ·å‡ºç°ååˆ·æ–°é¡µé¢å°±ä¸å†å‡ºç°äº†ã€‚ä¹‹å‰å…¬å¸æœ‰åŒäº‹åšæ¸¸æˆçš„ä¸‹è½½å™¨å°±é‡åˆ°è¿™ä¸ªé—®é¢˜ï¼Œç”¨æˆ·ä¸‹è½½æ¸¸æˆåè§£å‹ä¸èƒ½ç©ï¼Œåé¢é€šè¿‡æ–‡ä»¶é€ä¸€å¯¹æ¯”æ‰¾åˆ°åŸå› ï¼ŒåŸæ¥æ˜¯ CDN åŠ«æŒå¯¼è‡´çš„ã€‚æ€ä¹ˆè§£å†³çš„å‘¢ï¼Ÿå¬è¯´æ˜¯æ‰¾ xx äº¤äº†ä¿æŠ¤è´¹ï¼Œåé¢ä¹Ÿæ˜¯åˆ©ç”¨æ–‡ä»¶ hash çš„æ–¹å¼ï¼Œæƒ³å¿…åŸç†ä¸Šä¹Ÿæ˜¯è·Ÿ SRI ç›¸åŒçš„ã€‚</p><p>æ‰€å¹¸çš„æ˜¯ï¼Œç›®å‰å¤§å¤šæ•°çš„ CDN åŠ«æŒåªæ˜¯ä¸ºäº†åšä¸€äº›å¤¹å¸¦ï¼Œæ¯”å¦‚é€šè¿‡ iframe æ’å…¥ä¸€äº›è´´ç‰‡å¹¿å‘Šï¼Œå¦‚æœåŠ«æŒè€…åˆ«æœ‰ç”¨å¿ƒï¼Œæ¯”å¦‚ xss æ³¨å…¥ä¹‹ç±»çš„ï¼Œè¿˜æ˜¯éå¸¸å±é™©çš„ã€‚</p><p>å¼€å¯ SRI èƒ½æœ‰æ•ˆä¿è¯é¡µé¢å¼•ç”¨èµ„æºçš„å®Œæ•´æ€§ï¼Œé¿å…æ¶æ„ä»£ç æ‰§è¡Œã€‚</p><h2>æµè§ˆå™¨å¦‚ä½•å¤„ç† SRI</h2><ul><li>å½“æµè§ˆå™¨åœ¨ script æˆ–è€… link æ ‡ç­¾ä¸­é‡åˆ° integrity å±æ€§ä¹‹åï¼Œä¼šåœ¨æ‰§è¡Œè„šæœ¬æˆ–è€…åº”ç”¨æ ·å¼è¡¨ä¹‹å‰å¯¹æ¯”æ‰€åŠ è½½æ–‡ä»¶çš„å“ˆå¸Œå€¼å’ŒæœŸæœ›çš„å“ˆå¸Œå€¼ã€‚</li><li>å½“è„šæœ¬æˆ–è€…æ ·å¼è¡¨çš„å“ˆå¸Œå€¼å’ŒæœŸæœ›çš„ä¸ä¸€è‡´æ—¶ï¼Œæµè§ˆå™¨å¿…é¡»æ‹’ç»æ‰§è¡Œè„šæœ¬æˆ–è€…åº”ç”¨æ ·å¼è¡¨ï¼Œå¹¶ä¸”å¿…é¡»è¿”å›ä¸€ä¸ªç½‘ç»œé”™è¯¯è¯´æ˜è·å¾—è„šæœ¬æˆ–æ ·å¼è¡¨å¤±è´¥ã€‚</li></ul><h2>ä½¿ç”¨ SRI</h2><p>é€šè¿‡ä½¿ç”¨ webpack çš„ html-webpack-plugin å’Œ webpack-subresource-integrity å¯ä»¥ç”ŸæˆåŒ…å« integrity å±æ€§ script æ ‡ç­¾ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SriPlugin <span class="keyword">from</span> <span class="string">'webpack-subresource-integrity'</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> compiler = webpack(&#123;</span><br><span class="line">    output: &#123;</span><br><span class="line">        crossOriginLoading: <span class="string">'anonymous'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> SriPlugin(&#123;</span><br><span class="line">            hashFuncNames: [<span class="string">'sha256'</span>, <span class="string">'sha384'</span>],</span><br><span class="line">            enabled: process.env.NODE_ENV === <span class="string">'production'</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆå½“ script æˆ–è€… link èµ„æº SRI æ ¡éªŒå¤±è´¥çš„æ—¶å€™åº”è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ</p><p>æ¯”è¾ƒå¥½çš„æ–¹å¼æ˜¯é€šè¿‡ script çš„ onerror äº‹ä»¶ï¼Œå½“é‡åˆ° onerror çš„æ—¶å€™é‡æ–° load é™æ€æ–‡ä»¶æœåŠ¡å™¨ä¹‹é—´çš„èµ„æºï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">"text/javascript"</span> src=<span class="string">"//11.url.cn/aaa.js"</span></span><br><span class="line">        integrity=<span class="string">"sha256-xxx sha384-yyy"</span></span><br><span class="line">        crossorigin=<span class="string">"anonymous"</span> onerror=<span class="string">"loadjs.call(this, event)"</span>&gt;&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><p>loadjs:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadjs</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ä¸ŠæŠ¥</span></span><br><span class="line">  ...</span><br><span class="line">  <span class="comment">// é‡æ–°åŠ è½½ js</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> script = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>)</span><br><span class="line">    script.src = <span class="keyword">this</span>.src.replace(<span class="regexp">/\/\/11.src.cn/</span>, <span class="string">'https://x.y.z'</span>) <span class="comment">// æ›¿æ¢ cdn åœ°å€ä¸ºé™æ€æ–‡ä»¶æœåŠ¡å™¨åœ°å€</span></span><br><span class="line">    script.onload = resolve</span><br><span class="line">    script.onerror = reject</span><br><span class="line">    <span class="built_in">document</span>.getElementsByTagName(<span class="string">'head'</span>)[<span class="number">0</span>].appendChild(script);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ç§æ–¹å¼çš„ç¼ºç‚¹æ˜¯ç›®å‰ onerror ä¸­çš„ event å‚æ•°æ— æ³•åŒºåˆ†ç©¶ç«Ÿæ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´çš„é”™è¯¯ï¼Œå¯èƒ½æ˜¯èµ„æºä¸å­˜åœ¨ï¼Œä¹Ÿå¯èƒ½æ˜¯ SRI æ ¡éªŒå¤±è´¥ï¼Œä¸è¿‡ç›®å‰æ¥çœ‹ï¼Œé™¤éæœ‰ç»Ÿè®¡éœ€æ±‚ï¼Œæ— å·®åˆ«å¯¹å¾…å¹¶æ²¡æœ‰å¤šå¤§é—®é¢˜ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä½¿ç”¨ <a href="https://www.npmjs.com/package/script-ext-html-webpack-plugin" target="_blank" rel="noopener">script-ext-html-webpack-plugin</a> å°† onerror äº‹ä»¶æ³¨å…¥è¿›å»ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> ScriptExtHtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'script-ext-html-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(),</span><br><span class="line">    <span class="keyword">new</span> SriPlugin(&#123;</span><br><span class="line">      hashFuncNames: [<span class="string">'sha256'</span>, <span class="string">'sha384'</span>]</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="keyword">new</span> ScriptExtHtmlWebpackPlugin(&#123;</span><br><span class="line">      custom: &#123;</span><br><span class="line">        test: <span class="regexp">/.js*/</span>,</span><br><span class="line">        attribute: <span class="string">'onerror="loadjs.call(this, event)" onsuccess="loadSuccess.call(this)"'</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åå°† loadjs å’Œ loadSuccess ä¸¤ä¸ªæ–¹æ³•æ³¨å…¥åˆ° html ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ inline çš„æ–¹å¼ã€‚</p><p>è¿˜åœ¨çŸ¥ä¹ä¸Šçœ‹åˆ°ä¸€ä½å¤§ç¥å¦è¾Ÿè¹Šå¾„ï¼Œé€šè¿‡ jsonp çš„æ–¹å¼è§£å†³ CDN åŠ«æŒã€‚ä¸ªäººæ„Ÿè§‰è¿™ç§æ–¹å¼ç›®å‰èƒ½å¤Ÿå®Œç¾åº”å¯¹ CDN åŠ«æŒçš„ä¸»è¦åŸå› æ˜¯è¿è¥å•†é€šè¿‡æ–‡ä»¶ååŒ¹é…çš„æ–¹å¼è¿›è¡ŒåŠ«æŒï¼Œä½œè€…çš„æ–¹å¼å°±æ˜¯é€šè¿‡ onerror æ£€æµ‹æ‹¦æˆªï¼Œå¹¶ä¸”å»æ‰èµ„æºæ–‡ä»¶çš„ js åç¼€ä»¥åº”å¯¹ CDN åŠ«æŒã€‚</p><p><a href="https://www.zhihu.com/question/35720092" target="_blank" rel="noopener">åº”å¯¹æµé‡åŠ«æŒï¼Œå‰ç«¯èƒ½åšå“ªäº›å·¥ä½œï¼Ÿ</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;SRI ç®€ä»‹&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://developer.mozilla.org/zh-CN/docs/Web/Security/%E5%AD%90%E8%B5%84%E6%BA%90%E5%AE%8C%E6%95%B4%E6%80%A7&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;SRI&lt;/a&gt; å…¨ç§° Subresource Integrity - å­èµ„æºå®Œæ•´æ€§ï¼Œæ˜¯æŒ‡æµè§ˆå™¨é€šè¿‡éªŒè¯èµ„æºçš„å®Œæ•´æ€§ï¼ˆé€šå¸¸ä» CDN è·å–ï¼‰æ¥åˆ¤æ–­å…¶æ˜¯å¦è¢«ç¯¡æ”¹çš„å®‰å…¨ç‰¹æ€§ã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡ç»™ link æ ‡ç­¾æˆ–è€… script æ ‡ç­¾å¢åŠ  integrity å±æ€§å³å¯å¼€å¯ SRI åŠŸèƒ½ï¼Œæ¯”å¦‚ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;script&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;text/javascript&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;src&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;//s.url.cn/xxxx/xxx.js?_offline=1&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;integrity&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;sha256-mY9nzNMPPf8oL3CJss7THIEoXAC2ToW1tEX0NBhMvuw= sha384-ncIKElSEk2OR3YfjNLRSY35mzt0CUwrpNDVS//iD3dF9vxrWeZ7WPlAPJTqGkSai&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;crossorigin&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;anonymous&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;integrity å€¼åˆ†æˆä¸¤ä¸ªéƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ†æŒ‡å®šå“ˆå¸Œå€¼çš„ç”Ÿæˆç®—æ³•ï¼ˆsha256ã€sha384 åŠ sha512ï¼‰ï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯ç»è¿‡ base64 ç¼–ç çš„å®é™…å“ˆå¸Œå€¼ï¼Œä¸¤è€…ä¹‹é—´é€šè¿‡ä¸€ä¸ªçŸ­æ¨ªï¼ˆ-ï¼‰åˆ†å‰²ã€‚integrity å€¼å¯ä»¥åŒ…å«å¤šä¸ªç”±ç©ºæ ¼åˆ†éš”çš„å“ˆå¸Œå€¼ï¼Œåªè¦æ–‡ä»¶åŒ¹é…å…¶ä¸­ä»»æ„ä¸€ä¸ªå“ˆå¸Œå€¼ï¼Œå°±å¯ä»¥é€šè¿‡æ ¡éªŒå¹¶åŠ è½½è¯¥èµ„æºã€‚ä¸Šè¿°ä¾‹å­ä¸­æˆ‘ä½¿ç”¨äº† sha256 å’Œ sha384 ä¸¤å¼  hash æ–¹æ¡ˆã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="HTML" scheme="https://lz5z.com/categories/HTML/"/>
    
    
      <category term="CDN" scheme="https://lz5z.com/tags/CDN/"/>
    
      <category term="intergrity" scheme="https://lz5z.com/tags/intergrity/"/>
    
  </entry>
  
  <entry>
    <title>API ç½‘å…³ Kong</title>
    <link href="https://lz5z.com/API-Gateway-Kong/"/>
    <id>https://lz5z.com/API-Gateway-Kong/</id>
    <published>2018-10-24T21:51:14.000Z</published>
    <updated>2020-04-21T10:23:54.823Z</updated>
    
    <content type="html"><![CDATA[<h2><a href="https://konghq.com/" target="_blank" rel="noopener">Kong</a> ç®€ä»‹</h2><p>Kong æ˜¯ä¸€æ¬¾åŸºäº OpenResty çš„ API ç½‘å…³å¹³å°ï¼Œåœ¨å®¢æˆ·ç«¯å’Œï¼ˆå¾®ï¼‰æœåŠ¡ä¹‹é—´è½¬å‘ API é€šä¿¡ã€‚Kong é€šè¿‡æ’ä»¶çš„æ–¹å¼æ‰©å±•è‡ªå·±çš„åŠŸèƒ½ï¼Œå…¶ä¸­åŒ…æ‹¬èº«ä»½éªŒè¯ã€å®‰å…¨æ§åˆ¶ã€æµé‡æ§åˆ¶ã€ç†”æ–­æœºåˆ¶ã€æ—¥å¿—ã€é»‘åå•ã€API åˆ†å‘ç­‰ç­‰ä¼—å¤šåŠŸèƒ½ã€‚ä¸‹å›¾æ˜¯å®˜ç½‘ç»™å‡ºçš„ä¼ ç»Ÿé¡¹ç›®æ¶æ„å’Œä½¿ç”¨ Kong çš„æ¶æ„ï¼š</p><img src="/assets/img/kong.png" alt="kong"><p>Next-Generation API Platform for Modern Architecturesã€‚</p><a id="more"></a><p>å¯ä»¥çœ‹åˆ°ï¼Œä½¿ç”¨ Kong ä¹‹åï¼Œå†…éƒ¨æœåŠ¡å¼€å‘è€…åªéœ€è¦ focus å…·ä½“ä¸šåŠ¡çš„å®ç°ï¼Œç½‘å…³å±‚æä¾› API åˆ†å‘ã€ç®¡ç†ã€ç»´æŠ¤ç­‰åŠŸèƒ½ï¼Œå¼€å‘è€…åªéœ€è¦ç®€å•çš„é…ç½®å°±å¯ä»¥æŠŠè‡ªå·±å¼€å‘çš„æœåŠ¡å‘å¸ƒå‡ºå»ï¼ŒåŒæ—¶ç½®äºç½‘å…³çš„ä¿æŠ¤ä¹‹ä¸‹ã€‚</p><h3><a href="https://openresty.org/cn/" target="_blank" rel="noopener">OpenResty</a> ç®€ä»‹</h3><p>OpenRestyÂ® æ˜¯ä¸€ä¸ªåŸºäº Nginx ä¸ Lua çš„é«˜æ€§èƒ½ Web å¹³å°ï¼Œå…¶å†…éƒ¨é›†æˆäº†å¤§é‡ç²¾è‰¯çš„ Lua åº“ã€ç¬¬ä¸‰æ–¹æ¨¡å—ä»¥åŠå¤§å¤šæ•°çš„ä¾èµ–é¡¹ã€‚ç”¨äºæ–¹ä¾¿åœ°æ­å»ºèƒ½å¤Ÿå¤„ç†è¶…é«˜å¹¶å‘ã€æ‰©å±•æ€§æé«˜çš„åŠ¨æ€ Web åº”ç”¨ã€Web æœåŠ¡å’ŒåŠ¨æ€ç½‘å…³ã€‚</p><h3>Kong ä¸‰å¤§ç»„ä»¶</h3><ul><li>Kong Server ï¼šåŸºäº nginx çš„æœåŠ¡å™¨ï¼Œç”¨æ¥æ¥æ”¶ API è¯·æ±‚ã€‚</li><li>Apache Cassandra/<a href="https://www.postgresql.org/" target="_blank" rel="noopener">PostgreSQL</a>ï¼šç”¨æ¥å­˜å‚¨æ“ä½œæ•°æ®ï¼Œæœ¬æ–‡ä»¥ PostgreSQL ä¸ºä¾‹è¿›è¡Œè®²è§£ã€‚</li><li><a href="https://github.com/PGBI/kong-dashboard" target="_blank" rel="noopener">Kong dashboard</a>ï¼šUI ç®¡ç†å·¥å…·ã€‚</li></ul><h3>Kong ç‰¹æ€§</h3><ul><li><strong>å¯æ‰©å±•</strong>ï¼šé€šè¿‡ç®€å•åœ°æ·»åŠ æœºå™¨æ¥è¿›è¡Œæ°´å¹³æ‰©å±•ï¼Œå¯ä»¥ç”¨è¾ƒä½çš„è´Ÿè½½å¤„ç†ä»»ä½•è¯·æ±‚ã€‚</li><li><strong>æ¨¡å—åŒ–</strong>ï¼šé€šè¿‡ RESTful API å®‰è£…å’Œé…ç½®æ’ä»¶ã€‚</li><li><strong>åœ¨ä»»ä½•åŸºç¡€è®¾æ–½ä¸Šè¿è¡Œ</strong>ï¼šKong å¯ä»¥éƒ¨ç½²åœ¨äº‘ç«¯ã€æœºæˆ¿ã€æˆ–è€…æ··åˆç¯å¢ƒï¼ŒåŒ…æ‹¬å•ä¸ªæˆ–å¤šä¸ªæ•°æ®ä¸­å¿ƒã€‚</li></ul><h2>å®‰è£…ä»¥åŠä½¿ç”¨</h2><p>Kong å¯ä»¥å®‰è£…è¿è¡Œåœ¨å¤§éƒ¨åˆ† Linux åˆ†å¸ƒå¼å¹³å°å’Œ macOS ä¸Šã€‚å…¨éƒ¨å®‰è£…æ–¹å¼è¯·æŸ¥çœ‹ <a href="https://konghq.com/install/" target="_blank" rel="noopener">å®‰è£… Kong ç¤¾åŒºç‰ˆ</a>ã€‚</p><h3>macOS Homebrew</h3><p>(1) å®‰è£… Kong</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ brew tap kong/kong</span><br><span class="line">$ brew install kong</span><br></pre></td></tr></table></figure><p>(2) å‡†å¤‡æ•°æ®åº“</p><p>å®‰è£… PostgresSQLï¼Œåœ¨ Kong å¯åŠ¨ä¹‹å‰æŒ‡å®šæ•°æ®åº“å’Œç”¨æˆ·ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ CREATE USER kong; CREATE DATABASE kong OWNER kong;</span><br></pre></td></tr></table></figure><p>ç”±äºå¯¹ Postgres å¹¶ä¸ç†Ÿæ‚‰ï¼Œæˆ‘ä½¿ç”¨ GUI å·¥å…· pgAdmin4 å®Œæˆ User å’Œ Database çš„åˆ›å»ºã€‚</p><p>(3) å‡†å¤‡ kong é…ç½®æ–‡ä»¶</p><p>kong é»˜è®¤ä½¿ç”¨ <code>/etc/kong/kong.conf</code> ä½œä¸ºå¯åŠ¨çš„é…ç½®æ–‡ä»¶ï¼Œå› æ­¤æˆ‘ä»¬åœ¨ <code>/etc/kong/</code> ç›®å½•ä¸‹åˆ›å»º kong.conf æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">database = postgres</span><br><span class="line">pg_port = 5432</span><br><span class="line">pg_user = kong</span><br><span class="line">pg_password = **** <span class="comment"># å¦‚æœä½ åˆšæ‰è®¾ç½®å¯†ç çš„è¯</span></span><br></pre></td></tr></table></figure><p>å…¨éƒ¨ kong çš„é…ç½®æ–‡ä»¶ä½ å¯ä»¥æŸ¥çœ‹ <a href="https://github.com/Kong/kong/blob/master/kong.conf.default" target="_blank" rel="noopener">kong.conf.default</a>ã€‚</p><p>(4) å¯åŠ¨ kong</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ kong migrations up</span><br><span class="line">$ kong start</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ—¶å€™ kong å°±å¯åŠ¨èµ·æ¥äº†ã€‚ç„¶åæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æµ‹è¯•ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ curl -i http://localhost:8001/</span><br></pre></td></tr></table></figure><p>(5) æ›´å¤š kong çš„å‘½ä»¤</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ kong check /etc/kong/kong.conf <span class="comment"># æ£€éªŒ kong é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®</span></span><br><span class="line">$ kong migrations up [-c /etc/kong/kong.conf] <span class="comment"># é€šè¿‡é…ç½®æ–‡ä»¶å‡†å¤‡æ•°æ®å­˜å‚¨</span></span><br><span class="line">$ kong start [-c /etc/kong/kong.conf] <span class="comment"># å¯åŠ¨ kong</span></span><br><span class="line">$ kong stop </span><br><span class="line">$ kong reload</span><br></pre></td></tr></table></figure><p>(6) kong å¯åŠ¨åç›‘å¬äº† 4 ä¸ªç«¯å£</p><ul><li><strong>8000</strong>: Kong ç›‘å¬æ¥è‡ªå®¢æˆ·ç«¯çš„ HTTP è¯·æ±‚çš„ï¼Œå¹¶å°†æ­¤è¯·æ±‚è½¬å‘åˆ°ä¸Šæ¸¸æœåŠ¡ã€‚</li><li><strong>8443</strong>: ä¸ 8000 ç«¯å£ç›¸åŒï¼Œä¸è¿‡åªç›‘å¬ HTTPS è¯·æ±‚ã€‚</li><li><strong>8001</strong>: ç®¡ç†å‘˜å¯¹ Kong è¿›è¡Œé…ç½®ç®¡ç†çš„ç«¯å£ã€‚</li><li><strong>8444</strong>: ç®¡ç†å‘˜ç›‘å¬ HTTPS è¯·æ±‚çš„ç«¯å£ã€‚</li></ul><h3>Docker</h3><p>(1) åˆ›å»ºä¸€ä¸ªåä¸º kong-net çš„ network</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker network create kong-net</span><br></pre></td></tr></table></figure><p>(2) å¯åŠ¨æ•°æ®åº“ï¼ˆPostgreSQLï¼‰</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ docker run -d --name kong-database \</span><br><span class="line">              --network=kong-net \</span><br><span class="line">              -p 5432:5432 \</span><br><span class="line">              -e <span class="string">"POSTGRES_USER=kong"</span> \</span><br><span class="line">              -e <span class="string">"POSTGRES_DB=kong"</span> \</span><br><span class="line">              postgres:9.6</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ—¶å€™å‘½ä»¤è¡Œä¼šæ˜¾ç¤º <code>Unable to find image 'postgres:9.6' locally</code>ï¼Œç„¶åä¼šè‡ªåŠ¨å¸®æˆ‘ä¹°ä¸‹è½½ postgres çš„ imageã€‚</p><p>(3) å‡†å¤‡æ•°æ®åº“</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ docker run --rm \</span><br><span class="line">    --network=kong-net \</span><br><span class="line">    -e <span class="string">"KONG_DATABASE=postgres"</span> \</span><br><span class="line">    -e <span class="string">"KONG_PG_HOST=kong-database"</span> \</span><br><span class="line">    -e <span class="string">"KONG_CASSANDRA_CONTACT_POINTS=kong-database"</span> \</span><br><span class="line">    kong:latest kong migrations up</span><br></pre></td></tr></table></figure><p>(4) å¯åŠ¨ Kong</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ docker run -d --name kong \</span><br><span class="line">    --network=kong-net \</span><br><span class="line">    -e <span class="string">"KONG_DATABASE=postgres"</span> \</span><br><span class="line">    -e <span class="string">"KONG_PG_HOST=kong-database"</span> \</span><br><span class="line">    -e <span class="string">"KONG_CASSANDRA_CONTACT_POINTS=kong-database"</span> \</span><br><span class="line">    -e <span class="string">"KONG_PROXY_ACCESS_LOG=/dev/stdout"</span> \</span><br><span class="line">    -e <span class="string">"KONG_ADMIN_ACCESS_LOG=/dev/stdout"</span> \</span><br><span class="line">    -e <span class="string">"KONG_PROXY_ERROR_LOG=/dev/stderr"</span> \</span><br><span class="line">    -e <span class="string">"KONG_ADMIN_ERROR_LOG=/dev/stderr"</span> \</span><br><span class="line">    -e <span class="string">"KONG_ADMIN_LISTEN=0.0.0.0:8001, 0.0.0.0:8444 ssl"</span> \</span><br><span class="line">    -p 8000:8000 \</span><br><span class="line">    -p 8443:8443 \</span><br><span class="line">    -p 8001:8001 \</span><br><span class="line">    -p 8444:8444 \</span><br><span class="line">    kong:latest</span><br></pre></td></tr></table></figure><p>(5) ä½¿ç”¨ Kong</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ curl -i http://localhost:8001/</span><br></pre></td></tr></table></figure><p>æ›´è¯¦ç»†çš„å†…å®¹å¯ä»¥æŸ¥çœ‹ <a href="https://docs.konghq.com/0.14.x/getting-started/quickstart/" target="_blank" rel="noopener">5 åˆ†é’Ÿå¿«é€Ÿå¼€å§‹</a></p><h3>kong-dashboard</h3><p>Kong dashboard æ˜¯ä¸€ä¸ªåŸºäº node å®ç°çš„ç®¡ç† Kong ç½‘å…³è®¾ç½®çš„ GUI å·¥å…·ã€‚</p><p>ä½¿ç”¨ npmï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Install Kong Dashboard</span></span><br><span class="line">npm install -g kong-dashboard</span><br><span class="line"></span><br><span class="line"><span class="comment"># Start Kong Dashboard</span></span><br><span class="line">kong-dashboard start --kong-url http://localhost:8001</span><br><span class="line"></span><br><span class="line"><span class="comment"># Start Kong Dashboard on a custom port</span></span><br><span class="line">kong-dashboard start \</span><br><span class="line">  --kong-url http://localhost:8001 \</span><br><span class="line">  --port [port]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Start Kong Dashboard with basic auth</span></span><br><span class="line">kong-dashboard start \</span><br><span class="line">  --kong-url http://localhost:8001 \</span><br><span class="line">  --basic-auth user1=password1 user2=password2</span><br><span class="line"></span><br><span class="line"><span class="comment"># See full list of start options</span></span><br><span class="line">kong-dashboard start --<span class="built_in">help</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ Dockerï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Start Kong Dashboard</span></span><br><span class="line">docker run --rm -p 8080:8080 pgbi/kong-dashboard start --kong-url http://kong:8001</span><br><span class="line"></span><br><span class="line"><span class="comment"># Start Kong Dashboard on a custom port</span></span><br><span class="line">docker run --rm -p [port]:8080 pgbi/kong-dashboard start --kong-url http://kong:8001</span><br><span class="line"></span><br><span class="line"><span class="comment"># Start Kong Dashboard with basic auth</span></span><br><span class="line">docker run --rm -p 8080:8080 pgbi/kong-dashboard start \</span><br><span class="line">  --kong-url http://kong:8001</span><br><span class="line">  --basic-auth user1=password1 user2=password2</span><br><span class="line"></span><br><span class="line"><span class="comment"># See full list of start options</span></span><br><span class="line">docker run --rm -p 8080:8080 pgbi/kong-dashboard start --<span class="built_in">help</span></span><br></pre></td></tr></table></figure><h2>Kong ä½¿ç”¨</h2><p>æœ¬è´¨ä¸Š Kong æ˜¯ä½œç”¨äºè¯·æ±‚å’Œå“åº”ä¹‹é—´çš„ä¸€å±‚ä»£ç†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ RESTful çš„å½¢å¼ç®¡ç† APIã€‚</p><h3>æ·»åŠ ä¸€ä¸ª API</h3><p>ä½¿ç”¨ curl å‘½ä»¤è¡Œï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ curl -i -X POST \</span><br><span class="line">  --url http://localhost:8001/apis/ \</span><br><span class="line">  --data <span class="string">'name=example-api'</span> \</span><br><span class="line">  --data <span class="string">'hosts=example.com'</span> \</span><br><span class="line">  --data <span class="string">'upstream_url=https://lz5z.com'</span></span><br></pre></td></tr></table></figure><p>æˆ–è€…ä½¿ç”¨ <code>kong-dashboard</code>ï¼Œåœ¨ <a href="http://localhost:8080/#!/apis" target="_blank" rel="noopener">http://localhost:8080/#!/apis</a> ç¼–è¾‘æŸ¥çœ‹ï¼š</p><img src="/assets/img/kong-dashboard.png" alt="kong-dashboard"><p>è¿™æ—¶ï¼ŒKong å·²ç»åšå¥½äº†å¯¹ HOST æ˜¯ <a href="http://example.com" target="_blank" rel="noopener">example.com</a> çš„ api çš„ä»£ç†è¯·æ±‚ï¼Œå¹¶ä¸”å°†å…¶ä»£ç†åˆ° <a href="https://lz5z.com">https://lz5z.com</a> ä¸Šã€‚</p><pre><code class="language-sh">$ curl -i -X GET \  --url http://localhost:8000/ \  --header 'Host: example.com'</code></pre><h2>æ€»ç»“</h2><p>ä»¥ä¸Šåªæ˜¯ Kong ç®€å•çš„å®‰è£…å’Œå·¥å…·çš„ä½¿ç”¨ï¼Œç”±äºä¹‹å‰å¯¹ dockerã€PostgresSQL ç­‰å‘¨è¾¹å·¥å…·å¹¶ä¸ç†Ÿæ‚‰ï¼Œæ‰€ä»¥å­¦ä¹ èµ·æ¥éœ€è¦æ‰©å±•çš„ä¸œè¥¿æ¯”è¾ƒå¤šï¼Œæš‚æ—¶å…ˆå†™åˆ°è¿™é‡Œå§ã€‚å…³äº Kong æ’ä»¶çš„ä½¿ç”¨å·²ç»ç¼–å†™ï¼Œç”¨æˆ·æ“ä½œã€æˆæƒã€è´Ÿè½½å‡è¡¡ã€ç†”æ–­ç­‰ä¿¡æ¯ï¼Œè¿™é‡Œå…ˆåŸ‹å‘ï¼Œåé¢æœ‰æ—¶é—´å†è¡¥ä¸Šå§ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;&lt;a href=&quot;https://konghq.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Kong&lt;/a&gt; ç®€ä»‹&lt;/h2&gt;
&lt;p&gt;Kong æ˜¯ä¸€æ¬¾åŸºäº OpenResty çš„ API ç½‘å…³å¹³å°ï¼Œåœ¨å®¢æˆ·ç«¯å’Œï¼ˆå¾®ï¼‰æœåŠ¡ä¹‹é—´è½¬å‘ API é€šä¿¡ã€‚Kong é€šè¿‡æ’ä»¶çš„æ–¹å¼æ‰©å±•è‡ªå·±çš„åŠŸèƒ½ï¼Œå…¶ä¸­åŒ…æ‹¬èº«ä»½éªŒè¯ã€å®‰å…¨æ§åˆ¶ã€æµé‡æ§åˆ¶ã€ç†”æ–­æœºåˆ¶ã€æ—¥å¿—ã€é»‘åå•ã€API åˆ†å‘ç­‰ç­‰ä¼—å¤šåŠŸèƒ½ã€‚ä¸‹å›¾æ˜¯å®˜ç½‘ç»™å‡ºçš„ä¼ ç»Ÿé¡¹ç›®æ¶æ„å’Œä½¿ç”¨ Kong çš„æ¶æ„ï¼š&lt;/p&gt;
&lt;img src=&quot;/assets/img/kong.png&quot; alt=&quot;kong&quot;&gt;
&lt;p&gt;Next-Generation API Platform for Modern Architecturesã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ç½‘ç»œ" scheme="https://lz5z.com/categories/%E7%BD%91%E7%BB%9C/"/>
    
    
      <category term="Gateway" scheme="https://lz5z.com/tags/Gateway/"/>
    
      <category term="nginx" scheme="https://lz5z.com/tags/nginx/"/>
    
      <category term="lua" scheme="https://lz5z.com/tags/lua/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨ requestAnimationFrame è§£å†³æ»šåŠ¨ç‚¹åœè¯¯è§¦å’Œ scroll äº‹ä»¶å»¶è¿Ÿ</title>
    <link href="https://lz5z.com/requestAnimationFrame_to_solve_scroll_event_late/"/>
    <id>https://lz5z.com/requestAnimationFrame_to_solve_scroll_event_late/</id>
    <published>2018-10-09T13:07:37.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h2>èƒŒæ™¯</h2><p>åœ¨æ‰‹æœºç«¯ç½‘é¡µå¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°æ»šåŠ¨ç‚¹åœè¯¯è§¦çš„é—®é¢˜ï¼Œæœ€å¼€å§‹æƒ³åˆ°çš„è§£å†³åŠæ³•å°±æ˜¯åˆ¤æ–­å½“å‰é¡µé¢ï¼ˆDOMï¼‰æ˜¯å¦åœ¨æ»šåŠ¨ï¼Œå¦‚æœåœ¨æ»šåŠ¨ï¼Œå°±å–æ¶ˆç‚¹å‡»æˆ–è€…å…¶ä»–äº‹ä»¶ã€‚ä½†æ˜¯åœ¨åˆ¤æ–­é¡µé¢æ˜¯å¦åœ¨æ»šåŠ¨çš„æ—¶å€™å‡ºç°äº†ä¸€äº›é—®é¢˜ï¼Œæœ€å¸¸è§çš„å°± uiwebview scroll äº‹ä»¶å»¶è¿Ÿï¼Œå¯¼è‡´æˆ‘ä»¬æ— æ³•å‡†ç¡®åˆ¤æ–­å½“å‰é¡µé¢ï¼ˆDOMï¼‰æ˜¯å¦è¿˜åœ¨æ»šåŠ¨ã€‚äºæ˜¯æƒ³åˆ°äº†ä½¿ç”¨ requestAnimationFrame åˆ¤æ–­æŸä¸ªå…ƒç´ çš„ä½ç½®æ˜¯å¦å‘ç”Ÿå˜åŒ–æ¥æ ‡è¯†å½“å‰é¡µé¢ï¼ˆDOMï¼‰æ˜¯å¦åœ¨æ»šåŠ¨ã€‚</p><a id="more"></a><h2>å¸¸è§çš„æ»šåŠ¨ç‚¹åœè¯¯è§¦</h2><p>è¿™æ˜¯ç§»åŠ¨ç«¯çš„å‰ç«¯å¼€å‘ä¸­å®é™…é‡åˆ°çš„ä¸€ä¸ªé—®é¢˜ï¼Œå½“æˆ‘ä»¬çš„é¡µé¢å‡ºç°æ»šåŠ¨æ¡çš„æ—¶å€™ï¼Œç”¨æ‰‹æ»‘åŠ¨å±å¹•ï¼Œå±å¹•ä¸Šé¡µé¢å†…å®¹ä¼šå¿«é€Ÿæ»šåŠ¨ï¼Œä¸ä¼šå› ä¸ºæ‰‹å·²ç»ç¦»å¼€äº†å±å¹•è€Œæ»šåŠ¨åœæ­¢ã€‚å½“æˆ‘ä»¬æƒ³è¦åœæ­¢æ»šåŠ¨çš„æ—¶å€™ï¼Œè½»è½»ç‚¹å‡»å±å¹•ï¼Œè®©å±å¹•åœæ­¢ã€‚ä½†æ˜¯è¿™ä¸ªæ—¶å€™æœ‰ä¸ªé—®é¢˜ï¼Œå¦‚æœå±å¹•ä¸Šç‚¹å‡»çš„ä½ç½®æ°å¥½å¯ä»¥ç‚¹å‡»ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šè¯¯è§¦ã€‚è¿˜æœ‰ä¸€ç§å¸¸è§çš„æƒ…å†µæ˜¯ï¼Œæ»šåŠ¨å·²ç»åœæ­¢äº†ï¼Œç‚¹å‡»å±å¹•å‘ç”Ÿåœ¨å…¶ä¹‹åï¼Œä½†æ˜¯æ„Ÿè§‰åƒæ˜¯å‘ç”Ÿäº†è¯¯è§¦ã€‚</p><h3>å¸¸ç”¨çš„è§£å†³åŠæ³•</h3><p>æœ€å…ˆæƒ³åˆ°çš„è§£å†³åŠæ³•å½“ç„¶æ˜¯åŠ é”ï¼Œå½“é¡µé¢åœ¨æ»šåŠ¨çš„æ—¶å€™ï¼Œå°±ç¦æ­¢å…ƒç´ çš„ç‚¹å‡»æˆ–è€… touch äº‹ä»¶ã€‚ä½†æ˜¯è¿™é‡Œå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œæœ‰äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½æ­£ç¡®çš„è·å¾—å½“å‰é¡µé¢æ˜¯å¦æ­£åœ¨å‘ç”Ÿæ»šåŠ¨ã€‚æ¯”å¦‚åœ¨ iOS UIWebViews ä¸­, åœ¨è§†å›¾çš„æ»šåŠ¨è¿‡ç¨‹ä¸­ï¼Œscroll äº‹ä»¶ä¸ä¼šè¢«è§¦å‘ï¼›åœ¨æ»šåŠ¨ç»“æŸåï¼Œscroll æ‰ä¼šè§¦å‘ï¼Œå‚è§ <a href="https://github.com/twbs/bootstrap/issues/16202" target="_blank" rel="noopener">Bootstrap issue #16202</a> ã€‚ä¸èƒ½æ­£ç¡®è·å– scroll äº‹ä»¶å°±æ— æ³•æ­£ç¡®åˆ¤æ–­å½“å‰é¡µé¢æ˜¯å¦æ­£åœ¨æ»šåŠ¨ã€‚çœ‹èµ·æ¥æˆ‘ä»¬é™·å…¥äº†åƒµå±€ã€‚</p><h2>æ–°çš„è§£å†³æ–¹æ¡ˆ</h2><p>æˆ‘ä»¬æ”¾å¼ƒ scroll äº‹ä»¶ï¼Œä½¿ç”¨åˆ«çš„æ–¹å¼åˆ¤æ–­é¡µé¢æ˜¯å¦æ»šåŠ¨ã€‚æœ€å…ˆæƒ³åˆ°çš„å°±æ˜¯é€šè¿‡è·å–æŸä¸ªå…ƒç´ çš„ç›¸å¯¹ä½ç½®ï¼Œå¦‚æœåœ¨ä¸¤å¸§ä¹‹å†…ä½ç½®æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¸å°±è¯æ˜äº†å½“å‰é¡µé¢å·²ç»ä¸æ»šåŠ¨äº†å—ã€‚</p><h3>å¦‚ä½•åˆ¤æ–­å…ƒç´ ä½ç½®æ²¡æœ‰å‘ç”Ÿæ”¹å˜</h3><p>æˆ‘ä»¬é¦–å…ˆç»™ window ä¸Šç»‘å®š touch äº‹ä»¶ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'touchmove'</span>, <span class="keyword">this</span>.onWindowTouchMove.bind(<span class="keyword">this</span>))</span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'touchend'</span>, <span class="keyword">this</span>.onWindowTouchEnd.bind(<span class="keyword">this</span>))</span><br></pre></td></tr></table></figure><p>å¦‚æœå‘ç”Ÿ touchmoveï¼Œå°±è®¤ä¸ºç”¨æˆ·æ»‘åŠ¨äº†ï¼Œåœ¨ touchend çš„æ—¶å€™é€šè¿‡ getBoundingClientRect() è·å–å…ƒç´ ä½ç½®ï¼Œå†ä½¿ç”¨ requestAnimationFrame() åˆ¤æ–­åœ¨ä¸¤å¸§ä¹‹é—´å…ƒç´ çš„ä½ç½®æ˜¯å¦å‘ç”Ÿå˜åŒ–ï¼Œä»¥æ­¤æ¥æ ‡è¯†é¡µé¢æ»šåŠ¨æ˜¯å¦åœæ­¢ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> element = e.target</span><br><span class="line"><span class="keyword">let</span> rectObject0 = element.getBoundingClientRect()</span><br><span class="line"><span class="keyword">let</span> _this = <span class="keyword">this</span></span><br><span class="line"><span class="built_in">window</span>.cancelAnimationFrame(raf)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">step</span> (<span class="params">timestamp</span>) </span>&#123;</span><br><span class="line">    _this.scrollTime = <span class="built_in">Date</span>.now()</span><br><span class="line">    <span class="keyword">let</span> rectObject1 = element.getBoundingClientRect()</span><br><span class="line">    <span class="keyword">if</span> (rectObject0.top !== rectObject1.top) &#123;</span><br><span class="line">        rectObject0 = rectObject1</span><br><span class="line">        raf = <span class="built_in">window</span>.requestAnimationFrame(step)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        _this.isScrolling = <span class="literal">false</span></span><br><span class="line">        <span class="built_in">window</span>.cancelAnimationFrame(raf)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">raf = <span class="built_in">window</span>.requestAnimationFrame(step)</span><br></pre></td></tr></table></figure><p>å®Œæ•´ä»£ç  <a href="https://github.com/Leo555/scrolling-observer" target="_blank" rel="noopener">scrolling-observer</a>ï¼š</p><p>åŒ…å·²ç»å‘å¸ƒåœ¨ npm ä¸Šäº†ï¼Œå¯ä»¥ npm æˆ–è€… yarn ä½¿ç”¨ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ npm install scrolling-observer --save</span><br><span class="line">$ yarn add scrolling-observer</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ–¹å¼ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> scroll <span class="keyword">from</span> <span class="string">'scrolling-observer'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–</span></span><br><span class="line">scroll()</span><br><span class="line"><span class="comment">// é¡µé¢æ˜¯å¦åœ¨æ»šåŠ¨</span></span><br><span class="line"><span class="keyword">let</span> isScrolling = scroll().isScrolling</span><br><span class="line"><span class="comment">// æœ€åæ»šåŠ¨æ—¶é—´</span></span><br><span class="line"><span class="keyword">let</span> scrollTime = scroll().scrollTime</span><br><span class="line"><span class="comment">// destroy</span></span><br><span class="line">scroll().destroy()</span><br></pre></td></tr></table></figure><p>éœ€è¦ä½¿ç”¨ ssr çš„åŒå­¦è¯·æ³¨æ„ä¸è¦åœ¨ node ç«¯åˆå§‹åŒ–ï¼Œå› ä¸ºæ„é€ å‡½æ•°ä¸­ä½¿ç”¨äº† window å¯¹è±¡ã€‚</p><h2>æ€»ç»“</h2><p>ç®€å•é€šè¿‡åˆ¤æ–­ä¸¤å¸§ä¹‹é—´å…ƒç´ çš„ç›¸å¯¹ä½ç½®æ˜¯å¦å‘ç”Ÿå˜åŒ–æ¥åˆ¤æ–­é¡µé¢æ˜¯å¦æ­£åœ¨æ»šåŠ¨ã€‚ä½¿ç”¨ requestAnimationFrame å¹¶ä¸”åªåœ¨ touchend åè§¦å‘æ£€æŸ¥æœºåˆ¶ï¼Œå¯¹é¡µé¢æ€§èƒ½ä¹Ÿä¸ä¼šé€ æˆå¤ªå¤§çš„å½±å“ã€‚ç›®å‰æ¥çœ‹æ˜¯ä¸é”™çš„è§£å†³æ–¹æ¡ˆã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;èƒŒæ™¯&lt;/h2&gt;
&lt;p&gt;åœ¨æ‰‹æœºç«¯ç½‘é¡µå¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°æ»šåŠ¨ç‚¹åœè¯¯è§¦çš„é—®é¢˜ï¼Œæœ€å¼€å§‹æƒ³åˆ°çš„è§£å†³åŠæ³•å°±æ˜¯åˆ¤æ–­å½“å‰é¡µé¢ï¼ˆDOMï¼‰æ˜¯å¦åœ¨æ»šåŠ¨ï¼Œå¦‚æœåœ¨æ»šåŠ¨ï¼Œå°±å–æ¶ˆç‚¹å‡»æˆ–è€…å…¶ä»–äº‹ä»¶ã€‚ä½†æ˜¯åœ¨åˆ¤æ–­é¡µé¢æ˜¯å¦åœ¨æ»šåŠ¨çš„æ—¶å€™å‡ºç°äº†ä¸€äº›é—®é¢˜ï¼Œæœ€å¸¸è§çš„å°± uiwebview scroll äº‹ä»¶å»¶è¿Ÿï¼Œå¯¼è‡´æˆ‘ä»¬æ— æ³•å‡†ç¡®åˆ¤æ–­å½“å‰é¡µé¢ï¼ˆDOMï¼‰æ˜¯å¦è¿˜åœ¨æ»šåŠ¨ã€‚äºæ˜¯æƒ³åˆ°äº†ä½¿ç”¨ requestAnimationFrame åˆ¤æ–­æŸä¸ªå…ƒç´ çš„ä½ç½®æ˜¯å¦å‘ç”Ÿå˜åŒ–æ¥æ ‡è¯†å½“å‰é¡µé¢ï¼ˆDOMï¼‰æ˜¯å¦åœ¨æ»šåŠ¨ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="requestAnimationFrame" scheme="https://lz5z.com/tags/requestAnimationFrame/"/>
    
      <category term="touch event" scheme="https://lz5z.com/tags/touch-event/"/>
    
  </entry>
  
  <entry>
    <title>webpack4 æ–°ç‰¹æ€§</title>
    <link href="https://lz5z.com/webpack4-new/"/>
    <id>https://lz5z.com/webpack4-new/</id>
    <published>2018-09-15T17:13:58.000Z</published>
    <updated>2020-04-21T10:23:54.831Z</updated>
    
    <content type="html"><![CDATA[<p>wepack4 å‡ºæ¥å·²ç»æœ‰åŠå¹´äº†ï¼Œç›®å‰æœ€æ–°çš„ release ç‰ˆæœ¬ä¸º <a href="https://webpack.docschina.org/concepts/" target="_blank" rel="noopener">4.19.0</a>ã€‚ç”±äºä¹‹å‰é¡¹ç›®æ‰“åŒ…ä¸€ç›´å­˜åœ¨æ€§èƒ½é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä¸€ç›´å¾ˆå…³æ³¨ webpack å’Œå…¶ç¤¾åŒºçš„å‘å±•ã€‚ç›®å‰æ¥è¯´ webpack4 å·²ç»è¶‹äºç¨³å®šï¼Œå¾ˆå¤šå…³é”®çš„æ’ä»¶ä¹Ÿéƒ½æ›´æ–°äº†å¯¹ webpack4 çš„æ”¯æŒï¼›æ›´ä¸ºé‡è¦çš„æ˜¯ï¼Œwebpack4 çš„å®˜æ–¹æ–‡æ¡£ï¼ˆä¸­è‹±æ–‡ï¼‰å·²ç»å¾ˆå®Œå–„äº†ï¼Œå› æ­¤ç°åœ¨ä¸å­¦ä¹  webpack4ï¼Œæ›´å¾…ä½•æ—¶ã€‚æ ¹æ® webpack ä½œè€… Tobias Koppers çš„è¯´æ³•ï¼Œä»–ä»¬å·²ç»ç€æ‰‹å¼€å§‹å¼€å‘ webpack5 äº†ã€‚</p><p>å…³äº webpack å…¥é—¨çš„æ–‡ç« å¯ä»¥å‚è€ƒ <a href="https://lz5z.com/webpack/">webpack ä»å…¥é—¨åˆ°æ”¾å¼ƒ</a>ã€‚<br>å…³äº webpack æ€§èƒ½ä¼˜åŒ–çš„å†…å®¹å¯ä»¥å‚è€ƒ <a href="https://lz5z.com/webpack%E6%89%93%E5%8C%85%E5%8A%A0%E9%80%9F%E5%AE%9E%E6%88%98/">webpack æ‰“åŒ…ä¼˜åŒ–</a>ã€‚<br>å…³äº webpack4 å…¨éƒ¨æ–°çš„ç‰¹æ€§å¯ä»¥æŸ¥çœ‹å®˜æ–¹çš„ <a href="https://github.com/webpack/webpack/releases/tag/v4.0.0" target="_blank" rel="noopener">releases</a>ã€‚</p><a id="more"></a><h2>å­¦ä¹ å‚è€ƒ</h2><p>å­¦ä¹ ä¸€é¡¹æ–°çŸ¥è¯†æœ€å¥½èƒ½ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šï¼Œå…¶ä¸­ angular-cliã€create-react-app å’Œ vue-cli ä¸­å¯¹ webpack4 ä¸­çš„ä½¿ç”¨éƒ½æ˜¯æˆ‘ä»¬å­¦ä¹ å’Œæ¨¡ä»¿çš„å¯¹è±¡ã€‚</p><h3>å‚è€ƒ <a href="https://github.com/facebook/create-react-app" target="_blank" rel="noopener">create-react-app</a></h3><p>ä½¿ç”¨ npx åˆ›å»º react-demoï¼Œåˆ›å»ºä¹‹å <code>npm run eject</code> å°±å¯ä»¥çœ‹åˆ°å®ƒè¯¦ç»†çš„ webpack é…ç½®äº†ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ npx create-react-app react-demo</span><br><span class="line">$ <span class="built_in">cd</span> react-demo</span><br><span class="line">$ npm run eject / yarn eject</span><br></pre></td></tr></table></figure><p>ä¸è¿‡æ¯”è¾ƒé—æ†¾çš„æ˜¯æ­£å¼ç‰ˆæœ¬çš„ create-react-app æš‚æ—¶è¿˜ä¸æ”¯æŒ webpack4ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>react-scripts@2.0.0-next.3e165448</code> æ¥ä½“éªŒ webpack4 çš„ç‰¹æ€§ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="comment"># Create a new application</span></span><br><span class="line">$ npx create-react-app@next --scripts-version=2.0.0-next.3e165448 react-demo</span><br><span class="line">$ <span class="comment"># Upgrade an existing application</span></span><br><span class="line">$ yarn upgrade react-scripts@2.0.0-next.3e165448</span><br></pre></td></tr></table></figure><img src="/assets/img/create-react-app-webpack.png" alt="create-react-app-webpack"><p>å…¶ä¸­ config ç›®å½•ä¸‹çš„ä¸ webpack ç›¸å…³çš„ä¸‰ä¸ªæ–‡ä»¶æ˜¯éå¸¸å¥½çš„å­¦ä¹ å’Œå€Ÿé‰´çš„å¯¹è±¡ï¼Œå¯ä»¥è¯´é€‚åº”äºç»å¤§å¤šæ•°ä¸­å°å‹é¡¹ç›®ã€‚</p><h3>å‚è€ƒ vue-cli</h3><p><a href="https://cli.vuejs.org/zh/" target="_blank" rel="noopener">Vue CLI3</a> ç®€ç›´å¯ä»¥è¯´æ˜¯å­¦ä¹ å’Œä½¿ç”¨ vue ä¸­ä¸€ä¸ªæ— æ•Œçš„å­˜åœ¨ï¼Œå…¶ä¸­ @vue/cli-service ä¸­é›†æˆäº† webpack çš„é»˜è®¤é…ç½®ï¼Œå¸¦æ¥å¼€ç®±å³ç”¨çš„å¿«æ„Ÿï¼›ä¸è¿‡ Vue CLI æ²¡æœ‰åƒ angular-cli å’Œ create-react-app é‚£æ ·æä¾› eject å‘½ä»¤ï¼Œè€Œæ˜¯é€šè¿‡ vue.config.js è¿›è¡ŒåŒ…æ‹¬ webpack åœ¨å†…çš„å…¨å±€é…ç½®ã€‚å…¶å¯è§†åŒ–å·¥å…· <a href="https://cli.vuejs.org/zh/guide/creating-a-project.html#%E4%BD%BF%E7%94%A8%E5%9B%BE%E5%BD%A2%E5%8C%96%E7%95%8C%E9%9D%A2" target="_blank" rel="noopener">vue ui</a> ä¸­çš„ inspect å¯ä»¥æŸ¥çœ‹ webpack å‚æ•°ï¼Œéå¸¸å¼ºå¤§ã€‚</p><p>Vue CLI3 å†…éƒ¨çš„ webpack é…ç½®æ˜¯é€šè¿‡ <a href="https://github.com/mozilla-neutrino/webpack-chain" target="_blank" rel="noopener">webpack-chain</a> ç»´æŠ¤çš„ï¼Œè¿™ä¸ªåº“æä¾›äº†ä¸€ä¸ª webpack åŸå§‹é…ç½®çš„ä¸Šå±‚æŠ½è±¡ï¼Œä½¿å…¶å¯ä»¥å®šä¹‰å…·åçš„ loader è§„åˆ™å’Œå…·åæ’ä»¶ï¼Œå¹¶æœ‰æœºä¼šåœ¨åæœŸè¿›å…¥è¿™äº›è§„åˆ™å¹¶å¯¹å®ƒä»¬çš„é€‰é¡¹è¿›è¡Œä¿®æ”¹ã€‚</p><p>å¦‚æœä½ çš„é¡¹ç›®ä¹Ÿæœ‰é“¾å¼è®¿é—®ç‰¹å®šçš„ loader çš„éœ€æ±‚çš„è¯ï¼Œä¸å¦¨å‚è€ƒä¸€ä¸‹ Vue CLI3ã€‚</p><img src="/assets/img/vue-cli-webpack.png" alt="vue-cli-webpack"><p>å¦‚æœä¸å¸Œæœ›ä½¿ç”¨ webpack-chain çš„è¯ï¼Œå¯ä»¥å‚è€ƒå…¶å®ƒæ¯”è¾ƒæˆç†Ÿçš„ vue é¡¹ç›®ï¼Œæ¯”å¦‚ <a href="https://github.com/PanJiaChen/vue-element-admin/tree/master/build" target="_blank" rel="noopener">vue-element-admin</a> ä¹Ÿéå¸¸å…·æœ‰å€Ÿé‰´æ„ä¹‰ã€‚</p><h2>webpack4 å‡çº§å»ºè®®</h2><ul><li>webpack4 ä¾èµ– node ç‰ˆæœ¬ &gt;= 6.11.5ï¼Œnode4 åŠå…¶ä»¥ä¸‹ç‰ˆæœ¬å°†ä¸å†æ”¯æŒã€‚æ‰€ä»¥é¦–å…ˆéœ€è¦æ£€æŸ¥ node æ˜¯å¦éœ€è¦å‡çº§ã€‚</li><li>è¿˜éœ€è¦å®‰è£… webpack-cli åˆ° devDependencies ä¸­ã€‚</li><li>å¦‚æœæ˜¯å‡çº§ä¸€ä¸ªå·²æœ‰é¡¹ç›®çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ <code>npm outdated</code> æŸ¥çœ‹ä¸ webpack ç›¸å…³çš„ loader å’Œ plugin æ˜¯å¦éœ€è¦å‡çº§ã€‚</li><li><a href="https://github.com/webpack-contrib/extract-text-webpack-plugin" target="_blank" rel="noopener">extract-text-webpack-plugin</a> è®©ä½äº <a href="https://github.com/webpack-contrib/mini-css-extract-plugin" target="_blank" rel="noopener">mini-css-extract-plugin</a>ã€‚</li><li><a href="https://github.com/jantimon/html-webpack-plugin" target="_blank" rel="noopener">html-webpack-plugin</a> åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­å¦‚æœé‡åˆ°  <code>thrownewError('Cyclic dependency'+nodeRep)</code> çš„é”™è¯¯çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ Alpha ç‰ˆæœ¬ <code>npm i--save-dev html-webpack-plugin@next</code>ã€‚</li></ul><blockquote><p>ç”±äº webpack4 ä»¥åå¯¹ css æ¨¡å—æ”¯æŒçš„é€æ­¥å®Œå–„å’Œ commonChunk æ’ä»¶çš„ç§»é™¤ï¼Œåœ¨å¤„ç† css æ–‡ä»¶æå–çš„è®¡ç®—æ–¹å¼ä¸Šä¹Ÿåšäº†äº›è°ƒæ•´ã€‚æ‰€ä»¥ä¹‹å‰ä¸€ç›´ä½¿ç”¨çš„ extract-text-webpack-plugin ä¹Ÿå®Œæˆäº†å®ƒçš„å†å²ä½¿å‘½ï¼Œå°†è®©ä½äº mini-css-extract-pluginã€‚</p></blockquote><p>extract-text-webpack-plugin ä¼šå°† css å†…è”åœ¨ js ä¸­ï¼Œè¿™æ ·å¸¦æ¥çš„é—®é¢˜æ˜¯ï¼šcss æˆ–è€… js çš„æ”¹åŠ¨éƒ½ä¼šå½±å“æ•´ä¸ª bundle çš„ç¼“å­˜ã€‚è€Œ mini-css-extract-plugin åœ¨ code Splitting çš„æ—¶å€™ä¼šå°†åŸå…ˆå†…è”å†™åœ¨æ¯ä¸€ä¸ª js chunk bundle çš„ cssï¼Œå•ç‹¬æ‹†æˆäº†ä¸€ä¸ªä¸ª css æ–‡ä»¶ã€‚ç„¶åå†é€šè¿‡ <a href="https://github.com/NMFR/optimize-css-assets-webpack-plugin" target="_blank" rel="noopener">optimize-css-assets-webpack-plugin</a> è¿™ä¸ªæ’ä»¶å¯¹ css è¿›è¡Œå‹ç¼©å’Œä¼˜åŒ–ã€‚</p><p><span style="opacity:0.7">å¤‡æ³¨ï¼šoptimize-css-assets-webpack-plugin é»˜è®¤ä½¿ç”¨ cssnano è¿›è¡Œ css ä»£ç ä¼˜åŒ–ï¼Œä½†æ˜¯ä¹Ÿä¼šå¯¼è‡´ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚æˆ‘ä¹‹å‰é‡åˆ°çš„ z-index é‡æ–°è®¡ç®—çš„é—®é¢˜å’Œ keyframes é‡å‘½åçš„é—®é¢˜ï¼š<a href="https://lz5z.com/%E8%A7%A3%E5%86%B3webpack%E6%89%93%E5%8C%85%E5%90%8Ez-index%E9%87%8D%E6%96%B0%E8%AE%A1%E7%AE%97%E7%9A%84%E9%97%AE%E9%A2%98/">è§£å†³ webpack æ‰“åŒ…å z-index é‡æ–°è®¡ç®—çš„é—®é¢˜</a>ã€‚ </span></p><h2>webpack4 å¸¦æ¥çš„å˜åŒ–</h2><p>å¯èƒ½æ˜¯å—åˆ° <a href="http://www.css88.com/doc/parcel/" target="_blank" rel="noopener">parcel</a>ï¼ˆä¸€æ¬¾å·ç§°å¿«é€Ÿï¼Œé›¶é…ç½®çš„ Web åº”ç”¨ç¨‹åºæ‰“åŒ…å™¨ï¼‰çš„å½±å“ï¼Œwebpack4 ä¹Ÿå¼•å…¥äº†é›¶é…ç½®çš„æ¦‚å¿µï¼Œéµä»è½¯ä»¶è¡Œä¸šæ›´å…ˆè¿›çš„ã€è§„çº¦å¤§äºé…ç½®ã€çš„ç†å¿µã€‚</p><h3>æ¨¡å¼ï¼ˆmodeï¼‰</h3><p>mode æœ‰ä¸‰ä¸ªå€¼ï¼š</p><table><thead><tr><th style="text-align:left">é€‰é¡¹</th><th style="text-align:left">æè¿°</th></tr></thead><tbody><tr><td style="text-align:left">development</td><td style="text-align:left">ä¼šå°† process.env.NODE_ENV çš„å€¼è®¾ä¸º developmentã€‚å¯ç”¨ NamedChunksPlugin å’Œ NamedModulesPluginã€‚</td></tr><tr><td style="text-align:left">production</td><td style="text-align:left">ä¼šå°† process.env.NODE_ENV çš„å€¼è®¾ä¸º productionã€‚å¯ç”¨ FlagDependencyUsagePlugin, FlagIncludedChunksPlugin, ModuleConcatenationPlugin, NoEmitOnErrorsPlugin, OccurrenceOrderPlugin, SideEffectsFlagPlugin å’Œ UglifyJsPluginã€‚</td></tr><tr><td style="text-align:left">none</td><td style="text-align:left">ä¸é€‰ç”¨ä»»ä½•é»˜è®¤ä¼˜åŒ–é€‰é¡¹</td></tr></tbody></table><p>ï¼ˆ1ï¼‰å¯ä»¥åœ¨å¯åŠ¨å‘½ä»¤ååŠ å…¥å‚æ•°ä½¿ç”¨ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">  <span class="string">"dev"</span>: <span class="string">"webpack --mode development"</span>,</span><br><span class="line">  <span class="string">"build"</span>: <span class="string">"webpack --mode production"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰ä¹Ÿå¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­åŠ å…¥ mode å±æ€§ï¼š</p><ul><li>mode: development</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.development.config.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">+ mode: <span class="string">'development'</span></span><br><span class="line">- plugins: [</span><br><span class="line">-   <span class="keyword">new</span> webpack.NamedModulesPlugin(), <span class="comment">// å½“å¼€å¯ HMR çš„æ—¶å€™ä½¿ç”¨è¯¥æ’ä»¶ä¼šæ˜¾ç¤ºæ¨¡å—çš„ç›¸å¯¹è·¯å¾„</span></span><br><span class="line">-   <span class="keyword">new</span> webpack.NamedChunksPlugin(),  <span class="comment">// æ ¹æ®æ–‡ä»¶åæ¥ç”Ÿæˆç¨³å®šçš„ chunkid</span></span><br><span class="line">-   <span class="keyword">new</span> webpack.DefinePlugin(&#123; <span class="string">"process.env.NODE_ENV"</span>: <span class="built_in">JSON</span>.stringify(<span class="string">"development"</span>) &#125;) <span class="comment">// å‘ä»£ç æ³¨å…¥äº† NODE\_ENV è¿™ä¸ªç¯å¢ƒå˜é‡</span></span><br><span class="line">- ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>development æ¨¡å¼é»˜è®¤å¼€å¯äº† NamedChunksPlugin å’Œ NamedModulesPlugin æ–¹ä¾¿è°ƒè¯•ï¼Œæä¾›äº†æ›´å®Œæ•´çš„é”™è¯¯ä¿¡æ¯ï¼Œæ›´å¿«çš„é‡æ–°ç¼–è¯‘çš„é€Ÿåº¦ã€‚</p><ul><li>mode: production</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.production.config.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">+  mode: <span class="string">'production'</span>,</span><br><span class="line">-  plugins: [</span><br><span class="line">-    <span class="keyword">new</span> UglifyJsPlugin(<span class="comment">/* ... */</span>), <span class="comment">// JS ä»£ç å‹ç¼©</span></span><br><span class="line">-    <span class="keyword">new</span> webpack.optimize.ModuleConcatenationPlugin(), <span class="comment">// ä½œç”¨åŸŸæå‡(scope hoisting)ï¼Œæå‡ä»£ç åœ¨æµè§ˆå™¨ä¸­çš„æ‰§è¡Œé€Ÿåº¦</span></span><br><span class="line">-    <span class="keyword">new</span> webpack.NoEmitOnErrorsPlugin(), <span class="comment">// åœ¨ç¼–è¯‘å‡ºç°é”™è¯¯æ—¶ï¼Œè·³è¿‡è¾“å‡ºé˜¶æ®µ</span></span><br><span class="line">-    <span class="keyword">new</span> webpack.DefinePlugin(&#123; <span class="string">"process.env.NODE_ENV"</span>: <span class="built_in">JSON</span>.stringify(<span class="string">"production"</span>) &#125;)</span><br><span class="line">-  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>production æ¨¡å¼æä¾›ä»£ç å‹ç¼©å’Œä»£ç åˆ†å‰²ï¼ŒåŒæ—¶ webpack ä¹Ÿä¼šè‡ªåŠ¨è¿›è¡Œ Scopehoisting å’Œ Tree-shakingã€‚</p><p>å¯ä»¥çœ‹å‡º mode æœ¬è´¨ä¸Šæ˜¯æä¾›äº†ä¸€äº›é»˜è®¤çš„é…ç½®ï¼Œä»¥æ­¤æ¥ç®€åŒ– webpack çš„ä½¿ç”¨é—¨æ§›ã€‚</p><h2><a href="https://webpack.docschina.org/configuration/optimization/" target="_blank" rel="noopener">optimization(ä¼˜åŒ–)</a></h2><p>optimization æ˜¯ webpack4 ä¸­æœ€å¤§çš„æ”¹è¿›ï¼Œå…¶ä¸­åŒ…æ‹¬ä»£ç å‹ç¼©ï¼Œåˆ†å‰²ï¼Œä¼˜åŒ–ç­‰åŠŸèƒ½ã€‚</p><h3>ä½¿ç”¨ optimization.splitChunks è¿›è¡Œåˆ†åŒ…</h3><p>webpack4 ç§»é™¤ CommonsChunkPluginï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ä¸¤ä¸ªæ–°çš„é…ç½®é¡¹ï¼ˆoptimization.splitChunks å’Œ optimization.runtimeChunkï¼‰æ¥è¿›è¡Œåˆ†åŒ…ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹ä¸‹ create-react-app ç”Ÿæˆçš„å…³äºåˆ†åŒ…çš„é…ç½®ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> UglifyJsPlugin = <span class="built_in">require</span>(<span class="string">'uglifyjs-webpack-plugin'</span>);</span><br><span class="line"><span class="keyword">const</span> OptimizeCSSAssetsPlugin = <span class="built_in">require</span>(<span class="string">'optimize-css-assets-webpack-plugin'</span>); <span class="comment">// ç”¨æ¥å‹ç¼©ä»¥åŠä¼˜åŒ– css</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  mode: <span class="string">'production'</span>,</span><br><span class="line">  optimization: &#123;</span><br><span class="line">    minimizer: [</span><br><span class="line">      <span class="keyword">new</span> UglifyJsPlugin(&#123;</span><br><span class="line">        uglifyOptions: &#123;<span class="comment">/* ... */</span>&#125;,</span><br><span class="line">        <span class="comment">// Use multi-process parallel running to improve the build speed</span></span><br><span class="line">        <span class="comment">// Default number of concurrent runs: os.cpus().length - 1</span></span><br><span class="line">        parallel: <span class="literal">true</span>,</span><br><span class="line">        <span class="comment">// Enable file caching</span></span><br><span class="line">        cache: <span class="literal">true</span></span><br><span class="line">      &#125;),</span><br><span class="line">      <span class="keyword">new</span> OptimizeCSSAssetsPlugin(&#123; <span class="attr">cssProcessorOptions</span>: &#123; <span class="attr">safe</span>: <span class="literal">true</span> &#125; &#125;),</span><br><span class="line">    ],</span><br><span class="line">    <span class="comment">// Automatically split vendor and commons</span></span><br><span class="line">    splitChunks: &#123;</span><br><span class="line">      chunks: <span class="string">'all'</span>,</span><br><span class="line">      name: <span class="string">'vendors'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// Keep the runtime chunk seperated to enable long term caching</span></span><br><span class="line">    runtimeChunk: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨åˆ†åŒ…åŠŸèƒ½ä¸Šä¸»è¦ä½¿ç”¨ <a href="https://webpack.docschina.org/configuration/optimization/#optimization-splitchunks" target="_blank" rel="noopener">splitChunks</a> å’Œ <a href="https://webpack.docschina.org/configuration/optimization/#optimization-runtimechunk" target="_blank" rel="noopener">runtimeChunk</a> ä¸¤ä¸ªå‚æ•°ã€‚</p><h3>optimization.splitChunks</h3><p>é»˜è®¤æƒ…å†µä¸‹ splitChunks çš„é…ç½®å°±é€‚ç”¨äºå¤§å¤šæ•°ç”¨æˆ·ã€‚webpack4 å°†ä¼šæŒ‰ç…§ä»¥ä¸‹è§„åˆ™è‡ªåŠ¨è¿›è¡Œåˆ†åŒ…ï¼š</p><ul><li>æ–°çš„ chunk æ˜¯å¦è¢«åˆ†äº«æˆ–è€…æ˜¯å¦æ¥è‡ª node_modulesã€‚</li><li>æ–°çš„ chunk åœ¨å‹ç¼©å’Œ gzip å‰æ˜¯å¦å¤§äº 30kbã€‚</li><li>æŒ‰éœ€åŠ è½½ chunk çš„å¹¶å‘è¯·æ±‚æ•°é‡å°äºç­‰äº 5 ä¸ªã€‚</li><li>é¡µé¢åˆå§‹åŒ–æ—¶éœ€è¦åŠ è½½çš„ chunk å¹¶å‘æ•°é‡å°äºç­‰äº 3 ä¸ªã€‚</li></ul><p>ä¸ºäº†æ»¡è¶³åé¢ä¸¤ä¸ªæ¡ä»¶ï¼Œwebpack æœ‰å¯èƒ½å—é™äºåŒ…çš„æœ€å¤§æ•°é‡å€¼ï¼Œç”Ÿæˆçš„ä»£ç ä½“ç§¯å¾€ä¸Šå¢åŠ ã€‚</p><p>é»˜è®¤é…ç½®å¯¹åº”çš„å‚æ•°å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">optimization: &#123;</span><br><span class="line">  splitChunks: &#123;</span><br><span class="line">    chunks: <span class="string">'async'</span>,</span><br><span class="line">    minSize: <span class="number">30000</span>,</span><br><span class="line">    minChunks: <span class="number">1</span>,</span><br><span class="line">    maxAsyncRequests: <span class="number">5</span>,</span><br><span class="line">    maxInitialRequests: <span class="number">3</span>,</span><br><span class="line">    automaticNameDelimiter: <span class="string">'~'</span>, </span><br><span class="line">    name: <span class="literal">true</span>,</span><br><span class="line">    cacheGroups: &#123;</span><br><span class="line">      vendors: &#123;</span><br><span class="line">        test: <span class="regexp">/[\\/]node_modules[\\/]/</span>,</span><br><span class="line">        priority: <span class="number">-10</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="keyword">default</span>: &#123;</span><br><span class="line">        minChunks: <span class="number">2</span>,</span><br><span class="line">        priority: <span class="number">-20</span>,</span><br><span class="line">        reuseExistingChunk: <span class="literal">true</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(1) splitChunks.chunks</p><p>è¡¨ç¤ºå“ªäº› chunks ä¼šè¢«åˆ†å‰²ï¼Œå¯ä»¥æä¾›å­—ç¬¦ä¸²æˆ–è€… function ä½œä¸ºå‚æ•°ã€‚å¦‚æœä¼ å­—ç¬¦ä¸²çš„è¯ï¼Œå€¼å¯ä»¥æ˜¯ â€œallâ€ã€â€œasyncâ€ã€â€œinitialâ€ã€‚â€œallâ€ è¡¨ç¤ºæ— è®º chunk æ˜¯ async è¿˜æ˜¯ non-async éƒ½å¯ä»¥è¢«å…±äº«ã€‚</p><p>(2) splitChunks.cacheGroups</p><p>é»˜è®¤æ¨¡å¼ä¼šå°†æ‰€æœ‰æ¥è‡ª node_modules çš„æ¨¡å—åˆ†é…åˆ° ä¸€ä¸ªå« vendors çš„ç¼“å­˜ç»„ï¼›æ‰€æœ‰é‡å¤å¼•ç”¨è‡³å°‘ä¸¤æ¬¡çš„ä»£ç ï¼Œä¼šè¢«åˆ†é…åˆ° default çš„ç¼“å­˜ç»„ã€‚</p><p>ä¸€ä¸ªæ¨¡å—å¯ä»¥è¢«åˆ†é…åˆ°å¤šä¸ªç¼“å­˜ç»„ï¼Œä¼˜åŒ–ç­–ç•¥ä¼šå°†æ¨¡å—åˆ†é…è‡³è·Ÿé«˜ä¼˜å…ˆçº§åˆ«ï¼ˆpriorityï¼‰çš„ç¼“å­˜ç»„ï¼Œæˆ–è€…ä¼šåˆ†é…è‡³å¯ä»¥å½¢æˆæ›´å¤§ä½“ç§¯ä»£ç å—çš„ç»„é‡Œã€‚</p><p>é»˜è®¤æ¥è¯´ï¼Œç¼“å­˜ç»„ä¼šç»§æ‰¿ splitChunks çš„é…ç½®ã€‚æ‰€æœ‰ä¸Šé¢åˆ—å‡ºçš„é€‰æ‹©éƒ½æ˜¯å¯ä»¥ç”¨åœ¨ç¼“å­˜ç»„é‡Œçš„ï¼šchunks, minSize, minChunks, maxAsyncRequests, maxInitialRequests, nameã€‚</p><p>å¯ä»¥é€šè¿‡ <code>optimization.splitChunks.cacheGroups.default: false</code> ç¦ç”¨ default ç¼“å­˜ç»„ã€‚</p><p>å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„æ–¹å¼æå–å…¬å…±ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cacheGroups: &#123;</span><br><span class="line">  commons: &#123;</span><br><span class="line">    name: &quot;commons&quot;,</span><br><span class="line">    chunks: &quot;initial&quot;,</span><br><span class="line">    minChunks: 2</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(3) minSize: å½¢æˆä¸€ä¸ªæ–°ä»£ç å—æœ€å°çš„ä½“ç§¯ï¼Œé»˜è®¤æ˜¯ 30 kbã€‚<br>(4) minChunks: åœ¨åˆ†å‰²ä¹‹å‰ï¼Œè¿™ä¸ªä»£ç å—æœ€å°åº”è¯¥è¢«å¼•ç”¨çš„æ¬¡æ•°ï¼ˆä¿è¯ä»£ç å—å¤ç”¨æ€§ï¼Œé»˜è®¤å€¼ä¸º 1 ï¼Œå³ä¸éœ€è¦å¤šæ¬¡å¼•ç”¨ä¹Ÿå¯ä»¥è¢«åˆ†å‰²ï¼‰ã€‚<br>(5) maxInitialRequests: ä¸€ä¸ªå…¥å£æœ€å¤§çš„å¹¶è¡Œè¯·æ±‚æ•°ï¼Œé»˜è®¤æ˜¯ 3ã€‚<br>(6) maxAsyncRequests: æŒ‰éœ€åŠ è½½æ—¶å€™æœ€å¤§çš„å¹¶è¡Œè¯·æ±‚æ•°ï¼Œé»˜è®¤æ˜¯ 5ã€‚<br>(7) name: è¦æ§åˆ¶ä»£ç å—çš„å‘½åï¼Œå¯ä»¥ç”¨ name å‚æ•°æ¥é…ç½®ï¼Œå½“ä¸åŒåˆ†å‰²ä»£ç å—è¢«èµ‹äºˆç›¸åŒåç§°æ—¶å€™ï¼Œä»–ä»¬ä¼šè¢«åˆå¹¶åœ¨ä¸€èµ·ã€‚å¦‚æœèµ‹äºˆä¸€ä¸ªç¥å¥‡çš„å€¼ trueï¼Œwebpack ä¼šåŸºäºä»£ç å—å’Œç¼“å­˜ç»„çš„ key è‡ªåŠ¨é€‰æ‹©ä¸€ä¸ªåç§°ã€‚</p><h3>optimization.runtimeChunk</h3><p>webpack4 æä¾›äº† runtimeChunk èƒ½è®©æˆ‘ä»¬æ–¹ä¾¿çš„æå– manifestï¼Œä»¥å‰æˆ‘ä»¬éœ€è¦è¿™æ ·é…ç½®</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> webpack.optimize.CommonsChunkPlugin(&#123;</span><br><span class="line">  name: <span class="string">"manifest"</span>,</span><br><span class="line">  minChunks: <span class="literal">Infinity</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>webpack4 ä¸­åˆ™åªéœ€è¦</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">runtimeChunk: <span class="literal">true</span>,</span><br><span class="line"><span class="comment">// OR manifest</span></span><br><span class="line">runtimeChunk: &#123;</span><br><span class="line">  name: <span class="string">"manifest"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡ <code>optimization.runtimeChunk: true</code> é€‰é¡¹ï¼Œwebpack ä¼šæ·»åŠ ä¸€ä¸ªåªåŒ…å«è¿è¡Œæ—¶(runtime)é¢å¤–ä»£ç å—åˆ°æ¯ä¸€ä¸ªå…¥å£ã€‚<br>è¿™ä¸ªéœ€è¦çœ‹åœºæ™¯ä½¿ç”¨ï¼Œä¼šå¯¼è‡´æ¯ä¸ªå…¥å£éƒ½åŠ è½½å¤šä¸€ä»½è¿è¡Œæ—¶ä»£ç ã€‚å…¶å®æ‰“åŒ…ç”Ÿæˆçš„ runtime.js éå¸¸çš„å°ï¼Œgzip ä¹‹åä¸€èˆ¬åªæœ‰å‡  kbï¼Œä½†è¿™ä¸ªæ–‡ä»¶åˆç»å¸¸ä¼šæ”¹å˜ï¼Œå¯¼è‡´æˆ‘ä»¬æ¯æ¬¡éƒ½éœ€è¦é‡æ–°è¯·æ±‚å®ƒï¼Œå®ƒçš„ http è€—æ—¶è¿œå¤§äºå®ƒçš„æ‰§è¡Œæ—¶é—´äº†ï¼Œæ‰€ä»¥å»ºè®®ä¸è¦å°†å®ƒå•ç‹¬æ‹†åŒ…ï¼Œè€Œæ˜¯å°†å®ƒå†…è”åˆ° index.html ä¹‹ä¸­ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> ScriptExtHtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'script-ext-html-webpack-plugin'</span>) <span class="comment">// æ”¯æŒ prefetch preload</span></span><br><span class="line"><span class="comment">// æ³¨æ„ä¸€å®šè¦åœ¨ HtmlWebpackPlugin ä¹‹åå¼•ç”¨</span></span><br><span class="line"><span class="comment">// inline çš„ name å’Œ runtimeChunk çš„ name ä¿æŒä¸€è‡´</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> ScriptExtHtmlWebpackPlugin(&#123;</span><br><span class="line">  inline: <span class="regexp">/runtime..*.js$/</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3>webpack ä¸­çš„ <a href="https://webpack.docschina.org/concepts/manifest/" target="_blank" rel="noopener">runtime å’Œ manifest</a></h3><p>åœ¨ä½¿ç”¨ webpack æ„å»ºçš„åº”ç”¨ç¨‹åºä¸­ï¼Œä¸»è¦åŒ…å«ä¸‰ç§ç±»å‹çš„ä»£ç ï¼š</p><ul><li>æˆ‘ä»¬è‡ªå·±ç¼–å†™çš„ä»£ç </li><li>æºç ä¾èµ–çš„ç¬¬ä¸‰æ–¹ library æˆ–è€… â€œvendorâ€</li><li>webpack çš„ runtime å’Œ manifestï¼Œç®¡ç†æ‰€æœ‰æ¨¡å—çš„äº¤äº’</li></ul><p>runtime ä»¥åŠä¼´éšçš„ manifest æ•°æ®ï¼Œä¸»è¦æ˜¯æŒ‡ï¼šåœ¨æµè§ˆå™¨è¿è¡Œæ—¶ï¼Œwebpack ç”¨æ¥è¿æ¥æ¨¡å—åŒ–çš„åº”ç”¨ç¨‹åºçš„æ‰€æœ‰ä»£ç ã€‚</p><p>ï¼ˆ1ï¼‰runtime</p><p>åœ¨æ¨¡å—äº¤äº’æ—¶ï¼Œè¿æ¥æ¨¡å—æ‰€éœ€çš„åŠ è½½å’Œè§£æé€»è¾‘ã€‚åŒ…æ‹¬æµè§ˆå™¨ä¸­çš„å·²åŠ è½½æ¨¡å—çš„è¿æ¥ï¼Œä»¥åŠæ‡’åŠ è½½æ¨¡å—çš„æ‰§è¡Œé€»è¾‘ã€‚</p><p>ï¼ˆ2ï¼‰manifest</p><p>å½“ç¼–è¯‘å™¨(compiler)å¼€å§‹æ‰§è¡Œã€è§£æå’Œæ˜ å°„åº”ç”¨ç¨‹åºæ—¶ï¼Œå®ƒä¼šä¿ç•™æ‰€æœ‰æ¨¡å—çš„æ‘˜è¦ä¿¡æ¯ã€‚è¿™ä¸ªæ‘˜è¦çš„æ•°æ®é›†åˆç§°ä¸º â€œManifestâ€ï¼Œå½“å®Œæˆæ‰“åŒ…å¹¶å‘é€åˆ°æµè§ˆå™¨æ—¶ï¼Œåœ¨è¿è¡Œæ—¶é€šè¿‡ Manifest æ¥è§£æå’ŒåŠ è½½æ¨¡å—ã€‚</p><p>æ— è®ºé€‰æ‹©å“ªç§æ¨¡å—è¯­æ³•ï¼Œé‚£äº› import æˆ– require è¯­å¥ç°åœ¨éƒ½å·²ç»è½¬æ¢ä¸º <code>__webpack_require__</code> æ–¹æ³•ï¼Œæ­¤æ–¹æ³•æŒ‡å‘æ¨¡å—æ ‡è¯†ç¬¦(module identifier)ã€‚é€šè¿‡ä½¿ç”¨ manifest ä¸­çš„æ•°æ®ï¼Œruntime å°†èƒ½å¤ŸæŸ¥è¯¢æ¨¡å—æ ‡è¯†ç¬¦ï¼Œæ£€ç´¢å‡ºèƒŒåå¯¹åº”çš„æ¨¡å—ã€‚</p><p>å¯ä»¥ç†è§£ä¸ºåœ¨åº”ç”¨ç¨‹åºè¿è¡Œæ—¶ï¼Œç¼–è¯‘å™¨é€šè¿‡ manifest ä¸­çš„æ•°æ®æ¥æŸ¥æ‰¾ç›¸åº”çš„æ¨¡å—ï¼Œç®¡ç†æ¨¡å—çš„åŠ è½½å’Œæ‰§è¡Œã€‚</p><h3>ä¼˜åŒ–åˆ†åŒ…ç­–ç•¥</h3><p>æ ¹æ®ä¸šåŠ¡çš„å¤æ‚ç¨‹åº¦ï¼Œä¸€èˆ¬åœ¨æˆ‘ä»¬çš„ä»£ç ä¸­å­˜åœ¨ä»¥ä¸‹å‡ ç§ç±»å‹çš„ä»£ç ï¼š</p><p>åŸºç¡€ç»„ä»¶åº“ï¼šreact/vue; redux/vuex/mobx; react-router/vue-router; axios;<br>UI ç»„ä»¶åº“ï¼šAnt Design/Element;<br>å¿…è¦ç»„ä»¶/å…¬å…±ç»„ä»¶ï¼šNav; Footer; Header; å…¨å±€é…ç½®ç­‰<br>éå¿…è¦ç»„ä»¶/ä»£ç ï¼šè‡ªå·±å°è£…çš„ç»„ä»¶å’Œå‡½æ•°<br>ä½é¢‘ç»„ä»¶ï¼šå¯Œæ–‡æœ¬; Markdown-Editor; Echarts ç­‰<br>ä¸šåŠ¡ä»£ç ï¼šä¸šåŠ¡ç»„ä»¶; ä¸šåŠ¡æ¨¡å—; ä¸šåŠ¡é¡µé¢ç­‰</p><ul><li>åŸºç¡€ç±»åº“ chunk-libs</li></ul><p>å®ƒæ˜¯æ„æˆæˆ‘ä»¬é¡¹ç›®å¿…ä¸å¯å°‘çš„ä¸€äº›åŸºç¡€ç±»åº“ï¼Œæ¯”å¦‚ vue å…¨å®¶æ¡¶æˆ–è€… reat å…¨å®¶æ¡¶ï¼Œå®ƒä»¬çš„å‡çº§é¢‘ç‡éƒ½ä¸é«˜ï¼Œä½†æ¯ä¸ªé¡µé¢éƒ½éœ€è¦å®ƒä»¬ï¼Œè¿˜æœ‰ä¸€äº›å…¨å±€è¢«å…±ç”¨çš„ï¼Œä½“ç§¯ä¸å¤§çš„ç¬¬ä¸‰æ–¹åº“ä¹Ÿå¯ä»¥æ”¾åœ¨å…¶ä¸­ï¼šæ¯”å¦‚ nprogressã€js-cookieã€clipboard ç­‰ã€‚</p><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ webpack çš„ dll æŠ€æœ¯å°†è¿™äº›ä»£ç æŠ½å–ä¸ºåŠ¨æ€é“¾æ¥åº“ã€‚</p><ul><li>UI ç»„ä»¶åº“</li></ul><p>å¯ä»¥è€ƒè™‘å°† UI ç»„ä»¶åº“ä¹Ÿæ‰“åŒ…åœ¨ libs ä¸­ï¼Œä¸è¿‡ç›¸æ¯”äº chunk-libsï¼Œå®ƒçš„å‡çº§é¢‘ç‡æ›´é«˜ï¼Œå¹¶ä¸”ä½“ç§¯æ›´å¤§ï¼Œå› æ­¤å•ç‹¬æ‰“åŒ…æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚</p><ul><li>è‡ªå®šä¹‰ç»„ä»¶/å‡½æ•° chunk-commons</li></ul><p>è‡ªå®šä¹‰ç»„ä»¶å¯ä»¥é€‰æ‹©å•ç‹¬æ‰“åŒ…æˆ bundleï¼Œä¹Ÿå¯ä»¥ä¸ä¸šåŠ¡ä»£ç æ‰“åŒ…åœ¨ä¸€èµ·ï¼Œè¿˜æ˜¯è¦ç»“åˆå…·ä½“æƒ…å†µæ¥çœ‹ã€‚</p><ul><li>ä½é¢‘ç»„ä»¶</li></ul><p>ä½é¢‘ç»„ä»¶å’Œ chunk-commons æœ€å¤§çš„åŒºåˆ«æ˜¯ï¼Œå®ƒä»¬åªä¼šåœ¨ä¸€äº›ç‰¹å®šä¸šåŠ¡åœºæ™¯ä¸‹ä½¿ç”¨ï¼Œæ¯”å¦‚å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ã€js-xlsx ç­‰ã€‚webpack4 ä¼šæ ¹æ®è¿™äº›åº“çš„å¤§å°ï¼ˆ30kbï¼‰é€‰æ‹©å°†å…¶æ‰“åŒ…æˆç‹¬ç«‹çš„ bundle æˆ–è€… ç›´æ¥æ‰“åŒ…åˆ°å…·ä½“çš„é¡µé¢ bundle ä¸­ã€‚</p><ul><li>ä¸šåŠ¡ä»£ç </li></ul><p>ä¸€èˆ¬æŒ‰ç…§é¡µé¢æ¥åˆ’åˆ†æ‰“åŒ…ã€‚</p><h2><a href="https://webpack.docschina.org/api/plugins" target="_blank" rel="noopener">webpack4 plugins</a></h2><p>webpack æ’ä»¶æ˜¯ä¸€ä¸ªå…·æœ‰ apply æ–¹æ³•çš„ JavaScript å¯¹è±¡ã€‚apply å±æ€§ä¼šè¢« webpack compiler è°ƒç”¨ï¼Œå¹¶ä¸” compiler å¯¹è±¡å¯åœ¨æ•´ä¸ªç¼–è¯‘ç”Ÿå‘½å‘¨æœŸè®¿é—®ã€‚</p><ul><li>å®šä¹‰ apply æ–¹æ³•ã€‚</li><li>æŒ‡å®šä¸€ä¸ªç»‘å®šåˆ° webpack è‡ªèº«çš„äº‹ä»¶é’©å­ã€‚</li><li>ä½¿ç”¨ webpack æä¾›çš„ plugin API æ“ä½œæ„å»ºç»“æœã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> pluginName = <span class="string">'BasicPlugin'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BasicPlugin</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(options) &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  apply(compiler) &#123;</span><br><span class="line">    compiler.hooks.run.tap(pluginName, compilation =&gt; &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'webpack æ„å»ºè¿‡ç¨‹å¼€å§‹ï¼'</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨è¿™ä¸ªæ’ä»¶</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> BasicPlugin = <span class="built_in">require</span>(<span class="string">'./BasicPlugin.js'</span>)</span><br><span class="line"><span class="built_in">module</span>.export = &#123;</span><br><span class="line">  plugins:[</span><br><span class="line">    <span class="keyword">new</span> BasicPlugin(options),</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3>æ’ä»¶è¿ä½œåŸç†</h3><p>webpack åŸºäºæ’ä»¶çš„è¿è¡Œæ¨¡å¼éå¸¸å¼ºå¤§ï¼Œä¹Ÿæ˜¯å…¶èƒ½å¤Ÿè¿…é€Ÿå é¢†å¸‚åœºï¼Œç¤¾åŒºæ´»è·ƒçš„ä¸»è¦åŸå› ã€‚å¦‚æœæŠŠ webpack æ¯”ä½œæµæ°´çº¿ï¼Œæ’ä»¶å°±æ˜¯æµæ°´çº¿ä¸Šä¸€ä¸ªä¸ªå·¥äººã€‚webpack é€šè¿‡ <a href="https://github.com/webpack/tapable" target="_blank" rel="noopener">Tapable</a> æ¥ç»„ç»‡è¿™æ¡å¤æ‚çš„æµæ°´çº¿ã€‚</p><p>webpack åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ä¼šå¹¿æ’­äº‹ä»¶ï¼Œæ¯ä¸ªæ’ä»¶åªéœ€è¦ç›‘å¬å®ƒæ‰€å…³å¿ƒçš„äº‹ä»¶ï¼Œå°±èƒ½åŠ å…¥åˆ°è¿™æ¡ç”Ÿäº§çº¿ä¸­ï¼Œä»è€Œæ”¹å˜ç”Ÿäº§çº¿çš„è¿ä½œã€‚webpack ä¸­åŸºäºè§‚å¯Ÿè€…æ¨¡å¼çš„äº‹ä»¶æµæœºåˆ¶ä¿è¯äº†å…¶è¿è¡Œçš„æœ‰åºæ€§ã€‚</p><p>æ’ä»¶çš„æ ¸å¿ƒæ˜¯ä¸¤ä¸ªç»§æ‰¿äº Tapable çš„å¯¹è±¡ï¼š Compiler å’Œ Compilationï¼Œå®ƒä»¬æ˜¯è¿æ¥æ’ä»¶ä¸ webpack ä¹‹é—´çš„æ¡¥æ¢ã€‚åœ¨æ’ä»¶ä»£ç çš„ç¼–å†™ä¸­ï¼Œåªè¦æ‹¿åˆ°äº†è¿™ä¸¤ä¸ªå¯¹è±¡ï¼Œå°±å¯ä»¥å®ç°å¹¿æ’­å’Œç›‘å¬äº‹ä»¶ã€‚</p><ul><li>Compiler å¯¹è±¡åŒ…å«äº† webpack ç¯å¢ƒæ‰€æœ‰çš„çš„é…ç½®ä¿¡æ¯ï¼ŒåŒ…å« optionsï¼Œloadersï¼Œplugins è¿™äº›ä¿¡æ¯ï¼Œè¿™ä¸ªå¯¹è±¡åœ¨ webpack å¯åŠ¨æ—¶å€™è¢«å®ä¾‹åŒ–ï¼Œå®ƒæ˜¯å…¨å±€å”¯ä¸€çš„ï¼Œå¯ä»¥ç®€å•åœ°æŠŠå®ƒç†è§£ä¸º webpack å®ä¾‹ã€‚</li><li>Compilation å¯¹è±¡åŒ…å«äº†å½“å‰çš„æ¨¡å—èµ„æºã€ç¼–è¯‘ç”Ÿæˆèµ„æºã€å˜åŒ–çš„æ–‡ä»¶ç­‰ã€‚å½“ webpack ä»¥å¼€å‘æ¨¡å¼è¿è¡Œæ—¶ï¼Œæ¯å½“æ£€æµ‹åˆ°ä¸€ä¸ªæ–‡ä»¶å˜åŒ–ï¼Œä¸€æ¬¡æ–°çš„ Compilation å°†è¢«åˆ›å»ºã€‚Compilation å¯¹è±¡ä¹Ÿæä¾›äº†å¾ˆå¤šäº‹ä»¶å›è°ƒä¾›æ’ä»¶åšæ‰©å±•ã€‚é€šè¿‡ Compilation ä¹Ÿèƒ½è¯»å–åˆ° Compiler å¯¹è±¡ã€‚</li></ul><p>Compiler å’Œ Compilation çš„åŒºåˆ«åœ¨äºï¼šCompiler ä»£è¡¨äº†æ•´ä¸ª webpack ä»å¯åŠ¨åˆ°å…³é—­çš„ç”Ÿå‘½å‘¨æœŸï¼Œè€Œ Compilation åªæ˜¯ä»£è¡¨äº†ä¸€æ¬¡æ–°çš„ç¼–è¯‘ã€‚</p><h3>æ’ä»¶äº‹ä»¶æµå˜åŒ–</h3><p>webpack4 æ’ä»¶çš„ç¼–å†™æ–¹å¼ä¸ä¹‹å‰å‘ç”Ÿäº†å˜åŒ–ï¼Œä¸»è¦è¡¨ç°åœ¨ Compiler å’Œ Compilation ä¸­äº‹ä»¶ç›‘å¬å’Œå¹¿æ’­çš„è¡¨ç°å½¢å¼ã€‚</p><p>webpack3:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* å¹¿æ’­å‡ºäº‹ä»¶</span></span><br><span class="line"><span class="comment">* event-name ä¸ºäº‹ä»¶åç§°ï¼Œæ³¨æ„ä¸è¦å’Œç°æœ‰çš„äº‹ä»¶é‡å</span></span><br><span class="line"><span class="comment">* params ä¸ºé™„å¸¦çš„å‚æ•°</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">compiler.apply(<span class="string">'event-name'</span>, params);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* ç›‘å¬åç§°ä¸º event-name çš„äº‹ä»¶ï¼Œå½“ event-name äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå‡½æ•°å°±ä¼šè¢«æ‰§è¡Œã€‚</span></span><br><span class="line"><span class="comment">* åŒæ—¶å‡½æ•°ä¸­çš„ params å‚æ•°ä¸ºå¹¿æ’­äº‹ä»¶æ—¶é™„å¸¦çš„å‚æ•°ã€‚</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">compiler.plugin(<span class="string">'event-name'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">params</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// compilation.apply å’Œ compilation.plugin ä½¿ç”¨æ–¹æ³•å’Œä¸Šé¢ä¸€è‡´ã€‚</span></span><br></pre></td></tr></table></figure><p>webpack4:</p><p><a href="https://github.com/jantimon/html-webpack-plugin" target="_blank" rel="noopener">html-webpack-plugin</a> ä¸­åœ¨ compilation.hooks ä¸Šæ·»åŠ äº† htmlWebpackPluginBeforeHtmlGeneration å¯¹è±¡ï¼š</p><img src="/assets/img/webpack-plugin-hooks-2.png" alt="webpack-plugin-hooks"><p>æ¥çœ‹ä¸‹ <a href="https://github.com/jharris4/html-webpack-include-assets-plugin" target="_blank" rel="noopener">html-webpack-include-assets-plugin</a> çš„å…¼å®¹å†™æ³•ã€‚</p><img src="/assets/img/webpack-plugin-hooks.png" alt="webpack-plugin-hooks"><h2>å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://webpack.docschina.org/" target="_blank" rel="noopener">webpack</a></li><li><a href="https://mp.weixin.qq.com/s/bQvRFb3luLkvj0MEOvbsJw" target="_blank" rel="noopener">æ‰‹æ‘¸æ‰‹ï¼Œå¸¦ä½ ç”¨åˆç†çš„å§¿åŠ¿ä½¿ç”¨ webpack 4</a></li><li><a href="https://github.com/yesvods/Blog/issues/15" target="_blank" rel="noopener">æ²¡æœ‰äº†CommonsChunkPluginï¼Œå’±æ‹¿ä»€ä¹ˆæ¥åˆ†åŒ…ï¼ˆè¯‘ï¼‰</a></li><li><a href="https://segmentfault.com/a/1190000012840742" target="_blank" rel="noopener">WebpackåŸç†-ç¼–å†™Plugin</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;wepack4 å‡ºæ¥å·²ç»æœ‰åŠå¹´äº†ï¼Œç›®å‰æœ€æ–°çš„ release ç‰ˆæœ¬ä¸º &lt;a href=&quot;https://webpack.docschina.org/concepts/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;4.19.0&lt;/a&gt;ã€‚ç”±äºä¹‹å‰é¡¹ç›®æ‰“åŒ…ä¸€ç›´å­˜åœ¨æ€§èƒ½é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä¸€ç›´å¾ˆå…³æ³¨ webpack å’Œå…¶ç¤¾åŒºçš„å‘å±•ã€‚ç›®å‰æ¥è¯´ webpack4 å·²ç»è¶‹äºç¨³å®šï¼Œå¾ˆå¤šå…³é”®çš„æ’ä»¶ä¹Ÿéƒ½æ›´æ–°äº†å¯¹ webpack4 çš„æ”¯æŒï¼›æ›´ä¸ºé‡è¦çš„æ˜¯ï¼Œwebpack4 çš„å®˜æ–¹æ–‡æ¡£ï¼ˆä¸­è‹±æ–‡ï¼‰å·²ç»å¾ˆå®Œå–„äº†ï¼Œå› æ­¤ç°åœ¨ä¸å­¦ä¹  webpack4ï¼Œæ›´å¾…ä½•æ—¶ã€‚æ ¹æ® webpack ä½œè€… Tobias Koppers çš„è¯´æ³•ï¼Œä»–ä»¬å·²ç»ç€æ‰‹å¼€å§‹å¼€å‘ webpack5 äº†ã€‚&lt;/p&gt;
&lt;p&gt;å…³äº webpack å…¥é—¨çš„æ–‡ç« å¯ä»¥å‚è€ƒ &lt;a href=&quot;https://lz5z.com/webpack/&quot;&gt;webpack ä»å…¥é—¨åˆ°æ”¾å¼ƒ&lt;/a&gt;ã€‚&lt;br&gt;
å…³äº webpack æ€§èƒ½ä¼˜åŒ–çš„å†…å®¹å¯ä»¥å‚è€ƒ &lt;a href=&quot;https://lz5z.com/webpack%E6%89%93%E5%8C%85%E5%8A%A0%E9%80%9F%E5%AE%9E%E6%88%98/&quot;&gt;webpack æ‰“åŒ…ä¼˜åŒ–&lt;/a&gt;ã€‚&lt;br&gt;
å…³äº webpack4 å…¨éƒ¨æ–°çš„ç‰¹æ€§å¯ä»¥æŸ¥çœ‹å®˜æ–¹çš„ &lt;a href=&quot;https://github.com/webpack/webpack/releases/tag/v4.0.0&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;releases&lt;/a&gt;ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="webpack" scheme="https://lz5z.com/tags/webpack/"/>
    
      <category term="webpack4" scheme="https://lz5z.com/tags/webpack4/"/>
    
  </entry>
  
  <entry>
    <title>å†è§é‡‘å±±ï¼Œä½ å¥½è…¾è®¯</title>
    <link href="https://lz5z.com/GoodByeKingsoft-HelloTencent/"/>
    <id>https://lz5z.com/GoodByeKingsoft-HelloTencent/</id>
    <published>2018-08-24T10:25:35.000Z</published>
    <updated>2020-04-21T10:23:54.823Z</updated>
    
    <content type="html"><![CDATA[<h2>æœ‰ä»€ä¹ˆæ„Ÿå—</h2><p>åœ¨é‡‘å±±çš„æœ€åä¸€å¤©äº†ï¼Œä»æ˜¨å¤©æ—©ä¸Šå°±å¼€å§‹äº†åˆ’æ°´æ‘¸é±¼<img src="/assets/img/èŠ±å¼æ‘¸é±¼.jpg" alt="èŠ±å¼æ‘¸é±¼" width="100px">çš„å·¥ä½œæ¨¡å¼ï¼Œä¸»è¦æ˜¯æŠŠé¡¹ç›®çš„ä»£ç ç»“æ„ç»™å‡ ä½åŒäº‹è®²ä¸€ä¸‹ï¼Œè¿˜æœ‰ä¸€äº›æ¯”è¾ƒå®¹æ˜“è®©äººå›°æƒ‘çš„ç‚¹ï¼Œæ‰å‘ç°æˆ‘å¯¹é¡¹ç›®æ˜¯å¦‚æ­¤ç†Ÿæ‚‰ï¼Œå¤§éƒ¨åˆ†ä»£ç å¦‚æ•°å®¶çã€‚</p><p>ä» 2017 å¹´ 2 æœˆ 14 å·æƒ…äººèŠ‚å…¥èŒåˆ°æ˜å¤© 2018 å¹´ 8 æœˆ 24 æ­£å¼ç¦»èŒï¼Œå·®ä¸å¤šåœ¨è¿™é‡Œå‘†äº†ä¸€å¹´åŠçš„æ—¶é—´ï¼Œè‡ªå·±çš„è¿›æ­¥è‡ªå·±çœ‹å¾—åˆ°ï¼Œå‘¨å›´çš„åŒäº‹ä¹Ÿçœ‹å¾—åˆ°ã€‚è€å¤§æ›¾ç»å¯¹æˆ‘è¯´ï¼Œæ„Ÿè§‰å…¥èŒçš„æ—¶å€™å¯¹æˆ‘çš„è¯„çº§è¯„ä½äº†ã€‚å¬åˆ°ä»¥åå¾ˆå¼€å¿ƒï¼Œå¯èƒ½ä¸æ˜¯è¯„ä½äº†ï¼Œæ˜¯æˆ‘ç¡®å®è¿›æ­¥äº†ä¸å°‘ã€‚è·Ÿå»å¹´è¦ç¦»å¼€ OOCL çš„æ—¶å€™æ„Ÿè§‰ä¸åŒï¼Œé‚£ä¸ªæ—¶å€™æ­£å¥½èµ¶ä¸Šè¿‡å¹´å¹¶ä¸”è‡ªå·±åšçš„é¡¹ç›®æ²¡æœ‰ä¸œè¥¿å¯ä»¥åšï¼Œæ‰€ä»¥éå¸¸è½»æ¾ï¼Œèµ°ä¹‹å‰å·®ä¸å¤šå¾ˆé•¿ä¸€æ®µæ—¶é—´éƒ½åœ¨æ‘¸é±¼ã€‚è€Œè¿™æ¬¡ä»é‡‘å±±ç¦»èŒï¼Œä»æå‡ºç¦»èŒç”³è¯·åˆ°æ˜¨å¤©ï¼ŒåŸºæœ¬ä¸Šæ¯å¤©éƒ½æœ‰äº‹æƒ…è¦åšï¼Œèµ¶éœ€æ±‚ï¼Œæ”¹ Bugï¼Œæ‹›æ–°äººï¼Œè®²ä»£ç ï¼Œäº¤æ¥åŠŸèƒ½ï¼Œä¸€ç›´å¿™ä¸ªä¸åœã€‚å¯è§è‡ªå·±çš„é‡è¦æ€§æé«˜äº†ï¼Œæ‰€ä»¥éå¸¸è°¨æ…åœ°åˆå°†ä¸€äº›å¯èƒ½ç•™ä¸‹çš„é—®é¢˜æ”¹äº†åˆæ”¹ï¼Œäº‰å–ä¸ç»™åé¢çš„åŒäº‹åŸ‹å‘ã€‚</p><a id="more"></a><h2>ä¸ºä»€ä¹ˆè¦èµ°</h2><p>å½“ç„¶æ˜¯ä¸ºäº†å¤šèµšé’±å•¦ã€‚è¯´ä»€ä¹ˆä¸ªäººæå‡ï¼Œå¼€é˜”è§†é‡ï¼Œå¹´è½»å°±è¦å¤šåƒè‹¦ä¹‹ç±»çš„ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯ä¸ºäº†å½“å‰æˆ–è€…ä»¥åå¤šèµšé’±ã€‚ä»¥ä¸‰åˆ†å…´è¶£ï¼Œä¸ƒåˆ†ä¸ºäº†é’±å»å¥‹æ–—ï¼Œæˆ‘è§‰å¾— <img src="/assets/img/ojbk.jpg" alt="ojbk" style="width: 45px">ã€‚å½“ç„¶è·³æ§½ä¹Ÿæ˜¯æœ‰æˆæœ¬çš„ï¼Œç°åœ¨å·²ç»å¿«è¦ä¹æœˆä»½äº†ï¼Œè·³æ§½ç›¸å½“äºäºäº†å‡ ä¸ªæœˆçš„å¹´ç»ˆå¥–ï¼Œè€Œä¸”å»æ·±åœ³è¿˜è¦ç§Ÿæˆ¿ï¼Œæ¯å‘¨å¾€è¿”æ·±åœ³ç æµ·è¿˜è¦ä¸è²çš„è·¯è´¹ï¼Œè¿™äº›éƒ½æ˜¯ä»£ä»·ã€‚ç²—ç•¥ä¸€ç®—ï¼Œå¯èƒ½æœªæ¥å‡ ä¸ªæœˆä¼šè¿‡å¾—æ›´ç©·ã€‚å†åŠ ä¸Šä»Šå¹´æŠ•èµ„äºäº†ä¸€äº›ï¼ŒP2P æš´é›·äºäº†ä¸€äº›ï¼Œå†…æ¨å¥–é‡‘æ²¡æ‹¿åˆ°ï¼Œæˆ‘æ„Ÿè§‰ä»Šå¹´æˆ‘å°±æ˜¯è·Ÿé’±è¿‡ä¸å» ğŸ˜¢ã€‚</p><p>è™½ç„¶åœ¨åˆ«çš„å‚èƒ½æ‹¿åˆ°æ›´å¥½çš„å¾…é‡ï¼Œä½†æ˜¯é€‰æ‹©è…¾è®¯ä¸€ä¸ªæ˜¯ç¦»å®¶è¿‘ï¼Œä¸€ä¸ªæ˜¯å¤§å‚å…‰ç¯ã€‚æ‰€ä»¥å°±ç®—æ˜¯å»é•€é‡‘äº†å§ï¼Œå¸Œæœ›ä»¥åèƒ½æœ‰æ›´å¥½çš„å‘å±•ã€‚</p><p>é‡‘å±±ç»™äº†æˆ‘å¾ˆå¤šçš„æˆé•¿ï¼Œå› æ­¤å†…å¿ƒå¯¹å…¶è¿˜æ˜¯éå¸¸æ„Ÿæ¿€çš„ï¼Œå”¯ä¸€è§‰å¾—å…¬å¸æœ‰ç‚¹äºå¾…æˆ‘çš„å°±æ˜¯ç»™çš„é’±æœ‰ç‚¹å°‘ï¼Œæ¶¨è–ªä¹Ÿæ²¡æœ‰è°ˆåˆ¤ä½™åœ°ï¼Œç­‰äº†å¾ˆä¹…ç»™äº†æˆ‘ä¸€ä¸ªæ•°å­—ï¼Œå†…å¿ƒå½“ç„¶æ˜¯ä¸æ»¡æ„çš„ã€‚å› ä¸ºé‚£ä¸ªæ—¶å€™å·²ç»æœ‰çŒå¤´è”ç³»å¹¶ä¸”å¼€å‡ºæ¥è¿‘ double çš„å¾…é‡äº†ï¼Œæ‰€ä»¥å·®ä¸å¤šçŸ¥é“æ¶¨è–ªåå°±æœ‰ç¦»å¼€çš„æ„å‘äº†ã€‚ä½†æ˜¯å½“æ—¶æˆ‘ä»¬ç»„æœ‰æ–°çš„äº§å“å³å°†ä¸Šçº¿ï¼Œå¤§å®¶éƒ½å¤„äºåŠ ç­åŠ ç‚¹çš„çŠ¶æ€ï¼Œä¸ªäººè§‰å¾—é‚£ä¸ªæ—¶å€™ç¦»å¼€æœ‰äº›ä¸åšé“ï¼Œå°±æ‹–å»¶äº†å‡ ä¸ªæœˆã€‚</p><h2>é¢è¯•</h2><p>åˆ°äº”å…­æœˆä»½å¼€å§‹å‡†å¤‡ï¼Œé™†é™†ç»­ç»­é¢äº†å¤´æ¡ï¼Œé˜¿é‡Œï¼Œè…¾è®¯ã€‚å¤´æ¡æ˜¯ä¸€é¢æŒ‚ï¼Œåé¢å°±æ²¡æœ‰æ¶ˆæ¯äº†ï¼›é˜¿é‡Œéå¸¸é¡ºåˆ©ï¼Œä¸€åˆ°ä¸‰é¢éƒ½è¿‡äº†ï¼Œåæ¥æ ½åˆ° HR é¢ï¼Œå„ç§åŸå› ä¸è¯´äº†ã€‚è…¾è®¯ä¹Ÿæ˜¯ä¸€é¢æŒ‚ï¼Œä½†æ˜¯æ²¡è¿‡å¤šä¹…åˆæœ‰ç”µè¯æ‰“æ¥ï¼Œæ¢ä¸ªéƒ¨é—¨æ¥ç€é¢ï¼Œé‚£ä¸ªæ—¶å€™å·®ä¸å¤šå·²ç»ç®—æ˜¯æ‹¿åˆ°é˜¿é‡Œ offer äº†ï¼Œæƒ³ç€åæ­£é¢é¢ä¹Ÿä¸åƒäºï¼Œæ²¡æƒ³åˆ°è¿™ä¸ªå´æˆäº†æœ€ç»ˆçš„å½’å®¿ã€‚è…¾è®¯çš„éƒ¨é—¨æ˜¯ SNGï¼Œå‰å‰ååæ€»å…±é¢äº† 7 é¢ï¼Œç®€ç›´æ˜¯ä½“åŠ›åŠ³åŠ¨ï¼Œæ¯æ¬¡åŠå°æ—¶åˆ°ä¸€å°æ—¶ä¸ç­‰ï¼ŒèŠå®Œéƒ½æ˜¯å£å¹²èˆŒç‡¥ã€é¢çº¢è€³èµ¤ã€‚ä¸­é—´åˆç©¿æ’äº†ä¸€ä¸ªé˜¿é‡Œçš„éƒ¨é—¨ç»§ç»­é¢ã€‚ã€‚ã€‚ç»ˆäºåˆ°äº† 7 æœˆ 24 å·ï¼Œæ‹¿åˆ°äº†è…¾è®¯ SNG çš„ offerï¼Œæ²¡æ€ä¹ˆçŠ¹è±«å°±æ¥å—äº†ã€‚æ”¶åˆ°è…¾è®¯ offer ä¸€å‘¨å¤šä»¥åï¼Œåˆæ¥åˆ°é˜¿é‡Œçš„ç”µè¯ï¼Œæ€»ç›‘é¢ã€‚ã€‚ã€‚ï¼ˆè¿™ä¸ªæ•ˆç‡æœ‰ç‚¹ä½å•Šï¼‰</p><p>ä»Šæ—¥å¤´æ¡æ˜¯ç¬¬ä¸€æ¬¡é¢è¯•ï¼Œè€Œä¸”åªé¢äº†ä¸€é¢ï¼Œè§†é¢‘é¢è¯•åŠ åœ¨çº¿ç¬”è¯•ï¼ˆåˆ«äººçœ‹ç€ä½ å†™ä»£ç ï¼‰ï¼Œå› ä¸ºè¡¨ç°ä¸å¥½ï¼Œå·®ä¸å¤šé¢å®Œå°±çŸ¥é“æ²¡æˆäº†ã€‚ä»Šæ—¥å¤´æ¡æ¯”è¾ƒå¥½çš„æ˜¯ï¼Œé¢è¯•å‰æœ‰å£°éŸ³å¾ˆå¥½å¬çš„ hr å°å¦¹å¦¹æ‰“ç”µè¯æå‰é¢„çº¦ï¼Œé¢„çº¦åæœ‰é‚®ä»¶é€šçŸ¥ï¼Œé¢è¯•æŒ‚äº†è¿˜æœ‰å©‰æ‹’çš„é‚®ä»¶ã€‚è¿™ç‚¹æ¯”å¾ˆå¤šå¤§å‚éƒ½è¦å‹å¥½ä¸€äº›ã€‚</p><p>è…¾è®¯çš„é¢è¯•å¾ˆç»†èŠ‚ï¼Œä¸ªäººæ„Ÿè§‰æ˜¯éœ€è¦æå‰æŸ¥æ¼è¡¥ç¼ºçš„ï¼Œä» api åˆ°è®¾è®¡åˆ°åŸç†è¿˜æœ‰ç®—æ³•éƒ½æœ‰æ¶‰çŒã€‚é¢ alloyteam çš„æ—¶å€™ï¼Œé¢è¯•å®˜çš„é—®é¢˜ç§ç§éƒ½æ˜¯ â€œä½ è§‰å¾— a æ¯” b ç›¸æ¯”æ€ä¹ˆæ ·â€ï¼Œâ€œä½¿ç”¨ a æŠ€æœ¯å¼€å‘æŸæŸå¯èƒ½ä¼šé‡åˆ°ä»€ä¹ˆé—®é¢˜â€ï¼Œâ€œæŸæŸæŸä¸ºä»€ä¹ˆé€‰æ‹©è¿™æ ·çš„è®¾è®¡â€ è¿™æ ·å¾ˆå¼€æ”¾æ€§çš„é—®é¢˜ï¼Œæ„Ÿè§‰è‡ªå·±å›ç­”çš„éƒ½ä¸æ˜¯å¾ˆå¥½ã€‚åé¢é€šè¿‡åŒäº‹å’¨è¯¢é¢è¯•å®˜ï¼Œå¾—åˆ°çš„ç­”å¤æ˜¯ä»–è¿˜åœ¨è€ƒè™‘ï¼Œç„¶åå°±æ²¡æœ‰ç„¶åäº†ã€‚æ¯•ç«Ÿæ˜¯è…¾è®¯çš„æ˜æ˜Ÿç»„ï¼Œæƒ³è¿›å…¥è¿˜æ˜¯æœ‰éš¾åº¦çš„ã€‚</p><p>é˜¿é‡Œçš„é¢è¯•å·®å¼‚åŒ–æ¯”è¾ƒå¤§ï¼Œæ²¡æœ‰æ˜ç¡®çš„é£æ ¼ï¼Œæ¯ä¸ªé¢è¯•å®˜éƒ½ä¸åŒï¼Œæœ‰ä¸€ä¸ªé¢è¯•å®˜èŠå®ŒæŠ€æœ¯ä»¥ååˆè·Ÿæˆ‘ä¸€èµ·èŠäº†å¤§åŠä¸ªå°æ—¶ä¸­å›½äº’è”ç½‘ç¯å¢ƒï¼ˆä¼°è®¡æœ‰åˆ›ä¸šçš„æƒ³æ³•ï¼‰ï¼Œè¿˜æœ‰ä¸€ä¸ªé¢è¯•å®˜ä»å¤´åˆ°å°¾æ²¡é—®æŠ€æœ¯é—®é¢˜ï¼Œä¸€ç›´é—®æˆ‘ç›®å‰åšä»€ä¹ˆï¼Œå¹³æ—¶æ€ä¹ˆå­¦ä¹ ï¼Œé¡¹ç›®ä¸­é‡åˆ°äº†å“ªäº›é—®é¢˜ï¼Œåé¢åˆè¦äº†æˆ‘çš„åšå®¢ã€‚å½“ç„¶å¤§éƒ¨åˆ†é¢è¯•å®˜è¿˜æ˜¯å¸¸è§„æ€§åœ°é—®ä¸€äº›æŠ€æœ¯é—®é¢˜ï¼Œä¸è¿‡æˆ‘èƒ½å¤Ÿæ˜æ˜¾çš„æ„Ÿå—åˆ°é˜¿é‡Œçš„é¢è¯•æ°›å›´æ›´åŠ æ´»æ³¼ä¸€äº›ã€‚è¿˜æœ‰å°±æ˜¯é˜¿é‡Œçš„ HR ç»™äº†æˆ‘è¾ƒä¸ºä¸æ„‰å¿«çš„ä½“éªŒï¼Œè¿™é‡Œä¸å¤šè¯´äº†ã€‚</p><p>å…·ä½“çš„é¢è¯•é—®é¢˜æˆ‘è§‰å¾—æ²¡æœ‰å•¥å‚è€ƒæ€§ï¼Œå°±ä¸è´´äº†ã€‚</p><h2>é—æ†¾</h2><p>é—æ†¾çš„äº‹æœ‰å‡ ä»¶ï¼Œä¸€ä¸ªæ˜¯ä¹‹å‰æƒ³é‡æ„ä¸€ä¸‹å½“å‰é¡¹ç›®çš„æ‰“åŒ…ï¼Œå‡çº§ä¸€ä¸‹ webpack4 çš„ï¼Œä¸€ç›´æ²¡æœ‰æ—¶é—´ï¼Œå¸Œæœ›åé¢çš„å°ä¼™ä¼´èƒ½å¤Ÿå†æ¥å†å‰å¸®æˆ‘å®Œæˆå¿ƒæ„¿ã€‚ä¸€ä¸ªæ˜¯ç°åœ¨çš„å‰ç«¯è´Ÿè´£äººæŠ€æœ¯å¾ˆå¥½ï¼Œæ„Ÿè§‰åœ¨ä»–èº«ä¸Šè¿˜æœ‰ä¸€äº›ä¸œè¥¿å¯ä»¥å­¦ä¹ ã€‚è¿˜æœ‰ä¸€ä¸ªæ˜¯è¦ç¦»å¼€ç æµ·å®‰é€¸çš„ç¯å¢ƒå»æ·±åœ³å¥‹æ–—äº†ï¼Œç æµ·çœŸæ˜¯å¤ªé€‚åˆç”Ÿæ´»äº†ï¼Œç¯å¢ƒä¼˜é›…ï¼Œäººäººéƒ½å¾ˆéšå’Œï¼Œäº¤é€šä¹Ÿæ²¡æœ‰é‚£ä¹ˆæ‹¥æŒ¤ï¼Œè€Œæ·±åœ³ä¼šç»™äººæ— å½¢çš„å‹åŠ›ã€‚</p><h2>è…¾è®¯</h2><p>è™½ç„¶æœ€è¿‘è…¾è®¯è‚¡ä»·å¤§è·Œï¼Œä½†æ˜¯å¯¹æˆ‘ä»¬åº•å±‚å‘˜å·¥æ¥è¯´åº”è¯¥æ˜¯æ²¡æœ‰å½±å“çš„å§ã€‚æ—©å°±çŸ¥é“è…¾è®¯ä¼šæœ‰æ¯”è¾ƒè‹¦é€¼çš„åŠ ç­ï¼Œæ‰€ä»¥å†…å¿ƒä¹Ÿå¹¶ä¸æ˜¯å¾ˆæ‹…å¿ƒã€‚ç›®å‰åœ¨é‡‘å±±æˆ‘ä¹Ÿä¼šç»å¸¸æ€§çš„ç•™ä¸‹æ¥åŠ ç­ï¼Œæœ‰æ—¶å€™æ˜¯åšé¡¹ç›®ï¼Œæœ‰æ—¶å€™æ˜¯ç•™ä¸‹æ¥å­¦ä¹ ï¼Œæ‰€ä»¥å¯¹åŠ ç­ä¹Ÿæ²¡æœ‰é‚£ä¹ˆæ’æ–¥ã€‚å¯¹è¦è¿›çš„éƒ¨é—¨å…¶å®ä¹Ÿæ²¡æœ‰å¤ªå¤šçš„äº†è§£ï¼Œåé¢ç†Ÿæ‚‰äº†ä»¥åå†è¯´å§ã€‚</p><h2>æœ€å</h2><p>è¿˜æ˜¯åƒä»¥å‰ä¸€æ ·ï¼Œå¸Œæœ›æŠ€æœ¯å¿«å¿«æå‡ï¼Œmoney å¿«å¿«æ¥ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;æœ‰ä»€ä¹ˆæ„Ÿå—&lt;/h2&gt;
&lt;p&gt;åœ¨é‡‘å±±çš„æœ€åä¸€å¤©äº†ï¼Œä»æ˜¨å¤©æ—©ä¸Šå°±å¼€å§‹äº†åˆ’æ°´æ‘¸é±¼&lt;img src=&quot;/assets/img/èŠ±å¼æ‘¸é±¼.jpg&quot; alt=&quot;èŠ±å¼æ‘¸é±¼&quot; width=&quot;100px&quot;&gt;çš„å·¥ä½œæ¨¡å¼ï¼Œä¸»è¦æ˜¯æŠŠé¡¹ç›®çš„ä»£ç ç»“æ„ç»™å‡ ä½åŒäº‹è®²ä¸€ä¸‹ï¼Œè¿˜æœ‰ä¸€äº›æ¯”è¾ƒå®¹æ˜“è®©äººå›°æƒ‘çš„ç‚¹ï¼Œæ‰å‘ç°æˆ‘å¯¹é¡¹ç›®æ˜¯å¦‚æ­¤ç†Ÿæ‚‰ï¼Œå¤§éƒ¨åˆ†ä»£ç å¦‚æ•°å®¶çã€‚&lt;/p&gt;
&lt;p&gt;ä» 2017 å¹´ 2 æœˆ 14 å·æƒ…äººèŠ‚å…¥èŒåˆ°æ˜å¤© 2018 å¹´ 8 æœˆ 24 æ­£å¼ç¦»èŒï¼Œå·®ä¸å¤šåœ¨è¿™é‡Œå‘†äº†ä¸€å¹´åŠçš„æ—¶é—´ï¼Œè‡ªå·±çš„è¿›æ­¥è‡ªå·±çœ‹å¾—åˆ°ï¼Œå‘¨å›´çš„åŒäº‹ä¹Ÿçœ‹å¾—åˆ°ã€‚è€å¤§æ›¾ç»å¯¹æˆ‘è¯´ï¼Œæ„Ÿè§‰å…¥èŒçš„æ—¶å€™å¯¹æˆ‘çš„è¯„çº§è¯„ä½äº†ã€‚å¬åˆ°ä»¥åå¾ˆå¼€å¿ƒï¼Œå¯èƒ½ä¸æ˜¯è¯„ä½äº†ï¼Œæ˜¯æˆ‘ç¡®å®è¿›æ­¥äº†ä¸å°‘ã€‚è·Ÿå»å¹´è¦ç¦»å¼€ OOCL çš„æ—¶å€™æ„Ÿè§‰ä¸åŒï¼Œé‚£ä¸ªæ—¶å€™æ­£å¥½èµ¶ä¸Šè¿‡å¹´å¹¶ä¸”è‡ªå·±åšçš„é¡¹ç›®æ²¡æœ‰ä¸œè¥¿å¯ä»¥åšï¼Œæ‰€ä»¥éå¸¸è½»æ¾ï¼Œèµ°ä¹‹å‰å·®ä¸å¤šå¾ˆé•¿ä¸€æ®µæ—¶é—´éƒ½åœ¨æ‘¸é±¼ã€‚è€Œè¿™æ¬¡ä»é‡‘å±±ç¦»èŒï¼Œä»æå‡ºç¦»èŒç”³è¯·åˆ°æ˜¨å¤©ï¼ŒåŸºæœ¬ä¸Šæ¯å¤©éƒ½æœ‰äº‹æƒ…è¦åšï¼Œèµ¶éœ€æ±‚ï¼Œæ”¹ Bugï¼Œæ‹›æ–°äººï¼Œè®²ä»£ç ï¼Œäº¤æ¥åŠŸèƒ½ï¼Œä¸€ç›´å¿™ä¸ªä¸åœã€‚å¯è§è‡ªå·±çš„é‡è¦æ€§æé«˜äº†ï¼Œæ‰€ä»¥éå¸¸è°¨æ…åœ°åˆå°†ä¸€äº›å¯èƒ½ç•™ä¸‹çš„é—®é¢˜æ”¹äº†åˆæ”¹ï¼Œäº‰å–ä¸ç»™åé¢çš„åŒäº‹åŸ‹å‘ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Work" scheme="https://lz5z.com/categories/Work/"/>
    
    
      <category term="è·³æ§½" scheme="https://lz5z.com/tags/%E8%B7%B3%E6%A7%BD/"/>
    
  </entry>
  
  <entry>
    <title>Symbol</title>
    <link href="https://lz5z.com/JavaScript-Symbol/"/>
    <id>https://lz5z.com/JavaScript-Symbol/</id>
    <published>2018-07-09T21:31:49.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://lz5z.com/ES2018%E6%96%B0%E7%89%B9%E6%80%A7%E5%AD%A6%E4%B9%A0/">ES2018æ–°ç‰¹æ€§å­¦ä¹ </a> ä¸­åˆå›é¡¾åˆ°äº† symbol æ•°æ®ç±»å‹ã€‚Symbol ä½œä¸ºä¸€ç§åŸå§‹æ•°æ®ç±»å‹ï¼Œé™¤äº†å…¶ <code>Symbol.iterator</code> å±æ€§å’Œ <code>Symbol.asyncIterator</code> å±æ€§ä¸ºæ•°æ®æä¾› <code>for...of</code> å’Œ <code>for...await...of</code> è®¿é—®æœºåˆ¶å¤–ï¼Œå®ƒè¿˜æœ‰ä»€ä¹ˆåŠŸèƒ½å‘¢ï¼Ÿæˆ–è€…è¯´ï¼ŒES6 ä¸­å¢åŠ  Symbol æ•°æ®ç±»å‹ä¸»è¦é¢å¯¹ä»€ä¹ˆåœºæ™¯å‘¢ï¼Ÿ</p><h2>Symbol ç®€ä»‹</h2><p>Symbol() å‡½æ•°è¿”å› symbol ç±»å‹çš„å€¼ï¼Œè¯¥ç±»å‹å…·æœ‰é™æ€å±æ€§å’Œé™æ€æ–¹æ³•ï¼Œå¹¶ä¸”ä¸æ”¯æŒ <code>new Symbol()</code> è¯­æ³•ã€‚æ¯ä¸ªä» Symbol() å‡½æ•°ä¸­è¿”å›çš„ symbol å€¼éƒ½æ˜¯å”¯ä¸€çš„ã€‚ä¸€ä¸ª symbol å€¼èƒ½ä½œä¸ºå¯¹è±¡å±æ€§çš„æ ‡è¯†ç¬¦ï¼Œè¿™æ˜¯è¯¥æ•°æ®ç±»å‹æœ€å¤§çš„ç›®çš„ã€‚</p><a id="more"></a><h3>Symbol vs symbol</h3><ol><li>Symbol æ˜¯ä¸€ä¸ªä¸æ”¯æŒ new æ“ä½œç¬¦çš„å‡½æ•°ï¼Œç”¨äºåˆ›å»º symbol ç±»å‹çš„å€¼ã€‚</li><li>symbol æ˜¯ä¸€ç§åŸºæœ¬æ•°æ®ç±»å‹ã€‚ç›®å‰ JavaScript æ”¯æŒçš„ 7 ç§æ•°æ®ç±»å‹æ˜¯ï¼šundefinedã€nullã€Booleanã€Stringã€Numberã€Objectã€symbolã€‚</li></ol><h2>Symbol ä½¿ç”¨</h2><p>æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ Symbol() å‡½æ•°åˆ›å»º symbol ç±»å‹ï¼Œå¹¶ä¸”ç”¨ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå…¶æè¿°ï¼Œæ¯æ¬¡éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ symbol ç±»å‹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="built_in">Symbol</span>()</span><br><span class="line"><span class="keyword">typeof</span> a <span class="comment">// 'symbol'</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(a) <span class="comment">// '[object Symbol]'</span></span><br><span class="line"><span class="keyword">let</span> a1 = <span class="built_in">Symbol</span>(<span class="string">'a'</span>)</span><br><span class="line"><span class="keyword">let</span> a2 = <span class="built_in">Symbol</span>(<span class="string">'a'</span>)</span><br><span class="line">a1 == a2 <span class="comment">// false</span></span><br><span class="line">a1 === a2 <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Symbol</span>(<span class="string">'foo'</span>) === <span class="built_in">Symbol</span>(<span class="string">'foo'</span>) <span class="comment">// false</span></span><br></pre></td></tr></table></figure><p>Symbol() å‡½æ•°ä¸èƒ½ä½¿ç”¨ new æ“ä½œç¬¦ã€‚å› ä¸º JavaScript ä¸­ new æ“ä½œç¬¦ç”¨æ¥åˆ›å»ºå¯¹è±¡ï¼ŒSymbol ç”Ÿæˆçš„æ˜¯ä¸€ä¸ªåŸå§‹ç±»å‹çš„å€¼ï¼Œå¹¶ä¸æ˜¯å¯¹è±¡ã€‚é€šè¿‡åŸå§‹æ•°æ®ç±»å‹åˆ›å»ºä¸€ä¸ªæ˜¾å¼åŒ…è£…å™¨å¯¹è±¡çš„æ–¹å¼ä» ECMAScript 6 å¼€å§‹ä¸å†è¢«æ”¯æŒã€‚ ç„¶è€Œç°æœ‰çš„åŸå§‹åŒ…è£…å™¨å¯¹è±¡ï¼Œå¦‚ <code>new Boolean()</code>ã€<code>new String()</code> ä»¥åŠ <code>new Number()</code> å› ä¸ºé—ç•™åŸå› ä»å¯è¢«åˆ›å»ºã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">Symbol</span>() <span class="comment">// TypeError: Symbol is not a constructor at new Symbol</span></span><br></pre></td></tr></table></figure><p>Symbol å¯ä»¥æ¥æ”¶å­—ç¬¦ä¸²æˆ–è€…å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œå¦‚æœå‚æ•°æ˜¯å¯¹è±¡çš„è¯ï¼ŒSymbol ä¼šè°ƒç”¨è¯¥å¯¹è±¡çš„ toString() æ–¹æ³•ï¼Œå°†å…¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œå†ç”Ÿæˆ symbol å€¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = &#123;</span><br><span class="line">  toString () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'abc'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> sa = <span class="built_in">Symbol</span>(a)</span><br><span class="line">sa <span class="comment">// Symbol(abc)</span></span><br></pre></td></tr></table></figure><p>Symbol å€¼ä¸èƒ½ä¸å…¶å®ƒæ•°æ®ç±»å‹çš„å€¼è¿›è¡Œè¿ç®—ï¼Œä½†æ˜¯ Symbol å€¼å¯ä»¥<strong>æ˜¾å¼è½¬æ¢</strong>ä¸ºå­—ç¬¦ä¸²æˆ–è€… Booleanï¼Œå…¶å®ƒç±»å‹çš„è½¬æ¢éƒ½ä¼šæŠ¥ TypeError é”™è¯¯ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="built_in">Symbol</span>(<span class="string">'World'</span>)</span><br><span class="line"><span class="string">'Hello '</span> + a <span class="comment">// TypeError: Cannot convert a Symbol value to a string</span></span><br><span class="line"><span class="string">`Hello <span class="subst">$&#123;a&#125;</span>`</span> <span class="comment">// TypeError: Cannot convert a Symbol value to a string  </span></span><br><span class="line">a.toString() <span class="comment">// 'Symbol(World)'</span></span><br><span class="line"><span class="built_in">String</span>(a) <span class="comment">// 'Symbol(World)'</span></span><br><span class="line"><span class="built_in">Boolean</span>(a) <span class="comment">// true</span></span><br><span class="line">!a <span class="comment">// false</span></span><br></pre></td></tr></table></figure><p>æ¯ä¸€ä¸ª Symbol å‡½æ•°ç”Ÿæˆçš„å€¼éƒ½ä¸ç›¸ç­‰ï¼Œå› æ­¤ Symbol å¯ä»¥ä½œä¸ºæ ‡è¯†ç¬¦ï¼Œå½“åšå¯¹è±¡å±æ€§åï¼Œè¿™æ ·å°±å¯ä»¥ä¿è¯ä¸ä¼šå‡ºç°ç›¸åŒçš„å±æ€§åã€‚è¿™å¯ä»¥æœ‰æ•ˆé¿å…å±æ€§è¢«è¦†ç›–ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="built_in">Symbol</span>()</span><br><span class="line"><span class="comment">// ç¬¬ä¸€ç§å†™æ³•</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123;&#125;</span><br><span class="line">obj[a] = <span class="string">'Hello'</span></span><br><span class="line"><span class="comment">// ç¬¬äºŒç§å†™æ³•</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">  [a]: <span class="string">'Hello'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ç¬¬ä¸‰ç§å†™æ³•</span></span><br><span class="line"><span class="keyword">let</span> a = &#123;&#125;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(a, mySymbol, &#123;<span class="attr">value</span>: <span class="string">'Hello'</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»¥ä¸Šå†™æ³•éƒ½å¾—åˆ°åŒæ ·ç»“æœ</span></span><br><span class="line">a[mySymbol] <span class="comment">// 'Hello'</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼ŒSymbol å€¼ä½œä¸ºå¯¹è±¡å±æ€§åæ—¶ï¼Œä¸èƒ½ç”¨ç‚¹è¿ç®—ç¬¦ï¼Œå› ä¸ºç‚¹è¿ç®—ç¬¦åé¢æ˜¯å­—ç¬¦ä¸²ï¼Œè€Œ symbol å€¼å¹¶ä¸æ˜¯å­—ç¬¦ä¸²ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="built_in">Symbol</span>()</span><br><span class="line"><span class="keyword">let</span> obj = &#123;&#125;</span><br><span class="line"></span><br><span class="line">obj.a = <span class="string">'Hello!'</span> <span class="comment">// æ­¤æ—¶ a ç›¸å½“äºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶ä¸æ˜¯ a å€¼</span></span><br><span class="line">obj[a] <span class="comment">// undefined</span></span><br><span class="line">obj[<span class="string">'a'</span>] <span class="comment">// 'Hello!'</span></span><br></pre></td></tr></table></figure><p>åœ¨å¯¹è±¡å†…éƒ¨ä½¿ç”¨ Symbol çš„æ—¶å€™ï¼Œå¿…é¡»æ”¾åœ¨æ–¹æ‹¬å·ä¸­ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="built_in">Symbol</span>()</span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">  [a]: <span class="function"><span class="keyword">function</span>(<span class="params">arg</span>)</span>&#123;...&#125;  </span><br><span class="line">&#125;</span><br><span class="line">obj[a](<span class="number">123</span>)</span><br></pre></td></tr></table></figure><h2>Symbol å±æ€§</h2><h3>Symbol.length</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Symbol</span>.length <span class="comment">// 0</span></span><br></pre></td></tr></table></figure><h3>Symbol.iterator</h3><p>è¿”å›å¯¹è±¡é»˜è®¤è¿­ä»£å™¨æ–¹æ³•ï¼Œä½¿ç”¨ <code>for...of</code> è¿›è¡Œè¿­ä»£ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> iterable = &#123;</span><br><span class="line">  [<span class="built_in">Symbol</span>.iterator]() &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      i: <span class="number">0</span>,</span><br><span class="line">      next() &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.i &lt; <span class="number">3</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> &#123; <span class="attr">value</span>: <span class="keyword">this</span>.i++, <span class="attr">done</span>: <span class="literal">false</span> &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> &#123; <span class="attr">value</span>: <span class="literal">undefined</span>, <span class="attr">done</span>: <span class="literal">true</span> &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> value <span class="keyword">of</span> iterable) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(value)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 0</span></span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="comment">// 2</span></span><br></pre></td></tr></table></figure><h3>Symbol.asyncIterator</h3><p>è¿”å›å¯¹è±¡é»˜è®¤çš„å¼‚æ­¥è¿­ä»£å™¨çš„æ–¹æ³•ï¼Œä½¿ç”¨ <code>for await of</code> è¿›è¡Œè¿­ä»£ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myAsyncIterator = &#123;</span><br><span class="line">  [<span class="built_in">Symbol</span>.asyncIterator]: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> items = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>]</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      next: <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">Promise</span>.resolve(&#123;</span><br><span class="line">        done: items.length === <span class="number">0</span>,</span><br><span class="line">        value: items.shift()</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> foo = <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> <span class="keyword">await</span> (<span class="keyword">const</span> item <span class="keyword">of</span> myAsyncIterator) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(item)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">foo()</span><br></pre></td></tr></table></figure><h3><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Symbol/match" target="_blank" rel="noopener">Symbol.match</a></h3><p>æŒ‡å®šäº†åŒ¹é…çš„æ˜¯æ­£åˆ™è¡¨è¾¾å¼è€Œä¸æ˜¯å­—ç¬¦ä¸²ã€‚<code>String.prototype.match()</code> æ–¹æ³•ä¼šè°ƒç”¨æ­¤å‡½æ•°ã€‚æ­¤å‡½æ•°è¿˜ç”¨äºæ ‡è¯†å¯¹è±¡æ˜¯å¦å…·æœ‰æ­£åˆ™è¡¨è¾¾å¼çš„è¡Œä¸ºã€‚æ¯”å¦‚ï¼š <code>String.prototype.startsWith()</code>ï¼Œ<code>String.prototype.endsWith()</code> å’Œ <code>String.prototype.includes()</code> è¿™äº›æ–¹æ³•ä¼šæ£€æŸ¥å…¶ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¦æ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼Œæ˜¯æ­£åˆ™è¡¨è¾¾å¼å°±æŠ›å‡ºä¸€ä¸ª TypeErrorã€‚ç°åœ¨ï¼Œå¦‚æœ match symbol è®¾ç½®ä¸º falseï¼ˆæˆ–è€…ä¸€ä¸ª å‡å€¼ï¼‰ï¼Œå°±è¡¨ç¤ºè¯¥å¯¹è±¡ä¸æ‰“ç®—ç”¨ä½œæ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> re = <span class="regexp">/foo/</span></span><br><span class="line">re[<span class="built_in">Symbol</span>.match] = <span class="literal">false</span></span><br><span class="line"><span class="string">'/foo/'</span>.startsWith(re) <span class="comment">// true</span></span><br><span class="line"><span class="string">'/baz/'</span>.endsWith(re)   <span class="comment">// false</span></span><br><span class="line"><span class="comment">// ä¸‹é¢ä»£ç ä¼šæŠ›å‡ºä¸€ä¸ª TypeErrorï¼š</span></span><br><span class="line"><span class="string">'/bar/'</span>.startsWith(<span class="regexp">/bar/</span>) <span class="comment">// Throws TypeError, å› ä¸º /bar/ æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ä¸” Symbol.match æ²¡æœ‰ä¿®æ”¹ã€‚</span></span><br></pre></td></tr></table></figure><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Symbol/replace" target="_blank" rel="noopener">Symbol.replace</a>ï¼Œ<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Symbol/search" target="_blank" rel="noopener">Symbol.search</a>ã€<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Symbol/split" target="_blank" rel="noopener">Symbol.split</a> ä½¿ç”¨æ–¹æ³•éƒ½ä¸ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Symbol/match" target="_blank" rel="noopener">Symbol.match</a> æ¯”è¾ƒç±»ä¼¼ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†ã€‚</p><h3><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Symbol/hasInstance" target="_blank" rel="noopener">Symbol.hasInstance</a></h3><p>ç”¨äºåˆ¤æ–­æŸå¯¹è±¡æ˜¯å¦ä¸ºæŸæ„é€ å™¨çš„å®ä¾‹ï¼Œå› æ­¤ä½ å¯ä»¥ç”¨å®ƒè‡ªå®šä¹‰ instanceof æ“ä½œç¬¦åœ¨æŸä¸ªç±»ä¸Šçš„è¡Œä¸ºã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyArray</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> [<span class="built_in">Symbol</span>.hasInstance](instance) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Array</span>.isArray(instance)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log([] <span class="keyword">instanceof</span> MyArray) <span class="comment">// true</span></span><br></pre></td></tr></table></figure><h3><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Symbol/isConcatSpreadable" target="_blank" rel="noopener">Symbol.isConcatSpreadable</a></h3><p>ç”¨äºé…ç½®æŸå¯¹è±¡ä½œä¸º <code>Array.prototype.concat()</code> æ–¹æ³•çš„å‚æ•°æ—¶æ˜¯å¦å±•å¼€å…¶æ•°ç»„å…ƒç´ ã€‚</p><p>å¯¹äºæ•°ç»„å¯¹è±¡ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œç”¨äº concat æ—¶ï¼Œä¼šæŒ‰æ•°ç»„å…ƒç´ å±•å¼€ç„¶åè¿›è¡Œè¿æ¥ï¼ˆæ•°ç»„å…ƒç´ ä½œä¸ºæ–°æ•°ç»„çš„å…ƒç´ ï¼‰ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr1 = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>]</span><br><span class="line"><span class="keyword">var</span> arr2 = numeric = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="keyword">var</span> arr3 = arr1.concat(arr2)</span><br><span class="line"><span class="built_in">console</span>.log(arr3) <span class="comment">// ç»“æœ: ['a', 'b', 'c', 1, 2, 3]</span></span><br></pre></td></tr></table></figure><p>é‡ç½® <code>Symbol.isConcatSpreadable</code> å¯ä»¥æ”¹å˜é»˜è®¤è¡Œä¸ºã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr1 = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>]</span><br><span class="line"><span class="keyword">var</span> arr2 = numeric = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">arr2[<span class="built_in">Symbol</span>.isConcatSpreadable] = <span class="literal">false</span> </span><br><span class="line"><span class="keyword">var</span> arr3 = arr1.concat(arr2)</span><br><span class="line"><span class="built_in">console</span>.log(arr3) <span class="comment">// ç»“æœ: ['a', 'b', 'c', 1, 2, 3]</span></span><br></pre></td></tr></table></figure><p>å¯¹äºç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œé»˜è®¤æ˜¯ä¸å±•å¼€çš„ï¼Œå¦‚æœæœŸæœ›ä½¿ç”¨ concat æ—¶ï¼Œå±•å¼€å…¶å…ƒç´ ç”¨äºè¿æ¥ï¼Œé‡ç½® <code>Symbol.isConcatSpreadable</code> ä¸º trueã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  [<span class="built_in">Symbol</span>.isConcatSpreadable]: <span class="literal">true</span>, </span><br><span class="line">  length: <span class="number">2</span>, </span><br><span class="line">  <span class="number">0</span>: <span class="string">'hello'</span>, </span><br><span class="line">  <span class="number">1</span>: <span class="string">'world'</span> </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">arr1.concat(obj) <span class="comment">// [1, 2, 3, 'hello', 'world']</span></span><br></pre></td></tr></table></figure><h3><a href>Symbol.unscopables</a></h3><h3><a href>Symbol.species</a></h3><h3><a href>Symbol.toPrimitive</a></h3><h3><a href>Symbol.toStringTag</a></h3><h2>Symbol æ–¹æ³•</h2><h3>Symbol.for(key)</h3><p>ä½¿ç”¨ç»™å®šçš„ key æœç´¢ç°æœ‰çš„ symbolï¼Œå¦‚æœæ‰¾åˆ°åˆ™è¿”å›è¯¥ symbolã€‚å¦åˆ™å°†ä½¿ç”¨ç»™å®šçš„ key åœ¨å…¨å±€ symbol æ³¨å†Œè¡¨ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„ symbolã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Symbol</span>.for(<span class="string">'foo'</span>) <span class="comment">// åˆ›å»ºä¸€ä¸ª symbol å¹¶æ”¾å…¥ symbol æ³¨å†Œè¡¨ä¸­ï¼Œé”®ä¸º 'foo'</span></span><br><span class="line"><span class="built_in">Symbol</span>.for(<span class="string">'foo'</span>) <span class="comment">// ä» symbol æ³¨å†Œè¡¨ä¸­è¯»å–é”®ä¸º'foo'çš„ symbol</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">Symbol</span>.for(<span class="string">'bar'</span>) === <span class="built_in">Symbol</span>.for(<span class="string">'bar'</span>) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Symbol</span>(<span class="string">'bar'</span>) === <span class="built_in">Symbol</span>(<span class="string">'bar'</span>) <span class="comment">// falseï¼ŒSymbol() å‡½æ•°æ¯æ¬¡éƒ½ä¼šè¿”å›æ–°çš„ä¸€ä¸ª symbol</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> sym = <span class="built_in">Symbol</span>.for(<span class="string">'mario'</span>)</span><br><span class="line">sym.toString() <span class="comment">// 'Symbol(mario)'ï¼Œmario æ—¢æ˜¯è¯¥ symbol åœ¨ symbol æ³¨å†Œè¡¨ä¸­çš„é”®åï¼Œåˆæ˜¯è¯¥ symbol è‡ªèº«çš„æè¿°å­—ç¬¦ä¸²</span></span><br></pre></td></tr></table></figure><h3>Symbol.keyFor(sym)</h3><p>ç”¨æ¥è·å– symbol æ³¨å†Œè¡¨ä¸­ä¸æŸä¸ª symbol å…³è”çš„é”®ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ª symbol å¹¶æ”¾å…¥ Symbol æ³¨å†Œè¡¨ï¼Œkey ä¸º 'foo'</span></span><br><span class="line"><span class="keyword">var</span> globalSym = <span class="built_in">Symbol</span>.for(<span class="string">'foo'</span>) </span><br><span class="line"><span class="built_in">Symbol</span>.keyFor(globalSym) <span class="comment">// 'foo'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ª symbolï¼Œä½†ä¸æ”¾å…¥ symbol æ³¨å†Œè¡¨ä¸­</span></span><br><span class="line"><span class="keyword">var</span> localSym = <span class="built_in">Symbol</span>()</span><br><span class="line"><span class="built_in">Symbol</span>.keyFor(localSym) <span class="comment">// undefinedï¼Œæ‰€ä»¥æ˜¯æ‰¾ä¸åˆ° key çš„</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Symbol é»˜è®¤å±æ€§å¹¶ä¸åœ¨ symbol æ³¨å†Œè¡¨ä¸­</span></span><br><span class="line"><span class="built_in">Symbol</span>.keyFor(<span class="built_in">Symbol</span>.iterator) <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure><h2>å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Symbol" target="_blank" rel="noopener">MDN-Symbol</a></li><li><a href="http://es6.ruanyifeng.com/#docs/symbol" target="_blank" rel="noopener">Symbol</a></li><li></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://lz5z.com/ES2018%E6%96%B0%E7%89%B9%E6%80%A7%E5%AD%A6%E4%B9%A0/&quot;&gt;ES2018æ–°ç‰¹æ€§å­¦ä¹ &lt;/a&gt; ä¸­åˆå›é¡¾åˆ°äº† symbol æ•°æ®ç±»å‹ã€‚Symbol ä½œä¸ºä¸€ç§åŸå§‹æ•°æ®ç±»å‹ï¼Œé™¤äº†å…¶ &lt;code&gt;Symbol.iterator&lt;/code&gt; å±æ€§å’Œ &lt;code&gt;Symbol.asyncIterator&lt;/code&gt; å±æ€§ä¸ºæ•°æ®æä¾› &lt;code&gt;for...of&lt;/code&gt; å’Œ &lt;code&gt;for...await...of&lt;/code&gt; è®¿é—®æœºåˆ¶å¤–ï¼Œå®ƒè¿˜æœ‰ä»€ä¹ˆåŠŸèƒ½å‘¢ï¼Ÿæˆ–è€…è¯´ï¼ŒES6 ä¸­å¢åŠ  Symbol æ•°æ®ç±»å‹ä¸»è¦é¢å¯¹ä»€ä¹ˆåœºæ™¯å‘¢ï¼Ÿ&lt;/p&gt;
&lt;h2&gt;Symbol ç®€ä»‹&lt;/h2&gt;
&lt;p&gt;Symbol() å‡½æ•°è¿”å› symbol ç±»å‹çš„å€¼ï¼Œè¯¥ç±»å‹å…·æœ‰é™æ€å±æ€§å’Œé™æ€æ–¹æ³•ï¼Œå¹¶ä¸”ä¸æ”¯æŒ &lt;code&gt;new Symbol()&lt;/code&gt; è¯­æ³•ã€‚æ¯ä¸ªä» Symbol() å‡½æ•°ä¸­è¿”å›çš„ symbol å€¼éƒ½æ˜¯å”¯ä¸€çš„ã€‚ä¸€ä¸ª symbol å€¼èƒ½ä½œä¸ºå¯¹è±¡å±æ€§çš„æ ‡è¯†ç¬¦ï¼Œè¿™æ˜¯è¯¥æ•°æ®ç±»å‹æœ€å¤§çš„ç›®çš„ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="Symbol" scheme="https://lz5z.com/tags/Symbol/"/>
    
  </entry>
  
  <entry>
    <title>HTTP åè®® Transfer-Encoding</title>
    <link href="https://lz5z.com/HTTP-Transfer-Encoding/"/>
    <id>https://lz5z.com/HTTP-Transfer-Encoding/</id>
    <published>2018-07-09T00:08:27.000Z</published>
    <updated>2020-04-21T10:23:54.823Z</updated>
    
    <content type="html"><![CDATA[<h2>ç®€ä»‹</h2><p>Transfer-Encoding (ä¼ è¾“ç¼–ç ) æ˜¯å¸¸è§çš„ HTTP å¤´ å­—æ®µï¼Œè¡¨ç¤ºå°†å®ä½“å®‰å…¨ä¼ é€’ç»™ç”¨æˆ·æ‰€é‡‡ç”¨çš„ç¼–ç å½¢å¼ã€‚ä¸å¦å¤–ä¸€ä¸ªæ›´ä¸ºå¸¸è§çš„ Content-Encoding ä¸åŒï¼ŒContent-Encoding è¡¨ç¤ºå†…å®¹ç¼–ç ï¼Œé€šå¸¸ç”¨äºå¯¹å®ä½“å†…å®¹è¿›è¡Œå‹ç¼©ç¼–ç ï¼Œæ¯”å¦‚ gzipï¼Œdeflate ç­‰ã€‚è€Œ Transfer-Encoding ä¸ä¼šå‡å°‘å®ä½“å†…å®¹ä¼ è¾“å¤§å°ï¼Œä½†æ˜¯ä¼šæ”¹å˜å®ä½“ä¼ è¾“çš„å½¢å¼ã€‚Content-Encoding å’Œ Transfer-Encoding äºŒè€…æ˜¯ç›¸è¾…ç›¸æˆçš„ï¼Œå¯¹äºä¸€ä¸ª HTTP æŠ¥æ–‡ï¼Œå¾ˆå¯èƒ½åŒæ—¶è¿›è¡Œäº†å†…å®¹ç¼–ç å’Œä¼ è¾“ç¼–ç ã€‚</p><p>åœ¨ HTTP è¯·æ±‚å¤´ä¸­ï¼ŒTransfer-Encoding è¢«ç§°ä¸º TEï¼Œè¡¨ç¤ºæµè§ˆå™¨é¢„æœŸæ¥å—çš„ä¼ è¾“ç¼–ç æ–¹å¼ï¼Œå¯ä½¿ç”¨ Response å¤´ Transfer-Encoding å­—æ®µä¸­çš„å€¼ï¼Œæ¯”å¦‚ chunkedï¼›å¦å¤–è¿˜å¯ç”¨ trailers è¿™ä¸ªå€¼æ¥è¡¨æ˜æµè§ˆå™¨å¸Œæœ›åœ¨æœ€åä¸€ä¸ªå¤§å°ä¸º 0 çš„å—ä¹‹åè¿˜æ¥æ”¶åˆ°ä¸€äº›é¢å¤–çš„å­—æ®µã€‚</p><a id="more"></a><h2>HTTP é•¿è¿æ¥</h2><p>HTTP/1.0 åæœŸå¼•å…¥é•¿è¿æ¥çš„æ¦‚å¿µï¼Œé€šè¿‡ <code>Connection: keep-alive</code> å®ç°ï¼ŒæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯é€šè¿‡è¿™ä¸ªå¤´éƒ¨å‘Šè¯‰å¯¹æ–¹å‘é€å®Œæ•°æ®åä¸éœ€è¦æ–­å¼€ TCP è¿æ¥ï¼Œåé¢å¯ä»¥ç»§ç»­ä½¿ç”¨ã€‚HTTP/1.1 åˆ™å°†å…¶å˜ä¸ºé»˜è®¤è§„åˆ™ï¼Œåªè¦ä¸å‘é€ <code>Connection: close</code>ï¼Œæ‰€æœ‰çš„è¿æ¥å‡ä¿æŒä¸ºé•¿è¿æ¥ã€‚</p><h3>é•¿è¿æ¥å­˜åœ¨çš„é—®é¢˜</h3><p>æŒä¹…é“¾æ¥éœ€è¦æœåŠ¡å™¨åœ¨å¼€å§‹å‘é€æ¶ˆæ¯ä½“å‰å‘é€ Content-Length æ¶ˆæ¯å¤´å­—æ®µï¼Œä½†æ˜¯å¯¹äºåŠ¨æ€ç”Ÿæˆçš„å†…å®¹æ¥è¯´ï¼Œåœ¨å†…å®¹åˆ›å»ºå®Œä¹‹å‰æ˜¯ä¸å¯çŸ¥çš„ã€‚åœ¨ <a href="https://imququ.com/post/transfer-encoding-header-in-http.html" target="_blank" rel="noopener">HTTP åè®®ä¸­çš„ Transfer-Encoding</a> è¿™ç¯‡æ–‡ç« ä¸­ï¼Œä½œè€…ä¸¾äº†ä¸¤ä¸ªä¾‹å­æ¥é˜è¿°é•¿è¿æ¥å­˜åœ¨çš„é—®é¢˜ã€‚ä½¿ç”¨ node åˆ›å»º serverã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">'net'</span>).createServer(<span class="function"><span class="keyword">function</span>(<span class="params">sock</span>) </span>&#123;</span><br><span class="line">  sock.on(<span class="string">'data'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">    sock.write(<span class="string">'HTTP/1.1 200 OK\r\n'</span>)</span><br><span class="line">    sock.write(<span class="string">'\r\n'</span>)</span><br><span class="line">    sock.write(<span class="string">'hello world!'</span>)</span><br><span class="line">    sock.destroy()</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;).listen(<span class="number">8080</span>, <span class="string">'127.0.0.1'</span>)</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>sock.destroy()</code> ï¼Œåˆ™æ¯æ¬¡å‘é€å®Œè¯·æ±‚åï¼Œå°±å…³é—­ TCP è¿æ¥ï¼Œå‡å¦‚å»æ‰ <code>sock.destroy()</code>ï¼ŒæœåŠ¡å˜æˆé•¿è¿æ¥ï¼Œä½†æ˜¯è¯·æ±‚çš„çŠ¶æ€ä¸€ç›´åœ¨ pendingï¼Œå› æ­¤æµè§ˆå™¨æ— æ³•ç¡®è®¤æ•°æ®æ˜¯å¦ä¼ è¾“å®Œæˆï¼Œåªèƒ½ä¸€ç›´ç­‰å¾…ã€‚é€šè¿‡è®¾ç½® <code>Content-Length</code> æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">'net'</span>).createServer(<span class="function"><span class="keyword">function</span>(<span class="params">sock</span>) </span>&#123;</span><br><span class="line">  sock.on(<span class="string">'data'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">    sock.write(<span class="string">'HTTP/1.1 200 OK\r\n'</span>)</span><br><span class="line">    sock.write(<span class="string">'Content-Length: 12\r\n'</span>)</span><br><span class="line">    sock.write(<span class="string">'\r\n'</span>)</span><br><span class="line">    sock.write(<span class="string">'hello world!'</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;).listen(<span class="number">8080</span>, <span class="string">'127.0.0.1'</span>)</span><br></pre></td></tr></table></figure><p>è¿™æ ·æµè§ˆå™¨èƒ½æ­£å¸¸æ¥æ”¶å“åº”æ•°æ®ï¼Œé€šè¿‡ <code>Content-Length</code> åˆ¤æ–­å®ä½“å·²ç»ç»“æŸï¼Œä½†æ˜¯å¦‚æœ <code>Content-Length</code> è®¡ç®—é”™è¯¯ä¼šå¯¼è‡´æ•°æ®å¼‚å¸¸ï¼Œå¹¶ä¸”å¯¹äºåŠ¨æ€ç”Ÿæˆçš„å†…å®¹æ¥è¯´ï¼Œåœ¨å†…å®¹åˆ›å»ºå®Œä¹‹å‰å…¶é•¿åº¦æ˜¯ä¸å¯çŸ¥çš„ã€‚</p><h2><a href="https://zh.wikipedia.org/wiki/%E5%88%86%E5%9D%97%E4%BC%A0%E8%BE%93%E7%BC%96%E7%A0%81" target="_blank" rel="noopener">Transfer-Encoding: chunked (åˆ†å—ä¼ è¾“ç¼–ç )</a></h2><p>Transfer-Encoding çš„å‡ºç°æ­£æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å¦‚æœä¸€ä¸ª HTTP æ¶ˆæ¯ï¼ˆè¯·æ±‚æ¶ˆæ¯æˆ–åº”ç­”æ¶ˆæ¯ï¼‰çš„ Transfer-Encoding æ¶ˆæ¯å¤´çš„å€¼ä¸º chunkedï¼Œé‚£ä¹ˆï¼Œæ¶ˆæ¯ä½“ç”±æ•°é‡æœªå®šçš„å—ç»„æˆï¼Œå¹¶ä»¥æœ€åä¸€ä¸ªå¤§å°ä¸º 0 çš„å—ä¸ºç»“æŸã€‚åˆ†å—ä¼ è¾“ç¼–ç åªåœ¨ HTTP/1.1 ä¸­æä¾›ã€‚</p><p>ä½¿ç”¨æ–¹å¼ä¹Ÿå¾ˆç®€å•ï¼Œåœ¨å“åº”å¤´éƒ¨åŠ ä¸Š <code>Transfer-Encoding: chunked</code> åï¼Œå°±è¡¨ç¤ºè¿™ä¸ªæŠ¥æ–‡é‡‡ç”¨åˆ†å—ç¼–ç ã€‚æ¯ä¸€ä¸ªéç©ºçš„å—éƒ½ä»¥è¯¥å—åŒ…å«æ•°æ®çš„å­—èŠ‚æ•°ï¼ˆå­—èŠ‚æ•°ä»¥åå…­è¿›åˆ¶è¡¨ç¤ºï¼‰å¼€å§‹ï¼Œè·Ÿéšä¸€ä¸ª CRLF ï¼ˆå›è½¦åŠæ¢è¡Œï¼‰ï¼Œç„¶åæ˜¯æ•°æ®æœ¬èº«ï¼Œæœ€åä»¥ä¸€ä¸ªå¤§å°ä¸º 0 çš„å— + CRLF ç»“æŸã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">'net'</span>).createServer(<span class="function"><span class="keyword">function</span>(<span class="params">sock</span>) </span>&#123;</span><br><span class="line">  sock.on(<span class="string">'data'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">    sock.write(<span class="string">'HTTP/1.1 200 OK\r\n'</span>)</span><br><span class="line">    sock.write(<span class="string">'Transfer-Encoding: chunked\r\n'</span>)</span><br><span class="line">    sock.write(<span class="string">'\r\n'</span>)</span><br><span class="line"></span><br><span class="line">    sock.write(<span class="string">'24\r\n'</span>) <span class="comment">// (36 å­—ç¬¦ =&gt; åå…­è¿›åˆ¶: 0x24)</span></span><br><span class="line">    sock.write(<span class="string">'This is the data in the first chunk \r\n'</span>)</span><br><span class="line"></span><br><span class="line">    sock.write(<span class="string">'1b\r\n'</span>) <span class="comment">// (27 å­—ç¬¦ =&gt; åå…­è¿›åˆ¶: 0x1b)</span></span><br><span class="line">    sock.write(<span class="string">'and this is the second one \r\n'</span>)</span><br><span class="line"></span><br><span class="line">    sock.write(<span class="string">'3\r\n'</span>) <span class="comment">// (3 å­—ç¬¦ =&gt; åå…­è¿›åˆ¶: 0x03)</span></span><br><span class="line">    sock.write(<span class="string">'con\r\n'</span>)</span><br><span class="line"></span><br><span class="line">    sock.write(<span class="string">'8\r\n'</span>) <span class="comment">// (8 å­—ç¬¦ =&gt; åå…­è¿›åˆ¶: 0x08)</span></span><br><span class="line">    sock.write(<span class="string">'sequence\r\n'</span>)</span><br><span class="line"></span><br><span class="line">    sock.write(<span class="string">'0\r\n'</span>) <span class="comment">// å—å¤§å°ä¸º 0 è¡¨ç¤ºæ•°æ®ä¼ è¾“ç»“æŸ</span></span><br><span class="line">    sock.write(<span class="string">'\r\n'</span>)  <span class="comment">// æ¶ˆæ¯æœ€åä»¥ CRLF ç»“å°¾</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;).listen(<span class="number">8080</span>, <span class="string">'127.0.0.1'</span>)</span><br></pre></td></tr></table></figure><p>ç”¨æµè§ˆå™¨è®¿é—® <code>http://localhost:8080/</code> å¯ä»¥çœ‹åˆ° â€œThis is the data in the first chunk and this is the second one consequenceâ€ã€‚</p><h2>Transfer-Encoding å…¶å®ƒå®šä¹‰æ–¹æ³•</h2><ol><li><code>Transfer-Encoding: chunked</code>ï¼šæ•°æ®ä»¥ä¸€ç³»åˆ—åˆ†å—çš„å½¢å¼è¿›è¡Œå‘é€ã€‚ Content-Length é¦–éƒ¨åœ¨è¿™ç§æƒ…å†µä¸‹ä¸è¢«å‘é€ã€‚</li><li><code>Transfer-Encoding: compress</code>ï¼šé‡‡ç”¨ Lempel-Ziv-Welch (LZW) å‹ç¼©ç®—æ³•ï¼Œè¿™ç§å†…å®¹ç¼–ç æ–¹å¼å·²ç»è¢«å¤§éƒ¨åˆ†æµè§ˆå™¨å¼ƒç”¨ã€‚</li><li><code>Transfer-Encoding: deflate</code>ï¼šé‡‡ç”¨ zlib ç»“æ„ (åœ¨ RFC 1950 ä¸­è§„å®š)ï¼Œå’Œ deflate å‹ç¼©ç®—æ³•(åœ¨ RFC 1951 ä¸­è§„å®š)ã€‚</li><li><code>Transfer-Encoding: gzip</code>ï¼šè¡¨ç¤ºé‡‡ç”¨ Lempel-Ziv coding (LZ77) å‹ç¼©ç®—æ³•ï¼Œä»¥åŠ 32 ä½ CRC æ ¡éªŒçš„ç¼–ç æ–¹å¼ã€‚è¿™ä¸ªç¼–ç æ–¹å¼æœ€åˆç”± UNIX å¹³å°ä¸Šçš„ gzip ç¨‹åºé‡‡ç”¨ã€‚</li><li><code>Transfer-Encoding: identity</code>ï¼šç”¨äºæŒ‡ä»£è‡ªèº«ï¼ˆä¾‹å¦‚ï¼šæœªç»è¿‡å‹ç¼©å’Œä¿®æ”¹ï¼‰ã€‚é™¤éç‰¹åˆ«æŒ‡æ˜ï¼Œè¿™ä¸ªæ ‡è®°å§‹ç»ˆå¯ä»¥è¢«æ¥å—ã€‚</li></ol><h2>å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://zh.wikipedia.org/wiki/%E5%88%86%E5%9D%97%E4%BC%A0%E8%BE%93%E7%BC%96%E7%A0%81" target="_blank" rel="noopener">åˆ†å—ä¼ è¾“ç¼–ç </a></li><li><a href="https://imququ.com/post/transfer-encoding-header-in-http.html" target="_blank" rel="noopener">HTTP åè®®ä¸­çš„ Transfer-Encoding</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Transfer-Encoding" target="_blank" rel="noopener">Transfer-Encoding</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;ç®€ä»‹&lt;/h2&gt;
&lt;p&gt;Transfer-Encoding (ä¼ è¾“ç¼–ç ) æ˜¯å¸¸è§çš„ HTTP å¤´ å­—æ®µï¼Œè¡¨ç¤ºå°†å®ä½“å®‰å…¨ä¼ é€’ç»™ç”¨æˆ·æ‰€é‡‡ç”¨çš„ç¼–ç å½¢å¼ã€‚ä¸å¦å¤–ä¸€ä¸ªæ›´ä¸ºå¸¸è§çš„ Content-Encoding ä¸åŒï¼ŒContent-Encoding è¡¨ç¤ºå†…å®¹ç¼–ç ï¼Œé€šå¸¸ç”¨äºå¯¹å®ä½“å†…å®¹è¿›è¡Œå‹ç¼©ç¼–ç ï¼Œæ¯”å¦‚ gzipï¼Œdeflate ç­‰ã€‚è€Œ Transfer-Encoding ä¸ä¼šå‡å°‘å®ä½“å†…å®¹ä¼ è¾“å¤§å°ï¼Œä½†æ˜¯ä¼šæ”¹å˜å®ä½“ä¼ è¾“çš„å½¢å¼ã€‚Content-Encoding å’Œ Transfer-Encoding äºŒè€…æ˜¯ç›¸è¾…ç›¸æˆçš„ï¼Œå¯¹äºä¸€ä¸ª HTTP æŠ¥æ–‡ï¼Œå¾ˆå¯èƒ½åŒæ—¶è¿›è¡Œäº†å†…å®¹ç¼–ç å’Œä¼ è¾“ç¼–ç ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ HTTP è¯·æ±‚å¤´ä¸­ï¼ŒTransfer-Encoding è¢«ç§°ä¸º TEï¼Œè¡¨ç¤ºæµè§ˆå™¨é¢„æœŸæ¥å—çš„ä¼ è¾“ç¼–ç æ–¹å¼ï¼Œå¯ä½¿ç”¨ Response å¤´ Transfer-Encoding å­—æ®µä¸­çš„å€¼ï¼Œæ¯”å¦‚ chunkedï¼›å¦å¤–è¿˜å¯ç”¨ trailers è¿™ä¸ªå€¼æ¥è¡¨æ˜æµè§ˆå™¨å¸Œæœ›åœ¨æœ€åä¸€ä¸ªå¤§å°ä¸º 0 çš„å—ä¹‹åè¿˜æ¥æ”¶åˆ°ä¸€äº›é¢å¤–çš„å­—æ®µã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="ç½‘ç»œ" scheme="https://lz5z.com/categories/%E7%BD%91%E7%BB%9C/"/>
    
    
      <category term="HTTP" scheme="https://lz5z.com/tags/HTTP/"/>
    
      <category term="Transfer-Encoding" scheme="https://lz5z.com/tags/Transfer-Encoding/"/>
    
  </entry>
  
  <entry>
    <title>HTTP çŠ¶æ€ç  301 ä¸ 302 çš„åŒºåˆ«</title>
    <link href="https://lz5z.com/HTTP-301-vs-302/"/>
    <id>https://lz5z.com/HTTP-301-vs-302/</id>
    <published>2018-07-08T20:28:56.000Z</published>
    <updated>2020-04-21T10:23:54.823Z</updated>
    
    <content type="html"><![CDATA[<h2>301 å’Œ 302 æœ‰å•¥åŒºåˆ«</h2><p>301 Moved Permanentlyï¼Œæ°¸ä¹…é‡å®šå‘ã€‚è¢«è¯·æ±‚èµ„æºå·²æ°¸ä¹…ç§»åŠ¨åˆ°æ–°ä½ç½®ï¼Œå¹¶ä¸”å°†æ¥ä»»ä½•å¯¹è¯¥èµ„æºçš„å¼•ç”¨éƒ½ä½¿ç”¨æœ¬å“åº”è¿”å›çš„è‹¥å¹²ä¸ª URI ä¹‹ä¸€ã€‚301 èµ„æºé™¤éé¢å¤–æŒ‡å®šï¼Œå¦åˆ™éƒ½æ˜¯å¯ç¼“å­˜çš„ã€‚</p><blockquote><p>æ³¨æ„ï¼šå¯¹äºæŸäº›ä½¿ç”¨ HTTP/1.0 åè®®çš„æµè§ˆå™¨ï¼Œå½“å®ƒä»¬å‘é€çš„ POST è¯·æ±‚å¾—åˆ°äº†ä¸€ä¸ª 301 å“åº”çš„è¯ï¼Œæ¥ä¸‹æ¥çš„é‡å®šå‘è¯·æ±‚å°†ä¼šå˜æˆ GET æ–¹å¼ã€‚</p></blockquote><p>302 Found è¡¨ç¤ºä¸´æ—¶é‡å®šå‘ Moved Temporarilyã€‚ç”±äºè¿™æ ·çš„é‡å®šå‘æ˜¯ä¸´æ—¶çš„ï¼Œå®¢æˆ·ç«¯åº”ç»§ç»­å‘åŸæœ‰åœ°å€å‘é€ä»¥åçš„è¯·æ±‚ï¼Œåªæœ‰åœ¨ Cache-Control æˆ– Expires ä¸­è¿›è¡Œäº†æŒ‡å®šçš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªå“åº”æ‰æ˜¯å¯ç¼“å­˜çš„ã€‚</p><blockquote><p>æ³¨æ„ï¼šè™½ç„¶ RFC1945 å’Œ RFC 2068 è§„èŒƒä¸å…è®¸å®¢æˆ·ç«¯åœ¨é‡å®šå‘æ—¶æ”¹å˜è¯·æ±‚çš„æ–¹æ³•ï¼Œä½†æ˜¯å¾ˆå¤šç°å­˜çš„æµè§ˆå™¨å°† 302 å“åº”è§†ä½œä¸º 303 å“åº”ï¼Œå¹¶ä¸”ä½¿ç”¨ GET æ–¹å¼è®¿é—®åœ¨ Location ä¸­è§„å®šçš„ URIï¼Œè€Œæ— è§†åŸå…ˆè¯·æ±‚çš„æ–¹æ³•ã€‚å› æ­¤çŠ¶æ€ç  303 å’Œ 307 è¢«æ·»åŠ äº†è¿›æ¥ï¼Œç”¨ä»¥æ˜ç¡®æœåŠ¡å™¨æœŸå¾…å®¢æˆ·ç«¯è¿›è¡Œä½•ç§ååº”ã€‚</p></blockquote><a id="more"></a><h2>301 å’Œ 302 ç›¸åŒç‚¹</h2><ol><li>éƒ½è¡¨ç¤ºèµ„æºé‡å®šå‘ã€‚</li><li>æ–°çš„ URI åœ°å€éƒ½æ˜¯åœ¨å“åº”çš„ Location ä¸­è¿”å›ã€‚</li><li>å¦‚æœåŸå§‹è¯·æ±‚ä¸æ˜¯ GET æˆ–è€… HEAD è¯·æ±‚çš„è¯ï¼Œæµè§ˆå™¨ä¼šç¦æ­¢è‡ªåŠ¨è¿›è¡Œé‡å®šå‘ï¼Œé™¤éå¾—åˆ°ç”¨æˆ·çš„ç¡®è®¤ï¼Œå› ä¸ºè¯·æ±‚çš„æ¡ä»¶å¯èƒ½å› æ­¤å‘ç”Ÿå˜åŒ–ã€‚</li></ol><h2>301 Moved Permanently</h2><p>æ¥çœ‹ä¸€ä¸ªå¸¸è§çš„ 301 çŠ¶æ€ç çš„æ¼”ç¤ºã€‚è®¿é—®<a href="https://lz5z.com">æœ¬ç½‘é¡µ</a>çš„æ—¶å€™ï¼Œç”±äºä½¿ç”¨ https åè®®ï¼Œå¹¶ä¸”è®¾ç½® http è‡ªåŠ¨é‡å®šå‘åˆ° httpsï¼Œæ‰€ä»¥å‡å¦‚ç›´æ¥ä½¿ç”¨ http åè®®<a href="http://lz5z.com">http://lz5z.com</a>è¿›è¡Œè®¿é—®ï¼Œä¼šæœ‰ä¸€æ¬¡ 301 é‡å®šå‘ã€‚</p><img src="/assets/img/http_301.png" alt="http_301"><p>æµè§ˆå™¨è·å¾—å“åº”ç»“æœåï¼Œæ ¹æ® Location ä¸­çš„å€¼è¿›è¡Œé‡å®šå‘ï¼Œæ‰“å¼€é¡µé¢ <a href="https://lz5z.com">https://lz5z.com</a>ã€‚</p><h2>302 Found</h2><p>æˆ‘ä»¬å¸¸ç”¨çš„çŸ­é“¾æ¥å°±æ˜¯ 302 è·³è½¬ï¼Œæ¯”å¦‚æˆ‘ä½¿ç”¨ <a href="http://dwz.wailian.work/" target="_blank" rel="noopener">sina çš„çŸ­é“¾æ¥</a>æœåŠ¡ç”Ÿæˆæœ¬é¡µé¢çš„åœ°å€: <a href="http://t.cn/RdC6GHq" target="_blank" rel="noopener">http://t.cn/RdC6GHq</a>ã€‚å¯¹å…¶è¿›è¡Œè®¿é—®çš„æ—¶å€™å°±é¦–å…ˆå‘ç”Ÿäº† 302 é‡å®šå‘ã€‚</p><img src="/assets/img/http_302.png" alt="http_302"><h2>ä½¿ç”¨æ—¶æœº</h2><p>ç”±äº 301 é‡å®šå‘æ˜¯æ°¸ä¹…çš„é‡å®šå‘ï¼Œæœç´¢å¼•æ“åœ¨æŠ“å–æ–°å†…å®¹çš„åŒæ—¶ä¹Ÿå°†æ—§çš„ç½‘å€æ›¿æ¢ä¸ºé‡å®šå‘ä¹‹åçš„ç½‘å€ã€‚302 é‡å®šå‘æ˜¯ä¸´æ—¶çš„é‡å®šå‘ï¼Œæœç´¢å¼•æ“ä¼šæŠ“å–æ–°çš„å†…å®¹è€Œä¿ç•™æ—§çš„ç½‘å€ã€‚å› ä¸ºæœåŠ¡å™¨è¿”å› 302 ä»£ç ï¼Œæœç´¢å¼•æ“è®¤ä¸ºæ–°çš„ç½‘å€åªæ˜¯æš‚æ—¶çš„ã€‚</p><p>æ‰€ä»¥ 301 æ˜¯å¯¹æœç´¢å¼•æ“æ›´åŠ å‹å¥½çš„é‡å®šå‘ï¼Œå»ºè®®åªè¦ä¸æ˜¯èµ„æºä¸´æ—¶è½¬ç§»ï¼Œéƒ½å¯ä»¥ä½¿ç”¨ 301 çš„æ–¹å¼ã€‚</p><h2>å‚è€ƒèµ„æº</h2><ul><li><a href="https://zh.wikipedia.org/wiki/HTTP%E7%8A%B6%E6%80%81%E7%A0%81#3xx%E9%87%8D%E5%AE%9A%E5%90%91" target="_blank" rel="noopener">HTTPçŠ¶æ€ç #3xxé‡å®šå‘</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;301 å’Œ 302 æœ‰å•¥åŒºåˆ«&lt;/h2&gt;
&lt;p&gt;301 Moved Permanentlyï¼Œæ°¸ä¹…é‡å®šå‘ã€‚è¢«è¯·æ±‚èµ„æºå·²æ°¸ä¹…ç§»åŠ¨åˆ°æ–°ä½ç½®ï¼Œå¹¶ä¸”å°†æ¥ä»»ä½•å¯¹è¯¥èµ„æºçš„å¼•ç”¨éƒ½ä½¿ç”¨æœ¬å“åº”è¿”å›çš„è‹¥å¹²ä¸ª URI ä¹‹ä¸€ã€‚301 èµ„æºé™¤éé¢å¤–æŒ‡å®šï¼Œå¦åˆ™éƒ½æ˜¯å¯ç¼“å­˜çš„ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ³¨æ„ï¼šå¯¹äºæŸäº›ä½¿ç”¨ HTTP/1.0 åè®®çš„æµè§ˆå™¨ï¼Œå½“å®ƒä»¬å‘é€çš„ POST è¯·æ±‚å¾—åˆ°äº†ä¸€ä¸ª 301 å“åº”çš„è¯ï¼Œæ¥ä¸‹æ¥çš„é‡å®šå‘è¯·æ±‚å°†ä¼šå˜æˆ GET æ–¹å¼ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;302 Found è¡¨ç¤ºä¸´æ—¶é‡å®šå‘ Moved Temporarilyã€‚ç”±äºè¿™æ ·çš„é‡å®šå‘æ˜¯ä¸´æ—¶çš„ï¼Œå®¢æˆ·ç«¯åº”ç»§ç»­å‘åŸæœ‰åœ°å€å‘é€ä»¥åçš„è¯·æ±‚ï¼Œåªæœ‰åœ¨ Cache-Control æˆ– Expires ä¸­è¿›è¡Œäº†æŒ‡å®šçš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªå“åº”æ‰æ˜¯å¯ç¼“å­˜çš„ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ³¨æ„ï¼šè™½ç„¶ RFC1945 å’Œ RFC 2068 è§„èŒƒä¸å…è®¸å®¢æˆ·ç«¯åœ¨é‡å®šå‘æ—¶æ”¹å˜è¯·æ±‚çš„æ–¹æ³•ï¼Œä½†æ˜¯å¾ˆå¤šç°å­˜çš„æµè§ˆå™¨å°† 302 å“åº”è§†ä½œä¸º 303 å“åº”ï¼Œå¹¶ä¸”ä½¿ç”¨ GET æ–¹å¼è®¿é—®åœ¨ Location ä¸­è§„å®šçš„ URIï¼Œè€Œæ— è§†åŸå…ˆè¯·æ±‚çš„æ–¹æ³•ã€‚å› æ­¤çŠ¶æ€ç  303 å’Œ 307 è¢«æ·»åŠ äº†è¿›æ¥ï¼Œç”¨ä»¥æ˜ç¡®æœåŠ¡å™¨æœŸå¾…å®¢æˆ·ç«¯è¿›è¡Œä½•ç§ååº”ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="ç½‘ç»œ" scheme="https://lz5z.com/categories/%E7%BD%91%E7%BB%9C/"/>
    
    
      <category term="HTTP" scheme="https://lz5z.com/tags/HTTP/"/>
    
      <category term="301" scheme="https://lz5z.com/tags/301/"/>
    
      <category term="302" scheme="https://lz5z.com/tags/302/"/>
    
  </entry>
  
  <entry>
    <title>ES2018æ–°ç‰¹æ€§å­¦ä¹ </title>
    <link href="https://lz5z.com/ES2018%E6%96%B0%E7%89%B9%E6%80%A7%E5%AD%A6%E4%B9%A0/"/>
    <id>https://lz5z.com/ES2018æ–°ç‰¹æ€§å­¦ä¹ /</id>
    <published>2018-07-02T19:47:59.000Z</published>
    <updated>2020-04-21T10:23:54.823Z</updated>
    
    <content type="html"><![CDATA[<p>ECMAScript 2018 (ES9) åœ¨ 6 æœˆåº•æ­£å¼å‘å¸ƒï¼Œå¸¦æ¥äº†å¾ˆå¤šæ–°ç‰¹æ€§ã€‚å…³äº ES7 å’Œ ES8 ç›¸å…³çš„çŸ¥è¯†ï¼Œå¯ä»¥æŸ¥çœ‹è¿™ç¯‡æ–‡ç«  <a href="https://lz5z.com/ES2016%E5%92%8CES2017%E5%AD%A6%E4%B9%A0/">ES2016 å’Œ ES2017 å­¦ä¹ </a>ã€‚ç›®å‰å¤§éƒ¨åˆ† ES7 å’Œ ES8 çš„ç‰¹æ€§éƒ½å¾—åˆ°ä¸»æµæµè§ˆå™¨çš„æ”¯æŒï¼Œè€Œ ES9 çš„æ–°ç‰¹æ€§è¿˜æœªèƒ½å®ç°å¾ˆå¥½çš„å…¼å®¹æ€§ã€‚</p><p>å…³äº ES7/8/9 å…¨éƒ¨ç‰¹æ€§å¯ä»¥æŸ¥çœ‹ tc39 å®˜æ–¹çš„ <a href="https://github.com/tc39/proposals/blob/master/finished-proposals.md" target="_blank" rel="noopener">proposals</a>ï¼Œè¿™äº›éƒ½æ˜¯æœ€åè¿›å…¥ stage 4 çš„ç‰¹æ€§ã€‚</p><p>ES9 çš„æ–°ç‰¹æ€§ï¼š</p><ol><li>Lifting template literal restriction æ¨¡æ¿è¯­æ³•ä¿®æ­£</li><li><code>s</code> (dotAll) flag for regular expressions (æ­£åˆ™è¡¨è¾¾å¼ dotAll æ¨¡å¼)</li><li>RegExp named capture groups (æ­£åˆ™è¡¨è¾¾å¼å‘½åæ•è·ç»„)</li><li>Rest/Spread Properties (Rest/Spread å±æ€§)</li><li>RegExp Lookbehind Assertions (æ­£åˆ™è¡¨è¾¾å¼åå‘(lookbehind)æ–­è¨€)</li><li>RegExp Unicode Property Escapes (æ­£åˆ™è¡¨è¾¾å¼ Unicode è½¬ä¹‰)</li><li>Promise.prototype.finally</li><li>Asynchronous Iteration (å¼‚æ­¥è¿­ä»£å™¨)</li></ol><a id="more"></a><h2><a href="https://github.com/tc39/proposal-regexp-dotall-flag" target="_blank" rel="noopener">æ­£åˆ™è¡¨è¾¾å¼ dotAll æ¨¡å¼</a></h2><p>dotAll æ˜¯ä¸€ä¸ªæ–°çš„æ­£åˆ™è¡¨è¾¾å¼ä¿®é¥°ç¬¦ï¼Œç›®å‰ JS æ‹¥æœ‰çš„ä¿®é¥°ç¬¦æœ‰ï¼š</p><ul><li>g -&gt; global</li><li>i -&gt; ingoreCase</li><li>m -&gt; multiline</li><li>y -&gt; sticky</li><li>u -&gt; unicode</li><li>s -&gt; dotAll</li></ul><p>æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„ <code>.</code> ç”¨æ¥åŒ¹é…ä»»ä½•å•ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯æœ‰ 2 ä¸ªé™¤å¤–ï¼šå¤šå­—èŠ‚ emoji å­—ç¬¦å’Œè¡Œç»ˆç»“ç¬¦ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> regex = <span class="regexp">/^.$/</span></span><br><span class="line">regex.test(<span class="string">'ğŸ˜€'</span>)   <span class="comment">// false</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡è®¾ç½® u è¡¨ç¤º unicode</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> regex = <span class="regexp">/^.$/u</span></span><br><span class="line">regex.test(<span class="string">'ğŸ˜€'</span>)   <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>è¡Œç»ˆæ­¢ç¬¦åŒ…æ‹¬</p><ul><li>U+000A LINE FEED (LF) (\n) - æ¢è¡Œ</li><li>U+000D CARRIAGE RETURN (CR) (\r) - å›è½¦</li><li>U+2028 LINE SEPARATOR - è¡Œåˆ†éš”ç¬¦</li><li>U+2029 PARAGRAPH SEPARATOR - æ®µåˆ†éš”ç¬¦</li></ul><p>è¿˜æœ‰ä¸€äº›å…¶å®ƒå­—ç¬¦ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºä¸€è¡Œçš„å¼€å§‹ï¼š</p><ul><li>U+000B VERTICAL TAB (\v)</li><li>U+000C FORM FEED (\f)</li><li>U+0085 NEXT LINE</li></ul><p>ç›®å‰ <code>.</code> åªèƒ½åŒ¹é…å…¶ä¸­çš„ä¸€éƒ¨åˆ†ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> regex = <span class="regexp">/./</span></span><br><span class="line"></span><br><span class="line">regex.test(<span class="string">'\n'</span>)       <span class="comment">// false</span></span><br><span class="line">regex.test(<span class="string">'\r'</span>)       <span class="comment">// false</span></span><br><span class="line">regex.test(<span class="string">'\u&#123;2028&#125;'</span>) <span class="comment">// false</span></span><br><span class="line">regex.test(<span class="string">'\u&#123;2029&#125;'</span>) <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line">regex.test(<span class="string">'\v'</span>)       <span class="comment">// true</span></span><br><span class="line">regex.test(<span class="string">'\f'</span>)       <span class="comment">// true</span></span><br><span class="line">regex.test(<span class="string">'\u&#123;0085&#125;'</span>) <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>æ ‡è®° <code>s</code> è¡¨ç¤º dotAllï¼Œç”¨æ¥æ”¹å˜ <code>.</code> ä¸èƒ½åŒ¹é…è¡Œç»ˆæ­¢ç¬¦çš„è¡Œä¸º:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/hello.world/.test(<span class="string">'hello\nworld'</span>)  <span class="comment">// false</span></span><br><span class="line">/hello.world/s.test(<span class="string">'hello\nworld'</span>) <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>æˆ–è€…ç”¨ <code>\s</code> æ¥åŒ¹é…ç©ºç™½ç¬¦ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/hello.world/.test(<span class="string">'hello\nworld'</span>)  <span class="comment">// false</span></span><br><span class="line">/hello[\s]world/s.test(<span class="string">'hello\nworld'</span>) <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>dotAll è¡¨ç¤º <code>.</code> å¯ä»¥åŒ¹é…ä»»æ„å­—ç¬¦ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> re = <span class="regexp">/hello.world/</span>s  <span class="comment">// ç­‰ä»·äº const re = new RegExp('hello.world', 's')</span></span><br><span class="line"></span><br><span class="line">re.test(<span class="string">'hello\nworld'</span>) <span class="comment">// true</span></span><br><span class="line">re.dotAll <span class="comment">// true</span></span><br><span class="line">re.flags <span class="comment">// 's'</span></span><br></pre></td></tr></table></figure><h2><a href="https://github.com/tc39/proposal-regexp-named-groups" target="_blank" rel="noopener">æ­£åˆ™è¡¨è¾¾å¼å‘½åæ•è·ç»„</a></h2><p>æ•è·ç»„å°±æ˜¯æŠŠæ­£åˆ™è¡¨è¾¾å¼ä¸­åŒ¹é…åˆ°çš„å†…å®¹ï¼Œä¿å­˜åˆ°å†…å­˜ä¸­ä»¥æ•°å­—ç¼–å·æˆ–è€…æ˜¾å¼å‘½åçš„æ•°ç»„é‡Œï¼Œæ–¹ä¾¿åé¢ä½¿ç”¨ã€‚è¿™ç§å¼•ç”¨æ—¢å¯ä»¥åœ¨æ­£åˆ™è¡¨è¾¾å¼å†…éƒ¨ï¼Œä¹Ÿå¯ä»¥æ˜¯åœ¨æ­£åˆ™è¡¨è¾¾å¼å¤–éƒ¨ã€‚</p><p>æ•è·ç»„æœ‰ä¸¤ç§å½¢å¼ï¼Œä¸€ç§æ˜¯æ™®é€šæ•è·ç»„ï¼Œå¦ä¸€ç§æ˜¯å‘½åæ•è·ç»„ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> regex = <span class="regexp">/(\d&#123;4&#125;)-(\d&#123;2&#125;)-(\d&#123;2&#125;)/</span></span><br><span class="line"><span class="keyword">const</span> matchers = regex.exec(<span class="string">'2018-07-02'</span>)</span><br><span class="line">matchers[<span class="number">0</span>]    <span class="comment">// 2018-07-02</span></span><br><span class="line">matchers[<span class="number">1</span>]    <span class="comment">// 2018</span></span><br><span class="line">matchers[<span class="number">2</span>]    <span class="comment">// 07</span></span><br><span class="line">matchers[<span class="number">3</span>]    <span class="comment">// 02</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ•°å­—æ•è·ç»„çš„ä¸€ä¸ªç¼ºç‚¹æ˜¯å¯¹äºå¼•ç”¨ä¸å¤ªç›´è§‚ï¼Œä»¥ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬å¾ˆéš¾åˆ†æ¸…æ¥šå“ªä¸ªç»„ä»£è¡¨çš„æ˜¯å¹´ï¼Œå“ªä¸ªç»„ä»£è¡¨çš„æ˜¯æœˆã€‚è€Œå‘½åæ•è·ç»„å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><h3>å‘½åæ•è·ç»„</h3><p>ES2018 å…è®¸å‘½åæ•è·ç»„å¯ä»¥ä½¿ç”¨ <code>(?&lt;name&gt;...)</code> è¯­æ³•ç»™æ¯ä¸ªç»„èµ·ä¸€ä¸ªåå­—ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> regex = <span class="regexp">/(?&lt;year&gt;[0-9]&#123;4&#125;)-(?&lt;month&gt;[0-9]&#123;2&#125;)-(?&lt;day&gt;[0-9]&#123;2&#125;)/</span></span><br><span class="line"><span class="keyword">const</span> match = regex.exec(<span class="string">'2018-07-02'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(match.groups.day) <span class="comment">// '02'</span></span><br><span class="line"><span class="built_in">console</span>.log(match.groups.month) <span class="comment">// '07'</span></span><br><span class="line"><span class="built_in">console</span>.log(match.groups.year) <span class="comment">// '2018'</span></span><br></pre></td></tr></table></figure><h3>åå­—å”¯ä¸€</h3><p>æ¯ä¸ªæ•è·ç»„çš„åå­—å¿…é¡»å”¯ä¸€ï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> regex = <span class="regexp">/(?&lt;foo&gt;\d)-(?&lt;foo&gt;\d)/</span></span><br><span class="line"><span class="comment">// Uncaught SyntaxError: Invalid regular expression: /(?&lt;foo&gt;\d)-(?&lt;foo&gt;\d)/: Duplicate capture group name</span></span><br></pre></td></tr></table></figure><h3>åŒ¹é…å¤±è´¥</h3><p>ä»»ä½•åŒ¹é…å¤±è´¥çš„å‘½åç»„éƒ½å°†è¿”å› undefinedã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> re = <span class="regexp">/^(?&lt;optional&gt;\d+)?$/</span></span><br><span class="line"><span class="keyword">const</span> matchers = re.exec(<span class="string">''</span>)</span><br><span class="line"></span><br><span class="line">matchers[<span class="number">0</span>] === <span class="string">''</span></span><br><span class="line">matchers.groups.optional === <span class="literal">undefined</span></span><br></pre></td></tr></table></figure><h3>ä½¿ç”¨è§£æ„èµ‹å€¼</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> re = <span class="regexp">/^(?&lt;one&gt;.*):(?&lt;two&gt;.*)$/</span></span><br><span class="line"><span class="keyword">let</span> &#123;<span class="attr">groups</span>: &#123;one, two&#125;&#125; = re.exec(<span class="string">'foo:bar'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`one: <span class="subst">$&#123;one&#125;</span>, two: <span class="subst">$&#123;two&#125;</span>`</span>)  <span class="comment">// è¾“å‡º one: foo, two: bar</span></span><br></pre></td></tr></table></figure><h3>ä½¿ç”¨ replace</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> reDate = <span class="regexp">/(?&lt;year&gt;[0-9]&#123;4&#125;)-(?&lt;month&gt;[0-9]&#123;2&#125;)-(?&lt;day&gt;[0-9]&#123;2&#125;)/</span></span><br><span class="line"><span class="keyword">const</span> d = <span class="string">'2018-07-02'</span></span><br><span class="line"><span class="built_in">console</span>.log(d.replace(reDate, <span class="string">'$&lt;month&gt;-$&lt;day&gt;-$&lt;year&gt;'</span>)) <span class="comment">// 07-02-2018</span></span><br></pre></td></tr></table></figure><p><code>String.prototype.replace</code> ç¬¬ 2 ä¸ªå‚æ•°å¯ä»¥æ¥å—ä¸€ä¸ªå‡½æ•°ã€‚è¿™æ—¶ å‘½åæ•è·ç»„çš„å¼•ç”¨ä¼šä½œä¸º groups å‚æ•°ä¼ é€’è¿›å»:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> re = <span class="regexp">/(?&lt;year&gt;\d&#123;4&#125;)-(?&lt;month&gt;\d&#123;2&#125;)-(?&lt;day&gt;\d&#123;2&#125;)/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> result = <span class="string">'2018-07-02'</span>.replace(re, (...args) =&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> &#123;day, month, year&#125; = args[args.length - <span class="number">1</span>]</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;day&#125;</span>-<span class="subst">$&#123;month&#125;</span>-<span class="subst">$&#123;year&#125;</span>`</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">result === <span class="string">'02/07/2018'</span> <span class="comment">// true</span></span><br></pre></td></tr></table></figure><h3>åå‘å¼•ç”¨</h3><p>å½“éœ€è¦åœ¨æ­£åˆ™è¡¨è¾¾å¼é‡Œé¢å¼•ç”¨å‘½åæ•è·ç»„æ—¶ï¼Œä½¿ç”¨ <code>\k&lt;name&gt;</code> è¯­æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> duplicate = <span class="regexp">/^(?&lt;half&gt;.*).\k&lt;half&gt;$/</span></span><br><span class="line">duplicate.test(<span class="string">'a*b'</span>) <span class="comment">// false</span></span><br><span class="line">duplicate.test(<span class="string">'a*a'</span>) <span class="comment">// true</span></span><br></pre></td></tr></table></figure><h3>å‘ä¸‹å…¼å®¹</h3><p><code>/(?&lt;name&gt;)/</code> å’Œ <code>/\k&lt;foo&gt;/</code> åªæœ‰åœ¨å‘½åæ•è·ç»„ä¸­æ‰æœ‰æ„ä¹‰ã€‚å¦‚æœæ­£åˆ™è¡¨è¾¾å¼æ²¡æœ‰å‘½åæ•è·ç»„ï¼Œé‚£ä¹ˆ <code>/\k&lt;foo&gt;/</code> ä»…ä»…æ˜¯å­—ç¬¦ä¸²å­—é¢é‡ â€œk<foo>â€ è€Œå·²ã€‚</foo></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/\k&lt;foo&gt;<span class="regexp">/.test('k&lt;foo&gt;')   /</span><span class="regexp">/ true</span></span><br></pre></td></tr></table></figure><h2><a href="https://github.com/tc39/proposal-regexp-lookbehind" target="_blank" rel="noopener">æ­£åˆ™è¡¨è¾¾å¼åå‘(lookbehind)æ–­è¨€</a></h2><p>æ–­è¨€ (Assertion) æ˜¯ä¸€ä¸ªå¯¹å½“å‰åŒ¹é…ä½ç½®ä¹‹å‰æˆ–ä¹‹åçš„å­—ç¬¦çš„æµ‹è¯•ï¼Œå®ƒä¸ä¼šå®é™…æ¶ˆè€—ä»»ä½•å­—ç¬¦ï¼Œæ‰€ä»¥æ–­è¨€ä¹Ÿè¢«ç§°ä¸ºâ€œéæ¶ˆè€—æ€§åŒ¹é…â€æˆ–â€œéè·å–åŒ¹é…â€ã€‚</p><p>æ­£åˆ™è¡¨è¾¾å¼çš„æ–­è¨€ä¸€å…±æœ‰ 4 ç§å½¢å¼ï¼š</p><ul><li><code>(?=pattern)</code> é›¶å®½æ­£å‘è‚¯å®šæ–­è¨€(zero-width positive lookahead assertion)</li><li><code>(?!pattern)</code> é›¶å®½æ­£å‘å¦å®šæ–­è¨€(zero-width negative lookahead assertion)</li><li><code>(?&lt;=pattern)</code> é›¶å®½åå‘è‚¯å®šæ–­è¨€(zero-width positive lookbehind assertion)</li><li><code>(?&lt;!pattern)</code> é›¶å®½åå‘å¦å®šæ–­è¨€(zero-width negative lookbehind assertion)</li></ul><h3>æ­£å‘æ–­è¨€(lookahead)</h3><p>å½“å‰ä½ç½®åé¢çš„å­—ç¬¦ä¸²åº”è¯¥æ»¡è¶³æ–­è¨€ï¼Œä½†æ˜¯å¹¶ä¸æ•è·ï¼Œåœ¨å½“å‰çš„ JavaScript æ­£åˆ™è¡¨è¾¾å¼åªæ”¯æŒæ­£å‘æ–­è¨€ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> regex = <span class="regexp">/li(?=zhen)/</span></span><br><span class="line"><span class="keyword">const</span> match1 = regex.exec(<span class="string">'lizhen'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(match1[<span class="number">0</span>]) <span class="comment">// li</span></span><br><span class="line"><span class="comment">// å¦‚æœå­—ç¬¦ä¸²æ²¡æœ‰zhenï¼Œåˆ™æ— æ³•åŒ¹é…</span></span><br><span class="line"><span class="keyword">const</span> match2 = regex.exec(<span class="string">'liming'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(match2) <span class="comment">// null</span></span><br></pre></td></tr></table></figure><p>æ­£å‘å¦å®šæ–­è¨€æ­£å¥½ç›¸å</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> regex = <span class="regexp">/li(?!zhen)/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> match1 = regex.exec(<span class="string">'lizhen'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(match1)    <span class="comment">// null</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> match2 = regex.exec(<span class="string">'liming'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(match2[<span class="number">0</span>]) <span class="comment">// li</span></span><br></pre></td></tr></table></figure><h3>åå‘æ–­è¨€(lookbehind)</h3><p>åå‘æ–­è¨€å’Œæ­£å‘æ–­è¨€çš„è¡Œä¸ºä¸€æ ·ï¼Œåªæ˜¯æ–¹å‘ç›¸åã€‚åå‘è‚¯å®šæ–­è¨€ä½¿ç”¨è¯­æ³• <code>(?&lt;=...)</code>ã€‚</p><p>æ¯”å¦‚æˆ‘ä»¬æƒ³è·å–æ‰€æœ‰çš„äººæ°‘å¸é‡‘é¢ï¼Œä½†æ˜¯ä¸è·å–å…¶å®ƒè´§å¸ï¼ˆæ¯”å¦‚ç¾å…ƒï¼‰ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> regex = <span class="regexp">/(?&lt;=\D)\d+(\.\d*)?/</span></span><br><span class="line"><span class="keyword">const</span> match = regex.exec(<span class="string">'$123.89'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(match[<span class="number">0</span>]) <span class="comment">// 123.89</span></span><br></pre></td></tr></table></figure><h2><a href="https://github.com/tc39/proposal-regexp-unicode-property-escapes" target="_blank" rel="noopener">æ­£åˆ™è¡¨è¾¾å¼ Unicode è½¬ä¹‰</a></h2><p>Unicode æ ‡å‡†ä¸ºæ¯ä¸ªç¬¦å·åˆ†é…å„ç§å±æ€§å’Œå±æ€§å€¼ï¼Œæ¯”å¦‚å¸Œè…Šå­—æ¯ <code>Ï€</code> åœ¨ Unicode ä¸­æœ‰ç‹¬ç‰¹çš„å±æ€§å’Œå±æ€§å€¼ã€‚ç›®å‰ç‰ˆæœ¬çš„ ECMAScript ä¸­æ­£åˆ™è¡¨è¾¾å¼æ˜¯æ— æ³•åŒ¹é…è¿™äº› Unicode çš„ï¼Œé€šå¸¸å¼€å‘äººå‘˜æœ‰ä¸¤ç§é€‰æ‹©ã€‚</p><p>(1) åœ¨è¿è¡Œæ—¶ä½¿ç”¨ç±»ä¼¼äº <a href="https://github.com/slevithan/xregexp" target="_blank" rel="noopener">xregexp</a> è¿™æ ·çš„åº“åˆ›å»ºå¢å¼ºçš„æ­£åˆ™è¡¨è¾¾å¼ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> regexGreekSymbol = XRegExp(<span class="string">'\\p&#123;Greek&#125;'</span>, <span class="string">'A'</span>)</span><br><span class="line">regexGreekSymbol.test(<span class="string">'Ï€'</span>) <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>ç¼ºç‚¹æ˜¯ xregexp æ˜¯ä¸€ä¸ªè¿è¡Œæ—¶ä¾èµ–ï¼Œå¯¹æ€§èƒ½è¦æ±‚è¾ƒé«˜çš„ web åº”ç”¨æ¥è¯´ä¸æ˜¯å¾ˆç†æƒ³ã€‚è€Œä¸”å…¶å‹ç¼©æ–‡ä»¶ <code>xregexp-all-min.js.gz</code> ä¹Ÿæœ‰ 35kï¼Œå¹¶ä¸”æ¯å½“ Unicode æ ‡å‡†æ›´æ–°æ—¶ï¼Œå¿…é¡»è¦æ›´æ–° xregexp æ‰èƒ½ä½¿ç”¨æ–°æ•°æ®ã€‚</p><p>(2) åœ¨ç¼–è¯‘æ—¶çš„æ—¶å€™ä½¿ç”¨ <a href="https://github.com/mathiasbynens/regenerate" target="_blank" rel="noopener">regenerate</a> ç”Ÿæˆæ­£åˆ™è¡¨è¾¾å¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> regenerate = <span class="built_in">require</span>(<span class="string">'regenerate'</span>)</span><br><span class="line"><span class="keyword">const</span> codePoints = <span class="built_in">require</span>(<span class="string">'unicode-9.0.0/Script/Greek/code-points.js'</span>)</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">set</span> = regenerate(codePoints)</span><br><span class="line"><span class="keyword">set</span>.toString()</span><br><span class="line">// â†’ '[\u0370-\u0373\u0375-\u0377\u037A-\u037D\u037F\u0384\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03E1\u03F0-\u03FF\u1D26-\u1D2A\u1D5D-\u1D61\u1D66-\u1D6A\u1DBF\u1F00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FC4\u1FC6-\u1FD3\u1FD6-\u1FDB\u1FDD-\u1FEF\u1FF2-\u1FF4\u1FF6-\u1FFE\u2126\uAB65]|\uD800[\uDD40-\uDD8E\uDDA0]|\uD834[\uDE00-\uDE45]'</span><br><span class="line">// Imagine thereâ€™s more code here to save this pattern to a file.</span><br></pre></td></tr></table></figure><p>è™½ç„¶è¿™ç§æ–¹æ³•æ‰€ç”Ÿæˆçš„æ­£åˆ™è¡¨è¾¾å¼ç›¸å½“å¤§ï¼Œä½†æ˜¯èƒ½å¤Ÿå¾—åˆ°æœ€ä½³çš„è¿è¡Œæ—¶æ€§èƒ½ã€‚æœ€å¤§çš„ç¼ºç‚¹æ˜¯å®ƒéœ€è¦ä¸€ä¸ªæ„å»ºè„šæœ¬ï¼Œæ¯å½“ Unicode æ ‡å‡†æ›´æ–°æ—¶ï¼Œå¿…é¡»æ›´æ–°ç”Ÿæˆè„šæœ¬ã€‚</p><h3>è§£å†³æ–¹æ¡ˆ</h3><p>ES2018 ä¸­ä½¿ç”¨ <code>\p{â€¦}</code> å’Œ <code>\P{â€¦}</code> è¿›è¡Œ Unicode çš„å±æ€§è½¬ä¹‰ï¼Œåœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ä½¿ç”¨ <code>u</code> è¿›è¡Œæ ‡è®°ã€‚åœ¨ <code>\p{â€¦}</code> å†…ï¼Œå¯ä»¥ä»¥é”®å€¼å¯¹çš„æ–¹å¼è®¾ç½®éœ€è¦åŒ¹é…çš„å±æ€§ï¼Œè€Œéå…·ä½“å†…å®¹ã€‚æ¯”å¦‚è¦åŒ¹é…å¸Œè…Šå­—æ¯ <code>Ï€</code>ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> reGreekSymbol = <span class="regexp">/\p&#123;Script=Greek&#125;/u</span></span><br><span class="line">reGreekSymbol.test(<span class="string">'Ï€'</span>) <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>è§£å†³äº†ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š</p><ol><li>ä¸ç”¨ä¸ºåˆ›å»º Unicode-aware æ­£åˆ™è¡¨è¾¾å¼æ‹…å¿ƒã€‚</li><li>ä¸éœ€è¦è¿è¡Œæ—¶ä¾èµ–ã€‚</li><li>æ­£åˆ™è¡¨è¾¾å¼ä¸éœ€è¦ä½¿ç”¨ Unicode åŒºé—´æ¥åˆ¤æ–­ç‰¹ç‚¹çš„å†…å®¹ã€‚</li><li>ä¸éœ€è¦ç”Ÿæˆæ­£åˆ™è¡¨è¾¾å¼è„šæœ¬ã€‚</li><li>Unicode å±æ€§è½¬ä¹‰è‡ªåŠ¨ä¿æŒæœ€æ–°ï¼Œæ¯å½“ Unicode æ ‡å‡†æ›´æ–°æ—¶ï¼ŒECMAScript å¼•æ“æ›´æ–°å…¶æ•°æ®å³å¯ã€‚</li></ol><h2><a href="https://github.com/tc39/proposal-object-rest-spread" target="_blank" rel="noopener">Rest/Spread å±æ€§</a></h2><p>ECMAScript 6 ä¸­å¢åŠ äº†æ•°ç»„çš„ Rest è§£æ„èµ‹å€¼å’Œ Spread è¯­æ³•ï¼Œæ¯”å¦‚ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a, b, rest</span><br><span class="line">[a, b, ...rest] = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>]</span><br><span class="line"><span class="built_in">console</span>.log(a) <span class="comment">// 10</span></span><br><span class="line"><span class="built_in">console</span>.log(b) <span class="comment">// 20</span></span><br><span class="line"><span class="built_in">console</span>.log(rest) <span class="comment">// [30, 40, 50]</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">x, y, z</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> x + y + z</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">sum(...numbers) <span class="comment">// 6</span></span><br><span class="line">sum.apply(<span class="literal">null</span>, numbers) <span class="comment">// 6</span></span><br></pre></td></tr></table></figure><p>ES2018 ä¸­å¢åŠ äº†å¯¹è±¡çš„ Rest å±æ€§å’Œ Spread è¯­æ³•ã€‚</p><h3>Rest å±æ€§</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> &#123;x, y, ...z&#125; = &#123;<span class="attr">x</span>:<span class="number">1</span>, <span class="attr">y</span>:<span class="number">2</span>, <span class="attr">a</span>:<span class="number">3</span>, <span class="attr">b</span>:<span class="number">4</span>&#125;</span><br><span class="line">x <span class="comment">// 1</span></span><br><span class="line">y <span class="comment">// 2</span></span><br><span class="line">z <span class="comment">// &#123;a:3, b: 4&#125;</span></span><br></pre></td></tr></table></figure><h3>Spread è¯­æ³•</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> n = &#123;x, y, ...z&#125;</span><br><span class="line">n <span class="comment">// &#123;x:1, y:2, a:3, b:4&#125;</span></span><br></pre></td></tr></table></figure><h2><a href="https://github.com/tc39/proposal-promise-finally" target="_blank" rel="noopener">Promise.prototype.finally</a></h2><p>Promise.prototype.finally æ—©å°±æœ‰å¾ˆå¤šå®ç°ï¼Œä»¥è‡³äºæˆ‘ä¸€ç›´éƒ½è®¤ä¸ºå®ƒæ˜¯åŸç”Ÿå¯¹è±¡çš„åŸå‹å±æ€§ã€‚å¸¸è§çš„å®ç°æœ‰ï¼š</p><ol><li><a href="http://bluebirdjs.com/docs/api/finally.html" target="_blank" rel="noopener">Bluebird#finally</a></li><li><a href="https://github.com/kriskowal/q/wiki/API-Reference#promisefinallycallback" target="_blank" rel="noopener">Q#finally</a></li><li><a href="https://github.com/cujojs/when/blob/master/docs/api.md#promisefinally" target="_blank" rel="noopener">when#finally</a></li><li><a href="http://api.jquery.com/jQuery.ajax/#jqXHR" target="_blank" rel="noopener">jQuery jqXHR#always</a></li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Promise</span>.resolve(<span class="number">2</span>).finally(<span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;) <span class="comment">// will be resolved with 2</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Promise</span>.reject(<span class="number">3</span>).finally(<span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;) <span class="comment">// will be rejected with 3</span></span><br></pre></td></tr></table></figure><h2><a href="https://github.com/tc39/proposal-async-iteration" target="_blank" rel="noopener">Asynchronous Iteration</a></h2><p>å…³äº JavaScript çš„å¼‚æ­¥å¾ªç¯ï¼Œæˆ‘åœ¨ä¹‹å‰çš„æ–‡ç« <a href="https://lz5z.com/JavaScript-Loop-Async/">JavaScript å¾ªç¯ä¸å¼‚æ­¥</a>æœ‰è¿‡æ¢ç´¢ã€‚å¦‚ä»Š ECMAScript ä¸­æœ‰äº†å¯¹å¼‚æ­¥è¿­ä»£çš„åŸç”Ÿæ”¯æŒã€‚</p><h3>è¿­ä»£å™¨ Iterator</h3><p>ES6 ä¸­å¼•å…¥è¿­ä»£å™¨æ¥éå†æ•°ç»„ï¼ŒJavaScript ä¸­çš„è¿­ä»£å™¨æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæä¾› next() æ–¹æ³•ï¼Œç”¨æ¥è¿”å›åºåˆ—ä¸­çš„ä¸‹ä¸€é¡¹ï¼Œè¿™ä¸ªæ–¹æ³•åŒ…å«ä¸¤ä¸ªå±æ€§ï¼šdone å’Œ valueã€‚</p><p>è¿­ä»£å™¨å¯¹è±¡ä¸€æ—¦è¢«åˆ›å»ºï¼Œå°±å¯ä»¥åå¤è°ƒç”¨ next()ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">makeIterator</span> (<span class="params">array</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> nextIndex = <span class="number">0</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    next: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> nextIndex &lt; array.length ?</span><br><span class="line">        &#123;<span class="attr">value</span>: array[nextIndex++], <span class="attr">done</span>: <span class="literal">false</span>&#125; :</span><br><span class="line">        &#123;<span class="attr">done</span>: <span class="literal">true</span>&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åˆå§‹åŒ–å next() æ–¹æ³•å¯ä»¥ç”¨æ¥ä¾æ¬¡è®¿é—®å¯¹è±¡ä¸­çš„é”®å€¼</span></span><br><span class="line"><span class="keyword">var</span> it = makeIterator([<span class="string">'a'</span>, <span class="string">'b'</span>])</span><br><span class="line"><span class="built_in">console</span>.log(it.next().value) <span class="comment">// 'a'</span></span><br><span class="line"><span class="built_in">console</span>.log(it.next().value) <span class="comment">// 'b'</span></span><br><span class="line"><span class="built_in">console</span>.log(it.next().done)  <span class="comment">// true</span></span><br></pre></td></tr></table></figure><h3>å¯è¿­ä»£å¯¹è±¡</h3><p>å¸¸è§çš„å¯è¿­ä»£å¯¹è±¡æœ‰ï¼šArrayã€Stringã€TypedArrayã€Mapã€Setã€‚è¿™äº›å¯¹è±¡éƒ½å†…ç½®å¯è¿­ä»£çš„å¯¹è±¡ï¼Œåœ¨å…¶åŸå‹ä¸­æœ‰ä¸€ä¸ª <code>Symbol.iterator</code> æ–¹æ³•ã€‚</p><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥å®šä¹‰å¯è¿­ä»£å¯¹è±¡ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myIterable = &#123;&#125;</span><br><span class="line">myIterable[<span class="built_in">Symbol</span>.iterator] = <span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">1</span></span><br><span class="line">  <span class="keyword">yield</span> <span class="number">2</span></span><br><span class="line">  <span class="keyword">yield</span> <span class="number">3</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> value <span class="keyword">of</span> myIterable) &#123; </span><br><span class="line">  <span class="built_in">console</span>.log(value)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> [a, b, c] = [...myIterable] <span class="comment">// [1, 2, 3]</span></span><br><span class="line"><span class="comment">// a ===1; b === 2; c === 3</span></span><br><span class="line"><span class="built_in">Array</span>.from(myIterable) <span class="comment">// [1, 2, 3]</span></span><br></pre></td></tr></table></figure><p>å½“æˆ‘ä»¬å®šä¹‰äº†å¯è¿­ä»£å¯¹è±¡åï¼Œå°±å¯ä»¥åœ¨ <code>Array.from</code>ã€<code>for...of</code> ä¸­ä½¿ç”¨è¿™ä¸ªå¯¹è±¡ã€‚</p><h3>å¼‚æ­¥è¿­ä»£å™¨</h3><p>ä¸€ä¸ªå¼‚æ­¥è¿­ä»£å™¨å°±åƒä¸€ä¸ªè¿­ä»£å™¨ï¼Œé™¤äº†å®ƒçš„ next() æ–¹æ³•è¿”å›ä¸€ä¸ª { value, done } çš„ promiseã€‚å¦‚ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬å¿…é¡»è¿”å›è¿­ä»£å™¨ç»“æœçš„ promiseï¼Œå› ä¸ºåœ¨è¿­ä»£å™¨æ–¹æ³•è¿”å›æ—¶ï¼Œè¿­ä»£å™¨çš„ä¸‹ä¸€ä¸ªå€¼å’Œ done çŠ¶æ€å¯èƒ½æœªçŸ¥ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myAsyncIterator = &#123;</span><br><span class="line">  [<span class="built_in">Symbol</span>.asyncIterator]: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> items = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>]</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    next: <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">Promise</span>.resolve(&#123;</span><br><span class="line">        done: items.length === <span class="number">0</span>,</span><br><span class="line">        value: items.shift()</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äºå¼‚æ­¥è¿­ä»£å™¨ï¼Œä½¿ç”¨ <code>for await of</code> è¿›è¡Œè¿­ä»£ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> <span class="keyword">await</span> (<span class="keyword">const</span> item <span class="keyword">of</span> myAsyncIterator) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(item)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure><h3>å¼‚æ­¥ç”Ÿæˆå™¨å‡½æ•°</h3><p>å¼‚æ­¥ç”Ÿæˆå™¨å‡½æ•°ä¸ç”Ÿæˆå™¨å‡½æ•°ç±»ä¼¼ï¼Œä½†æœ‰ä»¥ä¸‹åŒºåˆ«ï¼š</p><ol><li>å½“è¢«è°ƒç”¨æ—¶ï¼Œå¼‚æ­¥ç”Ÿæˆå™¨å‡½æ•°è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼šasync generatorï¼Œè¯¥å¯¹è±¡æœ‰ 3 ä¸ªæ–¹æ³•ï¼ˆnextï¼Œthrowï¼Œå’Œ returnï¼‰ï¼Œæ¯ä¸ªæ–¹æ³•éƒ½è¿”å›ä¸€ä¸ª Promiseï¼ŒPromise è¿”å› { value, done }ã€‚è€Œæ™®é€šç”Ÿæˆå™¨å‡½æ•°å¹¶ä¸è¿”å› Promiseï¼Œè€Œæ˜¯ç›´æ¥è¿”å› { value, done }ã€‚è¿™ä¼šè‡ªåŠ¨ä½¿è¿”å›çš„å¼‚æ­¥ç”Ÿæˆå™¨å¯¹è±¡å…·æœ‰å¼‚æ­¥è¿­ä»£çš„åŠŸèƒ½ã€‚</li><li>å…è®¸ä½¿ç”¨ await è¡¨è¾¾å¼å’Œ for-await-of è¯­å¥ã€‚</li><li>ä¿®æ”¹äº† <code>yield*</code> çš„è¡Œä¸ºä»¥æ”¯æŒå¼‚æ­¥è¿­ä»£ã€‚</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span>* <span class="title">myAsyncGenerator</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> t = <span class="number">0</span></span><br><span class="line">  <span class="keyword">const</span> test = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        resolve(+<span class="keyword">new</span> <span class="built_in">Date</span>())</span><br><span class="line">      &#125;, <span class="number">1000</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">while</span> (t++ &lt; <span class="number">10</span>) &#123;</span><br><span class="line">      <span class="keyword">yield</span> <span class="keyword">await</span> test()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'finally'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">main</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> <span class="keyword">await</span> (<span class="keyword">const</span> item <span class="keyword">of</span> myAsyncGenerator()) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(item)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">main()</span><br></pre></td></tr></table></figure><p>å‡½æ•°è¿”å›ä¸€ä¸ªå¼‚æ­¥ç”Ÿæˆå™¨ï¼ˆasync generatorï¼‰å¯¹è±¡ï¼Œå¯ä»¥ç”¨åœ¨ for-await-of è¯­å¥ä¸­ä½¿ç”¨ã€‚</p><h2>å‚è€ƒæ–‡æ¡£</h2><ul><li><a href="http://esnext.justjavac.com/proposal/" target="_blank" rel="noopener">esnext</a></li><li><a href="https://juejin.im/post/5b2a186cf265da596d04a648" target="_blank" rel="noopener">[è¯‘] ES2018ï¼ˆES9ï¼‰çš„æ–°ç‰¹æ€§</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ECMAScript 2018 (ES9) åœ¨ 6 æœˆåº•æ­£å¼å‘å¸ƒï¼Œå¸¦æ¥äº†å¾ˆå¤šæ–°ç‰¹æ€§ã€‚å…³äº ES7 å’Œ ES8 ç›¸å…³çš„çŸ¥è¯†ï¼Œå¯ä»¥æŸ¥çœ‹è¿™ç¯‡æ–‡ç«  &lt;a href=&quot;https://lz5z.com/ES2016%E5%92%8CES2017%E5%AD%A6%E4%B9%A0/&quot;&gt;ES2016 å’Œ ES2017 å­¦ä¹ &lt;/a&gt;ã€‚ç›®å‰å¤§éƒ¨åˆ† ES7 å’Œ ES8 çš„ç‰¹æ€§éƒ½å¾—åˆ°ä¸»æµæµè§ˆå™¨çš„æ”¯æŒï¼Œè€Œ ES9 çš„æ–°ç‰¹æ€§è¿˜æœªèƒ½å®ç°å¾ˆå¥½çš„å…¼å®¹æ€§ã€‚&lt;/p&gt;
&lt;p&gt;å…³äº ES7/8/9 å…¨éƒ¨ç‰¹æ€§å¯ä»¥æŸ¥çœ‹ tc39 å®˜æ–¹çš„ &lt;a href=&quot;https://github.com/tc39/proposals/blob/master/finished-proposals.md&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;proposals&lt;/a&gt;ï¼Œè¿™äº›éƒ½æ˜¯æœ€åè¿›å…¥ stage 4 çš„ç‰¹æ€§ã€‚&lt;/p&gt;
&lt;p&gt;ES9 çš„æ–°ç‰¹æ€§ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Lifting template literal restriction æ¨¡æ¿è¯­æ³•ä¿®æ­£&lt;/li&gt;
&lt;li&gt;&lt;code&gt;s&lt;/code&gt; (dotAll) flag for regular expressions (æ­£åˆ™è¡¨è¾¾å¼ dotAll æ¨¡å¼)&lt;/li&gt;
&lt;li&gt;RegExp named capture groups (æ­£åˆ™è¡¨è¾¾å¼å‘½åæ•è·ç»„)&lt;/li&gt;
&lt;li&gt;Rest/Spread Properties (Rest/Spread å±æ€§)&lt;/li&gt;
&lt;li&gt;RegExp Lookbehind Assertions (æ­£åˆ™è¡¨è¾¾å¼åå‘(lookbehind)æ–­è¨€)&lt;/li&gt;
&lt;li&gt;RegExp Unicode Property Escapes (æ­£åˆ™è¡¨è¾¾å¼ Unicode è½¬ä¹‰)&lt;/li&gt;
&lt;li&gt;Promise.prototype.finally&lt;/li&gt;
&lt;li&gt;Asynchronous Iteration (å¼‚æ­¥è¿­ä»£å™¨)&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="ES2018" scheme="https://lz5z.com/tags/ES2018/"/>
    
      <category term="ES9" scheme="https://lz5z.com/tags/ES9/"/>
    
  </entry>
  
  <entry>
    <title>ã€Šæ·±å…¥æµ…å‡ºNode.jsã€‹-ç©è½¬è¿›ç¨‹</title>
    <link href="https://lz5z.com/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BANode-js-%E7%8E%A9%E8%BD%AC%E8%BF%9B%E7%A8%8B/"/>
    <id>https://lz5z.com/æ·±å…¥æµ…å‡ºNode-js-ç©è½¬è¿›ç¨‹/</id>
    <published>2018-06-18T17:28:28.000Z</published>
    <updated>2020-04-21T10:23:54.831Z</updated>
    
    <content type="html"><![CDATA[<h1>ç¬¬ä¹ç«  ç©è½¬è¿›ç¨‹</h1><p>Node åŸºäº V8 å¼•æ“æ„å»ºï¼Œé‡‡ç”¨å•çº¿ç¨‹æ¨¡å‹ï¼Œæ‰€æœ‰çš„ JavaScript å°†ä¼šè¿è¡Œåœ¨å•ä¸ªè¿›ç¨‹çš„å•ä¸ªçº¿ç¨‹ä¸Šï¼Œå®ƒå¸¦æ¥çš„å¥½å¤„æ˜¯ï¼šæ²¡æœ‰å¤šçº¿ç¨‹ä¸­å¸¸è§çš„é”ä»¥åŠçº¿ç¨‹åŒæ­¥çš„é—®é¢˜ï¼Œæ“ä½œç³»ç»Ÿåœ¨è°ƒåº¦æ—¶ä¹Ÿèƒ½å‡å°‘ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæé«˜ CPU ä½¿ç”¨ç‡ã€‚ä½†æ˜¯å¦‚ä»Š CPU åŸºæœ¬å‡æ˜¯å¤šæ ¸çš„ï¼ŒçœŸæ­£çš„æœåŠ¡å™¨å¾€å¾€è¿˜æœ‰å¤šä¸ª CPUï¼Œä¸€ä¸ª Node è¿›ç¨‹åªèƒ½åˆ©ç”¨ä¸€ä¸ªæ ¸ï¼Œè¿™å¸¦æ¥ç¡¬ä»¶èµ„æºçš„æµªè´¹ã€‚å¦å¤–ï¼ŒNode è¿è¡Œåœ¨å•çº¿ç¨‹ä¹‹ä¸Šï¼Œä¸€ä¸ªå•çº¿ç¨‹æŠ›å‡ºå¼‚å¸¸è€Œæ²¡æœ‰è¢«æ•è·ï¼Œå°†ä¼šå¯¼è‡´è¿›ç¨‹çš„å´©æºƒã€‚</p><p>ä¸¥æ ¼æ¥è¯´ï¼ŒNode å¹¶éçœŸæ­£çš„å•çº¿ç¨‹ï¼ŒNode è‡ªèº«ä¸­è¿˜æœ‰ I/O çº¿ç¨‹å­˜åœ¨ï¼Œè¿™äº› I/O çº¿ç¨‹ç”±åº•å±‚ libuv å¤„ç†ï¼Œè¿™éƒ¨åˆ†çº¿ç¨‹å¯¹äº JavaScript è€Œè¨€æ˜¯é€æ˜çš„ï¼Œåªæœ‰ C++ æ‰©å±•æ—¶æ‰ä¼šå…³æ³¨åˆ°ï¼ŒJavaScript ä»£ç è¿è¡Œåœ¨ V8 ä¸Šï¼Œæ˜¯å•çº¿ç¨‹çš„ã€‚</p><a id="more"></a><h2>æœåŠ¡å™¨å˜è¿</h2><ol><li>åŒæ­¥ï¼šæœ€æ—©æœåŠ¡å™¨æ˜¯åŒæ­¥æ¨¡å‹ï¼Œä¸€æ¬¡åªèƒ½å¤„ç†ä¸€ä¸ªè¯·æ±‚ï¼Œå…¶å®ƒè¯·æ±‚éƒ½éœ€è¦ç­‰å¾…å½“å‰è¯·æ±‚å¤„ç†å®Œæ¯•ã€‚å‡å¦‚æ¯æ¬¡å“åº”è€—æ—¶ä¸º N ç§’ï¼Œè¿™ç±»æœåŠ¡çš„ QPS ä¸º 1/Nã€‚</li><li>å¤åˆ¶è¿›ç¨‹ï¼šæ¯ä¸€ä¸ªè¿æ¥ä½¿ç”¨ä¸€ä¸ªè¿›ç¨‹æ¥æœåŠ¡ï¼Œé‡‡ç”¨è¿›ç¨‹çš„å¤åˆ¶å®ç°ï¼Œä»£ä»·éå¸¸æ˜‚è´µã€‚å‡å¦‚è¿›ç¨‹æ•°ä¸Šé™ä¸º Mï¼Œè¿™ç±»æœåŠ¡çš„ QPS ä¸º M/Nã€‚</li><li>å¤šçº¿ç¨‹ï¼šä¸€ä¸ªçº¿ç¨‹å¤„ç†ä¸€ä¸ªè¯·æ±‚ï¼Œçº¿ç¨‹ç›¸å¯¹è¿›ç¨‹å¼€é”€è¦å°å¾ˆå¤šï¼Œçº¿ç¨‹ç›´æ¥å¯ä»¥å…±äº«æ•°æ®ï¼Œåˆ©ç”¨çº¿ç¨‹æ± å‡å°‘åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹çš„å¼€é”€ã€‚å‡å¦‚çº¿ç¨‹å ç”¨çš„èµ„æºä¸ºè¿›ç¨‹çš„ 1/Lï¼Œå®ƒçš„ QPS ä¸º M*L/Nã€‚</li><li>äº‹ä»¶é©±åŠ¨ï¼šNode å’Œ Nginx é‡‡ç”¨äº‹ä»¶é©±åŠ¨çš„æ–¹å¼å®ç°ï¼Œé¿å…äº†ä¸å¿…è¦çš„å†…å­˜å¼€é”€å’Œä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚äº‹ä»¶é©±åŠ¨æ¨¡å‹å­˜åœ¨çš„ä¸»è¦é—®é¢˜æ˜¯ CPU åˆ©ç”¨ç‡ä¸é«˜å’Œç¨‹åºå¥å£®æ€§ä¸èƒ½ä¿è¯ã€‚</li><li>åç¨‹ï¼šåŸºäºåç¨‹å®ç°çš„æœåŠ¡å™¨ï¼Œæ¯”å¦‚ Golang ç›®å‰ä¹Ÿéå¸¸æµè¡Œï¼Œåç¨‹æ˜¯ç”¨æˆ·çº§åˆ«çº¿ç¨‹ï¼Œå®ƒå¯¹äºå†…æ ¸é€æ˜ï¼Œå®Œå…¨ç”±ç”¨æˆ·è‡ªå·±è¿›è¡Œç¨‹åºä¹‹é—´çš„è°ƒç”¨ã€‚è¯¦ç»†å†…å®¹å¯ä»¥å‚è€ƒæˆ‘è¿™ç¯‡æ–‡ç« <a href="https://lz5z.com/Python%E5%8D%8F%E7%A8%8B/">Python åç¨‹</a>ã€‚</li></ol><h2>å¤šè¿›ç¨‹æ¶æ„</h2><p>Node æä¾› child_process æ¨¡å—æ¥å®ç°å¤šæ ¸ CPU çš„åˆ©ç”¨ã€‚child_process.fork() å‡½æ•°æ¥å®ç°è¿›ç¨‹çš„å¤åˆ¶ã€‚</p><p>worker.js ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>)</span><br><span class="line">http.createServer(<span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">  res.writeHead(<span class="number">200</span>, &#123; <span class="string">'Content-Type'</span>: <span class="string">'text/plain'</span> &#125;)</span><br><span class="line">  res.end(<span class="string">'Hello World\n'</span>)</span><br><span class="line">&#125;).listen(<span class="built_in">Math</span>.round((<span class="number">1</span> + <span class="built_in">Math</span>.random()) * <span class="number">1000</span>), <span class="string">'127.0.0.1'</span>)</span><br></pre></td></tr></table></figure><p>é€šè¿‡ <code>node worker.js</code> å¯åŠ¨å®ƒï¼Œä¼šç›‘å¬ 1000 åˆ° 2000 ä¹‹é—´çš„ä¸€ä¸ªéšæœºç«¯å£ã€‚</p><p>master.js ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fork = <span class="built_in">require</span>(<span class="string">'child_process'</span>).fork</span><br><span class="line"><span class="keyword">var</span> cpus = <span class="built_in">require</span>(<span class="string">'os'</span>).cpus()</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; cpus.length; i++) &#123;</span><br><span class="line">  fork(<span class="string">'./worker.js'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç æ ¹æ® CPU æ•°é‡å¤åˆ¶å‡ºå¯¹åº”çš„ Node è¿›ç¨‹æ•°ï¼ŒLinux ç³»ç»Ÿä¸‹é€šè¿‡ ps aux | grep worker.js æŸ¥çœ‹è¿›ç¨‹çš„æ•°é‡ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ps aux | grep worker.js</span></span><br><span class="line">lizhen 1475 0.0 0.0 2432768 600 s003 S+ 3:27AM 0:00.00 grep worker.js</span><br><span class="line">lizhen 1440 0.0 0.2 3022452 12680 s003 S 3:25AM 0:00.14 /usr/local/bin/node ./worker.js</span><br><span class="line">lizhen 1439 0.0 0.2 3023476 12716 s003 S 3:25AM 0:00.14 /usr/local/bin/node ./worker.js</span><br><span class="line">lizhen 1438 0.0 0.2 3022452 12704 s003 S 3:25AM 0:00.14 /usr/local/bin/node ./worker.js</span><br><span class="line">lizhen 1437 0.0 0.2 3031668 12696 s003 S 3:25AM 0:00.15 /usr/local/bin/node ./worker.js</span><br></pre></td></tr></table></figure><p>è¿™ç§é€šè¿‡ Master å¯å¤šä¸ª Worker çš„æ¨¡å¼å°±æ˜¯ä¸»ä»æ¨¡å¼ï¼Œè¿›ç¨‹è¢«åˆ†ä¸ºä¸»è¿›ç¨‹å’Œå·¥ä½œè¿›ç¨‹ã€‚ä¸»è¿›ç¨‹ä¸è´Ÿè´£å…·ä½“çš„ä¸šåŠ¡ï¼Œè€Œæ˜¯è´Ÿè´£è°ƒåº¦å’Œç®¡ç†å·¥ä½œè¿›ç¨‹ï¼Œå®ƒæ˜¯è¶‹äºç¨³å®šçš„ã€‚</p><p>é€šè¿‡ fork() å¤åˆ¶çš„è¿›ç¨‹éƒ½æ˜¯ç‹¬ç«‹çš„è¿›ç¨‹ï¼Œè¿™ä¸ªè¿›ç¨‹ä¸­æœ‰ç€ç‹¬ç«‹çš„ V8 å®ä¾‹ï¼Œå®ƒéœ€è¦è‡³å°‘ 30ms çš„å¯åŠ¨æ—¶é—´å’Œè‡³å°‘ 10MB çš„å†…å­˜ã€‚å› æ­¤ fork ä¾ç„¶æ˜¯æ˜‚è´µçš„ã€‚</p><h3>åˆ›å»ºå­è¿›ç¨‹</h3><p>child_process æ¨¡å—ç»™äºˆ Node å¯ä»¥éšæ„åˆ›å»ºå­è¿›ç¨‹çš„èƒ½åŠ›ï¼Œè¯¦ç»†çš„ä½¿ç”¨æ–¹æ³•å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š<a href="https://lz5z.com/Node.js%E4%B8%ADchild_procss%E6%A8%A1%E5%9D%97/">Node.js ä¸­ child_procss æ¨¡å—</a>ã€‚</p><ol><li>spawn() å¯åŠ¨ä¸€ä¸ªå­è¿›ç¨‹æ‰§è¡Œå‘½ä»¤ã€‚</li><li>exec() å¯åŠ¨å­è¿›ç¨‹æ‰§è¡Œå‘½ä»¤ï¼Œé€šè¿‡å›è°ƒå‡½æ•°è·å–å­è¿›ç¨‹çŠ¶æ€ã€‚</li><li>execFile() å¯åŠ¨ä¸€ä¸ªå­è¿›ç¨‹æ‰§è¡Œå¯æ‰§è¡Œæ–‡ä»¶ã€‚</li><li>fork() é€šè¿‡åˆ¶å®šéœ€è¦æ‰§è¡Œçš„ JavaScript æ–‡ä»¶åˆ›å»º Node å­è¿›ç¨‹ã€‚</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> cp = <span class="built_in">require</span>(<span class="string">'child_process'</span>)</span><br><span class="line">cp.spawn(<span class="string">'node'</span>, [<span class="string">'worker.js'</span>])</span><br><span class="line">cp.exec(<span class="string">'node worker.js'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, stdout, stderr</span>) </span>&#123;</span><br><span class="line"> <span class="comment">// some code</span></span><br><span class="line">&#125;)</span><br><span class="line">cp.execFile(<span class="string">'worker.js'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, stdout, stderr</span>) </span>&#123;</span><br><span class="line"> <span class="comment">// some code</span></span><br><span class="line">&#125;)</span><br><span class="line">cp.fork(<span class="string">'./worker.js'</span>)</span><br></pre></td></tr></table></figure><h3>è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡</h3><p>é¦–å…ˆæ¥çœ‹ä¸€ä¸ªç¤ºä¾‹ï¼š</p><p>parent.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> cp = <span class="built_in">require</span>(<span class="string">'child_process'</span>)</span><br><span class="line"><span class="keyword">var</span> n = cp.fork(__dirname + <span class="string">'/sub.js'</span>)</span><br><span class="line">n.on(<span class="string">'message'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">m</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'PARENT got message:'</span>, m)</span><br><span class="line">&#125;)</span><br><span class="line">n.send(&#123;<span class="attr">hello</span>: <span class="string">'world'</span>&#125;)</span><br></pre></td></tr></table></figure><p>sub.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">process.on(<span class="string">'message'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">m</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'CHILD got message:'</span>, m)</span><br><span class="line">&#125;)</span><br><span class="line">process.send(&#123;<span class="attr">foo</span>: <span class="string">'bar'</span>&#125;)</span><br></pre></td></tr></table></figure><p>é€šè¿‡ fork() æˆ–è€…å…¶å®ƒ APIï¼Œåˆ›å»ºå­è¿›ç¨‹ä¹‹åï¼Œä¸ºäº†å®çˆ¶å­ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼Œçˆ¶è¿›ç¨‹ä¸å­è¿›<br>ç¨‹ä¹‹é—´ä¼šåˆ›å»º IPC é€šé“ã€‚é€šè¿‡è¿‡ IPC é€šé“ï¼Œçˆ¶å­è¿›ç¨‹ä¹‹é—´æ‰èƒ½é€šè¿‡ message å’Œ send() ä¼ é€’ä¿¡æ¯ã€‚</p><blockquote><p>è¿›ç¨‹é—´é€šä¿¡åŸç†ï¼š<br>IPC å…¨ç§°æ˜¯ Inter-Process Communicationï¼Œå³è¿›ç¨‹é—´é€šä¿¡ï¼ŒNode å®ç° IPC ä½¿ç”¨ç®¡é“(pipe)æŠ€æœ¯ï¼Œå…·ä½“å®ç°ç»†èŠ‚ç”± libuv æä¾›ã€‚åœ¨ Windows ä¸‹ç”±å‘½åç®¡é“ï¼ˆnamed pipeï¼‰å®ç°ï¼ŒLinux ä¸‹é‡‡ç”¨ Unix Domain Socket å®ç°ã€‚è¡¨ç°åœ¨åº”ç”¨å±‚ä¸Šçš„è¿›ç¨‹é—´é€šä¿¡åªæœ‰ç®€å•çš„ message äº‹ä»¶å’Œ send() æ–¹æ³•ã€‚çˆ¶è¿›ç¨‹åœ¨å®é™…åˆ›å»ºå­è¿›ç¨‹ä¹‹å‰ï¼Œä¼šåˆ›å»º IPC é€šé“å¹¶ç›‘å¬å®ƒï¼Œç„¶åæ‰çœŸæ­£åˆ›å»ºå‡ºå­è¿›ç¨‹ï¼Œå¹¶ä¸”é€šè¿‡ç¯å¢ƒå˜é‡ NODE_CHANNEL_FD å‘Šè¯‰å­è¿›ç¨‹è¿™ä¸ª IPC é€šé“çš„<strong>æ–‡ä»¶æè¿°ç¬¦</strong>ã€‚å­è¿›ç¨‹é€šè¿‡è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦å»è¿æ¥è¿™ä¸ªå·²å­˜åœ¨çš„ IPC é€šé“ï¼Œä»è€Œå®Œæˆçˆ¶å­è¿›ç¨‹ä¹‹é—´çš„è¿æ¥ã€‚</p></blockquote><img src="/assets/img/process_ipc.png" alt="process_ipc"><p>ç”±äº IPC ç®¡é“æ˜¯ç”¨å‘½åç®¡é“æˆ–è€… Domain Socket åˆ›å»ºçš„ï¼Œä¸ç½‘ç»œ socket æ¯”è¾ƒç±»ä¼¼ï¼Œå±äºåŒå‘é€šè¡Œã€‚ä¸åŒçš„æ˜¯å®ƒä»¬åœ¨ç³»ç»Ÿå†…æ ¸ä¸­å°±å®Œæˆäº†è¿›ç¨‹é—´çš„é€šä¿¡ï¼Œè€Œä¸æ˜¯é€šè¿‡ç½‘ç»œå±‚ï¼Œéå¸¸é«˜æ•ˆã€‚</p><h3>å¥æŸ„ä¼ é€’</h3><p>é€šå¸¸æˆ‘ä»¬å¯ç”¨å¤šä¸ª Node è¿›ç¨‹çš„æ—¶å€™ï¼Œå‡å¦‚æ¯ä¸ªè¿›ç¨‹éƒ½ç›‘å¬ 80 ç«¯å£ï¼Œä¼šå¯¼è‡´ EADDRINUSE å¼‚å¸¸ï¼Œè§£å†³æ–¹æ¡ˆæ˜¯è®©æ¯ä¸ªè¿›ç¨‹ç›‘å¬ä¸åŒçš„ç«¯å£ï¼Œå…¶ä¸­ä¸»è¿›ç¨‹ç›‘å¬ 80ï¼Œå¯¹å¤–æ¥æ”¶æ‰€æœ‰çš„ç½‘ç»œè¯·æ±‚ï¼Œå†å°†è¿™äº›è¯·æ±‚ä»£ç†åˆ°ä¸åŒçš„ç«¯å£çš„è¿›ç¨‹ä¸Šã€‚</p><img src="/assets/img/process_80.png" alt="process_80"><p>é€šè¿‡ä»£ç†ä¸ä»…èƒ½è§£å†³ç«¯å£é‡å¤ç›‘å¬çš„é—®é¢˜ï¼Œè¿˜èƒ½é€‚å½“çš„åšè´Ÿè½½å‡è¡¡ã€‚ç”±äºè¿›ç¨‹æ¯æ¥æ”¶ä¸€ä¸ªè¿æ¥éƒ½ä¼šç”¨æ‰ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œå› æ­¤ä»£ç†æ–¹æ¡ˆä¸­å®¢æˆ·ç«¯è¿æ¥åˆ°ä»£ç†è¿›ç¨‹ï¼Œä»£ç†è¿›ç¨‹è¿æ¥åˆ°å·¥ä½œè¿›ç¨‹çš„è¿‡ç¨‹éœ€è¦ç”¨æ‰ä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œæ“ä½œç³»ç»Ÿçš„æ–‡ä»¶æè¿°ç¬¦æ˜¯æœ‰é™çš„ï¼Œä»£ç†æ–¹å¼éœ€è¦ä¸€å€æ•°é‡çš„æ–‡ä»¶æè¿°ç¬¦å½±å“äº†ç³»ç»Ÿçš„æ‰©å±•èƒ½åŠ›ã€‚</p><p>ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼ŒNode å¼•å…¥äº†è¿›ç¨‹é—´ä¼ é€’å¥æŸ„çš„åŠŸèƒ½ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">child.send(message, [sendHandle])</span><br></pre></td></tr></table></figure><p>å¥æŸ„æ˜¯ä¸€ç§å¯ä»¥ç”¨æ¥æ ‡è¯†èµ„æºçš„å¼•ç”¨ï¼Œæ¯”å¦‚å¥æŸ„å¯ä»¥æ ‡è¯†ä¸€ä¸ªæœåŠ¡å™¨ç«¯çš„ socket å¯¹è±¡ï¼Œä¸€ä¸ªå®¢æˆ·ç«¯çš„ socket å¯¹è±¡ï¼Œä¸€ä¸ª UDP scoketï¼Œä¸€ä¸ªç®¡é“ç­‰ã€‚</p><p>å‘é€å¥æŸ„æ„å‘³ç€ä¸»è¿›ç¨‹æ¥æ”¶åˆ° socket è¯·æ±‚åï¼Œç›´æ¥å°† socket å‘é€ç»™å·¥ä½œè¿›ç¨‹ï¼Œè€Œä¸æ˜¯é‡æ–°ä¸å·¥ä½œè¿›ç¨‹ä¹‹é—´å»ºç«‹æ–°çš„ socket è¿æ¥æ¥è½¬å‘æ•°æ®ã€‚</p><p>ä¸»è¿›ç¨‹ parent.jsï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> child = <span class="built_in">require</span>(<span class="string">'child_process'</span>).fork(<span class="string">'child.js'</span>)</span><br><span class="line"><span class="comment">// Open up the server object and send the handle</span></span><br><span class="line"><span class="keyword">var</span> server = <span class="built_in">require</span>(<span class="string">'net'</span>).createServer()</span><br><span class="line">server.on(<span class="string">'connection'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">socket</span>) </span>&#123;</span><br><span class="line">  socket.end(<span class="string">'handled by parent\n'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">server.listen(<span class="number">1337</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  child.send(<span class="string">'server'</span>, server)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>å­è¿›ç¨‹ child.jsï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">process.on(<span class="string">'message'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">m, server</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (m === <span class="string">'server'</span>) &#123;</span><br><span class="line">    server.on(<span class="string">'connection'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">socket</span>) </span>&#123;</span><br><span class="line">      socket.end(<span class="string">'handled by child\n'</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>é€šè¿‡ node å¯åŠ¨æŸ¥çœ‹æ•ˆæœï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// å…ˆå¯åŠ¨æœåŠ¡å™¨</span><br><span class="line"><span class="meta">$</span><span class="bash"> node parent.js</span></span><br><span class="line">// ä½¿ç”¨ curl å·¥å…·</span><br><span class="line"><span class="meta">$</span><span class="bash"> curl <span class="string">"http://127.0.0.1:1337"</span></span></span><br><span class="line">handled by parent</span><br><span class="line"><span class="meta">$</span><span class="bash"> curl <span class="string">"http://127.0.0.1:1337"</span></span></span><br><span class="line">handled by child</span><br><span class="line"><span class="meta">$</span><span class="bash"> curl <span class="string">"http://127.0.0.1:1337"</span></span></span><br><span class="line">handled by child</span><br><span class="line"><span class="meta">$</span><span class="bash"> curl <span class="string">"http://127.0.0.1:1337"</span></span></span><br><span class="line">handled by parent</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºçˆ¶å­è¿›ç¨‹éƒ½æœ‰å¯èƒ½å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ã€‚</p><p>å°è¯•å°†æœåŠ¡å‘é€ç»™å¤šä¸ªå­è¿›ç¨‹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// parent.js</span></span><br><span class="line"><span class="keyword">var</span> cp = <span class="built_in">require</span>(<span class="string">'child_process'</span>)</span><br><span class="line"><span class="keyword">var</span> child1 = cp.fork(<span class="string">'child.js'</span>)</span><br><span class="line"><span class="keyword">var</span> child2 = cp.fork(<span class="string">'child.js'</span>)</span><br><span class="line"><span class="comment">// Open up the server object and send the handle</span></span><br><span class="line"><span class="keyword">var</span> server = <span class="built_in">require</span>(<span class="string">'net'</span>).createServer()</span><br><span class="line">server.on(<span class="string">'connection'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">socket</span>) </span>&#123;</span><br><span class="line">  socket.end(<span class="string">'handled by parent\n'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">server.listen(<span class="number">1337</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  child1.send(<span class="string">'server'</span>, server)</span><br><span class="line">  child2.send(<span class="string">'server'</span>, server)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>å­è¿›ç¨‹å°†è¿›ç¨‹ ID æ‰“å°å‡ºæ¥ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// child.js</span></span><br><span class="line">process.on(<span class="string">'message'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">m, server</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (m === <span class="string">'server'</span>) &#123;</span><br><span class="line">    server.on(<span class="string">'connection'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">socket</span>) </span>&#123;</span><br><span class="line">      socket.end(<span class="string">'handled by child, pid is '</span> + process.pid + <span class="string">'\n'</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>é€šè¿‡ curl æµ‹è¯•ä¾ç„¶æ˜¯ç›¸åŒçš„ç»“æœï¼Œè¯·æ±‚å¯èƒ½è¢«çˆ¶è¿›ç¨‹å¤„ç†ï¼Œä¹Ÿå¯èƒ½è¢«ä¸åŒçš„å­è¿›ç¨‹å¤„ç†ã€‚å¹¶ä¸”è¿™äº›éƒ½æ˜¯åœ¨ TCP å±‚é¢å®Œæˆçš„äº‹æƒ…ã€‚æˆ‘ä»¬å°è¯•å°†å…¶æ”¹æˆ HTTP å±‚æ¥å¤„ç†ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// parent.js</span></span><br><span class="line"><span class="keyword">var</span> cp = <span class="built_in">require</span>(<span class="string">'child_process'</span>)</span><br><span class="line"><span class="keyword">var</span> child1 = cp.fork(<span class="string">'child.js'</span>)</span><br><span class="line"><span class="keyword">var</span> child2 = cp.fork(<span class="string">'child.js'</span>)</span><br><span class="line"><span class="comment">// Open up the server object and send the handle</span></span><br><span class="line"><span class="keyword">var</span> server = <span class="built_in">require</span>(<span class="string">'net'</span>).createServer()</span><br><span class="line">server.listen(<span class="number">1337</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  child1.send(<span class="string">'server'</span>, server)</span><br><span class="line">  child2.send(<span class="string">'server'</span>, server)</span><br><span class="line">  <span class="comment">// å…³é—­</span></span><br><span class="line">  server.close()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>å¯¹å­è¿›ç¨‹è¿›è¡Œæ”¹åŠ¨</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// child.js</span></span><br><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>)</span><br><span class="line"><span class="keyword">var</span> server = http.createServer(<span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">  res.writeHead(<span class="number">200</span>, &#123; <span class="string">'Content-Type'</span>: <span class="string">'text/plain'</span> &#125;)</span><br><span class="line">  res.end(<span class="string">'handled by child, pid is '</span> + process.pid + <span class="string">'\n'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">process.on(<span class="string">'message'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">m, tcp</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (m === <span class="string">'server'</span>) &#123;</span><br><span class="line">    tcp.on(<span class="string">'connection'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">socket</span>) </span>&#123;</span><br><span class="line">      server.emit(<span class="string">'connection'</span>, socket)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>é‡æ–°å¯åŠ¨ parent.js åï¼Œå†æ¬¡æµ‹è¯•ï¼Œæ‰€æœ‰çš„è¯·æ±‚éƒ½æ˜¯ç”±å­è¿›ç¨‹å¤„ç†äº†ã€‚æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡çš„è¿‡ç¨‹å‘ç”Ÿäº†ä¸€æ¬¡æ”¹å˜ï¼š</p><img src="/assets/img/process_handle.png" alt="process_handle"><p>ä¸»è¿›ç¨‹å‘é€å®Œå¥æŸ„å¹¶ä¸”å…³é—­ç›‘å¬ä¹‹åï¼Œæˆäº†ä¸‹å›¾çš„ç»“æ„ï¼š</p><img src="/assets/img/process_handle_1.png" alt="process_handle_1"><ol><li>å¥æŸ„å‘é€ä¸è¿˜åŸ</li><li>ç«¯å£å…±åŒç›‘å¬</li></ol><h2>é›†ç¾¤ç¨³å®šä¹‹è·¯</h2>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;ç¬¬ä¹ç«  ç©è½¬è¿›ç¨‹&lt;/h1&gt;
&lt;p&gt;Node åŸºäº V8 å¼•æ“æ„å»ºï¼Œé‡‡ç”¨å•çº¿ç¨‹æ¨¡å‹ï¼Œæ‰€æœ‰çš„ JavaScript å°†ä¼šè¿è¡Œåœ¨å•ä¸ªè¿›ç¨‹çš„å•ä¸ªçº¿ç¨‹ä¸Šï¼Œå®ƒå¸¦æ¥çš„å¥½å¤„æ˜¯ï¼šæ²¡æœ‰å¤šçº¿ç¨‹ä¸­å¸¸è§çš„é”ä»¥åŠçº¿ç¨‹åŒæ­¥çš„é—®é¢˜ï¼Œæ“ä½œç³»ç»Ÿåœ¨è°ƒåº¦æ—¶ä¹Ÿèƒ½å‡å°‘ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæé«˜ CPU ä½¿ç”¨ç‡ã€‚ä½†æ˜¯å¦‚ä»Š CPU åŸºæœ¬å‡æ˜¯å¤šæ ¸çš„ï¼ŒçœŸæ­£çš„æœåŠ¡å™¨å¾€å¾€è¿˜æœ‰å¤šä¸ª CPUï¼Œä¸€ä¸ª Node è¿›ç¨‹åªèƒ½åˆ©ç”¨ä¸€ä¸ªæ ¸ï¼Œè¿™å¸¦æ¥ç¡¬ä»¶èµ„æºçš„æµªè´¹ã€‚å¦å¤–ï¼ŒNode è¿è¡Œåœ¨å•çº¿ç¨‹ä¹‹ä¸Šï¼Œä¸€ä¸ªå•çº¿ç¨‹æŠ›å‡ºå¼‚å¸¸è€Œæ²¡æœ‰è¢«æ•è·ï¼Œå°†ä¼šå¯¼è‡´è¿›ç¨‹çš„å´©æºƒã€‚&lt;/p&gt;
&lt;p&gt;ä¸¥æ ¼æ¥è¯´ï¼ŒNode å¹¶éçœŸæ­£çš„å•çº¿ç¨‹ï¼ŒNode è‡ªèº«ä¸­è¿˜æœ‰ I/O çº¿ç¨‹å­˜åœ¨ï¼Œè¿™äº› I/O çº¿ç¨‹ç”±åº•å±‚ libuv å¤„ç†ï¼Œè¿™éƒ¨åˆ†çº¿ç¨‹å¯¹äº JavaScript è€Œè¨€æ˜¯é€æ˜çš„ï¼Œåªæœ‰ C++ æ‰©å±•æ—¶æ‰ä¼šå…³æ³¨åˆ°ï¼ŒJavaScript ä»£ç è¿è¡Œåœ¨ V8 ä¸Šï¼Œæ˜¯å•çº¿ç¨‹çš„ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Node" scheme="https://lz5z.com/categories/Node/"/>
    
    
      <category term="child_process" scheme="https://lz5z.com/tags/child-process/"/>
    
      <category term="Cluster" scheme="https://lz5z.com/tags/Cluster/"/>
    
  </entry>
  
  <entry>
    <title>ã€Šæ·±å…¥æµ…å‡ºNode.jsã€‹-WebSocket</title>
    <link href="https://lz5z.com/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BANode-js-WebSocket/"/>
    <id>https://lz5z.com/æ·±å…¥æµ…å‡ºNode-js-WebSocket/</id>
    <published>2018-06-08T11:58:26.000Z</published>
    <updated>2020-04-21T10:23:54.831Z</updated>
    
    <content type="html"><![CDATA[<h2>æ„å»º WebSocket æœåŠ¡</h2><p>WebSocket ä¸ Node ä¹‹é—´çš„é…åˆå¯ä»¥è¯´æ˜¯å¤©ä½œä¹‹åˆï¼šWebSocket å®¢æˆ·ç«¯åŸºäºäº‹ä»¶çš„ç¼–ç¨‹æ¨¡å‹ä¸ Node ä¸­è‡ªå®šä¹‰äº‹ä»¶ç›¸å·®æ— å‡ ï¼›WebSocket å®ç°äº†å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´çš„é•¿è¿æ¥ï¼Œè€Œ Node åœ¨ä¸å¤§é‡å®¢æˆ·ç«¯ä¹‹é—´ä¿æŒé«˜å¹¶å‘è¿æ¥æ–¹é¢éå¸¸æ“…é•¿ã€‚</p><p>WebSocket æœ‰ä»¥ä¸‹å¥½å¤„ï¼š</p><ol><li>å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´åªéœ€è¦å»ºç«‹ä¸€ä¸ª TCP è¿æ¥ï¼Œå¯ä»¥ä½¿ç”¨æ›´å°‘çš„è¿æ¥ã€‚</li><li>WebSocket æœåŠ¡å™¨å¯ä»¥æ¨é€æ•°æ®åˆ°å®¢æˆ·ç«¯ï¼Œæ¯” HTTP è¯·æ±‚å“åº”æ¨¡å‹æ›´çµæ´»ã€‚</li><li>WebSocket åè®®å¤´æ›´åŠ è½»é‡ï¼Œå‡å°‘æ•°æ®ä¼ è¾“ã€‚</li><li>WebSocket æ—¢å¯ä»¥å‘é€æ–‡æœ¬ï¼Œä¹Ÿå¯ä»¥å‘é€äºŒè¿›åˆ¶æ•°æ®ã€‚</li><li>WebSocket æ²¡æœ‰åŒæºé™åˆ¶ï¼Œå®¢æˆ·ç«¯å¯ä»¥ä¸ä»»æ„æœåŠ¡å™¨é€šä¿¡ã€‚</li><li>å»ºç«‹åœ¨ TCP åè®®ä¹‹ä¸Šï¼Œä¸ HTTP åè®®æœ‰å¾ˆå¥½çš„å…¼å®¹æ€§ï¼Œé»˜è®¤ç«¯å£ä¹Ÿæ˜¯ 80 å’Œ 443ã€‚</li></ol><a id="more"></a><p>WebSocket åœ¨å®¢æˆ·ç«¯çš„åº”ç”¨ç¤ºä¾‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ws = <span class="keyword">new</span> WebSocket(<span class="string">"wss://127.0.0.1:12010/updates"</span>)</span><br><span class="line"></span><br><span class="line">ws.onopen = <span class="function"><span class="keyword">function</span>(<span class="params">evt</span>) </span>&#123; </span><br><span class="line">  setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (socket.bufferedAmount == <span class="number">0</span>)</span><br><span class="line">      socket.send(getUpdateData())</span><br><span class="line">  &#125;, <span class="number">50</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ws.onmessage = <span class="function"><span class="keyword">function</span>(<span class="params">evt</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log( <span class="string">"Received Message: "</span> + evt.data);</span><br><span class="line">  ws.close()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ws.onclose = <span class="function"><span class="keyword">function</span>(<span class="params">evt</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"Connection closed."</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°å®¢æˆ·ç«¯ä»£ç ä¸æœåŠ¡å™¨å»ºç«‹ WebSocket è¿æ¥åï¼Œæ¯ 50 æ¯«ç§’å‘æœåŠ¡å™¨å‘é€ä¸€æ¬¡æ•°æ®ã€‚å¹¶ä¸”é€šè¿‡ onmessage æ¥å—æœåŠ¡ç«¯ä¼ æ¥çš„æ•°æ®ã€‚</p><p>åœ¨ WebSocket ä¹‹å‰ï¼ŒæœåŠ¡å™¨ä¸å®¢æˆ·ç«¯é€šä¿¡æœ€é«˜æ•ˆçš„æ˜¯ Comet æŠ€æœ¯ï¼Œå®ç°åŸç†ä¾èµ–äºé•¿è½®è¯¢æˆ– iframe æµã€‚é•¿è½®è¯¢æ˜¯å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼ŒæœåŠ¡å™¨åªæœ‰åœ¨è¶…æ—¶æˆ–è€…æ•°æ®å“åº”æ—¶æ–­å¼€è¿æ¥ï¼ˆres.end()ï¼‰ï¼Œå®¢æˆ·ç«¯åœ¨æ”¶åˆ°æ•°æ®æˆ–è€…è¶…æ—¶åé‡æ–°å‘èµ·è¯·æ±‚ï¼Œè¿™ä¸ªè¯·æ±‚æ‹–ç€é•¿é•¿çš„å°¾å·´ï¼Œæ‰€ä»¥ç”¨å½—æ˜Ÿå‘½åã€‚</p><p>ä½¿ç”¨ WebSocket æŠ€æœ¯ï¼Œå®¢æˆ·ç«¯åªéœ€è¦ä¿æŒä¸€ä¸ª TCP è¿æ¥å³å¯å®ŒæˆåŒå‘é€šä¿¡ï¼Œæ— éœ€é¢‘ç¹æ–­å¼€è¿æ¥å’Œé‡å‘è¯·æ±‚ã€‚</p><p>WebSocket åè®®ä¸»è¦åˆ†ä¸¤ä¸ªéƒ¨åˆ†ï¼šæ¡æ‰‹å’Œæ•°æ®ä¼ è¾“ã€‚</p><h3>WebSocket æ¡æ‰‹</h3><p>å®¢æˆ·ç«¯å»ºç«‹è¿æ¥æ—¶ï¼Œé€šè¿‡ HTTP å‘èµ·æŠ¥æ–‡è¯·æ±‚ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GET /chat HTTP/<span class="number">1.1</span></span><br><span class="line">Host: server.example.com</span><br><span class="line">Upgrade: websocket</span><br><span class="line">Connection: Upgrade</span><br><span class="line">Sec-WebSocket-Key: dGhlIHNhbXBsZSBub25jZQ==</span><br><span class="line">Sec-WebSocket-Protocol: chat, superchat</span><br><span class="line">Sec-WebSocket-Version: <span class="number">13</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­ Upgrade è¡¨ç¤ºè¯·æ±‚æœåŠ¡å™¨å‡çº§åè®®ä¸º WebSocketï¼›Sec-WebSocket-Protocol å’Œ Sec-WebSocket-Version è¡¨ç¤ºåè®®å’Œç‰ˆæœ¬å·ï¼›Sec-WebSocket-Key ç”¨äºå®‰å…¨æ ¡éªŒï¼Œæ˜¯ä¸€ä¸ªéšæœºç”Ÿæˆçš„ Base64 ç¼–ç çš„å­—ç¬¦ä¸²ï¼Œä¸æœåŠ¡å™¨å“åº”é¦–éƒ¨çš„ Sec-WebSocket-Accept æ˜¯é…å¥—ä½¿ç”¨çš„ï¼Œä¸º WebSocket æä¾›åŸºæœ¬é˜²æŠ¤ã€‚å…¶å¯¹åº”çš„ç®—æ³•å¦‚ä¸‹ï¼š</p><p>å°† Sec-WebSocket-Key è·Ÿ <code>258EAFA5-E914-47DA-95CA-C5AB0DC85B11</code> æ‹¼æ¥ï¼Œé€šè¿‡ SHA1 è®¡ç®—å‡ºæ‘˜è¦ï¼Œå¹¶è½¬æˆ base64 å­—ç¬¦ä¸²ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> crypto = <span class="built_in">require</span>(<span class="string">'crypto'</span>)</span><br><span class="line"><span class="keyword">var</span> magic = <span class="string">'258EAFA5-E914-47DA-95CA-C5AB0DC85B11'</span></span><br><span class="line"><span class="keyword">var</span> val = crypto.createHash(<span class="string">'sha1'</span>)</span><br><span class="line">.update(secWebSocketKey + magic)</span><br><span class="line">.digest(<span class="string">'bash64'</span>)</span><br></pre></td></tr></table></figure><p>æœåŠ¡å™¨å¤„ç†å®Œè¯·æ±‚åï¼Œå“åº”çš„æŠ¥æ–‡å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">HTTP/<span class="number">1.1</span> <span class="number">101</span> Switching Protocols</span><br><span class="line">Upgrade: websocket</span><br><span class="line">Connection: Upgrade</span><br><span class="line">Sec-WebSocket-Accept: s3pPLMBiTxaQ9kYGzzhZRbK+xOo=</span><br><span class="line">Sec-WebSocket-Protocol: chat</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯æ”¶åˆ°å“åº”åï¼Œä¼šæ ¡éªŒ Sec-WebSocket-Accept çš„å€¼ï¼Œå¦‚æœæˆåŠŸï¼Œå°±å¼€å§‹æ¥ä¸‹æ¥çš„æ•°æ®ä¼ è¾“ã€‚</p><h3>WebSocket æ•°æ®ä¼ è¾“</h3><p>æ¡æ‰‹é¡ºåˆ©å®Œæˆåï¼Œå°±å¼€å§‹ WebSocket æ•°æ®å¸§åè®®ï¼Œåè®®å‡çº§è¿‡ç¨‹å¦‚ä¸‹å›¾ï¼š</p><img src="/assets/img/webSocket-upgrade.png" alt="webSocket-upgrade"><p>æ¡æ‰‹å®Œæˆåï¼Œå®¢æˆ·ç«¯çš„ onopen() å°†ä¼šè¢«è§¦å‘ã€‚æœåŠ¡å™¨ç«¯æ²¡æœ‰ onopen() æ–¹æ³•ï¼Œä¸ºäº†å®Œæˆ TCP socket äº‹ä»¶åˆ° WebSocket äº‹ä»¶çš„å°è£…ï¼Œéœ€è¦åœ¨æ¥æ”¶æ•°æ®æ—¶è¿›è¡Œå¤„ç†ï¼ŒWebSocket çš„æ•°æ®å¸§åè®®åœ¨åº•å±‚çš„ data äº‹ä»¶ä¸Šå°è£…å®Œæˆçš„ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">WebSocket.prototype.setSocket = <span class="function"><span class="keyword">function</span> (<span class="params">socket</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.socket = socket</span><br><span class="line">  <span class="keyword">this</span>.socket.on(<span class="string">'data'</span>, <span class="keyword">this</span>.receiver)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯è°ƒç”¨ send() å‘é€æ•°æ®æ—¶ï¼ŒæœåŠ¡ç«¯å‡ºå‘ onmessage()ï¼›å½“æœåŠ¡å™¨è°ƒç”¨ send() å‘é€æ•°æ®æ—¶ï¼Œå®¢æˆ·ç«¯çš„ onmessage() è§¦å‘ã€‚send() å‘é€çš„æ•°æ®ä¼šè¢«åè®®å°è£…ä¸ºä¸€å¸§æˆ–è€…å¤šå¸§ï¼Œç„¶åé€å¸§å‘é€ã€‚</p><p>ä¸ºäº†å®‰å…¨è€ƒè™‘ï¼Œå®¢æˆ·ç«¯éœ€è¦å¯¹å‘é€çš„æ•°æ®å¸§è¿›è¡Œæ©ç å¤„ç†ï¼ŒæœåŠ¡å™¨ä¸€æ—¦æ”¶åˆ°æ— æ©ç å¸§çš„æ•°æ®ï¼Œè¿æ¥å°†å…³é—­ï¼›è€ŒæœåŠ¡å™¨çš„æ•°æ®åˆ™ä¸éœ€è¦æ©ç å¤„ç†ã€‚</p><h3>å®¢æˆ·ç«¯ <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/WebSocket" target="_blank" rel="noopener">API</a></h3><p>(1) WebSocket å¯¹è±¡ä½œä¸ºæ„é€ å‡½æ•°ï¼Œç”¨äºæ–°å»º WebSocket å®ä¾‹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ws = <span class="keyword">new</span> WebSocket(<span class="string">'ws://localhost:8080'</span>)</span><br></pre></td></tr></table></figure><p>(2) readyState</p><ul><li>CONNECTING0è¿æ¥è¿˜æ²¡å¼€å¯ã€‚</li><li>OPEN1è¿æ¥å·²å¼€å¯å¹¶å‡†å¤‡å¥½è¿›è¡Œé€šä¿¡ã€‚</li><li>CLOSING2è¿æ¥æ­£åœ¨å…³é—­çš„è¿‡ç¨‹ä¸­ã€‚</li><li>CLOSED3è¿æ¥å·²ç»å…³é—­ï¼Œæˆ–è€…è¿æ¥æ— æ³•å»ºç«‹ã€‚</li></ul><p>(3) äº‹ä»¶</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ws.onopen = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">ws.onclose = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">ws.onmessage = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// æœåŠ¡å™¨è¿”å›çš„æ•°æ®å¯èƒ½æ˜¯æ–‡æœ¬ï¼Œä¹Ÿå¯èƒ½æ˜¯äºŒè¿›åˆ¶</span></span><br><span class="line">&#125;</span><br><span class="line">ws.onerror = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;</span><br></pre></td></tr></table></figure><h3>åŸºäº Node çš„ WebSocket æœåŠ¡ç«¯å®ç°</h3><p><a href="https://socket.io/" target="_blank" rel="noopener">socket.io</a></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> app = <span class="built_in">require</span>(<span class="string">'express'</span>)()</span><br><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>).Server(app)</span><br><span class="line"><span class="keyword">var</span> io = <span class="built_in">require</span>(<span class="string">'socket.io'</span>)(http)</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">  res.sendFile(__dirname + <span class="string">'/index.html'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">io.on(<span class="string">'connection'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">socket</span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'a user connected'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">http.listen(<span class="number">3000</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'listening on *:3000'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2>æ€»ç»“</h2><p>åœ¨æ‰€æœ‰çš„ WebSocket æœåŠ¡å™¨å®ç°ä¸­ï¼ŒNode æœ€è´´è¿‘ WebSocket çš„ä½¿ç”¨æ–¹å¼ï¼š</p><ul><li>åŸºäºäº‹ä»¶çš„ç¼–ç¨‹æ¥å£</li><li>åŸºäº JavaScriptï¼ŒAPI åœ¨æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯é«˜åº¦ç›¸ä¼¼</li></ul><p>å¦å¤–ï¼ŒNode åŸºäºäº‹ä»¶é©±åŠ¨çš„æ–¹å¼ä½¿å¾—å®ƒåº”å¯¹ WebSocket è¿™ç±»é•¿è¿æ¥çš„åº”ç”¨åœºæ™¯æ—¶å¯ä»¥è½»æ¾å¤„ç†å¤§é‡å¹¶å‘è¯·æ±‚ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;æ„å»º WebSocket æœåŠ¡&lt;/h2&gt;
&lt;p&gt;WebSocket ä¸ Node ä¹‹é—´çš„é…åˆå¯ä»¥è¯´æ˜¯å¤©ä½œä¹‹åˆï¼šWebSocket å®¢æˆ·ç«¯åŸºäºäº‹ä»¶çš„ç¼–ç¨‹æ¨¡å‹ä¸ Node ä¸­è‡ªå®šä¹‰äº‹ä»¶ç›¸å·®æ— å‡ ï¼›WebSocket å®ç°äº†å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´çš„é•¿è¿æ¥ï¼Œè€Œ Node åœ¨ä¸å¤§é‡å®¢æˆ·ç«¯ä¹‹é—´ä¿æŒé«˜å¹¶å‘è¿æ¥æ–¹é¢éå¸¸æ“…é•¿ã€‚&lt;/p&gt;
&lt;p&gt;WebSocket æœ‰ä»¥ä¸‹å¥½å¤„ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´åªéœ€è¦å»ºç«‹ä¸€ä¸ª TCP è¿æ¥ï¼Œå¯ä»¥ä½¿ç”¨æ›´å°‘çš„è¿æ¥ã€‚&lt;/li&gt;
&lt;li&gt;WebSocket æœåŠ¡å™¨å¯ä»¥æ¨é€æ•°æ®åˆ°å®¢æˆ·ç«¯ï¼Œæ¯” HTTP è¯·æ±‚å“åº”æ¨¡å‹æ›´çµæ´»ã€‚&lt;/li&gt;
&lt;li&gt;WebSocket åè®®å¤´æ›´åŠ è½»é‡ï¼Œå‡å°‘æ•°æ®ä¼ è¾“ã€‚&lt;/li&gt;
&lt;li&gt;WebSocket æ—¢å¯ä»¥å‘é€æ–‡æœ¬ï¼Œä¹Ÿå¯ä»¥å‘é€äºŒè¿›åˆ¶æ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;WebSocket æ²¡æœ‰åŒæºé™åˆ¶ï¼Œå®¢æˆ·ç«¯å¯ä»¥ä¸ä»»æ„æœåŠ¡å™¨é€šä¿¡ã€‚&lt;/li&gt;
&lt;li&gt;å»ºç«‹åœ¨ TCP åè®®ä¹‹ä¸Šï¼Œä¸ HTTP åè®®æœ‰å¾ˆå¥½çš„å…¼å®¹æ€§ï¼Œé»˜è®¤ç«¯å£ä¹Ÿæ˜¯ 80 å’Œ 443ã€‚&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
      <category term="Node" scheme="https://lz5z.com/categories/Node/"/>
    
    
      <category term="WebSocket" scheme="https://lz5z.com/tags/WebSocket/"/>
    
  </entry>
  
  <entry>
    <title>ã€Šæ·±å…¥æµ…å‡ºNode.jsã€‹-ç½‘ç»œç¼–ç¨‹</title>
    <link href="https://lz5z.com/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BANode-js-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/"/>
    <id>https://lz5z.com/æ·±å…¥æµ…å‡ºNode-js-ç½‘ç»œç¼–ç¨‹/</id>
    <published>2018-05-30T00:12:53.000Z</published>
    <updated>2020-04-21T10:23:54.831Z</updated>
    
    <content type="html"><![CDATA[<h1>ç¬¬ä¸ƒç«  ç½‘ç»œç¼–ç¨‹</h1><p>Node ä¸­æä¾›äº† netï¼Œdgramï¼Œhttpï¼Œhttps å››ä¸ªæ¨¡å—ï¼Œåˆ†åˆ«ç”¨æ¥å¤„ç† TCPï¼ŒUDPï¼ŒHTTPï¼ŒHTTPSï¼Œé€‚ç”¨äºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ã€‚</p><h2>TCP</h2><p>TCP ä¼ è¾“æ§åˆ¶åè®®ï¼Œåœ¨ OSI æ¨¡å‹ä¸­å±äºä¼ è¾“å±‚ï¼Œè®¸å¤šåº”ç”¨å±‚çš„åè®®åŸºäº TCP æ„å»ºï¼Œæ¯”å¦‚ HTTPï¼ŒSMTPï¼ŒIMAP ç­‰ã€‚å›é¡¾ä¸€ä¸‹ OSI æ¨¡å‹ã€‚</p><ul><li>ç¬¬ 7 å±‚ï¼š<strong>åº”ç”¨å±‚</strong>ä¸ºæ“ä½œç³»ç»Ÿæˆ–ç½‘ç»œåº”ç”¨ç¨‹åºæä¾›è®¿é—®ç½‘ç»œæœåŠ¡çš„æ¥å£ã€‚åº”ç”¨å±‚åè®®çš„ä»£è¡¨åŒ…æ‹¬ï¼š HTTPï¼ŒHTTPSï¼ŒFTPï¼ŒTELNETï¼ŒSSHï¼ŒSMTPï¼ŒPOP3ç­‰ã€‚</li><li>ç¬¬ 6 å±‚ï¼š<strong>è¡¨ç¤ºå±‚</strong>æŠŠæ•°æ®è½¬æ¢ä¸ºæ¥å—è€…èƒ½å¤Ÿå…¼å®¹å¹¶ä¸”é€‚åˆä¼ è¾“çš„å†…å®¹ï¼Œæ¯”å¦‚æ•°æ®åŠ å¯†ï¼Œå‹ç¼©ï¼Œæ ¼å¼è½¬æ¢ç­‰ã€‚</li><li>ç¬¬ 5 å±‚ï¼š<strong>ä¼šè¯å±‚</strong>è´Ÿè´£æ•°æ®ä¼ è¾“ä¸­è®¾ç½®å’Œç»´æŒç½‘ç»œè®¾å¤‡ä¹‹é—´çš„é€šä¿¡è¿æ¥ã€‚ç®¡ç†ä¸»æœºä¹‹é—´çš„ä¼šè¯è¿›ç¨‹ï¼Œè¿˜å¯ä»¥åˆ©ç”¨åœ¨æ•°æ®ä¸­æ’å…¥æ ¡éªŒç‚¹æ¥å®ç°æ•°æ®çš„åŒæ­¥ã€‚</li><li>ç¬¬ 4 å±‚ï¼š<strong>ä¼ è¾“å±‚</strong>æŠŠä¼ è¾“è¡¨å¤´åŠ è‡³æ•°æ®å½¢æˆæ•°æ®åŒ…ï¼Œå®Œæˆç«¯åˆ°ç«¯çš„æ•°æ®ä¼ è¾“ã€‚ä¼ è¾“è¡¨å¤´åŒ…å«äº†åè®®ç­‰ä¿¡æ¯ï¼Œæ¯”å¦‚: TCPï¼ŒUDP ç­‰ã€‚</li><li>ç¬¬ 3 å±‚ï¼š<strong>ç½‘ç»œå±‚</strong>è´Ÿè´£å¯¹å­ç½‘é—´çš„æ•°æ®åŒ…è¿›è¡Œå¯»å€å’Œè·¯ç”±é€‰æ‹©ï¼Œè¿˜å¯ä»¥å®ç°æ‹¥å¡æ§åˆ¶ï¼Œç½‘é™…äº’è”ç­‰åŠŸèƒ½ã€‚ç½‘ç»œå±‚çš„åè®®åŒ…æ‹¬ï¼šIPï¼ŒIPX ç­‰ã€‚</li><li>ç¬¬ 2 å±‚ï¼š<strong>æ•°æ®é“¾è·¯å±‚</strong>åœ¨ä¸å¯é çš„ç‰©ç†ä»‹è´¨ä¸Šæä¾›å¯é çš„ä¼ è¾“ï¼Œä¸»è¦ä¸»è¦ä¸ºï¼šç‰©ç†åœ°å€å¯»å€ã€æ•°æ®å°è£…æˆå¸§ã€æµé‡æ§åˆ¶ã€æ•°æ®æ ¡éªŒã€é‡å‘ç­‰ã€‚</li><li>ç¬¬ 1 å±‚ï¼š<strong>ç‰©ç†å±‚</strong>åœ¨å±€åŸŸç½‘ä¸Šä¼ é€æ•°æ®å¸§ï¼Œè´Ÿè´£ç”µè„‘é€šä¿¡è®¾å¤‡ä¸ç½‘ç»œåª’ä½“ä¹‹é—´çš„äº’é€šï¼ŒåŒ…æ‹¬é’ˆè„šï¼Œç”µå‹ï¼Œçº¿ç¼†è§„èŒƒï¼Œé›†çº¿å™¨ï¼Œç½‘å¡ï¼Œä¸»æœºé€‚é…ç­‰ã€‚</li></ul><a id="more"></a><p>TCP æ˜¯é¢å‘è¿æ¥çš„åè®®ï¼Œå…¶æ˜¾è‘—ç‰¹å¾æ˜¯åœ¨ä¼ è¾“ä¹‹å‰éœ€è¦ 3 æ¬¡æ¡æ‰‹ã€‚åªæœ‰å»ºç«‹ä¼šè¯ï¼ŒæœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯æ‰èƒ½äº’ç›¸å‘é€æ•°æ®ï¼Œåœ¨å»ºç«‹ä¼šè¯çš„è¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯åˆ†åˆ«æä¾›ä¸€ä¸ª socketï¼Œè¿™ä¸¤ä¸ª socket å…±åŒå½¢æˆè¿æ¥ã€‚æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯é€šè¿‡ socket å®ç°ä¸¤è€…ä¹‹é—´è¿æ¥çš„æ“ä½œã€‚</p><h3>åˆ›å»º TCP æœåŠ¡ç«¯</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> net = <span class="built_in">require</span>(<span class="string">'net'</span>)</span><br><span class="line"><span class="keyword">var</span> server = net.createServer(<span class="function"><span class="keyword">function</span> (<span class="params">socket</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// æ–°çš„è¿æ¥</span></span><br><span class="line">  socket.on(<span class="string">'data'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    socket.write(<span class="string">'Hello'</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="comment">// æ–­å¼€è¿æ¥</span></span><br><span class="line">  socket.on(<span class="string">'end'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Socket end'</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  socket.write(<span class="string">'Welcome'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">server.listen(<span class="number">8124</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'server bound'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ telnet å·¥å…·ä½œä¸ºå®¢æˆ·ç«¯å¯¹åˆšæ‰åˆ›å»ºçš„æœåŠ¡å™¨è¿›è¡Œè¿æ¥ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> telnet 127.0.0.1 8124</span></span><br><span class="line">// éšæ„è¾“å…¥ä»»æ„å­—ç¬¦</span><br><span class="line"><span class="meta">$</span><span class="bash"> Hello</span></span><br></pre></td></tr></table></figure><p>åŒæ ·çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹ Domain Socket è¿›è¡Œç›‘å¬</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">server.listen(<span class="string">'/tmp/echo.sock'</span>)</span><br></pre></td></tr></table></figure><p>é€šè¿‡ net æ¨¡å—è‡ªè¡Œæ„å»ºå®¢æˆ·ç«¯è¿›è¡Œä¼šè¯ client.js:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> net = <span class="built_in">require</span>(<span class="string">'net'</span>)</span><br><span class="line"><span class="keyword">var</span> client = net.connect(&#123; <span class="attr">port</span>: <span class="number">8124</span> &#125;, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">//'connect' listener</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'client connected'</span>)</span><br><span class="line">  client.write(<span class="string">'world!\r\n'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">client.on(<span class="string">'data'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(data.toString())</span><br><span class="line">  client.end()</span><br><span class="line">&#125;)</span><br><span class="line">client.on(<span class="string">'end'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'client disconnected'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œå¦‚æœæ˜¯ Domain Socketï¼Œåœ¨å¡«å†™é€‰é¡¹æ—¶ï¼Œå¡«å†™ path å³å¯ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> client = net.connect(&#123;<span class="attr">path</span>: <span class="string">'/tmp/echo.sock'</span>&#125;)</span><br></pre></td></tr></table></figure><h3>TCP æœåŠ¡çš„äº‹ä»¶</h3><p>ä¸Šè¿°ä»£ç åˆ†ä¸ºæœåŠ¡ç«¯äº‹ä»¶å’Œè¿æ¥äº‹ä»¶ã€‚</p><p>(1) æœåŠ¡ç«¯äº‹ä»¶</p><p>å¯¹äº net.createServer() åˆ›å»ºçš„æœåŠ¡å™¨è€Œè¨€ï¼Œå®ƒæ˜¯ä¸€ä¸ª EventEmitter å®ä¾‹ï¼Œå®ƒçš„è‡ªå®šä¹‰äº‹ä»¶æœ‰å¦‚ä¸‹å‡ ç§ã€‚</p><ul><li>listeningï¼šåœ¨è°ƒç”¨ server.listen() ç»‘å®šç«¯å£æˆ– Domain Socket åè§¦å‘ï¼Œå¯ä»¥å†™ä½œ server.listen(port, listeningListener)ã€‚</li><li>connectionï¼šæ¯ä¸ªå®¢æˆ·ç«¯ socket è¿æ¥åˆ°æœåŠ¡å™¨æ—¶è§¦å‘ï¼Œå¯ä»¥å†™ä½œ net.createServer()ã€‚</li><li>closeï¼šæœåŠ¡å™¨å…³é—­æ—¶è§¦å‘ã€‚server.close() ä¼šåœæ­¢æ¥å—æ–°çš„ socketï¼Œä½†æ˜¯ä¿å­˜å·²æœ‰çš„è¿æ¥ï¼Œç­‰å¾…æ‰€æœ‰çš„è¿æ¥æ–­å¼€åè§¦å‘ã€‚</li><li>errorï¼šæœåŠ¡å™¨å‘ç”Ÿå¼‚å¸¸æ—¶è§¦å‘ã€‚</li></ul><p>(2) è¿æ¥äº‹ä»¶</p><p>æœåŠ¡å™¨å¯ä»¥ä¸å¤šä¸ªå®¢æˆ·ç«¯ä¿å­˜è¿æ¥ï¼Œæ¯ä¸ªè¿æ¥éƒ½æ˜¯å…¸å‹çš„å¯è¯»å¯å†™çš„ Stream å¯¹è±¡ã€‚å®ƒçš„è‡ªå®šä¹‰äº‹ä»¶æœ‰å¦‚ä¸‹å‡ ç§ã€‚</p><ul><li>dataï¼šå½“ä¸€ç«¯è°ƒç”¨ write() å‘é€æ•°æ®ï¼Œå¦å¤–ä¸€ç«¯è§¦å‘ data äº‹ä»¶ã€‚</li><li>endï¼šå½“è¿æ¥ä¸­çš„ä»»ä¸€ç«¯å‘é€ FIN æ•°æ®æ—¶ï¼Œè§¦å‘è¯¥äº‹ä»¶ã€‚</li><li>connectï¼šå®¢æˆ·ç«¯ socket ä¸æœåŠ¡å™¨è¿æ¥æˆåŠŸé€‚è§¦å‘ã€‚</li><li>drainï¼šrain å’Œ socket.write() çš„è¿”å›å€¼å¼ºå…³è”ï¼Œå½“ä»»æ„ä¸€ç«¯è°ƒç”¨ write()ï¼Œå½“å‰è¿™ç«¯ä¼šè§¦å‘è¯¥äº‹ä»¶ã€‚</li><li>errorï¼šå¼‚å¸¸æ—¶è§¦å‘ã€‚</li><li>closeï¼šsocket å…³é—­æ—¶è§¦å‘ã€‚</li><li>timeoutï¼šä¸€å®šæ—¶é—´è¿æ¥ä¸å†æ´»è·ƒæ—¶ï¼Œè¯¥äº‹ä»¶è§¦å‘ï¼Œé€šçŸ¥ç”¨æˆ·å½“å‰è¿æ¥å·²ç»é—²ç½®ã€‚</li></ul><p>TCP socket ä¸ºå¯è¯»å¯å†™ Stream å¯¹è±¡ï¼Œå¯ä»¥ç”¨ pipe() å®ç°ç®¡é“æ“ä½œã€‚å¦‚ä¸‹ä»£ç å®ç° echo æœåŠ¡å™¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> net = <span class="built_in">require</span>(<span class="string">'net'</span>)</span><br><span class="line"><span class="keyword">var</span> server = net.createServer(<span class="function"><span class="keyword">function</span>(<span class="params">socket</span>) </span>&#123;</span><br><span class="line">  socket.write(<span class="string">'Echo server\r\n'</span>)</span><br><span class="line">  socket.pipe(socket)</span><br><span class="line">&#125;)</span><br><span class="line">server.listen(<span class="number">1337</span>, <span class="string">'127.0.0.1'</span>)</span><br></pre></td></tr></table></figure><p>TCP å¯¹ç½‘ç»œä¸­çš„å°æ•°æ®åŒ…æœ‰ä¸€å®šçš„ä¼˜åŒ–ç­–ç•¥ï¼šNagle ç®—æ³•ï¼Œç”¨æ¥å‡å°‘ç½‘ç»œä¸­å°æ•°æ®åŒ…ã€‚Nagle ç®—æ³•é’ˆå¯¹è¿™ç§æƒ…å†µï¼Œè¦æ±‚ç¼“å†²åŒºæ•°æ®è¾¾åˆ°ä¸€å®šæ•°é‡æˆ–è€…ä¸€å®šæ—¶é—´åæ‰å°†å…¶å‘å‡ºï¼Œå¹¶ä¸” Nagle ç®—æ³•åˆå¹¶å°æ•°æ®åŒ…ï¼Œä¸€æ¬¡ä¼˜åŒ–ç½‘ç»œã€‚ä½†æ˜¯å¯èƒ½é€ æˆæ•°æ®å»¶è¿Ÿå‘é€ã€‚</p><p>Node ä¸­é»˜è®¤å¼€å¯ Nagle ç®—æ³•ï¼Œå¯ä»¥è°ƒç”¨ socket.setNoDelay(true) å…³é—­ Nagle ç®—æ³•ï¼Œä½¿å¾— write() å¯ä»¥ç«‹å³å‘é€æ•°æ®åˆ°ç½‘ç»œä¸­ã€‚</p><h2>æ„å»º UDP æœåŠ¡</h2><p>UDP åˆç§°ä¸ºç”¨æˆ·æ•°æ®åŒ…æœåŠ¡ï¼Œä¸ TCP ä¸€æ ·å±äºç½‘ç»œä¼ è¾“å±‚ã€‚UDP ä¸æ˜¯é¢å‘è¿æ¥çš„ï¼ŒTCP ä¸­ä¸€æ—¦å»ºç«‹è¿æ¥ï¼Œæ‰€æœ‰çš„ä¼šè¯éƒ½æ˜¯åŸºäºè¿æ¥å®Œæˆï¼Œå®¢æˆ·ç«¯å¦‚æœè¦ä¸å¦ä¸€ä¸ª TCP æœåŠ¡åŒå­¦ï¼Œéœ€è¦å¦åˆ›å»ºä¸€ä¸ª socket å¤„ç†ã€‚åœ¨ UDP ä¸­ï¼Œä¸€ä¸ª socket å¯ä»¥ä¸å¤šä¸ª UDP æœåŠ¡é€šä¿¡ã€‚</p><p>UDP æä¾›é¢å‘äº‹ç‰©çš„ä¸å¯é ä¼ è¾“æœåŠ¡ï¼Œåœ¨ç½‘ç»œå·®çš„æƒ…å†µä¸‹å­˜åœ¨ä¸¢åŒ…çš„é—®é¢˜ï¼Œä½†æ˜¯å®ƒæ— é¡»è¿æ¥ï¼Œèµ„æºæ¶ˆè€—ä½ï¼Œå¤„ç†å¿«é€Ÿä¸”çµæ´»ï¼Œficoé€‚ç”¨äºé‚£äº›å¶å°”ä¸¢ä¸€ä¸¤ä¸ªæ•°æ®åŒ…ä¹Ÿä¸ä¼šäº§ç”Ÿé—®é¢˜çš„åœºæ™¯ï¼Œæ¯”å¦‚éŸ³é¢‘ã€è§†é¢‘ç­‰ã€‚DNS æœåŠ¡åŸºäº UDP å®ç°ã€‚</p><h3>åˆ›å»º UDP socket</h3><p>UDP socket æ—¢å¯ä»¥ä½œä¸ºæœåŠ¡ç«¯ï¼Œåˆå¯ä»¥ä½œä¸ºå®¢æˆ·ç«¯ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> dgram = <span class="built_in">require</span>(<span class="string">'dgram'</span>)</span><br><span class="line"><span class="keyword">var</span> socket = dgram.createSocket(<span class="string">'upd4'</span>)</span><br></pre></td></tr></table></figure><p>(1) åˆ›å»º UDP æœåŠ¡å™¨</p><p>é€šè¿‡è°ƒç”¨ dgram.bind(port, [address]) æ–¹æ³•åˆ›å»º UDP æœåŠ¡å™¨ï¼Œæ¥æ”¶ç½‘è·¯æ¶ˆæ¯ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> dgram = <span class="built_in">require</span>(<span class="string">'dgram'</span>)</span><br><span class="line"><span class="keyword">var</span> server = dgram.createSocket(<span class="string">'udp4'</span>)</span><br><span class="line">server.on(<span class="string">'message'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">msg, rinfo</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'server got: '</span> + msg + <span class="string">' from '</span> +</span><br><span class="line">    rinfo.address + <span class="string">':'</span> + rinfo.port)</span><br><span class="line">&#125;)</span><br><span class="line">server.on(<span class="string">'listening'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> address = server.address()</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'server listening '</span> +</span><br><span class="line">    address.address + <span class="string">':'</span> + address.port)</span><br><span class="line">&#125;)</span><br><span class="line">server.bind(<span class="number">41234</span>)</span><br></pre></td></tr></table></figure><p>(2) åˆ›å»º UDP å®¢æˆ·ç«¯</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> dgram = <span class="built_in">require</span>(<span class="string">'dgram'</span>)</span><br><span class="line"><span class="keyword">var</span> message = Buffer.alloc(<span class="number">13</span>, <span class="string">'Hello Node.js'</span>)</span><br><span class="line"><span class="keyword">var</span> client = dgram.createSocket(<span class="string">'udp4'</span>)</span><br><span class="line">client.send(message, <span class="number">0</span>, message.length, <span class="number">41234</span>, <span class="string">'localhost'</span>,</span><br><span class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">err, bytes</span>) </span>&#123;</span><br><span class="line">    client.close()</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯æ‰§è¡Œåï¼ŒæœåŠ¡ç«¯è¾“å‡ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> node main.js</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> server listening 0.0.0.0:41234</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> server got: Hello Node.js from 127.0.0.1:61286</span></span><br></pre></td></tr></table></figure><p>å½“ socket åœ¨å®¢æˆ·ç«¯æ—¶ï¼Œå¯ä»¥è°ƒç”¨ send() æ–¹æ³•å‘ç”Ÿæ¶ˆæ¯åˆ°ç½‘ç»œã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">socket.send(buf, offset, length, port, address, [callback])</span><br></pre></td></tr></table></figure><p>(3) UDP socket äº‹ä»¶</p><p>UDP ç›¸å¯¹äº TCP æ›´ç®€å•ï¼Œå®ƒåªæ˜¯ä¸€ä¸ª EventEmitter çš„å®ä¾‹ï¼Œè€Œé Stream çš„å®ä¾‹ã€‚å®ƒè‡ªå®šä¹‰äº‹ä»¶å¦‚ä¸‹ï¼š</p><ul><li>messageï¼šå½“ UDP socket ä¾¦å¬ç½‘å¡ç«¯å£åï¼Œæ¥æ”¶åˆ°æ¶ˆæ¯æ—¶è§¦å‘è¯¥äº‹ä»¶ã€‚</li><li>listeningï¼šå½“ UDP å¼€å§‹ä¾¦å¬æ—¶è§¦å‘è¯¥äº‹ä»¶ã€‚</li><li>closeï¼šè°ƒç”¨ close() æ–¹æ³•æ—¶è§¦å‘è¯¥äº‹ä»¶ï¼Œå¹¶ä¸å†è§¦å‘ message äº‹ä»¶ã€‚</li><li>errorï¼šå‘ç”Ÿå¼‚å¸¸æ—¶è§¦å‘è¯¥äº‹ä»¶ã€‚</li></ul><h2>æ„å»º HTTP æœåŠ¡</h2><p>TCP ä¸ UDP éƒ½å±äºç½‘ç»œä¼ è¾“å±‚åè®®ï¼Œå¦‚æœè¦æ„é€ é«˜æ•ˆçš„ç½‘ç»œåº”ç”¨ï¼Œå°±åº”è¯¥ä»ä¼ è¾“å±‚è¿›è¡Œç€æ‰‹ã€‚ä½†æ˜¯ä¸€èˆ¬ä½¿ç”¨åº”ç”¨å±‚åè®®å°±èƒ½æ»¡è¶³æˆ‘ä»¬å¤§éƒ¨åˆ†å¼€å‘éœ€æ±‚ã€‚Node æä¾›åŸºæœ¬çš„ http å’Œ https æ¨¡å—ç”¨äº HTTP å’Œ HTTPS çš„å°è£…ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>)</span><br><span class="line">http.createServer(<span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">  res.writeHead(<span class="number">200</span>, &#123;<span class="string">'Content-Type'</span>: <span class="string">'text/plain'</span>&#125;)</span><br><span class="line">  res.end(<span class="string">'Hello World'</span>)</span><br><span class="line">&#125;).listen(<span class="number">1337</span>, <span class="string">'127.0.0.1'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'Server running at http://127.0.0.1:1337/'</span>)</span><br></pre></td></tr></table></figure><h3>HTTP</h3><p>HTTP æ„å»ºäº TCP ä¹‹ä¸Šï¼Œå±äºåº”ç”¨å±‚åè®®ã€‚</p><p>ä½¿ç”¨ curl æŸ¥çœ‹ç½‘ç»œé€šä¿¡çš„æŠ¥æ–‡ä¿¡æ¯ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> curl -v http://127.0.0.1:1337</span></span><br><span class="line">* About to connect() to 127.0.0.1 port 1337 (#0)</span><br><span class="line">*   Trying 127.0.0.1...</span><br><span class="line">* Connected to 127.0.0.1 (127.0.0.1) port 1337 (#0)</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> GET / HTTP/1.1</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> User-Agent: curl/7.29.0</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> Host: 127.0.0.1:1337</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> Accept: */*</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> </span></span><br><span class="line">&lt; HTTP/1.1 200 OK</span><br><span class="line">&lt; Date: Mon, 04 Jun 2018 15:34:30 GMT</span><br><span class="line">&lt; Connection: keep-alive</span><br><span class="line">&lt; Transfer-Encoding: chunked</span><br><span class="line">&lt; </span><br><span class="line">Hello World</span><br><span class="line">* Connection #0 to host 127.0.0.1 left intact</span><br><span class="line">* Closing connection #0</span><br></pre></td></tr></table></figure><p>æŠ¥æ–‡è§£æï¼š</p><p>(1) TCP ä¸‰æ¬¡æ¡æ‰‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* About to connect() to 127.0.0.1 port 1337 (#0)</span><br><span class="line">*   Trying 127.0.0.1...</span><br><span class="line">* Connected to 127.0.0.1 (127.0.0.1) port 1337 (#0)</span><br></pre></td></tr></table></figure><p>(2) å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€è¯·æ±‚æŠ¥æ–‡</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> GET / HTTP/1.1</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> User-Agent: curl/7.29.0</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> Host: 127.0.0.1:1337</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> Accept: */*</span></span><br><span class="line"><span class="meta">&gt;</span></span><br></pre></td></tr></table></figure><p>(3) æœåŠ¡å™¨å“åº”å®¢æˆ·ç«¯å†…å®¹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt; HTTP/1.1 200 OK</span><br><span class="line">&lt; Date: Mon, 04 Jun 2018 15:34:30 GMT</span><br><span class="line">&lt; Connection: keep-alive</span><br><span class="line">&lt; Transfer-Encoding: chunked</span><br><span class="line">&lt; </span><br><span class="line">Hello World</span><br></pre></td></tr></table></figure><p>(4) ç»“æŸä¼šè¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* Connection #0 to host 127.0.0.1 left intact</span><br><span class="line">* Closing connection #0</span><br></pre></td></tr></table></figure><p>ä»ä¸Šè¿°æŠ¥æ–‡ä¿¡æ¯ä¸­å¯ä»¥çœ‹å‡º HTTP çš„ç‰¹ç‚¹ï¼šåŸºäºè¯·æ±‚å“åº”å¼çš„ï¼Œä»¥ä¸€é—®ä¸€ç­”çš„æ–¹å¼å®ç°æœåŠ¡ï¼Œè™½ç„¶åŸºäº TCP ä¼šè¯ï¼Œä½†æ˜¯æœ¬èº«å¹¶æ— ä¼šè¯çš„ç‰¹ç‚¹ã€‚</p><h3>http æ¨¡å—</h3><p>Node çš„ http æ¨¡å—åŒ…å«å¯¹ HTTP å¤„ç†çš„å°è£…ï¼Œåœ¨ Node ä¸­ï¼ŒHTTP æœåŠ¡ç»§æ‰¿è‡ª TCP æœåŠ¡ï¼ˆnet æ¨¡å—ï¼‰ï¼Œå®ƒèƒ½å¤Ÿä¸å¤šä¸ªå®¢æˆ·ç«¯ä¿æŒè¿æ¥ï¼Œé‡‡ç”¨äº‹ä»¶é©±åŠ¨çš„å½¢å¼ï¼Œå¹¶ä¸ä¸ºæ¯ä¸€ä¸ªè¿æ¥åˆ›å»ºé¢å¤–çš„çº¿ç¨‹æˆ–è€…è¿›ç¨‹ï¼Œå ç”¨å¾ˆä½çš„å†…å­˜ï¼Œå¹¶ä¸”å®ç°é«˜å¹¶å‘ã€‚</p><p>HTTP æœåŠ¡ä¸ TCP æœåŠ¡çš„åŒºåˆ«åœ¨äºï¼Œå¼€å¯ keepalive åï¼Œä¸€ä¸ª TCP ä¼šè¯å¯ä»¥ç”¨äºå¤šæ¬¡è¯·æ±‚å’Œå“åº”ï¼ŒTCP ä»¥ connection ä¸ºå•ä½è¿›è¡ŒæœåŠ¡ï¼ŒHTTP æœåŠ¡ä»¥ request ä¸ºå•ä½è¿›è¡ŒæœåŠ¡ã€‚http æ¨¡å—å³æ˜¯å°† connection åˆ° request çš„è¿‡ç¨‹è¿›è¡Œäº†å°è£…ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œhttp æ¨¡å—å°†è¿æ¥æ‰€ç”¨çš„ socket çš„è¯»å†™æŠ½è±¡ä¸º ServerRequest å’Œ ServerResponse å¯¹è±¡ï¼Œå®ƒä»¬åˆ†åˆ«å¯¹åº”è¯·æ±‚å’Œå“åº”æ“ä½œã€‚åœ¨è¯·æ±‚äº§ç”Ÿçš„è¿‡ç¨‹ä¸­ï¼Œhttp æ¨¡å—æ‹¿åˆ°è¿æ¥ä¸­ä¼ æ¥çš„æ•°æ®ï¼Œè°ƒç”¨äºŒè¿›åˆ¶æ¨¡å— http_parser è¿›è¡Œè§£æï¼Œåœ¨è§£æå®Œè¯·æ±‚æŠ¥æ–‡çš„æŠ¥å¤´åï¼Œè§¦å‘ request äº‹ä»¶ï¼Œè°ƒç”¨ç”¨æˆ·çš„ä¸šåŠ¡é€»è¾‘ã€‚</p><p>(1) HTTP è¯·æ±‚</p><p>å¯¹äº TCP è¿æ¥çš„è¯»æ“ä½œï¼Œhttp æ¨¡å—å°†å…¶å°è£…ä¸º ServerRequest å¯¹è±¡ã€‚æŠ¥å¤´é€šè¿‡ http_parser è¿›è¡Œè§£æã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> GET / HTTP/1.1</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> User-Agent: curl/7.29.0</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> Host: 127.0.0.1:1337</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> Accept: */*</span></span><br><span class="line"><span class="meta">&gt;</span></span><br></pre></td></tr></table></figure><ul><li>req.method å±æ€§ï¼š GET</li><li>req.url å±æ€§ï¼š /</li><li>req.httpVersion å±æ€§ï¼š 1.1<br>å…¶ä½™æŠ¥å¤´æ˜¯å¾ˆè§„å¾‹çš„ key: Value æ ¼å¼ï¼Œè¢«è§£æåæ”¾ç½®åœ¨ req.headers å±æ€§ä¸Šä¼ é€’ç»™ä¸šåŠ¡é€»è¾‘è°ƒç”¨ã€‚</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">headers: &#123;</span><br><span class="line">  'user-agent': 'curl/7.29.0',</span><br><span class="line">  host: '127.0.0.7:1337',</span><br><span class="line">  accept: '*/*'</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŠ¥æ–‡ä½“éƒ¨åˆ†åˆ™æŠ½è±¡ä¸ºä¸€ä¸ªåªè¯»æµå¯¹è±¡ï¼Œå¦‚æœä¸šåŠ¡é€»è¾‘éœ€è¦è¯»å–æŠ¥æ–‡ä½“ä¸­çš„æ•°æ®ï¼Œåˆ™è¦åœ¨è¿™ä¸ªæ•°æ®æµç»“æŸåæ‰èƒ½è¿›è¡Œæ“ä½œã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> buffers = []</span><br><span class="line">  req.on(<span class="string">'data'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">trunk</span>) </span>&#123;</span><br><span class="line">    buffers.push(trunk)</span><br><span class="line">  &#125;).on(<span class="string">'end'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> buffer = Buffer.concat(buffers)</span><br><span class="line">    res.end(<span class="string">''</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(2) HTTP å“åº”</p><p>HTTP å“åº”å¯¹è±¡å°è£…äº†åº•å±‚è¿æ¥çš„å†™æ“ä½œï¼Œå¯ä»¥å°†å…¶çœ‹ä½œä¸€ä¸ªå¯å†™çš„æµå¯¹è±¡ï¼Œé€šè¿‡ res.setHeader() å’Œ res.writeHead() å“åº”æŠ¥æ–‡å¤´éƒ¨ä¿¡æ¯ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">res.writeHead(<span class="number">200</span>, &#123;<span class="string">'Content-Type'</span>: <span class="string">'text/plain'</span>&#125;)</span><br></pre></td></tr></table></figure><p>è½¬åŒ–ä¸ºæŠ¥æ–‡å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt; HTTP/1.1 200 OK</span><br><span class="line">&lt; Content-Type: text/plain</span><br></pre></td></tr></table></figure><p>setHeader å¯ä»¥è¿›è¡Œå¤šæ¬¡è°ƒç”¨ï¼Œä½†åªæœ‰è°ƒç”¨ writeHead åï¼ŒæŠ¥æ–‡æ‰ä¼šå†™å…¥åˆ°è¿æ¥ä¸­ï¼Œæ­¤å¤–ï¼Œhttp æ¨¡å—è¿˜ä¼šè‡ªåŠ¨è®¾ç½®ä¸€äº›å¤´ä¿¡æ¯ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt; Date: Mon, 04 Jun 2018 15:34:30 GMT</span><br><span class="line">&lt; Connection: keep-alive</span><br><span class="line">&lt; Transfer-Encoding: chunked</span><br><span class="line">&lt;</span><br></pre></td></tr></table></figure><p>æŠ¥æ–‡ä½“åˆ™æ˜¯é€šè¿‡è°ƒç”¨ res.write() å’Œ res.end() æ–¹æ³•å®ç°ï¼ŒåŒºåˆ«åœ¨äº res.end() ä¼šè°ƒç”¨ write() å‘é€æ•°æ®ï¼Œç„¶åå‘é€ä¿¡å·å‘ŠçŸ¥æœåŠ¡å™¨è¿™æ¬¡å“åº”ç»“æŸã€‚</p><p>å“åº”ç»“æŸåï¼ŒHTTP æœåŠ¡å™¨å¯èƒ½å°†å½“æœŸè¿æ¥ç”¨äºä¸‹ä¸€æ¬¡è¯·æ±‚ï¼Œæˆ–è€…å…³é—­è¿æ¥ã€‚å¦å¤–ï¼Œæ— æ³•æœåŠ¡å™¨åœ¨å¤„ç†ä¸šåŠ¡é€»è¾‘æ—¶æ˜¯å¦å‘ç”Ÿå¼‚å¸¸ï¼ŒåŠ¡å¿…åœ¨ç»“æŸæ—¶è°ƒç”¨ res.end() ç»“æŸè¯·æ±‚ï¼Œå¦åˆ™å®¢æˆ·ç«¯å°†ä¸€ç›´å¤„äºç­‰å¾…çš„çŠ¶æ€ã€‚å½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡å»¶è¿Ÿ res.end() çš„æ–¹å¼å®ç°å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´çš„é•¿è¿æ¥ï¼Œä½†ç»“æŸæ—¶åŠ¡å¿…å…³é—­è¿æ¥ã€‚</p><p>(3) HTTP æœåŠ¡çš„äº‹ä»¶</p><p>HTTP æœåŠ¡å™¨æŠ½è±¡äº†ä¸€äº›äº‹ä»¶ï¼Œä¾›åº”ç”¨å±‚ä½¿ç”¨ï¼ŒæœåŠ¡å™¨ä¹Ÿæ˜¯ä¸€ä¸ª EventEmitter å®ä¾‹ã€‚</p><ul><li>connection äº‹ä»¶ï¼šHTTP è¯·æ±‚å“åº”å‰è§¦å‘ï¼Œå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨å»ºç«‹åº•å±‚çš„ TCP è¿æ¥æ—¶è§¦å‘ã€‚</li><li>request äº‹ä»¶ï¼šå»ºç«‹ TCP è¿æ¥åï¼Œhttp æ¨¡å—åº•å±‚å°†åœ¨æ•°æ®æµä¸­æŠ½è±¡å‡º HTTP è¯·æ±‚å’Œå“åº”ï¼Œå½“è§£æå‡º HTTP è¯·æ±‚å¤´æ—¶ï¼Œè§¦å‘è¯¥äº‹ä»¶ã€‚</li><li>close äº‹ä»¶ï¼šè°ƒç”¨ server.close() æ–¹æ³•åœæ­¢æ¥å—æ–°çš„è¿æ¥ï¼Œå¹¶ä¸”å·²æœ‰è¿æ¥å…¨éƒ¨æ–­å¼€æ—¶è§¦å‘ã€‚</li><li>checkContinue äº‹ä»¶ï¼šå®¢æˆ·ç«¯å‘é€è¾ƒå¤§çš„æ•°æ®æ—¶ï¼Œå¹¶ä¸ä¼šç›´æ¥å°†æ•°æ®å‘é€ï¼Œè€Œæ˜¯å…ˆå‘ä¸€ä¸ªå¤´éƒ¨å¸¦ <code>Expect: 100-continue</code> çš„è¯·æ±‚åˆ°æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å°†è§¦å‘ checkContinue äº‹ä»¶ã€‚å¦‚æœæœåŠ¡å™¨æ²¡æœ‰ç›‘å¬è¿™ä¸ªäº‹ä»¶ï¼Œåˆ™ä¼šè‡ªåŠ¨å“åº”å®¢æˆ·ç«¯ 100 Continue çš„çŠ¶æ€ç ï¼Œè¡¨ç¤ºæ¥å—æ•°æ®ä¸Šä¼ ã€‚å¦‚æœä¸æ¥å—ï¼Œæˆ–è€…å®¢æˆ·ç«¯æ•°æ®è¾ƒå¤šæ—¶ï¼Œå“åº” 400 Bad Request æ‹’ç»å®¢æˆ·ç«¯ç»§ç»­å‘é€æ•°æ®ã€‚</li><li>connect äº‹ä»¶ï¼šå½“å®¢æˆ·ç«¯å‘èµ· CONNECT è¯·æ±‚æ—¶è§¦å‘ã€‚è€Œå‘èµ· CONNECT è¯·æ±‚é€šå¸¸åœ¨ HTTP ä»£ç†æ—¶å‡ºç°ï¼Œå¦‚æœä¸ç›‘å¬è¯¥äº‹ä»¶ï¼Œå‘èµ·è¯·æ±‚çš„è¿æ¥å°†ä¼šå…³é—­ã€‚</li><li>upgrade äº‹ä»¶ï¼šå®¢æˆ·ç«¯è¦æ±‚å‡çº§è¿æ¥åè®®æ—¶è§¦å‘ã€‚</li><li>clientError äº‹ä»¶ï¼šè¿æ¥çš„å®¢æˆ·ç«¯è§¦å‘ error äº‹ä»¶æ—¶ï¼Œè¿™ä¸ªé”™è¯¯ä¼šä¼ é€’åˆ°æœåŠ¡å™¨ï¼Œæ­¤æ—¶è§¦å‘è¯¥äº‹ä»¶ã€‚</li></ul><p>(4) HTTP å®¢æˆ·ç«¯</p><p>http æ¨¡å—é€šè¿‡è°ƒç”¨ http.request(options, connect) æ„é€ å®¢æˆ·ç«¯ã€‚ä¸ä¸Šæ–‡çš„ curl å¤§è‡´ç›¸åŒï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> options = &#123;</span><br><span class="line">  hostname: <span class="string">'127.0.0.1'</span>,</span><br><span class="line">  port: <span class="number">1334</span>,</span><br><span class="line">  path: <span class="string">'/'</span>,</span><br><span class="line">  method: <span class="string">'GET'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> req = http.request(options, <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'STATUS: '</span> + res.statusCode)</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'HEADERS: '</span> + <span class="built_in">JSON</span>.stringify(res.headers))</span><br><span class="line">  res.setEncoding(<span class="string">'utf8'</span>)</span><br><span class="line">  res.on(<span class="string">'data'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">chunk</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(chunk)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">req.end()</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> node client.js</span></span><br><span class="line">STATUS: 200</span><br><span class="line">HEADERS: &#123;"date":"Mon, 04 Jun 2018 15:34:30 GMT","connection":"keep-alive","transfer-encoding":"chunked"&#125;</span><br><span class="line">Hello World</span><br></pre></td></tr></table></figure><p>options ä¸­é€‰é¡¹æœ‰å¦‚ä¸‹è¿™äº›ï¼š</p><ul><li>host</li><li>hostname</li><li>portï¼šé»˜è®¤ 80</li><li>localAddressï¼šå»ºç«‹ç½‘ç»œè¿æ¥çš„æœ¬åœ°ç½‘å¡</li><li>socketPath</li><li>methodï¼šé»˜è®¤ä¸º GET</li><li>pathï¼šè¯·æ±‚è·¯å¾„ï¼Œé»˜è®¤ä¸º /</li><li>headers</li><li>auth: Basic è®¤è¯ï¼Œè¿™ä¸ªå€¼å°†è¢«è®¡ç®—æˆè¯·æ±‚å¤´ä¸­çš„ Authorization éƒ¨åˆ†ã€‚</li></ul><p>(5) HTTP ä»£ç†</p><p>http æä¾›çš„ ClientRequest å¯¹è±¡ä¹Ÿæ˜¯åŸºäº TCP å±‚å®ç°çš„ï¼Œåœ¨ keepalive çš„æƒ…å†µä¸‹ï¼Œä¸€ä¸ªåº•å±‚çš„ä¼šè¯è¿æ¥å¯ä»¥ç”¨äºå¤šæ¬¡è¯·æ±‚ã€‚ä¸ºäº†é‡ç”¨ TCP è¿æ¥ï¼Œhttp æ¨¡å—åŒ…å«ä¸€ä¸ªé»˜è®¤çš„å®¢æˆ·ç«¯ä»£ç†å¯¹è±¡ http.globalAgentã€‚</p><p>http.globalAgent å¯¹æ¯ä¸ªæœåŠ¡å™¨ç«¯ï¼ˆhost + portï¼‰åˆ›å»ºçš„è¿æ¥è¿›è¡Œç®¡ç†ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ªè¯·æ±‚æœ€å¤šå¯ä»¥åˆ›å»º 5 ä¸ªè¿æ¥ï¼Œå®ƒçš„å®è´¨æ˜¯ä¸€ä¸ªè¿æ¥æ± ã€‚</p><p>è°ƒç”¨ HTTP å®¢æˆ·ç«¯å¯¹ä¸€ä¸ªæœåŠ¡å™¨å‘èµ· 10 æ¬¡ HTTP è¯·æ±‚æ—¶ï¼Œå…¶å®è´¨åªæœ‰ 5 ä¸ªè¯·æ±‚å¤„äºå¹¶å‘çŠ¶æ€ï¼Œåç»­çš„è¯·æ±‚éœ€è¦ç­‰å¾…æŸä¸ªè¯·æ±‚å®Œæˆåæ‰çœŸæ­£å‘å‡ºï¼Œä¸æµè§ˆå™¨å¯¹åŒä¸€åŸŸåçš„å¹¶å‘é™åˆ¶ç›¸åŒã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> agent = <span class="keyword">new</span> http.Agent(&#123;</span><br><span class="line">  maxSockets: <span class="number">10</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">var</span> options = &#123;</span><br><span class="line">  hostname: <span class="string">'127.0.0.1'</span>,</span><br><span class="line">  port: <span class="number">1334</span>,</span><br><span class="line">  path: <span class="string">'/'</span>,</span><br><span class="line">  method: <span class="string">'GET'</span>,</span><br><span class="line">  agent: agent</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥è®¾ç½® agent é€‰é¡¹ä¸º falseï¼Œä»¥è„±ç¦»è¿æ¥æ± ç®¡ç†ï¼Œä½¿è¯·æ±‚ä¸å—å¹¶å‘é™åˆ¶ã€‚</p><p>(6) HTTP å®¢æˆ·ç«¯äº‹ä»¶</p><ul><li>responseï¼šå®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡å™¨çš„å“åº”æ—¶è§¦å‘ã€‚</li><li>socketï¼šå½“åº•å±‚è¿æ¥æ± ä¸­ç®€å†çš„è¿æ¥åˆ†é…ç»™å½“å‰è¯·æ±‚å¯¹è±¡æ—¶è§¦å‘è¯¥äº‹ä»¶ã€‚</li><li>connectï¼šå®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘èµ· CONNECT è¯·æ±‚æ—¶ï¼Œå¦‚æœæœåŠ¡å™¨å“åº”äº† 200 çŠ¶æ€ç ï¼Œå®¢æˆ·ç«¯è§¦å‘ã€‚</li><li>upgradeï¼šå®¢æˆ·ç«¯å‘èµ· Upgrade è¯·æ±‚æ—¶ï¼Œå¦‚æœæœåŠ¡å™¨å“åº”äº† 101 Switching Protocols çŠ¶æ€ï¼Œå®¢æˆ·ç«¯è§¦å‘ã€‚</li><li>continueï¼šå®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘èµ· Expect: 100-continue å¤´ä¿¡æ¯ï¼ŒæœåŠ¡æœåŠ¡å™¨å“åº” 100 Continue çŠ¶æ€ï¼Œå®¢æˆ·ç«¯è§¦å‘ã€‚</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;ç¬¬ä¸ƒç«  ç½‘ç»œç¼–ç¨‹&lt;/h1&gt;
&lt;p&gt;Node ä¸­æä¾›äº† netï¼Œdgramï¼Œhttpï¼Œhttps å››ä¸ªæ¨¡å—ï¼Œåˆ†åˆ«ç”¨æ¥å¤„ç† TCPï¼ŒUDPï¼ŒHTTPï¼ŒHTTPSï¼Œé€‚ç”¨äºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ã€‚&lt;/p&gt;
&lt;h2&gt;TCP&lt;/h2&gt;
&lt;p&gt;TCP ä¼ è¾“æ§åˆ¶åè®®ï¼Œåœ¨ OSI æ¨¡å‹ä¸­å±äºä¼ è¾“å±‚ï¼Œè®¸å¤šåº”ç”¨å±‚çš„åè®®åŸºäº TCP æ„å»ºï¼Œæ¯”å¦‚ HTTPï¼ŒSMTPï¼ŒIMAP ç­‰ã€‚å›é¡¾ä¸€ä¸‹ OSI æ¨¡å‹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¬¬ 7 å±‚ï¼š&lt;strong&gt;åº”ç”¨å±‚&lt;/strong&gt;ä¸ºæ“ä½œç³»ç»Ÿæˆ–ç½‘ç»œåº”ç”¨ç¨‹åºæä¾›è®¿é—®ç½‘ç»œæœåŠ¡çš„æ¥å£ã€‚åº”ç”¨å±‚åè®®çš„ä»£è¡¨åŒ…æ‹¬ï¼š HTTPï¼ŒHTTPSï¼ŒFTPï¼ŒTELNETï¼ŒSSHï¼ŒSMTPï¼ŒPOP3ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;ç¬¬ 6 å±‚ï¼š&lt;strong&gt;è¡¨ç¤ºå±‚&lt;/strong&gt;æŠŠæ•°æ®è½¬æ¢ä¸ºæ¥å—è€…èƒ½å¤Ÿå…¼å®¹å¹¶ä¸”é€‚åˆä¼ è¾“çš„å†…å®¹ï¼Œæ¯”å¦‚æ•°æ®åŠ å¯†ï¼Œå‹ç¼©ï¼Œæ ¼å¼è½¬æ¢ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;ç¬¬ 5 å±‚ï¼š&lt;strong&gt;ä¼šè¯å±‚&lt;/strong&gt;è´Ÿè´£æ•°æ®ä¼ è¾“ä¸­è®¾ç½®å’Œç»´æŒç½‘ç»œè®¾å¤‡ä¹‹é—´çš„é€šä¿¡è¿æ¥ã€‚ç®¡ç†ä¸»æœºä¹‹é—´çš„ä¼šè¯è¿›ç¨‹ï¼Œè¿˜å¯ä»¥åˆ©ç”¨åœ¨æ•°æ®ä¸­æ’å…¥æ ¡éªŒç‚¹æ¥å®ç°æ•°æ®çš„åŒæ­¥ã€‚&lt;/li&gt;
&lt;li&gt;ç¬¬ 4 å±‚ï¼š&lt;strong&gt;ä¼ è¾“å±‚&lt;/strong&gt;æŠŠä¼ è¾“è¡¨å¤´åŠ è‡³æ•°æ®å½¢æˆæ•°æ®åŒ…ï¼Œå®Œæˆç«¯åˆ°ç«¯çš„æ•°æ®ä¼ è¾“ã€‚ä¼ è¾“è¡¨å¤´åŒ…å«äº†åè®®ç­‰ä¿¡æ¯ï¼Œæ¯”å¦‚: TCPï¼ŒUDP ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;ç¬¬ 3 å±‚ï¼š&lt;strong&gt;ç½‘ç»œå±‚&lt;/strong&gt;è´Ÿè´£å¯¹å­ç½‘é—´çš„æ•°æ®åŒ…è¿›è¡Œå¯»å€å’Œè·¯ç”±é€‰æ‹©ï¼Œè¿˜å¯ä»¥å®ç°æ‹¥å¡æ§åˆ¶ï¼Œç½‘é™…äº’è”ç­‰åŠŸèƒ½ã€‚ç½‘ç»œå±‚çš„åè®®åŒ…æ‹¬ï¼šIPï¼ŒIPX ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;ç¬¬ 2 å±‚ï¼š&lt;strong&gt;æ•°æ®é“¾è·¯å±‚&lt;/strong&gt;åœ¨ä¸å¯é çš„ç‰©ç†ä»‹è´¨ä¸Šæä¾›å¯é çš„ä¼ è¾“ï¼Œä¸»è¦ä¸»è¦ä¸ºï¼šç‰©ç†åœ°å€å¯»å€ã€æ•°æ®å°è£…æˆå¸§ã€æµé‡æ§åˆ¶ã€æ•°æ®æ ¡éªŒã€é‡å‘ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;ç¬¬ 1 å±‚ï¼š&lt;strong&gt;ç‰©ç†å±‚&lt;/strong&gt;åœ¨å±€åŸŸç½‘ä¸Šä¼ é€æ•°æ®å¸§ï¼Œè´Ÿè´£ç”µè„‘é€šä¿¡è®¾å¤‡ä¸ç½‘ç»œåª’ä½“ä¹‹é—´çš„äº’é€šï¼ŒåŒ…æ‹¬é’ˆè„šï¼Œç”µå‹ï¼Œçº¿ç¼†è§„èŒƒï¼Œé›†çº¿å™¨ï¼Œç½‘å¡ï¼Œä¸»æœºé€‚é…ç­‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="Node" scheme="https://lz5z.com/categories/Node/"/>
    
    
      <category term="TCP" scheme="https://lz5z.com/tags/TCP/"/>
    
      <category term="ç½‘ç»œ" scheme="https://lz5z.com/tags/%E7%BD%91%E7%BB%9C/"/>
    
      <category term="UDP" scheme="https://lz5z.com/tags/UDP/"/>
    
      <category term="OSI" scheme="https://lz5z.com/tags/OSI/"/>
    
  </entry>
  
  <entry>
    <title>ã€Šæ·±å…¥æµ…å‡ºNode.jsã€‹-ç†è§£Buffer</title>
    <link href="https://lz5z.com/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BANode-js-%E7%90%86%E8%A7%A3Buffer/"/>
    <id>https://lz5z.com/æ·±å…¥æµ…å‡ºNode-js-ç†è§£Buffer/</id>
    <published>2018-05-28T22:11:29.000Z</published>
    <updated>2020-04-21T10:23:54.831Z</updated>
    
    <content type="html"><![CDATA[<h1>ç¬¬å…­ç«  ç†è§£ Buffer</h1><h2>Buffer ç»“æ„</h2><p>Buffer æ˜¯ä¸€ä¸ªåƒ Array çš„å¯¹è±¡ï¼Œä¸»è¦ç”¨æ¥æ“ä½œå­—èŠ‚ã€‚Buffer æ˜¯ä¸€ä¸ªå…¸å‹çš„ JavaScript ä¸ C++ ç»“åˆçš„æ¨¡å—ï¼Œå®ƒå°†æ€§èƒ½ç›¸å…³çš„éƒ¨åˆ†ç”¨ C++ å®ç°ï¼Œå°†éæ€§èƒ½ç›¸å…³çš„éƒ¨åˆ†ç”¨ JavaScript å®ç°ã€‚</p><p>Buffer æ‰€å ç”¨çš„å†…å­˜ä¸æ˜¯é€šè¿‡ V8 åˆ†é…çš„ï¼Œè€Œæ˜¯å †å¤–å†…å­˜ã€‚ç”±äº V8 åƒåœ¾å›æ”¶æ€§èƒ½çš„å½±å“ï¼Œå°† Buffer å¯¹è±¡ç”¨æ›´é«˜æ•ˆçš„ä¸“æœ‰å†…å­˜åˆ†é…å›æ”¶ç­–ç•¥æ¥ç®¡ç†ã€‚</p><p>Buffer åœ¨ Node è¿›ç¨‹å¯åŠ¨çš„æ—¶å€™å·²ç»è½½å…¥äº†ï¼Œå¹¶å°†å…¶æ”¾åœ¨å…¨å±€å¯¹è±¡ global ä¸Šï¼Œå› æ­¤æ— éœ€ require() å°±èƒ½ä½¿ç”¨ã€‚</p><h3>Buffer å¯¹è±¡</h3><p>Buffer çš„å…ƒç´ ä¸º 16 è¿›åˆ¶çš„ä¸¤ä½æ•°ï¼Œå³ 0 åˆ° 255 çš„æ•°å€¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'æ·±å…¥æµ…å‡ºnode.js'</span></span><br><span class="line"><span class="keyword">var</span> buf = <span class="keyword">new</span> Buffer(str, <span class="string">'utf8'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(buf) <span class="comment">// &lt;Buffer e6 b7 b1 e5 85 a5 e6 b5 85 e5 87 ba 6e 6f 64 65 2e 6a 73&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸åŒç¼–ç çš„å­—ç¬¦ä¸²å ç”¨çš„å…ƒç´ ä¸ªæ•°å„ä¸ç›¸åŒï¼Œä¸­æ–‡åœ¨ UTF-8 ç¼–ç ä¸‹å ç”¨ 3 ä¸ªå…ƒç´ ï¼Œå­—æ¯å’ŒåŠè§’æ ‡ç‚¹å ç”¨ 1 ä¸ªå…ƒç´ ã€‚</p><p>Buffer å¯ä»¥é€šè¿‡ length å±æ€§å¾—åˆ°é•¿åº¦ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä¸‹æ ‡è®¿é—®å…ƒç´ ã€‚</p><a id="more"></a><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> buf = <span class="keyword">new</span> Buffer(<span class="number">100</span>)</span><br><span class="line"><span class="built_in">console</span>.log(buf.length) <span class="comment">// 100</span></span><br><span class="line"><span class="built_in">console</span>.log(buf[<span class="number">10</span>]) <span class="comment">// 0</span></span><br><span class="line">buf[<span class="number">10</span>] = <span class="number">100</span></span><br><span class="line"><span class="built_in">console</span>.log(buf[<span class="number">10</span>]) <span class="comment">// 100</span></span><br></pre></td></tr></table></figure><p>å¦‚æœç»™å…ƒç´ èµ‹å€¼ä¸æ˜¯ 0 åˆ° 255 çš„æ•´æ•°è€Œæ˜¯å°æ•°ï¼ŒBuffer é€šè¿‡ä¸æ–­ +256 æˆ–è€…ä¸æ–­ -256 å¾—åˆ°ä¸€ä¸ªä½äº 0 - 255 ä¹‹é—´çš„æ•´æ•°ã€‚å¦‚æœæ˜¯å°æ•°ï¼Œåˆ™ç›´æ¥èˆå¼ƒå°æ•°éƒ¨åˆ†ï¼Œåªä¿ç•™æ•´æ•°éƒ¨åˆ†ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">buf[<span class="number">10</span>] = <span class="number">-100</span></span><br><span class="line"><span class="built_in">console</span>.log(buf[<span class="number">10</span>]) <span class="comment">// 156</span></span><br><span class="line">buf[<span class="number">10</span>] = <span class="number">300</span></span><br><span class="line"><span class="built_in">console</span>.log(buf[<span class="number">10</span>]) <span class="comment">// 44</span></span><br><span class="line">buf[<span class="number">10</span>] = <span class="number">3.1415</span></span><br><span class="line"><span class="built_in">console</span>.log(buf[<span class="number">10</span>]) <span class="comment">// 3</span></span><br></pre></td></tr></table></figure><h3>Buffer å†…å­˜åˆ†é…</h3><p>Buffer å¯¹è±¡çš„å†…å­˜ä¸æ˜¯åœ¨ V8 å †å†…å­˜ä¸­ï¼Œè€Œä¸” Node çš„ C++ å±‚é¢å®ç°çš„å†…å­˜ç”³è¯·ã€‚å› ä¸ºå¤„ç†å¤§é‡çš„å­—èŠ‚æ•°æ®ä¸èƒ½é‡‡ç”¨éœ€è¦ä¸€ç‚¹å†…å­˜å°±åƒæ“ä½œç³»ç»Ÿç”³è¯·ä¸€ç‚¹å†…å­˜çš„æ–¹å¼ï¼Œè¿™å¯èƒ½é€ æˆå¤§é‡å†…å­˜ç”³è¯·çš„ç³»ç»Ÿè°ƒç”¨ï¼Œå¯¹æ“ä½œç³»ç»Ÿæœ‰ä¸€å®šå‹åŠ›ã€‚Node ä½¿ç”¨çš„ç­–ç•¥æ˜¯åœ¨ C++ å±‚é¢ç”³è¯·å†…å­˜ï¼Œåœ¨ JavaScript ä¸­åˆ†é…å†…å­˜ã€‚</p><p>Node æ“ä½œ Buffer ä½¿ç”¨ slab å†…å­˜åˆ†é…ç­–ç•¥ã€‚slab æ˜¯ä¸€ç§åŠ¨æ€å†…å­˜ç®¡ç†æœºåˆ¶ï¼Œæœ€æ—©å‡ºç°äº SunOSï¼Œç›®å‰å¹¿æ³›åº”ç”¨äº Linuxã€‚</p><p>slab æ˜¯ä¸€å—ç”³è¯·å¥½çš„å›ºå®šå¤§å°çš„å†…å­˜åŒºåŸŸã€‚ä¸€å…±æœ‰ä¸‰ç§çŠ¶æ€ï¼š fullï¼šå®Œå…¨åˆ†é…çŠ¶æ€ï¼Œpartialï¼šéƒ¨åˆ†åˆ†é…çŠ¶æ€ï¼›emptyï¼šæ²¡æœ‰åˆ†é…çŠ¶æ€ã€‚</p><p>å½“æˆ‘ä»¬éœ€è¦ä¸€ä¸ª Buffer å¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡ä¼ å…¥ size æ¥æŒ‡å®š Buffer å¯¹è±¡å¤§å°ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> Buffer(size)</span><br></pre></td></tr></table></figure><p>Node ä»¥ 8kb ä¸ºç•Œé™æ¥åŒºåˆ† Buffer æ˜¯å¤§å¯¹è±¡è¿˜æ˜¯å°å¯¹è±¡ã€‚è¿™ä¸ª 8kb ä¹Ÿå°±æ˜¯æ¯ä¸ª slab çš„å€¼ï¼Œåœ¨ JavaScript å±‚é¢ï¼Œä»¥å®ƒä½œä¸ºå•ä½è¿›è¡Œå†…å­˜åˆ†é…ã€‚</p><p>(1) å° Buffer å¯¹è±¡</p><p>å¦‚æœæŒ‡å®š Buffer çš„å¤§å°å°äº 8kbï¼ŒNodeä¼šæŒ‰ç…§å°å¯¹è±¡çš„æ–¹å¼è¿›è¡Œåˆ†é…ã€‚</p><p>(2) å¤§ Buffer å¯¹è±¡</p><p>å¦‚æœæ˜¯è¶…è¿‡ 8kb çš„å¯¹è±¡ï¼Œå°†ä¼šç›´æ¥åˆ†é…ä¸€ä¸ª SlowBuffer å¯¹è±¡ä½œä¸º slab å•å…ƒï¼Œè¿™ä¸ª slab å•å…ƒå°†è¢«è¿™ä¸ªå¤§ Buffer å¯¹è±¡ç‹¬å ã€‚</p><h2>Buffer è½¬æ¢</h2><p>Buffer å¯¹è±¡å¯ä»¥ä¸å­—ç¬¦ä¸²ç›´æ¥äº’ç›¸è½¬æ¢ï¼Œç›®å‰æ”¯æŒçš„å­—ç¬¦ä¸²ç¼–ç ç±»å‹æœ‰ï¼šASCIIã€UTF-8ã€UTF-16LE/USC-2ã€Base64ã€Binaryã€Hexã€‚</p><h3>å­—ç¬¦ä¸²è½¬ Buffer</h3><p>å­—ç¬¦ä¸²å¯ä»¥é€šè¿‡ Buffer æ„é€ å‡½æ•°è½¬æ¢ä¸º Buffer å¯¹è±¡ï¼Œå­˜å‚¨çš„åªèƒ½è¯´ä¸€ç§ç¼–ç ç±»å‹ã€‚encoding å‚æ•°ä¸ä¼ é€’æ—¶ï¼Œé»˜è®¤æŒ‰ç…§ UTF-8 ç¼–ç è¿›è¡Œè½¬ç å’Œå­˜å‚¨ã€‚ä¸€ä¸ª Buffer å¯¹è±¡å¯ä»¥å­˜å‚¨ä¸åŒç¼–ç ç±»å‹çš„å­—ç¬¦ä¸²è½¬ç çš„å€¼ï¼Œè°ƒç”¨ write() å¯ä»¥å®ç°ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> Buffer(str, [encoding])</span><br><span class="line">buf.write(string, [offset], [length], [encoding])</span><br></pre></td></tr></table></figure><p>ç”±äºå¯ä»¥ä¸æ–­å†™å†…å®¹åˆ° Buffer å¯¹è±¡ä¸­ï¼Œå¹¶ä¸”æ¯æ¬¡éƒ½å¯ä»¥æŒ‡å®šç¼–ç ï¼Œæ‰€ä»¥ Buffer å¯¹è±¡ä¸­å¯ä»¥å­˜åœ¨å¤šç§ç¼–ç è½¬åŒ–åçš„å†…å®¹ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ¯ç§ç¼–ç æ‰€ç”¨çš„å­—èŠ‚é•¿åº¦ä¸åŒï¼Œåè½¬ Buffer å›å­—ç¬¦ä¸²æ—¶éœ€è¦è°¨æ…å¤„ç†ã€‚</p><h3>Buffer è½¬å­—ç¬¦ä¸²</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">buf.toString([encoding], [start], [end])</span><br></pre></td></tr></table></figure><p>å¯ä»¥è®¾ç½® encodingï¼Œstartï¼Œend è¿™ 3 ä¸ªå‚æ•°å®ç°æ•´ä½“æˆ–è€…å±€éƒ¨çš„è½¬åŒ–ã€‚</p><h3>Buffer ä¸æ”¯æŒçš„ç¼–ç ç±»å‹</h3><p>ç”±äº Node ä¸­ Buffer å¯¹è±¡åªæ”¯æŒä¸Šè¿°å‡ ç§ç±»å‹çš„ç¼–ç ï¼Œå› æ­¤å¯ä»¥ç”¨ isEncoding() å‡½æ•°åˆ¤æ–­ç¼–ç æ˜¯å¦æ”¯æŒè½¬åŒ–ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Buffer.isEncoding(encoding)</span><br><span class="line">Buffer.isEncoding(<span class="string">'GBK'</span>) <span class="comment">// false</span></span><br><span class="line">Buffer.isEncoding(<span class="string">'UTF-8'</span>) <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>å¦‚æœéœ€è¦è½¬åŒ–å…¶å®ƒç±»å‹çš„ç¼–ç ï¼Œå¯ä»¥å€ŸåŠ© <a href="https://github.com/bnoordhuis/node-iconv" target="_blank" rel="noopener">iconv</a> å’Œ <a href="https://github.com/ashtuchkin/iconv-lite" target="_blank" rel="noopener">iconv-lite</a> ä¸¤ä¸ªæ¨¡å—ã€‚</p><p>iconv-lite ç”±çº¯ JavaScript å®ç°ï¼Œiconv åˆ™æ˜¯é€šè¿‡ C++ è°ƒç”¨ libiconv åº“å®ç°ï¼Œå‰è€…æ¯”åè€…æ›´è½»é‡ï¼Œæ— éœ€ç¼–è¯‘å’Œå¤„ç†ç¯å¢ƒä¾èµ–ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> iconv = <span class="built_in">require</span>(<span class="string">'iconv-lite'</span>)</span><br><span class="line"><span class="comment">// Buffer è½¬å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="keyword">var</span> str = icon.decode(buf, <span class="string">'win1251'</span>)</span><br><span class="line"><span class="comment">// å­—ç¬¦ä¸²è½¬ Buffer </span></span><br><span class="line"><span class="keyword">var</span> buf = iconv.encode(<span class="string">'Sample input string'</span>, <span class="string">'win1251'</span>)</span><br></pre></td></tr></table></figure><h2>Buffer æ‹¼æ¥</h2><p>Buffer å¸¸ç”¨äºä»è¾“å…¥æµä¸­è¯»å–å†…å®¹</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"><span class="keyword">var</span> rs = fs.createReadStream(<span class="string">'./test.md'</span>)</span><br><span class="line"><span class="keyword">var</span> data = <span class="string">''</span></span><br><span class="line">rs.on(<span class="string">'data'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">chunk</span>) </span>&#123;</span><br><span class="line">  data += chunk</span><br><span class="line">&#125;)</span><br><span class="line">rs.on(<span class="string">'end'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">chunk</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(data)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç åœ¨è‹±æ–‡ç¯å¢ƒä¸­ä¸€èˆ¬ä¸ä¼šå‡ºç°é—®é¢˜ï¼Œä½†æ˜¯åœ¨ä¸­æ–‡ç¯å¢ƒä¸­ï¼Œç»å¸¸ä¼šçœ‹åˆ°ä¹±ç ã€‚data äº‹ä»¶ä¸­è·å–çš„ chunk å¯¹è±¡ä¸º Buffer å¯¹è±¡ï¼Œä¸Šè¿°ä»£ç å°†å…¶å½“åšå­—ç¬¦ä¸²å¤„ç†ï¼š<code>data += chunk</code> æœ¬è´¨ä¸Šæ˜¯ <code>data = data.toString() + chunk.toString()</code>ã€‚åœ¨è‹±æ–‡ç¯å¢ƒä¸­ï¼ŒtoString() ä¸ä¼šé€ æˆä»»ä½•é—®é¢˜ï¼Œä½†æ˜¯å¯¹äºå®½å­—èŠ‚çš„ä¸­æ–‡ï¼Œå´ä¼šå½¢æˆé—®é¢˜ã€‚</p><p>æˆ‘ä»¬åˆ›å»º <a href="http://test.md" target="_blank" rel="noopener">test.md</a>ï¼Œå†…å®¹ä¸ºæç™½çš„ã€Šé™å¤œæ€ã€‹ï¼Œä¿®æ”¹åˆšæ‰çš„ä»£ç ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> rs = fs.createReadStream(<span class="string">'./test.md'</span> &#123; <span class="attr">highWaterMark</span>: <span class="number">11</span> &#125;)</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">çª—å‰æ˜ï¿½ï¿½å…‰ï¼Œç–‘ï¿½ï¿½ï¿½åœ°ä¸Šéœœï¼Œä¸¾å¤´ï¿½ï¿½æ˜æœˆï¼Œï¿½ï¿½ï¿½å¤´æ€æ•…ä¹¡ã€‚</span><br></pre></td></tr></table></figure><p>ä¸‹é¢æˆ‘ä»¬æ¥åˆ†æä¹±ç æ˜¯æ€ä¹ˆæ¥çš„ã€‚</p><h3>ä¹±ç æ˜¯å¦‚ä½•äº§ç”Ÿçš„</h3><p>ä¸Šé¢ä¼ çš„å‚æ•° highWaterMark çš„ä½œç”¨æ˜¯é™åˆ¶ Buffer å¯¹è±¡çš„é•¿åº¦ä¸º 11ã€‚å‰é¢è¯´åˆ°ä¸­æ–‡ UTF-8 ä¸º 3 ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥å‰ 3 ä¸ªå­—â€œåºŠå‰æ˜â€èƒ½å¤Ÿæ­£å¸¸è¾“å‡ºï¼Œåé¢ 11 - 3 * 3 = 2 ä¸ªå­—èŠ‚æ— æ³•æ­£å¸¸è§£æä¸º UTF-8 çš„ä¸­æ–‡å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥è¾“å‡ºä¹±ç ã€‚åœ¨è°ƒç”¨ toString() çš„æ—¶å€™ï¼Œé»˜è®¤ä½¿ç”¨ UTF-8 ç¼–ç ã€‚åé¢çš„ä¹±ç éƒ½æ˜¯ç›¸åŒçš„é“ç†ã€‚</p><h3>setEncoding() ä¸ string_decoder()</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> rs = fs.createReadStream(<span class="string">'./test.md'</span>, &#123; <span class="attr">highWaterMark</span>: <span class="number">11</span> &#125;)</span><br><span class="line">rs.setEncoding(<span class="string">'utf8'</span>)</span><br></pre></td></tr></table></figure><p>setEncoding() çš„ä½œç”¨æ˜¯è®© data äº‹ä»¶ä¸­ä¼ é€’çš„ä¸å†æ˜¯ä¸€ä¸ª Buffer å¯¹è±¡ï¼Œè€Œæ˜¯ç¼–ç åçš„å­—ç¬¦ä¸²ã€‚æ”¹è¿›åé‡æ–°æ‰§è¡Œï¼Œå¾—åˆ°æ­£ç¡®çš„è¾“å‡ºã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">çª—å‰æ˜æœˆå…‰ï¼Œç–‘æ˜¯åœ°ä¸Šéœœï¼Œä¸¾å¤´æœ›æ˜æœˆï¼Œä½å¤´æ€æ•…ä¹¡ã€‚</span><br></pre></td></tr></table></figure><p>åœ¨è°ƒç”¨ setEncoding() çš„æ—¶å€™ï¼Œå¯è¯»æµå¯¹è±¡åœ¨å†…éƒ¨è®¾ç½®äº†ä¸€ä¸ª decoder å¯¹è±¡ï¼Œæ¯æ¬¡ data äº‹ä»¶éƒ½æ˜¯é€šè¿‡ decoder å¯¹è±¡è¿›è¡Œ Buffer åˆ°å­—ç¬¦ä¸²çš„è§£æã€‚</p><h2>Buffer æ€§èƒ½</h2><p>Buffer åœ¨æ–‡ä»¶ I/O å’Œç½‘ç»œ I/O ä¸­è¿ç”¨å¹¿æ³›ï¼Œåœ¨åº”ç”¨ä¸­ï¼Œé€šå¸¸æ“ä½œå­—ç¬¦ä¸²ï¼Œä½†ä¸€æ—¦åœ¨ç½‘ç»œä¸­ä¼ è¾“ï¼Œéƒ½éœ€è¦è½¬æ¢ä¸º Bufferï¼Œä»¥äºŒè¿›åˆ¶æ•°æ®è¿›è¡Œä¼ è¾“ã€‚</p><h3>æµ‹è¯•</h3><p>æ„é€ ä¸€ä¸ª 10kb å¤§å°çš„å­—ç¬¦ä¸²ï¼Œé€šè¿‡çº¯å­—ç¬¦ä¸²çš„æ–¹å¼å‘å®¢æˆ·ç«¯å‘é€ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>)</span><br><span class="line"><span class="keyword">var</span> helloworld = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">1024</span> * <span class="number">10</span>; i++) &#123;</span><br><span class="line">  helloworld += <span class="string">'a'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// helloworld = new Buffer(helloworld)</span></span><br><span class="line">http.createServer(<span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">  res.writeHead(<span class="number">200</span>)</span><br><span class="line">  res.end(helloworld)</span><br><span class="line">&#125;).listen(<span class="number">8001</span>)</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ ab è¿›è¡Œæ€§èƒ½æµ‹è¯•ï¼Œå‘èµ· 200 ä¸ªå¹¶å‘å®¢æˆ·ç«¯ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ab -c 200 -t 100 http://127.0.0.1:8001</span><br></pre></td></tr></table></figure><p>åœ¨æˆ‘çš„è…¾è®¯äº‘ä¸Šå•æ ¸ 1G CPUï¼Œ1G å†…å­˜çš„æœåŠ¡å™¨ä¸Šæµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">Server Software:</span><br><span class="line">Server Hostname:        127.0.0.1</span><br><span class="line">Server Port:            8001</span><br><span class="line"></span><br><span class="line">Document Path:          /</span><br><span class="line">Document Length:        10240 bytes</span><br><span class="line"></span><br><span class="line">Concurrency Level:      200</span><br><span class="line">Time taken for tests:   13.104 seconds</span><br><span class="line">Complete requests:      50000</span><br><span class="line">Failed requests:        0</span><br><span class="line">Write errors:           0</span><br><span class="line">Total transferred:      515750000 bytes</span><br><span class="line">HTML transferred:       512000000 bytes</span><br><span class="line">Requests per second:    3815.61 [#/sec] (mean)</span><br><span class="line">Time per request:       52.416 [ms] (mean)</span><br><span class="line">Time per request:       0.262 [ms] (mean, across all concurrent requests)</span><br><span class="line">Transfer rate:          38435.54 [Kbytes/sec] received</span><br><span class="line"></span><br><span class="line">Connection Times (ms)</span><br><span class="line">              min  mean[+/-sd] median   max</span><br><span class="line">Connect:        0   16 129.3      1    3014</span><br><span class="line">Processing:     7   35  10.2     38     255</span><br><span class="line">Waiting:        1   34  10.4     37     254</span><br><span class="line">Total:          7   51 130.0     39    3047</span><br><span class="line"></span><br><span class="line">Percentage of the requests served within a certain time (ms)</span><br><span class="line"><span class="meta">  50%</span><span class="bash">     39</span></span><br><span class="line"><span class="meta">  66%</span><span class="bash">     40</span></span><br><span class="line"><span class="meta">  75%</span><span class="bash">     40</span></span><br><span class="line"><span class="meta">  80%</span><span class="bash">     40</span></span><br><span class="line"><span class="meta">  90%</span><span class="bash">     43</span></span><br><span class="line"><span class="meta">  95%</span><span class="bash">     52</span></span><br><span class="line"><span class="meta">  98%</span><span class="bash">     56</span></span><br><span class="line"><span class="meta">  99%</span><span class="bash">   1040</span></span><br><span class="line"><span class="meta"> 100%</span><span class="bash">   3047 (longest request)</span></span><br></pre></td></tr></table></figure><p>æµ‹è¯•çš„ QPSï¼ˆæ¯ç§’æŸ¥è¯¢æ¬¡æ•°ï¼‰ä¸º 3815.61ï¼Œä¼ è¾“ç‡ä¸º 38435.54ã€‚<br>å»æ‰ helloworld = new Buffer(helloworld) å‰é¢çš„æ³¨é‡Šï¼Œå†æ¬¡æµ‹è¯•ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">Server Software:</span><br><span class="line">Server Hostname:        <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">Server Port:            <span class="number">8001</span></span><br><span class="line"></span><br><span class="line">Document Path:          <span class="regexp">/</span></span><br><span class="line"><span class="regexp">Document Length:        10240 bytes</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">Concurrency Level:      200</span></span><br><span class="line"><span class="regexp">Time taken for tests:   7.260 seconds</span></span><br><span class="line"><span class="regexp">Complete requests:      50000</span></span><br><span class="line"><span class="regexp">Failed requests:        0</span></span><br><span class="line"><span class="regexp">Write errors:           0</span></span><br><span class="line"><span class="regexp">Total transferred:      515750000 bytes</span></span><br><span class="line"><span class="regexp">HTML transferred:       512000000 bytes</span></span><br><span class="line"><span class="regexp">Requests per second:    6886.98 [#/sec] (mean)</span></span><br><span class="line"><span class="regexp">Time per request:       29.040 [ms] (mean)</span></span><br><span class="line"><span class="regexp">Time per request:       0.145 [ms] (mean, across all concurrent requests)</span></span><br><span class="line"><span class="regexp">Transfer rate:          69374.22 [Kbytes/sec] received</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">Connection Times (ms)</span></span><br><span class="line"><span class="regexp">              min  mean[+/-sd] median   max</span></span><br><span class="line"><span class="regexp">Connect:        0    7  71.0      2    1012</span></span><br><span class="line"><span class="regexp">Processing:     7   17  10.1     14     417</span></span><br><span class="line"><span class="regexp">Waiting:        7   15  10.3     12     401</span></span><br><span class="line"><span class="regexp">Total:         10   24  72.7     16    1234</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">Percentage of the requests served within a certain time (ms)</span></span><br><span class="line"><span class="regexp">  50%     16</span></span><br><span class="line"><span class="regexp">  66%     17</span></span><br><span class="line"><span class="regexp">  75%     18</span></span><br><span class="line"><span class="regexp">  80%     18</span></span><br><span class="line"><span class="regexp">  90%     30</span></span><br><span class="line"><span class="regexp">  95%     32</span></span><br><span class="line"><span class="regexp">  98%     41</span></span><br><span class="line"><span class="regexp">  99%     48</span></span><br><span class="line"><span class="regexp"> 100%   1234 (longest request)</span></span><br></pre></td></tr></table></figure><p>æµ‹è¯•çš„ QPSï¼ˆæ¯ç§’æŸ¥è¯¢æ¬¡æ•°ï¼‰ä¸º 6886.98ï¼Œä¼ è¾“ç‡ä¸º 69374.22ã€‚æ€§èƒ½æå‡äº†è¿‘ä¸€å€ã€‚</p><p>é€šè¿‡é¢„å…ˆè½¬æ¢é™æ€å†…å®¹ä¸º Buffer å¯¹è±¡ï¼Œå¯ä»¥æœ‰æ•ˆå‡å°‘ CPU é‡å¤ä½¿ç”¨ï¼ŒèŠ‚çœæœåŠ¡å™¨èµ„æºã€‚åœ¨ Node æ„å»ºçš„ Web åº”ç”¨ä¸­ï¼Œå¯ä»¥é€‰æ‹©å°†é¡µé¢ä¸­çš„åŠ¨æ€å†…å®¹å’Œé™æ€å†…å®¹åˆ†ç±»ï¼Œé™æ€å†…å®¹é¢„å…ˆè½¬æ¢ä¸º Buffer å¯¹è±¡ï¼Œä½¿æ€§èƒ½å¾—åˆ°æå‡ã€‚ç”±äºæ–‡ä»¶æœ¬èº«æ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼Œæ‰€ä»¥åœ¨ä¸éœ€è¦æ”¹å˜å†…å®¹çš„åœºæ™¯ä¸­ï¼Œè®¾ç½® Buffer ä¸ºåªè¯»ï¼Œä¸åšé¢å¤–çš„è½¬æ¢èƒ½è¾¾åˆ°æ›´å¥½çš„æ•ˆæœã€‚</p><h3>æ–‡ä»¶è¯»å–</h3><p>é€šè¿‡ fs.createReadStream(path, opts) åˆ›å»ºæ–‡ä»¶è¯»æµï¼Œå…¶ä¸­å¯ä»¥ä¼ å…¥çš„å‚æ•°ä¸ºï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  flags: <span class="string">'r'</span>,</span><br><span class="line">  encoding: <span class="literal">null</span>,</span><br><span class="line">  fd: <span class="literal">null</span>,</span><br><span class="line">  mode: <span class="number">0666</span>,</span><br><span class="line">  autoClose: <span class="literal">true</span>,</span><br><span class="line">  highWaterMark: <span class="number">64</span> &amp; <span class="number">1024</span>    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>opts å¯ä»¥åŒ…æ‹¬ start å’Œ end å€¼ï¼Œä½¿å…¶å¯ä»¥ä»æ–‡ä»¶è¯»å–ä¸€å®šèŒƒå›´çš„å­—èŠ‚è€Œä¸æ˜¯æ•´ä¸ªæ–‡ä»¶ã€‚ä¾‹å¦‚ä» 100 ä¸ªå­—èŠ‚çš„æ–‡ä»¶ä¸­è¯»å–æœ€å 10 ä¸ªå­—èŠ‚ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fs.createReadStream(<span class="string">'sample.txt'</span>, &#123; <span class="attr">start</span>: <span class="number">90</span>, <span class="attr">end</span>: <span class="number">99</span> &#125;)</span><br></pre></td></tr></table></figure><p>fs.createReadStream() çš„å·¥ä½œæ–¹å¼æ˜¯åœ¨å†…å­˜ä¸­å‡†å¤‡ä¸€æ®µ Bufferï¼Œç„¶ååœ¨ fs.read() è¯»å–æ—¶é€æ­¥ä»ç£ç›˜ä¸­å°†å­—èŠ‚å¤åˆ¶åˆ° Bufferï¼Œå®Œæˆä¸€æ¬¡è¯»å–åï¼Œä»è¿™ä¸ª Buffer ä¸­é€šè¿‡ slice() æ–¹æ³•å–å‡ºéƒ¨åˆ†æ•°æ®ä½œä¸ºä¸€ä¸ªå° Buffer å¯¹è±¡ï¼Œå†é€šè¿‡ data äº‹ä»¶ä¼ é€’ç»™è°ƒç”¨æ–¹ã€‚å¦‚æœ Buffer ç”¨å®Œï¼Œåˆ™é‡æ–°åˆ†é…ä¸€ä¸ªï¼Œå¦‚æœè¿˜æœ‰å‰©ä½™åˆ™ç»§ç»­ä½¿ç”¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> pool </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">allocNewPool</span> (<span class="params">poolSize</span>) </span>&#123;</span><br><span class="line">  pool = <span class="keyword">new</span> Buffer(poolSize)</span><br><span class="line">  pool.used = <span class="number">0</span>  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç†æƒ³çŠ¶å†µä¸‹ï¼Œæ¯æ¬¡è¯»å–çš„é•¿åº¦å°±æ˜¯ç”¨æˆ·æŒ‡å®šçš„ highWaterMarkï¼Œä½†æ˜¯å‡å¦‚è¯»åˆ°æ–‡ä»¶æœ€åï¼Œå‰©ä¸‹çš„å†…å®¹ä¸åˆ° highWaterMark é‚£ä¹ˆå¤§ï¼Œè¿™æ˜¯é¢„å…ˆæŒ‡å®šçš„ Buffer å¯¹è±¡å°†ä¼šæœ‰å‰©ä½™ï¼Œä¸è¿‡è¿™éƒ¨åˆ†å†…å­˜å¯ä»¥åˆ†é…ç»™ä¸‹æ¬¡è¯»å–æ—¶ç”¨ã€‚</p><p>highWaterMark çš„å¤§å°å¯¹æ€§èƒ½æœ‰ä»¥ä¸‹ä¸¤ä¸ªå½±å“ï¼š</p><ul><li>highWaterMark çš„è®¾ç½®å¯¹ Buffer å†…å­˜åˆ†é…å’Œä½¿ç”¨æœ‰å½±å“ã€‚</li><li>highWaterMark è®¾ç½®è¿‡å°ï¼Œå¯èƒ½å¯¼è‡´ç³»ç»Ÿè°ƒç”¨æ¬¡æ•°è¿‡å¤šã€‚</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;ç¬¬å…­ç«  ç†è§£ Buffer&lt;/h1&gt;
&lt;h2&gt;Buffer ç»“æ„&lt;/h2&gt;
&lt;p&gt;Buffer æ˜¯ä¸€ä¸ªåƒ Array çš„å¯¹è±¡ï¼Œä¸»è¦ç”¨æ¥æ“ä½œå­—èŠ‚ã€‚Buffer æ˜¯ä¸€ä¸ªå…¸å‹çš„ JavaScript ä¸ C++ ç»“åˆçš„æ¨¡å—ï¼Œå®ƒå°†æ€§èƒ½ç›¸å…³çš„éƒ¨åˆ†ç”¨ C++ å®ç°ï¼Œå°†éæ€§èƒ½ç›¸å…³çš„éƒ¨åˆ†ç”¨ JavaScript å®ç°ã€‚&lt;/p&gt;
&lt;p&gt;Buffer æ‰€å ç”¨çš„å†…å­˜ä¸æ˜¯é€šè¿‡ V8 åˆ†é…çš„ï¼Œè€Œæ˜¯å †å¤–å†…å­˜ã€‚ç”±äº V8 åƒåœ¾å›æ”¶æ€§èƒ½çš„å½±å“ï¼Œå°† Buffer å¯¹è±¡ç”¨æ›´é«˜æ•ˆçš„ä¸“æœ‰å†…å­˜åˆ†é…å›æ”¶ç­–ç•¥æ¥ç®¡ç†ã€‚&lt;/p&gt;
&lt;p&gt;Buffer åœ¨ Node è¿›ç¨‹å¯åŠ¨çš„æ—¶å€™å·²ç»è½½å…¥äº†ï¼Œå¹¶å°†å…¶æ”¾åœ¨å…¨å±€å¯¹è±¡ global ä¸Šï¼Œå› æ­¤æ— éœ€ require() å°±èƒ½ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;h3&gt;Buffer å¯¹è±¡&lt;/h3&gt;
&lt;p&gt;Buffer çš„å…ƒç´ ä¸º 16 è¿›åˆ¶çš„ä¸¤ä½æ•°ï¼Œå³ 0 åˆ° 255 çš„æ•°å€¼ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; str = &lt;span class=&quot;string&quot;&gt;&#39;æ·±å…¥æµ…å‡ºnode.js&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; buf = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Buffer(str, &lt;span class=&quot;string&quot;&gt;&#39;utf8&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(buf) &lt;span class=&quot;comment&quot;&gt;// &amp;lt;Buffer e6 b7 b1 e5 85 a5 e6 b5 85 e5 87 ba 6e 6f 64 65 2e 6a 73&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä¸åŒç¼–ç çš„å­—ç¬¦ä¸²å ç”¨çš„å…ƒç´ ä¸ªæ•°å„ä¸ç›¸åŒï¼Œä¸­æ–‡åœ¨ UTF-8 ç¼–ç ä¸‹å ç”¨ 3 ä¸ªå…ƒç´ ï¼Œå­—æ¯å’ŒåŠè§’æ ‡ç‚¹å ç”¨ 1 ä¸ªå…ƒç´ ã€‚&lt;/p&gt;
&lt;p&gt;Buffer å¯ä»¥é€šè¿‡ length å±æ€§å¾—åˆ°é•¿åº¦ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä¸‹æ ‡è®¿é—®å…ƒç´ ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Node" scheme="https://lz5z.com/categories/Node/"/>
    
    
      <category term="å†…å­˜" scheme="https://lz5z.com/tags/%E5%86%85%E5%AD%98/"/>
    
      <category term="Buffer" scheme="https://lz5z.com/tags/Buffer/"/>
    
  </entry>
  
  <entry>
    <title>ã€Šæ·±å…¥æµ…å‡ºNode.jsã€‹-å†…å­˜æ§åˆ¶</title>
    <link href="https://lz5z.com/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BANode-js-%E5%86%85%E5%AD%98%E6%8E%A7%E5%88%B6/"/>
    <id>https://lz5z.com/æ·±å…¥æµ…å‡ºNode-js-å†…å­˜æ§åˆ¶/</id>
    <published>2018-05-27T21:14:20.000Z</published>
    <updated>2020-04-21T10:23:54.831Z</updated>
    
    <content type="html"><![CDATA[<h1>ç¬¬äº”ç«  å†…å­˜æ§åˆ¶</h1><p>æœ¬ç« å­¦ä¹  V8 çš„åƒåœ¾å›æ”¶æœºåˆ¶ä»¥åŠå¦‚ä½•é«˜æ•ˆä½¿ç”¨å†…å­˜ï¼Œå†…å­˜æ³„æ¼ä»¥åŠå¦‚ä½•æ’æŸ¥å†…å­˜æ³„æ¼ã€‚</p><h2>V8 çš„åƒåœ¾å›æ”¶æœºåˆ¶ä¸å†…å­˜é™åˆ¶</h2><p>å…³äº JavaScript ä¸­å¸¸ç”¨çš„åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç«  <a href="https://lz5z.com/JavaScript%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/">JavaScript åƒåœ¾å›æ”¶</a>ã€‚</p><h3>V8 çš„å†…å­˜é™åˆ¶</h3><p>ä¸€èˆ¬åç«¯å¼€å‘è¯­è¨€ä¸­ï¼Œåœ¨åŸºæœ¬çš„å†…å­˜ä½¿ç”¨ä¸Šéƒ½æ²¡æœ‰ä»€ä¹ˆé™åˆ¶ï¼Œè€Œ Node ä¸­å°† JavaScript çš„ä½¿ç”¨å†…å­˜åšå‡ºå¦‚ä¸‹é™åˆ¶ï¼š64 ä½æ“ä½œç³»ç»Ÿçº¦ä¸º 1.4Gï¼Œ32 ä½æ“ä½œç³»ç»Ÿçº¦ä¸º 0.7Gã€‚åœ¨è¿™æ ·çš„é™åˆ¶ä¸‹ï¼ŒNode æ— æ³•ç›´æ¥æ“ä½œå¤§å†…å­˜å¯¹è±¡ï¼Œæ¯”å¦‚å°†ä¸€ä¸ª 2GB æ–‡ä»¶è¯»å–åˆ°å†…å­˜ä¸­è¿›è¡Œå­—ç¬¦ä¸²åˆ†æï¼Œå³ä½¿ç‰©ç†å†…å­˜æœ‰ 32 GBã€‚</p><h3>V8 çš„å¯¹è±¡åˆ†é…</h3><p>åœ¨ V8 ä¸­ï¼Œæ‰€æœ‰çš„ JavaScript å¯¹è±¡éƒ½æ˜¯é€šè¿‡å †æ¥è¿›è¡Œå†…å­˜åˆ†é…çš„ï¼ŒNode ä¸­å¯ä»¥é€šè¿‡ <a href="http://nodejs.cn/api/process.html#process_process_memoryusage" target="_blank" rel="noopener">process.memoryUsage()</a> æŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> node</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> process.memoryUsage()</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> &#123; rss: 24244224,</span></span><br><span class="line">    heapTotal: 9232384,</span><br><span class="line">    heapUsed: 5041608,</span><br><span class="line">    external: 11497 &#125;</span><br></pre></td></tr></table></figure><a id="more"></a><p>å…¶ä¸­ heapTotal å’Œ heapUsed æ˜¯ V8 å †å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œå‰è€…æ˜¯å·²ç»ç”³è¯·åˆ°çš„å †å†…å­˜ï¼Œåè€…æ˜¯å½“å‰å†…å­˜ä½¿ç”¨é‡ã€‚external ä»£è¡¨ V8 ç®¡ç†çš„ï¼Œç»‘å®šåˆ° Javascript çš„ C++ å¯¹è±¡çš„å†…å­˜ä½¿ç”¨æƒ…å†µã€‚rss ä»£è¡¨è¿›ç¨‹å¸¸é©»å†…å­˜éƒ¨åˆ†, æ˜¯ç»™è¿™ä¸ªè¿›ç¨‹åˆ†é…äº†å¤šå°‘ç‰©ç†å†…å­˜(å æ€»åˆ†é…å†…å­˜çš„ä¸€éƒ¨åˆ†) è¿™äº›ç‰©ç†å†…å­˜ä¸­åŒ…å«å †ï¼Œæ ˆï¼Œå’Œä»£ç æ®µã€‚è¿›ç¨‹ä¸­çš„å†…å­˜æ€»å…±æœ‰å‡ éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ˜¯ rssï¼Œå…¶ä½™éƒ¨åˆ†åœ¨äº¤æ¢åŒºï¼ˆswapï¼‰æˆ–è€…æ–‡ä»¶ç³»ç»Ÿï¼ˆfilesystemï¼‰ä¸­ã€‚</p><p>å½“æˆ‘ä»¬åœ¨ä»£ç ä¸­å£°æ˜å˜é‡å¹¶ä¸”èµ‹å€¼çš„æ—¶å€™ï¼Œä½¿ç”¨çš„å¯¹è±¡å°±åˆ†é…åœ¨å †ä¸­ï¼Œå¦‚æœå·²ç»ç”³è¯·åˆ°çš„å †å†…å­˜ä¸å¤Ÿåˆ†é…æ—¶ï¼Œå°±ç»§ç»­ç”³è¯·ï¼Œç›´åˆ°è¶…è¿‡ V8 çš„é™åˆ¶ä¸ºæ­¢ã€‚</p><p>åœ¨ Node ç¯å¢ƒä¸­ä½¿ç”¨ä¸‹é¢ä¸¤ä¸ªå‚æ•°å¯ä»¥è°ƒæ•´å¯åŠ¨æ—¶å†…å­˜é™åˆ¶çš„å¤§å°ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node --max-nex-space-size=1024 app.js // å•ä½ä¸ºKB</span><br><span class="line">node --max-old-space-size=2000 app.js // å•ä½ä¸ºMB</span><br></pre></td></tr></table></figure><h3>V8 åƒåœ¾å›æ”¶æœºåˆ¶</h3><p>V8 é‡‡ç”¨åˆ†ä»£å¼çš„åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œä¸»è¦å°†å†…å­˜åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€ç”Ÿä»£ã€‚æ–°ç”Ÿä»£ä¸­å¯¹è±¡å­˜æ´»æ—¶é—´è¾ƒçŸ­ï¼Œè€ç”Ÿä»£ä¸­å¯¹è±¡å­˜æ´»æ—¶é—´è¾ƒé•¿æˆ–è€…å¸¸é©»å†…å­˜ã€‚ <code>--max-old-space-size</code> å’Œ <code>--max-new-space-size</code> å°±æ˜¯ç”¨äºè®¾ç½®è€ç”Ÿä»£å’Œæ–°ç”Ÿä»£å†…å­˜å¤§å°ã€‚</p><p>(1) Scavenge ç®—æ³•</p><p>æ–°ç”Ÿä»£å¯¹è±¡ä¸»è¦é€šè¿‡ Scavenge ç®—æ³•è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œåœ¨ Scavenge çš„å…·ä½“å®ç°ä¸­ï¼Œä¸»è¦é‡‡å– Cheney ç®—æ³•ã€‚</p><p>Cheney ç®—æ³•æ˜¯ä¸€ç§é‡‡ç”¨å¤åˆ¶çš„æ–¹å¼å®ç°çš„åƒåœ¾å›æ”¶ç®—æ³•ï¼Œå®ƒå°†å †å†…å­˜ä¸€åˆ†ä¸ºäºŒï¼Œæ¯ä»½ç©ºé—´ç§°ä¸º semispaceï¼Œä¸¤ä»½å †å†…å­˜ä¸€ä¸ªå¤„äºä½¿ç”¨ä¸­ï¼Œä¸€ä¸ªå¤„äºé—²ç½®çŠ¶æ€ã€‚å¤„äºä½¿ç”¨çŠ¶æ€çš„çš„ç©ºé—´ç§°ä¸º From ç©ºé—´ï¼Œå¤„äºé—²ç½®çŠ¶æ€çš„ç©ºé—´ç§°ä¸º To ç©ºé—´ã€‚å½“æˆ‘ä»¬åˆ†é…å¯¹è±¡æ—¶ï¼Œé¦–å…ˆåœ¨ From ç©ºé—´åˆ†é…ï¼Œå½“å¼€å§‹è¿›è¡Œåƒåœ¾å›æ”¶æ—¶ï¼Œä¼šæ£€æŸ¥ From ä¸­å­˜æ´»çš„å¯¹è±¡ï¼Œå°†å…¶å¤åˆ¶åˆ° To ç©ºé—´ä¸­ï¼Œéå­˜æ´»å¯¹è±¡å ç”¨çš„ç©ºé—´å°†è¢«é‡Šæ”¾ã€‚</p><p>Scavenge çš„ç¼ºç‚¹æ˜¯åªèƒ½ä½¿ç”¨ä¸€åŠçš„å †å†…å­˜ï¼Œä½†æ˜¯ç”±äº Scavenge åªå¤åˆ¶å­˜æ´»çš„å¯¹è±¡ï¼Œæ‰€ä»¥åœ¨é¢å¯¹å£°æ˜å‘¨æœŸè¾ƒçŸ­çš„åœºæ™¯æ—¶ï¼Œéå¸¸æœ‰ä¼˜åŠ¿ã€‚å› æ­¤åœ¨ V8 æ–°ç”Ÿä»£å†…å­˜ä¸­åƒåœ¾å›æ”¶ä½¿ç”¨ Scavenge ç®—æ³•ã€‚</p><p>åœ¨ V8 åˆ†ä»£å¼åƒåœ¾å›æ”¶æœºåˆ¶ä¸‹ï¼ŒFrom ç©ºé—´ä¸­å­˜æ´»çš„å¯¹è±¡åœ¨å¤åˆ¶åˆ° To ç©ºé—´ä¹‹å‰è¦è¿›è¡Œæ£€æŸ¥ï¼Œå°†ä¸€äº›æ»¡è¶³æ¡ä»¶çš„å¯¹è±¡ç§»åŠ¨åˆ°è€ç”Ÿä»£å†…å­˜ä¸­ã€‚</p><p>(2) Mark-Sweep &amp; Mark-Compact</p><p>V8 åœ¨è€ç”Ÿä»£å†…å­˜ä¸­ï¼Œä¸»è¦é‡‡ç”¨æ ‡è®°æ¸…é™¤æ³•å’Œæ ‡è®°ç´§ç¼©æ³•è¿›è¡Œåƒåœ¾å›æ”¶ã€‚</p><p>Mark-Sweep åœ¨æ ‡è®°é˜¶æ®µéå†å †ä¸­æ‰€æœ‰çš„å¯¹è±¡ï¼Œå¹¶æ ‡è®°æ´»ç€çš„å¯¹è±¡ï¼Œåœ¨éšåçš„æ¸…é™¤é˜¶æ®µï¼Œåªæ¸…é™¤æ²¡æœ‰è¢«æ ‡è®°çš„å¯¹è±¡ã€‚Mark-Sweep å­˜åœ¨çš„é—®é¢˜æ˜¯è¿›è¡Œä¸€æ¬¡æ ‡è®°æ¸…é™¤å›æ”¶åï¼Œå†…å­˜ä¼šå‡ºç°ä¸è¿ç»­çš„çŠ¶æ€ã€‚</p><p>ä¸ºäº†è§£å†³ Mark-Sweep ä¸­å†…å­˜ç¢ç‰‡çš„é—®é¢˜ï¼ŒMark-Compact è¢«æå‡ºæ¥äº†ã€‚Mark-Compact æ˜¯æ ‡è®°æ•´ç†æˆ–è€…æ ‡è®°ç´§ç¼©çš„æ„æ€ã€‚ Mark-Compact åœ¨ Mark-Sweep çš„åŸºç¡€ä¸Šæ¼”å˜è€Œæ¥ï¼Œå®ƒä»¬çš„å·®åˆ«åœ¨äºï¼Œæ¸…é™¤å®Œæ ‡è®°å¯¹è±¡åï¼Œåœ¨æ•´ç†çš„è¿‡ç¨‹ä¸­ï¼Œå°†æ´»ç€çš„å¯¹è±¡å‘ä¸€ç«¯ç§»åŠ¨ï¼Œç§»åŠ¨å®Œæˆåï¼Œç›´æ¥æ¸…ç†æ‰è¾¹ç•Œçš„å†…å­˜ã€‚</p><p>(3) Incremental Marking</p><p>ä¸ºäº†é¿å…å‡ºç° JavaScript åº”ç”¨é€»è¾‘ä¸åƒåœ¾å›æ”¶å™¨ä¸­çœ‹åˆ°çš„ä¸ä¸€è‡´çš„æƒ…å†µï¼Œåƒåœ¾å›æ”¶çš„ 3 ç§ç®—æ³•éƒ½è¦å°†åº”ç”¨é€»è¾‘æš‚åœä¸‹è·¯ï¼Œå¾…æ‰§è¡Œå®Œåƒåœ¾å›æ”¶åå†æ¢å¤æ‰§è¡Œé€»è¾‘ã€‚<br>å¢é‡æ ‡è®°æ˜¯åœ¨ V8 ä¸ºäº†é™ä½åƒåœ¾å›æ”¶æ—¶å¸¦æ¥çš„åœé¡¿æ—¶é—´ï¼ŒV8 ä»åœé¡¿é˜¶æ®µå…¥æ‰‹ï¼Œå°†åŸæ¥è¦ä¸€å£æ°”å®Œæˆçš„åŠ¨ä½œæ‹†åˆ†ä¸ºè®¸å¤šéƒ¨åˆ†ï¼Œæ¯å®Œæˆä¸€éƒ¨åˆ†ï¼Œè®© JavaScript åº”ç”¨é€»è¾‘æ‰§è¡Œä¸€å°ä¼šå„¿ï¼Œåƒåœ¾å›æ”¶ä¸åº”ç”¨é€»è¾‘äº¤æ›¿æ‰§è¡Œç›´åˆ°æ ‡è®°é˜¶æ®µå®Œæˆã€‚</p><h3>æŸ¥çœ‹åƒåœ¾å›æ”¶æ—¥å¿—</h3><p>é€šè¿‡åœ¨å¯åŠ¨å‚æ•°ä¸­æ·»åŠ  <code>--trace_gc</code>ï¼Œå½“è¿›è¡Œåƒåœ¾å›æ”¶æ—¶ï¼Œä¼šæ‰“å°å‡ºåƒåœ¾å›æ”¶çš„ä¿¡æ¯ã€‚</p><p>é€šè¿‡åœ¨å¯åŠ¨å‚æ•°ä¸­æ·»åŠ  <code>--prof</code>ï¼Œå¯ä»¥å¾—åˆ° V8 æ‰§è¡Œæ—¶çš„æ€§èƒ½åˆ†ææ•°æ®ï¼Œå…¶ä¸­åŒ…å«åƒåœ¾å›æ”¶æ‰§è¡Œæ‰€å ç”¨çš„æ—¶é—´ã€‚</p><h2>å¦‚ä½•é«˜æ•ˆå®ç”¨å†…å­˜</h2><h3>ä½œç”¨åŸŸ</h3><p>åœ¨ JavaScript ä¸­èƒ½å½¢æˆä½œç”¨åŸŸçš„æœ‰å‡½æ•°è°ƒç”¨ï¼Œwith ä»¥åŠ å…¨å±€ä½œç”¨åŸŸã€‚æ¯”å¦‚åœ¨ä¸‹é¢ä»£ç ä¸­ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> foo = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> local = &#123;&#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>foo() åœ¨æ¯æ¬¡è¢«è°ƒç”¨çš„æ—¶å€™éƒ½ä¼šåˆ›å»ºå¯¹äºçš„ä½œç”¨åŸŸï¼Œæ‰§è¡Œå®Œåä½œç”¨åŸŸé”€æ¯ï¼Œä½œç”¨åŸŸå†…å£°æ˜çš„å±€éƒ¨å˜é‡ä¹Ÿéšä¹‹é”€æ¯ã€‚åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œlocal å¯¹è±¡ä¼šåˆ†é…åœ¨æ–°ç”Ÿä»£å†…å­˜ From ä¸­ï¼Œä½œç”¨åŸŸé‡Šæ”¾åï¼Œlocal è¢«åƒåœ¾å›æ”¶ã€‚</p><p>(1) æ ‡è¯†ç¬¦æŸ¥æ‰¾</p><p>æ ‡è¯†ç¬¦å¯ä»¥ç†è§£ä¸ºå˜é‡åï¼Œåœ¨ JavaScript æ‰§è¡Œæ—¶ï¼Œå®ƒä¼šé¦–å…ˆæŸ¥æ‰¾å½“å‰ä½œç”¨åŸŸï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œå°†ä¼šå‘ä¸Šçº§ä½œç”¨åŸŸæŸ¥æ‰¾ï¼Œç›´åˆ°æŸ¥åˆ°ä¸ºæ­¢ã€‚è¿™ç§ä¸æ–­å‘ä¸Šçº§ä½œç”¨åŸŸæŸ¥æ‰¾çš„æ–¹å¼ä¹Ÿå«åšä½œç”¨åŸŸé“¾ã€‚</p><p>(2) å˜é‡ä¸»åŠ¨é‡Šæ”¾</p><p>å…¨å±€å˜é‡å¦‚æœä¸ä¸»åŠ¨åˆ é™¤ï¼Œå¯èƒ½ä¼šå¯¼è‡´å¯¹è±¡å¸¸é©»å†…å­˜ï¼ˆè€ç”Ÿä»£ï¼‰ï¼Œå¯ä»¥é€šè¿‡ delete æ“ä½œç¬¦æ¥åˆ é™¤å¼•ç”¨å…³ç³»ã€‚æˆ–è€…å°†å˜é‡é‡æ–°èµ‹å€¼ï¼Œè®©æ—§çš„å¯¹è±¡è„±ç¦»å¼•ç”¨å…³ç³»ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">global.foo = <span class="string">'I am a global object'</span></span><br><span class="line"><span class="keyword">delete</span> global.foo</span><br><span class="line"><span class="comment">//æˆ–è€…é‡æ–°èµ‹å€¼</span></span><br><span class="line">global.foo = <span class="literal">undefined</span></span><br></pre></td></tr></table></figure><h3>é—­åŒ…(closure)</h3><p>é—­åŒ…æ˜¯ä¸€ç§åä½œç”¨åŸŸé“¾çš„æ–¹å¼ï¼Œé€šè¿‡é«˜é˜¶å‡½æ•°ï¼Œå®ç°å¤–éƒ¨ä½œç”¨åŸŸè®¿é—®å†…éƒ¨ä½œç”¨åŸŸä¸­çš„å˜é‡çš„æ–¹æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> foo = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> bar = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> local = <span class="string">"å±€éƒ¨å˜é‡"</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> local</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> baz = bar()</span><br><span class="line">  <span class="built_in">console</span>.log(baz())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸€èˆ¬æ¥è¯´ï¼Œbar() å‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼Œå±€éƒ¨å˜é‡ local å°±ä¼šè¢«åƒåœ¾å›æ”¶ï¼Œä½†æ˜¯ bar() å‡½æ•°è¿”å›äº†ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œè€Œä¸”åŒ¿åå‡½æ•°è¿˜å…·å¤‡è®¿é—® local çš„æ¡ä»¶ï¼Œæ‰€ä»¥åªè¦æ‰§è¡ŒåŒ¿åå‡½æ•°çš„ baz å­˜åœ¨ï¼Œlocal å°±ä¸ä¼šè¢«åƒåœ¾å›æ”¶ã€‚</p><h3>å°ç»“</h3><p>åœ¨æ­£å¸¸çš„ JavaScript æ‰§è¡Œä¸­ï¼Œæ— æ³•ç«‹å³å›æ”¶çš„å†…å­˜æœ‰é—­åŒ…å’Œå…¨å±€å˜é‡ï¼Œå› æ­¤åœ¨ä½¿ç”¨çš„æ—¶å€™è¦å¤šåŠ å°å¿ƒï¼Œé¿å…è€ç”Ÿä»£å†…å­˜ä¸æ–­å¢å¤šçš„ç°è±¡ã€‚</p><h2>å†…å­˜æŒ‡æ ‡</h2><h3>æŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µ</h3><p>(1) process.memoryUsage()<br>(2) os æ¨¡å—çš„ totalmem() å’Œ freemem() å¯ä»¥æŸ¥çœ‹æ“ä½œç³»ç»Ÿæ€»å†…å­˜å’Œé—²ç½®å†…å­˜ã€‚</p><h3>å †å¤–å†…å­˜</h3><p>é€šè¿‡ process.memoryUsage() å¯ä»¥å‘ç°å †ä¸­çš„å†…å­˜ä½¿ç”¨é‡æ€»æ˜¯å°äºè¿›ç¨‹çš„å¸¸é©»å†…å­˜ä½¿ç”¨é‡çš„ï¼Œè¿™å°±æ„å‘³ç€ Node ä¸­å†…å­˜çš„ä½¿ç”¨å¹¶éå…¨éƒ¨é€šè¿‡ V8 è¿›è¡Œåˆ†é…ã€‚é‚£äº›ä¸é€šè¿‡ V8 è¿›è¡Œåˆ†é…çš„å†…å­˜æˆä¸ºå †å¤–å†…å­˜ã€‚æ¯”å¦‚ Buffer å¯¹è±¡ä½¿ç”¨çš„å°±æ˜¯å †å¤–å†…å­˜ã€‚</p><h2>å†…å­˜æ³„æ¼</h2><p>é€ æˆå†…å­˜æ³„æ¼çš„ä¸»è¦åŸå› æœ‰ï¼šç¼“å­˜ï¼Œé˜Ÿåˆ—æ¶ˆè´¹ä¸åŠæ—¶ï¼Œä½œç”¨åŸŸæœªé‡Šæ”¾ã€‚</p><h3>ç¼“å­˜</h3><p>åœ¨ Node ä¸­ï¼Œä¸€æ—¦ä¸€ä¸ªå¯¹è±¡è¢«å½“åšç¼“å­˜ç”¨ï¼Œé‚£å°±æ„å‘³ç€å®ƒå°†ä¼šå¸¸é©»è€ç”Ÿä»£å†…å­˜ï¼Œè€ç”Ÿä»£å†…å­˜çš„å †ç§¯ä¼šå¯¼è‡´åƒåœ¾å›æ”¶åœ¨è¿›è¡Œæ‰«ææ—¶ï¼Œå¯¹è¿™äº›å¯¹è±¡åšæ— ç”¨åŠŸã€‚</p><p>ä¸‹é¢æ˜¯æˆ‘ä»¬ç»å¸¸éƒ½ä¼šå†™çš„ä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> cache = &#123;&#125;</span><br><span class="line"><span class="keyword">var</span> <span class="keyword">get</span> = function (key) &#123;</span><br><span class="line">  <span class="keyword">if</span> (cache[key]) &#123;</span><br><span class="line">    <span class="keyword">return</span> cache[key]</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// get from otherwise</span></span><br><span class="line">    cache[key] = value</span><br><span class="line">    <span class="keyword">return</span> value</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ååˆ†å®¹æ˜“ç†è§£ï¼Œåˆ›å»ºç¼“å­˜ä»¥å†…å­˜æ¢å– CPU æ‰§è¡Œæ—¶é—´ï¼Œä½†æ˜¯è¦æ³¨æ„ä¸€å®šè¦é™å®šç¼“å­˜å¯¹è±¡çš„å¤§å°ï¼Œå†åŠ ä¸Šå®Œå–„çš„è¿‡æœŸç­–ç•¥é˜²æ­¢å†…å­˜æ— é™åˆ¶å¢é•¿ã€‚</p><h3>ç¼“å­˜çš„è§£å†³æ–¹æ¡ˆ</h3><p>ç›´æ¥å°†å†…å­˜ä½œä¸ºç¼“å­˜çš„æ–¹æ¡ˆè¦ååˆ†æ…é‡ï¼Œé™¤äº†è¦é™åˆ¶ç¼“å­˜å¤§å°å¤–ï¼Œè¿˜éœ€è¦è€ƒè™‘çš„äº‹æƒ…æ˜¯è¿›ç¨‹ç›´æ¥æ— æ³•å…±äº«å†…å­˜ã€‚è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨è¿›ç¨‹å¤–ç¼“å­˜ï¼Œæ¯”å¦‚ Redis å’Œ Memcachedã€‚</p><h3>å…³æ³¨é˜Ÿåˆ—çŠ¶æ€</h3><p>Node é€šè¿‡ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼æ„å»ºæ¶ˆæ¯é˜Ÿåˆ—ï¼Œå‡å¦‚é˜Ÿåˆ—çš„æ¶ˆè´¹é€Ÿåº¦ä½äºé˜Ÿåˆ—çš„ç”Ÿæˆé€Ÿåº¦ï¼Œå¾ˆå®¹æ˜“é€ æˆå †ç§¯ã€‚ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œæœ‰çš„åº”ç”¨ä¼šæ”¶é›†æ—¥å¿—ï¼Œå‡å¦‚é‡‡ç”¨æ•°æ®åº“æ¥è®°å½•æ—¥å¿—ï¼Œç”±äºæ•°æ®åº“æ„äºæ–‡ä»¶ç³»ç»Ÿä¹‹ä¸Šï¼Œå†™å…¥çš„æ•ˆç‡ä½äºæ–‡ä»¶ç›´æ¥å†™å…¥ï¼Œäºæ˜¯ä¼šå½¢æˆæ•°æ®åº“å†™å…¥æ“ä½œçš„å †ç§¯ï¼Œè€Œ JavaScript ä¸­ç›¸å…³çš„ä½œç”¨åŸŸå¾—ä¸åˆ°é‡Šæ”¾ï¼Œä»è€Œå¯¼è‡´å†…å­˜æ³„æ¼ã€‚</p><p>è§£å†³æ–¹æ³•ï¼š</p><ol><li>ä½¿ç”¨æ›´å¿«æ¶ˆè´¹é€Ÿåº¦çš„æŠ€æœ¯ã€‚æ¯”å¦‚æ—¥å¿—ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿè¯»å†™ä»£æ›¿æ•°æ®åº“ã€‚</li><li>ç›‘æ§é˜Ÿåˆ—çš„é•¿åº¦ï¼Œä¸€æ—¦å †ç§¯ï¼Œç›‘æ§ç³»ç»Ÿäº§ç”Ÿè­¦æŠ¥å¹¶é€šçŸ¥ç›¸å…³äººå‘˜ã€‚</li><li>ä»»æ„çš„å¼‚æ­¥è°ƒç”¨éƒ½åº”è¯¥åŒ…å«è¶…æ—¶æœºåˆ¶ï¼Œä¸€æ—¦åœ¨é™å®šæ—¶é—´å†…æœªå®Œæˆå“åº”ï¼Œé€šè¿‡å›æ‰å‡½æ•°ä¼ é€’è¶…æ—¶å¼‚å¸¸ï¼Œä½¿å¼‚æ­¥è°ƒç”¨æœ‰å¯æ§çš„å“åº”æ—¶é—´ã€‚</li><li>Bagpipe ä¸­æä¾›è¶…æ—¶æ¨¡å¼å’Œæ‹’ç»æ¨¡å¼ï¼Œå¯åŠ¨è¶…æ—¶æ¨¡å¼æ—¶ï¼Œå‡½æ•°è¶…æ—¶å°±è¿”å›è¶…æ—¶é”™è¯¯ï¼Œå¯åŠ¨æ‹’ç»æ¨¡å¼æ—¶ï¼Œå½“é˜Ÿåˆ—æ‹¥å¡æ—¶ï¼Œæ–°æ¥çš„è°ƒç”¨ä¼šç›´æ¥å“åº”æ‹¥å¡é”™è¯¯ã€‚</li></ol><h2>å†…å­˜æ³„æ¼æ’æŸ¥</h2><p><a href="https://github.com/bnoordhuis/node-heapdump" target="_blank" rel="noopener">node-heapdump</a> å…è®¸å¯¹ V8 å †å†…å­˜æŠ“å–å¿«ç…§ï¼Œç”¨äºäº‹ååˆ†æã€‚</p><p><a href="https://github.com/lloyd/node-memwatch" target="_blank" rel="noopener">node-memwatch</a></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> memwatch = <span class="built_in">require</span>(<span class="string">'memwatch'</span>)</span><br><span class="line">memwatch.on(<span class="string">'leak'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">info</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'leak:'</span>)</span><br><span class="line">  <span class="built_in">console</span>.log(info)</span><br><span class="line">&#125;)</span><br><span class="line">memwatch.on(<span class="string">'stats'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">stats</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'stats:'</span>)</span><br><span class="line">  <span class="built_in">console</span>.log(stats)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3>stats äº‹ä»¶</h3><p>åœ¨è¿›ç¨‹ä¸­ä½¿ç”¨ node-memwatch ä¹‹åï¼Œæ¯æ¬¡è¿›è¡Œåƒåœ¾å›æ”¶çš„æ—¶å€™ï¼Œéƒ½ä¼šè§¦å‘ä¸€æ¬¡ stats äº‹ä»¶ï¼Œè¿™ä¸ªäº‹ä»¶å°†ä¼šä¼ é€’å†…å­˜çš„ç»Ÿè®¡ä¿¡æ¯ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"num_full_gc"</span>: <span class="number">17</span>,  <span class="comment">// ç¬¬ 17 æ¬¡è¿›è¡Œå…¨é˜Ÿåƒåœ¾å›æ”¶</span></span><br><span class="line">  <span class="string">"num_inc_gc"</span>: <span class="number">8</span>, <span class="comment">// ç¬¬å‡ æ¬¡å¢é‡åƒåœ¾å›æ”¶</span></span><br><span class="line">  <span class="string">"heap_compactions"</span>: <span class="number">8</span>, <span class="comment">// ç¬¬å‡ æ¬¡å¯¹è€ç”Ÿä»£è¿›è¡Œæ•´ç†</span></span><br><span class="line">  <span class="string">"estimated_base"</span>: <span class="number">2592568</span>, <span class="comment">// é¢„ä¼°åŸºæ•°</span></span><br><span class="line">  <span class="string">"current_base"</span>: <span class="number">2592568</span>, <span class="comment">// å½“å‰åŸºæ•°</span></span><br><span class="line">  <span class="string">"min"</span>: <span class="number">2499912</span>, <span class="comment">// æœ€å°</span></span><br><span class="line">  <span class="string">"max"</span>: <span class="number">2592568</span>, <span class="comment">// æœ€å¤§</span></span><br><span class="line">  <span class="string">"usage_trend"</span>: <span class="number">0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3>leak äº‹ä»¶</h3><p>leak äº‹ä»¶è®°å½• Node ä¸­å­˜åœ¨çš„å†…å­˜æ³„æ¼ã€‚å¦‚æœç»è¿‡ 5 æ¬¡åƒåœ¾å›æ”¶ï¼Œå†…å­˜ä»ç„¶æ²¡æœ‰é‡Šæ”¾ï¼Œè¿™æ„å‘³ç€å¯èƒ½å­˜åœ¨å†…å­˜æ³„æ¼ï¼Œnode-memwatch ä¼šå‘å‡ºä¸€ä¸ª leak äº‹ä»¶ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="attr">start</span>: Fri, <span class="number">29</span> Jun <span class="number">2012</span> <span class="number">14</span>:<span class="number">12</span>:<span class="number">13</span> GMT,</span><br><span class="line">  end: Fri, <span class="number">29</span> Jun <span class="number">2012</span> <span class="number">14</span>:<span class="number">12</span>:<span class="number">33</span> GMT,</span><br><span class="line">  growth: <span class="number">67984</span>,</span><br><span class="line">  reason: <span class="string">'heap growth over 5 consecutive GCs (20s) - 11.67 mb/hr'</span> &#125;</span><br></pre></td></tr></table></figure><p>growth æ˜¾ç¤ºäº† 5 æ¬¡åƒåœ¾å›æ”¶çš„è¿‡ç¨‹ä¸­å†…å­˜å¢é•¿äº†å¤šå°‘ã€‚</p><h2>å¤§å†…å­˜åº”ç”¨</h2><p>Node ä¸­ä½¿ç”¨ Stream æ¨¡å—å¤„äºå¤„ç†å¤§æ–‡ä»¶</p><p>Stream æ¨¡å—æ˜¯ Node çš„åŸç”Ÿæ¨¡å—ï¼Œç»§æ‰¿è‡ª EventEmitterï¼Œå…·å¤‡åŸºæœ¬è‡ªå®šä¹‰äº‹ä»¶åŠŸèƒ½å’Œæ ‡å‡†çš„äº‹ä»¶å’Œæ–¹æ³•ã€‚Stream åˆ†ä¸ºè¯»å’Œå†™ä¸¤ç§ï¼ŒNode ä¸­å¾ˆå¤šæ¨¡å—ä¾èµ–äº Stream æ¨¡å—ï¼Œæ¯”å¦‚ fs.createReadStream() å’Œ fs.createWriteStream() åˆ†åˆ«ç”¨æ¥åˆ›å»ºæ–‡ä»¶çš„å¯è¯»æµå’Œå¯å†™æµã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> reader = fs.createReadStream(<span class="string">'in.txt'</span>)</span><br><span class="line"><span class="keyword">var</span> writer = fs.createWriteStream(<span class="string">'out.txt'</span>)</span><br><span class="line">reader.on(<span class="string">'data'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">chunk</span>) </span>&#123;</span><br><span class="line">  writer.write(chunk)</span><br><span class="line">&#125;)</span><br><span class="line">reader.on(<span class="string">'end'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  writer.end()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>æˆ–è€…ä½¿ç”¨ç®¡é“æ–¹æ³•</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> reader = fs.createReadStream(<span class="string">'in.txt'</span>)</span><br><span class="line"><span class="keyword">var</span> writer = fs.createWriteStream(<span class="string">'out.txt'</span>)</span><br><span class="line">reader.pipe(writer)</span><br></pre></td></tr></table></figure><p>é€šè¿‡æµçš„æ–¹å¼è¿›è¡Œæ–‡ä»¶çš„è¯»å†™ï¼Œä¸ä¼šå— V8 å†…å­˜é™åˆ¶ï¼Œå¦‚æœä¸éœ€è¦è¿›è¡Œå­—ç¬¦ä¸²å±‚é¢çš„æ“ä½œï¼Œå¯ä»¥å€ŸåŠ© Buffer æ“ä½œï¼Œä½†æ˜¯å¤§ç‰‡ä½¿ç”¨å†…å­˜çš„æƒ…å†µä¾ç„¶éœ€è¦æ¶ˆæ¯ï¼Œå³ä½¿ V8 ä¸é™åˆ¶å†…å­˜ï¼Œç‰©ç†å†…å­˜ä¾ç„¶æœ‰é™åˆ¶ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;ç¬¬äº”ç«  å†…å­˜æ§åˆ¶&lt;/h1&gt;
&lt;p&gt;æœ¬ç« å­¦ä¹  V8 çš„åƒåœ¾å›æ”¶æœºåˆ¶ä»¥åŠå¦‚ä½•é«˜æ•ˆä½¿ç”¨å†…å­˜ï¼Œå†…å­˜æ³„æ¼ä»¥åŠå¦‚ä½•æ’æŸ¥å†…å­˜æ³„æ¼ã€‚&lt;/p&gt;
&lt;h2&gt;V8 çš„åƒåœ¾å›æ”¶æœºåˆ¶ä¸å†…å­˜é™åˆ¶&lt;/h2&gt;
&lt;p&gt;å…³äº JavaScript ä¸­å¸¸ç”¨çš„åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç«  &lt;a href=&quot;https://lz5z.com/JavaScript%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/&quot;&gt;JavaScript åƒåœ¾å›æ”¶&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h3&gt;V8 çš„å†…å­˜é™åˆ¶&lt;/h3&gt;
&lt;p&gt;ä¸€èˆ¬åç«¯å¼€å‘è¯­è¨€ä¸­ï¼Œåœ¨åŸºæœ¬çš„å†…å­˜ä½¿ç”¨ä¸Šéƒ½æ²¡æœ‰ä»€ä¹ˆé™åˆ¶ï¼Œè€Œ Node ä¸­å°† JavaScript çš„ä½¿ç”¨å†…å­˜åšå‡ºå¦‚ä¸‹é™åˆ¶ï¼š64 ä½æ“ä½œç³»ç»Ÿçº¦ä¸º 1.4Gï¼Œ32 ä½æ“ä½œç³»ç»Ÿçº¦ä¸º 0.7Gã€‚åœ¨è¿™æ ·çš„é™åˆ¶ä¸‹ï¼ŒNode æ— æ³•ç›´æ¥æ“ä½œå¤§å†…å­˜å¯¹è±¡ï¼Œæ¯”å¦‚å°†ä¸€ä¸ª 2GB æ–‡ä»¶è¯»å–åˆ°å†…å­˜ä¸­è¿›è¡Œå­—ç¬¦ä¸²åˆ†æï¼Œå³ä½¿ç‰©ç†å†…å­˜æœ‰ 32 GBã€‚&lt;/p&gt;
&lt;h3&gt;V8 çš„å¯¹è±¡åˆ†é…&lt;/h3&gt;
&lt;p&gt;åœ¨ V8 ä¸­ï¼Œæ‰€æœ‰çš„ JavaScript å¯¹è±¡éƒ½æ˜¯é€šè¿‡å †æ¥è¿›è¡Œå†…å­˜åˆ†é…çš„ï¼ŒNode ä¸­å¯ä»¥é€šè¿‡ &lt;a href=&quot;http://nodejs.cn/api/process.html#process_process_memoryusage&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;process.memoryUsage()&lt;/a&gt; æŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; node&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; process.memoryUsage()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; &amp;#123; rss: 24244224,&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    heapTotal: 9232384,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    heapUsed: 5041608,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    external: 11497 &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Node" scheme="https://lz5z.com/categories/Node/"/>
    
    
      <category term="JavaScript" scheme="https://lz5z.com/tags/JavaScript/"/>
    
      <category term="V8" scheme="https://lz5z.com/tags/V8/"/>
    
      <category term="å†…å­˜" scheme="https://lz5z.com/tags/%E5%86%85%E5%AD%98/"/>
    
  </entry>
  
  <entry>
    <title>ã€Šæ·±å…¥æµ…å‡ºNode.jsã€‹-å¼‚æ­¥I/O</title>
    <link href="https://lz5z.com/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BANode-js-%E5%BC%82%E6%AD%A5I-O/"/>
    <id>https://lz5z.com/æ·±å…¥æµ…å‡ºNode-js-å¼‚æ­¥I-O/</id>
    <published>2018-05-25T22:20:38.000Z</published>
    <updated>2020-04-21T10:23:54.831Z</updated>
    
    <content type="html"><![CDATA[<h2>ç¬¬ä¸‰ç«  å¼‚æ­¥ I/O</h2><p>å¼‚æ­¥çš„æ¦‚å¿µé¦–å…ˆåœ¨ Web2.0 ä¸­ç«èµ·æ¥ï¼Œæ˜¯å› ä¸ºæµè§ˆå™¨ä¸­ JavaScript åœ¨å•çº¿ç¨‹ä¸Šæ‰§è¡Œï¼Œè€Œä¸”å®ƒè¿˜ä¸ UI æ¸²æŸ“å…±ç”¨ä¸€ä¸ªçº¿ç¨‹ã€‚è¿™æ„å‘³ç€ JavaScript åœ¨æ‰§è¡Œçš„æ—¶å€™ UI æ¸²æŸ“å’Œå“åº”æ˜¯å¤„äºåœæ»çŠ¶æ€çš„ã€‚å‰ç«¯é€šè¿‡å¼‚æ­¥çš„æ–¹å¼æ¥æ¶ˆé™¤ UI é˜»å¡çš„ç°è±¡ã€‚å‡å¦‚ä¸šåŠ¡åœºæ™¯ä¸­æœ‰ä¸€ç»„äº’ä¸ç›¸å…³çš„ä»»åŠ¡éœ€è¦å®Œæˆï¼Œå¯ä»¥é‡‡ç”¨ä¸‹é¢ä¸¤ç§æ–¹å¼ã€‚</p><ol><li>å•çº¿ç¨‹ä¸²è¡Œä¸€æ¬¡æ‰§è¡Œã€‚</li><li>å¤šçº¿ç¨‹å¹¶è¡Œæ‰§è¡Œã€‚</li></ol><p>å¦‚æœåˆ›å»ºå¤šçº¿ç¨‹çš„å¼€é”€å°äºå¹¶è¡Œæ‰§è¡Œï¼Œé‚£ä¹ˆå¤šçº¿ç¨‹çš„æ–¹å¼æ˜¯é¦–é€‰çš„ã€‚å¤šçº¿ç¨‹çš„ä»£ä»·åœ¨äºåˆ›å»ºçº¿ç¨‹å’Œæ‰§è¡ŒæœŸé—´çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€è¾ƒå¤§ã€‚å¦å¤–ï¼Œåœ¨å¤æ‚ä¸šåŠ¡ä¸­ï¼Œå¤šçº¿ç¨‹ç¼–ç¨‹ç»å¸¸é¢ä¸´é”ã€çŠ¶æ€åŒæ­¥ç­‰é—®é¢˜ã€‚ä½†æ˜¯å¤šçº¿ç¨‹èƒ½æœ‰æ•ˆåˆ©ç”¨ CPUã€‚</p><p>å•çº¿ç¨‹é¡ºåºæ‰§è¡Œæ¯”è¾ƒç¬¦åˆç¼–ç¨‹äººå‘˜æŒ‰ç…§é¡ºåºæ€è€ƒçš„æ€ç»´æ–¹å¼ï¼Œä¹Ÿæ˜¯æœ€ä¸»æµçš„ç¼–ç¨‹æ–¹å¼ã€‚ç¼ºç‚¹åœ¨äºæ‰§è¡Œæ€§èƒ½ï¼Œä»»ä½•ä¸€ä¸ªç•¥æ…¢çš„ä»»åŠ¡éƒ½ä¼šå¯¼è‡´åç»­æ‰§è¡Œä»£ç è¢«é˜»å¡ã€‚</p><p>Node åœ¨ä¸¤è€…ä¹‹é—´ç»™å‡ºäº†å®ƒçš„æ–¹æ¡ˆï¼šåˆ©ç”¨å•çº¿ç¨‹ï¼Œè¿œç¦»å¤šçº¿ç¨‹æ­»é”ï¼ŒçŠ¶æ€åŒæ­¥é—®é¢˜ï¼›åˆ©ç”¨å¼‚æ­¥ I/Oï¼Œè®©å•çº¿ç¨‹è¿œç¦»é˜»å¡ï¼Œæ›´å¥½åœ°åˆ©ç”¨ CPUã€‚</p><p>å¼‚æ­¥ I/O å°±æ˜¯ I/O çš„è°ƒç”¨ä¸å†é˜»å¡åç»­è®¡ç®—ï¼Œå°†åŸæœ‰ç­‰å¾… I/O å®Œæˆè¿™æ®µæ—¶é—´åˆ†é…ç»™å…¶å®ƒéœ€è¦çš„ä¸šåŠ¡å»æ‰§è¡Œã€‚</p><a id="more"></a><h3>å¼‚æ­¥ I/O å’Œ éé˜»å¡ I/O</h3><p>ä»è®¡ç®—æœºå†…æ ¸ I/O è€Œè¨€ï¼ŒåŒæ­¥/å¼‚æ­¥å’Œé˜»å¡/éé˜»å¡å®é™…ä¸Šæ˜¯ä¸åŒçš„ã€‚æ“ä½œç³»ç»Ÿå†…æ ¸å¯¹ I/O åªæœ‰ä¸¤ç§æ–¹å¼ï¼Œé˜»å¡å’Œéé˜»å¡ã€‚åœ¨è°ƒç”¨é˜»å¡ I/O æ—¶ï¼Œåº”ç”¨ç¨‹åºéœ€è¦ç­‰å¾… I/O å®Œæˆæ‰è¿”å›ç»“æœã€‚é˜»å¡ I/O é€ æˆ CPU ç­‰å¾… I/Oï¼ŒCPU çš„å¤„ç†èƒ½åŠ›å¾—ä¸åˆ°å……åˆ†åˆ©ç”¨ã€‚ä¸ºäº†æé«˜æ€§èƒ½ï¼Œå†…æ ¸æä¾›äº†éé˜»å¡ I/Oã€‚éé˜»å¡ I/O åœ¨è°ƒç”¨ä¹‹åç«‹é©¬è¿”å›ï¼Œä½†æ˜¯æ•°æ®å¹¶ä¸åœ¨è¿”å›ç»“æœä¸­ï¼Œè¿”å›ç»“æœä¸­åªæœ‰å½“å‰è°ƒç”¨çš„çŠ¶æ€ã€‚ä¸ºäº†è·å–å®Œæ•´çš„æ•°æ®ï¼Œåº”ç”¨ç¨‹åºéœ€è¦é‡å¤è°ƒç”¨ I/O æ“ä½œæ¥ç¡®è®¤æ˜¯å¦å®Œæˆã€‚è¿™ç§æ–¹å¼å«åšè½®è¯¢ã€‚</p><p>éé˜»å¡ I/O æŠ€æœ¯è™½ç„¶ä¸ä¼šè®© CPU ç­‰å¾…é€ æˆæµªè´¹ï¼Œä½†æ˜¯å´éœ€è¦è½®è¯¢å»ç¡®è®¤æ˜¯å¦å®Œæˆæ•°æ®è·å–ï¼Œå…¶å®ä¹Ÿæ˜¯å¯¹ CPU èµ„æºçš„æµªè´¹ã€‚</p><p>ä¸»è¦è½®è¯¢æŠ€æœ¯ï¼š</p><p>(1) readã€‚åå¤è°ƒç”¨æ¥æ£€æŸ¥ I/O çš„çŠ¶æ€ã€‚<br>(2) selectã€‚é€šè¿‡æ–‡ä»¶æè¿°ç¬¦ä¸Šçš„äº‹ä»¶çŠ¶æ€è¿›è¡Œåˆ¤æ–­ï¼Œselect è½®è¯¢é‡‡ç”¨ 1024 é•¿åº¦æ•°ç»„å­˜å‚¨çŠ¶æ€ã€‚<br>(3) pollã€‚ä½¿ç”¨é“¾è¡¨ï¼Œå‡å°‘ä¸å¿…è¦çš„æ£€æŸ¥ã€‚<br>(4) epollã€‚è¯¥æ–¹æ¡ˆæ˜¯ Linux ä¸‹æ•ˆç‡æœ€é«˜çš„ I/O äº‹ä»¶é€šçŸ¥æœºåˆ¶ã€‚åœ¨è¿›å…¥è½®è¯¢çš„æ—¶å€™å¦‚æœæ²¡æœ‰æ£€æŸ¥åˆ° I/O äº‹ä»¶ï¼Œå°†ä¼šè¿›è¡Œä¼‘çœ ï¼ŒçŸ¥é“äº‹ä»¶å‘ç”Ÿå°†å®ƒå”¤é†’ã€‚</p><h2>Node çš„å¼‚æ­¥ I/O</h2><h3>äº‹ä»¶å¾ªç¯</h3><p>äº‹ä»¶å¾ªç¯æ˜¯ Node è‡ªèº«çš„æ‰§è¡Œæ¨¡å‹ï¼Œæ­£æ˜¯å®ƒä½¿å¾—å›è°ƒå‡½æ•°ååˆ†æ™®éã€‚</p><p>åœ¨è¿›ç¨‹å¯åŠ¨æ—¶ï¼ŒNode ä¾¿ä¼šåˆ›å»ºä¸€ä¸ªç±»ä¼¼äº while(true) çš„å¾ªç¯ï¼Œæ¯æ‰§è¡Œä¸€æ¬¡å¾ªç¯ä½“æˆä¸º Tickã€‚æ¯ä¸ª Tick çš„è¿‡ç¨‹å°±æ˜¯æŸ¥çœ‹æ˜¯å¦æœ‰äº‹ä»¶å¾…å¤„ç†ï¼Œå¦‚æœæœ‰ï¼Œå°±å–å‡ºäº‹ä»¶åŠå…¶ç›¸å…³çš„å›è°ƒå‡½æ•°ã€‚å¦‚æœå­˜åœ¨å…³è”çš„å›è°ƒå‡½æ•°ï¼Œå°±æ‰§è¡Œå®ƒä»¬ï¼Œç„¶åè¿›å…¥ä¸‹ä¸ªå¾ªç¯ï¼Œç›´åˆ°æ²¡æœ‰äº‹ä»¶å¤„ç†ï¼Œå°±é€€å‡ºè¿›ç¨‹ã€‚</p><h3>è§‚å¯Ÿè€…</h3><p>åœ¨æ¯ä¸ª Tick çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚ä½•åˆ¤æ–­æ˜¯å¦æœ‰äº‹ä»¶éœ€è¦å¤„ç†å‘¢ï¼ŸNode åœ¨æ¯ä¸ªäº‹ä»¶å¾ªç¯ä¸­éƒ½æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªè§‚å¯Ÿè€…ï¼Œè€Œåˆ¤æ–­æ˜¯å¦æœ‰äº‹ä»¶éœ€è¦å¤„ç†çš„è¿‡ç¨‹å°±æ˜¯å‘è¿™äº›è§‚å¯Ÿè€…è¯¢é—®æ˜¯å¦æœ‰è¦å¤„ç†çš„äº‹ä»¶ã€‚</p><p>åœ¨ Node ä¸­ï¼Œäº‹ä»¶ä¸»è¦æ¥æºäºç½‘ç»œè¯·æ±‚ï¼Œæ–‡ä»¶ I/O ç­‰ã€‚äº‹ä»¶å¾ªç¯æ˜¯ä¸€ä¸ªå…¸å‹çš„ç”Ÿäº§è€…/æ¶ˆè´¹è€…æ¨¡å‹ã€‚å¼‚æ­¥ I/Oï¼Œç½‘ç»œè¯·æ±‚ç­‰åˆ™æ˜¯äº‹ä»¶çš„ç”Ÿäº§è€…ï¼Œæºæºä¸æ–­ä¸º Node æä¾›ä¸åŒç±»å‹çš„äº‹ä»¶ï¼Œè¿™äº›äº‹ä»¶è¢«ä¼ é€’åˆ°å¯¹åº”çš„è§‚å¯Ÿè€…å“ªé‡Œï¼Œäº‹ä»¶å¾ªç¯åˆ™ä»è§‚å¯Ÿè€…é‚£é‡Œå–å‡ºäº‹ä»¶å¹¶å¤„ç†ã€‚</p><h3>è¯·æ±‚å¯¹è±¡</h3><p>å¯¹äº Node ä¸­çš„å¼‚æ­¥ I/O è€Œè¨€ï¼Œå›è°ƒå‡½æ•°ç©¶ç«Ÿæ˜¯è°åœ¨è°ƒç”¨å‘¢ï¼Ÿæ¯”å¦‚ä¸‹è¿°ä»£ç ï¼Œå½“æ–‡ä»¶æ‰“å¼€æˆåŠŸåï¼Œåé¢çš„å›è°ƒçš„æ‰§è¡Œè¿‡ç¨‹æ˜¯æ€æ ·çš„å‘¢ï¼Ÿ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line">fs.open(<span class="string">'xxx.js'</span>, <span class="string">'a+'</span>, callback)</span><br></pre></td></tr></table></figure><p>ä» JavaScript è°ƒç”¨ Node æ ¸å¿ƒæ¨¡å—ï¼Œæ ¸å¿ƒæ¨¡å—è°ƒç”¨ C++ å†…å»ºæ¨¡å—ï¼Œå†…å»ºæ¨¡å—é€šè¿‡ libuv è¿›è¡Œç³»ç»Ÿè°ƒç”¨ã€‚libuv ä½œä¸ºå°è£…å±‚ï¼Œæœ‰å¹³å°å„è‡ªçš„å®ç°ï¼Œæœ¬è´¨ä¸Šæ˜¯è°ƒç”¨ uv_fs_open() æ–¹æ³•ã€‚åœ¨è°ƒç”¨ uv_fs_open() çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª FSReqWrap è¯·æ±‚å¯¹è±¡ã€‚ä» JavaScript å±‚ä¼ å…¥çš„å‚æ•°å’Œå½“å‰æ–¹æ³•éƒ½å°è£…åœ¨è¿™ä¸ªè¯·æ±‚å¯¹è±¡ä¸­ï¼Œå›è°ƒå‡½æ•°ä¹Ÿæ˜¯è¿™ä¸ªè¯·æ±‚å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ã€‚è€Œæ“ä½œç³»ç»Ÿæ‹¿åˆ°è¿™ä¸ªå¯¹è±¡åï¼Œå°† FSReqWrap å¯¹è±¡æ¨å…¥çº¿ç¨‹æ± ä¸­ç­‰å¾…æ‰§è¡Œã€‚</p><p>è‡³æ­¤ï¼ŒJavaScript è°ƒç”¨ç«‹å³è¿”å›ï¼Œå¼‚æ­¥è°ƒç”¨ç¬¬ä¸€é˜¶æ®µå®Œæˆï¼ŒJavaScript çº¿ç¨‹å¯ä»¥ç»§ç»­æ‰§è¡Œåç»­ä»»åŠ¡ã€‚å½“å‰çš„ I/O æ“ä½œåœ¨çº¿ç¨‹æ± ä¸­ç­‰å¾…æ‰§è¡Œï¼Œä¸ç®¡å®ƒæ˜¯å¦é˜»å¡ï¼Œéƒ½ä¸ä¼šå½±å“ JavaScript åç»­çš„æ‰§è¡Œã€‚</p><h3>æ‰§è¡Œå›è°ƒ</h3><p>çº¿ç¨‹æ± ä¸­çš„è¯·æ±‚å¯¹è±¡åœ¨å¾—åˆ° CPU èµ„æºåè°ƒç”¨æ“ä½œç³»ç»Ÿåº•å±‚çš„å‡½æ•°å®Œæˆ I/O æ“ä½œï¼Œçº¿ç¨‹æ± è°ƒç”¨ PostQueuedCompletionStatus() æ–¹æ³•æäº¤çŠ¶æ€ï¼Œç„¶åå°†ç»“æœå­˜å‚¨åœ¨è¯·æ±‚å¯¹è±¡çš„ <code>req-&gt; result</code> å±æ€§ä¸Šï¼Œå¹¶ä¸”é‡Šæ”¾çº¿ç¨‹å›å½’çº¿ç¨‹æ± ã€‚I/O è§‚å¯Ÿè€…åœ¨æ¯æ¬¡ Tick çš„æ—¶å€™é€šè¿‡è°ƒç”¨ GetQueuedCompletionStatus() æ–¹æ³•å»æ£€æŸ¥çº¿ç¨‹æ± ä¸­æ˜¯å¦æœ‰æ‰§è¡Œå®Œçš„è¯·æ±‚ï¼Œå¦‚æœå­˜åœ¨ï¼Œä¼šå°†è¯·æ±‚å¯¹è±¡åŠ å…¥åˆ° I/O è§‚å¯Ÿè€…é˜Ÿåˆ—ä¸­ï¼Œç„¶åå°†å…¶å½“åšäº‹ä»¶å¤„ç†ã€‚<br>I/O è§‚å¯Ÿè€…å–å‡ºè¯·æ±‚å¯¹è±¡çš„ result å±æ€§ä½œä¸ºå‚æ•°ï¼Œå–å‡ºç»‘å®šåœ¨ä¸Šé¢çš„å›è°ƒå‡½æ•°ï¼Œç„¶åæ‰§è¡Œï¼Œä»¥æ­¤è¾¾åˆ°è°ƒç”¨ JavaScript å›è°ƒå‡½æ•°çš„ç›®çš„ã€‚è‡³æ­¤ï¼Œæ•´ä¸ªå¼‚æ­¥ I/O å®Œæˆã€‚</p><img src="/assets/img/Node_IO.png" alt="Node_IO"><p>äº‹ä»¶å¾ªç¯ã€è§‚å¯Ÿè€…ã€è¯·æ±‚å¯¹è±¡ã€I/O çº¿ç¨‹æ± è¿™å››è€…å…±åŒæ„æˆäº† Node å¼‚æ­¥ I/O æ¨¡å‹çš„åŸºæœ¬è¦ç´ ã€‚Windows ä¸»è¦é€šè¿‡ IOCP æ¥å‘ç³»ç»Ÿå†…æ ¸å‘é€ I/O è°ƒç”¨å’Œä»ç³»ç»Ÿå†…æ ¸è·å– I/O çŠ¶æ€ï¼Œé…ä»¥äº‹ä»¶å¾ªç¯ï¼Œå®Œæˆå¼‚æ­¥ I/O çš„è¿‡ç¨‹ï¼ŒLinux ä¸‹é€šè¿‡ epoll å®ç°è¿™ä¸ªè¿‡ç¨‹ã€‚ä¸åŒçš„æ˜¯ï¼Œçº¿ç¨‹æ± åœ¨ Windows ä¸Šç”±å†…æ ¸ IOCP å®ç°ï¼ŒLinux ä¸‹ç”± libuv å®ç°ã€‚</p><p>æœ€åå›ç­”ä¸Šé¢æåˆ°çš„é—®é¢˜ï¼Œå›è°ƒå‡½æ•°ç©¶ç«Ÿç”±è°æ¥æ‰§è¡Œï¼Ÿç­”æ¡ˆæ˜¯ï¼šI/O è§‚å¯Ÿè€…ã€‚</p><h2>é I/O çš„å¼‚æ­¥ API</h2><p>Node ä¸­è¿˜å­˜åœ¨ä¸€äº›ä¸ I/O æ— å…³çš„ APIï¼šsetTimeout()ã€setInterval()ã€setImmediate() å’Œ process.nextTick()ã€‚</p><h3>å®šæ—¶å™¨</h3><p>(1) setTimeout å’Œ setInterval çš„å®ç°åŸç†ä¸å¼‚æ­¥ I/O æ¯”è¾ƒç±»ä¼¼ï¼Œåªæ˜¯ä¸éœ€è¦çº¿ç¨‹æ± å‚ä¸ã€‚è°ƒç”¨ setTimeout/setInterval åˆ›å»ºçš„å®šæ—¶å™¨ä¼šè¢«æ’å…¥å®šæ—¶å™¨è§‚å¯Ÿè€…å†…éƒ¨çš„çº¢é»‘æ ‘ä¸­ï¼Œæ¯æ¬¡ Tick æ‰§è¡Œæ—¶ï¼Œä¼šä»è¯¥çº¢é»‘æ ‘ä¸­è¿­ä»£é€‰å‡ºå®šæ—¶å™¨å¯¹è±¡ï¼Œæ£€æŸ¥æ˜¯å¦è¶…è¿‡æ—¶é—´ï¼Œå¦‚æœè¶…è¿‡ï¼Œå®ƒçš„å›è°ƒå‡½æ•°ç«‹å³æ‰§è¡Œã€‚</p><p>æ‰§è¡Œå›è°ƒå‡½æ•°çš„æ˜¯å®šæ—¶å™¨è§‚å¯Ÿè€…ã€‚</p><p>å®šæ—¶å™¨çš„é—®é¢˜åœ¨äºï¼Œå®ƒå¹¶éç²¾ç¡®çš„ï¼Œå°½ç®¡äº‹ä»¶å¾ªç¯éå¸¸å¿«ï¼Œä½†æ˜¯å¦‚æœæ¯ä¸€æ¬¡å¾ªç¯å ç”¨æ—¶é—´è¾ƒå¤šï¼Œé‚£ä¹ˆä¸‹æ¬¡å¾ªç¯æ—¶ï¼Œå®ƒå¯èƒ½å·²ç»è¶…æ—¶å¾ˆä¹…äº†ã€‚æ¯”å¦‚ setTimeout è®¾å®šä¸€ä¸ªä»»åŠ¡åœ¨ 10 æ¯«ç§’åæ‰§è¡Œï¼Œä½†æ˜¯åœ¨ 9 æ¯«ç§’æ—¶ï¼Œæœ‰ä¸€ä¸ªä»»åŠ¡å ç”¨äº† 5 æ¯«ç§’çš„ CPU æ—¶é—´ç‰‡ï¼Œå†æ¬¡è½®åˆ°å®šæ—¶å™¨æ‰§è¡Œæ—¶ï¼Œæ—¶é—´å·²ç»è¶…è¿‡ 4 æ¯«ç§’äº†ã€‚</p><img src="/assets/img/Node_IO_setTimeout.png" alt="Node_IO_setTimeout"><p>(2) process.nextTick() çš„å‡ºç°æ­£æ˜¯ä¸ºäº†è§£å†³å®šæ—¶å™¨ç²¾åº¦ä¸é«˜ï¼Œå¹¶ä¸”éœ€è¦çº¢é»‘æ ‘ï¼ˆæ€§èƒ½æµªè´¹ï¼‰çš„é—®é¢˜ã€‚å®ƒçš„ä½œç”¨æ˜¯å®šä¹‰ä¸€ä¸ªåŠ¨ä½œï¼Œåœ¨ä¸‹æ¬¡äº‹ä»¶è½®è¯¢çš„æ—¶é—´ç‚¹ä¸Šæ‰§è¡Œè¿™ä¸ªåŠ¨ä½œã€‚</p><p>æ¯”å¦‚ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'aaa'</span>)  </span><br><span class="line">&#125;</span><br><span class="line">process.nextTick(foo)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'bbb'</span>)</span><br></pre></td></tr></table></figure><p>ç»ˆç«¯ä¸Šçš„è¾“å‡ºç»“æœæ˜¯ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bbb</span><br><span class="line">aaa</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ setTimeout ä¹Ÿèƒ½è¾¾åˆ°åŒæ ·çš„æ•ˆæœï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'aaa'</span>)  </span><br><span class="line">&#125;</span><br><span class="line">setTimeout(foo, <span class="number">0</span>)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'bbb'</span>)</span><br></pre></td></tr></table></figure><p>æ¯æ¬¡è°ƒç”¨ process.nextTick() æ–¹æ³•ï¼Œåªä¼šå°†å›è°ƒå‡½æ•°æ”¾å…¥é˜Ÿåˆ—ä¸­ï¼Œåœ¨ä¸‹ä¸€è½® Tick æ—¶å–å‡ºæ‰§è¡Œã€‚<br>å®šæ—¶å™¨ä¸­é‡‡ç”¨çº¢é»‘æ ‘çš„æ“ä½œæ—¶é—´å¤æ‚åº¦ä¸º O(lg(n))ï¼ŒnextTick() çš„æ—¶æ—¶å¤æ‚åº¦ä¸º O(1)ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œ<br>process.nextTick() æ›´é«˜æ•ˆã€‚</p><p>(3) setImmediate() ä¸ process.nextTick() æ–¹æ³•ååˆ†ç±»ä¼¼ï¼Œéƒ½æ˜¯å°†å›è°ƒå‡½æ•°å»¶è¿Ÿæ‰§è¡Œã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">process.nextTick(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'å»¶è¿Ÿæ‰§è¡Œ'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'æ­£å¸¸æ‰§è¡Œ'</span>)</span><br><span class="line"><span class="comment">//----------//</span></span><br><span class="line">setImmediate(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'å»¶è¿Ÿæ‰§è¡Œ'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'æ­£å¸¸æ‰§è¡Œ'</span>)</span><br></pre></td></tr></table></figure><p>ä¸¤è€…çš„è¾“å‡ºç»“æœæ˜¯ä¸€æ ·çš„ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æ­£å¸¸æ‰§è¡Œ</span><br><span class="line">å»¶è¿Ÿæ‰§è¡Œ</span><br></pre></td></tr></table></figure><p>process.nextTick çš„ä¼˜å…ˆçº§è¦é«˜äº setImmediateã€‚åŸå› æ˜¯äº‹ä»¶å¾ªç¯å¯¹è§‚å¯Ÿè€…çš„æ£€æŸ¥æ˜¯æœ‰å…ˆåé¡ºåºçš„ã€‚process.nextTick å±äº idle è§‚å¯Ÿè€…ï¼ŒsetImmediate å±äº check è§‚å¯Ÿè€…ã€‚åœ¨æ¯ä¸€ä¸ªè½®è¯¢æ£€æŸ¥ä¸­ï¼Œidle è§‚å¯Ÿè€…ä¼˜å…ˆäº I/O è§‚å¯Ÿè€…ï¼ŒI/O è§‚å¯Ÿè€…ä¼˜å…ˆäº check è§‚å¯Ÿè€…ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªä¸»è¦çš„åŒºåˆ«æ˜¯ï¼Œprocess.nextTick() çš„å›è°ƒå‡½æ•°ä¿å­˜åœ¨æ•°ç»„ä¸­ï¼ŒsetImmediate() çš„å›è°ƒå‡½æ•°ä¿å­˜åœ¨é“¾è¡¨ä¸­ã€‚åœ¨è¡Œä¸ºä¸Šï¼Œprocess.nextTick() åœ¨æ¯æ¬¡è½®è¯¢ä¸­ä¼šå°†æ•°ç»„å†…å…¨éƒ¨å›è°ƒå‡½æ•°æ‰§è¡Œå®Œï¼ŒsetImmediate() åœ¨æ¯æ¬¡å¾ªç¯ä¸­åªæ‰§è¡Œé“¾è¡¨çš„ç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚</p><h2>äº‹ä»¶é©±åŠ¨ä¸é«˜æ€§èƒ½æœåŠ¡å™¨</h2><p>äº‹ä»¶é©±åŠ¨çš„å®è´¨å°±æ˜¯é€šè¿‡ä¸»å¾ªç¯å’Œäº‹ä»¶è§¦å‘çš„æ–¹å¼æ¥è¿è¡Œç¨‹åºï¼ŒNode é‡‡ç”¨çš„äº‹ä»¶é©±åŠ¨çš„æ–¹å¼ï¼Œæ— éœ€ä¸ºæ¯ä¸ªè¯·æ±‚ç®€å†é¢å¤–çš„çº¿ç¨‹ï¼Œå¯ä»¥çœå»çº¿ç¨‹åˆ›å»ºåˆ‡æ¢å’Œé”€æ¯å¸¦æ¥çš„å¼€é”€ï¼Œä½¿å¾—æœåŠ¡å™¨èƒ½æœ‰æ¡ä¸ç´Šåœ°å¤„ç†æ¶ˆæ¯ï¼Œè¿™æ˜¯ Node é«˜æ€§èƒ½çš„ä¸€ä¸ªä¸»è¦åŸå› ã€‚</p><p>äº‹ä»¶é©±åŠ¨å¸¦æ¥çš„é«˜æ•ˆä¹Ÿè¢« Nginx é‡‡ç”¨ï¼Œä¸åŒä¹‹å¤„åœ¨äº Nginx ç”±çº¯ C ç¼–å†™ï¼Œæ€§èƒ½æå…¶å¼ºå¤§ï¼Œéå¸¸é€‚åˆåš Web æœåŠ¡å™¨ã€‚</p><h2>æ€»ç»“</h2><p>å¼‚æ­¥ I/O çš„æ ¸å¿ƒæ˜¯äº‹ä»¶å¾ªç¯ï¼ŒNode ä½¿ç”¨äº†å’Œæµè§ˆå™¨ä¸­ä¸€æ ·çš„æ‰§è¡Œæ¨¡å‹ï¼Œè®© JavaScript åœ¨æœåŠ¡ç«¯å‘æŒ¥å·¨å¤§çš„èƒ½é‡ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;ç¬¬ä¸‰ç«  å¼‚æ­¥ I/O&lt;/h2&gt;
&lt;p&gt;å¼‚æ­¥çš„æ¦‚å¿µé¦–å…ˆåœ¨ Web2.0 ä¸­ç«èµ·æ¥ï¼Œæ˜¯å› ä¸ºæµè§ˆå™¨ä¸­ JavaScript åœ¨å•çº¿ç¨‹ä¸Šæ‰§è¡Œï¼Œè€Œä¸”å®ƒè¿˜ä¸ UI æ¸²æŸ“å…±ç”¨ä¸€ä¸ªçº¿ç¨‹ã€‚è¿™æ„å‘³ç€ JavaScript åœ¨æ‰§è¡Œçš„æ—¶å€™ UI æ¸²æŸ“å’Œå“åº”æ˜¯å¤„äºåœæ»çŠ¶æ€çš„ã€‚å‰ç«¯é€šè¿‡å¼‚æ­¥çš„æ–¹å¼æ¥æ¶ˆé™¤ UI é˜»å¡çš„ç°è±¡ã€‚å‡å¦‚ä¸šåŠ¡åœºæ™¯ä¸­æœ‰ä¸€ç»„äº’ä¸ç›¸å…³çš„ä»»åŠ¡éœ€è¦å®Œæˆï¼Œå¯ä»¥é‡‡ç”¨ä¸‹é¢ä¸¤ç§æ–¹å¼ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å•çº¿ç¨‹ä¸²è¡Œä¸€æ¬¡æ‰§è¡Œã€‚&lt;/li&gt;
&lt;li&gt;å¤šçº¿ç¨‹å¹¶è¡Œæ‰§è¡Œã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¦‚æœåˆ›å»ºå¤šçº¿ç¨‹çš„å¼€é”€å°äºå¹¶è¡Œæ‰§è¡Œï¼Œé‚£ä¹ˆå¤šçº¿ç¨‹çš„æ–¹å¼æ˜¯é¦–é€‰çš„ã€‚å¤šçº¿ç¨‹çš„ä»£ä»·åœ¨äºåˆ›å»ºçº¿ç¨‹å’Œæ‰§è¡ŒæœŸé—´çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€è¾ƒå¤§ã€‚å¦å¤–ï¼Œåœ¨å¤æ‚ä¸šåŠ¡ä¸­ï¼Œå¤šçº¿ç¨‹ç¼–ç¨‹ç»å¸¸é¢ä¸´é”ã€çŠ¶æ€åŒæ­¥ç­‰é—®é¢˜ã€‚ä½†æ˜¯å¤šçº¿ç¨‹èƒ½æœ‰æ•ˆåˆ©ç”¨ CPUã€‚&lt;/p&gt;
&lt;p&gt;å•çº¿ç¨‹é¡ºåºæ‰§è¡Œæ¯”è¾ƒç¬¦åˆç¼–ç¨‹äººå‘˜æŒ‰ç…§é¡ºåºæ€è€ƒçš„æ€ç»´æ–¹å¼ï¼Œä¹Ÿæ˜¯æœ€ä¸»æµçš„ç¼–ç¨‹æ–¹å¼ã€‚ç¼ºç‚¹åœ¨äºæ‰§è¡Œæ€§èƒ½ï¼Œä»»ä½•ä¸€ä¸ªç•¥æ…¢çš„ä»»åŠ¡éƒ½ä¼šå¯¼è‡´åç»­æ‰§è¡Œä»£ç è¢«é˜»å¡ã€‚&lt;/p&gt;
&lt;p&gt;Node åœ¨ä¸¤è€…ä¹‹é—´ç»™å‡ºäº†å®ƒçš„æ–¹æ¡ˆï¼šåˆ©ç”¨å•çº¿ç¨‹ï¼Œè¿œç¦»å¤šçº¿ç¨‹æ­»é”ï¼ŒçŠ¶æ€åŒæ­¥é—®é¢˜ï¼›åˆ©ç”¨å¼‚æ­¥ I/Oï¼Œè®©å•çº¿ç¨‹è¿œç¦»é˜»å¡ï¼Œæ›´å¥½åœ°åˆ©ç”¨ CPUã€‚&lt;/p&gt;
&lt;p&gt;å¼‚æ­¥ I/O å°±æ˜¯ I/O çš„è°ƒç”¨ä¸å†é˜»å¡åç»­è®¡ç®—ï¼Œå°†åŸæœ‰ç­‰å¾… I/O å®Œæˆè¿™æ®µæ—¶é—´åˆ†é…ç»™å…¶å®ƒéœ€è¦çš„ä¸šåŠ¡å»æ‰§è¡Œã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Node" scheme="https://lz5z.com/categories/Node/"/>
    
    
      <category term="JavaScript" scheme="https://lz5z.com/tags/JavaScript/"/>
    
      <category term="å¼‚æ­¥" scheme="https://lz5z.com/tags/%E5%BC%82%E6%AD%A5/"/>
    
      <category term="I/O" scheme="https://lz5z.com/tags/I-O/"/>
    
  </entry>
  
  <entry>
    <title>ã€Šæ·±å…¥æµ…å‡ºNode.jsã€‹-è¯»ä¹¦ç¬”è®°</title>
    <link href="https://lz5z.com/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BANode-js-%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
    <id>https://lz5z.com/æ·±å…¥æµ…å‡ºNode-js-è¯»ä¹¦ç¬”è®°/</id>
    <published>2018-05-23T22:51:15.000Z</published>
    <updated>2020-04-21T10:23:54.831Z</updated>
    
    <content type="html"><![CDATA[<h2>ç®€ä»‹</h2><p>ä¸çŸ¥ä¸è§‰ Node å·²ç»æ›´æ–°åˆ°ç¬¬åä¸ªç‰ˆæœ¬äº†ï¼Œæœ¬äººä½¿ç”¨ Node ä¹Ÿæœ‰ä¸¤å¹´å¤šæ—¶é—´ï¼Œä¹‹å‰å­¦ä¹ çš„ä¸œè¥¿ä¸€ç›´é›¶é›¶æ•£æ•£ï¼Œæ²¡æœ‰å½¢æˆç³»ç»Ÿçš„çŸ¥è¯†ä½“ç³»ï¼Œäºæ˜¯æœ€è¿‘åˆæŠ½æ—¶é—´å›é¡¾è¿™æœ¬ç»å…¸çš„ <a href="https://book.douban.com/subject/25768396/" target="_blank" rel="noopener">ã€Šæ·±å…¥æµ…å‡ºNode.jsã€‹</a>ï¼Œé˜…è¯»çš„è¿‡ç¨‹ä¸­ï¼Œéš¾å…æœ‰äº›ä¸œè¥¿ä¸æ˜“ç†è§£æˆ–è€…å®¹æ˜“å¿˜è®°ï¼Œå› æ­¤é€‰æ‹©åšå®¢çš„å½¢å¼è®°å½•ã€‚</p><p>ä½œè€…ä¹¦å†™è¿™æœ¬ä¹¦çš„æ—¶å€™ï¼ŒNode çš„ç¨³å®šç‰ˆæœ¬ä¸º v0.10.13ï¼Œå½“å‰æœ€é«˜ç‰ˆæœ¬ä¸º v10.1.0ï¼Œä¸è¿‡æ•´ä¸ª Node çš„æ ¸å¿ƒä½“ç³»åœ¨å½“æ—¶å·²ç»å½¢æˆï¼Œå› æ­¤å¯¹æ›´é«˜ç‰ˆæœ¬çš„ç†è§£é—®é¢˜ä¸å¤§ã€‚</p><h2>ç¬¬ä¸€ç«  Node ç®€ä»‹</h2><p>Node è¯ç”Ÿäº 2009 å¹´ 3 æœˆï¼Œä½œè€…ä¸º Ryan Dahlã€‚ä½œè€…é€‰æ‹© JavaScript ä½œä¸º Node çš„å®ç°è¯­è¨€ä¸»è¦å› ä¸ºï¼šJavaScript é«˜æ€§èƒ½ï¼ˆV8ï¼‰ï¼Œç¬¦åˆäº‹ä»¶é©±åŠ¨ï¼Œæ²¡æœ‰åç«¯å†å²åŒ…è¢±ã€‚</p><p>é™¤äº† HTMLã€WebKit å’Œæ˜¾å¡è¿™äº›ä¸ UI ç›¸å…³æŠ€æœ¯æ²¡æœ‰æ”¯æŒå¤–ï¼Œæ•´ä¸ª Node çš„ç»“æ„ä¸ Chrome éå¸¸ç›¸ä¼¼ï¼Œå®ƒä»¬éƒ½æ˜¯åŸºäºäº‹ä»¶é©±åŠ¨çš„å¼‚æ­¥æ¶æ„ï¼Œæµè§ˆå™¨é€šè¿‡äº‹ä»¶é©±åŠ¨æ¥æœåŠ¡ç•Œé¢ä¸Šçš„äº¤äº’ï¼ŒNode é€šè¿‡äº‹ä»¶é©±åŠ¨æ¥æœåŠ¡ I/Oã€‚</p><a id="more"></a><h3>Node çš„ç‰¹ç‚¹</h3><p>(1) å¼‚æ­¥ I/Oã€‚åœ¨ Node ä¸­ï¼Œç»å¤§å¤šæ•°çš„æ“ä½œéƒ½æ˜¯ä»¥å¼‚æ­¥çš„æ–¹å¼è¿›è¡Œè°ƒç”¨ï¼Œä»æ–‡ä»¶æ“ä½œåˆ°ç½‘ç»œè¯·æ±‚éƒ½æ˜¯å¦‚æ­¤ã€‚<br>(2) äº‹ä»¶ä¸å›è°ƒå‡½æ•°ã€‚Node å°†å‰ç«¯æµè§ˆå™¨ä¸­åº”ç”¨å¹¿æ³›çš„äº‹ä»¶æœºåˆ¶å¼•å…¥åç«¯ï¼Œé…åˆå¼‚æ­¥ I/Oã€‚ä¼˜ç‚¹æ˜¯äº‹ä»¶ç¼–ç¨‹è½»é‡ï¼Œä½è€¦åˆï¼Œåªç”¨å…³æ³¨äº‹åŠ¡ç‚¹ç­‰ï¼Œç¼ºç‚¹æ˜¯å¤šä¸ªäº‹ä»¶ä¹‹é—´çš„åä½œæ˜¯ä¸€ä¸ªé—®é¢˜ã€‚<br>(3) å•çº¿ç¨‹ã€‚Node ä¿æŒäº† JS å•çº¿ç¨‹çš„ç‰¹ç‚¹ï¼Œåœ¨ Node ä¸­ï¼ŒJS ä¸å…¶ä½™çº¿ç¨‹æ— æ³•å…±äº«çŠ¶æ€ã€‚å•çº¿ç¨‹å¥½å¤„äº†ä¸ç”¨å¤„ç†å¤šçº¿ç¨‹ä¹‹é—´çš„çŠ¶æ€åŒæ­¥ä¸é€šä¿¡ï¼Œæ²¡æœ‰æ­»é”çš„å­˜åœ¨ï¼Œä¹Ÿæ²¡æœ‰çº¿ç¨‹åˆ‡æ¢å¸¦æ¥çš„æ€§èƒ½å¼€é”€ã€‚ç¼ºç‚¹æ˜¯æ— æ³•åˆ©ç”¨å¤šæ ¸ CPUï¼›é”™è¯¯ä¼šå¼•èµ·æ•´ä¸ªåº”ç”¨é€€å‡ºï¼Œåº”ç”¨å¥å£®æ€§å€¼å¾—è€ƒéªŒï¼›å¯¹å¤§è§„æ¨¡é«˜ CPU è®¡ç®—ä¸å‹å¥½ã€‚</p><p>åœ¨æµè§ˆå™¨ä¸­ï¼ŒHTML5 åˆ¶å®šäº† Web Worker æ ‡å‡†æ¥è§£å†³ JS å¤§è§„æ¨¡è®¡ç®—å¯¼è‡´çš„é˜»å¡ UI æ¸²æŸ“çš„é—®é¢˜ã€‚è€Œ Node ä¸­ï¼Œä½¿ç”¨ child_process åˆ›å»ºå­è¿›ç¨‹æ¥åº”å¯¹å•çº¿ç¨‹å¸¦æ¥çš„é—®é¢˜ã€‚</p><p>(4) è·¨å¹³å°ã€‚</p><h3>Node åº”ç”¨åœºæ™¯</h3><p>(1) I/O å¯†é›†å‹ã€‚I/O å¯†é›†çš„ä¼˜åŠ¿Ëè¦åœ¨äº Node åˆ©ç”¨äº‹ä»¶å¾ªç¯çš„èƒ½åŠ›ï¼Œè€Œä¸æ˜¯å¯åŠ¨æ¯ä¸€ä¸ªçº¿ç¨‹ä¸ºæ¯ä¸€ä¸ªè¯·æ±‚æœåŠ¡ï¼Œèµ„æºå ç”¨æå°‘ã€‚<br>(2) Node æ˜¯å¦é€‚ç”¨äº CPU å¯†é›†å‹åº”ç”¨ï¼Ÿé¦–å…ˆ Node çš„è®¡ç®—æ€§èƒ½å¹¶ä¸å·®ï¼Œä½†æ˜¯ç”±äº JavaScript å•çº¿ç¨‹çš„åŸå› ï¼Œå¦‚æœæœ‰é•¿æ—¶é—´è¿ç®—ï¼Œå°†å¯¼è‡´ CPU ä¸èƒ½é‡Šæ”¾ï¼Œä½¿åç»­ I/O æ— æ³•å‘èµ·ã€‚<br>(3) ä¸é—ç•™ç³»ç»Ÿå’Œå¹³å…±å¤„ã€‚æ¯”å¦‚å’Œ Java é…åˆï¼ŒNode å®Œæˆ Web ç«¯çš„å¼€å‘ï¼ŒJava æä¾›ç¨³å®šçš„æ¥å£ã€‚<br>(4) åˆ†å¸ƒå¼åº”ç”¨ã€‚</p><h2>ç¬¬äºŒç«  æ¨¡å—æœºåˆ¶</h2><p>Node çš„æ¨¡å—åŒ–é‡‡ç”¨ CommonJS è§„èŒƒï¼Œå…³äº JavaScript æ¨¡å—åŒ–çš„å„ç§è§„èŒƒï¼Œå¯ä»¥å‚è€ƒ <a href="https://lz5z.com/JavaScript%E6%A8%A1%E5%9D%97%E5%8C%96-CommonJS-AMD-CMD-ES6/">å‰ç«¯æ¨¡å—åŒ–-CommonJS,AMD,CMD,ES6</a>ã€‚</p><p>CommonJS è§„èŒƒæ¶µç›–äº†æ¨¡å—ï¼ŒäºŒè¿›åˆ¶ï¼ŒBufferï¼Œå­—ç¬¦é›†ç¼–ç ï¼ŒI/O æµï¼Œè¿›ç¨‹ç¯å¢ƒï¼Œæ–‡ä»¶ç³»ç»Ÿï¼Œsocketï¼Œå•å…ƒæµ‹è¯•ï¼ŒWebæœåŠ¡å™¨æ¥å£ï¼ŒåŒ…ç®¡ç†ç­‰ã€‚</p><h3>CommonJS æ¨¡å—è§„èŒƒ</h3><p>(1) æ¨¡å—å¼•ç”¨</p><p>é€šè¿‡ require() æ–¹æ³•å¼•å…¥ä¸€ä¸ªæ¨¡å—çš„ API åˆ°å½“å‰ä¸Šä¸‹æ–‡ä¸­ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> math = <span class="built_in">require</span>(<span class="string">'math'</span>)</span><br></pre></td></tr></table></figure><p>(2) æ¨¡å—å®šä¹‰</p><p>åœ¨æ¨¡å—ä¸­ï¼Œä¸Šä¸‹æ–‡æä¾› exports å¯¹è±¡ç”¨äºå¯¼å‡ºå½“å‰æ¨¡å—çš„å˜é‡æˆ–è€…æ–¹æ³•ï¼Œå¹¶ä¸”å®ƒæ˜¯å”¯ä¸€å¯¼å‡ºçš„å‡ºå£ã€‚åœ¨æ¨¡å—ä¸­ï¼Œè¿˜å­˜åœ¨ä¸€ä¸ª module å¯¹è±¡ï¼Œä»£è¡¨æ¨¡å—è‡ªèº«ï¼Œè€Œ exports æ˜¯ module çš„å±æ€§ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">exports.add = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">eval</span>(<span class="built_in">Array</span>.prototype.join.call(<span class="built_in">arguments</span>, <span class="string">'+'</span>))  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(3) æ¨¡å—æ ‡è¯†</p><p>æ¨¡å—æ ‡è¯†å°±æ˜¯ä¼ é€’ç»™ require() çš„å‚æ•°ï¼Œå®ƒå¿…é¡»æ˜¯ç¬¦åˆå°é©¼å³°å‘½åçš„å­—ç¬¦ä¸²ï¼Œæˆ–è€…ä»¥ <code>.</code> å’Œ <code>..</code> å¼€å¤´çš„ç›¸å¯¹è·¯å¾„ï¼Œæˆ–è€…ç»å¯¹è·¯å¾„ã€‚</p><p>CommonJS æ„å»ºçš„è¿™å¥—æ¨¡å—å¯¼å‡ºå’Œå¼•å…¥æœºåˆ¶ä½¿å¾—ç”¨æˆ·å®Œå…¨ä¸å¿…è€ƒè™‘å˜é‡æ±¡æŸ“ï¼Œå‘½åç©ºé—´ç­‰æ–¹æ¡ˆç›¸å½¢è§ç»Œã€‚</p><h3>Node æ¨¡å—å®ç°</h3><p>Node å¼•å…¥æ¨¡å—ï¼Œéœ€è¦ç»å†ä¸‰ä¸ªæ­¥éª¤ï¼šè·¯å¾„åˆ†æï¼Œæ–‡ä»¶å®šä½ï¼Œç¼–è¯‘æ‰§è¡Œã€‚</p><p>Node ä¸­çš„æ¨¡å—åˆ†ä¸ºæ ¸å¿ƒæ¨¡å—å’Œæ–‡ä»¶æ¨¡å—ã€‚</p><p>(1) æ ¸å¿ƒæ¨¡å—åœ¨ Node æºç ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œç¼–è¯‘æˆä¸ºäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œåœ¨ Node å¯åŠ¨é˜¶æ®µéƒ¨åˆ†æ ¸å¿ƒæ¨¡å—å°±è¢«åŠ è½½è¿›å†…å­˜ï¼Œæ‰€ä»¥çœå»äº†æ–‡ä»¶å®šä½å’Œç¼–è¯‘çš„æ—¶é—´ï¼ŒåŠ è½½é€Ÿåº¦æœ€å¿«ã€‚</p><p>(2) æ–‡ä»¶æ¨¡å—åˆ™æ˜¯åœ¨è¿è¡Œæ—¶åŠ¨æ€åŠ è½½ã€‚</p><p>(3) è‡ªå®šä¹‰æ¨¡å—æ˜¯æŒ‡éæ ¸å¿ƒæ¨¡å—ï¼Œä¹Ÿä¸æ˜¯è·¯å¾„å½¢å¼çš„æ–‡ä»¶æ¨¡å—ã€‚ä»¥æ–‡ä»¶æˆ–è€…åŒ…çš„å½¢å¼å­˜åœ¨ï¼Œè¿™ç±»æ¨¡å—çš„æŸ¥æ‰¾æ˜¯æœ€è´¹æ—¶çš„ã€‚</p><p>æ¨¡å—è·¯å¾„ï¼šNode åœ¨å®šä½æ–‡ä»¶æ¨¡å—çš„æ—¶å€™é‡‡ç”¨çš„ä¸€ç§æŸ¥æ‰¾ç­–ç•¥ã€‚å…·ä½“è¡¨ç°ä¸ºä¸€ä¸ªè·¯å¾„ç»„æˆçš„æ•°ç»„ã€‚æ¯”å¦‚æˆ‘åœ¨è‡ªå·±çš„ç”µè„‘ <code>/Users/lizhen/WorkSpaces/test</code> ç›®å½•ä¸‹é¢åˆ›å»ºæ–‡ä»¶ index.jsï¼š</p><p>å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">module</span>.paths)</span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[ '/Users/lizhen/WorkSpaces/test/node_modules',</span><br><span class="line">  '/Users/lizhen/WorkSpaces/node_modules',</span><br><span class="line">  '/Users/lizhen/node_modules',</span><br><span class="line">  '/Users/node_modules',</span><br><span class="line">  '/node_modules' ]</span><br></pre></td></tr></table></figure><p>å…¶è·¯å¾„å¯»å€è§„åˆ™å¦‚ä¸‹ï¼šä»å½“å‰ç›®å½•çš„ node_modules ä¸­å¯»æ‰¾ -&gt; çˆ¶ç›®å½•çš„ node_modules ä¸­å¯»æ‰¾ -&gt; é€’å½’ä¸€ç›´åˆ°æ ¹ç›®å½•çš„ node_modulesã€‚</p><p>å®ƒçš„ç”Ÿæˆæ–¹å¼ä¸ JavaScript åŸå‹é“¾æˆ–è€…ä½œç”¨åŸŸé“¾çš„æŸ¥æ‰¾æ–¹å¼ååˆ†ç±»ä¼¼ã€‚Node ä¼šé€ä¸ªå°è¯•æ¨¡å—è·¯å¾„ï¼Œç›´åˆ°æ‰¾åˆ°æ¨¡å—æˆ–è€…æŸ¥æ‰¾åˆ°æ ¹ç›®å½•ä½ç½®ã€‚å¯ä»¥çœ‹å‡ºï¼Œå½“æ–‡ä»¶è·¯å¾„æ¯”è¾ƒæ·±çš„æ—¶å€™ï¼Œæ¨¡å—æŸ¥æ‰¾ä¼šæ¯”è¾ƒè€—æ—¶ã€‚</p><p>Node å¯¹å¼•å…¥è¿‡çš„æ¨¡å—éƒ½ä¼šè¿›è¡Œç¼“å­˜ï¼Œæ— è®ºæ˜¯æ ¸å¿ƒæ¨¡å—è¿˜æ˜¯æ–‡ä»¶æ¨¡å—ï¼Œrequire() æ–¹æ³•éƒ½é‡‡ç”¨ç¼“å­˜ä¼˜å…ˆçš„æ–¹å¼è¿›è¡ŒåŠ è½½ï¼Œå¹¶ä¸”æ ¸å¿ƒæ¨¡å—çš„ä¼˜å…ˆçº§é«˜äºæ–‡ä»¶æ¨¡å—ã€‚</p><h4>æ–‡ä»¶å®šä½</h4><p>require() åœ¨åˆ†ææ ‡è¯†ç¬¦çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæ ‡è¯†ç¬¦ä¸åŒ…æ‹¬æ‰©å±•åï¼ŒNode ä¼šæŒ‰ç…§ <code>.js</code>, <code>.json</code>, <code>.node</code> çš„æ¬¡åºè¡¥è¶³æ‰©å±•åï¼Œä¾æ¬¡å°è¯•ã€‚</p><p>åœ¨å°è¯•çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦è°ƒç”¨ fs æ¨¡å—åŒæ­¥é˜»å¡å¼åœ°åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œæ‰€ä»¥ä¼šå¼•èµ·æ€§èƒ½é—®é¢˜ã€‚è§£å†³çš„åŠæ³•æ˜¯ï¼š1. <code>.node</code> å’Œ <code>.json</code> æ–‡ä»¶æ ‡è¯†ç¬¦ä¸­å¸¦ä¸Šæ‰©å±•åã€‚2. åŒæ­¥é…åˆç¼“å­˜ï¼Œå¯ä»¥å¤§å¹…ç¼“è§£ Node å•çº¿ç¨‹ä¸­é˜»å¡è°ƒç”¨çš„ç¼ºé™·ã€‚</p><h3>æ¨¡å—ç¼–è¯‘</h3><p>åœ¨ Node ä¸­ï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒçš„å®šä¹‰å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Module</span> (<span class="params">id, parent</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.id = id</span><br><span class="line">  <span class="keyword">this</span>.exports = &#123;&#125;</span><br><span class="line">  <span class="keyword">this</span>.parent = parent</span><br><span class="line">  <span class="keyword">if</span> (parent &amp;&amp; parent.children) &#123;</span><br><span class="line">    parent.children.push(<span class="keyword">this</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">this</span>.filename = <span class="literal">null</span></span><br><span class="line">  <span class="keyword">this</span>.loaded = <span class="literal">false</span></span><br><span class="line">  <span class="keyword">this</span>.children = []</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘å’Œæ‰§è¡Œæ˜¯å¼•å…¥æ–‡ä»¶æ¨¡å—çš„æœ€åä¸€ä¸ªé˜¶æ®µã€‚å®šä½åˆ°æ–‡ä»¶åï¼ŒNode ä¼šæ–°å»ºä¸€ä¸ªæ¨¡å—å¯¹è±¡ï¼Œç„¶åæ ¹æ®è·¯å¾„è½½äººå¹¶ç¼–è¯‘ã€‚ä¸åŒæ–‡ä»¶è½½å…¥æ–¹å¼ä¸åŒï¼š</p><ol><li><code>.js</code> æ–‡ä»¶ï¼Œé€šè¿‡ fs æ¨¡å—åŒæ­¥è¯»å–æ–‡ä»¶åç¼–è¯‘æ‰§è¡Œã€‚</li><li><code>.node</code> æ–‡ä»¶ï¼Œç”± C/C++ ç¼–å†™ï¼Œé€šè¿‡ dlopen() åŠ è½½æœ€åç¼–è¯‘ç”Ÿæˆçš„æ–‡ä»¶ã€‚</li><li><code>.json</code> æ–‡ä»¶ï¼Œé€šè¿‡ fs æ¨¡å—åŒæ­¥è¯»å–åï¼Œç”¨ JSON.parse() è§£æã€‚</li><li>å…¶ä½™æ–‡ä»¶éƒ½è¢«å½“åš <code>.js</code> æ–‡ä»¶è½½å…¥ã€‚</li></ol><p>æ¯ä¸ªç¼–è¯‘æˆåŠŸçš„æ¨¡å—éƒ½ä¼šå°†å…¶æ–‡ä»¶è·¯å¾„ä½œä¸ºç´¢å¼•ç¼“å­˜åœ¨ <code>Module._cache</code> å¯¹è±¡ä¸Šï¼Œä»¥æé«˜äºŒæ¬¡å¼•å…¥çš„æ€§èƒ½ã€‚</p><p>æ ¹æ®ä¸åŒçš„æ–‡ä»¶æ‰©å±•åï¼ŒNode ä¼šè°ƒç”¨ä¸åŒçš„è¯»å–æ–¹å¼ï¼Œå¦‚ <code>.json</code> æ–‡ä»¶ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Module._extensions[<span class="string">'.json'</span>] = <span class="function"><span class="keyword">function</span> (<span class="params">module, filename</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> content = NativeModule.require(<span class="string">'fs'</span>).readFileSync(filename, <span class="string">'utf8'</span>)</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="built_in">module</span>.exports = <span class="built_in">JSON</span>.parse(stripBOM(content))</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      e.message = filename + <span class="string">':'</span> e.message</span><br><span class="line">      <span class="keyword">throw</span> e</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œ<code>Module._extensions</code> ä¼šèµ‹å€¼ç»™ require çš„ extensions å±æ€§ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">require</span>.extensions) <span class="comment">// &#123; '.js': [Function], '.json': [Function], '.node': [Function] &#125;</span></span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥é€šè¿‡æ‰©å±• <code>require.extensions['.ext']</code> çš„æ–¹å¼å¯¹è‡ªå®šä¹‰æ‰©å±•åè¿›è¡Œç‰¹æ®Šçš„åŠ è½½ï¼Œä½†æ˜¯ Node å®˜æ–¹å¹¶ä¸é¼“åŠ±è¿™ç§è¡Œä¸ºã€‚</p><h3>JavaScript æ¨¡å—ç¼–è¯‘</h3><p>åœ¨ç¼–è¯‘ JavaScript çš„è¿‡ç¨‹ä¸­ï¼ŒNode å¯¹è·å–çš„ JavaScript æ–‡ä»¶è¿›è¡ŒåŒ…è£…ï¼š<a href="http://nodejs.cn/api/modules.html#modules_the_module_wrapper" target="_blank" rel="noopener">æ¨¡å—åŒ…è£…å™¨</a></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">exports, require, module, __filename, __dirname</span>) </span>&#123;</span><br><span class="line"><span class="comment">// æ¨¡å—çš„ä»£ç å®é™…ä¸Šåœ¨è¿™é‡Œ</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¿™æ ·æ¯ä¸ªæ¨¡å—æ–‡ä»¶ä¹‹é—´éƒ½è¿›è¡Œäº†ä½œç”¨åŸŸéš”ç¦»ï¼ŒåŒ…è£…ä¹‹åçš„ä»£ç ä¼šé€šè¿‡ vm åŸç”Ÿæ¨¡å—çš„ runInThisContext() æ–¹æ³•æ‰§è¡Œï¼ˆç±»ä¼¼ evalï¼Œåªæ˜¯æœ‰æ˜ç¡®çš„ä¸Šä¸‹æ–‡ï¼Œä¸æ±¡æŸ“å…¨å±€ï¼‰ã€‚</p><p><strong>exports vs module.exports</strong></p><p>exports å¯¹è±¡æœ¬è´¨ä¸Šæ¥è¯´åªæ˜¯ Node æ¨¡å—åŒ…è£…å™¨çš„ä¸€ä¸ªå½¢å‚ï¼Œç›´æ¥å¯¹å…¶è¿›è¡Œèµ‹å€¼ï¼Œåªä¼šæ”¹å˜å½¢å‚çš„å¼•ç”¨ï¼Œä½†å¹¶ä¸èƒ½æ”¹å˜ä½œç”¨åŸŸå¤–çš„å€¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> change = <span class="function"><span class="keyword">function</span> (<span class="params">a</span>) </span>&#123;</span><br><span class="line">  a = <span class="number">100</span></span><br><span class="line">  <span class="built_in">console</span>.log(a) <span class="comment">// 100  </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> a = <span class="number">10</span></span><br><span class="line">change(a)</span><br><span class="line"><span class="built_in">console</span>.log(a) <span class="comment">// 10</span></span><br></pre></td></tr></table></figure><p>æ‰€ä»¥å¦‚æœè¦å®ç° require å¼•å…¥ä¸€ä¸ªç±»çš„æ•ˆæœï¼Œè¯·èµ‹å€¼ç»™ module.exports å¯¹è±¡ã€‚</p><p>æ›´è¯¦ç»†çš„è§£é‡Šï¼Œå¯ä»¥æŸ¥çœ‹ <a href="http://nodejs.cn/api/modules.html#modules_exports_shortcut" target="_blank" rel="noopener">exports å¿«æ·æ–¹å¼</a>ã€‚</p><p>æˆ‘ä¸ªäººçš„ç†è§£æ˜¯ï¼šmodule å¯¹è±¡åœ¨ Node æ‰§è¡Œæ—¶åˆ›å»ºï¼Œå¹¶ä¸”è‡ªå¸¦ exports å±æ€§ï¼Œè€Œ exports å¯¹è±¡æ˜¯å¯¹ module.exports çš„å€¼å¼•ç”¨ï¼Œå½“ module.exports æ”¹å˜çš„æ—¶å€™ï¼Œ exports ä¸ä¼šè¢«æ”¹å˜ï¼Œè€Œæ¨¡å—å¯¼å‡ºçš„æ—¶å€™ï¼ŒçœŸæ­£å¯¼å‡ºçš„æ˜¯ module.exportsï¼Œè€Œä¸æ˜¯ exportsã€‚</p><p>çœ‹è¿™ä¸ªä¾‹å­ï¼š</p><p>math.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">exports.add = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">eval</span>(<span class="built_in">Array</span>.prototype.join.call(<span class="built_in">arguments</span>, <span class="string">'+'</span>))</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  add: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Array</span>.prototype.join.call(<span class="built_in">arguments</span>, <span class="string">'+'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>test.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> math = <span class="built_in">require</span>(<span class="string">'./math'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(math.add(<span class="number">2</span>, <span class="number">34</span>)) <span class="comment">//  2+34</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œexports ä¸Šèµ‹çš„å€¼ï¼Œåœ¨ module.exports è¢«é‡å†™åæ— æ•ˆã€‚</p><h3>æ ¸å¿ƒæ¨¡å—</h3><p>Node çš„æ ¸å¿ƒæ¨¡å—åˆ†ä¸º C/C++ ç¼–å†™å’Œ JavaScript ç¼–å†™çš„ä¸¤éƒ¨åˆ†ã€‚å…¶ä¸­ C/C++ æ–‡ä»¶åœ¨ <a href="https://github.com/nodejs/node/tree/master/src" target="_blank" rel="noopener">src</a> ç›®å½•ä¸‹ï¼ŒJavaScript æ–‡ä»¶åœ¨ <a href="https://github.com/nodejs/node/tree/master/lib" target="_blank" rel="noopener">lib</a> ç›®å½•ä¸‹ã€‚</p><p>(1) JavaScript æ ¸å¿ƒæ¨¡å—ç¼–è¯‘è¿‡ç¨‹</p><p>åœ¨ç¼–è¯‘æ‰€æœ‰çš„ C/C++ æ–‡ä»¶ä¹‹å‰ï¼Œç¼–è¯‘ç¨‹åºéœ€è¦å°†æ‰€æœ‰çš„ JavaScript æ¨¡å—æ–‡ä»¶ç¼–è¯‘ä¸º C/C++ ä»£ç ã€‚</p><ul><li>è½¬ä¸º C/C++ ä»£ç ã€‚Node ä½¿ç”¨ V8 é™„å¸¦çš„ <a href="http://js2c.py" target="_blank" rel="noopener">js2c.py</a> å·¥å…·ï¼Œå°†æ‰€æœ‰å†…ç½®çš„ JS ä»£ç ï¼ˆ<code>src/node.js</code> å’Œ <code>lib/*.js</code>ï¼‰è½¬æ¢ä¸º C++ é‡Œé¢çš„æ•°ç»„ï¼Œç”Ÿæˆ <code>node_natives.h</code> å¤´æ–‡ä»¶ã€‚</li><li>ç¼–è¯‘ JS æ ¸å¿ƒæ¨¡å—ã€‚é¦–å…ˆåœ¨å¼•å…¥ JS çš„æ ¸å¿ƒæ¨¡å—çš„è¿‡ç¨‹ä¸­ï¼Œç»å†äº†æ¨¡å—åŒ…è£…å™¨çš„è¿‡ç¨‹ï¼Œç„¶åå¯¼å‡º exports å¯¹è±¡ã€‚JS æ ¸å¿ƒæ¨¡å—æºæ–‡ä»¶é€šè¿‡ <code>process.binding('natives')</code> å–å‡ºï¼Œç¼–è¯‘æˆåŠŸåæ¨¡å—ç¼“å­˜åœ¨ <code>NativeModule._cache</code>ï¼Œæ–‡ä»¶æ¨¡å—åˆ™ç¼“å­˜åœ¨ <code>Module._cache</code>ã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">NativeModule</span> (<span class="params">id</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.filename = id + <span class="string">'.js'</span></span><br><span class="line">  <span class="keyword">this</span>.id = is</span><br><span class="line">  <span class="keyword">this</span>.exports = &#123;&#125;</span><br><span class="line">  <span class="keyword">this</span>.loaded = <span class="literal">false</span>  </span><br><span class="line">&#125;</span><br><span class="line">NativeModule._source = process.binding(<span class="string">'natives'</span>)</span><br><span class="line">NativeModule._cache = &#123;&#125;</span><br></pre></td></tr></table></figure><p>(2) C/C++ æ ¸å¿ƒæ¨¡å—çš„ç¼–è¯‘è¿‡ç¨‹</p><p>Node çš„é«˜æ€§èƒ½ï¼Œå¾ˆå¤§ç¨‹åº¦æ˜¯å› ä¸ºæ ¸å¿ƒæ¨¡å‹ï¼Œå¤šæ•°æœ‰ C/C++ ç¼–å†™ï¼ŒC++ æ¨¡å—ä¸»å†…å®Œæˆæ ¸å¿ƒï¼ŒJS æ¨¡å—ä¸»å¤–å®ç°å°è£…æ¨¡å—ï¼Œå……åˆ†åˆ©ç”¨äº†è„šæœ¬è¯­è¨€æ˜“ç¼–å†™ï¼ŒC/C++ é«˜æ•ˆæ‰§è¡Œçš„ä¼˜ç‚¹ã€‚Node ä¸­å¸¸è§çš„ bufferã€cryptoã€evalsã€fsã€os ç­‰æ¨¡å—éƒ½æ˜¯ C/C++ ç¼–å†™çš„ã€‚</p><p>(3) æ ¸å¿ƒæ¨¡å—å¼•å…¥æµç¨‹</p><img src="/assets/img/node_core_module_import.png" alt="node_core_module_import"><p>(4) æ¨¡å—è°ƒç”¨æ ˆ</p><img src="/assets/img/node_module_imports.png" alt="node_module_imports"><p>(5) åŒ…ä¸ NPM</p><p>åœ¨ Node ä¸­ï¼ŒåŒ…å’Œ NPM æ˜¯å°†æ¨¡å—è”ç³»èµ·æ¥çš„ä¸€ç§æœºåˆ¶ã€‚CommonJS è§„èŒƒä¸­åŒ…ç›®å½•åº”è¯¥åŒ…å«å¦‚ä¸‹è¿™äº›æ–‡ä»¶ã€‚</p><ol><li>package.jsonï¼šåŒ…æè¿°æ–‡ä»¶</li><li>binï¼š å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶</li><li>libï¼šå­˜æ”¾ JavaScript æ–‡ä»¶</li><li>docï¼šå­˜æ”¾æ–‡æ¡£ç›®å½•</li><li>testï¼šå•å…ƒæµ‹è¯•ä»£ç </li></ol><p>NPM å…¨å±€å®‰è£…ï¼š</p><p>é€šè¿‡æ‰§è¡Œå‘½ä»¤ <code>npm install express -g</code> å°† express å®‰è£…ä¸ºå…¨å±€å¯ç”¨çš„å¯æ‰§è¡Œå‘½ä»¤ï¼Œä½†å¹¶ä¸æ„å‘³ç€å¯ä»¥ä»ä»»ä½•åœ°æ–¹é€šè¿‡ require() éƒ½å¯ä»¥å¼•å…¥å®ƒã€‚</p><p>å®é™…ä¸Šï¼Œå…¨å±€å®‰è£…çš„åŒ…éƒ½è¢«å®‰è£…åœ¨ä¸€ä¸ªç»Ÿä¸€çš„ç›®å½•ä¸‹ï¼Œè¿™ä¸ªç›®å½•ä¸ºï¼š</p><p><code>path.resolve(process.execPath, '..', '..', 'lib', 'node_modules')</code></p><p>è¿™ä¸ªè·¯å¾„æ˜¯ Node å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ï¼Œæ¯”å¦‚ï¼ŒNode å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ä¸º <code>/usr/local/bin/node</code>ï¼Œé‚£ä¹ˆæ¨¡å—ç›®å½•å°±æ˜¯ <code>/usr/local/lib/node_modules</code>ã€‚</p><p>å…³äºæ›´å¤š JavaScript æ¨¡å—çš„è§„èŒƒå¯ä»¥å‚è€ƒ <a href="https://lz5z.com/JavaScript%E6%A8%A1%E5%9D%97%E5%8C%96-CommonJS-AMD-CMD-ES6/">å‰ç«¯æ¨¡å—åŒ–-CommonJS,AMD,CMD,ES6</a>ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;ç®€ä»‹&lt;/h2&gt;
&lt;p&gt;ä¸çŸ¥ä¸è§‰ Node å·²ç»æ›´æ–°åˆ°ç¬¬åä¸ªç‰ˆæœ¬äº†ï¼Œæœ¬äººä½¿ç”¨ Node ä¹Ÿæœ‰ä¸¤å¹´å¤šæ—¶é—´ï¼Œä¹‹å‰å­¦ä¹ çš„ä¸œè¥¿ä¸€ç›´é›¶é›¶æ•£æ•£ï¼Œæ²¡æœ‰å½¢æˆç³»ç»Ÿçš„çŸ¥è¯†ä½“ç³»ï¼Œäºæ˜¯æœ€è¿‘åˆæŠ½æ—¶é—´å›é¡¾è¿™æœ¬ç»å…¸çš„ &lt;a href=&quot;https://book.douban.com/subject/25768396/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ã€Šæ·±å…¥æµ…å‡ºNode.jsã€‹&lt;/a&gt;ï¼Œé˜…è¯»çš„è¿‡ç¨‹ä¸­ï¼Œéš¾å…æœ‰äº›ä¸œè¥¿ä¸æ˜“ç†è§£æˆ–è€…å®¹æ˜“å¿˜è®°ï¼Œå› æ­¤é€‰æ‹©åšå®¢çš„å½¢å¼è®°å½•ã€‚&lt;/p&gt;
&lt;p&gt;ä½œè€…ä¹¦å†™è¿™æœ¬ä¹¦çš„æ—¶å€™ï¼ŒNode çš„ç¨³å®šç‰ˆæœ¬ä¸º v0.10.13ï¼Œå½“å‰æœ€é«˜ç‰ˆæœ¬ä¸º v10.1.0ï¼Œä¸è¿‡æ•´ä¸ª Node çš„æ ¸å¿ƒä½“ç³»åœ¨å½“æ—¶å·²ç»å½¢æˆï¼Œå› æ­¤å¯¹æ›´é«˜ç‰ˆæœ¬çš„ç†è§£é—®é¢˜ä¸å¤§ã€‚&lt;/p&gt;
&lt;h2&gt;ç¬¬ä¸€ç«  Node ç®€ä»‹&lt;/h2&gt;
&lt;p&gt;Node è¯ç”Ÿäº 2009 å¹´ 3 æœˆï¼Œä½œè€…ä¸º Ryan Dahlã€‚ä½œè€…é€‰æ‹© JavaScript ä½œä¸º Node çš„å®ç°è¯­è¨€ä¸»è¦å› ä¸ºï¼šJavaScript é«˜æ€§èƒ½ï¼ˆV8ï¼‰ï¼Œç¬¦åˆäº‹ä»¶é©±åŠ¨ï¼Œæ²¡æœ‰åç«¯å†å²åŒ…è¢±ã€‚&lt;/p&gt;
&lt;p&gt;é™¤äº† HTMLã€WebKit å’Œæ˜¾å¡è¿™äº›ä¸ UI ç›¸å…³æŠ€æœ¯æ²¡æœ‰æ”¯æŒå¤–ï¼Œæ•´ä¸ª Node çš„ç»“æ„ä¸ Chrome éå¸¸ç›¸ä¼¼ï¼Œå®ƒä»¬éƒ½æ˜¯åŸºäºäº‹ä»¶é©±åŠ¨çš„å¼‚æ­¥æ¶æ„ï¼Œæµè§ˆå™¨é€šè¿‡äº‹ä»¶é©±åŠ¨æ¥æœåŠ¡ç•Œé¢ä¸Šçš„äº¤äº’ï¼ŒNode é€šè¿‡äº‹ä»¶é©±åŠ¨æ¥æœåŠ¡ I/Oã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Node" scheme="https://lz5z.com/categories/Node/"/>
    
    
      <category term="Node" scheme="https://lz5z.com/tags/Node/"/>
    
      <category term="JavaScript" scheme="https://lz5z.com/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>HTTPS åŠ å¯†åŸç†</title>
    <link href="https://lz5z.com/HTTPS%E5%8A%A0%E5%AF%86%E5%8E%9F%E7%90%86/"/>
    <id>https://lz5z.com/HTTPSåŠ å¯†åŸç†/</id>
    <published>2018-05-22T21:05:58.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<p>å‰é¢å‡ å¤©å­¦ä¹  DNS ç¼“å­˜çš„æ—¶å€™ï¼Œäº†è§£åˆ°äº† DNS åŠ«æŒå’Œ HTTP åŠ«æŒï¼Œå…³äº DNS åŠ«æŒå’Œ HTTP åŠ«æŒçš„åŒºåˆ«ï¼ŒçŸ¥ä¹ä¸Šä¸€ä½åŒå­¦ç»™å‡ºäº†æœ‰è¶£çš„æ¯”å–»<a href="https://www.zhihu.com/question/27035513" target="_blank" rel="noopener">DNSåŠ«æŒå’ŒHTTPåŠ«æŒæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</a>:<br>DNS åŠ«æŒï¼šä½ è¾“å…¥çš„ç½‘å€æ˜¯ <code>http://www.google.com</code>ï¼Œå‡ºæ¥çš„æ˜¯ç™¾åº¦çš„é¡µé¢ã€‚<br>HTTP åŠ«æŒï¼šä½ æ‰“å¼€çš„æ˜¯çŸ¥ä¹çš„é¡µé¢ï¼Œå³ä¸‹è§’å¼¹å‡ºå”è€å¸ˆçš„ä¸å­•ä¸è‚²å¹¿å‘Šï¼ˆ2018å¹´æ›´ï¼šå³ä¸‹è§’å¼¹å‡ºï¼šå¶ç³»æ¸£æ¸£è¾‰ï¼‰ã€‚<br>åº”å¯¹ HTTP åŠ«æŒæœ€æœ‰æ•ˆçš„æ–¹æ³•å°±æ˜¯ HTTPSã€‚æœ¬æ–‡å­¦ä¹  HTTPS ç›¸å…³çš„çŸ¥è¯†ã€‚åœ¨å­¦ä¹ ä¹‹å‰é¦–å…ˆæŠ›å‡ºä¸‰ä¸ªé—®é¢˜ï¼š</p><ol><li>HTTPS åŠ å¯†åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</li><li>HTTPS æ˜¯å¦å®‰å…¨ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</li><li>ä¸ºä»€ä¹ˆæŠ“åŒ…å·¥å…·æ¯”å¦‚ Fiddler/Charles èƒ½æŠ“å– HTTPS åè®®çš„åŒ…ï¼Ÿ</li></ol><a id="more"></a><h2>HTTPS ç®€ä»‹</h2><p><a href="https://zh.wikipedia.org/wiki/%E8%B6%85%E6%96%87%E6%9C%AC%E4%BC%A0%E8%BE%93%E5%AE%89%E5%85%A8%E5%8D%8F%E8%AE%AE" target="_blank" rel="noopener">è¶…æ–‡æœ¬ä¼ è¾“å®‰å…¨åè®®</a>ï¼ˆè‹±æ–‡ï¼šHypertext Transfer Protocol Secure ç¼©å†™ä¸ºï¼šHTTPSï¼Œå¸¸ç§°ä¸º HTTP over TLS/SSL æˆ– HTTP Secureï¼‰æ˜¯ä¸€ç§é€šè¿‡è®¡ç®—æœºç½‘ç»œè¿›è¡Œå®‰å…¨é€šä¿¡çš„ä¼ è¾“åè®®ã€‚HTTPS ç»ç”± HTTP è¿›è¡Œé€šä¿¡ï¼Œä½†åˆ©ç”¨ SSL/TLS æ¥åŠ å¯†æ•°æ®åŒ…ã€‚å…³äº TLS/SSL çš„è¯¦ç»†å†…å®¹ï¼Œå¯ä»¥æŸ¥çœ‹<a href="https://zh.wikipedia.org/wiki/%E5%82%B3%E8%BC%B8%E5%B1%A4%E5%AE%89%E5%85%A8%E6%80%A7%E5%8D%94%E5%AE%9A" target="_blank" rel="noopener">ä¼ è¾“å±‚å®‰å…¨æ€§åè®®</a>ã€‚</p><h3>HTTPS åŠ å¯†åŸç†</h3><p>ä¼ ç»Ÿçš„ HTTP åè®®åŸºäº TCP/IP åè®®æ¥ä¼ é€’æ•°æ®ï¼Œå®¢æˆ·ç«¯é€šè¿‡ä¸‰æ¬¡æ¡æ‰‹ä¸æœåŠ¡ç«¯å»ºç«‹è¿æ¥ï¼ŒHTTPS åœ¨ä¼ è¾“æ•°æ®ä¹‹å‰éœ€è¦å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ä¹‹é—´è¿›è¡Œä¸€æ¬¡æ¡æ‰‹ï¼Œåœ¨æ¡æ‰‹çš„è¿‡ç¨‹ä¸­ç¡®ç«‹åŒæ–¹åŠ å¯†ä¼ è¾“æ•°æ®çš„å¯†ç ä¿¡æ¯ã€‚TLS/SSL ä½¿ç”¨éå¯¹ç§°åŠ å¯†ã€å¯¹ç§°åŠ å¯†ä»¥åŠ HASH ç®—æ³•ã€‚æ¡æ‰‹è¿‡ç¨‹å¯ä»¥ç®€å•æè¿°å¦‚ä¸‹ï¼š</p><p>(1) æµè§ˆå™¨å‘æœåŠ¡å™¨å‘é€è‡ªå·±æ‰€æ”¯æŒçš„åŠ å¯†è§„åˆ™ã€‚<br>(2) æœåŠ¡å™¨ä»ä¸­é€‰å–ä¸€ç»„åŠ å¯†ç®—æ³•ä¸ HASH ç®—æ³•ï¼Œå°†è‡ªå·±çš„èº«ä»½ä¿¡æ¯ä»¥è¯ä¹¦ï¼ˆCAï¼‰çš„å½¢å¼è¿”å›ç»™æµè§ˆå™¨ã€‚è¯ä¹¦é‡Œé¢åŒ…å«ç½‘ç«™åœ°å€ï¼ŒåŠ å¯†å…¬é’¥ S_PuKey ä»¥åŠè¯ä¹¦çš„é¢å‘æœºæ„ç­‰ä¿¡æ¯ã€‚<br>(3) å®¢æˆ·ç«¯ç¡®è®¤å…¶é¢å‘çš„è¯ä¹¦çš„æœ‰æ•ˆæ€§ï¼Œå¦‚æœè¯ä¹¦æœ‰æ•ˆæµè§ˆå™¨ä¼šç”Ÿæˆä¸€ä¸²éšæœºæ•°çš„å¯†ç  C_Keyï¼Œå¹¶ç”¨è¯ä¹¦ä¸­æä¾›çš„å…¬é’¥ S_PuKey åŠ å¯†ã€‚ç„¶åå®¢æˆ·ç«¯ä½¿ç”¨çº¦å®šå¥½çš„ HASH è®¡ç®—æ¡æ‰‹æ¶ˆæ¯ï¼Œå¹¶ä½¿ç”¨ç”Ÿæˆçš„éšæœºæ•° C_Key å¯¹æ¶ˆæ¯è¿›è¡ŒåŠ å¯†ï¼Œæœ€åå°†ä¹‹å‰ç”Ÿæˆçš„æ‰€æœ‰ä¿¡æ¯å‘é€ç»™æœåŠ¡å™¨ã€‚<br>(4) æœåŠ¡å™¨ä½¿ç”¨è‡ªå·±çš„ç§é’¥å°†ä¿¡æ¯è§£å¯†å–å‡ºå¯†ç  C_Keyï¼Œä½¿ç”¨ C_Key è§£å¯†æµè§ˆå™¨å‘æ¥çš„æ¡æ‰‹æ¶ˆæ¯ï¼Œå¹¶éªŒè¯ HASH æ˜¯å¦ä¸æµè§ˆå™¨å‘æ¥çš„ä¸€è‡´ã€‚ç„¶åæœåŠ¡å™¨ä½¿ç”¨å¯†ç åŠ å¯†ä¸€æ®µæ¡æ‰‹æ¶ˆæ¯ï¼Œå‘é€ç»™æµè§ˆå™¨ã€‚<br>(5) æµè§ˆå™¨è§£å¯†å¹¶è®¡ç®—æ¡æ‰‹æ¶ˆæ¯çš„ HASHï¼Œå¦‚æœä¸æœåŠ¡ç«¯å‘æ¥çš„ HASH ä¸€è‡´ï¼Œæ­¤æ—¶æ¡æ‰‹è¿‡ç¨‹ç»“æŸï¼Œä¹‹åæ‰€æœ‰çš„é€šä¿¡æ•°æ®å°†ç”±ä¹‹å‰æµè§ˆå™¨ç”Ÿæˆçš„éšæœºå¯†ç  C_Key å¹¶åˆ©ç”¨å¯¹ç§°åŠ å¯†ç®—æ³•è¿›è¡ŒåŠ å¯†ã€‚</p><p>HTTPS ä¸€èˆ¬ä½¿ç”¨çš„åŠ å¯†ä¸ HASH ç®—æ³•å¦‚ä¸‹ï¼š</p><ul><li>éå¯¹ç§°åŠ å¯†ç®—æ³•ï¼šRSAï¼ŒDSA/DSSï¼Œç”¨äºåœ¨æ¡æ‰‹è¿‡ç¨‹ä¸­åŠ å¯†ç”Ÿæˆçš„å¯†ç </li><li>å¯¹ç§°åŠ å¯†ç®—æ³•ï¼šAESï¼ŒRC4ï¼Œ3DESï¼Œç”¨äºæ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­è¿›è¡ŒåŠ å¯†</li><li>HASH ç®—æ³•ï¼šMD5ï¼ŒSHA1ï¼ŒSHA256ï¼Œç”¨äºéªŒè¯æ•°æ®çš„å®Œæ•´æ€§</li></ul><p>ç”±äºæµè§ˆå™¨ç”Ÿæˆçš„å¯†ç æ˜¯æ•´ä¸ªæ•°æ®åŠ å¯†çš„å…³é”®ï¼Œå› æ­¤åœ¨ä¼ è¾“çš„æ—¶å€™ä½¿ç”¨äº†éå¯¹ç§°åŠ å¯†ç®—æ³•å¯¹å…¶åŠ å¯†ã€‚éå¯¹ç§°åŠ å¯†ç®—æ³•ä¼šç”Ÿæˆå…¬é’¥å’Œç§é’¥ï¼Œå…¬é’¥åªèƒ½ç”¨äºåŠ å¯†æ•°æ®ï¼Œå› æ­¤å¯ä»¥éšæ„ä¼ è¾“ï¼Œè€Œç½‘ç«™çš„ç§é’¥ç”¨äºå¯¹æ•°æ®è¿›è¡Œè§£å¯†ï¼Œæ‰€ä»¥ç½‘ç«™éƒ½ä¼šéå¸¸å°å¿ƒçš„ä¿ç®¡è‡ªå·±çš„ç§é’¥ï¼Œé˜²æ­¢æ³„æ¼ã€‚</p><p>TLSæ¡æ‰‹è¿‡ç¨‹ä¸­å¦‚æœæœ‰ä»»ä½•é”™è¯¯ï¼Œéƒ½ä¼šä½¿åŠ å¯†è¿æ¥æ–­å¼€ï¼Œä»è€Œé˜»æ­¢äº†éšç§ä¿¡æ¯çš„ä¼ è¾“ã€‚</p><p>SSL è¯ä¹¦éªŒè¯å¤±è´¥æœ‰ä»¥ä¸‹ä¸‰ç‚¹åŸå› :</p><ul><li>SSL è¯ä¹¦ä¸æ˜¯ç”±å—ä¿¡ä»»çš„ CA æœºæ„é¢å‘çš„</li><li>è¯ä¹¦è¿‡æœŸ</li><li>è®¿é—®çš„ç½‘ç«™åŸŸåä¸è¯ä¹¦ç»‘å®šçš„åŸŸåä¸ä¸€è‡´</li></ul><h3>HTTPS å®‰å…¨å—ï¼Ÿ</h3><p>HTTPS æ˜¯å¦å®‰å…¨ï¼Œæ˜¯ä¸€ä¸ªç›¸å¯¹çš„æ¦‚å¿µï¼Œä»æœåŠ¡å™¨èº«ä»½è®¤è¯ï¼Œä¿æŠ¤äº¤æ¢æ•°æ®çš„éšç§æ€§å’Œå®Œæ•´æ€§æ–¹é¢æ¥è¯´ï¼Œå®ƒæ˜¯å®‰å…¨çš„ï¼Œä½†æ˜¯å®ƒä¹Ÿæœ‰è‡ªå·±çš„<a href="https://zh.wikipedia.org/wiki/%E8%B6%85%E6%96%87%E6%9C%AC%E4%BC%A0%E8%BE%93%E5%AE%89%E5%85%A8%E5%8D%8F%E8%AE%AE#%E5%B1%80%E9%99%90" target="_blank" rel="noopener">å±€é™</a>ã€‚</p><p>TLS/SSL åè®®ä¾èµ–æµè§ˆå™¨å’ŒæœåŠ¡å™¨æ‰€æ”¯æŒçš„åŠ å¯†ç®—æ³•ã€‚<br>HTTPS ä¹Ÿä¸èƒ½é˜²æ­¢ç½‘ç«™è¢«çˆ¬è™«æŠ“å–ï¼Œæ”»å‡»è€…å¯ä»¥æ ¹æ®æŸäº›æ‰‹æ®µæ¨æµ‹åŠ å¯†åçš„å¯†æ–‡ï¼Œä»è€Œä½¿é€‰æ‹©å¯†æ–‡æ”»å‡»æˆä¸ºå¯èƒ½ã€‚</p><h3>Charles ä¸ºä»€ä¹ˆèƒ½æŠ“ HTTPS çš„åŒ…ï¼Ÿ</h3><p>Charles æŠ“ HTTPS åŒ…çš„è¿‡ç¨‹å¯ä»¥ç†è§£ä¸ºä¸­é—´äººæ”»å‡»ã€‚</p><p>æµè§ˆå™¨å’ŒæœåŠ¡å™¨æ¯æ¬¡æ–°å»ºä¼šè¯æ—¶éƒ½ä½¿ç”¨éå¯¹ç§°å¯†é’¥äº¤æ¢ç®—æ³•åå•†å‡ºå¯¹ç§°å¯†é’¥ï¼Œä¹Ÿå°±æ˜¯ä¸Šæ–‡æ‰€è¯´çš„ C_Keyï¼Œä½¿ç”¨ C_Key å®Œæˆåº”ç”¨æ•°æ®çš„åŠ è§£å¯†å’ŒéªŒè¯ï¼Œæ•´ä¸ªä¼šè¯è¿‡ç¨‹ä¸­çš„å¯†é’¥åªåœ¨å†…å­˜ä¸­ç”Ÿæˆå’Œä¿å­˜ï¼Œè€Œä¸”æ¯ä¸ªä¼šè¯çš„ C_Key éƒ½ä¸ç›¸åŒï¼Œå¹¶ä¸”æ— æ³•çªƒå–ã€‚</p><p>æ‰€ä»¥æ•´ä¸ªåŠ å¯†è¿‡ç¨‹ä¸­ï¼Œè‡³å…³é‡è¦çš„å°±æ˜¯å®¢æˆ·ç«¯ç”Ÿæˆçš„å¯¹ç§°ç§˜é’¥ C_Keyï¼Œä¸­é—´äººæ”»å‡»æ˜¯å…ˆä¼ªè£…æœåŠ¡å™¨å‘æµè§ˆå™¨å‘é€ä¼ªé€ çš„å…¬é’¥ï¼Œä»è€Œå–å¾—æµè§ˆå™¨çš„ç§é’¥ã€‚è¿™æ ·å°±å®Œæˆçš„æµè§ˆå™¨ç«¯å’ŒæœåŠ¡å™¨ç«¯çš„è§£å¯†ã€‚</p><blockquote><p>ä¸­é—´äººæ”»å‡»ï¼šæ˜¯æŒ‡æ”»å‡»è€…ä¸é€šè®¯çš„ä¸¤ç«¯åˆ†åˆ«å»ºç«‹ç‹¬ç«‹çš„è”ç³»ï¼Œå¹¶äº¤æ¢å…¶æ‰€æ”¶åˆ°çš„æ•°æ®ï¼Œä½¿é€šè®¯çš„ä¸¤ç«¯è®¤ä¸ºä»–ä»¬æ­£åœ¨é€šè¿‡ä¸€ä¸ªç§å¯†çš„è¿æ¥ä¸å¯¹æ–¹ç›´æ¥å¯¹è¯ï¼Œä½†äº‹å®ä¸Šæ•´ä¸ªä¼šè¯éƒ½è¢«æ”»å‡»è€…å®Œå…¨æ§åˆ¶ã€‚</p></blockquote><p>æ•´ä¸ªè¿‡ç¨‹å¯ä»¥æ€»ç»“ä¸ºä»¥ä¸‹ï¼š</p><p>(1) é¦–å…ˆä»£ç†è½¯ä»¶æˆªè·æµè§ˆå™¨å‘é€ç»™æœåŠ¡ç«¯çš„ HTTPS è¯·æ±‚ï¼Œç„¶åä»£ç†è½¯ä»¶å‡è£…è‡ªå·±æ˜¯æµè§ˆå™¨å‘æœåŠ¡å™¨å‘é€è¯·æ±‚è¿›è¡Œæ¡æ‰‹ã€‚<br>(2) ä»£ç†è½¯ä»¶è·å–æœåŠ¡å™¨ CA è¯ä¹¦ï¼ŒéªŒè¯ CA è¯ä¹¦å¹¶ä¸”è§£å¯†åè·å–å…¬é’¥ S_PuKeyã€‚<br>(3) ä»£ç†è½¯ä»¶ä¼ªé€  CA è¯ä¹¦ï¼Œå†’å……æœåŠ¡å™¨ä¼ é€’ç»™å®¢æˆ·ç«¯æµè§ˆå™¨ã€‚æµè§ˆå™¨è§£æ CA è¯ä¹¦ï¼Œä½¿ç”¨ä»£ç†è½¯ä»¶ä¼ªé€ çš„ S_PubKey ç”Ÿæˆ C_Keyã€‚æµè§ˆå™¨æ ¹æ® C_Key åŠ å¯†æ¶ˆæ¯ï¼Œå¹¶ä¸”è®¡ç®— HASHï¼Œä¼ é€’ç»™ä»£ç†è½¯ä»¶ã€‚<br>(4) ä»£ç†è½¯ä»¶æ ¹æ®ç§é’¥è§£æå¯†æ–‡è®¡ç®—å‡ºæµè§ˆå™¨çš„ C_Keyï¼Œç„¶åå†ä½¿ç”¨æœåŠ¡ç«¯çš„å…¬é’¥ S_PuKey è¿›è¡ŒåŠ å¯†åè¿”å›ç»™æœåŠ¡å™¨ã€‚æœåŠ¡å™¨ç”¨è‡ªå·±çš„ç§é’¥è§£å¼€å¯†æ–‡åä¸ä»£ç†è½¯ä»¶å»ºç«‹ä¿¡ä»»ï¼Œæ¡æ‰‹å®Œæˆã€‚<br>(5) ä»£ç†è½¯ä»¶è·å–æœåŠ¡å™¨å‘é€çš„å¯†æ–‡ï¼Œç”¨å¯¹ç§°ç§˜é’¥è§£å¼€ï¼Œè®¡ç®—å‡ºæœåŠ¡å™¨çš„æ˜æ–‡ï¼ˆCharles ä¸ºä»€ä¹ˆèƒ½æŠ“ HTTPS çš„åŒ…ï¼Ÿï¼‰ï¼Œå†æ¬¡åŠ å¯†åè¿”å›ç»™æµè§ˆå™¨ã€‚<br>(6) æ•´ä¸ªé€šä¿¡è¿‡ç¨‹ä¸­ï¼Œä»£ç†è½¯ä»¶ä¸€ç›´æ‹¥æœ‰å¯¹ç§°ç§˜é’¥ï¼Œå› æ­¤æ•´ä¸ª HTTPS çš„è¿‡ç¨‹ä¸­ï¼Œä¿¡æ¯å§‹ç»ˆå¯¹å…¶é€æ˜ã€‚</p><p>ç»¼è¿°ï¼šä»£ç†è½¯ä»¶èƒ½å¤ŸæŠ“å– HTTPS çš„æ ¸å¿ƒæ˜¯è®©æµè§ˆå™¨ä¿¡ä»»ä»£ç†è½¯ä»¶çš„è¯ä¹¦ï¼Œä½¿ç”¨è¿™ä¸ªè¯ä¹¦ä»£æ›¿è¦è®¿é—®ç½‘ç«™çš„è¯ä¹¦ã€‚ç”±äº CA è¯ä¹¦åªèƒ½æœ‰ç‰¹å®šçš„ä¿¡ä»»æœºæ„æ‰èƒ½é¢å‘ï¼Œæ‰€ä»¥ä¸€èˆ¬æ¥è¯´ï¼Œä¸­é—´äººæ˜¯æ— æ³•æ¬ºéª—æµè§ˆå™¨è·å–ä¿¡ä»»çš„ã€‚è€Œæˆ‘ä»¬è‡ªå·±æŠ“åŒ…åˆ™æ˜¯ä¸»åŠ¨ä¿¡ä»»äº†ä»£ç†è½¯ä»¶çš„è¯ä¹¦ï¼Œå› æ­¤è¾¾åˆ°äº†ä½¿ç”¨ä»£ç†è½¯ä»¶å¯ä»¥æŠ“å– HTTPS çš„åŠŸèƒ½ã€‚</p><h2>å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://zh.wikipedia.org/wiki/%E8%B6%85%E6%96%87%E6%9C%AC%E4%BC%A0%E8%BE%93%E5%AE%89%E5%85%A8%E5%8D%8F%E8%AE%AE" target="_blank" rel="noopener">è¶…æ–‡æœ¬ä¼ è¾“å®‰å…¨åè®®</a></li><li><a href="https://www.guokr.com/post/114121/" target="_blank" rel="noopener">HTTPSé‚£äº›äº‹ï¼ˆä¸€ï¼‰HTTPSåŸç†</a></li><li><a href="https://zh.wikipedia.org/wiki/%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB" target="_blank" rel="noopener">ä¸­é—´äººæ”»å‡»</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‰é¢å‡ å¤©å­¦ä¹  DNS ç¼“å­˜çš„æ—¶å€™ï¼Œäº†è§£åˆ°äº† DNS åŠ«æŒå’Œ HTTP åŠ«æŒï¼Œå…³äº DNS åŠ«æŒå’Œ HTTP åŠ«æŒçš„åŒºåˆ«ï¼ŒçŸ¥ä¹ä¸Šä¸€ä½åŒå­¦ç»™å‡ºäº†æœ‰è¶£çš„æ¯”å–»&lt;a href=&quot;https://www.zhihu.com/question/27035513&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;DNSåŠ«æŒå’ŒHTTPåŠ«æŒæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ&lt;/a&gt;:&lt;br&gt;
DNS åŠ«æŒï¼šä½ è¾“å…¥çš„ç½‘å€æ˜¯ &lt;code&gt;http://www.google.com&lt;/code&gt;ï¼Œå‡ºæ¥çš„æ˜¯ç™¾åº¦çš„é¡µé¢ã€‚&lt;br&gt;
HTTP åŠ«æŒï¼šä½ æ‰“å¼€çš„æ˜¯çŸ¥ä¹çš„é¡µé¢ï¼Œå³ä¸‹è§’å¼¹å‡ºå”è€å¸ˆçš„ä¸å­•ä¸è‚²å¹¿å‘Šï¼ˆ2018å¹´æ›´ï¼šå³ä¸‹è§’å¼¹å‡ºï¼šå¶ç³»æ¸£æ¸£è¾‰ï¼‰ã€‚&lt;br&gt;
åº”å¯¹ HTTP åŠ«æŒæœ€æœ‰æ•ˆçš„æ–¹æ³•å°±æ˜¯ HTTPSã€‚æœ¬æ–‡å­¦ä¹  HTTPS ç›¸å…³çš„çŸ¥è¯†ã€‚åœ¨å­¦ä¹ ä¹‹å‰é¦–å…ˆæŠ›å‡ºä¸‰ä¸ªé—®é¢˜ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;HTTPS åŠ å¯†åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/li&gt;
&lt;li&gt;HTTPS æ˜¯å¦å®‰å…¨ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ&lt;/li&gt;
&lt;li&gt;ä¸ºä»€ä¹ˆæŠ“åŒ…å·¥å…·æ¯”å¦‚ Fiddler/Charles èƒ½æŠ“å– HTTPS åè®®çš„åŒ…ï¼Ÿ&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
      <category term="ç½‘ç»œ" scheme="https://lz5z.com/categories/%E7%BD%91%E7%BB%9C/"/>
    
    
      <category term="HTTPS" scheme="https://lz5z.com/tags/HTTPS/"/>
    
      <category term="SSL/TLS" scheme="https://lz5z.com/tags/SSL-TLS/"/>
    
      <category term="TCP" scheme="https://lz5z.com/tags/TCP/"/>
    
  </entry>
  
  <entry>
    <title>Web æ€§èƒ½ä¼˜åŒ–-é¦–å±å’Œç™½å±æ—¶é—´</title>
    <link href="https://lz5z.com/Web%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96-%E9%A6%96%E5%B1%8F%E5%92%8C%E7%99%BD%E5%B1%8F%E6%97%B6%E9%97%B4/"/>
    <id>https://lz5z.com/Webæ€§èƒ½ä¼˜åŒ–-é¦–å±å’Œç™½å±æ—¶é—´/</id>
    <published>2018-05-17T19:24:09.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h2>ä»€ä¹ˆæ˜¯é¦–å±å’Œç™½å±æ—¶é—´ï¼Ÿ</h2><p>ç™½å±æ—¶é—´æ˜¯æŒ‡æµè§ˆå™¨ä»å“åº”ç”¨æˆ·è¾“å…¥ç½‘å€åœ°å€ï¼Œåˆ°æµè§ˆå™¨å¼€å§‹æ˜¾ç¤ºå†…å®¹çš„æ—¶é—´ã€‚<br>é¦–å±æ—¶é—´æ˜¯æŒ‡æµè§ˆå™¨ä»å“åº”ç”¨æˆ·è¾“å…¥ç½‘ç»œåœ°å€ï¼Œåˆ°é¦–å±å†…å®¹æ¸²æŸ“å®Œæˆçš„æ—¶é—´ã€‚</p><p>ç™½å±æ—¶é—´ = åœ°å€æ è¾“å…¥ç½‘å€åå›è½¦ - æµè§ˆå™¨å‡ºç°ç¬¬ä¸€ä¸ªå…ƒç´ <br>é¦–å±æ—¶é—´ = åœ°å€æ è¾“å…¥ç½‘å€åå›è½¦ - æµè§ˆå™¨ç¬¬ä¸€å±æ¸²æŸ“å®Œæˆ</p><p>å½±å“ç™½å±æ—¶é—´çš„å› ç´ ï¼šç½‘ç»œï¼ŒæœåŠ¡ç«¯æ€§èƒ½ï¼Œå‰ç«¯é¡µé¢ç»“æ„è®¾è®¡ã€‚<br>å½±å“é¦–å±æ—¶é—´çš„å› ç´ ï¼šç™½å±æ—¶é—´ï¼Œèµ„æºä¸‹è½½æ‰§è¡Œæ—¶é—´ã€‚</p><p>ä»¥ç™¾åº¦ä¸ºä¾‹ï¼Œå°† chrome ç½‘é€Ÿè°ƒä¸º Fast 3Gï¼Œç„¶åæ‰“å¼€ Performance å·¥å…·ï¼Œç‚¹å‡» â€œStart profiling and reload pageâ€ æŒ‰é’®ï¼ŒæŸ¥çœ‹ Screenshots å¦‚ä¸‹å›¾ï¼š</p><a id="more"></a><img src="/assets/img/first_and_write_screen.png" alt="first_and_write_screen"><h2>ç™½å±æ—¶é—´</h2><p>é€šå¸¸è®¤ä¸ºæµè§ˆå™¨å¼€å§‹æ¸²æŸ“ <code>&lt;body&gt;</code> æˆ–è€…è§£æå®Œ <code>&lt;head&gt;</code> çš„æ—¶é—´æ˜¯ç™½å±ç»“æŸçš„æ—¶é—´ç‚¹ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>ç™½å±<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// ä¸å…¼å®¹ performance.timing çš„æµè§ˆå™¨</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">window</span>.pageStartTime = <span class="built_in">Date</span>.now()</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- é¡µé¢ CSS èµ„æº --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"xx.css"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"zz.css"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">            <span class="comment">// ç™½å±ç»“æŸæ—¶é—´</span></span></span><br><span class="line"><span class="javascript">            <span class="built_in">window</span>.firstPaint = <span class="built_in">Date</span>.now()</span></span><br><span class="line"><span class="actionscript">            <span class="comment">// ç™½å±æ—¶é—´</span></span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(firstPaint - performance.timing.navigationStart)</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç™½å±æ—¶é—´ = firstPaint - performance.timing.navigationStart || pageStartTime</p><h2>é¦–å±æ—¶é—´</h2><p>å…³äºé¦–å±æ—¶é—´æ˜¯å¦åŒ…å«å›¾ç‰‡åŠ è½½ç½‘ä¸Šæœ‰ä¸åŒçš„è¯´æ³•ï¼Œä¸ªäººè®¤ä¸ºï¼Œåªè¦é¦–å±ä¸­çš„å›¾ç‰‡åŠ è½½å®Œæˆï¼Œå³æ˜¯é¦–å±å®Œæˆï¼Œä¸åœ¨é¦–å±ä¸­çš„å›¾ç‰‡å¯ä»¥ä¸è€ƒè™‘ã€‚</p><p>è®¡ç®—é¦–å±æ—¶é—´å¸¸ç”¨çš„æ–¹æ³•æœ‰ï¼š</p><p>(1) é¦–å±æ¨¡å—æ ‡ç­¾æ ‡è®°æ³•</p><p>ç”±äºæµè§ˆå™¨è§£æ HTML æ˜¯æŒ‰ç…§é¡ºåºè§£æçš„ï¼Œå½“è§£æåˆ°æŸä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œä½ è§‰å¾—é¦–å±å®Œæˆäº†ï¼Œå°±åœ¨æ­¤å…ƒç´ åé¢åŠ å…¥ <code>script</code> è®¡ç®—é¦–å±å®Œæˆæ—¶é—´ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>é¦–å±<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// ä¸å…¼å®¹ performance.timing çš„æµè§ˆå™¨</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">window</span>.pageStartTime = <span class="built_in">Date</span>.now()</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- é¦–å±å¯è§å†…å®¹ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- é¦–å±å¯è§å†…å®¹ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="actionscript">            <span class="comment">// é¦–å±å±ç»“æŸæ—¶é—´</span></span></span><br><span class="line"><span class="javascript">            <span class="built_in">window</span>.firstPaint = <span class="built_in">Date</span>.now()</span></span><br><span class="line"><span class="actionscript">            <span class="comment">// é¦–å±æ—¶é—´</span></span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(firstPaint - performance.timing.navigationStart)</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- é¦–å±ä¸å¯è§å†…å®¹ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- é¦–å±ä¸å¯è§å†…å®¹ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>(2) ç»Ÿè®¡é¦–å±å†…åŠ è½½æœ€æ…¢çš„å›¾ç‰‡/iframe</p><p>é€šå¸¸é¦–å±å†…å®¹ä¸­åŠ è½½æœ€æ…¢çš„å°±æ˜¯å›¾ç‰‡æˆ–è€… iframe èµ„æºï¼Œå› æ­¤å¯ä»¥ç†è§£ä¸ºå½“å›¾ç‰‡æˆ–è€… iframe éƒ½åŠ è½½å‡ºæ¥äº†ï¼Œé¦–å±è‚¯å®šå·²ç»å®Œæˆäº†ã€‚</p><p>ç”±äºæµè§ˆå™¨å¯¹æ¯ä¸ªé¡µé¢çš„ TCP è¿æ¥æ•°æœ‰é™åˆ¶ï¼Œä½¿å¾—å¹¶ä¸æ˜¯æ‰€æœ‰å›¾ç‰‡éƒ½èƒ½ç«‹åˆ»å¼€å§‹ä¸‹è½½å’Œæ˜¾ç¤ºã€‚æˆ‘ä»¬åªéœ€è¦ç›‘å¬é¦–å±å†…æ‰€æœ‰çš„å›¾ç‰‡çš„ onload äº‹ä»¶ï¼Œè·å–å›¾ç‰‡ onload æ—¶é—´æœ€å¤§å€¼ï¼Œå¹¶ç”¨è¿™ä¸ªæœ€å¤§å€¼å‡å» navigationStart å³å¯è·å¾—è¿‘ä¼¼çš„é¦–å±æ—¶é—´ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>é¦–å±<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// ä¸å…¼å®¹ performance.timing çš„æµè§ˆå™¨</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">window</span>.pageStartTime = <span class="built_in">Date</span>.now()</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"https://lz5z.com/assets/img/google_atf.png"</span> <span class="attr">alt</span>=<span class="string">"img"</span> <span class="attr">onload</span>=<span class="string">"load()"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"https://lz5z.com/assets/img/css3_gpu_speedup.png"</span> <span class="attr">alt</span>=<span class="string">"img"</span> <span class="attr">onload</span>=<span class="string">"load()"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">        <span class="function"><span class="keyword">function</span> <span class="title">load</span> <span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">window</span>.firstScreen = <span class="built_in">Date</span>.now()</span></span><br><span class="line">        &#125;</span><br><span class="line"><span class="javascript">        <span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="actionscript">            <span class="comment">// é¦–å±æ—¶é—´</span></span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="built_in">window</span>.firstScreen - performance.timing.navigationStart)</span></span><br><span class="line">        &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Performance" target="_blank" rel="noopener">Performance API</a></h3><p>Performance æ¥å£å¯ä»¥è·å–åˆ°å½“å‰é¡µé¢ä¸æ€§èƒ½ç›¸å…³çš„ä¿¡æ¯ã€‚</p><p>(1) Performance.timing</p><p>åœ¨ chrome ä¸­æŸ¥çœ‹ performance.timing å¯¹è±¡ï¼š</p><img src="/assets/img/performance-timing.png" alt="performance"><p>ä¸æµè§ˆå™¨å¯¹åº”çš„çŠ¶æ€å¦‚ä¸‹å›¾ï¼š</p><img src="/assets/img/performance.png" alt="performance"><p>å·¦è¾¹çº¢çº¿ä»£è¡¨çš„æ˜¯ç½‘ç»œä¼ è¾“å±‚é¢çš„è¿‡ç¨‹ï¼Œå³è¾¹çº¢çº¿ä»£è¡¨äº†æœåŠ¡å™¨ä¼ è¾“å›å­—èŠ‚åæµè§ˆå™¨çš„å„ç§äº‹ä»¶çŠ¶æ€ï¼Œè¿™ä¸ªé˜¶æ®µåŒ…å«äº†æµè§ˆå™¨å¯¹æ–‡æ¡£çš„è§£æï¼ŒDOM æ ‘æ„å»ºï¼Œå¸ƒå±€ï¼Œç»˜åˆ¶ç­‰ç­‰ã€‚</p><ul><li>navigationStart: è¡¨ç¤ºä»ä¸Šä¸€ä¸ªæ–‡æ¡£å¸è½½ç»“æŸæ—¶çš„ unix æ—¶é—´æˆ³ï¼Œå¦‚æœæ²¡æœ‰ä¸Šä¸€ä¸ªæ–‡æ¡£ï¼Œè¿™ä¸ªå€¼å°†å’Œ fetchStart ç›¸ç­‰ã€‚</li><li>unloadEventStart: è¡¨ç¤ºå‰ä¸€ä¸ªç½‘é¡µï¼ˆä¸å½“å‰é¡µé¢åŒåŸŸï¼‰unload çš„æ—¶é—´æˆ³ï¼Œå¦‚æœæ— å‰ä¸€ä¸ªç½‘é¡µ unload æˆ–è€…å‰ä¸€ä¸ªç½‘é¡µä¸å½“å‰é¡µé¢ä¸åŒåŸŸï¼Œåˆ™å€¼ä¸º 0ã€‚</li><li>unloadEventEnd: è¿”å›å‰ä¸€ä¸ªé¡µé¢ unload æ—¶é—´ç»‘å®šçš„å›æ‰å‡½æ•°æ‰§è¡Œå®Œæ¯•çš„æ—¶é—´æˆ³ã€‚</li><li>redirectStart: ç¬¬ä¸€ä¸ª HTTP é‡å®šå‘å‘ç”Ÿæ—¶çš„æ—¶é—´ã€‚æœ‰è·³è½¬ä¸”æ˜¯åŒåŸŸåå†…çš„é‡å®šå‘æ‰ç®—ï¼Œå¦åˆ™å€¼ä¸º 0ã€‚</li><li>redirectEnd: æœ€åä¸€ä¸ª HTTP é‡å®šå‘å®Œæˆæ—¶çš„æ—¶é—´ã€‚æœ‰è·³è½¬ä¸”æ˜¯åŒåŸŸåå†…éƒ¨çš„é‡å®šå‘æ‰ç®—ï¼Œå¦åˆ™å€¼ä¸º 0ã€‚</li><li>fetchStart: æµè§ˆå™¨å‡†å¤‡å¥½ä½¿ç”¨ HTTP è¯·æ±‚æŠ“å–æ–‡æ¡£çš„æ—¶é—´ï¼Œè¿™å‘ç”Ÿåœ¨æ£€æŸ¥æœ¬åœ°ç¼“å­˜ä¹‹å‰ã€‚</li><li>domainLookupStart/domainLookupEnd: DNS åŸŸåæŸ¥è¯¢å¼€å§‹/ç»“æŸçš„æ—¶é—´ï¼Œå¦‚æœä½¿ç”¨äº†æœ¬åœ°ç¼“å­˜ï¼ˆå³æ—  DNS æŸ¥è¯¢ï¼‰æˆ–æŒä¹…è¿æ¥ï¼Œåˆ™ä¸ fetchStart å€¼ç›¸ç­‰</li><li>connectStart: HTTPï¼ˆTCPï¼‰å¼€å§‹/é‡æ–° å»ºç«‹è¿æ¥çš„æ—¶é—´ï¼Œå¦‚æœæ˜¯æŒä¹…è¿æ¥ï¼Œåˆ™ä¸ fetchStart å€¼ç›¸ç­‰ã€‚</li><li>connectEnd: HTTPï¼ˆTCPï¼‰ å®Œæˆå»ºç«‹è¿æ¥çš„æ—¶é—´ï¼ˆå®Œæˆæ¡æ‰‹ï¼‰ï¼Œå¦‚æœæ˜¯æŒä¹…è¿æ¥ï¼Œåˆ™ä¸ fetchStart å€¼ç›¸ç­‰ã€‚</li><li>secureConnectionStart: HTTPS è¿æ¥å¼€å§‹çš„æ—¶é—´ï¼Œå¦‚æœä¸æ˜¯å®‰å…¨è¿æ¥ï¼Œåˆ™å€¼ä¸º 0ã€‚</li><li>requestStart: HTTP è¯·æ±‚è¯»å–çœŸå®æ–‡æ¡£å¼€å§‹çš„æ—¶é—´ï¼ˆå®Œæˆå»ºç«‹è¿æ¥ï¼‰ï¼ŒåŒ…æ‹¬ä»æœ¬åœ°è¯»å–ç¼“å­˜ã€‚</li><li>responseStart: HTTP å¼€å§‹æ¥æ”¶å“åº”çš„æ—¶é—´ï¼ˆè·å–åˆ°ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼‰ï¼ŒåŒ…æ‹¬ä»æœ¬åœ°è¯»å–ç¼“å­˜ã€‚</li><li>responseEnd: HTTP å“åº”å…¨éƒ¨æ¥æ”¶å®Œæˆçš„æ—¶é—´ï¼ˆè·å–åˆ°æœ€åä¸€ä¸ªå­—èŠ‚ï¼‰ï¼ŒåŒ…æ‹¬ä»æœ¬åœ°è¯»å–ç¼“å­˜ã€‚</li><li>domLoading: å¼€å§‹è§£ææ¸²æŸ“ DOM æ ‘çš„æ—¶é—´ï¼Œæ­¤æ—¶ Document.readyState å˜ä¸º loadingï¼Œå¹¶å°†æŠ›å‡º readystatechange ç›¸å…³äº‹ä»¶ã€‚</li><li>domInteractive: å®Œæˆè§£æ DOM æ ‘çš„æ—¶é—´ï¼ŒDocument.readyState å˜ä¸º interactiveï¼Œå¹¶å°†æŠ›å‡º readystatechange ç›¸å…³äº‹ä»¶ï¼Œæ³¨æ„åªæ˜¯ DOM æ ‘è§£æå®Œæˆï¼Œè¿™æ—¶å€™å¹¶æ²¡æœ‰å¼€å§‹åŠ è½½ç½‘é¡µå†…çš„èµ„æºã€‚</li><li>domContentLoadedEventStart: DOM è§£æå®Œæˆåï¼Œç½‘é¡µå†…èµ„æºåŠ è½½å¼€å§‹çš„æ—¶é—´ï¼Œåœ¨ DOMContentLoaded äº‹ä»¶æŠ›å‡ºå‰å‘ç”Ÿã€‚</li><li>domContentLoadedEventEnd: DOM è§£æå®Œæˆåï¼Œç½‘é¡µå†…èµ„æºåŠ è½½å®Œæˆçš„æ—¶é—´ï¼ˆå¦‚ JS è„šæœ¬åŠ è½½æ‰§è¡Œå®Œæ¯•ï¼‰ã€‚</li><li>domComplete: DOM æ ‘è§£æå®Œæˆï¼Œä¸”èµ„æºä¹Ÿå‡†å¤‡å°±ç»ªçš„æ—¶é—´ï¼ŒDocument.readyState å˜ä¸º completeï¼Œå¹¶å°†æŠ›å‡º readystatechange ç›¸å…³äº‹ä»¶ã€‚</li><li>loadEventStart: load äº‹ä»¶å‘é€ç»™æ–‡æ¡£ï¼Œä¹Ÿå³ load å›è°ƒå‡½æ•°å¼€å§‹æ‰§è¡Œçš„æ—¶é—´ã€‚</li><li>loadEventEnd: load äº‹ä»¶çš„å›è°ƒå‡½æ•°æ‰§è¡Œå®Œæ¯•çš„æ—¶é—´ã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è®¡ç®—åŠ è½½æ—¶é—´</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPerformanceTiming</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> t = performance.timing</span><br><span class="line">    <span class="keyword">var</span> times = &#123;&#125;</span><br><span class="line">    <span class="comment">// é¡µé¢åŠ è½½å®Œæˆçš„æ—¶é—´ï¼Œç”¨æˆ·ç­‰å¾…é¡µé¢å¯ç”¨çš„æ—¶é—´</span></span><br><span class="line">    times.loadPage = t.loadEventEnd - t.navigationStart</span><br><span class="line">    <span class="comment">// è§£æ DOM æ ‘ç»“æ„çš„æ—¶é—´</span></span><br><span class="line">    times.domReady = t.domComplete - t.responseEnd</span><br><span class="line">    <span class="comment">// é‡å®šå‘çš„æ—¶é—´</span></span><br><span class="line">    times.redirect = t.redirectEnd - t.redirectStart</span><br><span class="line">    <span class="comment">// DNS æŸ¥è¯¢æ—¶é—´</span></span><br><span class="line">    times.lookupDomain = t.domainLookupEnd - t.domainLookupStart</span><br><span class="line">    <span class="comment">// è¯»å–é¡µé¢ç¬¬ä¸€ä¸ªå­—èŠ‚çš„æ—¶é—´</span></span><br><span class="line">    times.ttfb = t.responseStart - t.navigationStart</span><br><span class="line">    <span class="comment">// èµ„æºè¯·æ±‚åŠ è½½å®Œæˆçš„æ—¶é—´</span></span><br><span class="line">    times.request = t.responseEnd - t.requestStart</span><br><span class="line">    <span class="comment">// æ‰§è¡Œ onload å›è°ƒå‡½æ•°çš„æ—¶é—´</span></span><br><span class="line">    times.loadEvent = t.loadEventEnd - t.loadEventStart</span><br><span class="line">    <span class="comment">// DNS ç¼“å­˜æ—¶é—´</span></span><br><span class="line">    times.appcache = t.domainLookupStart - t.fetchStart</span><br><span class="line">    <span class="comment">// å¸è½½é¡µé¢çš„æ—¶é—´</span></span><br><span class="line">    times.unloadEvent = t.unloadEventEnd - t.unloadEventStart</span><br><span class="line">    <span class="comment">// TCP å»ºç«‹è¿æ¥å®Œæˆæ¡æ‰‹çš„æ—¶é—´</span></span><br><span class="line">    times.connect = t.connectEnd - t.connectStart</span><br><span class="line">    <span class="keyword">return</span> times</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(2) Performance.navigation</p><ul><li>redirectCount: 0 // é¡µé¢ç»è¿‡äº†å¤šå°‘æ¬¡é‡å®šå‘</li><li>type: 0<ul><li>0 è¡¨ç¤ºæ­£å¸¸è¿›å…¥é¡µé¢ï¼›</li><li>1 è¡¨ç¤ºé€šè¿‡ <code>window.location.reload()</code> åˆ·æ–°é¡µé¢ï¼›</li><li>2 è¡¨ç¤ºé€šè¿‡æµè§ˆå™¨å‰è¿›åé€€è¿›å…¥é¡µé¢ï¼›</li><li>255 è¡¨ç¤ºå…¶å®ƒæ–¹å¼</li></ul></li></ul><p>(3) Performance.memory</p><ul><li>jsHeapSizeLimit: å†…å­˜å¤§å°é™åˆ¶</li><li>totalJSHeapSize: å¯ä½¿ç”¨çš„å†…å­˜</li><li>usedJSHeapSize: JS å¯¹è±¡å ç”¨çš„å†…å­˜</li></ul><h3>DOMContentLoaded vs load</h3><p>(1) DOMContentLoaded æ˜¯æŒ‡é¡µé¢å…ƒç´ åŠ è½½å®Œæ¯•ï¼Œä½†æ˜¯ä¸€äº›èµ„æºæ¯”å¦‚å›¾ç‰‡è¿˜æ— æ³•çœ‹åˆ°ï¼Œä½†æ˜¯è¿™ä¸ªæ—¶å€™é¡µé¢æ˜¯å¯ä»¥æ­£å¸¸äº¤äº’çš„ï¼Œæ¯”å¦‚æ»šåŠ¨ï¼Œè¾“å…¥å­—ç¬¦ç­‰ã€‚ jQuery ä¸­ç»å¸¸ä½¿ç”¨çš„ <code>$(document).ready()</code> å…¶å®ç›‘å¬çš„å°±æ˜¯ DOMContentLoaded äº‹ä»¶ã€‚</p><p>(2) load æ˜¯æŒ‡é¡µé¢ä¸Šæ‰€æœ‰çš„èµ„æºï¼ˆå›¾ç‰‡ï¼ŒéŸ³é¢‘ï¼Œè§†é¢‘ç­‰ï¼‰åŠ è½½å®Œæˆã€‚jQuery ä¸­ <code>$(document).load()</code> ç›‘å¬çš„æ˜¯ load äº‹ä»¶ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// load</span></span><br><span class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// DOMContentLoaded</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ready</span> (<span class="params">fn</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">document</span>.addEventListener) &#123;</span><br><span class="line">        <span class="built_in">document</span>.addEventListener(<span class="string">'DOMContentLoaded'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">document</span>.removeEventListener(<span class="string">'DOMContentLoaded'</span>, <span class="built_in">arguments</span>.callee, <span class="literal">false</span>)</span><br><span class="line">            fn()</span><br><span class="line">        &#125;, <span class="literal">false</span>)</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="comment">// å¦‚æœ IE</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">document</span>.attachEvent) &#123;</span><br><span class="line">        <span class="comment">// ç¡®ä¿å½“é¡µé¢æ˜¯åœ¨iframeä¸­åŠ è½½æ—¶ï¼Œäº‹ä»¶ä¾æ—§ä¼šè¢«å®‰å…¨è§¦å‘</span></span><br><span class="line">        <span class="built_in">document</span>.attachEvent(<span class="string">'onreadystatechange'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">document</span>.readyState == <span class="string">'complete'</span>) &#123;</span><br><span class="line">                <span class="built_in">document</span>.detachEvent(<span class="string">'onreadystatechange'</span>, <span class="built_in">arguments</span>.callee)</span><br><span class="line">                fn()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">// å¦‚æœæ˜¯ IE ä¸”é¡µé¢ä¸åœ¨ iframe ä¸­æ—¶ï¼Œè½®è¯¢è°ƒç”¨ doScroll æ–¹æ³•æ£€æµ‹DOMæ˜¯å¦åŠ è½½å®Œæ¯•</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">document</span>.documentElement.doScroll &amp;&amp; <span class="keyword">typeof</span> <span class="built_in">window</span>.frameElement === <span class="string">'undefined'</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="built_in">document</span>.documentElement.doScroll(<span class="string">'left'</span>)</span><br><span class="line">            &#125; <span class="keyword">catch</span>(error) &#123;</span><br><span class="line">                <span class="keyword">return</span> setTimeout(<span class="built_in">arguments</span>.callee, <span class="number">20</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            fn()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2>å‚è€ƒèµ„æ–™</h2><ul><li><a href="http://www.cnblogs.com/longm/p/7382163.html" target="_blank" rel="noopener">å‰ç«¯ä¼˜åŒ–-å¦‚ä½•è®¡ç®—ç™½å±å’Œé¦–å±æ—¶é—´</a></li><li><a href="https://segmentfault.com/a/1190000005784687" target="_blank" rel="noopener">å‰ç«¯æ€§èƒ½çš„å‡ ä¸ªåŸºç¡€æŒ‡æ ‡</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Performance" target="_blank" rel="noopener">Performance - MDN</a></li><li><a href="http://www.alloyteam.com/2015/09/explore-performance/" target="_blank" rel="noopener">åˆæ¢ performance â€“ ç›‘æ§ç½‘é¡µä¸ç¨‹åºæ€§èƒ½</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;ä»€ä¹ˆæ˜¯é¦–å±å’Œç™½å±æ—¶é—´ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;ç™½å±æ—¶é—´æ˜¯æŒ‡æµè§ˆå™¨ä»å“åº”ç”¨æˆ·è¾“å…¥ç½‘å€åœ°å€ï¼Œåˆ°æµè§ˆå™¨å¼€å§‹æ˜¾ç¤ºå†…å®¹çš„æ—¶é—´ã€‚&lt;br&gt;
é¦–å±æ—¶é—´æ˜¯æŒ‡æµè§ˆå™¨ä»å“åº”ç”¨æˆ·è¾“å…¥ç½‘ç»œåœ°å€ï¼Œåˆ°é¦–å±å†…å®¹æ¸²æŸ“å®Œæˆçš„æ—¶é—´ã€‚&lt;/p&gt;
&lt;p&gt;ç™½å±æ—¶é—´ = åœ°å€æ è¾“å…¥ç½‘å€åå›è½¦ - æµè§ˆå™¨å‡ºç°ç¬¬ä¸€ä¸ªå…ƒç´ &lt;br&gt;
é¦–å±æ—¶é—´ = åœ°å€æ è¾“å…¥ç½‘å€åå›è½¦ - æµè§ˆå™¨ç¬¬ä¸€å±æ¸²æŸ“å®Œæˆ&lt;/p&gt;
&lt;p&gt;å½±å“ç™½å±æ—¶é—´çš„å› ç´ ï¼šç½‘ç»œï¼ŒæœåŠ¡ç«¯æ€§èƒ½ï¼Œå‰ç«¯é¡µé¢ç»“æ„è®¾è®¡ã€‚&lt;br&gt;
å½±å“é¦–å±æ—¶é—´çš„å› ç´ ï¼šç™½å±æ—¶é—´ï¼Œèµ„æºä¸‹è½½æ‰§è¡Œæ—¶é—´ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ç™¾åº¦ä¸ºä¾‹ï¼Œå°† chrome ç½‘é€Ÿè°ƒä¸º Fast 3Gï¼Œç„¶åæ‰“å¼€ Performance å·¥å…·ï¼Œç‚¹å‡» â€œStart profiling and reload pageâ€ æŒ‰é’®ï¼ŒæŸ¥çœ‹ Screenshots å¦‚ä¸‹å›¾ï¼š&lt;/p&gt;
    
    </summary>
    
      <category term="æ€§èƒ½" scheme="https://lz5z.com/categories/%E6%80%A7%E8%83%BD/"/>
    
    
      <category term="é¦–å±" scheme="https://lz5z.com/tags/%E9%A6%96%E5%B1%8F/"/>
    
      <category term="ç™½å±" scheme="https://lz5z.com/tags/%E7%99%BD%E5%B1%8F/"/>
    
  </entry>
  
  <entry>
    <title>Web æ€§èƒ½ä¼˜åŒ–-ç¼“å­˜-HTTP ç¼“å­˜</title>
    <link href="https://lz5z.com/Web%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96-HTTP%E7%BC%93%E5%AD%98/"/>
    <id>https://lz5z.com/Webæ€§èƒ½ä¼˜åŒ–-HTTPç¼“å­˜/</id>
    <published>2018-05-16T16:39:55.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h2>æµè§ˆå™¨ç¼“å­˜</h2><p>HTTP ç¼“å­˜é€šå¸¸è¦é…åˆå®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰ä½¿ç”¨æ‰èƒ½å‘æŒ¥æ•ˆæœï¼Œæ‰€ä»¥åˆè¢«ç§°ä¹‹ä¸ºæµè§ˆå™¨ç¼“å­˜ï¼Œæ˜¯ Web æ€§èƒ½ä¼˜åŒ–çš„ä¸€å¤§åˆ©å™¨ã€‚</p><h3>ç¼“å­˜ç±»å‹</h3><p>æµè§ˆå™¨ç¼“å­˜åˆ†ä¸ºå¼ºç¼“å­˜å’Œåå•†ç¼“å­˜ã€‚</p><p>(1) å¼ºç¼“å­˜ï¼šæµè§ˆå™¨åœ¨åŠ è½½èµ„æºçš„æ—¶å€™ï¼Œæ ¹æ®èµ„æºçš„ HTTP Header åˆ¤æ–­å®ƒæ˜¯å¦å‘½ä¸­å¼ºç¼“å­˜ï¼Œå¦‚æœå‘½ä¸­ï¼Œæµè§ˆå™¨ç›´æ¥ä»è‡ªå·±çš„ç¼“å­˜ä¸­è¯»å–èµ„æºï¼Œä¸ä¼šå‘è¯·æ±‚åˆ°æœåŠ¡å™¨ã€‚</p><p>(2) åå•†ç¼“å­˜ï¼šå½“å¼ºç¼“å­˜æ²¡æœ‰å‘½ä¸­çš„æ—¶å€™ï¼Œæµè§ˆå™¨å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼ŒæœåŠ¡å™¨ç«¯ä¾æ®èµ„æºçš„å¦å¤–ä¸€äº›  HTTP Header éªŒè¯è¿™ä¸ªèµ„æºæ˜¯å¦å‘½ä¸­åå•†ç¼“å­˜ï¼Œå¦‚æœåå•†ç¼“å­˜å‘½ä¸­ï¼ŒæœåŠ¡å™¨ä¼šå°†è¿™ä¸ªè¯·æ±‚è¿”å› 304ï¼Œæµè§ˆå™¨ä»ç¼“å­˜ä¸­åŠ è½½è¿™ä¸ªèµ„æºï¼›è‹¥æœªå‘½ä¸­è¯·æ±‚ï¼ŒæœåŠ¡ç«¯è¿”å› 200 å¹¶å°†èµ„æºè¿”å›å®¢æˆ·ç«¯ï¼Œæµè§ˆå™¨æ›´æ–°æœ¬åœ°ç¼“å­˜æ•°æ®ã€‚</p><a id="more"></a><p>å¦å¤–ä¸€ç§åˆ†ç±»æ–¹å¼ï¼Œå¯ä»¥å°†æµè§ˆå™¨ç¼“å­˜åˆ†æˆ HTTP åè®®ç¼“å­˜å’Œé HTTP åè®®ç¼“å­˜ã€‚</p><p>(1) é HTTP åè®®ç¼“å­˜ï¼šä½¿ç”¨ HTML Meta æ ‡ç­¾ï¼Œå¼€å‘è€…å¯ä»¥å‘Šè¯‰æµè§ˆå™¨æ˜¯å¦ç¼“å­˜å½“å‰é¡µé¢ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">META</span> <span class="attr">HTTP-EQUIV</span>=<span class="string">"Pragma"</span> <span class="attr">CONTENT</span>=<span class="string">"no-cache"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">META</span> <span class="attr">HTTP-EQUIV</span>=<span class="string">"Expires"</span> <span class="attr">CONTENT</span>=<span class="string">"0"</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç å‘Šè¯‰æµè§ˆå™¨å½“å‰é¡µé¢ä¸èƒ½è¢«ç¼“å­˜ï¼Œæ¯æ¬¡è®¿é—®éƒ½è¦å»æœåŠ¡ç«¯æ‹‰å–ã€‚åªæœ‰éƒ¨åˆ†æµè§ˆå™¨æ”¯æŒï¼Œç¼“å­˜ä»£ç†æœåŠ¡å™¨ä¸æ”¯æŒã€‚</p><p>(2) HTTP åè®®ç¼“å­˜ï¼šé€šè¿‡åœ¨ HTTP åè®®å¤´é‡Œé¢å®šä¹‰ä¸€äº›å­—æ®µæ¥å‘Šè¯‰æµè§ˆå™¨å½“å‰èµ„æºæ˜¯å¦ç¼“å­˜ï¼Œæ¯”å¦‚  Cache-Control, Expires, Last-Modified, Etag ç­‰ã€‚</p><h2>HTTP ç¼“å­˜</h2><h3>HTTP/1.0 ç¼“å­˜å­—æ®µ</h3><p>(1) <strong>Pragma</strong>ï¼šè®¾ç½®èµ„æºæ˜¯å¦ç¼“å­˜ï¼Œno-cache è¡¨ç¤ºä¸ç¼“å­˜ã€‚åœ¨ HTTP/1.1 ä¸­è¢« Cache-Control æ›¿ä»£ï¼Œæ‰€ä»¥ä¼˜å…ˆçº§ä½äº Cache-Controlã€‚</p><p>(2) <strong>Expires</strong>ï¼šè®¾ç½®èµ„æºè¿‡æœŸæ—¶é—´ï¼ŒExpires çš„å€¼å¯¹åº”ä¸€ä¸ª GMT(æ ¼æ—å°¼æ²»æ—¶é—´) æ¥å‘Šè¯‰æµè§ˆå™¨èµ„æºä»€ä¹ˆæ—¶é—´è¿‡æœŸã€‚ç¼ºç‚¹æ˜¯å¦‚æœå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯æ—¶é—´ç›¸å·®å¾ˆå¤§ï¼Œä¼šå¯¼è‡´æ—¶é—´è®¡ç®—ä¸ç²¾ç¡®ï¼Œåœ¨ HTTP/1.1 ä¸­è¢« max-age å–ä»£ã€‚</p><h3>HTTP/1.1 ç›¸å…³å­—æ®µ</h3><p>(1) <strong><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Cache-Control" target="_blank" rel="noopener">Cache-Control</a></strong>ï¼šè®¾ç½®ä¸€ä¸ªç›¸å¯¹çš„æ—¶é—´ï¼Œåœ¨ç¼“å­˜åˆ¤å®šçš„æ—¶å€™ï¼Œç”±æµè§ˆå™¨è¿›è¡Œåˆ¤æ–­ã€‚Cache-Control çš„å€¼å¯ä»¥æ˜¯ public, private, no-cache, no-store, no-transform ç­‰ã€‚</p><ul><li><p>max-age(å•ä½ä¸º s) è®¾å®šç¼“å­˜æœ€å¤§çš„æœ‰æ•ˆæ—¶é—´ï¼Œ<code>Cache-Control: max-age=3600</code> è¡¨ç¤ºè¯¥èµ„æºåœ¨æµè§ˆå™¨ç«¯ä¸€ä¸ªå°æ—¶å†…å‡æœ‰æ•ˆã€‚</p></li><li><p>s-maxage(å•ä½æ˜¯ s) è®¾å®šå…±äº«ç¼“å­˜æ—¶é—´ï¼Œæ¯”å¦‚ CDN æˆ–è€…ä»£ç†ã€‚</p></li><li><p>no-store ç½‘ç»œèµ„æºä¸ç¼“å­˜ï¼Œæ¯æ¬¡éƒ½åˆ°æœåŠ¡å™¨ä¸Šæ‹‰å–ã€‚</p></li><li><p>no-cache è¡¨ç¤ºç½‘ç»œèµ„æºå¯ä»¥ç¼“å­˜ä¸€ä»½ï¼Œä½†ä½¿ç”¨å‰å¿…é¡»è¯¢é—®æœåŠ¡å™¨æ­¤èµ„æºæ˜¯ä¸æ˜¯æœ€æ–°çš„ã€‚</p></li><li><p>public è¡¨æ˜å“åº”å¯ä»¥è¢«ä»»ä½•å¯¹è±¡ï¼ˆå®¢æˆ·ç«¯ï¼Œä»£ç†æœåŠ¡å™¨ç­‰ï¼‰ç¼“å­˜ã€‚</p></li><li><p>private è¡¨æ˜å“åº”åªèƒ½è¢«å•ä¸ªç”¨æˆ·ç¼“å­˜ï¼Œå…¶å®ƒç”¨æˆ·æˆ–è€…ä»£ç†æœåŠ¡å™¨ä¸èƒ½ç¼“å­˜è¿™äº›æ•°æ®ã€‚</p></li></ul><p>(2) <strong>Last-Modified/If-Modified-Since</strong>ï¼š</p><ul><li><p>Last-Modified è¡¨ç¤ºå“åº”èµ„æºæœ€åä¿®æ”¹æ—¶é—´ï¼Œéœ€è¦ä¸ Cache-Control å…±åŒä½¿ç”¨ï¼Œæ˜¯æ£€æŸ¥æœåŠ¡ç«¯èµ„æºæ›´æ–°çš„ä¸€ç§æ–¹å¼ã€‚</p></li><li><p>If-Modified-Since è¡¨ç¤ºèµ„æºè¿‡æœŸæ—¶ï¼ˆè¶…è¿‡ max-ageï¼‰ï¼Œå‘ç°èµ„æºå…·æœ‰ Last-Modified å£°æ˜ï¼Œåˆ™å†æ¬¡å‘webæœåŠ¡å™¨è¯·æ±‚æ—¶å¸¦ä¸Šå¤´ If-Modified-Sinceï¼Œè¡¨ç¤ºè¯·æ±‚æ—¶é—´ã€‚web æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åå‘ç° Header ä¸­æœ‰ If-Modified-Since åˆ™ä¸è¢«è¯·æ±‚èµ„æºçš„æœ€åä¿®æ”¹æ—¶é—´è¿›è¡Œæ¯”å¯¹ã€‚è‹¥æœ€åä¿®æ”¹æ—¶é—´è¾ƒæ–°ï¼Œè¯´æ˜èµ„æºåˆè¢«æ”¹åŠ¨è¿‡ï¼Œåˆ™å“åº”æ•´ç‰‡èµ„æºå†…å®¹ï¼ˆå†™åœ¨å“åº”æ¶ˆæ¯åŒ…ä½“å†…ï¼‰ï¼ŒHTTP 200ï¼›è‹¥æœ€åä¿®æ”¹æ—¶é—´è¾ƒæ—§ï¼Œè¯´æ˜èµ„æºæ— æ–°ä¿®æ”¹ï¼Œåˆ™å“åº”HTTP 304 (æ— éœ€åŒ…ä½“ï¼ŒèŠ‚çœæµè§ˆ)ï¼Œå‘ŠçŸ¥æµè§ˆå™¨ç»§ç»­ä½¿ç”¨æ‰€ä¿å­˜çš„cacheã€‚</p></li></ul><p>(3) <strong>Etag/If-None-Match</strong>ï¼š</p><ul><li><p>Etag æ˜¯æ ¹æ®èµ„æºå†…å®¹ç”Ÿæˆçš„ä¸€æ®µ hash å­—ç¬¦ä¸²ï¼Œæ ‡è¯†èµ„æºçš„çŠ¶æ€ï¼Œç”±æœåŠ¡ç«¯äº§ç”Ÿã€‚æµè§ˆå™¨å°†è¿™ä¸²å­—ç¬¦ä¸²ä¼ å›æœåŠ¡å™¨ï¼ŒéªŒè¯èµ„æºæ˜¯å¦å‘ç”Ÿä¿®æ”¹ã€‚</p></li><li><p>If-None-Match è¡¨ç¤ºå½“èµ„æºè¿‡æœŸæ—¶ï¼ˆè¶…è¿‡ max-ageï¼‰ï¼Œå‘ç°èµ„æºæœ‰ Etag å£°æ˜ï¼Œå‘ web æœåŠ¡å™¨å‘é€è¯·æ±‚æ—¶å¸¦ä¸Š If-None-Match ï¼ˆEtag å€¼ï¼‰ã€‚web æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åå‘ç° Header ä¸­å¸¦æœ‰ If-None-Match åˆ™ä¸è¢«è¯·æ±‚èµ„æºçš„ç›¸åº”æ ¡éªŒä¸²è¿›è¡Œå¯¹æ¯”ï¼Œå†³å®šè¿”å› 200 æˆ–è€… 304ã€‚</p></li></ul><h3>Last-Modified vs Etag</h3><p>Etag å¯ä»¥è§£å†³ Last-Modified å­˜åœ¨çš„ä¸€äº›é—®é¢˜ï¼š</p><ul><li>æŸäº›æœåŠ¡å™¨ä¸èƒ½ç²¾ç¡®å¾—åˆ°èµ„æºçš„æœ€åä¿®æ”¹æ—¶é—´ï¼Œè¿™æ ·å°±æ— æ³•é€šè¿‡æœ€åä¿®æ”¹æ—¶é—´åˆ¤æ–­èµ„æºæ˜¯å¦æ›´æ–°ã€‚</li><li>å¦‚æœèµ„æºä¿®æ”¹éå¸¸é¢‘ç¹ï¼Œè€Œ Last-modified åªèƒ½ç²¾ç¡®åˆ°ç§’ã€‚</li><li>ä¸€äº›èµ„æºçš„æœ€åä¿®æ”¹æ—¶é—´æ”¹å˜äº†ï¼Œä½†æ˜¯å†…å®¹æ²¡æ”¹å˜ï¼Œä½¿ç”¨ ETag å°±è®¤ä¸ºèµ„æºè¿˜æ˜¯æ²¡æœ‰ä¿®æ”¹çš„ã€‚</li></ul><h2>æµè§ˆå™¨è¡Œä¸º</h2><p>(1) F5 åˆ·æ–°é¡µé¢æ—¶ï¼Œä¼šè·³è¿‡å¼ºç¼“å­˜ï¼Œæ£€æŸ¥åå•†ç¼“å­˜ã€‚<br>(2) ctrl + F5 å¼ºåˆ¶åˆ·æ–°é¡µé¢æ—¶ï¼Œä¹‹é—´ä»æœåŠ¡ç«¯åŠ è½½æ•°æ®ï¼Œè·³è¿‡å¼ºç¼“å­˜å’Œåå•†ç¼“å­˜ã€‚</p><h2>å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers" target="_blank" rel="noopener">HTTP Headers</a></li><li><a href="https://www.cnblogs.com/vajoy/p/5341664.html" target="_blank" rel="noopener">æµ…è°ˆæµè§ˆå™¨httpçš„ç¼“å­˜æœºåˆ¶</a></li><li><a href="https://segmentfault.com/a/1190000009638800" target="_blank" rel="noopener">Webç¼“å­˜ç›¸å…³çŸ¥è¯†æ•´ç†</a></li><li><a href="http://www.alloyteam.com/2016/03/discussion-on-web-caching/" target="_blank" rel="noopener">æµ…è°ˆWebç¼“å­˜</a></li><li><a href="https://segmentfault.com/a/1190000006741200" target="_blank" rel="noopener">è¯¦è°ˆWebç¼“å­˜</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;æµè§ˆå™¨ç¼“å­˜&lt;/h2&gt;
&lt;p&gt;HTTP ç¼“å­˜é€šå¸¸è¦é…åˆå®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰ä½¿ç”¨æ‰èƒ½å‘æŒ¥æ•ˆæœï¼Œæ‰€ä»¥åˆè¢«ç§°ä¹‹ä¸ºæµè§ˆå™¨ç¼“å­˜ï¼Œæ˜¯ Web æ€§èƒ½ä¼˜åŒ–çš„ä¸€å¤§åˆ©å™¨ã€‚&lt;/p&gt;
&lt;h3&gt;ç¼“å­˜ç±»å‹&lt;/h3&gt;
&lt;p&gt;æµè§ˆå™¨ç¼“å­˜åˆ†ä¸ºå¼ºç¼“å­˜å’Œåå•†ç¼“å­˜ã€‚&lt;/p&gt;
&lt;p&gt;(1) å¼ºç¼“å­˜ï¼šæµè§ˆå™¨åœ¨åŠ è½½èµ„æºçš„æ—¶å€™ï¼Œæ ¹æ®èµ„æºçš„ HTTP Header åˆ¤æ–­å®ƒæ˜¯å¦å‘½ä¸­å¼ºç¼“å­˜ï¼Œå¦‚æœå‘½ä¸­ï¼Œæµè§ˆå™¨ç›´æ¥ä»è‡ªå·±çš„ç¼“å­˜ä¸­è¯»å–èµ„æºï¼Œä¸ä¼šå‘è¯·æ±‚åˆ°æœåŠ¡å™¨ã€‚&lt;/p&gt;
&lt;p&gt;(2) åå•†ç¼“å­˜ï¼šå½“å¼ºç¼“å­˜æ²¡æœ‰å‘½ä¸­çš„æ—¶å€™ï¼Œæµè§ˆå™¨å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼ŒæœåŠ¡å™¨ç«¯ä¾æ®èµ„æºçš„å¦å¤–ä¸€äº›  HTTP Header éªŒè¯è¿™ä¸ªèµ„æºæ˜¯å¦å‘½ä¸­åå•†ç¼“å­˜ï¼Œå¦‚æœåå•†ç¼“å­˜å‘½ä¸­ï¼ŒæœåŠ¡å™¨ä¼šå°†è¿™ä¸ªè¯·æ±‚è¿”å› 304ï¼Œæµè§ˆå™¨ä»ç¼“å­˜ä¸­åŠ è½½è¿™ä¸ªèµ„æºï¼›è‹¥æœªå‘½ä¸­è¯·æ±‚ï¼ŒæœåŠ¡ç«¯è¿”å› 200 å¹¶å°†èµ„æºè¿”å›å®¢æˆ·ç«¯ï¼Œæµè§ˆå™¨æ›´æ–°æœ¬åœ°ç¼“å­˜æ•°æ®ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="æ€§èƒ½" scheme="https://lz5z.com/categories/%E6%80%A7%E8%83%BD/"/>
    
    
      <category term="HTTP" scheme="https://lz5z.com/tags/HTTP/"/>
    
      <category term="Cache" scheme="https://lz5z.com/tags/Cache/"/>
    
  </entry>
  
  <entry>
    <title>Web æ€§èƒ½ä¼˜åŒ–-ç¼“å­˜-DNS ç¼“å­˜</title>
    <link href="https://lz5z.com/Web%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96-DNS%E7%BC%93%E5%AD%98/"/>
    <id>https://lz5z.com/Webæ€§èƒ½ä¼˜åŒ–-DNSç¼“å­˜/</id>
    <published>2018-05-16T13:32:17.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h2>ç¼“å­˜æ¢—æ¦‚</h2><p>ç¼“å­˜æŠ€æœ¯å‡ ä¹å­˜åœ¨äºç½‘ç»œæŠ€æœ¯å‘å±•çš„å„ä¸ªè§’è½ï¼Œä»æ•°æ®åº“åˆ°æœåŠ¡å™¨ï¼Œä»æœåŠ¡å™¨åˆ°ç½‘ç»œï¼Œå†ä»ç½‘ç»œåˆ°å®¢æˆ·ç«¯ï¼Œç¼“å­˜éšå¤„å¯è§ã€‚è·Ÿå‰ç«¯æœ‰å…³çš„ç¼“å­˜æŠ€æœ¯ä¸»è¦æœ‰ï¼šDNS ç¼“å­˜ï¼ŒHTTP ç¼“å­˜ï¼Œæµè§ˆå™¨ç¼“å­˜ï¼ŒHTML5 ç¼“å­˜ï¼ˆlocalhost/manifestï¼‰å’Œ service worker ä¸­çš„ cache apiã€‚</p><h2>DNS ç¼“å­˜</h2><p>å½“ç”¨æˆ·åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ç½‘å€çš„åœ°å€åï¼Œæµè§ˆå™¨è¦åšçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯è§£æ DNSï¼š</p><p>(1) æµè§ˆå™¨æ£€æŸ¥ç¼“å­˜ä¸­æ˜¯å¦æœ‰åŸŸåå¯¹åº”çš„ IPï¼Œå¦‚æœæœ‰å°±ç»“æŸ DNS è§£æè¿‡ç¨‹ã€‚æµè§ˆå™¨ä¸­çš„ DNS ç¼“å­˜æœ‰æ—¶é—´å’Œå¤§å°åŒé‡é™åˆ¶ï¼Œæ—¶é—´ä¸€èˆ¬ä¸ºå‡ åˆ†é’Ÿåˆ°å‡ ä¸ªå°æ—¶ä¸ç­‰ã€‚DNS ç¼“å­˜æ—¶é—´è¿‡é•¿ä¼šå¯¼è‡´å¦‚æœ IP åœ°å€å‘ç”Ÿå˜åŒ–ï¼Œæ— æ³•è§£æåˆ°æ­£ç¡®çš„ IP åœ°å€ï¼›æ—¶é—´è¿‡çŸ­ä¼šå¯¼è‡´æµè§ˆå™¨é‡å¤è§£æåŸŸåã€‚</p><p>(2) å¦‚æœæµè§ˆå™¨ç¼“å­˜ä¸­æ²¡æœ‰å¯¹åº”çš„ IP åœ°å€ï¼Œæµè§ˆå™¨ä¼šç»§ç»­æŸ¥æ‰¾æ“ä½œç³»ç»Ÿç¼“å­˜ä¸­æ˜¯å¦æœ‰åŸŸåå¯¹åº”çš„ DNS è§£æç»“æœã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨æ“ä½œç³»ç»Ÿä¸­è®¾ç½® hosts æ–‡ä»¶æ¥è®¾ç½® IP ä¸åŸŸåçš„å…³ç³»ã€‚</p><a id="more"></a><p>(3) å¦‚æœè¿˜æ²¡æœ‰æ‹¿åˆ°è§£æç»“æœï¼Œæ“ä½œç³»ç»Ÿå°±ä¼šæŠŠåŸŸåå‘é€ç»™æœ¬åœ°åŒºçš„åŸŸåæœåŠ¡å™¨ï¼ˆLDNSï¼‰ï¼ŒLDNS é€šå¸¸ç”±äº’è”ç½‘æœåŠ¡æä¾›å•†ï¼ˆISPï¼‰æä¾›ï¼Œæ¯”å¦‚ç”µä¿¡æˆ–è€…è”é€šã€‚è¿™ä¸ªåŸŸåæœåŠ¡å™¨ä¸€èˆ¬åœ¨åŸå¸‚æŸä¸ªè§’è½ï¼Œå¹¶ä¸”æ€§èƒ½è¾ƒå¥½ï¼Œå½“æ‹¿åˆ°åŸŸååï¼Œé¦–å…ˆä¹Ÿæ˜¯ä»ç¼“å­˜ä¸­æŸ¥æ‰¾ï¼Œçœ‹æ˜¯å¦æœ‰åŒ¹é…çš„ç»“æœã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå¤§å¤šæ•°çš„ DNS è§£æåˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ‰€ä»¥ LDNS/ISP DNS æ‰¿æ‹…äº†å¤§éƒ¨åˆ†çš„åŸŸåè§£æå·¥ä½œã€‚å¦‚æœç¼“å­˜ä¸­æœ‰ IP åœ°å€ï¼Œå°±ç›´æ¥è¿”å›ï¼Œå¹¶ä¸”ä¼šè¢«æ ‡è®°ä¸º<strong>éæƒå¨æœåŠ¡å™¨åº”ç­”</strong>ã€‚</p><blockquote><p>ç¬¬ä¸‰æ­¥æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœç”¨æˆ·åœ¨è‡ªå·±ç”µè„‘é‡Œè®¾ç½®äº† DNSï¼Œæ¯”å¦‚ Google çš„ <code>8.8.8.8</code> æˆ–è€… CloudFlare æ–°å‡ºçš„ <a href="https://blog.cloudflare.com/announcing-1111/" target="_blank" rel="noopener"><code>1.1.1.1</code></a>ï¼Œå°†ä¸ä¼šé€šè¿‡ ISP DNS æœåŠ¡å™¨è§£æã€‚</p></blockquote><p>(4) å¦‚æœå‰é¢ä¸‰æ­¥è¿˜æ²¡æœ‰å‘½ä¸­ DNS ç¼“å­˜ï¼Œé‚£åªèƒ½åˆ° Root Server åŸŸåæœåŠ¡å™¨ä¸­è¯·æ±‚è§£æäº†ã€‚æ ¹åŸŸåæœåŠ¡å™¨æ‹¿åˆ°è¯·æ±‚åï¼Œé¦–å…ˆåˆ¤æ–­åŸŸåæ˜¯å“ªä¸ªé¡¶çº§åŸŸåä¸‹çš„ï¼Œæ¯”å¦‚ <code>.com</code>, <code>.cn</code>, <code>.org</code> ç­‰ï¼Œå…¨çƒä¸€å…± 13 å°é¡¶çº§åŸŸåæœåŠ¡å™¨ã€‚æ ¹åŸŸåæœåŠ¡å™¨è¿”å›å¯¹åº”çš„é¡¶çº§åŸŸåæœåŠ¡å™¨ï¼ˆgTLD Serverï¼‰åœ°å€ã€‚</p><p>(5) æœ¬åœ°åŸŸåæœåŠ¡å™¨ï¼ˆLDNSï¼‰æ‹¿åˆ°åœ°å€åï¼Œå‘ gTLD Server å‘é€è¯·æ±‚ï¼ŒgTLD æœåŠ¡å™¨æŸ¥æ‰¾å¹¶ä¸”è¿”å›æ­¤åŸŸåå¯¹åº”çš„ Name Server åŸŸåæœåŠ¡å™¨åœ°å€ã€‚è¿™ä¸ª Name Server é€šå¸¸å°±æ˜¯ç”¨æˆ·æ³¨å†Œçš„åŸŸåæœåŠ¡å™¨ï¼Œä¾‹å¦‚ç”¨æˆ·åœ¨æŸä¸ªåŸŸåæœåŠ¡æä¾›å•†ç”³è¯·çš„åŸŸåï¼Œé‚£ä¹ˆè¿™ä¸ªåŸŸåè§£æä»»åŠ¡å°±ç”±è¿™ä¸ªåŸŸåæä¾›å•†çš„æœåŠ¡å™¨æ¥å®Œæˆã€‚</p><blockquote><p>è¿™ä¸ªè¿‡ç¨‹çš„è§£ææ–¹å¼ä¸ºé€’å½’æœç´¢ã€‚æ¯”å¦‚ï¼š<code>https://movie.lz5z.com</code>ï¼Œæœ¬åœ°åŸŸåæœåŠ¡å™¨é¦–å…ˆå‘é¡¶çº§åŸŸåæœåŠ¡å™¨ï¼ˆcom åŸŸï¼‰å‘é€è¯·æ±‚ï¼Œcom åŸŸåæœåŠ¡å™¨å°†åŸŸåä¸­çš„äºŒçº§åŸŸ <code>lz5z</code> çš„ IP åœ°å€è¿”å›ç»™ LDNSï¼ŒLDNS å†å‘äºŒçº§åŸŸåæœåŠ¡å™¨å‘é€è¯·æ±‚è¿›è¡ŒæŸ¥è¯¢ï¼Œä¹‹åä¸æ–­é‡å¤ç›´åˆ° LDNS å¾—åˆ°æœ€ç»ˆçš„æŸ¥è¯¢ç»“æœã€‚</p></blockquote><p>(6) Name Server åŸŸåæœåŠ¡å™¨ä¼šæŸ¥è¯¢å­˜å‚¨çš„åŸŸåå’Œ IP çš„æ˜ å°„å…³ç³»è¡¨ï¼Œåœ¨æ­£å¸¸æƒ…å†µä¸‹éƒ½æ ¹æ®åŸŸåå¾—åˆ°ç›®æ ‡ IP åœ°å€ï¼Œè¿åŒä¸€ä¸ª TTL å€¼è¿”å›ç»™ LDNSã€‚LDNS ä¼šç¼“å­˜è¿™ä¸ªåŸŸåå’Œ IP çš„å¯¹åº”å…³ç³»ï¼Œç¼“å­˜æ—¶é—´ç”± TTL å€¼æ§åˆ¶ã€‚LDNS ä¼šæŠŠè§£æç»“æœè¿”å›ç»™ç”¨æˆ·ï¼ŒDNS è§£æç»“æŸã€‚</p><h3>æ¸…é™¤ DNS ç¼“å­˜</h3><p>(1) chrome: <code>chrome://net-internals/#dns</code><br>(2) æœ¬åœ° DNS ï¼šWindows: <code>ipconfig /flushdns</code>; Linux å’Œ mac æ ¹æ®ä¸åŒçš„ç‰ˆæœ¬æœ‰ä¸åŒçš„æ–¹å¼</p><h3>å‡å°‘ DNS è§£ææˆ‘ä»¬èƒ½åšä»€ä¹ˆï¼Ÿ</h3><p>(1) å‡å°‘ DNS æŸ¥è¯¢ï¼Œé¿å…é‡å®šå‘ã€‚<br>(2) DNS é¢„è§£æï¼š</p><ul><li>å¯ä»¥é€šè¿‡ meta ä¿¡æ¯å‘Šè¯‰æµè§ˆå™¨ï¼Œé¡µé¢éœ€è¦åš DNS é¢„è§£æã€‚</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"x-dns-prefetch-control"</span> <span class="attr">content</span>=<span class="string">"on"</span> /&gt;</span></span><br></pre></td></tr></table></figure><ul><li>é€šè¿‡ link æ ‡ç­¾å¼ºåˆ¶ DNS é¢„è§£æ</li></ul><pre><code class="language-html">&lt;link rel=&quot;dns-prefetch&quot; href=&quot;https://lz5z.com&quot; /&gt;</code></pre><p>(3) åŸŸåå‘æ•£/åŸŸåæ”¶æ•›</p><ul><li>åŸŸåå‘æ•£</li></ul><p>PC ç«¯å› ä¸ºæµè§ˆå™¨æœ‰åŸŸåå¹¶å‘è¯·æ±‚é™åˆ¶ï¼ˆchrome ä¸º 6 ä¸ªï¼‰ï¼Œä¹Ÿå°±æ˜¯åŒä¸€æ—¶é—´ï¼Œæµè§ˆå™¨æœ€å¤šå‘åŒä¸€ä¸ªåŸŸåå‘é€ 6 ä¸ªè¯·æ±‚ï¼Œå› æ­¤ PC ç«¯ä½¿ç”¨åŸŸåå‘æ•£ç­–ç•¥ï¼Œå°† http é™æ€èµ„æºæ”¾å…¥å¤šä¸ªåŸŸå/å­åŸŸåä¸­ï¼Œä»¥ä¿è¯èµ„æºæ›´å¿«åŠ è½½ã€‚å¸¸è§çš„åŠæ³•ä¸ºä½¿ç”¨ cdnã€‚</p><ul><li>åŸŸåæ”¶æ•›</li></ul><p>å°†é™æ€èµ„æºæ”¾åœ¨åŒä¸€ä¸ªåŸŸåä¸‹ï¼Œå‡å°‘ DNS è§£æçš„å¼€é”€ã€‚åŸŸåæ”¶æ•›æ˜¯ç§»åŠ¨äº’è”ç½‘æ—¶ä»£çš„äº§ç‰©ï¼Œåœ¨ LDNS æ²¡æœ‰ç¼“å­˜çš„æƒ…å†µä¸‹ï¼ŒDNS è§£æå æ®ä¸€ä¸ªè¯·æ±‚çš„å¤§å¤šæ•°æ—¶é—´ï¼Œå› æ­¤ï¼Œé‡‡ç”¨å°½å¯èƒ½å°‘çš„åŸŸåå¯¹æ•´ä¸ªé¡µé¢åŠ è½½é€Ÿåº¦æœ‰æ˜¾è‘—çš„æé«˜ã€‚</p><p>(4) HttpDNS</p><p>DNS è¯·æ±‚ä½¿ç”¨çš„æ˜¯ UDP åè®®ï¼Œè™½ç„¶æ²¡æœ‰ TCP ä¸‰æ¬¡æ¡æ‰‹çš„å¼€é”€ï¼Œä½†æ˜¯å¯èƒ½å¯¼è‡´å¼±ç½‘ç¯å¢ƒä¸‹ï¼ˆ2Gï¼Œ3Gï¼‰æ•°æ®ä¸¢å¤±çš„é—®é¢˜ã€‚è¿˜è®°å¾—ä¹‹å‰<a href="https://lz5z.com/Web%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96-%E9%A1%B5%E9%9D%A2%E9%87%8D%E7%BB%98%E5%92%8C%E5%9B%9E%E6%B5%81/">Web æ€§èƒ½ä¼˜åŒ–-é¡µé¢é‡ç»˜å’Œå›æµï¼ˆé‡æ’ï¼‰</a>ä¸­æåˆ°çš„ Google 1s ç»ˆç«¯é¦–å±æ¸²æŸ“æ ‡å‡†ï¼Œå‡å¦‚ DNS è§£æå‡ºç°é—®é¢˜ï¼Œé‚£å¯èƒ½å‡ ç§’ç”šè‡³å‡ åç§’éƒ½é¦–å±ä¸äº†äº†ã€‚è€Œä¸”å›½å†…ç‰› X çš„è¿è¥å•†çš„å“è´¨ä½ ä¹Ÿæ˜¯çŸ¥é“çš„ï¼Œéšä¾¿åŠ«æŒä¸€ä¸‹ DNS å°±è®©ä½ çš„ web åº”ç”¨ä¸è§å¤©æ—¥ã€‚</p><p>ä¸ºäº†åº”å¯¹ä»¥ä¸Šä¸¤ä¸ªé—®é¢˜ï¼ŒHttpDNS åº”è¿è€Œç”Ÿï¼ŒåŸç†ä¹Ÿéå¸¸ç®€å•ï¼Œå°† DNS è¿™ç§å®¹æ˜“è¢«åŠ«æŒçš„åè®®ï¼Œè½¬è€Œä½¿ç”¨ HTTP åè®®è¯·æ±‚ Domain ä¸ IP åœ°å€ä¹‹é—´çš„æ˜ å°„ã€‚è·å¾—æ­£ç¡®çš„ IP åœ°å€åï¼Œå°±ä¸ç”¨æ‹…å¿ƒ ISP ç¯¡æ”¹æ•°æ®äº†ã€‚</p><p>å›½å†…è…¾è®¯äº‘å’Œé˜¿é‡Œäº‘éƒ½æœ‰ç›¸åº”çš„è§£å†³æ–¹æ¡ˆ</p><ul><li><a href="https://cloud.tencent.com/product/hd" target="_blank" rel="noopener">ç§»åŠ¨è§£æHttpDNS</a></li><li><a href="https://cn.aliyun.com/product/httpdns" target="_blank" rel="noopener">HTTPDNS</a></li></ul><p>Google çš„æ–¹æ¡ˆåˆ™æ›´è¿‘ä¸€æ­¥ï¼Œä½¿ç”¨ https åè®®ã€‚</p><ul><li><a href="https://developers.google.com/speed/public-dns/docs/dns-over-https" target="_blank" rel="noopener">DNS-over-HTTPS</a></li></ul><h2>å‚è€ƒèµ„æ–™</h2><ul><li><a href="http://www.cnblogs.com/xrq730/p/4931418.html" target="_blank" rel="noopener">DNSåŸŸåè§£æè¿‡ç¨‹</a></li><li><a href="http://taobaofed.org/blog/2015/12/16/h5-performance-optimization-and-domain-convergence/" target="_blank" rel="noopener">æ— çº¿æ€§èƒ½ä¼˜åŒ–ï¼šåŸŸåæ”¶æ•›</a></li><li><a href="https://www.cloudxns.net/Support/detail/id/1273.html" target="_blank" rel="noopener">æå‡é¡µé¢è®¿é—®é€Ÿåº¦çš„å‰ç«¯ä¼˜åŒ–å¤§æ³•ï¼šDNSé¢„è§£æ</a></li><li><a href="https://www.jianshu.com/p/6c790b9652a2" target="_blank" rel="noopener">ä¹Ÿè°ˆ HTTPS - HTTPDNS + HTTPS</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;ç¼“å­˜æ¢—æ¦‚&lt;/h2&gt;
&lt;p&gt;ç¼“å­˜æŠ€æœ¯å‡ ä¹å­˜åœ¨äºç½‘ç»œæŠ€æœ¯å‘å±•çš„å„ä¸ªè§’è½ï¼Œä»æ•°æ®åº“åˆ°æœåŠ¡å™¨ï¼Œä»æœåŠ¡å™¨åˆ°ç½‘ç»œï¼Œå†ä»ç½‘ç»œåˆ°å®¢æˆ·ç«¯ï¼Œç¼“å­˜éšå¤„å¯è§ã€‚è·Ÿå‰ç«¯æœ‰å…³çš„ç¼“å­˜æŠ€æœ¯ä¸»è¦æœ‰ï¼šDNS ç¼“å­˜ï¼ŒHTTP ç¼“å­˜ï¼Œæµè§ˆå™¨ç¼“å­˜ï¼ŒHTML5 ç¼“å­˜ï¼ˆlocalhost/manifestï¼‰å’Œ service worker ä¸­çš„ cache apiã€‚&lt;/p&gt;
&lt;h2&gt;DNS ç¼“å­˜&lt;/h2&gt;
&lt;p&gt;å½“ç”¨æˆ·åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ç½‘å€çš„åœ°å€åï¼Œæµè§ˆå™¨è¦åšçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯è§£æ DNSï¼š&lt;/p&gt;
&lt;p&gt;(1) æµè§ˆå™¨æ£€æŸ¥ç¼“å­˜ä¸­æ˜¯å¦æœ‰åŸŸåå¯¹åº”çš„ IPï¼Œå¦‚æœæœ‰å°±ç»“æŸ DNS è§£æè¿‡ç¨‹ã€‚æµè§ˆå™¨ä¸­çš„ DNS ç¼“å­˜æœ‰æ—¶é—´å’Œå¤§å°åŒé‡é™åˆ¶ï¼Œæ—¶é—´ä¸€èˆ¬ä¸ºå‡ åˆ†é’Ÿåˆ°å‡ ä¸ªå°æ—¶ä¸ç­‰ã€‚DNS ç¼“å­˜æ—¶é—´è¿‡é•¿ä¼šå¯¼è‡´å¦‚æœ IP åœ°å€å‘ç”Ÿå˜åŒ–ï¼Œæ— æ³•è§£æåˆ°æ­£ç¡®çš„ IP åœ°å€ï¼›æ—¶é—´è¿‡çŸ­ä¼šå¯¼è‡´æµè§ˆå™¨é‡å¤è§£æåŸŸåã€‚&lt;/p&gt;
&lt;p&gt;(2) å¦‚æœæµè§ˆå™¨ç¼“å­˜ä¸­æ²¡æœ‰å¯¹åº”çš„ IP åœ°å€ï¼Œæµè§ˆå™¨ä¼šç»§ç»­æŸ¥æ‰¾æ“ä½œç³»ç»Ÿç¼“å­˜ä¸­æ˜¯å¦æœ‰åŸŸåå¯¹åº”çš„ DNS è§£æç»“æœã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨æ“ä½œç³»ç»Ÿä¸­è®¾ç½® hosts æ–‡ä»¶æ¥è®¾ç½® IP ä¸åŸŸåçš„å…³ç³»ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="æ€§èƒ½" scheme="https://lz5z.com/categories/%E6%80%A7%E8%83%BD/"/>
    
    
      <category term="DNS" scheme="https://lz5z.com/tags/DNS/"/>
    
      <category term="HttpDNS" scheme="https://lz5z.com/tags/HttpDNS/"/>
    
      <category term="LDNS" scheme="https://lz5z.com/tags/LDNS/"/>
    
  </entry>
  
  <entry>
    <title>Web æ€§èƒ½ä¼˜åŒ–-CSS3 ç¡¬ä»¶åŠ é€Ÿ(GPU åŠ é€Ÿ)</title>
    <link href="https://lz5z.com/Web%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96-CSS3%E7%A1%AC%E4%BB%B6%E5%8A%A0%E9%80%9F/"/>
    <id>https://lz5z.com/Webæ€§èƒ½ä¼˜åŒ–-CSS3ç¡¬ä»¶åŠ é€Ÿ/</id>
    <published>2018-05-03T20:10:40.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h2>CSS3 ç¡¬ä»¶åŠ é€Ÿç®€ä»‹</h2><p>ä¸Šä¸€ç¯‡æ–‡ç« å­¦ä¹ äº†é‡ç»˜å’Œå›æµå¯¹é¡µé¢æ€§èƒ½çš„å½±å“ï¼Œæ˜¯ä»æ¯”è¾ƒå®è§‚çš„è§’åº¦å»ä¼˜åŒ– Web æ€§èƒ½ï¼Œæœ¬ç¯‡æ–‡ç« ä»æ¯ä¸€å¸§çš„å¾®è§‚è§’åº¦è¿›è¡Œåˆ†æï¼Œæ¥å­¦ä¹  CSS3 ç¡¬ä»¶åŠ é€Ÿçš„çŸ¥è¯†ã€‚</p><p>CSS3 ç¡¬ä»¶åŠ é€Ÿåˆå«åš GPU åŠ é€Ÿï¼Œæ˜¯åˆ©ç”¨ GPU è¿›è¡Œæ¸²æŸ“ï¼Œå‡å°‘ CPU æ“ä½œçš„ä¸€ç§ä¼˜åŒ–æ–¹æ¡ˆã€‚ç”±äº GPU ä¸­çš„ transform ç­‰ CSS å±æ€§ä¸ä¼šè§¦å‘ repaintï¼Œæ‰€ä»¥èƒ½å¤§å¤§æé«˜ç½‘é¡µçš„æ€§èƒ½ã€‚</p><p>æˆ‘åšäº†ä¸€ä¸ªé¡µé¢ï¼Œå·¦è¾¹å…ƒç´ çš„åŠ¨ç”»é€šè¿‡ left/top æ“ä½œä½ç½®å®ç°ï¼Œå³è¾¹å…ƒç´ çš„åŠ¨ç”»é€šè¿‡ <code>transform: translate</code> å®ç°ï¼Œä½ å¯ä»¥æ‰“å¼€ chrome çš„ â€œPaint flashingâ€ æŸ¥çœ‹ï¼Œç»¿è‰²éƒ¨åˆ†æ˜¯æ­£åœ¨ repaint çš„å†…å®¹ã€‚</p><p><a href="https://lz5z.com/css3_hardware_speedup/">æŸ¥çœ‹åœ°å€</a></p><p>ä» demo ä¸­å¯ä»¥çœ‹åˆ°å·¦è¾¹çš„å›¾å½¢åœ¨è¿åŠ¨æ—¶å¤–å±‚æœ‰ä¸€åœˆç»¿è‰²çš„è¾¹æ¡†ï¼Œè¡¨ç¤ºå…ƒç´ ä¸åœåœ° repaintï¼Œå¹¶ä¸”å¯ä»¥çœ‹åˆ°å…¶è¿åŠ¨è¿‡ç¨‹ä¸­æœ‰ä¸¢å¸§ç°è±¡ï¼Œå…·ä½“è¡¨ç°ä¸ºè¿åŠ¨ä¸è¿è´¯ï¼Œæœ‰è½»å¾®é—ªåŠ¨ã€‚</p><a id="more"></a><h3>åŠ¨ç”»ä¸å¸§</h3><p>ä¹‹å‰å­¦ä¹  flash çš„æ—¶å€™ï¼Œå°±çŸ¥é“åŠ¨ç”»æ˜¯ç”±ä¸€å¸§ä¸€å¸§çš„å›¾ç‰‡ç»„æˆï¼Œåœ¨æµè§ˆå™¨ä¸­ä¹Ÿæ˜¯å¦‚æ­¤ã€‚æˆ‘ä»¬é¦–å…ˆçœ‹ä¸€ä¸‹ï¼Œæµè§ˆå™¨æ¯ä¸€å¸§éƒ½åšäº†ä»€ä¹ˆã€‚</p><img src="/assets/img/css3_gpu_speedup.png" alt="css3_gpu_speedup" style="max-height: : 66px"><blockquote><ol><li>JavaScriptï¼šJavaScript å®ç°åŠ¨ç”»æ•ˆæœï¼ŒDOM å…ƒç´ æ“ä½œç­‰ã€‚</li><li>Styleï¼ˆè®¡ç®—æ ·å¼ï¼‰ï¼šç¡®å®šæ¯ä¸ª DOM å…ƒç´ åº”è¯¥åº”ç”¨ä»€ä¹ˆ CSS è§„åˆ™ã€‚</li><li>Layoutï¼ˆå¸ƒå±€ï¼‰ï¼šè®¡ç®—æ¯ä¸ª DOM å…ƒç´ åœ¨æœ€ç»ˆå±å¹•ä¸Šæ˜¾ç¤ºçš„å¤§å°å’Œä½ç½®ã€‚ç”±äº web é¡µé¢çš„å…ƒç´ å¸ƒå±€æ˜¯ç›¸å¯¹çš„ï¼Œæ‰€ä»¥å…¶ä¸­ä»»æ„ä¸€ä¸ªå…ƒç´ çš„ä½ç½®å‘ç”Ÿå˜åŒ–ï¼Œéƒ½ä¼šè”åŠ¨çš„å¼•èµ·å…¶ä»–å…ƒç´ å‘ç”Ÿå˜åŒ–ï¼Œè¿™ä¸ªè¿‡ç¨‹å« reflowã€‚</li><li>Paintï¼ˆç»˜åˆ¶ï¼‰ï¼šåœ¨å¤šä¸ªå±‚ä¸Šç»˜åˆ¶ DOM å…ƒç´ çš„çš„æ–‡å­—ã€é¢œè‰²ã€å›¾åƒã€è¾¹æ¡†å’Œé˜´å½±ç­‰ã€‚</li><li>Compositeï¼ˆæ¸²æŸ“å±‚åˆå¹¶ï¼‰ï¼šæŒ‰ç…§åˆç†çš„é¡ºåºåˆå¹¶å›¾å±‚ç„¶åæ˜¾ç¤ºåˆ°å±å¹•ä¸Šã€‚</li></ol></blockquote><h3>åŠ¨ç”»ä¸å›¾å±‚</h3><p>æµè§ˆå™¨åœ¨è·å– render treeï¼ˆè¯¦ç»†çŸ¥è¯†å¯ä»¥æŸ¥çœ‹<a href="https://lz5z.com/Web%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96-%E9%A1%B5%E9%9D%A2%E9%87%8D%E7%BB%98%E5%92%8C%E5%9B%9E%E6%B5%81/">Webæ€§èƒ½ä¼˜åŒ–-é¡µé¢é‡ç»˜å’Œå›æµï¼ˆé‡æ’ï¼‰</a>ï¼‰åï¼Œæ¸²æŸ“æ ‘ä¸­åŒ…å«äº†å¤§é‡çš„æ¸²æŸ“å…ƒç´ ï¼Œæ¯ä¸€ä¸ªæ¸²æŸ“å…ƒç´ ä¼šè¢«åˆ†åˆ°ä¸€ä¸ªå›¾å±‚ä¸­ï¼Œæ¯ä¸ªå›¾å±‚åˆä¼šè¢«åŠ è½½åˆ° GPU å½¢æˆæ¸²æŸ“çº¹ç†ã€‚GPU ä¸­ transform æ˜¯ä¸ä¼šè§¦å‘ repaint çš„ï¼Œè¿™ä¸€ç‚¹éå¸¸ç±»ä¼¼ 3D ç»˜å›¾åŠŸèƒ½ï¼Œæœ€ç»ˆè¿™äº›ä½¿ç”¨ transform çš„å›¾å±‚éƒ½ä¼šç”±ç‹¬ç«‹çš„åˆæˆå™¨è¿›ç¨‹è¿›è¡Œå¤„ç†ã€‚</p><p>è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><p>render tree -&gt; æ¸²æŸ“å…ƒç´  -&gt; å›¾å±‚ -&gt; GPU æ¸²æŸ“ -&gt; æµè§ˆå™¨å¤åˆå›¾å±‚ -&gt; ç”Ÿæˆæœ€ç»ˆçš„å±å¹•å›¾åƒã€‚</p><blockquote><p>TIPS: chrome devtools ä¸­å¯ä»¥å¼€å¯ Rendering ä¸­çš„ Layer borders æŸ¥çœ‹å›¾å±‚çº¹ç†ã€‚<br>å…¶ä¸­é»„è‰²è¾¹æ¡†è¡¨ç¤ºè¯¥å…ƒç´ æœ‰ 3d å˜æ¢ï¼Œè¡¨ç¤ºæ”¾åˆ°ä¸€ä¸ªæ–°çš„å¤åˆå±‚ï¼ˆcomposited layerï¼‰ä¸­æ¸²æŸ“ï¼Œè“è‰²æ …æ ¼è¡¨ç¤ºæ­£å¸¸çš„ render layerã€‚</p></blockquote><p>åœ¨æ–‡ç« å¼€å§‹ç»™å‡ºçš„<a href="https://lz5z.com/css3_hardware_speedup/">ä¾‹å­</a>ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å¼€å¯ Layer bordersï¼Œå¯ä»¥è§‚å¯Ÿåˆ°ï¼Œä½¿ç”¨ <code>transform: translate</code> åŠ¨ç”»çš„å…ƒç´ ï¼Œå¤–å›´æœ‰ä¸€ä¸ªé»„è‰²çš„è¾¹æ¡†ï¼Œå¯çŸ¥å…¶ä¸ºå¤åˆå±‚ã€‚</p><img src="/assets/img/css3_gpu_lauer_borders.png" alt="css3_gpu_lauer_borders"><p>åœ¨ GPU æ¸²æŸ“çš„è¿‡ç¨‹ä¸­ï¼Œä¸€äº›å…ƒç´ ä¼šå› ä¸ºç¬¦åˆäº†æŸäº›è§„åˆ™ï¼Œè€Œè¢«æå‡ä¸ºç‹¬ç«‹çš„å±‚ï¼ˆé»„è‰²è¾¹æ¡†éƒ¨åˆ†ï¼‰ï¼Œä¸€æ—¦ç‹¬ç«‹å‡ºæ¥ï¼Œå°±ä¸ä¼šå½±å“å…¶å®ƒ DOM çš„å¸ƒå±€ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™äº›è§„åˆ™ï¼Œå°†ç»å¸¸å˜æ¢çš„ DOM ä¸»åŠ¨æå‡åˆ°ç‹¬ç«‹çš„å±‚ï¼Œé‚£ä¹ˆåœ¨æµè§ˆå™¨çš„ä¸€å¸§è¿è¡Œä¸­ï¼Œå°±å¯ä»¥å‡å°‘ Layout å’Œ Paint çš„æ—¶é—´äº†ã€‚</p><h3>åˆ›å»ºç‹¬ç«‹å›¾å±‚</h3><p>å“ªäº›è§„åˆ™èƒ½è®©æµè§ˆå™¨ä¸»åŠ¨å¸®æˆ‘ä»¬åˆ›å»ºç‹¬ç«‹çš„å±‚å‘¢ï¼Ÿ</p><ol><li>3D æˆ–è€…é€è§†å˜æ¢ï¼ˆperspectiveï¼Œtransformï¼‰ çš„ CSS å±æ€§ã€‚</li><li>ä½¿ç”¨åŠ é€Ÿè§†é¢‘è§£ç çš„ video å…ƒç´ ã€‚</li><li>æ‹¥æœ‰ 3Dï¼ˆWebGLï¼‰ ä¸Šä¸‹æ–‡æˆ–è€…åŠ é€Ÿ 2D ä¸Šä¸‹æ–‡çš„ canvas å…ƒç´ ã€‚</li><li>æ··åˆæ’ä»¶ï¼ˆFlash)ã€‚</li><li>å¯¹è‡ªå·±çš„ opacity åš CSS åŠ¨ç”»æˆ–ä½¿ç”¨ä¸€ä¸ªåŠ¨ç”» webkit å˜æ¢çš„å…ƒç´ ã€‚</li><li>æ‹¥æœ‰åŠ é€Ÿ CSS è¿‡æ»¤å™¨çš„å…ƒç´ ã€‚</li><li>å…ƒç´ æœ‰ä¸€ä¸ªåŒ…å«å¤åˆå±‚çš„åä»£èŠ‚ç‚¹(æ¢å¥è¯è¯´ï¼Œå°±æ˜¯ä¸€ä¸ªå…ƒç´ æ‹¥æœ‰ä¸€ä¸ªå­å…ƒç´ ï¼Œè¯¥å­å…ƒç´ åœ¨è‡ªå·±çš„å±‚é‡Œ)ã€‚</li><li>å…ƒç´ æœ‰ä¸€ä¸ªå…„å¼Ÿå…ƒç´ åœ¨å¤åˆå›¾å±‚æ¸²æŸ“ï¼Œå¹¶ä¸”è¯¥å…„å¼Ÿå…ƒç´ çš„ z-index è¾ƒå°ï¼Œé‚£è¿™ä¸ªå…ƒç´ ä¹Ÿä¼šè¢«åº”ç”¨åˆ°å¤åˆå›¾å±‚ã€‚</li></ol><p>å…³äº z-index å¯¼è‡´çš„ç¡¬ä»¶åŠ é€Ÿçš„é—®é¢˜ï¼Œå¯ä»¥æŸ¥çœ‹è¿™ç¯‡æ–‡ç«  <a href="http://div.io/topic/1348" target="_blank" rel="noopener">CSS3ç¡¬ä»¶åŠ é€Ÿä¹Ÿæœ‰å‘ï¼ï¼</a></p><h3>å¼€å¯ GPU åŠ é€Ÿ</h3><p>CSS ä¸­çš„ä»¥ä¸‹å‡ ä¸ªå±æ€§èƒ½è§¦å‘ç¡¬ä»¶åŠ é€Ÿï¼š</p><ol><li>transform</li><li>opacity</li><li>filter</li><li>will-change</li></ol><p>å¦‚æœæœ‰ä¸€äº›å…ƒç´ ä¸éœ€è¦ç”¨åˆ°ä¸Šè¿°å±æ€§ï¼Œä½†æ˜¯éœ€è¦è§¦å‘ç¡¬ä»¶åŠ é€Ÿæ•ˆæœï¼Œå¯ä»¥ä½¿ç”¨ä¸€äº›å°æŠ€å·§æ¥è¯±å¯¼æµè§ˆå™¨å¼€å¯ç¡¬ä»¶åŠ é€Ÿã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.element</span> &#123;</span><br><span class="line">    <span class="attribute">-webkit-transform</span>: <span class="built_in">translateZ</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="attribute">-moz-transform</span>: <span class="built_in">translateZ</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="attribute">-ms-transform</span>: <span class="built_in">translateZ</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="attribute">-o-transform</span>: <span class="built_in">translateZ</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateZ</span>(<span class="number">0</span>); </span><br><span class="line">    <span class="comment">/**æˆ–è€…**/</span></span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotateZ</span>(<span class="number">360deg</span>);</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šæˆ‘åœ¨ä¸åŒçš„èµ„æ–™ä¸­æŸ¥åˆ°çš„ transform æ˜¯å¦èƒ½è§¦å‘ç¡¬ä»¶åŠ é€Ÿçš„ç»“æœä¸åŒï¼Œè‡ªå·±æµ‹è¯•åï¼Œå‘ç°ç»“æœæ˜¯å¯ä»¥ã€‚</p><h3>è¦æ³¨æ„çš„é—®é¢˜</h3><p>ï¼ˆ1ï¼‰è¿‡å¤šåœ°å¼€å¯ç¡¬ä»¶åŠ é€Ÿå¯èƒ½ä¼šè€—è´¹è¾ƒå¤šçš„å†…å­˜ï¼Œå› æ­¤ä»€ä¹ˆæ—¶å€™å¼€å¯ç¡¬ä»¶åŠ é€Ÿï¼Œç»™å¤šå°‘å…ƒç´ å¼€å¯ç¡¬ä»¶åŠ é€Ÿï¼Œéœ€è¦ç”¨æµ‹è¯•ç»“æœè¯´è¯ã€‚<br>ï¼ˆ2ï¼‰GPU æ¸²æŸ“ä¼šå½±å“å­—ä½“çš„æŠ—é”¯é½¿æ•ˆæœã€‚è¿™æ˜¯å› ä¸º GPU å’Œ CPU å…·æœ‰ä¸åŒçš„æ¸²æŸ“æœºåˆ¶ï¼Œå³ä½¿æœ€ç»ˆç¡¬ä»¶åŠ é€Ÿåœæ­¢äº†ï¼Œæ–‡æœ¬è¿˜æ˜¯ä¼šåœ¨åŠ¨ç”»æœŸé—´æ˜¾ç¤ºå¾—å¾ˆæ¨¡ç³Šã€‚</p><h2>å‚è€ƒæ–‡ç« </h2><ul><li><a href="http://blog.teamtreehouse.com/increase-your-sites-performance-with-hardware-accelerated-css" target="_blank" rel="noopener">Increase Your Siteâ€™s Performance with Hardware-Accelerated CSS</a></li><li><a href="http://www.cnblogs.com/rubylouvre/p/3471490.html" target="_blank" rel="noopener">ç”¨CSSå¼€å¯ç¡¬ä»¶åŠ é€Ÿæ¥æé«˜ç½‘ç«™æ€§èƒ½</a></li><li><a href="https://www.jianshu.com/p/f8b1d6e598db" target="_blank" rel="noopener">css3ç¡¬ä»¶åŠ é€Ÿ</a></li><li><a href="http://div.io/topic/1348" target="_blank" rel="noopener">CSS3ç¡¬ä»¶åŠ é€Ÿä¹Ÿæœ‰å‘ï¼ï¼</a></li><li><a href="https://aotu.io/notes/2017/04/11/GPU/index.html" target="_blank" rel="noopener">GPUåŠ é€Ÿæ˜¯ä»€ä¹ˆ</a></li><li><a href="http://www.zhangxinxu.com/wordpress/2015/11/css3-will-change-improve-paint/" target="_blank" rel="noopener">ä½¿ç”¨CSS3 will-changeæé«˜é¡µé¢æ»šåŠ¨ã€åŠ¨ç”»ç­‰æ¸²æŸ“æ€§èƒ½</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;CSS3 ç¡¬ä»¶åŠ é€Ÿç®€ä»‹&lt;/h2&gt;
&lt;p&gt;ä¸Šä¸€ç¯‡æ–‡ç« å­¦ä¹ äº†é‡ç»˜å’Œå›æµå¯¹é¡µé¢æ€§èƒ½çš„å½±å“ï¼Œæ˜¯ä»æ¯”è¾ƒå®è§‚çš„è§’åº¦å»ä¼˜åŒ– Web æ€§èƒ½ï¼Œæœ¬ç¯‡æ–‡ç« ä»æ¯ä¸€å¸§çš„å¾®è§‚è§’åº¦è¿›è¡Œåˆ†æï¼Œæ¥å­¦ä¹  CSS3 ç¡¬ä»¶åŠ é€Ÿçš„çŸ¥è¯†ã€‚&lt;/p&gt;
&lt;p&gt;CSS3 ç¡¬ä»¶åŠ é€Ÿåˆå«åš GPU åŠ é€Ÿï¼Œæ˜¯åˆ©ç”¨ GPU è¿›è¡Œæ¸²æŸ“ï¼Œå‡å°‘ CPU æ“ä½œçš„ä¸€ç§ä¼˜åŒ–æ–¹æ¡ˆã€‚ç”±äº GPU ä¸­çš„ transform ç­‰ CSS å±æ€§ä¸ä¼šè§¦å‘ repaintï¼Œæ‰€ä»¥èƒ½å¤§å¤§æé«˜ç½‘é¡µçš„æ€§èƒ½ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘åšäº†ä¸€ä¸ªé¡µé¢ï¼Œå·¦è¾¹å…ƒç´ çš„åŠ¨ç”»é€šè¿‡ left/top æ“ä½œä½ç½®å®ç°ï¼Œå³è¾¹å…ƒç´ çš„åŠ¨ç”»é€šè¿‡ &lt;code&gt;transform: translate&lt;/code&gt; å®ç°ï¼Œä½ å¯ä»¥æ‰“å¼€ chrome çš„ â€œPaint flashingâ€ æŸ¥çœ‹ï¼Œç»¿è‰²éƒ¨åˆ†æ˜¯æ­£åœ¨ repaint çš„å†…å®¹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://lz5z.com/css3_hardware_speedup/&quot;&gt;æŸ¥çœ‹åœ°å€&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä» demo ä¸­å¯ä»¥çœ‹åˆ°å·¦è¾¹çš„å›¾å½¢åœ¨è¿åŠ¨æ—¶å¤–å±‚æœ‰ä¸€åœˆç»¿è‰²çš„è¾¹æ¡†ï¼Œè¡¨ç¤ºå…ƒç´ ä¸åœåœ° repaintï¼Œå¹¶ä¸”å¯ä»¥çœ‹åˆ°å…¶è¿åŠ¨è¿‡ç¨‹ä¸­æœ‰ä¸¢å¸§ç°è±¡ï¼Œå…·ä½“è¡¨ç°ä¸ºè¿åŠ¨ä¸è¿è´¯ï¼Œæœ‰è½»å¾®é—ªåŠ¨ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="æ€§èƒ½" scheme="https://lz5z.com/categories/%E6%80%A7%E8%83%BD/"/>
    
    
      <category term="åŠ¨ç”»" scheme="https://lz5z.com/tags/%E5%8A%A8%E7%94%BB/"/>
    
      <category term="CSS" scheme="https://lz5z.com/tags/CSS/"/>
    
      <category term="GPU" scheme="https://lz5z.com/tags/GPU/"/>
    
  </entry>
  
  <entry>
    <title>Web æ€§èƒ½ä¼˜åŒ–-é¡µé¢é‡ç»˜å’Œå›æµï¼ˆé‡æ’ï¼‰</title>
    <link href="https://lz5z.com/Web%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96-%E9%A1%B5%E9%9D%A2%E9%87%8D%E7%BB%98%E5%92%8C%E5%9B%9E%E6%B5%81/"/>
    <id>https://lz5z.com/Webæ€§èƒ½ä¼˜åŒ–-é¡µé¢é‡ç»˜å’Œå›æµ/</id>
    <published>2018-05-02T21:46:24.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h2>å‰è¨€</h2><p>æ—©åœ¨äº”å¹´å‰ï¼ŒGoogle å°±æå‡ºäº† 1s å®Œæˆç»ˆç«¯é¡µé¢çš„é¦–å±æ¸²æŸ“çš„æ ‡å‡†ã€‚</p><img src="/assets/img/google_atf.png" alt="google_atf"><p>å¸¸è§çš„ä¼˜åŒ–ç½‘ç»œè¯·æ±‚çš„æ–¹æ³•æœ‰ï¼šDNS Lookupï¼Œå‡å°‘é‡å®šå‘ï¼Œé¿å… JSã€CSS é˜»å¡ï¼Œå¹¶è¡Œè¯·æ±‚ï¼Œä»£ç å‹ç¼©ï¼Œç¼“å­˜ï¼ŒæŒ‰éœ€åŠ è½½ï¼Œå‰ç«¯æ¨¡å—åŒ–â€¦</p><a id="more"></a><p>è™½ç„¶ç›¸è¾ƒäºç½‘ç»œæ–¹é¢çš„ä¼˜åŒ–ï¼Œå‰ç«¯æ¸²æŸ“çš„ä¼˜åŒ–æ˜¾å¾—æ¯æ°´è½¦è–ªï¼Œè€Œä¸”éšç€æµè§ˆå™¨å’Œç¡¬ä»¶æ€§èƒ½çš„å¢é•¿ï¼Œå†åŠ ä¸Šä¸»æµå‰ç«¯æ¡†æ¶ï¼ˆreactã€vueã€angularï¼‰çš„å·²ç»å¸®æˆ‘ä»¬è§£å†³äº†å¤§å¤šæ•°çš„æ€§èƒ½é—®é¢˜ï¼Œä½†æ˜¯å‰ç«¯æ¸²æŸ“æ€§èƒ½ä¼˜åŒ–ä¾ç„¶å€¼å¾—å­¦ä¹ ï¼Œé™¤å»ç½‘ç»œæ–¹é¢çš„æ¶ˆè€—ï¼Œç•™ç»™å‰ç«¯æ¸²æŸ“çš„æ—¶é—´å·²ç»ä¸å¤šäº†ã€‚æœ¬æ–‡ä¸»è¦å­¦ä¹ å‰ç«¯æ¸²æŸ“ç›¸å…³çš„é—®é¢˜ã€‚</p><h2>æµè§ˆå™¨æ˜¯å¦‚ä½•æ¸²æŸ“ä¸€ä¸ªé¡µé¢çš„</h2><blockquote><ol><li>æµè§ˆå™¨æŠŠè·å–åˆ°çš„ HTML ä»£ç è§£ææˆ1ä¸ª DOM æ ‘ï¼ŒHTML ä¸­çš„æ¯ä¸ª tag éƒ½æ˜¯ DOM æ ‘ä¸­çš„1ä¸ªèŠ‚ç‚¹ï¼Œæ ¹èŠ‚ç‚¹æ˜¯ document å¯¹è±¡ã€‚DOM æ ‘é‡ŒåŒ…å«äº†æ‰€æœ‰ HTML æ ‡ç­¾ï¼ŒåŒ…æ‹¬ <code>display:none</code> éšè—çš„æ ‡ç­¾ï¼Œè¿˜æœ‰ç”¨ JS åŠ¨æ€æ·»åŠ çš„å…ƒç´ ç­‰ã€‚</li><li>æµè§ˆå™¨æŠŠæ‰€æœ‰æ ·å¼è§£ææˆæ ·å¼ç»“æ„ä½“ï¼Œåœ¨è§£æçš„è¿‡ç¨‹ä¸­ä¼šå»æ‰æµè§ˆå™¨ä¸èƒ½è¯†åˆ«çš„æ ·å¼ï¼Œæ¯”å¦‚ IE ä¼šå»æ‰ -moz å¼€å¤´çš„æ ·å¼ã€‚</li><li>DOM Tree å’Œæ ·å¼ç»“æ„ä½“ç»„åˆåæ„å»º render tree, render tree ç±»ä¼¼äº DOM treeï¼Œä½†åŒºåˆ«å¾ˆå¤§ï¼Œrender tree èƒ½è¯†åˆ«æ ·å¼ï¼Œrender tree ä¸­æ¯ä¸ª NODE éƒ½æœ‰è‡ªå·±çš„ styleï¼Œè€Œä¸” render tree ä¸åŒ…å«éšè—çš„èŠ‚ç‚¹ (æ¯”å¦‚ <code>display:none</code> çš„èŠ‚ç‚¹ï¼Œè¿˜æœ‰ head èŠ‚ç‚¹)ï¼Œå› ä¸ºè¿™äº›èŠ‚ç‚¹ä¸ä¼šç”¨äºå‘ˆç°ï¼Œè€Œä¸”ä¸ä¼šå½±å“å‘ˆç°çš„èŠ‚ç‚¹ï¼Œæ‰€ä»¥å°±ä¸ä¼šåŒ…å«åˆ° render tree ä¸­ã€‚æ³¨æ„ <code>visibility:hidden</code> éšè—çš„å…ƒç´ è¿˜æ˜¯ä¼šåŒ…å«åˆ° render tree ä¸­çš„ï¼Œå› ä¸º <code>visibility:hidden</code> ä¼šå½±å“å¸ƒå±€(layout)ï¼Œä¼šå æœ‰ç©ºé—´ã€‚æ ¹æ® CSS2 çš„æ ‡å‡†ï¼Œrender tree ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½ç§°ä¸º Box (Box dimensions)ï¼Œç†è§£é¡µé¢å…ƒç´ ä¸ºä¸€ä¸ªå…·æœ‰å¡«å……ã€è¾¹è·ã€è¾¹æ¡†å’Œä½ç½®çš„ç›’å­ã€‚</li><li>ä¸€æ—¦ render tree æ„å»ºå®Œæ¯•åï¼Œæµè§ˆå™¨å°±å¯ä»¥æ ¹æ® render tree æ¥ç»˜åˆ¶é¡µé¢äº†ã€‚</li></ol></blockquote><p>æ€»ç»“ä¸ºä¸‹å›¾ï¼š</p><img src="/assets/img/web_repaint_reflow.png" alt="web_repaint_reflow"><p>å›¾ç‰‡æ¥è‡ª <a href="https://segmentfault.com/a/1190000010298038" target="_blank" rel="noopener">æµè§ˆå™¨æ¸²æŸ“é¡µé¢è¿‡ç¨‹ä¸é¡µé¢ä¼˜åŒ–</a></p><p>åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œå‰ç«¯å·¥ç¨‹å¸ˆä¸»è¦çš„æ•Œäººä¸ºï¼š</p><ol><li>é‡æ–°è®¡ç®—æ ·å¼ï¼ˆRecalculate Styleï¼‰ã€è®¡ç®—å¸ƒå±€ï¼ˆLayoutï¼‰=&gt; Rendering/Reflowã€‚</li><li>ç»˜åˆ¶ =&gt; Painting/Repaintã€‚</li></ol><h3>é‡ç»˜ä¸å›æµ</h3><ol><li>å½“ render tree ä¸­çš„ä¸€éƒ¨åˆ†ï¼ˆæˆ–å…¨éƒ¨ï¼‰å› ä¸ºå…ƒç´ çš„è§„æ¨¡å°ºå¯¸ã€å¸ƒå±€ã€æ˜¾ç¤º/éšè—ç­‰æ”¹å˜è€Œéœ€è¦é‡æ–°æ„å»ºï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä½œå›æµï¼ˆreflowï¼‰ã€‚é¡µé¢ç¬¬ä¸€æ¬¡åŠ è½½çš„æ—¶å€™ï¼Œè‡³å°‘å‘ç”Ÿä¸€æ¬¡å›æµã€‚</li><li>å½“ render tree ä¸­çš„ä¸€äº›å…ƒç´ éœ€è¦æ›´æ–°å±æ€§ï¼Œè€Œè¿™äº›å±æ€§åªæ˜¯å½±å“å…ƒç´ çš„å¤–è§‚ï¼Œé£æ ¼ï¼Œè€Œä¸ä¼šå½±å“å¸ƒå±€çš„ï¼Œæ¯”å¦‚ background-colorï¼Œè¿™ä¸ªè¿‡ç¨‹å«åšé‡ç»˜ï¼ˆrepaintï¼‰</li></ol><p>åœ¨å›æµçš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šä½¿ render tree ä¸­å—åˆ°å½±å“çš„éƒ¨åˆ†å¤±æ•ˆï¼Œå¹¶é‡æ–°æ„é€ è¿™éƒ¨åˆ†æ¸²æŸ“æ ‘ï¼Œå®Œæˆå›æµåï¼Œæµè§ˆå™¨ä¼šé‡æ–°ç»˜åˆ¶å—å½±å“çš„éƒ¨åˆ†åˆ°å±å¹•ä¸­ï¼Œè¯¥è¿‡ç¨‹æˆä¸ºé‡ç»˜ã€‚å› æ­¤<strong>å›æµå¿…å°†å¼•èµ·é‡ç»˜ï¼Œè€Œé‡ç»˜ä¸ä¸€å®šä¼šå¼•èµ·å›æµã€‚</strong></p><p>Reflow çš„æˆæœ¬æ¯” Repaint é«˜å¾—å¤šçš„å¤šã€‚DOM Tree é‡Œçš„æ¯ä¸ªç»“ç‚¹éƒ½ä¼šæœ‰ reflow æ–¹æ³•ï¼Œä¸€ä¸ªç»“ç‚¹çš„ reflow å¾ˆæœ‰å¯èƒ½å¯¼è‡´å­ç»“ç‚¹ï¼Œç”šè‡³çˆ¶ç‚¹ä»¥åŠåŒçº§ç»“ç‚¹çš„ reflowã€‚</p><h3>åœ¨ chrome ä¸­æŸ¥çœ‹ repaint</h3><p>F12 æ‰“å¼€æ§åˆ¶å° -&gt; DevTools -&gt; Show console drawer -&gt; Rendering -&gt; å‹¾é€‰ Paint flashingã€‚</p><h3>é‡ç»˜ä½•æ—¶å‘ç”Ÿ</h3><p>å½“ä¸€ä¸ªå…ƒç´ çš„å¤–è§‚çš„å¯è§æ€§ visibility å‘ç”Ÿæ”¹å˜çš„æ—¶å€™ï¼Œä½†æ˜¯ä¸å½±å“å¸ƒå±€ã€‚ç±»ä¼¼çš„ä¾‹å­åŒ…æ‹¬ï¼šoutline, visibility, background colorã€‚</p><h3>å›æµä½•æ—¶å‘ç”Ÿ</h3><ol start="0"><li>é¡µé¢æ¸²æŸ“åˆå§‹åŒ–ã€‚</li><li>è°ƒæ•´çª—å£å¤§å°ã€‚</li><li>æ”¹å˜å­—ä½“ï¼Œæ¯”å¦‚ä¿®æ”¹ç½‘é¡µé»˜è®¤å­—ä½“ã€‚</li><li>å¢åŠ æˆ–è€…ç§»é™¤æ ·å¼è¡¨ã€‚</li><li>å†…å®¹å˜åŒ–ï¼Œæ¯”å¦‚æ–‡æœ¬æ”¹å˜æˆ–è€…å›¾ç‰‡å¤§å°æ”¹å˜è€Œå¼•èµ·çš„è®¡ç®—å€¼å®½åº¦å’Œé«˜åº¦æ”¹å˜ã€‚</li><li>æ¿€æ´» CSS ä¼ªç±»ï¼Œæ¯”å¦‚ :hover</li><li>æ“ä½œ class å±æ€§ã€‚</li><li>è„šæœ¬æ“ä½œ DOMï¼Œå¢åŠ åˆ é™¤æˆ–è€…ä¿®æ”¹ DOM èŠ‚ç‚¹ï¼Œå…ƒç´ å°ºå¯¸æ”¹å˜â€”â€”è¾¹è·ã€å¡«å……ã€è¾¹æ¡†ã€å®½åº¦å’Œé«˜åº¦ã€‚</li><li>è®¡ç®— offsetWidth å’Œ offsetHeight å±æ€§ã€‚</li><li>è®¾ç½® style å±æ€§çš„å€¼ã€‚</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s = <span class="built_in">document</span>.body.style</span><br><span class="line">s.padding = <span class="string">"2px"</span> <span class="comment">// å›æµ+é‡ç»˜</span></span><br><span class="line">s.border = <span class="string">"1px solid red"</span> <span class="comment">// å›æµ+é‡ç»˜</span></span><br><span class="line">s.color = <span class="string">"blue"</span> <span class="comment">// é‡ç»˜</span></span><br><span class="line">s.backgroundColor = <span class="string">"#ccc"</span> <span class="comment">// é‡ç»˜</span></span><br><span class="line">s.fontSize = <span class="string">"14px"</span> <span class="comment">// å†ä¸€æ¬¡ å›æµ+é‡ç»˜</span></span><br><span class="line"><span class="built_in">document</span>.body.appendChild(<span class="built_in">document</span>.createTextNode(<span class="string">'abc!'</span>)) <span class="comment">// å›æµ+é‡ç»˜</span></span><br></pre></td></tr></table></figure><h3>æµè§ˆå™¨</h3><p>å¦‚æœå‘ä¸Šè¿°ä»£ç ä¸­é‚£æ ·ï¼Œæµè§ˆå™¨ä¸åœåœ°å›æµ+é‡ç»˜ï¼Œå¾ˆå¯èƒ½æ€§èƒ½å¼€é”€éå¸¸å¤§ï¼Œå®é™…ä¸Šæµè§ˆå™¨ä¼šä¼˜åŒ–è¿™äº›æ“ä½œï¼Œå°†æ‰€æœ‰å¼•èµ·å›æµå’Œé‡ç»˜çš„æ“ä½œæ”¾å…¥ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œç­‰å¾…é˜Ÿåˆ—è¾¾åˆ°ä¸€å®šçš„æ•°é‡æˆ–è€…æ—¶é—´é—´éš”ï¼Œå°± flush è¿™ä¸ªé˜Ÿåˆ—ï¼Œä¸€æ¬¡æ€§å¤„ç†æ‰€æœ‰çš„å›æµå’Œé‡ç»˜ã€‚</p><p>è™½ç„¶æœ‰æµè§ˆå™¨ä¼˜åŒ–ï¼Œä½†æ˜¯å½“æˆ‘ä»¬å‘æµè§ˆå™¨è¯·æ±‚ä¸€äº› style ä¿¡æ¯çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¸ºäº†ç¡®ä¿æˆ‘ä»¬èƒ½æ‹¿åˆ°ç²¾ç¡®çš„å€¼ï¼Œå°±ä¼šæå‰ flush é˜Ÿåˆ—ã€‚</p><ol><li>offsetTop/Left/Width/Height</li><li>scrollTop/Left/Width/Height</li><li>clientTop/Left/Width/Height</li><li>width,height</li><li>getComputedStyle(), æˆ–è€… IEçš„ currentStyle</li></ol><h3>å‡å°‘å›æµé‡ç»˜</h3><ul><li><p>requestAnimationFrameï¼šèƒ½ä¿è¯æµè§ˆå™¨åœ¨æ­£ç¡®çš„æ—¶é—´è¿›è¡Œæ¸²æŸ“ã€‚</p></li><li><p>ä¿æŒ DOM æ“ä½œâ€œåŸå­æ€§â€ï¼š</p></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">var</span> newWidth = ele.offsetWidth + <span class="number">10</span></span><br><span class="line">ele.style.width = newWidth + <span class="string">'px'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> newHeight = ele.offsetHeight + <span class="number">10</span></span><br><span class="line">ele.style.height = newHeight + <span class="string">'px'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// good è¯»å†™åˆ†ç¦»ï¼Œæ‰¹é‡æ“ä½œ</span></span><br><span class="line"><span class="keyword">var</span> newWidth = ele.offsetWidth + <span class="number">10</span> <span class="comment">// read</span></span><br><span class="line"><span class="keyword">var</span> newHeight = ele.offsetHeight + <span class="number">10</span> <span class="comment">// read</span></span><br><span class="line">ele.style.width = newWidth + <span class="string">'px'</span> <span class="comment">// write</span></span><br><span class="line">ele.style.height = newHeight + <span class="string">'px'</span> <span class="comment">// write</span></span><br></pre></td></tr></table></figure><ul><li>ä½¿ç”¨ classList ä»£æ›¿ classNameï¼š</li></ul><p>className åªè¦èµ‹å€¼ï¼Œå°±ä¸€å®šå‡ºç°ä¸€æ¬¡ rendering è®¡ç®—ï¼›classList çš„ add å’Œ removeï¼Œæµè§ˆå™¨ä¼šè¿›è¡Œæ ·å¼åæ˜¯å¦å­˜åœ¨çš„åˆ¤æ–­ï¼Œä»¥å‡å°‘é‡å¤çš„ renderingã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ele.className += <span class="string">'something'</span></span><br><span class="line">ele.classList.add(<span class="string">'something'</span>)</span><br><span class="line">ele.classList.remove(<span class="string">'something'</span>)</span><br></pre></td></tr></table></figure><ul><li>æ‰¹é‡æ“ä½œå€ŸåŠ©ä¸´æ—¶å˜é‡</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">  el.style.left = el.offsetLeft + <span class="number">5</span> + <span class="string">'px'</span></span><br><span class="line">  el.style.top = el.offsetTop + <span class="number">5</span> + <span class="string">'px'</span> </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">let</span> left = el.offsetLeft</span><br><span class="line"><span class="keyword">let</span> top = el.offsetTop</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">  left += <span class="number">5</span></span><br><span class="line">  top += <span class="number">5</span> </span><br><span class="line">&#125;</span><br><span class="line">el.style.left = left + <span class="string">'px'</span></span><br><span class="line">el.style.top = left + <span class="string">'px'</span></span><br></pre></td></tr></table></figure><ul><li>å¯¹å…ƒç´ è¿›è¡Œâ€œç¦»çº¿æ“ä½œâ€ï¼Œå®Œæˆåå†ä¸€èµ·æ›´æ–°ï¼š</li></ul><ol><li>ä½¿ç”¨ DocumentFragment è¿›è¡Œç¼“å­˜æ“ä½œ,å¼•å‘ä¸€æ¬¡å›æµå’Œé‡ç»˜ <a href="http://www.cnblogs.com/blueSkys/p/3685740.html" target="_blank" rel="noopener">äº†è§£DocumentFragment ç»™æˆ‘ä»¬å¸¦æ¥çš„æ€§èƒ½ä¼˜åŒ–</a></li><li>å…ƒç´ æ“ä½œå‰ä½¿ç”¨ <code>display: none</code>ï¼Œå®Œæˆåå†å°†å…¶æ˜¾ç¤ºå‡ºæ¥ï¼Œè¿™æ ·åªä¼šè§¦å‘ä¸€æ¬¡å›æµå’Œé‡ç»˜ã€‚</li><li>ä½¿ç”¨ cloneNode + replaceChild æŠ€æœ¯ï¼Œå¼•å‘ä¸€æ¬¡å›æµå’Œé‡ç»˜ã€‚</li></ol><p>å‡å¦‚éœ€è¦åœ¨ä¸‹é¢çš„ html ä¸­æ·»åŠ ä¸¤ä¸ª li èŠ‚ç‚¹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">""</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ JavaScriptï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> ul = <span class="built_in">document</span>.getElementByTagName(<span class="string">'ul'</span>)</span><br><span class="line"><span class="keyword">let</span> man = <span class="built_in">document</span>.createElement(<span class="string">'li'</span>)</span><br><span class="line">man.innerHTML = <span class="string">'man'</span></span><br><span class="line">ul.appendChild(li)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">let</span> woman = <span class="built_in">document</span>.createElement(<span class="string">'li'</span>)</span><br><span class="line">woman.innerHTML = <span class="string">'woman'</span></span><br><span class="line">ul.appendChild(woman)</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ä¼šå‘ç”Ÿä¸¤æ¬¡å›æµï¼Œå‡å¦‚ä½¿ç”¨ <code>display: none</code> çš„æ–¹æ¡ˆï¼Œè™½ç„¶èƒ½å¤Ÿå‡å°‘å›æµæ¬¡æ•°ï¼Œä½†æ˜¯ä¼šå‘ç”Ÿä¸€æ¬¡é—ªçƒï¼Œè¿™æ—¶å€™ä½¿ç”¨ DocumentFragment  çš„ä¼˜åŠ¿å°±ä½“ç°å‡ºæ¥äº†ã€‚</p><p>DocumentFragment æœ‰ä¸¤å¤§ç‰¹ç‚¹ï¼š</p><ol><li>DocumentFragment èŠ‚ç‚¹ä¸å±äºæ–‡æ¡£æ ‘ï¼Œç»§æ‰¿çš„ parentNode å±æ€§æ€»æ˜¯ nullã€‚</li><li>å½“è¯·æ±‚æŠŠä¸€ä¸ª DocumentFragment èŠ‚ç‚¹æ’å…¥æ–‡æ¡£æ ‘æ—¶ï¼Œæ’å…¥çš„ä¸æ˜¯ DocumentFragment è‡ªèº«ï¼Œè€Œæ˜¯å®ƒçš„æ‰€æœ‰å­å­™èŠ‚ç‚¹ã€‚è¿™ä½¿å¾— DocumentFragment æˆäº†æœ‰ç”¨çš„å ä½ç¬¦ï¼Œæš‚æ—¶å­˜æ”¾é‚£äº›ä¸€æ¬¡æ’å…¥æ–‡æ¡£çš„èŠ‚ç‚¹ã€‚å®ƒè¿˜æœ‰åˆ©äºå®ç°æ–‡æ¡£çš„å‰ªåˆ‡ã€å¤åˆ¶å’Œç²˜è´´æ“ä½œã€‚ã€</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> fragment = <span class="built_in">document</span>.createDocumentFragment()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> man = <span class="built_in">document</span>.createElement(<span class="string">'li'</span>)</span><br><span class="line"><span class="keyword">let</span> woman = <span class="built_in">document</span>.createElement(<span class="string">'li'</span>)</span><br><span class="line">man.innerHTML = <span class="string">'man'</span></span><br><span class="line">woman.innerHTML = <span class="string">'woman'</span></span><br><span class="line">fragment.appendChild(man)</span><br><span class="line">fragment.appendChild(woman)</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.body.appendChild(spanNode)</span><br></pre></td></tr></table></figure><p>å¯è§ DocumentFragment æ˜¯ä¸€ä¸ªå­¤å„¿èŠ‚ç‚¹ï¼Œæ²¡çˆ¹å°±èƒ½å‡ºç”Ÿï¼Œä½†æ˜¯åœ¨éœ€è¦å®ƒçš„æ—¶å€™ï¼Œå®ƒåˆæ— ç§åœ°æŠŠå­©å­å¥‰çŒ®ç»™æ–‡æ¡£æ ‘ï¼Œç„¶åè‡ªå·±é»˜é»˜ç¦»å¼€ã€‚æ˜¯ä¸æ˜¯æœ‰ç‚¹åƒã€Šé“¶ç¿¼æ€æ‰‹2049ã€‹ï¼Ÿ</p><h2>å‚è€ƒèµ„æ–™</h2><ul><li><a href="http://velocity.oreilly.com.cn/2013/ppts/16_ms_optimization--web_front-end_performance_optimization.pdf" target="_blank" rel="noopener">16æ¯«ç§’çš„ä¼˜åŒ–<br></a></li><li><a href="https://segmentfault.com/a/1190000010298038" target="_blank" rel="noopener">æµè§ˆå™¨æ¸²æŸ“é¡µé¢è¿‡ç¨‹ä¸é¡µé¢ä¼˜åŒ–</a></li><li><a href="http://www.css88.com/archives/4996" target="_blank" rel="noopener">é¡µé¢é‡ç»˜å’Œå›æµä»¥åŠä¼˜åŒ–</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;å‰è¨€&lt;/h2&gt;
&lt;p&gt;æ—©åœ¨äº”å¹´å‰ï¼ŒGoogle å°±æå‡ºäº† 1s å®Œæˆç»ˆç«¯é¡µé¢çš„é¦–å±æ¸²æŸ“çš„æ ‡å‡†ã€‚&lt;/p&gt;
&lt;img src=&quot;/assets/img/google_atf.png&quot; alt=&quot;google_atf&quot;&gt;
&lt;p&gt;å¸¸è§çš„ä¼˜åŒ–ç½‘ç»œè¯·æ±‚çš„æ–¹æ³•æœ‰ï¼šDNS Lookupï¼Œå‡å°‘é‡å®šå‘ï¼Œé¿å… JSã€CSS é˜»å¡ï¼Œå¹¶è¡Œè¯·æ±‚ï¼Œä»£ç å‹ç¼©ï¼Œç¼“å­˜ï¼ŒæŒ‰éœ€åŠ è½½ï¼Œå‰ç«¯æ¨¡å—åŒ–â€¦&lt;/p&gt;
    
    </summary>
    
      <category term="æ€§èƒ½" scheme="https://lz5z.com/categories/%E6%80%A7%E8%83%BD/"/>
    
    
      <category term="CSS" scheme="https://lz5z.com/tags/CSS/"/>
    
      <category term="é‡ç»˜" scheme="https://lz5z.com/tags/%E9%87%8D%E7%BB%98/"/>
    
      <category term="å›æµ" scheme="https://lz5z.com/tags/%E5%9B%9E%E6%B5%81/"/>
    
  </entry>
  
  <entry>
    <title>å‰ç«¯æ¨¡å—åŒ–-CommonJS,AMD,CMD,ES6</title>
    <link href="https://lz5z.com/JavaScript%E6%A8%A1%E5%9D%97%E5%8C%96-CommonJS-AMD-CMD-ES6/"/>
    <id>https://lz5z.com/JavaScriptæ¨¡å—åŒ–-CommonJS-AMD-CMD-ES6/</id>
    <published>2018-04-26T23:03:17.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h2>æ¨¡å—åŒ–è§£å†³ä»€ä¹ˆé—®é¢˜</h2><p>éšç€ JavaScript å·¥ç¨‹è¶Šæ¥è¶Šå¤§ï¼Œå›¢é˜Ÿåä½œä¸å¯é¿å…ï¼Œä¸ºäº†æ›´å¥½åœ°å¯¹ä»£ç è¿›è¡Œç®¡ç†å’Œæµ‹è¯•ï¼Œæ¨¡å—åŒ–çš„æ¦‚å¿µé€æ¸å¼•å…¥å‰ç«¯ã€‚æ¨¡å—åŒ–å¯ä»¥é™ä½ååŒå¼€å‘çš„æˆæœ¬ï¼Œå‡å°‘ä»£ç é‡ï¼ŒåŒæ—¶ä¹Ÿæ˜¯â€œé«˜å†…èšï¼Œä½è€¦åˆâ€çš„åŸºç¡€ã€‚</p><p>æ¨¡å—åŒ–ä¸»è¦è§£å†³ä¸¤ä¸ªé—®é¢˜ï¼š</p><ol><li>å‘½åå†²çª</li><li>æ–‡ä»¶ä¾èµ–ï¼šæ¯”å¦‚ bootstrap éœ€è¦å¼•å…¥ jqueryï¼Œjquery æ–‡ä»¶çš„ä½ç½®å¿…é¡»è¦ bootstrap.js ä¹‹å‰å¼•å…¥ã€‚</li></ol><a id="more"></a><h3>è¿œå¤æ—¶ä»£çš„äººä»¬æ˜¯æ€æ ·è§£å†³æ¨¡å—åŒ–çš„</h3><p>åœ¨å„ç§æ¨¡å—åŒ–è§„èŒƒå‡ºæ¥ä¹‹å‰ï¼Œäººä»¬ä½¿ç”¨åŒ¿åé—­åŒ…å‡½æ•°è§£å†³æ¨¡å—åŒ–çš„é—®é¢˜ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> num0 = <span class="number">2</span>; <span class="comment">// æ³¨æ„è¿™é‡Œçš„åˆ†å·</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> num1 = <span class="number">3</span></span><br><span class="line">  <span class="keyword">var</span> num2 = <span class="number">5</span> </span><br><span class="line">  <span class="keyword">var</span> add = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> num0 + num1 + num2</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(add()) <span class="comment">// 10</span></span><br><span class="line">&#125;)()</span><br><span class="line"></span><br><span class="line"><span class="comment">// console.log(num1) // num1 is not defined</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œä½ å¯ä»¥åœ¨å‡½æ•°å†…éƒ¨ä½¿ç”¨å…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡ï¼Œå¹¶ä¸”ä¸ç”¨æ‹…å¿ƒå±€éƒ¨å˜é‡æ±¡æŸ“å…¨å±€å˜é‡ã€‚è¿™ç§ç”¨æ‹¬å·æŠŠåŒ¿åå‡½æ•°åŒ…èµ·æ¥çš„æ–¹å¼ï¼Œä¹Ÿå«åšç«‹å³æ‰§è¡Œå‡½æ•°ï¼ˆIIFEï¼‰ã€‚æ‰€æœ‰å‡½æ•°å†…éƒ¨ä»£ç éƒ½åœ¨é—­åŒ…(closure)å†…ã€‚å®ƒæä¾›äº†æ•´ä¸ªåº”ç”¨ç”Ÿå‘½å‘¨æœŸçš„ç§æœ‰å’ŒçŠ¶æ€ã€‚</p><h3>CommonJS è§„èŒƒ</h3><p>CommonJS å°†æ¯ä¸ªæ–‡ä»¶éƒ½è§†ä¸ºä¸€ä¸ªæ¨¡å—ï¼Œåœ¨æ¯ä¸ªæ¨¡å—ä¸­å˜é‡é»˜è®¤éƒ½æ˜¯ç§æœ‰å˜é‡ï¼Œé€šè¿‡ module.exports å®šä¹‰å½“å‰æ¨¡å—å¯¹å¤–è¾“å‡ºçš„æ¥å£ï¼Œé€šè¿‡ require åŠ è½½æ¨¡å—ã€‚</p><p>(1) ä½¿ç”¨æ–¹æ³•ï¼š</p><p>circle.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; PI &#125; = <span class="built_in">Math</span></span><br><span class="line">exports.area = <span class="function">(<span class="params">r</span>) =&gt;</span> PI * r ** <span class="number">2</span></span><br><span class="line">exports.circumference = <span class="function">(<span class="params">r</span>) =&gt;</span> <span class="number">2</span> * PI * r</span><br></pre></td></tr></table></figure><p>app.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> circle = <span class="built_in">require</span>(<span class="string">'./circle.js'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(circle.area(<span class="number">4</span>))</span><br></pre></td></tr></table></figure><p>(2) åŸç†ï¼šnode åœ¨ç¼–è¯‘ js æ–‡ä»¶çš„è¿‡ç¨‹ä¸­ï¼Œä¼šä½¿ç”¨ä¸€ä¸ªå¦‚ä¸‹çš„å‡½æ•°åŒ…è£…å™¨å°†å…¶åŒ…è£…<a href="http://nodejs.cn/api/modules.html#modules_the_module_wrapper" target="_blank" rel="noopener">æ¨¡å—åŒ…è£…å™¨</a>ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">exports, require, module, __filename, __dirname</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> circle = <span class="built_in">require</span>(<span class="string">'./circle.js'</span>)</span><br><span class="line">  <span class="built_in">console</span>.log(circle.area(<span class="number">4</span>))</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨ node ç¯å¢ƒä¸­å¯ä»¥ä½¿ç”¨è¿™å‡ ä¸ªæ²¡æœ‰æ˜¾å¼å®šä¹‰çš„å˜é‡çš„åŸå› ã€‚å…¶ä¸­ <code>__filename</code> å’Œ <code>__dirname</code> åœ¨æŸ¥æ‰¾æ–‡ä»¶è·¯å¾„çš„è¿‡ç¨‹ä¸­åˆ†æå¾—åˆ°åä¼ å…¥çš„ã€‚module å˜é‡æ˜¯è¿™ä¸ªæ¨¡å—å¯¹è±¡è‡ªèº«ï¼Œexports æ˜¯åœ¨ module çš„æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ–çš„ä¸€ä¸ªç©ºå¯¹è±¡ã€‚</p><p>æ›´è¯¦ç»†çš„å†…å®¹å¯ä»¥å‚è€ƒ <a href="http://nodejs.cn/api/modules.html" target="_blank" rel="noopener">node modules</a></p><p>å…³äºä»€ä¹ˆæ—¶å€™ä½¿ç”¨ exportsã€ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ module.exportsï¼Œå¯ä»¥å‚è€ƒ <a href="http://nodejs.cn/api/modules.html#modules_exports_shortcut" target="_blank" rel="noopener">exports shutcut</a></p><p>(3) ä¼˜ç‚¹ vs ç¼ºç‚¹</p><p>CommonJS èƒ½å¤Ÿé¿å…å…¨å±€å‘½åç©ºé—´æ±¡æŸ“ï¼Œå¹¶ä¸”æ˜ç¡®ä»£ç ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚ä½†æ˜¯ CommonJS çš„æ¨¡å—åŠ è½½æ˜¯åŒæ­¥çš„ï¼Œå‡å¦‚ä¸€ä¸ªæ¨¡å—å¼•ç”¨ä¸‰ä¸ªå…¶å®ƒæ¨¡å—ï¼Œé‚£ä¹ˆè¿™ä¸‰ä¸ªæ¨¡å—éœ€è¦è¢«å®Œå…¨åŠ è½½åè¿™ä¸ªæ¨¡å—æ‰èƒ½è¿è¡Œã€‚è¿™åœ¨æœåŠ¡ç«¯ä¸æ˜¯ä»€ä¹ˆé—®é¢˜ï¼ˆnodeï¼‰ï¼Œä½†æ˜¯åœ¨æµè§ˆå™¨ç«¯å°±ä¸æ˜¯é‚£ä¹ˆé«˜æ•ˆäº†ï¼Œæ¯•ç«Ÿè¯»å–ç½‘ç»œæ–‡ä»¶æ¯”æœ¬åœ°æ–‡ä»¶è¦è€—æ—¶çš„å¤šã€‚</p><h3>AMD</h3><p><a href="https://github.com/amdjs/amdjs-api/wiki/AMD" target="_blank" rel="noopener">AMD</a> å…¨ç§°å¼‚æ­¥æ¨¡å—åŒ–å®šä¹‰è§„èŒƒï¼ˆAsynchronous Module Definitionï¼‰ï¼Œé‡‡ç”¨å¼‚æ­¥åŠ è½½æ¨¡å—çš„æ–¹å¼ï¼Œæ¨¡å—çš„åŠ è½½ä¸å½±å“åé¢è¯­å¥çš„æ‰§è¡Œï¼Œå¹¶ä¸”ä½¿ç”¨ callback å›è°ƒå‡½æ•°çš„æ–¹å¼æ¥è¿è¡Œæ¨¡å—åŠ è½½å®Œæˆåçš„ä»£ç ã€‚</p><p>(1) ä½¿ç”¨æ–¹å¼</p><p>å®šä¹‰ä¸€ä¸ª myModule çš„æ¨¡å—ï¼Œå®ƒä¾èµ– jQuery æ¨¡å—ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">define(<span class="string">'myModule'</span>, [<span class="string">'jQuery'</span>], <span class="function"><span class="keyword">function</span> (<span class="params">$</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// $ æ˜¯ jQuery çš„è¾“å‡ºæ¨¡å—</span></span><br><span class="line">  $(<span class="string">'#app'</span>).text(<span class="string">'Hello World'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºæ¨¡å— idï¼Œä¸ºå¯é€‰å‚æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºæ¨¡å—ä¾èµ–ï¼Œä¹Ÿæ˜¯å¯é€‰å‚æ•°ã€‚</p><p>ä½¿ç”¨ myModule æ¨¡å—ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>([<span class="string">'myModule'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">myModule</span>) </span>&#123;&#125;])</span><br></pre></td></tr></table></figure><p><a href="http://requirejs.org/" target="_blank" rel="noopener">requirejs</a> æ˜¯ AMD è§„èŒƒçš„ä¸€ä¸ªå®ç°ï¼Œè¯¦ç»†çš„ä½¿ç”¨æ–¹æ³•å¯ä»¥æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ã€‚</p><h3>CMD</h3><p>CMD è§„èŒƒæ¥æºäº <a href="https://seajs.github.io/seajs/docs/" target="_blank" rel="noopener">seajs</a>ï¼ŒCMD æ€»ä½“äº AMD ä½¿ç”¨èµ·æ¥éå¸¸æ¥è¿‘ï¼ŒAMD ä¸ CMD çš„åŒºåˆ«ï¼Œå¯ä»¥æŸ¥çœ‹ ä¸ RequireJS çš„å¼‚åŒ](<a href="https://github.com/seajs/seajs/issues/277" target="_blank" rel="noopener">https://github.com/seajs/seajs/issues/277</a>)</p><p>(1) ä½¿ç”¨æ–¹å¼ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// CMD</span></span><br><span class="line">define(<span class="function"><span class="keyword">function</span>(<span class="params">require, exports, module</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="built_in">require</span>(<span class="string">'./a'</span>)</span><br><span class="line">  a.doSomething()</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="keyword">var</span> b = <span class="built_in">require</span>(<span class="string">'./b'</span>)</span><br><span class="line">  <span class="comment">// ä¾èµ–å¯ä»¥å°±è¿‘ä¹¦å†™</span></span><br><span class="line">  b.doSomething()</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>CMD æ¨å´‡ä¾èµ–å°±è¿‘ï¼Œå¯ä»¥æŠŠä¾èµ–å†™è¿›ä½ çš„ä»£ç ä¸­çš„ä»»æ„ä¸€è¡Œï¼ŒAMD æ˜¯ä¾èµ–å‰ç½®çš„ï¼Œåœ¨è§£æå’Œæ‰§è¡Œå½“å‰æ¨¡å—ä¹‹å‰ï¼Œæ¨¡å—å¿…é¡»æŒ‡æ˜å½“å‰æ¨¡å—æ‰€ä¾èµ–çš„æ¨¡å—ã€‚</p><h3>UMD</h3><p>UMDï¼ˆUniversal Module Definitionï¼‰å¹¶ä¸æ˜¯ä¸€ç§è§„èŒƒï¼Œè€Œæ˜¯ç»“åˆ AMD å’Œ CommonJS çš„ä¸€ç§æ›´ä¸ºé€šç”¨çš„ JS æ¨¡å—è§£å†³æ–¹æ¡ˆã€‚</p><p>åœ¨æ‰“åŒ…æ¨¡å—çš„æ—¶å€™ç»å¸¸ä¼šè§åˆ°è¿™æ ·çš„å†™æ³•ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">output: &#123;</span><br><span class="line">  path: path.resolve(__dirname, <span class="string">'../dist'</span>),</span><br><span class="line">  filename: <span class="string">'vue.js'</span>,</span><br><span class="line">  library: <span class="string">'Vue'</span>,</span><br><span class="line">  libraryTarget: <span class="string">'umd'</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>è¡¨ç¤ºæ‰“åŒ…å‡ºæ¥çš„æ¨¡å—ä¸º umd æ¨¡å—ï¼Œæ—¢èƒ½åœ¨æœåŠ¡ç«¯ï¼ˆnodeï¼‰è¿è¡Œï¼Œåˆèƒ½åœ¨æµè§ˆå™¨ç«¯è¿è¡Œã€‚æˆ‘ä»¬æ¥çœ‹ vue æ‰“åŒ…åçš„æºç  <a href="https://github.com/vuejs/vue/blob/master/dist/vue.js" target="_blank" rel="noopener">vue.js</a></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">global, factory</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">typeof</span> exports === <span class="string">'object'</span> &amp;&amp; <span class="keyword">typeof</span> <span class="built_in">module</span> !== <span class="string">'undefined'</span> ? <span class="built_in">module</span>.exports = factory() :</span><br><span class="line">  <span class="keyword">typeof</span> define === <span class="string">'function'</span> &amp;&amp; define.amd ? define(factory) : </span><br><span class="line">  (global.Vue = factory());</span><br><span class="line">&#125;(<span class="keyword">this</span>, (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="string">'use strict'</span>;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">&#125;)))</span><br></pre></td></tr></table></figure><p>ä»£ç ç¿»è¯‘è¿‡æ¥å°±æ˜¯ï¼š</p><ol><li>é¦–å…ˆåˆ¤æ–­æ˜¯å¦ä¸º node ç¯å¢ƒï¼šexports ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä¸” module å­˜åœ¨ã€‚</li><li>å¦‚æœæ˜¯ node ç¯å¢ƒå°±ç”¨ <code>module.exports = factory()</code> æŠŠ vue å¯¼å‡º ï¼ˆé€šè¿‡ require(â€˜vueâ€™) è¿›è¡Œå¼•ç”¨ï¼‰ã€‚</li><li>å¦‚æœä¸æ˜¯ node ç¯å¢ƒåˆ¤æ–­æ˜¯å¦æ”¯æŒ AMDï¼šdefine ä¸º function å¹¶ä¸” define.amd å­˜åœ¨ã€‚</li><li>å¦‚æœæ”¯æŒ AMD å°±ä½¿ç”¨ define å®šä¹‰æ¨¡å—ï¼Œï¼ˆé€šè¿‡ require([â€˜vueâ€™]) å¼•ç”¨ï¼‰ã€‚</li><li>å¦åˆ™çš„è¯ç›´æ¥å°† vue ç»‘å®šåœ¨å…¨å±€å˜é‡ä¸Šï¼ˆé€šè¿‡ window.vue å¼•ç”¨ï¼‰ã€‚</li></ol><h3>ES6</h3><p>ç»ˆäºåˆ°äº† ES6 çš„æ—¶ä»£ï¼ŒJS å¼€å§‹ä»è¯­è¨€å±‚é¢æ”¯æŒæ¨¡å—åŒ–ï¼Œä» node8.5 ç‰ˆæœ¬å¼€å§‹æ”¯æŒåŸç”Ÿ ES æ¨¡å—ã€‚ä¸è¿‡æœ‰ä¸¤ç‚¹é™åˆ¶ï¼š</p><ol><li>æ¨¡å—åï¼ˆæ–‡ä»¶åï¼‰å¿…é¡»ä¸º mjs</li><li>å¯åŠ¨å‚æ•°è¦åŠ ä¸Š <code>--experimental-modules</code></li></ol><p>å‡å¦‚æœ‰ a.mjs å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  name: <span class="string">'Jack'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ b.mjs ä¸­å¯ä»¥å¼•ç”¨ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> a <span class="keyword">from</span> <span class="string">'./a.mjs'</span></span><br><span class="line"><span class="built_in">console</span>.log(a) <span class="comment">// &#123; name: 'Jack' &#125;</span></span><br></pre></td></tr></table></figure><p>chrome61 å¼€å§‹ä¹Ÿæ”¯æŒ JS moduleï¼Œåªéœ€è¦åœ¨ script å±æ€§ä¸­æ·»åŠ  <code>type=&quot;module&quot;</code> å³å¯ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"module"</span> <span class="attr">src</span>=<span class="string">"module.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"module"</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">import</span> &#123; sayHello &#125; <span class="keyword">from</span> <span class="string">'./main.js'</span></span></span><br><span class="line">  sayHello()</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">// main.js</span><br><span class="line">export function sayHello () &#123;</span><br><span class="line">  console.info('Hello World')</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3>ES6 module è¯¦è§£</h3><p>ES6 module ä¸»è¦ç”±ä¸¤ä¸ªå‘½ä»¤ç»„æˆï¼šexport å’Œ importã€‚</p><p>(1) export å‘½ä»¤</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¾“å‡ºå˜é‡</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">let</span> num = <span class="number">123</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> name = <span class="string">'Leo'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾“å‡ºä¸€ç»„å˜é‡</span></span><br><span class="line"><span class="keyword">let</span> num = <span class="number">123</span></span><br><span class="line"><span class="keyword">let</span> name = <span class="string">'Leo'</span></span><br><span class="line"><span class="keyword">export</span> &#123; num, name &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾“å‡ºå‡½æ•°</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">foo</span> (<span class="params">x, y</span>) </span>&#123; <span class="keyword">return</span> x ** y &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨åˆ«å</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">b</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="keyword">export</span> &#123;</span><br><span class="line">  a <span class="keyword">as</span> name,</span><br><span class="line">  b <span class="keyword">as</span> value</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å¼•ç”¨çš„æ—¶å€™æŒ‰ç…§åˆ«åå¼•ç”¨</span></span><br><span class="line"><span class="keyword">import</span> &#123; name, value &#125; <span class="keyword">from</span> <span class="string">'..'</span></span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œexport å‘½ä»¤åªèƒ½å¯¹å¤–è¾“å‡ºæ¥å£ï¼Œä»¥ä¸‹çš„è¾“å‡ºæ–¹å¼å‡ä¸ºé”™è¯¯çš„ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æŠ¥é”™</span></span><br><span class="line"><span class="keyword">export</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">var</span> m = <span class="number">1</span></span><br><span class="line"><span class="keyword">export</span> m</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="keyword">export</span> f</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ­£ç¡®çš„å†™æ³•</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">var</span> m = <span class="number">1</span></span><br><span class="line"><span class="keyword">var</span> m = <span class="number">1</span></span><br><span class="line"><span class="keyword">export</span> &#123; m &#125;</span><br><span class="line"><span class="keyword">export</span> &#123; m <span class="keyword">as</span> n&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">f</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="keyword">export</span> &#123; f &#125;</span><br></pre></td></tr></table></figure><p>export è¾“å‡ºçš„å€¼æ˜¯åŠ¨æ€ç»‘å®šçš„ï¼Œè¿™ç‚¹ä¸ CommonJS ä¸åŒï¼ŒCommonJS è¾“å‡ºçš„æ˜¯å€¼çš„ç¼“å­˜ï¼Œä¸å­˜åœ¨åŠ¨æ€æ›´æ–°ã€‚</p><p>å¦‚ä½•åˆ é™¤ node ç¼“å­˜ï¼Ÿ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> config</span><br><span class="line">setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">delete</span> <span class="built_in">require</span>.cache[<span class="built_in">require</span>.resolve(<span class="string">'./config'</span>)]</span><br><span class="line">  config = <span class="built_in">require</span>(<span class="string">'./config'</span>)</span><br><span class="line">  <span class="built_in">console</span>.log(config)</span><br><span class="line">&#125;, <span class="number">3000</span>)</span><br></pre></td></tr></table></figure><p>export å‘½ä»¤å¿…é¡»å¤„äºæ¨¡å—é¡¶å±‚ï¼Œå¦‚æœå¤„äºå—çº§ä½œç”¨åŸŸå†…ï¼Œå°±ä¼šæŠ¥é”™ã€‚</p><p>(2) import å‘½ä»¤</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// import çš„å˜é‡æ˜¯åªè¯»çš„</span></span><br><span class="line"><span class="keyword">import</span> &#123; a &#125; <span class="keyword">from</span> <span class="string">'./a.js'</span></span><br><span class="line">a = <span class="number">33</span> <span class="comment">// Syntax Error : 'a' is read-only</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½†æ˜¯å¯ä»¥ä¿®æ”¹å…¶å±æ€§å€¼</span></span><br><span class="line">a.name = <span class="string">'Jack'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import å‘½ä»¤å¯ä»¥æå‡å˜é‡</span></span><br><span class="line">foo()</span><br><span class="line"><span class="keyword">import</span> &#123; foo &#125; <span class="keyword">from</span> <span class="string">'./a.js'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import æ˜¯é™æ€æ‰§è¡Œï¼Œä¸èƒ½ä½¿ç”¨è¡¨è¾¾å¼å’Œå˜é‡</span></span><br><span class="line"><span class="keyword">import</span> &#123; a + b &#125; <span class="keyword">from</span> <span class="string">'./a.ls'</span> <span class="comment">// æŠ¥é”™</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠ¥é”™</span></span><br><span class="line"><span class="keyword">let</span> <span class="built_in">module</span> = <span class="string">'my_module'</span></span><br><span class="line"><span class="keyword">import</span> &#123; foo &#125; <span class="keyword">from</span> <span class="built_in">module</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠ¥é”™</span></span><br><span class="line"><span class="keyword">if</span> (x === <span class="number">1</span>) &#123;</span><br><span class="line">  <span class="keyword">import</span> &#123; foo &#125; <span class="keyword">from</span> <span class="string">'module1'</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="keyword">import</span> &#123; foo &#125; <span class="keyword">from</span> <span class="string">'module2'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŠ è½½æ•´ä¸ªæ¨¡å—</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> utils <span class="keyword">from</span> <span class="string">'./utils.js'</span></span><br></pre></td></tr></table></figure><p>(3) export default</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// a.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'Hello World'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¼•ç”¨ a</span></span><br><span class="line"><span class="keyword">import</span> a <span class="keyword">from</span> <span class="string">'a.js'</span></span><br><span class="line">a()</span><br><span class="line"></span><br><span class="line"><span class="comment">// b.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> funtion foo () &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'Hello World'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¼•ç”¨ b</span></span><br><span class="line"><span class="keyword">import</span> foo <span class="keyword">from</span> <span class="string">'b.js'</span></span><br><span class="line">foo()</span><br></pre></td></tr></table></figure><p>export default ä¸ export è¾“å‡ºçš„æ¨¡å—åœ¨å¼•ç”¨çš„æ—¶å€™ï¼Œå·®åˆ«ä»…ä»…æ˜¯æ˜¯å¦ç”¨ <code>{}</code> å°†å˜é‡åŒ…èµ·æ¥ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span> (<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> x + y</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> &#123; add <span class="keyword">as</span> <span class="keyword">default</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¼•ç”¨</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> foo &#125; <span class="keyword">from</span> <span class="string">'a.js'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ­£ç¡®</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">var</span> a = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ­£ç¡®</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> a</span><br><span class="line"></span><br><span class="line"><span class="comment">// é”™è¯¯</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">var</span> a = <span class="number">1</span></span><br></pre></td></tr></table></figure><p>(4) export ä¸ import å¤åˆå†™æ³•</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> &#123; foo, bar &#125; <span class="keyword">from</span> <span class="string">'a.js'</span></span><br><span class="line"><span class="comment">// ç›¸å½“äº</span></span><br><span class="line"><span class="keyword">import</span> &#123; foo, bar &#125; <span class="keyword">from</span> <span class="string">'a.js'</span></span><br><span class="line"><span class="keyword">export</span> &#123; foo, bar &#125;</span><br></pre></td></tr></table></figure><h2>å‚è€ƒèµ„æ–™</h2><ul><li><a href="http://www.cnblogs.com/imwtr/p/4666181.html" target="_blank" rel="noopener">å…³äº CommonJS AMD CMD UMD è§„èŒƒçš„å·®å¼‚æ€»ç»“</a></li><li><a href="http://es6.ruanyifeng.com/#docs/module" target="_blank" rel="noopener">Module çš„è¯­æ³•</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;æ¨¡å—åŒ–è§£å†³ä»€ä¹ˆé—®é¢˜&lt;/h2&gt;
&lt;p&gt;éšç€ JavaScript å·¥ç¨‹è¶Šæ¥è¶Šå¤§ï¼Œå›¢é˜Ÿåä½œä¸å¯é¿å…ï¼Œä¸ºäº†æ›´å¥½åœ°å¯¹ä»£ç è¿›è¡Œç®¡ç†å’Œæµ‹è¯•ï¼Œæ¨¡å—åŒ–çš„æ¦‚å¿µé€æ¸å¼•å…¥å‰ç«¯ã€‚æ¨¡å—åŒ–å¯ä»¥é™ä½ååŒå¼€å‘çš„æˆæœ¬ï¼Œå‡å°‘ä»£ç é‡ï¼ŒåŒæ—¶ä¹Ÿæ˜¯â€œé«˜å†…èšï¼Œä½è€¦åˆâ€çš„åŸºç¡€ã€‚&lt;/p&gt;
&lt;p&gt;æ¨¡å—åŒ–ä¸»è¦è§£å†³ä¸¤ä¸ªé—®é¢˜ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å‘½åå†²çª&lt;/li&gt;
&lt;li&gt;æ–‡ä»¶ä¾èµ–ï¼šæ¯”å¦‚ bootstrap éœ€è¦å¼•å…¥ jqueryï¼Œjquery æ–‡ä»¶çš„ä½ç½®å¿…é¡»è¦ bootstrap.js ä¹‹å‰å¼•å…¥ã€‚&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="ES6" scheme="https://lz5z.com/tags/ES6/"/>
    
      <category term="CommonJS" scheme="https://lz5z.com/tags/CommonJS/"/>
    
      <category term="AMD" scheme="https://lz5z.com/tags/AMD/"/>
    
      <category term="CMD" scheme="https://lz5z.com/tags/CMD/"/>
    
  </entry>
  
  <entry>
    <title>JavaScript åƒåœ¾å›æ”¶</title>
    <link href="https://lz5z.com/JavaScript%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/"/>
    <id>https://lz5z.com/JavaScriptåƒåœ¾å›æ”¶/</id>
    <published>2018-04-25T18:01:21.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h2>åƒåœ¾å›æ”¶</h2><p>JavaScript å…·æœ‰è‡ªåŠ¨åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œè¿™ç§åƒåœ¾å›æ”¶æœºåˆ¶åŸç†å…¶å®å¾ˆç®€å•ï¼šæ‰¾å‡ºé‚£äº›ä¸å†ç»§ç»­ä½¿ç”¨çš„å˜é‡ï¼Œç„¶åé‡Šæ”¾å…¶æ‰€å ç”¨çš„å†…å­˜ï¼Œåƒåœ¾å›æ”¶å™¨ä¼šæŒ‰ç…§å›ºå®šçš„æ—¶é—´é—´éš”å‘¨æœŸæ€§åœ°æ‰§è¡Œè¿™ä¸€æ“ä½œã€‚å±€éƒ¨å˜é‡åªæœ‰åœ¨å‡½æ•°æ‰§è¡Œçš„è¿‡ç¨‹ä¸­å­˜åœ¨ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¼šä¸ºå±€éƒ¨å˜é‡åœ¨æ ˆï¼ˆæˆ–è€…å †ï¼‰å†…å­˜ä¸Šåˆ†é…ç©ºé—´ï¼Œç„¶ååœ¨å‡½æ•°ä¸­ä½¿ç”¨è¿™äº›å˜é‡ï¼Œç›´è‡³å‡½æ•°æ‰§è¡Œç»“æŸã€‚åƒåœ¾å›æ”¶å™¨å¿…é¡»è¿½è¸ªå“ªä¸ªå˜é‡æœ‰ç”¨å“ªä¸ªæ²¡ç”¨ï¼Œå¯¹äºä¸å†æœ‰ç”¨çš„å˜é‡æ‰“ä¸Šæ ‡è®°ï¼Œä»¥å¤‡å°†æ¥å›æ”¶å…¶å ç”¨çš„å†…å­˜ï¼Œç”¨äºæ ‡è¯†æ— ç”¨å˜é‡çš„ç­–ç•¥ä¸»è¦æœ‰æ ‡è®°æ¸…é™¤æ³•å’Œå¼•ç”¨è®¡æ•°æ³•ã€‚</p><a id="more"></a><h3>JavaScript å†…å­˜åˆ†é…</h3><p>JavaScript åœ¨å®šä¹‰å˜é‡æ—¶å°±å®Œæˆäº†å†…å­˜åˆ†é…ï¼Œè¿˜å¯ä»¥é€šè¿‡å‡½æ•°è°ƒç”¨åˆ†é…å†…å­˜ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å€¼çš„åˆå§‹åŒ–</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> s = <span class="string">"azerty"</span> <span class="comment">// ç»™å­—ç¬¦ä¸²åˆ†é…å†…å­˜</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> o = &#123;</span><br><span class="line">  a: <span class="number">1</span>,</span><br><span class="line">  b: <span class="literal">null</span></span><br><span class="line">&#125; <span class="comment">// ç»™å¯¹è±¡åŠå…¶åŒ…å«çš„å€¼åˆ†é…å†…å­˜</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»™æ•°ç»„åŠå…¶åŒ…å«çš„å€¼åˆ†é…å†…å­˜ï¼ˆå°±åƒå¯¹è±¡ä¸€æ ·ï¼‰</span></span><br><span class="line"><span class="keyword">var</span> a = [<span class="number">1</span>, <span class="literal">null</span>, <span class="string">"abra"</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">a</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + <span class="number">2</span></span><br><span class="line">&#125; <span class="comment">// ç»™å‡½æ•°ï¼ˆå¯è°ƒç”¨çš„å¯¹è±¡ï¼‰åˆ†é…å†…å­˜</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°è¡¨è¾¾å¼ä¹Ÿèƒ½åˆ†é…ä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">someElement.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  someElement.style.backgroundColor = <span class="string">'blue'</span></span><br><span class="line">&#125;, <span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‡½æ•°è°ƒç”¨åˆ†é…å†…å­˜</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> d = <span class="keyword">new</span> <span class="built_in">Date</span>() <span class="comment">// åˆ†é…ä¸€ä¸ª Date å¯¹è±¡</span></span><br><span class="line"><span class="keyword">var</span> e = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>) <span class="comment">// åˆ†é…ä¸€ä¸ª DOM å…ƒç´ </span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å€¼çš„è¿‡ç¨‹å®é™…ä¸Šæ˜¯å¯¹åˆ†é…å†…å­˜è¿›è¡Œè¯»å–ä¸å†™å…¥çš„æ“ä½œã€‚è¯»å–ä¸å†™å…¥å¯èƒ½æ˜¯å†™å…¥ä¸€ä¸ªå˜é‡æˆ–è€…ä¸€ä¸ªå¯¹è±¡çš„å±æ€§å€¼ï¼Œç”šè‡³ä¼ é€’å‡½æ•°çš„å‚æ•°ã€‚</p><h3>mark and sweep</h3><p>JavaScript ä¸­æœ€å¸¸ç”¨çš„åƒåœ¾å›æ”¶æ–¹å¼å°±æ˜¯æ ‡è®°æ¸…é™¤ï¼ˆmark-and-sweepï¼‰ï¼Œå½“å˜é‡è¿›å…¥ç¯å¢ƒæ—¶ï¼Œå°±å°†è¿™ä¸ªå˜é‡æ ‡è®°â€œè¿›å…¥ç¯å¢ƒâ€ï¼Œå½“å˜é‡ç¦»å¼€ç¯å¢ƒæ—¶ï¼Œå°±å°†å…¶æ ‡è®°ä¸ºâ€œç¦»å¼€ç¯å¢ƒâ€ã€‚è‡³äºæ€ä¹ˆæ ‡è®°æœ‰å¾ˆå¤šç§æ–¹å¼ï¼Œæ¯”å¦‚ç‰¹æ®Šä½çš„åè½¬ã€ç»´æŠ¤ä¸€ä¸ªåˆ—è¡¨ç­‰ã€‚</p><img src="/assets/img/gc_mark_sweep.gif" alt="gc_mark_sweep"><p>åƒåœ¾æ”¶é›†å™¨åœ¨è¿è¡Œçš„æ—¶å€™ä¼šç»™å­˜å‚¨åœ¨å†…å­˜ä¸­çš„æ‰€æœ‰å˜é‡éƒ½åŠ ä¸Šæ ‡è®°ï¼Œç„¶åå®ƒä¼šå»æ‰ç¯å¢ƒä¸­çš„å˜é‡å·²ç»è¢«ç¯å¢ƒä¸­å˜é‡è¢«æ ‡è®°ä¸ºå¼•ç”¨çš„å˜é‡ï¼Œåœ¨æ­¤ä¹‹åå†è¢«æ ‡è®°çš„å˜é‡å°†è¢«è§†ä¸ºå‡†å¤‡åˆ é™¤çš„å˜é‡ã€‚æœ€ååƒåœ¾å›æ”¶å™¨æ¸…é™¤æ ‡è®°çš„å˜é‡ï¼Œå›æ”¶å®ƒä»¬æ‰€å ç”¨çš„å†…å­˜ç©ºé—´ã€‚</p><p>ç›®å‰ä¸»æµæµè§ˆå™¨éƒ½æ˜¯ä½¿ç”¨æ ‡è®°æ¸…é™¤å¼çš„åƒåœ¾å›æ”¶ç­–ç•¥ï¼Œåªä¸è¿‡æ”¶é›†çš„é—´éš”æœ‰æ‰€ä¸åŒã€‚</p><h3>å¼•ç”¨è®¡æ•°ï¼ˆrefefence countingï¼‰</h3><p>å¼•ç”¨è®¡æ•°è·Ÿè¸ªå‡ ä¸ªæ¯ä¸ªå€¼è¢«å¼•ç”¨çš„æ¬¡æ•°ï¼Œå½“å£°æ˜ä¸€ä¸ªå¼•ç”¨ç±»å‹å€¼èµ‹ç»™è¯¥å˜é‡æ—¶ï¼Œåˆ™è¿™ä¸ªå€¼çš„å¼•ç”¨æ¬¡æ•°å°±æ˜¯ 1ï¼Œå¦‚æœåŒä¸€ä¸ªå€¼è¢«èµ‹ç»™å¦å¤–ä¸€ä¸ªå˜é‡ï¼Œåˆ™è¯¥å€¼çš„å¼•ç”¨æ¬¡æ•°åŠ  1ã€‚ç›¸åï¼Œå¦‚æœåŒ…å«å¯¹è¿™ä¸ªå€¼å¼•ç”¨çš„å˜é‡åˆå–äº†å¦å¤–ä¸€ä¸ªå€¼ï¼Œåˆ™è¿™ä¸ªå€¼çš„å¼•ç”¨æ¬¡æ•°å‡ 1ã€‚å½“è¿™ä¸ªå€¼çš„å¼•ç”¨æ¬¡æ•°å˜æˆ 0 æ—¶ï¼Œå°±å¯ä»¥å°†å…¶å†…å­˜ç©ºé—´å›æ”¶ã€‚å½“åƒåœ¾å›æ”¶å™¨å†æ¬¡è¿è¡Œæ—¶ï¼Œå®ƒå°±ä¼šé‡Šæ”¾å“ªäº›å¼•ç”¨æ¬¡æ•°ä¸º 0 çš„å€¼æ‰€å ç”¨çš„å†…å­˜ã€‚</p><p>Netscape Navigator 3.0 æ˜¯æœ€æ—©ä½¿ç”¨å¼•ç”¨è®¡æ•°ç­–ç•¥çš„æµè§ˆå™¨ï¼Œå®ƒå¾ˆå¿«å°±é‡åˆ°ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼šå¾ªç¯å¼•ç”¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">problem</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> obj1 = <span class="keyword">new</span> <span class="built_in">Object</span>()</span><br><span class="line">  <span class="keyword">var</span> obj2 = <span class="keyword">new</span> <span class="built_in">Object</span>()</span><br><span class="line"></span><br><span class="line">  obj1.someOtherObj = obj2</span><br><span class="line">  obj2.anotherObj = obj1    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œobj1 å’Œ obj2 é€šè¿‡å„è‡ªçš„å±æ€§ç›¸äº’å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸¤ä¸ªå¯¹è±¡çš„å¼•ç”¨æ¬¡æ•°éƒ½æ˜¯ 2ã€‚åœ¨é‡‡ç”¨æ ‡è®°æ¸…é™¤ç­–ç•¥çš„ç°å®ä¸­ï¼Œç”±äºå‡½æ•°æ‰§è¡Œåï¼Œä¸¤ä¸ªå¯¹è±¡éƒ½ç¦»å¼€äº†ä½œç”¨åŸŸï¼Œå› æ­¤ç›¸äº’å¼•ç”¨ä¸å­˜åœ¨é—®é¢˜ã€‚</p><p>ä½†æ˜¯åœ¨å¼•ç”¨è®¡æ•°ç­–ç•¥ä¸­ï¼Œå½“å‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼Œobj1 å’Œ obj2 è¿˜å¾—ç»§ç»­å­˜åœ¨ï¼Œå› ä¸ºå®ƒä»¬çš„å¼•ç”¨æ¬¡æ•°æ°¸è¿œä¸ä¼šæ˜¯ 0ï¼Œå¯¼è‡´å†…å­˜æ— æ³•å›æ”¶ã€‚</p><p>Netscape Navigator 4.0 ä¸­æ”¾å¼ƒäº†å¼•ç”¨è®¡æ•°ï¼Œè½¬è€Œä½¿ç”¨æ ‡è®°æ¸…é™¤æ¥å®ç°åƒåœ¾å›æ”¶ã€‚</p><p>IE å­˜åœ¨çš„é—®é¢˜ï¼š</p><p>åœ¨ IE9 ä¹‹å‰ï¼ŒIE ä¸­æœ‰ä¸€éƒ¨åˆ†å¯¹è±¡å¹¶ä¸æ˜¯åŸç”Ÿ JavaScript å¯¹è±¡ã€‚ä¾‹å¦‚ï¼ŒBOM å’Œ DOM ä¸­çš„å¯¹è±¡å°±æ˜¯ C++ å®ç°çš„ COM å¯¹è±¡ï¼Œè€Œ COM å¯¹è±¡çš„åƒåœ¾æ”¶é›†æœºåˆ¶é‡‡ç”¨çš„æ˜¯å¼•ç”¨è®¡æ•°ç­–ç•¥ã€‚å› æ­¤ï¼Œå³ä½¿ IE ä¸­çš„ JavaScript å¼•æ“ä½¿ç”¨æ ‡è®°æ¸…é™¤ç­–ç•¥å®ç°ï¼Œä½†æ˜¯ JS è®¿é—®çš„ COM å¯¹è±¡ä¾ç„¶æ˜¯åŸºäºå¼•ç”¨è®¡æ•°ç­–ç•¥çš„ã€‚å¯ä»¥åœ¨ IE ä¸­æ¶‰åŠåˆ° COM å¯¹è±¡ï¼Œå°±ä¼šå­˜åœ¨å¾ªç¯å¼•ç”¨çš„é—®é¢˜ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ele = <span class="built_in">document</span>.getElementById(<span class="string">'some_element'</span>)</span><br><span class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> <span class="built_in">Object</span>()</span><br><span class="line">obj.ele = ele</span><br><span class="line">ele.someObj = obj</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ä¸€ä¸ª DOM å…ƒç´ ä¸ä¸€ä¸ªåŸç”Ÿ JS å¯¹è±¡ä¹‹é—´åˆ›å»ºäº†å¾ªç¯å¼•ç”¨ï¼Œç”±äº COM çš„å¼•ç”¨è®¡æ•°çš„åƒåœ¾å›æ”¶ç­–ç•¥ï¼Œå¯¼è‡´ä¾‹å­ä¸­çš„ DOM ä»é¡µé¢åˆ é™¤ï¼Œä¹Ÿä¸ä¼šè¢«åƒåœ¾å›æ”¶ã€‚</p><p>è§£å†³åŠæ³•ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">obj.ele = <span class="literal">null</span></span><br><span class="line">ele.someObj = <span class="literal">null</span></span><br></pre></td></tr></table></figure><p>å°†å˜é‡è®¾ç½®ä¸º null æ„å‘³ç€åˆ‡æ–­å˜é‡å’Œå®ƒæ­¤å‰å¼•ç”¨å€¼ä¹‹é—´çš„è¿æ¥ã€‚å½“åƒåœ¾å›æ”¶å™¨ä¸‹æ¬¡è¿è¡Œæ—¶ï¼Œå°±èƒ½åˆ é™¤è¿™äº›å€¼å¹¶å›æ”¶å®ƒä»¬å ç”¨çš„å†…å­˜ã€‚</p><p>IE9 ä¹‹åï¼ŒDOM å’Œ BOM å¯¹è±¡éƒ½è¢«è½¬æ¢æˆç«‹çœŸæ­£çš„ JS å¯¹è±¡ï¼Œè¿™æ ·å°±é¿å…äº†ä¸¤ç§åƒåœ¾å›æ”¶ç®—æ³•å¹¶å­˜å¯¼è‡´çš„é—®é¢˜ã€‚</p><h3>æ€§èƒ½é—®é¢˜</h3><p>åƒåœ¾æ”¶é›†å™¨æ˜¯å‘¨æœŸæ€§è¿è¡Œï¼Œå› æ­¤å…¶è¿è¡Œæ—¶é—´é—´éš”æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„é—®é¢˜ã€‚IE7 ä¹‹å‰çš„åƒåœ¾æ”¶é›†å™¨æ˜¯æ ¹æ®å†…å­˜åˆ†é…é‡è¿è¡Œçš„ï¼Œè¾¾åˆ°æŸä¸€ä¸ªä¸´ç•Œå€¼ï¼ˆ256 ä¸ªå˜é‡ï¼Œ4096 ä¸ªå¯¹è±¡ã€æˆ–è€… 64 KB å­—ç¬¦ä¸²ï¼‰å°±æ˜¯å¯åŠ¨åƒåœ¾å›æ”¶å™¨ï¼Œè¿™å¯¼è‡´äº†ä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœè¯¥è„šæœ¬åœ¨å…¶ç”Ÿå‘½å‘¨æœŸéœ€è¦ä¸€ç›´ä¿æŒè¿™ä¹ˆå¤šå˜é‡ï¼Œåƒåœ¾å›æ”¶å™¨å°±ä¸å¾—ä¸é¢‘ç¹è¿è¡Œã€‚</p><p>äº‹å®ä¸Šï¼Œæµè§ˆå™¨ä¸­ä¸€èˆ¬å¯ä»¥ä¸»åŠ¨è§¦å‘åƒåœ¾æ”¶é›†è¿‡ç¨‹ã€‚åœ¨ IE ä¸­ï¼Œè°ƒç”¨ <code>window.CollectGarbage()</code> æ–¹æ³•ä¼šç«‹å³æ‰§è¡Œåƒåœ¾æ”¶é›†ï¼Œåœ¨ Opera7 ä¹‹åçš„ç‰ˆæœ¬ä¸­ï¼Œè°ƒç”¨ <code>window.opera.collect()</code> ä¹Ÿä¼šå¯åŠ¨åƒåœ¾æ”¶é›†ã€‚</p><h3>ä¼˜åŒ–å†…å­˜</h3><p>æ¯”è¾ƒå¥½çš„åŠæ³•å°±æ˜¯æ‰§è¡Œä»£ç ä¸­åªä¿ç•™å¿…è¦çš„æ•°æ®ï¼Œä¸€æ—¦æ•°æ®ä¸å†æœ‰ç”¨ï¼Œé€šè¿‡è®¾ç½®ä¸º null æ¥é‡Šæ”¾å…¶å¼•ç”¨ï¼ˆdereferencingï¼‰ï¼Œé€‚ç”¨äºå¤§å¤šæ•°å…¨å±€å˜é‡å’Œå…¨å±€å¯¹è±¡çš„å±æ€§ã€‚</p><h2>V8 å†…å­˜æœºåˆ¶</h2><p>V8 å¼•æ“ä¼šé™åˆ¶ JavaScript æ‰€èƒ½ä½¿ç”¨çš„å†…å­˜å¤§å°ï¼Œ64 ä½ç³»ç»Ÿæ˜¯ 1.4GBï¼Œ32 ä½ç³»ç»Ÿæ˜¯ 0.7GBã€‚åœ¨ Node ç¯å¢ƒä¸­ä½¿ç”¨ä¸‹é¢ä¸¤ä¸ªå‚æ•°å¯ä»¥è°ƒæ•´å¯åŠ¨æ—¶å†…å­˜é™åˆ¶çš„å¤§å°ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node --max-nex-space-size=1024 app.js // å•ä½ä¸ºKB</span><br><span class="line">node --max-old-space-size=2000 app.js // å•ä½ä¸ºMB</span><br></pre></td></tr></table></figure><p>è¿™ä¸¤æ¡å‘½ä»¤åˆ†åˆ«å¯¹åº” Node å†…å­˜å †ä¸­çš„ã€Œæ–°ç”Ÿä»£ã€å’Œã€Œè€ç”Ÿä»£ã€</p><h3>V8 çš„å †æ„æˆ</h3><p>V8 å°†å †åˆ†ä¸ºäº†å‡ ä¸ªä¸åŒçš„åŒºåŸŸï¼š</p><ul><li>æ–°ç”ŸåŒºï¼šå¤§å¤šæ•°å¯¹è±¡è¢«åˆ†é…åœ¨è¿™é‡Œã€‚æ–°ç”ŸåŒºæ˜¯ä¸€ä¸ªå¾ˆå°çš„åŒºåŸŸï¼Œåƒåœ¾å›æ”¶åœ¨è¿™ä¸ªåŒºåŸŸéå¸¸é¢‘ç¹ï¼Œä¸å…¶ä»–åŒºåŸŸç›¸ç‹¬ç«‹ã€‚</li><li>è€ç”ŸæŒ‡é’ˆåŒºï¼šè¿™é‡ŒåŒ…å«å¤§å¤šæ•°å¯èƒ½å­˜åœ¨æŒ‡å‘å…¶ä»–å¯¹è±¡çš„æŒ‡é’ˆçš„å¯¹è±¡ã€‚å¤§å¤šæ•°åœ¨æ–°ç”ŸåŒºå­˜æ´»ä¸€æ®µæ—¶é—´ä¹‹åçš„å¯¹è±¡éƒ½ä¼šè¢«æŒªåˆ°è¿™é‡Œã€‚<br>è€ç”Ÿæ•°æ®åŒºï¼šè¿™é‡Œå­˜æ”¾åªåŒ…å«åŸå§‹æ•°æ®çš„å¯¹è±¡ï¼ˆè¿™äº›å¯¹è±¡æ²¡æœ‰æŒ‡å‘å…¶ä»–å¯¹è±¡çš„æŒ‡é’ˆï¼‰ã€‚å­—ç¬¦ä¸²ã€å°ç®±çš„æ•°å­—ä»¥åŠæœªå°ç®±çš„åŒç²¾åº¦æ•°å­—æ•°ç»„ï¼Œåœ¨æ–°ç”ŸåŒºå­˜æ´»ä¸€æ®µæ—¶é—´åä¼šè¢«ç§»åŠ¨åˆ°è¿™é‡Œã€‚</li><li>å¤§å¯¹è±¡åŒºï¼šè¿™é‡Œå­˜æ”¾ä½“ç§¯è¶…è¶Šå…¶ä»–åŒºå¤§å°çš„å¯¹è±¡ã€‚æ¯ä¸ªå¯¹è±¡æœ‰è‡ªå·± mmap äº§ç”Ÿçš„å†…å­˜ã€‚åƒåœ¾å›æ”¶å™¨ä»ä¸ç§»åŠ¨å¤§å¯¹è±¡ã€‚<br>-ä»£ç åŒºï¼šä»£ç å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯åŒ…å« JIT ä¹‹åæŒ‡ä»¤çš„å¯¹è±¡ï¼Œä¼šè¢«åˆ†é…åˆ°è¿™é‡Œã€‚è¿™æ˜¯å”¯ä¸€æ‹¥æœ‰æ‰§è¡Œæƒé™çš„å†…å­˜åŒºï¼ˆä¸è¿‡å¦‚æœä»£ç å¯¹è±¡å› è¿‡å¤§è€Œæ”¾åœ¨å¤§å¯¹è±¡åŒºï¼Œåˆ™è¯¥å¤§å¯¹è±¡æ‰€å¯¹åº”çš„å†…å­˜ä¹Ÿæ˜¯å¯æ‰§è¡Œçš„ã€‚è¯‘æ³¨ï¼šä½†æ˜¯å¤§å¯¹è±¡å†…å­˜åŒºæœ¬èº«ä¸æ˜¯å¯æ‰§è¡Œçš„å†…å­˜åŒºï¼‰ã€‚<br>-Cell åŒºã€å±æ€§ Cell åŒºã€Map åŒºï¼šè¿™äº›åŒºåŸŸå­˜æ”¾ Cellã€å±æ€§ Cell å’Œ Mapï¼Œæ¯ä¸ªåŒºåŸŸå› ä¸ºéƒ½æ˜¯å­˜æ”¾ç›¸åŒå¤§å°çš„å…ƒç´ ï¼Œå› æ­¤å†…å­˜ç»“æ„å¾ˆç®€å•ã€‚</li></ul><h3>åˆ†ä»£å›æ”¶</h3><p>è„šæœ¬ä¸­ï¼Œç»å¤§å¤šæ•°å¯¹è±¡çš„ç”Ÿå­˜æœŸå¾ˆçŸ­ï¼Œåªæœ‰æŸäº›å¯¹è±¡çš„ç”Ÿå­˜æœŸè¾ƒé•¿ã€‚ä¸ºåˆ©ç”¨è¿™ä¸€ç‰¹ç‚¹ï¼ŒV8å°†å †è¿›è¡Œäº†åˆ†ä»£ã€‚å¯¹è±¡èµ·åˆä¼šè¢«åˆ†é…åœ¨æ–°ç”ŸåŒºï¼ˆé€šå¸¸å¾ˆå°ï¼Œåªæœ‰ 1-8 MBï¼Œå…·ä½“æ ¹æ®è¡Œä¸ºæ¥è¿›è¡Œå¯å‘ï¼‰ã€‚åœ¨æ–°ç”ŸåŒºçš„å†…å­˜åˆ†é…éå¸¸å®¹æ˜“ï¼šæˆ‘ä»¬åªéœ€ä¿æœ‰ä¸€ä¸ªæŒ‡å‘å†…å­˜åŒºçš„æŒ‡é’ˆï¼Œä¸æ–­æ ¹æ®æ–°å¯¹è±¡çš„å¤§å°å¯¹å…¶è¿›è¡Œé€’å¢å³å¯ã€‚å½“è¯¥æŒ‡é’ˆè¾¾åˆ°äº†æ–°ç”ŸåŒºçš„æœ«å°¾ï¼Œå°±ä¼šæœ‰ä¸€æ¬¡æ¸…ç†ï¼ˆå°å‘¨æœŸï¼‰ï¼Œæ¸…ç†æ‰æ–°ç”ŸåŒºä¸­ä¸æ´»è·ƒçš„æ­»å¯¹è±¡ã€‚å¯¹äºæ´»è·ƒè¶…è¿‡ 2 ä¸ªå°å‘¨æœŸçš„å¯¹è±¡ï¼Œåˆ™éœ€å°†å…¶ç§»åŠ¨è‡³è€ç”ŸåŒºã€‚è€ç”ŸåŒºåœ¨æ ‡è®°ï¼æ¸…é™¤æˆ–æ ‡è®°ï¼ç´§ç¼©ï¼ˆå¤§å‘¨æœŸï¼‰çš„è¿‡ç¨‹ä¸­è¿›è¡Œå›æ”¶ã€‚å¤§å‘¨æœŸè¿›è¡Œçš„å¹¶ä¸é¢‘ç¹ã€‚ä¸€æ¬¡å¤§å‘¨æœŸé€šå¸¸æ˜¯åœ¨ç§»åŠ¨è¶³å¤Ÿå¤šçš„å¯¹è±¡è‡³è€ç”ŸåŒºåæ‰ä¼šå‘ç”Ÿã€‚è‡³äºè¶³å¤Ÿå¤šåˆ°åº•æ˜¯å¤šå°‘ï¼Œåˆ™æ ¹æ®è€ç”ŸåŒºè‡ªèº«çš„å¤§å°å’Œç¨‹åºçš„åŠ¨å‘æ¥å®šã€‚</p><h2>å‚è€ƒèµ„æ–™</h2><ul><li>ã€ŠJavaScript é«˜çº§ç¨‹åºè®¾è®¡ã€‹</li><li><a href="http://newhtml.net/v8-garbage-collection/" target="_blank" rel="noopener">V8 ä¹‹æ—…ï¼š åƒåœ¾å›æ”¶å™¨</a></li><li><a href="https://segmentfault.com/a/1190000004934938" target="_blank" rel="noopener">NodeJSä¸­è¢«å¿½ç•¥çš„å†…å­˜</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;åƒåœ¾å›æ”¶&lt;/h2&gt;
&lt;p&gt;JavaScript å…·æœ‰è‡ªåŠ¨åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œè¿™ç§åƒåœ¾å›æ”¶æœºåˆ¶åŸç†å…¶å®å¾ˆç®€å•ï¼šæ‰¾å‡ºé‚£äº›ä¸å†ç»§ç»­ä½¿ç”¨çš„å˜é‡ï¼Œç„¶åé‡Šæ”¾å…¶æ‰€å ç”¨çš„å†…å­˜ï¼Œåƒåœ¾å›æ”¶å™¨ä¼šæŒ‰ç…§å›ºå®šçš„æ—¶é—´é—´éš”å‘¨æœŸæ€§åœ°æ‰§è¡Œè¿™ä¸€æ“ä½œã€‚å±€éƒ¨å˜é‡åªæœ‰åœ¨å‡½æ•°æ‰§è¡Œçš„è¿‡ç¨‹ä¸­å­˜åœ¨ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¼šä¸ºå±€éƒ¨å˜é‡åœ¨æ ˆï¼ˆæˆ–è€…å †ï¼‰å†…å­˜ä¸Šåˆ†é…ç©ºé—´ï¼Œç„¶ååœ¨å‡½æ•°ä¸­ä½¿ç”¨è¿™äº›å˜é‡ï¼Œç›´è‡³å‡½æ•°æ‰§è¡Œç»“æŸã€‚åƒåœ¾å›æ”¶å™¨å¿…é¡»è¿½è¸ªå“ªä¸ªå˜é‡æœ‰ç”¨å“ªä¸ªæ²¡ç”¨ï¼Œå¯¹äºä¸å†æœ‰ç”¨çš„å˜é‡æ‰“ä¸Šæ ‡è®°ï¼Œä»¥å¤‡å°†æ¥å›æ”¶å…¶å ç”¨çš„å†…å­˜ï¼Œç”¨äºæ ‡è¯†æ— ç”¨å˜é‡çš„ç­–ç•¥ä¸»è¦æœ‰æ ‡è®°æ¸…é™¤æ³•å’Œå¼•ç”¨è®¡æ•°æ³•ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="GC" scheme="https://lz5z.com/tags/GC/"/>
    
      <category term="V8" scheme="https://lz5z.com/tags/V8/"/>
    
  </entry>
  
  <entry>
    <title>JavaScript å¸¸è§çš„å†…å­˜æ³„æ¼</title>
    <link href="https://lz5z.com/JavaScript-Memory-Leaks/"/>
    <id>https://lz5z.com/JavaScript-Memory-Leaks/</id>
    <published>2018-04-23T22:07:24.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h2>ä»€ä¹ˆæ˜¯å†…å­˜æ³„æ¼</h2><p>JavaScript æ˜¯ä¸€ç§åƒåœ¾å›æ”¶è¯­è¨€ï¼Œåƒåœ¾å›æ”¶è¯­è¨€é€šè¿‡å‘¨æœŸæ€§åœ°æ£€æŸ¥ä¹‹å‰è¢«åˆ†é…çš„å†…å­˜æ˜¯å¦å¯ä»¥ä»åº”ç”¨çš„å…¶å®ƒéƒ¨åˆ†è®¿é—®æ¥å¸®åŠ©å¼€å‘è€…ç®¡ç†å†…å­˜ã€‚å†…å­˜æ³„éœ²æ˜¯æŒ‡å½“ä¸€å—å†…å­˜ä¸å†è¢«åº”ç”¨ç¨‹åºä½¿ç”¨çš„æ—¶å€™ï¼Œç”±äºæŸç§åŸå› ï¼Œè¿™å—å†…å­˜æ²¡æœ‰è¿”è¿˜ç»™æ“ä½œç³»ç»Ÿæˆ–è€…å†…å­˜æ± çš„ç°è±¡ã€‚å†…å­˜æ³„æ¼å¯èƒ½ä¼šå¯¼è‡´åº”ç”¨ç¨‹åºå¡é¡¿æˆ–è€…å´©æºƒã€‚</p><a id="more"></a><h3>æŸ¥çœ‹å†…å­˜æ³„æ¼</h3><p>åœ¨ chrome ä¸­å¯ä»¥é€šè¿‡ performance ä¸­çš„ Memory record æ¥æŸ¥çœ‹ï¼Œé€‰ä¸­ Memory åç‚¹å‡»å·¦è¾¹çš„ Recordï¼Œç„¶åæ¨¡æ‹Ÿç”¨æˆ·çš„æ“ä½œï¼Œä¸€æ®µæ—¶é—´åç‚¹å‡» stopï¼Œåœ¨é¢æ¿ä¸ŠæŸ¥çœ‹è¿™æ®µæ—¶é—´çš„å†…å­˜å ç”¨æƒ…å†µã€‚å¦‚æœå†…å­˜åŸºæœ¬å¹³ç¨³ï¼Œåˆ™æ— å†…å­˜æ³„æ¼æƒ…å†µï¼›å¦‚æœå†…å­˜å ç”¨ä¸æ–­é£™å‡ï¼Œå†…å¯èƒ½å‡ºç°å†…å­˜æ³„æ¼çš„æƒ…å†µã€‚</p><p>åœ¨ Node ç¯å¢ƒä¸­ï¼Œå¯ä»¥è¾“å…¥ <code>process.memoryUsage()</code> æŸ¥çœ‹ Node è¿›ç¨‹çš„å†…å­˜å ç”¨æƒ…å†µã€‚</p><ul><li>rssï¼ˆresident set sizeï¼‰ï¼šè¿›ç¨‹çš„å¸¸é©»å†…å­˜éƒ¨åˆ†ã€‚</li><li>heapTotalï¼š&quot;å †&quot;å ç”¨çš„å†…å­˜ï¼ŒåŒ…æ‹¬ç”¨åˆ°çš„å’Œæ²¡ç”¨åˆ°çš„ã€‚</li><li>heapUsedï¼šç”¨åˆ°çš„å †çš„éƒ¨åˆ†ã€‚</li><li>externalï¼š V8 å¼•æ“å†…éƒ¨çš„ C++ å¯¹è±¡å ç”¨çš„å†…å­˜ã€‚</li></ul><p>åˆ¤æ–­å†…å­˜æ³„æ¼ï¼Œä»¥ heapUsed å­—æ®µä¸ºå‡†ã€‚</p><h2>å¸¸è§çš„å†…å­˜æ³„æ¼</h2><p>ã€ŠJavaScripté«˜çº§ç¨‹åºè®¾è®¡ã€‹ä¸­æåˆ°äº†ä¸€ç§å†…å­˜æ³„æ¼ï¼šç”±äº IE9 ä¹‹å‰çš„ç‰ˆæœ¬å¯¹ JS å¯¹è±¡å’Œ DOM å¯¹è±¡ä¸­ä½¿ç”¨çš„åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œä¼šå¯¼è‡´å¦‚æœé—­åŒ…çš„ä½œç”¨åŸŸé“¾ä¸­ä¿å­˜ç€ä¸€ä¸ª HTML å…ƒç´ ï¼Œé‚£è¯¥å…ƒç´ å°†æ— æ³•é”€æ¯ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">assignHandler</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> element = <span class="built_in">document</span>.getElementById(<span class="string">'someElement'</span>)</span><br><span class="line">  element.onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(element.id)</span><br><span class="line">  &#125;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šä»£ç åˆ›å»ºäº†ä¸€ä¸ªä½œä¸º element å…ƒç´ äº‹ä»¶å¤„ç†ç¨‹åºçš„é—­åŒ…ï¼Œè€Œè¿™ä¸ªé—­åŒ…åˆ™åˆåˆ›å»ºäº†ä¸€ä¸ªå¾ªç¯å¼•ç”¨ï¼ŒåŒ¿åå‡½æ•°ä¸­ä¿å­˜äº†ä¸€ä¸ªå¯¹ element å¯¹è±¡çš„å¼•ç”¨ï¼Œå› æ­¤æ— æ³•å‡å°‘ element çš„å¼•ç”¨æ•°ã€‚åªè¦åŒ¿åå‡½æ•°åœ¨ï¼Œelement çš„å¼•ç”¨æ•°è‡³å°‘æ˜¯ 1ï¼Œå› æ­¤å®ƒæ‰€å ç”¨çš„å†…å­˜å°±æ°¸è¿œæ— æ³•å›æ”¶ã€‚</p><p>è§£å†³åŠæ³•ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">assignHandler</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> element = <span class="built_in">document</span>.getElementById(<span class="string">'someElement'</span>)</span><br><span class="line">  <span class="keyword">var</span> id = element.id</span><br><span class="line">  element.onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(id)</span><br><span class="line">  &#125;</span><br><span class="line">  element = <span class="literal">null</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„: ä¸Šè¿°é—®é¢˜åœ¨ç°ä»£æµè§ˆå™¨ä¸Šå¹¶ä¸ä¼šå‡ºç°</p></blockquote><h3>æ„å¤–çš„å…¨å±€å˜é‡</h3><p>åœ¨ JavaScript é<a href="https://lz5z.com/JavaScript%E4%B8%A5%E6%A0%BC%E6%A8%A1%E5%BC%8F/">ä¸¥æ ¼æ¨¡å¼</a>ä¸­ï¼Œæœªå®šä¹‰çš„å˜é‡ä¼šè‡ªåŠ¨ç»‘å®šåœ¨å…¨å±€å¯¹è±¡ä¸Šï¼ˆwindow/globalï¼‰ï¼Œæ¯”å¦‚ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  bar = <span class="string">'something'</span>    </span><br><span class="line">&#125;</span><br><span class="line">foo()</span><br></pre></td></tr></table></figure><p>foo æ‰§è¡Œçš„æ—¶å€™ï¼Œç”±äºå†…éƒ¨å˜é‡æ²¡æœ‰å®šä¹‰ï¼Œæ‰€ä»¥ç›¸å½“äº <code>window.bar = 'something'</code>ï¼Œå‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼Œæœ¬åº”è¯¥è¢«é”€æ¯çš„å˜é‡ bar å´æ°¸ä¹…çš„ä¿ç•™åœ¨å†…å­˜ä¸­äº†ã€‚</p><p>è§£å†³åŠæ³•ï¼Œä½¿ç”¨<a href="https://lz5z.com/JavaScript%E4%B8%A5%E6%A0%BC%E6%A8%A1%E5%BC%8F/">ä¸¥æ ¼æ¨¡å¼</a>ã€‚</p><p>è™½ç„¶å…¨å±€å˜é‡ä¸Šç»‘å®šçš„å˜é‡æ— æ³•è¢«åƒåœ¾å›æ”¶ï¼Œä½†æ˜¯æœ‰æ—¶éœ€è¦ä½¿ç”¨å…¨å±€å˜é‡å»å­˜å‚¨ä¸´æ—¶ä¿¡æ¯ï¼Œè¿™ä¸ªæ—¶å€™è¦æ ¼å¤–å°å¿ƒï¼Œå¹¶åœ¨å˜é‡ä½¿ç”¨å®Œæ¯•åè®¾ç½®ä¸º nullï¼Œä»¥å›æ”¶å†…å­˜ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.bar = <span class="literal">null</span></span><br><span class="line"><span class="keyword">delete</span> <span class="built_in">window</span>.bar</span><br></pre></td></tr></table></figure><p>ä¸‹é¢å†™ä¸€ä¸ª demoï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">new</span> <span class="built_in">Date</span>().getTime())</span><br><span class="line">    <span class="built_in">window</span>[<span class="string">`<span class="subst">$&#123;<span class="keyword">new</span> <span class="built_in">Date</span>().getTime()&#125;</span>`</span>] = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">1000000</span>).join(<span class="string">'x'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">grow</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  test()</span><br><span class="line">  setTimeout(grow, <span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">document</span>.onload = grow()</span><br></pre></td></tr></table></figure><p>å°†è¿™æ®µè„šæœ¬æ”¾ç½®äºæµè§ˆå™¨ä¸­ï¼Œæ‰“å¼€ chrome performanceï¼Œè®°å½•ä¸€æ®µæ—¶é—´åï¼Œå‘ç°å†…å­˜çº¿æ¡å¦‚ä¸‹ï¼š</p><img src="/assets/img/js-memory-leak.png" alt="js-memory-leak"><p>åŒæ—¶æ‰“å¼€ chrome ä»»åŠ¡ç®¡ç†å™¨ï¼Œä¼šçœ‹åˆ°ä»£è¡¨å½“å‰é¡µé¢çš„æ ‡ç­¾é¡µæ‰€å ç”¨çš„å†…å­˜ä¸æ–­é£™å‡ã€‚</p><h3>JS é”™è¯¯å¼•ç”¨ DOM å…ƒç´ </h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> nodes = <span class="string">''</span>;</span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> item = &#123;</span><br><span class="line">    name: <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">1000000</span>).join(<span class="string">'x'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  nodes = <span class="built_in">document</span>.getElementById(<span class="string">'nodes'</span>)</span><br><span class="line">  nodes.item = item</span><br><span class="line">  nodes.parentElement.removeChild(nodes)</span><br><span class="line"> &#125;)()</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„ dom å…ƒç´ è™½ç„¶å·²ç»ä»é¡µé¢ä¸Šç§»é™¤äº†ï¼Œä½†æ˜¯ js ä¸­ä»ç„¶ä¿å­˜è¿™å¯¹è¯¥ dom å…ƒç´ çš„å¼•ç”¨ï¼Œå¯¼è‡´å†…å­˜ä¸èƒ½é‡Šæ”¾ã€‚</p><p>æ‰“å¼€ chrome æ§åˆ¶å° Memoryï¼Œç‚¹å‡» <code>Take snapshot</code>ï¼š</p><img src="/assets/img/js-memory-leak-profile.png" alt="js-memory-leak-profile"><p>ç‚¹å‡»ç”Ÿæˆçš„ Snapshotï¼Œé€šè¿‡å…³é”®å­— <code>str</code> è¿›è¡Œ filterï¼š</p><img src="/assets/img/js-memory-leak-snapshot.png" alt="js-memory-leak-snapshot"><p>ä»ä¸Šå›¾å¯çŸ¥ï¼Œä»£ç è¿è¡Œç»“æŸåï¼Œå†…å­˜ä¸­çš„é•¿å­—ç¬¦ä¸²ä¾ç„¶æ²¡æœ‰è¢«åƒåœ¾å›æ”¶ã€‚</p><h3>é—­åŒ…å¾ªç¯å¼•ç”¨</h3><p><a href="https://lz5z.com/JavaScript%E9%97%AD%E5%8C%85/">é—­åŒ…</a>æ˜¯æŒ‡å‡½æ•°èƒ½å¤Ÿè®¿é—®çˆ¶ç¯å¢ƒä¸­å®šä¹‰çš„å˜é‡ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> bar = <span class="literal">null</span></span><br><span class="line">  <span class="keyword">var</span> foo = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> originalBar = bar</span><br><span class="line">    <span class="keyword">var</span> unused = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> originalBar</span><br><span class="line">    &#125;</span><br><span class="line">    bar = &#123;</span><br><span class="line">      longStr: <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">1000000</span>).join(<span class="string">'x'</span>),</span><br><span class="line">      someMethod() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">new</span> <span class="built_in">Date</span>().getTime())</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  setInterval(foo, <span class="number">100</span>)</span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­çš„ unused æ˜¯ä¸€ä¸ªé—­åŒ…ï¼Œå› ä¸ºå…¶å†…éƒ¨å¼•ç”¨äº†çˆ¶ç¯å¢ƒä¸­çš„å˜é‡ originalBarï¼Œè™½ç„¶å®ƒè¢«æ²¡æœ‰ä½¿ç”¨ï¼Œä½† v8 å¼•æ“å¹¶ä¸ä¼šæŠŠå®ƒä¼˜åŒ–æ‰ï¼Œå› ä¸º JavaScript é‡Œå­˜åœ¨ eval å‡½æ•°ï¼Œæ‰€ä»¥ v8 å¼•æ“å¹¶ä¸ä¼šéšä¾¿ä¼˜åŒ–æ‰æš‚æ—¶æ²¡æœ‰ä½¿ç”¨çš„å‡½æ•°ã€‚</p><p>éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼š <strong>é—­åŒ…çš„ä½œç”¨åŸŸä¸€æ—¦åˆ›å»ºï¼Œå®ƒä»¬æœ‰åŒæ ·çš„çˆ¶çº§ä½œç”¨åŸŸï¼Œä½œç”¨åŸŸæ˜¯å…±äº«çš„</strong>ã€‚</p><p>bar å¼•ç”¨äº†someMethodï¼ŒsomeMethod è¿™ä¸ªå‡½æ•°ä¸ unused è¿™ä¸ªé—­åŒ…å…±äº«ä¸€ä¸ªé—­åŒ…ä¸Šä¸‹æ–‡ã€‚æ‰€ä»¥ someMethod ä¹Ÿå¼•ç”¨äº† originalBar è¿™ä¸ªå˜é‡ã€‚</p><p>å› æ­¤å¼•ç”¨é“¾å¦‚ä¸‹ï¼š</p><p>GCHandler -&gt; foo -&gt; bar -&gt; someMethod -&gt; originalBar -&gt; someMethod(old) -&gt; originalBar(older)-&gt; someMethod(older)</p><p>é€ æˆäº†é—­åŒ…çš„å¾ªç¯å¼•ç”¨ã€‚</p><img src="/assets/img/js-memory-leak-clouser.png" alt="js-memory-leak-clouser"><h2>å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://segmentfault.com/a/1190000008901861" target="_blank" rel="noopener">javascriptå…¸å‹å†…å­˜æ³„æ¼åŠchromeçš„æ’æŸ¥æ–¹æ³•</a></li><li>ã€ŠJavaScripté«˜çº§ç¨‹åºè®¾è®¡ã€‹</li><li><a href="https://github.com/wengjq/Blog/issues/1" target="_blank" rel="noopener">4ç§JavaScriptå†…å­˜æ³„æ¼æµ…æåŠå¦‚ä½•ç”¨è°·æ­Œå·¥å…·æŸ¥å†…å­˜æ³„éœ²</a></li><li><a href="https://auth0.com/blog/four-types-of-leaks-in-your-javascript-code-and-how-to-get-rid-of-them/" target="_blank" rel="noopener">4 Types of Memory Leaks in JavaScript and How to Get Rid Of Them</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;ä»€ä¹ˆæ˜¯å†…å­˜æ³„æ¼&lt;/h2&gt;
&lt;p&gt;JavaScript æ˜¯ä¸€ç§åƒåœ¾å›æ”¶è¯­è¨€ï¼Œåƒåœ¾å›æ”¶è¯­è¨€é€šè¿‡å‘¨æœŸæ€§åœ°æ£€æŸ¥ä¹‹å‰è¢«åˆ†é…çš„å†…å­˜æ˜¯å¦å¯ä»¥ä»åº”ç”¨çš„å…¶å®ƒéƒ¨åˆ†è®¿é—®æ¥å¸®åŠ©å¼€å‘è€…ç®¡ç†å†…å­˜ã€‚å†…å­˜æ³„éœ²æ˜¯æŒ‡å½“ä¸€å—å†…å­˜ä¸å†è¢«åº”ç”¨ç¨‹åºä½¿ç”¨çš„æ—¶å€™ï¼Œç”±äºæŸç§åŸå› ï¼Œè¿™å—å†…å­˜æ²¡æœ‰è¿”è¿˜ç»™æ“ä½œç³»ç»Ÿæˆ–è€…å†…å­˜æ± çš„ç°è±¡ã€‚å†…å­˜æ³„æ¼å¯èƒ½ä¼šå¯¼è‡´åº”ç”¨ç¨‹åºå¡é¡¿æˆ–è€…å´©æºƒã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="https://lz5z.com/tags/JavaScript/"/>
    
      <category term="å†…å­˜æ³„æ¼" scheme="https://lz5z.com/tags/%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F/"/>
    
      <category term="Memory Leaks" scheme="https://lz5z.com/tags/Memory-Leaks/"/>
    
  </entry>
  
  <entry>
    <title>Vim å­¦ä¹ </title>
    <link href="https://lz5z.com/vim-study/"/>
    <id>https://lz5z.com/vim-study/</id>
    <published>2018-04-19T13:09:32.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡çš„å†…å®¹æ¥è‡ª vimtutor(v1.7)ï¼Œåœ¨ Unix ç³»ç»Ÿä¸‹è¾“å…¥ â€œvimtutorâ€ å³å¯è¿›å…¥æ•™å­¦æ¨¡å‹ã€‚è¿™é‡Œè®°å½•ä¸‹æ¥å­¦ä¹ ç‚¹æ»´ï¼Œæ–¹ä¾¿ä»¥åæŸ¥çœ‹ã€‚</p><h2>Vim ç®€ä»‹</h2><p>Vim æ˜¯ä¸€æ¬¾ç”± Vi æ´¾ç”Ÿå‡ºæ¥çš„å‘½ä»¤è¡Œç¼–è¾‘å™¨ï¼Œå…·æœ‰è¯­æ³•é«˜äº®ã€ä»£ç æŠ˜å ã€å¤šè¯­è¨€æ”¯æŒã€å¤šè§†å›¾ç­‰å¼ºå¤§çš„åŠŸèƒ½ï¼Œå¹¶ä¸”æ”¯æŒæ’ä»¶æ‰©å±•å’Œè°ƒç”¨è„šæœ¬è¯­è¨€ã€‚Vim æœ‰å¤šç§æ¨¡å¼ï¼Œå…¶ä¸­æœ€å¸¸ç”¨çš„ä¸ºæ’å…¥å’Œæ‰§è¡Œæ¨¡å¼ï¼Œä»…ä»…é€šè¿‡é”®ç›˜æ¥åœ¨è¿™äº›æ¨¡å¼ä¹‹ä¸­åˆ‡æ¢ï¼Œå¤§å¤§æé«˜äº†ç¨‹åºå¼€å‘æ•ˆç‡ã€‚</p><h2>Vim ä½¿ç”¨</h2><h3>ç§»åŠ¨å…‰æ ‡</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">è¦ç§»åŠ¨å…‰æ ‡ä½¿ç”¨ hã€jã€kã€l é”®</span><br><span class="line">     ^</span><br><span class="line">     k        </span><br><span class="line">&lt; h       l &gt;</span><br><span class="line">     j</span><br><span class="line">     v</span><br></pre></td></tr></table></figure><a id="more"></a><h3>Vim è¿›å…¥å’Œé€€å‡º</h3><p>é€šè¿‡ Vim + æ–‡ä»¶åè¿›å»æ–‡ä»¶åï¼Œé»˜è®¤ä¸ºæ™®é€šæ¨¡å¼ã€‚æ³¨æ„è¿›å…¥æ™®é€šæ¨¡å¼åè¯·å‹¿å¼€å¯ Shift-Lock(å¤§å°å†™é”å®šé”®)ã€‚</p><p>é€€å‡º Vimï¼ŒæŒ‰ <esc> é”®ï¼Œç„¶åè¾“å…¥ <code>:q!</code> &lt;å›è½¦&gt;ã€‚ è¿™ç§æ–¹å¼é€€å‡ºç¼–è¾‘å™¨ä¼šä¸¢å¼ƒè¿›å…¥ç¼–è¾‘å™¨ä»¥æ¥æ‰€åšçš„æ”¹åŠ¨ã€‚</esc></p><h3>æ–‡æœ¬ç¼–è¾‘-åˆ é™¤</h3><p>åœ¨æ™®é€šæ¨¡å¼ä¸‹ï¼ŒæŒ‰ x é”®æ¥åˆ é™¤å…‰æ ‡æ‰€åœ¨ä½ç½®çš„å­—ç¬¦ã€‚</p><h3>æ–‡æœ¬ç¼–è¾‘-æ’å…¥</h3><p>åœ¨æ™®é€šæ¨¡å¼ä¸‹ï¼ŒæŒ‰ i é”®æ¥æ’å…¥æ–‡æœ¬ã€‚</p><h3>æ–‡æœ¬ç¼–è¾‘-æ·»åŠ </h3><p>æŒ‰ a é”®æ¥æ·»åŠ æ–‡æœ¬ã€‚</p><p>æ’å…¥ä¸æ·»åŠ ç›´æ¥çš„åŒºåˆ«ï¼š</p><p>æ’å…¥æ˜¯åœ¨å…‰æ ‡å‰æ’å…¥æ–‡æœ¬ï¼Œæ·»åŠ å…‰æ ‡å­—æ¯åé¢æ·»åŠ ã€‚</p><h3>ç¼–è¾‘æ–‡ä»¶</h3><p>ä½¿ç”¨ <code>:wq</code> ä»¥ä¿å­˜æ–‡ä»¶å¹¶é€€å‡º</p><h3>åˆ é™¤ç±»å‘½ä»¤</h3><p>è¾“å…¥ <code>dw</code> å¯ä»¥ä»å…‰æ ‡å¤„åˆ é™¤è‡³ä¸€ä¸ªå•è¯çš„æœ«ã€‚</p><p>è¾“å…¥ <code>d$</code> ä»å½“å‰å…‰æ ‡åˆ é™¤åˆ°è¡Œæœ«ã€‚</p><p>è¾“å…¥ <code>de</code> ä»å½“å‰å…‰æ ‡å½“å‰ä½ç½®ç›´åˆ°å•è¯æœ«å°¾ï¼ŒåŒ…æ‹¬æœ€åä¸€ä¸ªå­—ç¬¦ã€‚</p><p>è¾“å…¥ <code>dd</code> åˆ é™¤æ•´è¡Œã€‚</p><p>è¾“å…¥ <code>2dd</code> åˆ é™¤ä¸¤è¡Œã€‚</p><h3>ç§»åŠ¨å…‰æ ‡</h3><p>è¾“å…¥ <code>2w</code> ä½¿å…‰æ ‡å‘åç§»åŠ¨ä¸¤ä¸ªå•è¯ã€‚</p><p>è¾“å…¥ <code>3e</code> ä½¿å…‰æ ‡å‘åç§»åŠ¨åˆ°ç¬¬ä¸‰ä¸ªå•è¯çš„æœ«å°¾ã€‚</p><p>æ¯”å¦‚ä¹‹å‰çš„å…‰æ ‡ä½ç½®ä¸ºï¼š</p><p>â€”&gt; |this is a demo.</p><p>è¾“å…¥ <code>2w</code>:</p><p>â€”&gt; this is |a demo.</p><p>è¾“å…¥ <code>2e</code>:</p><p>â€”&gt; this i|s a demo.</p><h3>è®¡æ•°åˆ é™¤</h3><p>â€”&gt; |this is a demo</p><p><code>d2w</code>: â€”&gt; |a demo.</p><p><code>d2e</code>: â€”&gt; | a demo.</p><h3>æ’¤é”€</h3><p>è¾“å…¥ <code>u</code> æ¥æ’¤æ¶ˆæœ€åæ‰§è¡Œçš„å‘½ä»¤ã€‚</p><p>è¾“å…¥ <code>U</code> æ¥æ’¤æ¶ˆå¯¹æ•´è¡Œçš„ä¿®æ”¹ã€‚</p><p>ä½¿ç”¨ <code>CTRL-R</code> ï¼ˆå…ˆæŒ‰ CTRL å†æŒ‰ Rï¼‰æ’¤é”€æ’¤é”€å‘½ä»¤ã€‚</p><h2>åˆ é™¤ä¸ç²˜è´´</h2><p>åˆ é™¤æ“ä½œåï¼Œè¾“å…¥ <code>p</code> å°†æœ€åä¸€æ¬¡åˆ é™¤çš„å†…å®¹ç½®å…¥å…‰æ ‡ä¹‹åã€‚</p><h2>æ›¿æ¢</h2><p>è¾“å…¥ <code>r</code> åŠ å­—ç¬¦æ›¿æ¢å…‰æ ‡åä¸€ä¸ªå­—ç¬¦ã€‚</p><h2>æ›´æ”¹</h2><p>è¦æ”¹å˜æ–‡æœ¬ç›´åˆ°ä¸€ä¸ªå•è¯çš„æœ«å°¾ï¼Œè¯·è¾“å…¥ <code>ce</code>ã€‚</p><p><code>ce</code> å‘½ä»¤ç›¸å½“äºåˆ é™¤ä¸€ä¸ªå•è¯çš„åŒæ—¶ï¼Œè¿›å…¥æ’å…¥æ¨¡å¼ã€‚</p><p>ä½¿ç”¨ <code>c2w</code> åˆ é™¤ä¸¤ä¸ªå•è¯å¹¶ä¸”è¿›å…¥æ’å…¥æ¨¡å¼ã€‚</p><p>ä½¿ç”¨ <code>c$</code> åˆ é™¤å…‰æ ‡åæ‰€æœ‰å†…å®¹å¹¶ä¸”è¿›å…¥æ’å…¥æ¨¡å¼ã€‚</p><h3>æ–‡ä»¶å®šä½</h3><p>è¾“å…¥ <code>CTRL-G</code> æ˜¾ç¤ºå½“å‰ç¼–è¾‘æ–‡ä»¶ä¸­å½“å‰å…‰æ ‡æ‰€åœ¨è¡Œä½ç½®ä»¥åŠæ–‡ä»¶çŠ¶æ€ä¿¡æ¯ã€‚</p><p>è¾“å…¥è¡Œå· + G (æ³¨æ„æ˜¯å¤§å†™) å¯ä»¥ç›´æ¥å°†å…‰æ ‡å®šä½äºè¡Œæ•°ã€‚</p><h3>æ–‡ä»¶æœç´¢</h3><p>è¾“å…¥ <code>/</code> åŠ ä¸Šå­—ç¬¦ä¸²ï¼Œå¯ä»¥åœ¨å½“å‰æ–‡ä»¶ä¸­æŸ¥æ‰¾è¯¥å­—ç¬¦ä¸²ã€‚</p><p>è¦æŸ¥æ‰¾åŒä¸Šä¸€æ¬¡çš„å­—ç¬¦ä¸²ï¼Œåªéœ€è¦æŒ‰ <code>n</code> é”®ã€‚è¦å‘ç›¸åæ–¹å‘æŸ¥æ‰¾åŒä¸Šä¸€æ¬¡çš„å­—ç¬¦ä¸²ï¼Œè¯·è¾“å…¥å¤§å†™ <code>N</code> å³å¯ã€‚</p><p>å›åˆ°ä¹‹å‰çš„ä½ç½®æŒ‰ <code>CTRL-O</code>ï¼Œé‡å¤æŒ‰å¯ä»¥å›é€€æ›´å¤šæ­¥ã€‚CTRL-I ä¼šè·³è½¬åˆ°è¾ƒæ–°çš„ä½ç½®ã€‚</p><p>æç¤ºï¼šå¦‚æœæŸ¥æ‰¾å·²ç»åˆ°è¾¾æ–‡ä»¶æœ«å°¾ï¼ŒæŸ¥æ‰¾ä¼šè‡ªåŠ¨ä»æ–‡ä»¶å¤´éƒ¨ç»§ç»­æŸ¥æ‰¾ï¼Œé™¤é â€˜wrapscanâ€™ é€‰é¡¹è¢«å¤ä½ã€‚</p><h3>é…å¯¹æ‹¬å·çš„æŸ¥æ‰¾</h3><p>æŠŠå…‰æ ‡ç½®äºæœ‰æ‹¬å·ï¼ˆ (ã€[ æˆ– { ï¼‰çš„åœ°æ–¹ï¼ŒæŒ‰ä¸‹ <code>%</code> å…‰æ ‡ä¼šè‡ªåŠ¨å®šä½åˆ°ä¸å…¶é…å¯¹çš„æ‹¬å·å¤„ã€‚</p><h3>æ›¿æ¢å‘½ä»¤</h3><p>åœ¨ä¸€è¡Œå†…æ›¿æ¢å¤´ä¸€ä¸ªå­—ç¬¦ä¸² old ä¸ºæ–°çš„å­—ç¬¦ä¸² newï¼Œè¾“å…¥ <code>:s/old/new</code>ã€‚</p><p>åœ¨ä¸€è¡Œå†…æ›¿æ¢æ‰€æœ‰çš„å­—ç¬¦ä¸² old ä¸ºæ–°çš„å­—ç¬¦ä¸² newï¼Œè¾“å…¥ <code>:s/old/new/g</code>ã€‚</p><p>åœ¨ä¸¤è¡Œå†…æ›¿æ¢æ‰€æœ‰çš„å­—ç¬¦ä¸² old ä¸ºæ–°çš„å­—ç¬¦ä¸² newï¼Œè¾“å…¥ <code>:#,#s/old/new/g</code>ï¼Œå…¶ä¸­ #, # ä»£è¡¨çš„æ˜¯æ›¿æ¢æ“ä½œçš„è‹¥å¹²è¡Œä¸­é¦–å°¾ä¸¤è¡Œçš„è¡Œå·ã€‚</p><p>åœ¨æ–‡ä»¶å†…æ›¿æ¢æ‰€æœ‰çš„å­—ç¬¦ä¸² old ä¸ºæ–°çš„å­—ç¬¦ä¸² newï¼Œè¾“å…¥ <code>:%s/old/new/g</code></p><p>è¿›è¡Œå…¨æ–‡æ›¿æ¢æ—¶è¯¢é—®ç”¨æˆ·ç¡®è®¤æ¯ä¸ªæ›¿æ¢éœ€æ·»åŠ  c æ ‡å¿— <code>:%s/old/new/gc</code></p><h3>Vim ä¸­æ‰§è¡Œå¤–éƒ¨å‘½ä»¤</h3><p>è¾“å…¥ <code>:!</code> ç„¶åç´§æ¥ç€è¾“å…¥ä¸€ä¸ªå¤–éƒ¨å‘½ä»¤å¯ä»¥æ‰§è¡Œè¯¥å¤–éƒ¨å‘½ä»¤ï¼Œæ¯”å¦‚ <code>:!ls</code> å¯ä»¥åœ¨ Vim ä¸­æŸ¥çœ‹å½“å‰ç›®å½•ã€‚</p><h3>æ–‡ä»¶ä¿å­˜</h3><p>è¦å°†å¯¹æ–‡ä»¶çš„æ”¹åŠ¨ä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œè¯·è¾“å…¥ <code>:w FILENAME</code>ã€‚ è¯¥å‘½ä»¤ä¼šä»¥ FILENAME ä¸ºæ–‡ä»¶åä¿å­˜æ•´ä¸ªæ–‡ä»¶ã€‚</p><h3>é€‰æ‹©æ€§ä¿å­˜</h3><p>ç§»åŠ¨å…‰æ ‡è‡³æŸä¸€è¡Œï¼ŒæŒ‰ä¸‹ <code>v</code> é”®è¿›å…¥å¯è§†æ¨¡å¼ï¼Œç§»åŠ¨å…‰æ ‡é€‰ä¸­å†…å®¹ï¼Œç„¶åæŒ‰ <code>:</code>ï¼Œå±å¹•åº•éƒ¨ä¼šå‡ºç° <code>:'&lt;,'&gt;</code>ï¼Œå†è¾“å…¥ <code>w FILENAME</code> å¯å°†é€‰ä¸­çš„å†…å®¹æŠ¥é”™åˆ° FILENAME ä¸­ã€‚</p><p>æç¤ºï¼šæŒ‰ v é”®ä½¿ Vim è¿›å…¥å¯è§†æ¨¡å¼è¿›è¡Œé€‰å–ã€‚å¯ä»¥å››å¤„ç§»åŠ¨å…‰æ ‡ä½¿é€‰å–åŒºåŸŸå˜å¤§æˆ–å˜å°ã€‚æ¥ç€å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæ“ä½œç¬¦å¯¹é€‰ä¸­æ–‡æœ¬è¿›è¡Œæ“ä½œã€‚ä¾‹å¦‚ï¼ŒæŒ‰ d é”®ä¼šåˆ é™¤é€‰ä¸­çš„æ–‡æœ¬å†…å®¹ã€‚</p><h3>æå–å’Œåˆå¹¶æ–‡ä»¶</h3><p>è¦å‘å½“å‰æ–‡ä»¶ä¸­æ’å…¥å¦å¤–çš„æ–‡ä»¶çš„å†…å®¹ï¼Œè¯·è¾“å…¥ <code>:r FILENAME</code>ã€‚</p><p><code>:r FILENAME</code> å¯æå–ç£ç›˜æ–‡ä»¶ FILENAME å¹¶å°†å…¶æ’å…¥åˆ°å½“å‰æ–‡ä»¶çš„å…‰æ ‡ä½ç½®åé¢ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ¬æ–‡çš„å†…å®¹æ¥è‡ª vimtutor(v1.7)ï¼Œåœ¨ Unix ç³»ç»Ÿä¸‹è¾“å…¥ â€œvimtutorâ€ å³å¯è¿›å…¥æ•™å­¦æ¨¡å‹ã€‚è¿™é‡Œè®°å½•ä¸‹æ¥å­¦ä¹ ç‚¹æ»´ï¼Œæ–¹ä¾¿ä»¥åæŸ¥çœ‹ã€‚&lt;/p&gt;
&lt;h2&gt;Vim ç®€ä»‹&lt;/h2&gt;
&lt;p&gt;Vim æ˜¯ä¸€æ¬¾ç”± Vi æ´¾ç”Ÿå‡ºæ¥çš„å‘½ä»¤è¡Œç¼–è¾‘å™¨ï¼Œå…·æœ‰è¯­æ³•é«˜äº®ã€ä»£ç æŠ˜å ã€å¤šè¯­è¨€æ”¯æŒã€å¤šè§†å›¾ç­‰å¼ºå¤§çš„åŠŸèƒ½ï¼Œå¹¶ä¸”æ”¯æŒæ’ä»¶æ‰©å±•å’Œè°ƒç”¨è„šæœ¬è¯­è¨€ã€‚Vim æœ‰å¤šç§æ¨¡å¼ï¼Œå…¶ä¸­æœ€å¸¸ç”¨çš„ä¸ºæ’å…¥å’Œæ‰§è¡Œæ¨¡å¼ï¼Œä»…ä»…é€šè¿‡é”®ç›˜æ¥åœ¨è¿™äº›æ¨¡å¼ä¹‹ä¸­åˆ‡æ¢ï¼Œå¤§å¤§æé«˜äº†ç¨‹åºå¼€å‘æ•ˆç‡ã€‚&lt;/p&gt;
&lt;h2&gt;Vim ä½¿ç”¨&lt;/h2&gt;
&lt;h3&gt;ç§»åŠ¨å…‰æ ‡&lt;/h3&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;è¦ç§»åŠ¨å…‰æ ‡ä½¿ç”¨ hã€jã€kã€l é”®&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     ^&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     k        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt; h       l &amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     j&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     v&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Tools" scheme="https://lz5z.com/categories/Tools/"/>
    
    
      <category term="Vim" scheme="https://lz5z.com/tags/Vim/"/>
    
      <category term="vimtutor" scheme="https://lz5z.com/tags/vimtutor/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨ requestAnimationFrame å®ç°åŠ¨ç”»</title>
    <link href="https://lz5z.com/requestAnimationFrame/"/>
    <id>https://lz5z.com/requestAnimationFrame/</id>
    <published>2018-04-14T18:24:28.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h2>å¦‚ä½•å®ç°ä¸€ä¸ªåŠ¨ç”»</h2><p>æˆ‘ä»¬æ¥å®ç°ä¸€ä¸ªæœ€ç®€å•çš„éœ€æ±‚ï¼Œå°†ä¸€ä¸ªå…ƒç´ ä»å±å¹•å·¦è¾¹å‡åŒ€åœ°ç§»åŠ¨åˆ°å±å¹•å³è¾¹ã€‚</p><p>ä¸‹é¢æ˜¯æ•ˆæœ:</p><!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.9.0">  <style>    .animate-warpper {      width: 100%;      height: 70px;    }    @keyframes move_animation {      0% { left: 0px; }      100% { left: calc(100% - 60px); }    }    .animate-div {      width: 60px;      height: 40px;      position: absolute;      left: 0;      border-radius: 5px;      background: #92B901;      transform: translateZ(0);      -webkit-transform: translateZ(0);      animation: move_animation 5s linear 2s infinite alternate;    }  </style></head><body>  <section class="animate-warpper">     <div class="animate-div"></div>  </section></body></html><a id="more"></a><p>ï¼ˆ1ï¼‰css animation</p><p>ç”¨ css å®ç°æ˜¯æœ€åˆç†ä¹Ÿæ˜¯æœ€é«˜æ•ˆçš„ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@keyframes</span> move_animation1 &#123;</span><br><span class="line">  0% &#123; <span class="attribute">left</span>: <span class="number">0px</span>; &#125;</span><br><span class="line">  100% &#123; <span class="attribute">left</span>: <span class="built_in">calc</span>(<span class="number">100%</span> - <span class="number">60px</span>); &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@keyframes</span> move_animation &#123;</span><br><span class="line">  0% &#123; <span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">0</span>); &#125;</span><br><span class="line">  50% &#123; <span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">250px</span>); &#125;</span><br><span class="line">  100% &#123; <span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">500px</span>)); &#125;    </span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.animate-div</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">60px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">40px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#92B901</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateZ</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="attribute">-webkit-transform</span>: <span class="built_in">translateZ</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="attribute">animation</span>: move_animation <span class="number">5s</span> linear <span class="number">2s</span> infinite alternate;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨ï¼š<code>transform:translateZ(0);</code> ç”¨æ¥å¼€å¯ chrome GPU åŠ é€Ÿï¼Œè§£å†³åŠ¨ç”»â€å¡é¡¿â€ã€‚<br>åœ¨åŠ¨ç”»ä¸­ä½¿ç”¨ transform æ¯” left/top æ€§èƒ½æ›´å¥½ï¼Œèƒ½å‡å°‘æµè§ˆå™¨ repaintã€‚</p></blockquote><p>ï¼ˆ2ï¼‰å‡å¦‚ç”¨ JS å®ç°å‘¢</p><p>é¦–å…ˆæƒ³åˆ°çš„æ˜¯ setInterval/setTimeoutï¼ŒåŸç†å°±æ˜¯åˆ©ç”¨äººçœ¼çš„è§†è§‰æ®‹ç•™å’Œç”µè„‘å±å¹•çš„åˆ·æ–°ï¼Œè®©å…ƒç´ ä»¥è¿è´¯å¹³æ»‘çš„æ–¹å¼é€æ­¥æ”¹å˜ä½ç½®ï¼Œæœ€ç»ˆå®ç°åŠ¨ç”»çš„æ•ˆæœã€‚</p><p>å¸¸ç”¨çš„å±å¹•åˆ·æ–°é¢‘ç‡ä¸º 60Hzï¼Œä¸€äº›ç”µç«å±å¹•åˆ™ä¸º 144Hzã€‚æˆ‘ä»¬ä»¥å¸¸ç”¨çš„åˆ·æ–°é¢‘ç‡ä¸ºä¾‹ï¼Œ60Hz æ„å‘³ç€å±å¹•æ¯ 1000 / 60 â‰ˆ 16.7ms åˆ·æ–°ä¸€æ¬¡ï¼Œæ‰€ä»¥æˆ‘ä»¬è®¾ç½® setInterval çš„é—´éš”ä¸º 16.7msï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> animateDiv = <span class="built_in">document</span>.querySelector(<span class="string">'.animate-div'</span>)</span><br><span class="line"><span class="keyword">let</span> i = <span class="number">0</span></span><br><span class="line"><span class="keyword">let</span> inter = setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  animateDiv.style.left = <span class="number">1</span>/<span class="number">3</span> * (++i) + <span class="string">'%'</span></span><br><span class="line">  <span class="keyword">if</span> (i === <span class="number">300</span>) clearInterval(inter)</span><br><span class="line">&#125;, <span class="number">16.7</span>)</span><br></pre></td></tr></table></figure><p>setInterval/setTimeout å­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼š</p><blockquote><ul><li>setTimeout çš„æ‰§è¡Œæ—¶é—´å¹¶ä¸æ˜¯ç¡®å®šçš„ã€‚åœ¨ Javascript ä¸­ï¼Œ setTimeout ä»»åŠ¡è¢«æ”¾è¿›äº†å¼‚æ­¥é˜Ÿåˆ—ä¸­ï¼Œåªæœ‰å½“ä¸»çº¿ç¨‹ä¸Šçš„ä»»åŠ¡æ‰§è¡Œå®Œä»¥åï¼Œæ‰ä¼šå»æ£€æŸ¥è¯¥é˜Ÿåˆ—é‡Œçš„ä»»åŠ¡æ˜¯å¦éœ€è¦å¼€å§‹æ‰§è¡Œï¼Œå› æ­¤ setTimeout çš„å®é™…æ‰§è¡Œæ—¶é—´ä¸€èˆ¬è¦æ¯”å…¶è®¾å®šçš„æ—¶é—´æ™šä¸€äº›ã€‚</li><li>åˆ·æ–°é¢‘ç‡å—å±å¹•åˆ†è¾¨ç‡å’Œå±å¹•å°ºå¯¸çš„å½±å“ï¼Œå› æ­¤ä¸åŒè®¾å¤‡çš„å±å¹•åˆ·æ–°é¢‘ç‡å¯èƒ½ä¼šä¸åŒï¼Œè€Œ setTimeout åªèƒ½è®¾ç½®ä¸€ä¸ªå›ºå®šçš„æ—¶é—´é—´éš”ï¼Œè¿™ä¸ªæ—¶é—´ä¸ä¸€å®šå’Œå±å¹•çš„åˆ·æ–°æ—¶é—´ç›¸åŒã€‚</li></ul></blockquote><p>ä»¥ä¸Šä¸¤ç§æƒ…å†µéƒ½ä¼šå¯¼è‡´ setTimeout çš„æ‰§è¡Œæ­¥è°ƒå’Œå±å¹•çš„åˆ·æ–°æ­¥è°ƒä¸ä¸€è‡´ï¼Œä»è€Œå¼•èµ·ä¸¢å¸§ç°è±¡ã€‚ è™½ç„¶åœ¨ä¸Šè¿°ä»£ç ä¸­æˆ‘ä»¬å°†æ—¶é—´é—´éš”è®¾ç½®ä¸º 16.7msï¼Œä½†æ˜¯è¿˜æ˜¯ä¸èƒ½å®Œå…¨é¿å…ä¸¢å¸§çš„ç°è±¡ã€‚</p><p>ï¼ˆ3ï¼‰requestAnimationFrame</p><p>requestAnimationFrame ä¸ setTimeout/setInterval æœ€å¤§çš„åŒºåˆ«æ˜¯ç”±ç³»ç»Ÿè‡ªå·±çš„åˆ·æ–°æœºåˆ¶æ¥å†³å®šä»€ä¹ˆæ—¶å€™è°ƒç”¨åŠ¨ç”»å‡½æ•°ï¼Œå¼€å‘è€…åªéœ€è¦å®šä¹‰å¥½åŠ¨ç”»å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼šåœ¨æµè§ˆå™¨é‡ç»˜ä¹‹å‰è°ƒç”¨ã€‚</p><h2>requestAnimationFrame ç®€ä»‹</h2><p>requestAnimationFrame æ¥æ”¶ä¸€ä¸ªå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œ<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/DOMHighResTimeStamp" target="_blank" rel="noopener">DOMHighResTimeStamp</a>ï¼ŒæŒ‡ç¤ºå½“å‰è¢« requestAnimationFrame() æ’åºçš„å›è°ƒå‡½æ•°è¢«è§¦å‘çš„æ—¶é—´ã€‚å›è°ƒå‡½æ•°ä¸­ä¼ å…¥æ—¶é—´æˆ³ä½œä¸ºå‚æ•°ï¼Œè¯¥æ—¶é—´æˆ³æ˜¯ä¸€ä¸ªåè¿›åˆ¶æ•°ï¼Œå•ä½æ¯«ç§’ï¼Œæœ€å°ç²¾åº¦ä¸º 1msã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> animateDiv = <span class="built_in">document</span>.querySelector(<span class="string">'.animate-div'</span>)</span><br><span class="line"><span class="keyword">let</span> start = <span class="literal">null</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å›è°ƒå‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">step</span>(<span class="params">timestamp</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!start) start = timestamp</span><br><span class="line">    <span class="keyword">let</span> progress = timestamp - start</span><br><span class="line">    animateDiv.style.left = progress + <span class="string">'px'</span></span><br><span class="line">    <span class="keyword">if</span> (progress &lt; <span class="number">350</span>) &#123;</span><br><span class="line">        <span class="comment">// åœ¨åŠ¨ç”»æ²¡æœ‰ç»“æŸå‰ï¼Œé€’å½’æ¸²æŸ“</span></span><br><span class="line">        <span class="built_in">window</span>.requestAnimationFrame(step)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¬¬ä¸€å¸§æ¸²æŸ“</span></span><br><span class="line"><span class="built_in">window</span>.requestAnimationFrame(step)</span><br></pre></td></tr></table></figure><h3>requestAnimationFrame ä¼˜åŠ¿</h3><p>é™¤äº†ç²¾å‡†æ§åˆ¶è°ƒç”¨æ—¶æœºä»¥å¤–ï¼ŒrequestAnimationFrame è¿˜æœ‰ä¸¤å¤§ä¼˜ç‚¹ï¼š</p><ul><li>è¿è¡Œåœ¨åå°æ ‡ç­¾é¡µæˆ–è€…éšè—çš„ iframe é‡Œæ—¶ï¼ŒrequestAnimationFrame() æš‚åœè°ƒç”¨ä»¥æå‡æ€§èƒ½å’Œç”µæ± å¯¿å‘½ã€‚</li><li>å‡½æ•°èŠ‚æµï¼šåœ¨é«˜é¢‘ç‡äº‹ä»¶(resize,scrollç­‰)ä¸­ï¼Œä¸ºäº†é˜²æ­¢åœ¨ä¸€ä¸ªåˆ·æ–°é—´éš”å†…å‘ç”Ÿå¤šæ¬¡å‡½æ•°æ‰§è¡Œï¼Œä½¿ç”¨ requestAnimationFrame å¯ä¿è¯æ¯ä¸ªåˆ·æ–°é—´éš”å†…ï¼Œå‡½æ•°åªè¢«æ‰§è¡Œä¸€æ¬¡ã€‚</li></ul><h3>cancelAnimationFrame</h3><p>å–æ¶ˆä¸€ä¸ªå…ˆå‰é€šè¿‡è°ƒç”¨ window.requestAnimationFrame()æ–¹æ³•è¿”å›çš„åŠ¨ç”»å¸§è¯·æ±‚ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> animateDiv = <span class="built_in">document</span>.querySelector(<span class="string">'.animate-div'</span>)</span><br><span class="line"><span class="keyword">const</span> requestAnimationFrame = <span class="built_in">window</span>.requestAnimationFrame || <span class="built_in">window</span>.mozRequestAnimationFrame ||</span><br><span class="line">  <span class="built_in">window</span>.webkitRequestAnimationFrame || <span class="built_in">window</span>.msRequestAnimationFrame</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> cancelAnimationFrame = <span class="built_in">window</span>.cancelAnimationFrame || <span class="built_in">window</span>.mozCancelAnimationFrame</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> start = <span class="literal">null</span></span><br><span class="line"><span class="keyword">let</span> myReq = <span class="literal">null</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">step</span>(<span class="params">timestamp</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> progress = timestamp - start</span><br><span class="line">  animateDiv.style.left = progress + <span class="string">'px'</span></span><br><span class="line">  <span class="keyword">if</span> (progress &lt; <span class="number">2000</span>) &#123;</span><br><span class="line">    myReq = requestAnimationFrame(step)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">myReq = requestAnimationFrame(step)</span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">window</span>.cancelAnimationFrame(myReq)</span><br><span class="line">&#125;, <span class="number">200</span>)</span><br></pre></td></tr></table></figure><h3>ä¼˜é›…é™çº§</h3><p>requestAnimationFrame ç›®å‰è¿˜å­˜åœ¨å…¼å®¹æ€§é—®é¢˜ï¼Œä½¿ç”¨ <a href="https://github.com/darius/requestAnimationFrame" target="_blank" rel="noopener">requestAnimationFrame polyfill</a> æ¥è¿›è¡Œä¼˜é›…é™çº§ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="built_in">Date</span>.now)</span><br><span class="line">    <span class="built_in">Date</span>.now = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Date</span>().getTime(); &#125;;</span><br><span class="line"></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="meta">    'use strict'</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> vendors = [<span class="string">'webkit'</span>, <span class="string">'moz'</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; vendors.length &amp;&amp; !<span class="built_in">window</span>.requestAnimationFrame; ++i) &#123;</span><br><span class="line">        <span class="keyword">let</span> vp = vendors[i];</span><br><span class="line">        <span class="built_in">window</span>.requestAnimationFrame = <span class="built_in">window</span>[vp+<span class="string">'RequestAnimationFrame'</span>];</span><br><span class="line">        <span class="built_in">window</span>.cancelAnimationFrame = (<span class="built_in">window</span>[vp+<span class="string">'CancelAnimationFrame'</span>]</span><br><span class="line">                                   || <span class="built_in">window</span>[vp+<span class="string">'CancelRequestAnimationFrame'</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="regexp">/iP(ad|hone|od).*OS 6/</span>.test(<span class="built_in">window</span>.navigator.userAgent) <span class="comment">// iOS6 is buggy</span></span><br><span class="line">        || !<span class="built_in">window</span>.requestAnimationFrame || !<span class="built_in">window</span>.cancelAnimationFrame) &#123;</span><br><span class="line">        <span class="keyword">let</span> lastTime = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">window</span>.requestAnimationFrame = <span class="function"><span class="keyword">function</span>(<span class="params">callback</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">let</span> now = <span class="built_in">Date</span>.now();</span><br><span class="line">            <span class="keyword">let</span> nextTime = <span class="built_in">Math</span>.max(lastTime + <span class="number">16</span>, now);</span><br><span class="line">            <span class="keyword">return</span> setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; callback(lastTime = nextTime); &#125;,</span><br><span class="line">                              nextTime - now);</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="built_in">window</span>.cancelAnimationFrame = clearTimeout;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;());</span><br></pre></td></tr></table></figure><h2>å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/requestAnimationFrame" target="_blank" rel="noopener">MDN-CSS requestAnimationFrame</a></li><li><a href="http://mp.weixin.qq.com/s/_m1flYySn6sgAROYbXqltg" target="_blank" rel="noopener">æ·±å…¥ç†è§£ requestAnimationFrame</a></li><li><a href="https://www.w3cplus.com/css3/introduction-to-hardware-acceleration-css-animations.html" target="_blank" rel="noopener">CSSåŠ¨ç”»ä¹‹ç¡¬ä»¶åŠ é€Ÿ</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;å¦‚ä½•å®ç°ä¸€ä¸ªåŠ¨ç”»&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬æ¥å®ç°ä¸€ä¸ªæœ€ç®€å•çš„éœ€æ±‚ï¼Œå°†ä¸€ä¸ªå…ƒç´ ä»å±å¹•å·¦è¾¹å‡åŒ€åœ°ç§»åŠ¨åˆ°å±å¹•å³è¾¹ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æ˜¯æ•ˆæœ:&lt;/p&gt;

&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;&lt;meta name=&quot;generator&quot; content=&quot;Hexo 3.9.0&quot;&gt;
  &lt;style&gt;
    .animate-warpper {
      width: 100%;
      height: 70px;
    }
    @keyframes move_animation {
      0% { left: 0px; }
      100% { left: calc(100% - 60px); }
    }
    .animate-div {
      width: 60px;
      height: 40px;
      position: absolute;
      left: 0;
      border-radius: 5px;
      background: #92B901;
      transform: translateZ(0);
      -webkit-transform: translateZ(0);
      animation: move_animation 5s linear 2s infinite alternate;
    }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;section class=&quot;animate-warpper&quot;&gt; 
    &lt;div class=&quot;animate-div&quot;&gt;&lt;/div&gt;
  &lt;/section&gt;
&lt;/body&gt;
&lt;/html&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="requestAnimationFrame" scheme="https://lz5z.com/tags/requestAnimationFrame/"/>
    
  </entry>
  
  <entry>
    <title>JavaScript å¾ªç¯ä¸å¼‚æ­¥</title>
    <link href="https://lz5z.com/JavaScript-Loop-Async/"/>
    <id>https://lz5z.com/JavaScript-Loop-Async/</id>
    <published>2018-04-11T14:03:53.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h2>JS ä¸­çš„å¾ªç¯ä¸å¼‚æ­¥</h2><p>JS ä¸­æœ‰å¤šç§æ–¹å¼å®ç°å¾ªç¯ï¼š<code>for; for in; for of; while; do while; forEach; map</code> ç­‰ç­‰ã€‚å‡å¦‚å¾ªç¯é‡Œé¢çš„å†…å®¹æ˜¯å¼‚æ­¥å¹¶ä¸” await çš„ï¼Œé‚£å¼‚æ­¥ä»£ç ç©¶ç«Ÿæ˜¯åƒ <code>Promise.all</code>ä¸€æ ·å°†å¾ªç¯ä¸­çš„ä»£ç ä¸€èµ·æ‰§è¡Œï¼Œè¿˜æ˜¯æ¯æ¬¡ç­‰å¾…ä¸Šä¸€æ¬¡å¾ªç¯æ‰§è¡Œå®Œæ¯•å†æ‰§è¡Œå‘¢ï¼Ÿ</p><h2>é¦–å…ˆçœ‹ç»“è®º</h2><p>forEach å’Œ map, some, every å¾ªç¯æ˜¯å¹¶è¡Œæ‰§è¡Œçš„ï¼Œç›¸å½“äº Promise.allï¼Œå…¶å®ƒ for, for in, for of, while, do while éƒ½æ˜¯ä¸²è¡Œæ‰§è¡Œçš„ã€‚</p><p>å…ˆå®šä¹‰å¼‚æ­¥å‡½æ•° foo å’Œå¯éå†æ•°ç»„ arrï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = <span class="built_in">Array</span>.from(&#123; <span class="attr">length</span>: <span class="number">5</span> &#125;, (v, k) =&gt; k)</span><br><span class="line"><span class="keyword">const</span> foo = <span class="function"><span class="params">i</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(i)</span><br><span class="line">      resolve(<span class="string">''</span>)</span><br><span class="line">    &#125;, <span class="number">1000</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><a id="more"></a><p>å¹¶è¡Œæ‰§è¡Œï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * forEach</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">e</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  arr.forEach(<span class="keyword">async</span> a =&gt; <span class="keyword">await</span> foo(a))</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * map</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  arr.map(<span class="keyword">async</span> a =&gt; <span class="keyword">await</span> foo(a))</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * every</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">g</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  arr.every(<span class="function"><span class="params">a</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params"><span class="keyword">async</span>(</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">await</span> foo(a)</span><br><span class="line">    &#125;)()</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸²è¡Œæ‰§è¡Œï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * for</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">    <span class="keyword">await</span> foo(arr[i])</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * for</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">    <span class="keyword">await</span> foo(arr[i])</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * for of</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">c</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">of</span> arr) &#123;</span><br><span class="line">    <span class="keyword">await</span> foo(i)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * for in</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">d</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">in</span> arr) &#123;</span><br><span class="line">    <span class="keyword">await</span> foo(i)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * while</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">h</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> i = <span class="number">0</span></span><br><span class="line">  <span class="keyword">while</span> (i &lt; <span class="number">5</span>) &#123;</span><br><span class="line">    <span class="keyword">await</span> foo(i++)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * do while</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">i</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> i = <span class="number">0</span></span><br><span class="line">  <span class="keyword">do</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> foo(i++)</span><br><span class="line">  &#125; <span class="keyword">while</span> (i &lt; <span class="number">5</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2>å¦‚ä½•è®© forEach æˆ–è€… map ä¹Ÿèƒ½ä¸²è¡Œæ‰§è¡Œ</h2><p>é¦–å…ˆæŸ¥çœ‹ forEach çš„ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach" target="_blank" rel="noopener">polyfill</a>ï¼Œç®€åŒ–åå¯ä»¥ç†è§£ä¸ºä»¥ä¸‹ä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.forEach = <span class="function"><span class="keyword">function</span>(<span class="params">callback, thisArg</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> len = <span class="keyword">this</span>.length</span><br><span class="line">  <span class="keyword">var</span> k = <span class="number">0</span></span><br><span class="line">  <span class="keyword">while</span> (k &lt; len) &#123;</span><br><span class="line">    <span class="keyword">var</span> kValue</span><br><span class="line">    <span class="keyword">if</span> (k <span class="keyword">in</span> <span class="keyword">this</span>) &#123;</span><br><span class="line">      kValue = <span class="keyword">this</span>[k]</span><br><span class="line">      callback.call(thisArg, kValue, k, <span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    k++</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æœ¬è´¨ä¸Š forEach è¿˜æ˜¯é€šè¿‡ while å¾ªç¯æ¥å®ç°çš„ï¼Œå‡å¦‚æˆ‘ä»¬æƒ³è¦ä¸€ä¸ªå¼‚æ­¥çš„ forEach çš„è¯ï¼Œåªéœ€è¦å°† callback çš„è°ƒç”¨æ”¹æˆ await å³å¯ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.forEachAsync = <span class="keyword">async</span> <span class="function"><span class="keyword">function</span>(<span class="params">callback, thisArg</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> len = <span class="keyword">this</span>.length</span><br><span class="line">  <span class="keyword">var</span> k = <span class="number">0</span></span><br><span class="line">  <span class="keyword">while</span> (k &lt; len) &#123;</span><br><span class="line">    <span class="keyword">var</span> kValue</span><br><span class="line">    <span class="keyword">if</span> (k <span class="keyword">in</span> <span class="keyword">this</span>) &#123;</span><br><span class="line">      kValue = <span class="keyword">this</span>[k]</span><br><span class="line">      <span class="keyword">await</span> callback.call(thisArg, kValue, k, <span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    k++</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>npm ä¸Šæœ‰ä¸€ä¸ªæ›´ä¸ºå®Œå¤‡çš„è§£å†³æ–¹æ¡ˆï¼š<a href="https://github.com/FuturesJS/forEachAsync/blob/master/forEachAsync.js" target="_blank" rel="noopener">forEachAsync</a></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> forEachAsync = <span class="built_in">require</span>(<span class="string">'forEachAsync'</span>).forEachAsync</span><br><span class="line"></span><br><span class="line">forEachAsync(arr, <span class="function"><span class="keyword">function</span>(<span class="params">a</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> foo(a)</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'Done!'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>å°±è¿™ä¹ˆå¤šã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;JS ä¸­çš„å¾ªç¯ä¸å¼‚æ­¥&lt;/h2&gt;
&lt;p&gt;JS ä¸­æœ‰å¤šç§æ–¹å¼å®ç°å¾ªç¯ï¼š&lt;code&gt;for; for in; for of; while; do while; forEach; map&lt;/code&gt; ç­‰ç­‰ã€‚å‡å¦‚å¾ªç¯é‡Œé¢çš„å†…å®¹æ˜¯å¼‚æ­¥å¹¶ä¸” await çš„ï¼Œé‚£å¼‚æ­¥ä»£ç ç©¶ç«Ÿæ˜¯åƒ &lt;code&gt;Promise.all&lt;/code&gt;ä¸€æ ·å°†å¾ªç¯ä¸­çš„ä»£ç ä¸€èµ·æ‰§è¡Œï¼Œè¿˜æ˜¯æ¯æ¬¡ç­‰å¾…ä¸Šä¸€æ¬¡å¾ªç¯æ‰§è¡Œå®Œæ¯•å†æ‰§è¡Œå‘¢ï¼Ÿ&lt;/p&gt;
&lt;h2&gt;é¦–å…ˆçœ‹ç»“è®º&lt;/h2&gt;
&lt;p&gt;forEach å’Œ map, some, every å¾ªç¯æ˜¯å¹¶è¡Œæ‰§è¡Œçš„ï¼Œç›¸å½“äº Promise.allï¼Œå…¶å®ƒ for, for in, for of, while, do while éƒ½æ˜¯ä¸²è¡Œæ‰§è¡Œçš„ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆå®šä¹‰å¼‚æ­¥å‡½æ•° foo å’Œå¯éå†æ•°ç»„ arrï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; arr = &lt;span class=&quot;built_in&quot;&gt;Array&lt;/span&gt;.from(&amp;#123; &lt;span class=&quot;attr&quot;&gt;length&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt; &amp;#125;, (v, k) =&amp;gt; k)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; foo = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;params&quot;&gt;i&lt;/span&gt; =&amp;gt;&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Promise&lt;/span&gt;(&lt;span class=&quot;function&quot;&gt;(&lt;span class=&quot;params&quot;&gt;resolve, reject&lt;/span&gt;) =&amp;gt;&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    setTimeout(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; =&amp;gt;&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(i)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      resolve(&lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;, &lt;span class=&quot;number&quot;&gt;1000&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="https://lz5z.com/tags/JavaScript/"/>
    
      <category term="Loop" scheme="https://lz5z.com/tags/Loop/"/>
    
      <category term="async/await" scheme="https://lz5z.com/tags/async-await/"/>
    
  </entry>
  
  <entry>
    <title>æ­£åˆ™è¡¨è¾¾å¼æ ¼å¼åŒ–æŸ¥è¯¢å‚æ•°</title>
    <link href="https://lz5z.com/QueryStringFormat-RegExp/"/>
    <id>https://lz5z.com/QueryStringFormat-RegExp/</id>
    <published>2018-03-26T23:05:05.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<p>è®°å½•ä¸€ä¸‹ï¼Œé€šè¿‡ä¸€è¡Œæ­£åˆ™è¡¨è¾¾å¼å’Œ replace æ–¹æ³•ç®€å•å®ç°æ­£åˆ™è¡¨è¾¾å¼æ ¼å¼åŒ–æŸ¥è¯¢å‚æ•°ã€‚</p><figure class="highlight qml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="built_in">url</span> = <span class="string">'https://lz5z.com/000/?a=123&amp;b=456&amp;c=%E4%B8%AD%E6%96%87'</span></span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * æ ¼å¼åŒ–æŸ¥è¯¢å­—ç¬¦ä¸²(æ­£åˆ™å®ç°) </span></span><br><span class="line"><span class="comment"> * @param url urlåœ°å€ </span></span><br><span class="line"><span class="comment"> * @return &#123;Object&#125; æ ¼å¼åŒ–çš„jsonå¯¹è±¡ </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">formatUrl</span>(<span class="params">url</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> reg = <span class="regexp">/(?:[?&amp;]+)([^&amp;]+)=([^&amp;]+)/g</span></span><br><span class="line">    <span class="keyword">let</span> data = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params">str, key, value</span>) </span>&#123;</span><br><span class="line">        data[<span class="built_in">decodeURIComponent</span>(key)] = <span class="built_in">decodeURIComponent</span>(value)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">url</span>.replace(reg, fn)</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(formatUrl(<span class="built_in">url</span>)) <span class="comment">// &#123; a: '123', b: '456', c: 'ä¸­æ–‡' &#125;</span></span><br></pre></td></tr></table></figure><p>ä¸‹æ¬¡é¢è¯•å®˜é—®ä½ çš„æ—¶å€™ï¼Œä½ èƒ½ç­”ä¸Šæ¥å—ï¼ŸğŸ˜‰ğŸ˜‰ğŸ˜‰</p><a id="more"></a><p>ä¸‹é¢æ˜¯ ã€ŠJavaScripté«˜çº§ç¨‹åºè®¾è®¡ã€‹ ä¸­ç»™å‡ºçš„æ–¹æ¡ˆ:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getQueryStringArgs</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// å–å¾—æŸ¥è¯¢å­—ç¬¦ä¸²å¹¶å»æ‰å¼€å¤´çš„é—®å·</span></span><br><span class="line">    <span class="keyword">var</span> qs = (location.search.length &gt; <span class="number">0</span> ? location.search.substring(<span class="number">1</span>) : <span class="string">''</span>)</span><br><span class="line">    <span class="comment">// ä¿å­˜æ•°æ®çš„å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">var</span> args = &#123;&#125;</span><br><span class="line">    <span class="comment">// å–å¾—æ¯ä¸€é¡¹</span></span><br><span class="line">    <span class="keyword">var</span> items = qs.length ? qs.split(<span class="string">'&amp;'</span>) : []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; items.length; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> item = items[i].split(<span class="string">'='</span>)</span><br><span class="line">        <span class="keyword">var</span> name = <span class="built_in">decodeURIComponent</span>(item[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">var</span> value = <span class="built_in">decodeURIComponent</span>(item[<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">if</span> (name.length) args[name] = value</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> args</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è®°å½•ä¸€ä¸‹ï¼Œé€šè¿‡ä¸€è¡Œæ­£åˆ™è¡¨è¾¾å¼å’Œ replace æ–¹æ³•ç®€å•å®ç°æ­£åˆ™è¡¨è¾¾å¼æ ¼å¼åŒ–æŸ¥è¯¢å‚æ•°ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight qml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;url&lt;/span&gt; = &lt;span class=&quot;string&quot;&gt;&#39;https://lz5z.com/000/?a=123&amp;amp;b=456&amp;amp;c=%E4%B8%AD%E6%96%87&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/** &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt; * æ ¼å¼åŒ–æŸ¥è¯¢å­—ç¬¦ä¸²(æ­£åˆ™å®ç°) &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt; * @param url urlåœ°å€ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt; * @return &amp;#123;Object&amp;#125; æ ¼å¼åŒ–çš„jsonå¯¹è±¡ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt; */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;formatUrl&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;url&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; reg = &lt;span class=&quot;regexp&quot;&gt;/(?:[?&amp;amp;]+)([^&amp;amp;]+)=([^&amp;amp;]+)/g&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; data = &amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;fn&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;str, key, value&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        data[&lt;span class=&quot;built_in&quot;&gt;decodeURIComponent&lt;/span&gt;(key)] = &lt;span class=&quot;built_in&quot;&gt;decodeURIComponent&lt;/span&gt;(value)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;url&lt;/span&gt;.replace(reg, fn)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; data&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(formatUrl(&lt;span class=&quot;built_in&quot;&gt;url&lt;/span&gt;)) &lt;span class=&quot;comment&quot;&gt;// &amp;#123; a: &#39;123&#39;, b: &#39;456&#39;, c: &#39;ä¸­æ–‡&#39; &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä¸‹æ¬¡é¢è¯•å®˜é—®ä½ çš„æ—¶å€™ï¼Œä½ èƒ½ç­”ä¸Šæ¥å—ï¼ŸğŸ˜‰ğŸ˜‰ğŸ˜‰&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="https://lz5z.com/tags/JavaScript/"/>
    
      <category term="RegExp" scheme="https://lz5z.com/tags/RegExp/"/>
    
  </entry>
  
  <entry>
    <title>JavaScript æ·±æ‹·è´å’Œæµ…æ‹·è´</title>
    <link href="https://lz5z.com/JavaScript%E6%B7%B1%E6%8B%B7%E8%B4%9D%E5%92%8C%E6%B5%85%E6%8B%B7%E8%B4%9D/"/>
    <id>https://lz5z.com/JavaScriptæ·±æ‹·è´å’Œæµ…æ‹·è´/</id>
    <published>2018-03-10T22:02:49.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨ JavaScript å¼•ç”¨æ•°æ®ç±»å‹ä¸­ï¼Œå˜é‡ä¿å­˜çš„æ˜¯ä¸€ä¸ªæŒ‡å‘å †å†…å­˜çš„æŒ‡é’ˆï¼Œå½“éœ€è¦è®¿é—®å¼•ç”¨ç±»å‹ï¼ˆå¦‚å¯¹è±¡ï¼Œæ•°ç»„ç­‰ï¼‰çš„å€¼æ—¶ï¼Œé¦–å…ˆä»æ ˆä¸­è·å¾—è¯¥å¯¹è±¡çš„åœ°å€æŒ‡é’ˆï¼Œç„¶åå†ä»å †å†…å­˜ä¸­å–å¾—æ‰€éœ€çš„æ•°æ®ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj1 = &#123; <span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span> &#125;</span><br><span class="line"><span class="keyword">let</span> obj2 = obj1</span><br><span class="line">obj2.x = <span class="number">2</span></span><br><span class="line"><span class="built_in">console</span>.log(obj1) <span class="comment">// &#123; x: 2, y: 2 &#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(obj2) <span class="comment">// &#123; x: 2, y: 2 &#125;</span></span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šçš„æ‹·è´æ–¹å¼å°±æ˜¯æµ…æ‹·è´ï¼Œå½“ obj2 çš„å€¼æ”¹å˜æ—¶ï¼Œobj1 çš„å€¼ä¹Ÿéšä¹‹å‘ç”Ÿæ”¹å˜ã€‚</p><a id="more"></a><h3>æµ…æ‹·è´</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr1 = [<span class="number">0</span>, <span class="number">1</span>, [<span class="string">'a'</span>, <span class="string">'b'</span>]]</span><br><span class="line"><span class="keyword">let</span> arr2 = arr1.concat()</span><br><span class="line"><span class="keyword">let</span> arr3 = arr1.slice()</span><br><span class="line"><span class="keyword">let</span> arr4 = <span class="built_in">Array</span>.from(arr3)</span><br><span class="line"></span><br><span class="line">arr2 === arr1 <span class="comment">// false çœ‹èµ·æ¥åƒæ·±æ‹·è´</span></span><br><span class="line">arr3 === arr1 <span class="comment">// false çœ‹èµ·æ¥åƒæ·±æ‹·è´</span></span><br><span class="line">arr4 === arr3 <span class="comment">// false çœ‹èµ·æ¥åƒæ·±æ‹·è´</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç„¶é¹…</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr5 = [&#123;<span class="attr">name</span>: <span class="string">'Leo'</span>&#125;]</span><br><span class="line"><span class="keyword">let</span> arr6 = arr4.slice()</span><br><span class="line"><span class="keyword">let</span> arr7 = arr4.concat()</span><br><span class="line"><span class="keyword">let</span> arr8 = <span class="built_in">Array</span>.from(arr4)</span><br><span class="line"></span><br><span class="line">arr5[<span class="number">0</span>].name = <span class="string">'Jack'</span></span><br><span class="line">arr6[<span class="number">0</span>].name === <span class="string">'Jack'</span> <span class="comment">// å…¶å®è¿˜æ˜¯æµ…æ‹·è´</span></span><br><span class="line">arr7[<span class="number">0</span>].name === <span class="string">'Jack'</span> <span class="comment">// å…¶å®è¿˜æ˜¯æµ…æ‹·è´</span></span><br><span class="line">arr8[<span class="number">0</span>].name === <span class="string">'Jack'</span> <span class="comment">// å…¶å®è¿˜æ˜¯æµ…æ‹·è´</span></span><br></pre></td></tr></table></figure><p>Array.prototype.concat(), Array.prototype.slice(), Array.from() åªèƒ½å®ç°å¯¹ä¸€ç»´æ•°ç»„çš„æ·±æ‹·è´ã€‚</p><h3>Object.assign()</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj1 = &#123; <span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span> &#125;</span><br><span class="line"><span class="keyword">let</span> obj2 = <span class="built_in">Object</span>.assign(&#123;&#125;, obj1)</span><br><span class="line">obj1 === obj2 <span class="comment">// false</span></span><br><span class="line">obj1.x = <span class="number">2</span></span><br><span class="line"><span class="built_in">console</span>.log(obj1) <span class="comment">// &#123; x: 2, y: 2 &#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(obj2) <span class="comment">// &#123; x: 1, y: 2 &#125; // ä¸€ç»´å¯¹è±¡å¯ä»¥è¿›è¡Œæ·±æ‹·è´</span></span><br><span class="line"><span class="comment">// ç„¶é¹…</span></span><br><span class="line"><span class="keyword">let</span> obj3 = &#123; <span class="attr">x</span>: &#123;<span class="attr">name</span>: <span class="string">'Leo'</span>&#125; &#125;</span><br><span class="line"><span class="keyword">let</span> obj4 = <span class="built_in">Object</span>.assign(&#123;&#125;, obj3)</span><br><span class="line">obj3 === obj4 <span class="comment">// false</span></span><br><span class="line">obj3.x.name = <span class="string">'Jack'</span></span><br><span class="line">obj4.x.name === <span class="string">'Jack'</span> <span class="comment">// true // å…¶å®è¿˜æ˜¯æµ…æ‹·è´</span></span><br></pre></td></tr></table></figure><h3>æ·±æ‹·è´</h3><p>ä½¿ç”¨ JSON.parse() + JSON.stringify() å®ç°æ·±æ‹·è´</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj1 = &#123;</span><br><span class="line">  x: <span class="number">1</span>,</span><br><span class="line">  y: &#123;</span><br><span class="line">    name: <span class="string">'Leo'</span>,</span><br><span class="line">    friends: [<span class="string">'Lily'</span>, <span class="string">'Elsa'</span>]</span><br><span class="line">  &#125;    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj2 = <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(obj1))</span><br><span class="line"></span><br><span class="line">obj1 === obj2 <span class="comment">// false</span></span><br><span class="line">obj1.y.name = <span class="string">'Jack'</span></span><br><span class="line">obj1.y.friends.push(<span class="string">'Tim'</span>)</span><br><span class="line">obj2.y.name === <span class="string">'Leo'</span> <span class="comment">// æ·±æ‹·è´</span></span><br><span class="line"><span class="built_in">console</span>.log(obj2.y.friends) <span class="comment">//Â ["Lily", "Elsa"] // æ·±æ‹·è´</span></span><br></pre></td></tr></table></figure><p>JSON.parse å’Œ JSON.stringify çœ‹èµ·æ¥ä¸é”™ï¼Œä¸è¿‡å­˜åœ¨ä¸€äº›<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify" target="_blank" rel="noopener">é—®é¢˜</a>ï¼š</p><ol><li>undefinedã€ä»»æ„çš„å‡½æ•°ä»¥åŠ symbol å€¼ï¼Œåœ¨åºåˆ—åŒ–è¿‡ç¨‹ä¸­ä¼šè¢«å¿½ç•¥ï¼ˆå‡ºç°åœ¨éæ•°ç»„å¯¹è±¡çš„å±æ€§å€¼ä¸­æ—¶ï¼‰æˆ–è€…è¢«è½¬æ¢æˆ nullï¼ˆå‡ºç°åœ¨æ•°ç»„ä¸­æ—¶ï¼‰ã€‚</li><li>æ‰€æœ‰ä»¥ symbol ä¸ºå±æ€§é”®çš„å±æ€§éƒ½ä¼šè¢«å®Œå…¨å¿½ç•¥æ‰ã€‚</li><li>ä¸å¯æšä¸¾çš„å±æ€§ä¼šè¢«å¿½ç•¥ã€‚</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">JSON</span>.stringify(&#123;<span class="attr">a</span>: <span class="function"><span class="keyword">function</span> <span class="title">add</span> (<span class="params"></span>)</span>&#123;&#125;&#125;) <span class="comment">// '&#123;&#125;'</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">JSON</span>.stringify(&#123;<span class="attr">x</span>: <span class="literal">undefined</span>, <span class="attr">y</span>: <span class="built_in">Object</span>, <span class="attr">z</span>: <span class="built_in">Symbol</span>(<span class="string">""</span>)&#125;) <span class="comment">// '&#123;&#125;'</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">JSON</span>.stringify([<span class="literal">undefined</span>, <span class="built_in">Object</span>, <span class="built_in">Symbol</span>(<span class="string">""</span>)]) <span class="comment">// '[null,null,null]' </span></span><br><span class="line"></span><br><span class="line"><span class="built_in">JSON</span>.stringify(&#123;[<span class="built_in">Symbol</span>(<span class="string">"foo"</span>)]: <span class="string">"foo"</span>&#125;) <span class="comment">// '&#123;&#125;'</span></span><br></pre></td></tr></table></figure><h3>ä½¿ç”¨é€’å½’</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deepClone</span>(<span class="params">o</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// if o is not an object </span></span><br><span class="line">  <span class="keyword">if</span> (!o || (<span class="keyword">typeof</span> o) != <span class="string">'object'</span>) <span class="keyword">return</span> o</span><br><span class="line">  <span class="keyword">let</span> res = <span class="built_in">Array</span>.isArray(o) ? [] : &#123;&#125;</span><br><span class="line">  <span class="keyword">let</span> keys = <span class="built_in">Object</span>.keys(o) </span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i&lt; keys.length; i++) &#123;</span><br><span class="line">    <span class="keyword">let</span> key = keys[i]</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> key === <span class="string">'object'</span>) &#123;</span><br><span class="line">        res[key] = deepClone(o[key])</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        res[key] = o[key]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj1 = &#123;</span><br><span class="line">  x: &#123;<span class="attr">name</span>: <span class="string">'Leo'</span>&#125;,</span><br><span class="line">  y: <span class="literal">undefined</span>,</span><br><span class="line">  z: <span class="function"><span class="keyword">function</span> <span class="title">add</span> (<span class="params"></span>) </span>&#123;&#125;,</span><br><span class="line">  t: <span class="built_in">Symbol</span>(<span class="string">'tt'</span>),</span><br><span class="line">  m: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>],</span><br><span class="line">  n: [[<span class="number">1</span>, <span class="number">2</span>]]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj2 = deepClone(obj1)</span><br><span class="line">obj1.n[<span class="number">0</span>].push(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(obj2.n[<span class="number">0</span>]) <span class="comment">// [1, 2]</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šç”±äºä½¿ç”¨ <code>for in</code> å¾ªç¯ï¼Œæ‰€ä»¥åªèƒ½æ·±åº¦æ‹·è´å¯¹è±¡è‡ªèº«å±æ€§ï¼ˆéåŸå‹é“¾ä¸Šçš„å±æ€§ï¼‰ï¼Œå¹¶ä¸”å±æ€§ä¸º enumerableã€‚</p><p>ä½¿ç”¨é€’å½’æ‹·è´å¯¹è±¡çš„æ–¹æ³•ï¼Œåœ¨ç›®æ ‡éå¸¸å¤§ï¼Œå±‚çº§å…³ç³»éå¸¸æ·±çš„æ—¶å€™ä¼šå‡ºç°æ€§èƒ½é—®é¢˜ï¼Œå…·ä½“è§£å†³æ–¹æ¡ˆå¯ä»¥å‚è€ƒæˆ‘ä¹‹å‰å†™çš„ <a href="https://lz5z.com/JavaScript%E9%80%92%E5%BD%92%E4%BC%98%E5%8C%96/">JavaScripté€’å½’ä¼˜åŒ–</a> ä½¿ç”¨æ ˆä»£æ›¿é€’å½’çš„æ–¹å¼è§£å†³ã€‚</p><h3>lodash</h3><p>lodash ä¸­æä¾› 4 ä¸ªå¯¹è±¡<a href="https://lodash.com/docs/4.17.10#clone" target="_blank" rel="noopener">æ‹·è´</a>ç›¸å…³çš„æ–¹æ³•ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">_.clone() <span class="comment">// æä¾›æµ…æ‹·è´</span></span><br><span class="line">_.cloneDeep() <span class="comment">// æä¾›æ·±æ‹·è´</span></span><br><span class="line">_.cloneDeepWith() <span class="comment">// æä¾›é€’å½’æ‹·è´ï¼Œå¹¶ä¸”å¯ä»¥è‡ªå®šä¹‰æ‹·è´å†…å®¹</span></span><br><span class="line">_.cloneWith() <span class="comment">// æä¾›æµ…æ‹·è´ï¼Œå¹¶ä¸”å¯ä»¥è‡ªå®šä¹‰æ‹·è´å†…å®¹</span></span><br></pre></td></tr></table></figure><p>demo</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">customizer</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (_.isElement(value)) &#123;</span><br><span class="line">    <span class="keyword">return</span> value.cloneNode(<span class="literal">true</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">let</span> el = _.cloneDeepWith(<span class="built_in">document</span>.body, customizer)</span><br><span class="line"> </span><br><span class="line"><span class="built_in">console</span>.log(el === <span class="built_in">document</span>.body) <span class="comment">// =&gt; false</span></span><br><span class="line"><span class="built_in">console</span>.log(el.nodeName) <span class="comment">// =&gt; 'BODY'</span></span><br><span class="line"><span class="built_in">console</span>.log(el.childNodes.length) <span class="comment">// =&gt; 20</span></span><br></pre></td></tr></table></figure><p>ç›¸ä¿¡ä¸Šè¿°å‡ ç§æ–¹æ³•å·²ç»èƒ½å¤Ÿæ»¡è¶³æˆ‘ä»¬å¹³æ—¶å¤§éƒ¨åˆ†çš„éœ€æ±‚äº†ï¼Œå¦‚æœæœ‰é¢å¤–çš„éœ€æ±‚ï¼Œåªèƒ½è‡ªå·±å®šä¹‰å®ç°æ·±/æµ…æ‹·è´çš„æ–¹å¼äº†ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨ JavaScript å¼•ç”¨æ•°æ®ç±»å‹ä¸­ï¼Œå˜é‡ä¿å­˜çš„æ˜¯ä¸€ä¸ªæŒ‡å‘å †å†…å­˜çš„æŒ‡é’ˆï¼Œå½“éœ€è¦è®¿é—®å¼•ç”¨ç±»å‹ï¼ˆå¦‚å¯¹è±¡ï¼Œæ•°ç»„ç­‰ï¼‰çš„å€¼æ—¶ï¼Œé¦–å…ˆä»æ ˆä¸­è·å¾—è¯¥å¯¹è±¡çš„åœ°å€æŒ‡é’ˆï¼Œç„¶åå†ä»å †å†…å­˜ä¸­å–å¾—æ‰€éœ€çš„æ•°æ®ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; obj1 = &amp;#123; &lt;span class=&quot;attr&quot;&gt;x&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;attr&quot;&gt;y&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; obj2 = obj1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;obj2.x = &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(obj1) &lt;span class=&quot;comment&quot;&gt;// &amp;#123; x: 2, y: 2 &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(obj2) &lt;span class=&quot;comment&quot;&gt;// &amp;#123; x: 2, y: 2 &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä»¥ä¸Šçš„æ‹·è´æ–¹å¼å°±æ˜¯æµ…æ‹·è´ï¼Œå½“ obj2 çš„å€¼æ”¹å˜æ—¶ï¼Œobj1 çš„å€¼ä¹Ÿéšä¹‹å‘ç”Ÿæ”¹å˜ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="clone" scheme="https://lz5z.com/tags/clone/"/>
    
      <category term="æ·±æ‹·è´" scheme="https://lz5z.com/tags/%E6%B7%B1%E6%8B%B7%E8%B4%9D/"/>
    
      <category term="æµ…æ‹·è´" scheme="https://lz5z.com/tags/%E6%B5%85%E6%8B%B7%E8%B4%9D/"/>
    
      <category term="lodash" scheme="https://lz5z.com/tags/lodash/"/>
    
  </entry>
  
  <entry>
    <title>Shell å­¦ä¹ </title>
    <link href="https://lz5z.com/Shell-study/"/>
    <id>https://lz5z.com/Shell-study/</id>
    <published>2018-03-07T22:51:37.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h2>Shell å˜é‡</h2><ul><li>å˜é‡é»˜è®¤éƒ½æ˜¯å­—ç¬¦ä¸²ç±»å‹</li><li>å˜é‡åå’Œç­‰å·ä¹‹é—´ä¸èƒ½æœ‰ç©ºæ ¼</li><li>å‘½åï¼šåªèƒ½ä½¿ç”¨è‹±æ–‡å­—æ¯ï¼Œæ•°å­—å’Œä¸‹åˆ’çº¿ï¼Œé¦–ä¸ªå­—ç¬¦ä¸èƒ½ä»¥æ•°å­—å¼€å¤´</li><li>æŸ¥çœ‹å˜é‡ set å‘½ä»¤ï¼Œåˆ é™¤å˜é‡ <code>unset variable_name</code></li><li><code>set -u</code> è°ƒç”¨æœªå£°æ˜å˜é‡æŠ¥é”™ï¼ˆé»˜è®¤æ— æç¤ºï¼‰</li></ul><h3>å˜é‡å åŠ </h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">x=123</span><br><span class="line">x="$x"456</span><br><span class="line">x=$&#123;x&#125;789</span><br><span class="line">echo $x # 123456789</span><br></pre></td></tr></table></figure><a id="more"></a><h3>readonly</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x=123</span><br><span class="line">readonly x</span><br><span class="line">x=312 #-bash: a: readonly variable</span><br></pre></td></tr></table></figure><h3>Shell å­—ç¬¦ä¸²</h3><p>Shell å­—ç¬¦ä¸²å¯ä»¥ç”¨å•å¼•å·ï¼Œä¹Ÿå¯ä»¥ç”¨åŒå¼•å·ï¼Œä¹Ÿå¯ä»¥ä¸ç”¨å¼•å·ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">str='Hello World'</span><br><span class="line">name='Jack'</span><br><span class="line">str="Hello, $&#123;name&#125;"</span><br><span class="line">str="Hello, "$name""</span><br><span class="line">str="Hello, \"$name\"! "</span><br></pre></td></tr></table></figure><p>å…¶ä¸­åŒå¼•å·ä¸­å¯ä»¥å‡ºç°å˜é‡å’Œè½¬ä¹‰ç¬¦ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">string="abcd"</span><br><span class="line">echo $&#123;#string&#125; # è·å–å­—ç¬¦ä¸²é•¿åº¦</span><br></pre></td></tr></table></figure><p>æå–å­å­—ç¬¦ä¸²<br>ä»¥ä¸‹å®ä¾‹ä»å­—ç¬¦ä¸²ç¬¬ 2 ä¸ªå­—ç¬¦å¼€å§‹æˆªå– 4 ä¸ªå­—ç¬¦ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">string="Hello World"</span><br><span class="line">echo $&#123;string:1:4&#125; # è¾“å‡º ello</span><br></pre></td></tr></table></figure><p>æŸ¥æ‰¾å­—ç¬¦ä¸²</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">string="Hello World"</span><br><span class="line">echo `expr index "$string" llo` # 3</span><br></pre></td></tr></table></figure><h2>Shell æ•°ç»„</h2><p>Shell ä¸­åªæ”¯æŒä¸€ç»´æ•°ç»„</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">names=('leo' 'jack' 'tim')</span><br><span class="line">names[3]='petter' # å¯ä»¥ä¸ä½¿ç”¨è¿ç»­çš„ä¸‹æ ‡ï¼Œè€Œä¸”ä¸‹æ ‡çš„èŒƒå›´æ²¡æœ‰é™åˆ¶</span><br><span class="line">echo $&#123;names[0]&#125; # leo</span><br><span class="line">echo $&#123;names[@]&#125; # è·å–å…¨éƒ¨å…ƒç´ </span><br><span class="line">echo $&#123;#names[@]&#125; # è·å–æ•°ç»„é•¿åº¦</span><br><span class="line">echo $&#123;#names[*]&#125; # è·å–æ•°ç»„é•¿åº¦</span><br><span class="line">echo $&#123;#names[0]&#125; # è·å–ç¬¬ä¸€ä¸ªå…ƒç´ é•¿åº¦</span><br></pre></td></tr></table></figure><h2>Shell æ³¨é‡Š</h2><p>Shell æ²¡æœ‰å¤šè¡Œæ³¨é‡Š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">--------------------------------------------</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> è¿™æ˜¯ä¸€ä¸ªæ³¨é‡Š</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> authorï¼šlizhen</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> siteï¼šhttps://lz5z.com</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> sloganï¼šäººç”Ÿè‹¦çŸ­ï¼Œæˆ‘å†ç¡ä¼š</span></span><br><span class="line"><span class="meta">#</span><span class="bash">--------------------------------------------</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#### config start #####</span></span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> blabla</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> </span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#### config end  #####</span></span></span><br></pre></td></tr></table></figure><h2>Shell å‚æ•°</h2><p>åˆ›å»ºè„šæœ¬ <code>test.sh</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> author:lizhen</span></span><br><span class="line"></span><br><span class="line">echo "Shell ä¼ é€’å‚æ•°";</span><br><span class="line">echo "æ‰§è¡Œçš„æ–‡ä»¶åï¼š$0";</span><br><span class="line">echo "ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºï¼š$1";</span><br><span class="line">echo "ç¬¬äºŒä¸ªå‚æ•°ä¸ºï¼š$2";</span><br><span class="line">echo "ç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºï¼š$3";</span><br><span class="line">echo "å‚æ•°ä¸ªæ•°ï¼š$#";</span><br><span class="line">echo "å‚æ•°å­—ç¬¦ä¸²ï¼š$*";</span><br><span class="line">echo "æ‰€æœ‰å‚æ•°ï¼š$@";</span><br><span class="line">echo "è¿›ç¨‹IDå·: $$";</span><br></pre></td></tr></table></figure><p>ä¸ºè„šæœ¬è®¾ç½®æ‰§è¡Œæƒé™ï¼Œå¹¶æ‰§è¡Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">chmod +x test.sh</span><br><span class="line">./test.sh 1 2 4</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Shell ä¼ é€’å‚æ•°</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ‰§è¡Œçš„æ–‡ä»¶åï¼š./test.sh</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºï¼š1</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ç¬¬äºŒä¸ªå‚æ•°ä¸ºï¼š2</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºï¼š3</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å‚æ•°ä¸ªæ•°ï¼š4</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å‚æ•°å­—ç¬¦ä¸²ï¼š1 2 3 4</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ‰€æœ‰å‚æ•°ï¼š1 2 3 4</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> è¿›ç¨‹IDå·: 27694</span></span><br></pre></td></tr></table></figure><h2>Shell è¿ç®—ç¬¦</h2><p>åŸç”Ÿ bash ä¸æ”¯æŒæ•°å­¦è¿ç®—ç¬¦ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡å…¶ä»–å‘½ä»¤å®ç°ï¼Œæ¯”å¦‚ exprã€‚</p><h3>ç®—æœ¯è¿ç®—ç¬¦</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">val=`expr 2 + 2` # æ³¨æ„ç©ºæ ¼</span><br><span class="line">echo val # 4</span><br><span class="line">echo `expr 2 - 2` # 0</span><br><span class="line">echo `expr 2 \* 2` # 4 # ä¹˜å·å‰é¢å¿…é¡»è¦æœ‰åæ–œæ </span><br><span class="line">echo `expr 2 / 2` # 1</span><br><span class="line">echo `expr 3 % 2` # 1</span><br><span class="line">echo `expr 2 == 2` # 1</span><br><span class="line">echo `expr 2 != 2` # 0</span><br></pre></td></tr></table></figure><h3>å…³ç³»è¿ç®—ç¬¦</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[ $a -eq $b ] # -eq ç›¸ç­‰</span><br><span class="line">[ $a -ne $b ] # -ne ä¸ç­‰</span><br><span class="line">[ $a -gt $b ] # -gt å¤§äº</span><br><span class="line">[ $a -lt $b ] # -lt å°äº</span><br><span class="line">[ $a -ge $b ] # -ge å¤§äºç­‰äº</span><br><span class="line">[ $a -le $b ] # -le å°äºç­‰äº</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">a=$1</span><br><span class="line">b=$2</span><br><span class="line">echo $a</span><br><span class="line">echo $b</span><br><span class="line">if [ $a -eq $b ]</span><br><span class="line">then</span><br><span class="line">   echo "$a -eq $b : a ç­‰äº b"</span><br><span class="line">else</span><br><span class="line">   echo "$a -eq $b: a ä¸ç­‰äº b"</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">./test.sh 10 20</span><br><span class="line"><span class="meta">#</span><span class="bash"> 10 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 20</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="string">"10 -eq 20: a ä¸ç­‰äº b"</span></span></span><br></pre></td></tr></table></figure><h3>å¸ƒå°”è¿ç®—ç¬¦</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> author:lizhen</span></span><br><span class="line"></span><br><span class="line">a=10</span><br><span class="line">b=20</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> éè¿ç®— !</span></span><br><span class="line">if [ $a != $b ]</span><br><span class="line">then</span><br><span class="line">   echo "$a != $b : a ä¸ç­‰äº b"</span><br><span class="line">else</span><br><span class="line">   echo "$a != $b: a ç­‰äº b"</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æˆ–è¿ç®— -o</span></span><br><span class="line">if [ $a -lt 100 -o $b -gt 100 ]</span><br><span class="line">then</span><br><span class="line">   echo "$a å°äº 100 æˆ– $b å¤§äº 100 : true"</span><br><span class="line">else</span><br><span class="line">   echo "$a å°äº 100 æˆ– $b å¤§äº 100 : false"</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¸è¿ç®— -a</span></span><br><span class="line">if [ $a -lt 100 -a $b -gt 15 ]</span><br><span class="line">then</span><br><span class="line">   echo "$a å°äº 100 ä¸” $b å¤§äº 15 : true"</span><br><span class="line">else</span><br><span class="line">   echo "$a å°äº 100 ä¸” $b å¤§äº 15 : false"</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><h3>é€»è¾‘è¿ç®—ç¬¦</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">a=10</span><br><span class="line">b=20</span><br><span class="line"><span class="meta">#</span><span class="bash"> é€»è¾‘AND &amp;&amp;</span></span><br><span class="line">if [[ $a -lt 100 &amp;&amp; $b -gt 100 ]]</span><br><span class="line">then</span><br><span class="line">   echo "true"</span><br><span class="line">else</span><br><span class="line">   echo "false"</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> é€»è¾‘OR ||</span></span><br><span class="line">if [[ $a -lt 100 || $b -gt 100 ]]</span><br><span class="line">then</span><br><span class="line">   echo "true"</span><br><span class="line">else</span><br><span class="line">   echo "false"</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><h3>å­—ç¬¦ä¸²è¿ç®—ç¬¦</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a="abc"</span><br><span class="line">b="cde"</span><br><span class="line">[ $a = $b ] # å­—ç¬¦ä¸²ç›¸ç­‰</span><br><span class="line">[ $a != $b ] # å­—ç¬¦ä¸²ä¸ç­‰</span><br><span class="line">[ -z $a ] # å­—ç¬¦ä¸²é•¿åº¦ä¸º0</span><br><span class="line">[ -n $a ] # å­—ç¬¦ä¸²é•¿åº¦ä¸ä¸º0</span><br><span class="line">[ $a ] # å­—ç¬¦ä¸²ä¸ä¸ºç©º</span><br></pre></td></tr></table></figure><h2>echo å‘½ä»¤</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">echo "\"Are you OK?\"" # è½¬ä¹‰å­—ç¬¦</span><br><span class="line">echo "$a" # å˜é‡</span><br><span class="line">echo -e "I\'m \nOK" # -e å¼€å¯è½¬ä¹‰</span><br><span class="line">echo -e "I\'m OK \c" # -e å¼€å¯è½¬ä¹‰ \c ä¸æ¢è¡Œ</span><br><span class="line">echo "Are you OK?" &gt; tesh.sh # æ˜¾ç¤ºç»“æœåˆ°æ–‡ä»¶</span><br><span class="line">echo '$a\"' # $a\" # åŸæ ·è¾“å‡ºå­—ç¬¦ä¸²ï¼Œä¸è½¬ä¹‰ä¸å»å˜é‡ å•å¼•å·</span><br><span class="line">echo `date` # æ˜¾ç¤ºæ—¶é—´</span><br></pre></td></tr></table></figure><h2>printf å‘½ä»¤</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">printf</span> format-string [arguments...]</span></span><br><span class="line"></span><br><span class="line">printf "%-10s %-8s %-4s\n" å§“å æ€§åˆ« ä½“é‡kg  </span><br><span class="line">printf "%-10s %-8s %-4.2f\n" éƒ­é– ç”· 66.1234 </span><br><span class="line">printf "%-10s %-8s %-4.2f\n" æ¨è¿‡ ç”· 48.6543 </span><br><span class="line">printf "%-10s %-8s %-4.2f\n" éƒ­èŠ™ å¥³ 47.9876</span><br></pre></td></tr></table></figure><p>%s %c %d %féƒ½æ˜¯æ ¼å¼æ›¿ä»£ç¬¦</p><p>%-10s æŒ‡ä¸€ä¸ªå®½åº¦ä¸º10ä¸ªå­—ç¬¦ï¼ˆ-è¡¨ç¤ºå·¦å¯¹é½ï¼Œæ²¡æœ‰åˆ™è¡¨ç¤ºå³å¯¹é½ï¼‰ï¼Œä»»ä½•å­—ç¬¦éƒ½ä¼šè¢«æ˜¾ç¤ºåœ¨10ä¸ªå­—ç¬¦å®½çš„å­—ç¬¦å†…ï¼Œå¦‚æœä¸è¶³åˆ™è‡ªåŠ¨ä»¥ç©ºæ ¼å¡«å……ï¼Œè¶…è¿‡ä¹Ÿä¼šå°†å†…å®¹å…¨éƒ¨æ˜¾ç¤ºå‡ºæ¥ã€‚</p><p>%-4.2f æŒ‡æ ¼å¼åŒ–ä¸ºå°æ•°ï¼Œå…¶ä¸­.2æŒ‡ä¿ç•™2ä½å°æ•°ã€‚</p><h2>test å‘½ä»¤</h2><p>test å‘½ä»¤ç”¨äºæ£€æŸ¥æŸä¸ªæ¡ä»¶æ˜¯å¦æˆç«‹ï¼Œå®ƒå¯ä»¥è¿›è¡Œæ•°å€¼ã€å­—ç¬¦å’Œæ–‡ä»¶ä¸‰ä¸ªæ–¹é¢çš„æµ‹è¯•ã€‚</p><h3>æ•°å€¼æµ‹è¯•</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a=10</span><br><span class="line">b=20</span><br><span class="line">if test $[a] -eq $[b] # å¦‚æœ a ç­‰äº b</span><br><span class="line">then</span><br><span class="line">  echo "$a ç­‰äº $b"</span><br><span class="line">else</span><br><span class="line">  echo "$a ä¸ç­‰äº $b"</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><p>ä»£ç ä¸­çš„ [] è¡¨ç¤ºæ‰§è¡ŒåŸºæœ¬çš„ç®—æ•°è¿ç®—ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a=10</span><br><span class="line">b=10</span><br><span class="line">echo "$[a+b]" # 20 # ä¸èƒ½æœ‰ç©ºæ ¼</span><br></pre></td></tr></table></figure><h3>å­—ç¬¦ä¸²æµ‹è¯•</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a="abc"</span><br><span class="line">b="ABC"</span><br><span class="line">if test $a = $b</span><br><span class="line">then </span><br><span class="line">  echo "å­—ç¬¦ä¸²ç›¸ç­‰"</span><br><span class="line">else </span><br><span class="line">  echo "å­—ç¬¦ä¸²ä¸ç­‰"</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><h3>æ–‡ä»¶æµ‹è¯•</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> -e æ–‡ä»¶å  å¦‚æœæ–‡ä»¶å­˜åœ¨åˆ™ä¸ºçœŸ</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> -r æ–‡ä»¶å  å¦‚æœæ–‡ä»¶å­˜åœ¨ä¸”å¯è¯»åˆ™ä¸ºçœŸ</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> -w æ–‡ä»¶å  å¦‚æœæ–‡ä»¶å­˜åœ¨ä¸”å¯å†™åˆ™ä¸ºçœŸ</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> -x æ–‡ä»¶å  å¦‚æœæ–‡ä»¶å­˜åœ¨ä¸”å¯æ‰§è¡Œåˆ™ä¸ºçœŸ</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> -s æ–‡ä»¶å  å¦‚æœæ–‡ä»¶å­˜åœ¨ä¸”è‡³å°‘æœ‰ä¸€ä¸ªå­—ç¬¦åˆ™ä¸ºçœŸ</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> -d æ–‡ä»¶å  å¦‚æœæ–‡ä»¶å­˜åœ¨ä¸”ä¸ºç›®å½•åˆ™ä¸ºçœŸ</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> -f æ–‡ä»¶å  å¦‚æœæ–‡ä»¶å­˜åœ¨ä¸”ä¸ºæ™®é€šæ–‡ä»¶åˆ™ä¸ºçœŸ</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> -c æ–‡ä»¶å  å¦‚æœæ–‡ä»¶å­˜åœ¨ä¸”ä¸ºå­—ç¬¦å‹ç‰¹æ®Šæ–‡ä»¶åˆ™ä¸ºçœŸ</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> -b æ–‡ä»¶å  å¦‚æœæ–‡ä»¶å­˜åœ¨ä¸”ä¸ºå—ç‰¹æ®Šæ–‡ä»¶åˆ™ä¸ºçœŸ</span></span><br><span class="line"></span><br><span class="line">if test -e ./test.sh</span><br><span class="line">then </span><br><span class="line">  echo "test.sh æ–‡ä»¶å­˜åœ¨"</span><br><span class="line">else</span><br><span class="line">  echo "æ–‡ä»¶ä¸å­˜åœ¨"</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><h2>Shell æµç¨‹æ§åˆ¶</h2><h3>æ¡ä»¶æ§åˆ¶</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">if</span> </span></span><br><span class="line">if condition</span><br><span class="line">then </span><br><span class="line">  command1</span><br><span class="line">  command2</span><br><span class="line">  ...</span><br><span class="line">  commandN</span><br><span class="line">fi  </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">if</span> <span class="keyword">else</span>-if <span class="keyword">else</span></span></span><br><span class="line">if condition1</span><br><span class="line">then</span><br><span class="line">    command1</span><br><span class="line">elif condition2 </span><br><span class="line">then </span><br><span class="line">    command2</span><br><span class="line">else</span><br><span class="line">    commandN</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><h3>for å¾ªç¯</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">for var in item1 item2 ... itemN</span><br><span class="line">do</span><br><span class="line">    command1</span><br><span class="line">    command2</span><br><span class="line">    ...</span><br><span class="line">    commandN</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">for</span> å¾ªç¯</span></span><br><span class="line">for var in item1 item2 ... itemN; do command1; command2â€¦ done;</span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">for</span> å¾ªç¯</span></span><br><span class="line">for loop in 1 2 3 4 5</span><br><span class="line">do</span><br><span class="line">    echo "The value is: $loop"</span><br><span class="line">done</span><br></pre></td></tr></table></figure><h3>while å¾ªç¯</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">while condition</span><br><span class="line">do </span><br><span class="line">  command</span><br><span class="line">done</span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">while</span> å¾ªç¯</span></span><br><span class="line">int=1</span><br><span class="line">while(( $int&lt;=5 ))</span><br><span class="line">do</span><br><span class="line">  echo $int</span><br><span class="line">  let "int++"</span><br><span class="line">done</span><br></pre></td></tr></table></figure><h3>æ— é™å¾ªç¯</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">while true</span><br><span class="line">do </span><br><span class="line">  command</span><br><span class="line">done</span><br></pre></td></tr></table></figure><h3>case</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">case å€¼ in</span><br><span class="line">æ¨¡å¼1)</span><br><span class="line">    command1</span><br><span class="line">    command2</span><br><span class="line">    ...</span><br><span class="line">    commandN</span><br><span class="line">    ;;</span><br><span class="line">æ¨¡å¼2ï¼‰</span><br><span class="line">    command1</span><br><span class="line">    command2</span><br><span class="line">    ...</span><br><span class="line">    commandN</span><br><span class="line">    ;;</span><br><span class="line">esac</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">case</span></span></span><br><span class="line">echo 'è¾“å…¥ 1 åˆ° 4 ä¹‹é—´çš„æ•°å­—:'</span><br><span class="line">echo 'ä½ è¾“å…¥çš„æ•°å­—ä¸º:'</span><br><span class="line">read aNum</span><br><span class="line">case $aNum in</span><br><span class="line">    1)  echo 'ä½ é€‰æ‹©äº† 1'</span><br><span class="line">    ;;</span><br><span class="line">    2)  echo 'ä½ é€‰æ‹©äº† 2'</span><br><span class="line">    ;;</span><br><span class="line">    3)  echo 'ä½ é€‰æ‹©äº† 3'</span><br><span class="line">    ;;</span><br><span class="line">    4)  echo 'ä½ é€‰æ‹©äº† 4'</span><br><span class="line">    ;;</span><br><span class="line">    *)  echo 'ä½ æ²¡æœ‰è¾“å…¥ 1 åˆ° 4 ä¹‹é—´çš„æ•°å­—'</span><br><span class="line">    ;;</span><br><span class="line">esac</span><br></pre></td></tr></table></figure><p>caseå·¥ä½œæ–¹å¼å¦‚ä¸Šæ‰€ç¤ºã€‚å–å€¼åé¢å¿…é¡»ä¸ºå•è¯inï¼Œæ¯ä¸€æ¨¡å¼å¿…é¡»ä»¥å³æ‹¬å·ç»“æŸã€‚å–å€¼å¯ä»¥ä¸ºå˜é‡æˆ–å¸¸æ•°ã€‚åŒ¹é…å‘ç°å–å€¼ç¬¦åˆæŸä¸€æ¨¡å¼åï¼Œå…¶é—´æ‰€æœ‰å‘½ä»¤å¼€å§‹æ‰§è¡Œç›´è‡³ ;;ã€‚</p><p>å–å€¼å°†æ£€æµ‹åŒ¹é…çš„æ¯ä¸€ä¸ªæ¨¡å¼ã€‚ä¸€æ—¦æ¨¡å¼åŒ¹é…ï¼Œåˆ™æ‰§è¡Œå®ŒåŒ¹é…æ¨¡å¼ç›¸åº”å‘½ä»¤åä¸å†ç»§ç»­å…¶ä»–æ¨¡å¼ã€‚å¦‚æœæ— ä¸€åŒ¹é…æ¨¡å¼ï¼Œä½¿ç”¨æ˜Ÿå· * æ•è·è¯¥å€¼ï¼Œå†æ‰§è¡Œåé¢çš„å‘½ä»¤ã€‚</p><h3>break</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">while :</span><br><span class="line">do</span><br><span class="line">    echo -n "è¾“å…¥ 1 åˆ° 5 ä¹‹é—´çš„æ•°å­—:"</span><br><span class="line">    read aNum</span><br><span class="line">    case $aNum in</span><br><span class="line">        1|2|3|4|5) echo "ä½ è¾“å…¥çš„æ•°å­—ä¸º $aNum!"</span><br><span class="line">        ;;</span><br><span class="line">        *) echo "ä½ è¾“å…¥çš„æ•°å­—ä¸æ˜¯ 1 åˆ° 5 ä¹‹é—´çš„! æ¸¸æˆç»“æŸ"</span><br><span class="line">            break</span><br><span class="line">        ;;</span><br><span class="line">    esac</span><br><span class="line">done</span><br></pre></td></tr></table></figure><h3>continue</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">while :</span><br><span class="line">do</span><br><span class="line">    echo -n "è¾“å…¥ 1 åˆ° 5 ä¹‹é—´çš„æ•°å­—: "</span><br><span class="line">    read aNum</span><br><span class="line">    case $aNum in</span><br><span class="line">        1|2|3|4|5) echo "ä½ è¾“å…¥çš„æ•°å­—ä¸º $aNum!"</span><br><span class="line">        ;;</span><br><span class="line">        *) echo "ä½ è¾“å…¥çš„æ•°å­—ä¸æ˜¯ 1 åˆ° 5 ä¹‹é—´çš„!"</span><br><span class="line">            continue</span><br><span class="line">            echo "æ¸¸æˆç»“æŸ"</span><br><span class="line">        ;;</span><br><span class="line">    esac</span><br><span class="line">done</span><br></pre></td></tr></table></figure><p>esac<br>caseçš„è¯­æ³•å’ŒC familyè¯­è¨€å·®åˆ«å¾ˆå¤§ï¼Œå®ƒéœ€è¦ä¸€ä¸ªesacï¼ˆå°±æ˜¯caseåè¿‡æ¥ï¼‰ä½œä¸ºç»“æŸæ ‡è®°ï¼Œæ¯ä¸ªcaseåˆ†æ”¯ç”¨å³åœ†æ‹¬å·ï¼Œç”¨ä¸¤ä¸ªåˆ†å·è¡¨ç¤ºbreakã€‚</p><h2>Shell å‡½æ•°</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">funWithReturn()&#123;</span><br><span class="line">    echo "è¾“å…¥çš„ä¸¤ä¸ªæ•°å­—è¿›è¡Œç›¸åŠ è¿ç®—..."</span><br><span class="line">    echo "è¾“å…¥ç¬¬ä¸€ä¸ªæ•°å­—: "</span><br><span class="line">    read aNum</span><br><span class="line">    echo "è¾“å…¥ç¬¬äºŒä¸ªæ•°å­—: "</span><br><span class="line">    read anotherNum</span><br><span class="line">    echo "ä¸¤ä¸ªæ•°å­—åˆ†åˆ«ä¸º $aNum å’Œ $anotherNum !"</span><br><span class="line">    return $(($aNum+$anotherNum))</span><br><span class="line">&#125;</span><br><span class="line">funWithReturn</span><br><span class="line">echo "è¾“å…¥çš„ä¸¤ä¸ªæ•°å­—ä¹‹å’Œä¸º $? !"</span><br></pre></td></tr></table></figure><p>å‡½æ•°è¿”å›å€¼åœ¨è°ƒç”¨è¯¥å‡½æ•°åé€šè¿‡ $? æ¥è·å¾—ã€‚</p><blockquote><p>æ³¨æ„ï¼šæ‰€æœ‰å‡½æ•°åœ¨ä½¿ç”¨å‰å¿…é¡»å®šä¹‰ã€‚è¿™æ„å‘³ç€å¿…é¡»å°†å‡½æ•°æ”¾åœ¨è„šæœ¬å¼€å§‹éƒ¨åˆ†ï¼Œç›´è‡³shellè§£é‡Šå™¨é¦–æ¬¡å‘ç°å®ƒæ—¶ï¼Œæ‰å¯ä»¥ä½¿ç”¨ã€‚è°ƒç”¨å‡½æ•°ä»…ä½¿ç”¨å…¶å‡½æ•°åå³å¯ã€‚</p></blockquote><h3>å‡½æ•°å‚æ•°</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">funWithParam()&#123;</span><br><span class="line">    echo "ç¬¬ä¸€ä¸ªå‚æ•°ä¸º $1 !"</span><br><span class="line">    echo "ç¬¬äºŒä¸ªå‚æ•°ä¸º $2 !"</span><br><span class="line">    echo "ç¬¬åä¸ªå‚æ•°ä¸º $10 !"</span><br><span class="line">    echo "ç¬¬åä¸ªå‚æ•°ä¸º $&#123;10&#125; !"</span><br><span class="line">    echo "ç¬¬åä¸€ä¸ªå‚æ•°ä¸º $&#123;11&#125; !"</span><br><span class="line">    echo "å‚æ•°æ€»æ•°æœ‰ $# ä¸ª!"</span><br><span class="line">    echo "ä½œä¸ºä¸€ä¸ªå­—ç¬¦ä¸²è¾“å‡ºæ‰€æœ‰å‚æ•° $* !"</span><br><span class="line">&#125;</span><br><span class="line">funWithParam 1 2 3 4 5 6 7 8 9 34 73</span><br></pre></td></tr></table></figure><h2>Shell é‡å®šå‘</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">command &gt; file # å°†è¾“å‡ºé‡å®šå‘åˆ° file</span><br><span class="line">command &lt; file # å°†è¾“å…¥é‡å®šå‘åˆ° file</span><br><span class="line">command &gt;&gt; file # å°†è¾“å‡ºä»¥è¿½åŠ çš„æ–¹å¼é‡å®šå‘åˆ° file</span><br></pre></td></tr></table></figure><h3>ç¦æ­¢è¾“å‡º</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">command &gt; /dev/null</span><br></pre></td></tr></table></figure><p>/dev/null æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ–‡ä»¶ï¼Œå†™å…¥åˆ°å®ƒçš„å†…å®¹éƒ½ä¼šè¢«ä¸¢å¼ƒï¼›å¦‚æœå°è¯•ä»è¯¥æ–‡ä»¶è¯»å–å†…å®¹ï¼Œé‚£ä¹ˆä»€ä¹ˆä¹Ÿè¯»ä¸åˆ°ã€‚ä½†æ˜¯ /dev/null æ–‡ä»¶éå¸¸æœ‰ç”¨ï¼Œå°†å‘½ä»¤çš„è¾“å‡ºé‡å®šå‘åˆ°å®ƒï¼Œä¼šèµ·åˆ°&quot;ç¦æ­¢è¾“å‡º&quot;çš„æ•ˆæœã€‚</p><p>å¦‚æœå¸Œæœ›å±è”½ stdout å’Œ stderrï¼Œå¯ä»¥è¿™æ ·å†™ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">command</span> &gt; /dev/null 2&gt;&amp;1</span></span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼š0 æ˜¯æ ‡å‡†è¾“å…¥ï¼ˆSTDINï¼‰ï¼Œ1 æ˜¯æ ‡å‡†è¾“å‡ºï¼ˆSTDOUTï¼‰ï¼Œ2 æ˜¯æ ‡å‡†é”™è¯¯è¾“å‡ºï¼ˆSTDERRï¼‰</p></blockquote><h2>Shell æ–‡ä»¶åŒ…å«</h2><p><a href="http://test1.sh" target="_blank" rel="noopener">test1.sh</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a="abc"</span><br></pre></td></tr></table></figure><p><a href="http://test2.sh" target="_blank" rel="noopener">test2.sh</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> ä½¿ç”¨ . å·æ¥å¼•ç”¨test1.sh æ–‡ä»¶</span></span><br><span class="line">. ./test1.sh</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æˆ–è€…ä½¿ç”¨ä»¥ä¸‹åŒ…å«æ–‡ä»¶ä»£ç </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">source</span> ./test1.sh</span></span><br><span class="line"></span><br><span class="line">echo "$a"</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¸º <a href="http://test2.sh" target="_blank" rel="noopener">test2.sh</a> æ·»åŠ å¯æ‰§è¡Œæƒé™å¹¶æ‰§è¡Œï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> chmod +x test2.sh </span></span><br><span class="line"><span class="meta">$</span><span class="bash"> ./test2.sh</span></span><br></pre></td></tr></table></figure><blockquote><p>æ³¨ï¼šè¢«åŒ…å«çš„æ–‡ä»¶ <a href="http://test1.sh" target="_blank" rel="noopener">test1.sh</a> ä¸éœ€è¦å¯æ‰§è¡Œæƒé™ã€‚</p></blockquote><h2>read</h2><p>-p è¾“å…¥æç¤ºä¿¡æ¯<br>-t ç­‰å¾…æ—¶é—´ï¼ˆå•ä½æ˜¯ç§’ï¼‰<br>-n å­—ç¬¦æ•°ï¼Œreadåª<br>-s è¾“å…¥éšè—æ•°æ®</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">read -p "please input your name: " -t 30 name</span><br><span class="line">echo $name</span><br><span class="line"></span><br><span class="line">read -p "please input your sex [M/F]: " -n 1 sex</span><br><span class="line">echo -e "\n"</span><br><span class="line">echo $sex</span><br><span class="line"></span><br><span class="line">read -p "please input your password: " -s password</span><br><span class="line">echo -e "\n"</span><br><span class="line">echo $password</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;Shell å˜é‡&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å˜é‡é»˜è®¤éƒ½æ˜¯å­—ç¬¦ä¸²ç±»å‹&lt;/li&gt;
&lt;li&gt;å˜é‡åå’Œç­‰å·ä¹‹é—´ä¸èƒ½æœ‰ç©ºæ ¼&lt;/li&gt;
&lt;li&gt;å‘½åï¼šåªèƒ½ä½¿ç”¨è‹±æ–‡å­—æ¯ï¼Œæ•°å­—å’Œä¸‹åˆ’çº¿ï¼Œé¦–ä¸ªå­—ç¬¦ä¸èƒ½ä»¥æ•°å­—å¼€å¤´&lt;/li&gt;
&lt;li&gt;æŸ¥çœ‹å˜é‡ set å‘½ä»¤ï¼Œåˆ é™¤å˜é‡ &lt;code&gt;unset variable_name&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;set -u&lt;/code&gt; è°ƒç”¨æœªå£°æ˜å˜é‡æŠ¥é”™ï¼ˆé»˜è®¤æ— æç¤ºï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;å˜é‡å åŠ &lt;/h3&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;x=123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;x=&quot;$x&quot;456&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;x=$&amp;#123;x&amp;#125;789&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;echo $x # 123456789&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Linux" scheme="https://lz5z.com/categories/Linux/"/>
    
    
      <category term="Shell" scheme="https://lz5z.com/tags/Shell/"/>
    
  </entry>
  
  <entry>
    <title>HTTP/2 å­¦ä¹ </title>
    <link href="https://lz5z.com/HTTP2-study/"/>
    <id>https://lz5z.com/HTTP2-study/</id>
    <published>2018-03-06T21:35:06.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h2>HTTP/2.0 ç®€ä»‹</h2><ol><li>HTTP/2 æ ‡å‡†äº 2015 å¹´å‘å¸ƒï¼Œç›®å‰å¤§éƒ¨åˆ†ä¸»æµæµè§ˆå™¨å‡å·²æä¾›æ”¯æŒã€‚</li><li>HTTP/2 æ²¡æœ‰æ”¹å˜ HTTP çš„åº”ç”¨è¯­ä¹‰ï¼Œå…¶è¯·æ±‚æ–¹æ³•ã€çŠ¶æ€ç ã€URI ç­‰æ ¸å¿ƒæ¦‚å¿µä¸ HTTP/1.1 ä¿æŒä¸€è‡´ã€‚</li><li>HTTP/2 é‡‡ç”¨äº†äºŒè¿›åˆ¶è€Œéæ˜æ–‡æ¥æ‰“åŒ…ã€ä¼ è¾“å®¢æˆ·ç«¯â€”æœåŠ¡å™¨é—´çš„æ•°æ®ã€‚</li><li>HTTP/2 çš„å‰èº«æ˜¯ <a href="https://zh.wikipedia.org/wiki/SPDY" target="_blank" rel="noopener">SPDY åè®®</a>ã€‚</li><li>HTTP/2 ä¸­ TLS ä¸ºå¯é€‰ï¼Œä½†æ˜¯å¤§å‚å•†å¦‚ chrome å’Œ firefox è¡¨ç¤ºåªä¼šå®ç°åŸºäº TLS çš„ HTTP/2ã€‚æ‰€ä»¥è¦éƒ¨ç½² HTTP/2ï¼Œé¦–å…ˆè¦å‡çº§ HTTPSã€‚</li><li>HTTP/2 é€šè¿‡ä»¥ä¸‹ä¸¾æªï¼Œå‡å°‘ç½‘ç»œå»¶è¿Ÿï¼Œæä¾›æµè§ˆå™¨åŠ è½½é€Ÿåº¦ï¼š<ul><li>å¯¹ HTTP å¤´å­—æ®µè¿›è¡Œæ•°æ®å‹ç¼©(å³ HPACK ç®—æ³•)ï¼›</li><li>HTTP/2 æœåŠ¡ç«¯æ¨é€(Server Push)ï¼›</li><li>è¯·æ±‚ç®¡çº¿åŒ–ï¼›</li><li>ä¿®å¤ HTTP/1. 0ç‰ˆæœ¬ä»¥æ¥æœªä¿®å¤çš„é˜Ÿå¤´é˜»å¡é—®é¢˜ï¼›</li><li>å¯¹æ•°æ®ä¼ è¾“é‡‡ç”¨å¤šè·¯å¤ç”¨ï¼Œè®©å¤šä¸ªè¯·æ±‚åˆå¹¶åœ¨åŒä¸€ TCP è¿æ¥å†…ã€‚</li></ul></li></ol><a id="more"></a><h2>HTTP/2 æµ‹è¯•</h2><p><a href="https://http2.akamai.com/demo" target="_blank" rel="noopener">Akamai http2 demo</a> è¿™ä¸ª Akamai å…¬å¸å»ºç«‹çš„å®˜æ–¹ demoï¼Œå·¦å³ä¸¤è¾¹åˆ†åˆ«ä¸º HTTP/1.1 å’Œ HTTP/2ï¼Œä¸¤è¾¹éƒ½åŒæ—¶è¯·æ±‚ 300 å¤šå¼ å›¾ç‰‡ï¼Œä»åŠ è½½æ—¶é—´å¯ä»¥çœ‹å‡º HTTP/2 åœ¨é€Ÿåº¦ä¸Šçš„ç»å¯¹ä¼˜åŠ¿ã€‚</p><p>chrome å•†åº—ä¸­æœ‰ä¸€ä¸ªå·¥å…· <a href="https://chrome.google.com/webstore/detail/http2-and-spdy-indicator/mpbpobfflnpcgagjijhmgnchggcjblin" target="_blank" rel="noopener">HTTP/2 and SPDY indicator</a> ç”¨æ¥æŸ¥çœ‹å½“å‰ç½‘ç«™æ˜¯å¦åŸºäº HTTP/2ï¼Œæ·»åŠ åˆ° chrome åå¦‚æœè“è‰²é—ªç”µäº®äº†è¯´æ˜æ”¯æŒ HTTP/2ã€‚</p><h2>HTTP/2 æ–°ç‰¹æ€§</h2><p>HTTP/2 æ‰€æœ‰æ€§èƒ½å¢å¼ºçš„æ ¸å¿ƒåœ¨äºæ–°çš„äºŒè¿›åˆ¶åˆ†å¸§å±‚ï¼Œå®ƒå®šä¹‰äº†å¦‚ä½•å°è£… HTTP æ¶ˆæ¯å¹¶åœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´ä¼ è¾“ã€‚HTTP/1.x åè®®è§£æåŸºäºçº¯æ–‡æœ¬ï¼Œè€Œ HTTP/2 å°†æ‰€æœ‰ä¼ è¾“çš„ä¿¡æ¯åˆ†å‰²ä¸ºæ›´å°çš„æ¶ˆæ¯å’Œå¸§ï¼Œå¹¶é‡‡ç”¨äºŒè¿›åˆ¶æ ¼å¼å¯¹å®ƒä»¬ç¼–ç ã€‚äºŒè¿›åˆ¶åªæœ‰ 0 å’Œ 1 çš„ç»„åˆå®ç°èµ·æ¥æ–¹ä¾¿ä¸”å¥å£®ã€‚</p><h3>å¸§ã€æ¶ˆæ¯ã€æµå’Œ TCP è¿æ¥</h3><p>æœ‰åˆ«äº HTTP/1.1 åœ¨è¿æ¥ä¸­çš„æ˜æ–‡è¯·æ±‚ï¼ŒHTTP/2 å°†ä¸€ä¸ª TCP è¿æ¥åˆ†ä¸ºè‹¥å¹²ä¸ªæµï¼ˆStreamï¼‰ï¼Œæ¯ä¸ªæµä¸­å¯ä»¥ä¼ è¾“è‹¥å¹²æ¶ˆæ¯ï¼ˆMessageï¼‰ï¼Œæ¯ä¸ªæ¶ˆæ¯ç”±è‹¥å¹²æœ€å°çš„äºŒè¿›åˆ¶å¸§ï¼ˆFrameï¼‰ç»„æˆã€‚è¿™ä¹Ÿæ˜¯ HTTP/1.1 ä¸ HTTP/2 æœ€å¤§çš„åŒºåˆ«ã€‚ HTTP/2 ä¸­ï¼Œæ¯ä¸ªç”¨æˆ·çš„æ“ä½œè¡Œä¸ºè¢«åˆ†é…äº†ä¸€ä¸ªæµç¼–å·(stream ID)ï¼Œè¿™æ„å‘³ç€ç”¨æˆ·ä¸æœåŠ¡ç«¯ä¹‹é—´åˆ›å»ºäº†ä¸€ä¸ª TCP é€šé“ï¼›åè®®å°†æ¯ä¸ªè¯·æ±‚åˆ†åŒºä¸ºäºŒè¿›åˆ¶çš„æ§åˆ¶å¸§ä¸æ•°æ®å¸§éƒ¨åˆ†ï¼Œä»¥ä¾¿è§£æã€‚</p><h3>å¤šè·¯å¤ç”¨</h3><p>åœ¨ HTTP/1.1 åè®®ä¸­ ã€Œæµè§ˆå™¨å®¢æˆ·ç«¯åœ¨åŒä¸€æ—¶é—´ï¼Œé’ˆå¯¹åŒä¸€åŸŸåä¸‹çš„è¯·æ±‚æœ‰ä¸€å®šæ•°é‡é™åˆ¶ã€‚è¶…è¿‡é™åˆ¶æ•°ç›®çš„è¯·æ±‚ä¼šè¢«é˜»å¡ã€è¿™ä¹Ÿæ˜¯æˆ‘ä»¬åœ¨ç«™ç‚¹ä¸­ä½¿ç”¨ CDN çš„ä¸»è¦åŸå› ã€‚</p><p>å¤šè·¯å¤ç”¨åŸç†ä¸Šè¿˜æ˜¯åŸºäºä»¥ä¸Š TCP è¿æ¥é€šé“ï¼Œé€šè¿‡å•ä¸€çš„ TCP è¿æ¥å‘èµ·å’Œå“åº”å¤šé‡è¯·æ±‚æœºåˆ¶ã€‚</p><h3>é¦–éƒ¨å‹ç¼© - HPACK ç®—æ³•</h3><p>åœ¨ HTTP/1.x ä¸­ï¼Œheader ä¸­å¸¦æœ‰å¤§é‡ä¿¡æ¯ï¼Œè€Œä¸”æ¯æ¬¡éƒ½è¦é‡å¤å‘é€ï¼ŒHTTP/2 ä¸­å¼•å…¥ HPACK ç®—æ³•ç”¨äºå¯¹ HTTP å¤´éƒ¨åšå‹ç¼©ã€‚å…¶åŸç†åœ¨äºï¼š</p><ul><li>å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯å…±åŒç»´æŠ¤ä¸€ä»½é™æ€å­—å…¸ï¼ˆStatic Tableï¼‰ï¼Œå…¶ä¸­åŒ…å«äº†å¸¸è§å¤´éƒ¨ååŠå¸¸è§å¤´éƒ¨åç§°ä¸å€¼çš„ç»„åˆçš„ä»£ç ï¼›</li><li>å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯æ ¹æ®å…ˆå…¥å…ˆå‡ºçš„åŸåˆ™ï¼Œç»´æŠ¤ä¸€ä»½å¯åŠ¨æ€æ·»åŠ å†…å®¹çš„å…±åŒåŠ¨æ€å­—å…¸ï¼ˆDynamic Tableï¼‰ï¼›</li><li>å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å…±åŒæ”¯æŒåŸºäºç›¸åŒå†…å®¹å¾—é™æ€å“ˆå¤«æ›¼ç è¡¨çš„å“ˆå¤«æ›¼ç¼–ç ï¼ˆHuffman Codingï¼‰ã€‚</li></ul><h3>æœåŠ¡å™¨æ¨é€ - Server Push</h3><p>HTTP/2 å¼•å…¥äº†æœåŠ¡å™¨æ¨é€ï¼Œå¯ä»¥åœ¨å®¢æˆ·ç«¯è¯·æ±‚èµ„æºä¹‹å‰å‘é€æ•°æ®ï¼Œè¿™å…è®¸æœåŠ¡å™¨ç›´æ¥æä¾›æµè§ˆå™¨æ¸²æŸ“é¡µé¢æ‰€éœ€èµ„æºï¼Œè€Œæ— é¡»æµè§ˆå™¨åœ¨æ”¶åˆ°ã€è§£æé¡µé¢åå†æèµ·ä¸€è½®è¯·æ±‚ï¼ŒèŠ‚çº¦äº†åŠ è½½æ—¶é—´ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒæœåŠ¡å™¨è¿˜èƒ½å¤Ÿç¼“å­˜æ•°æ®ï¼Œåœ¨åŒæºç­–ç•¥ä¸‹ï¼Œä¸åŒé¡µé¢å…±äº«ç¼“å­˜èµ„æºæˆä¸ºå¯èƒ½ã€‚</p><h3>é‡ç½®</h3><p>HTTP/1.1 çš„æœ‰ä¸€ä¸ªç¼ºç‚¹æ˜¯ï¼šå½“ä¸€ä¸ªå«æœ‰ç¡®åˆ‡å€¼çš„ Content-Lengt hçš„ HTTP æ¶ˆæ¯è¢«é€å‡ºä¹‹åï¼Œä½ å°±å¾ˆéš¾ä¸­æ–­å®ƒäº†ã€‚å½“ç„¶ï¼Œé€šå¸¸ä½ å¯ä»¥æ–­å¼€æ•´ä¸ª TCP é“¾æ¥ï¼ˆä½†ä¹Ÿä¸æ€»æ˜¯å¯ä»¥è¿™æ ·ï¼‰ï¼Œä½†è¿™æ ·å¯¼è‡´çš„ä»£ä»·å°±æ˜¯éœ€è¦é€šè¿‡ä¸‰æ¬¡æ¡æ‰‹æ¥é‡æ–°å»ºç«‹ä¸€ä¸ªæ–°çš„TCPè¿æ¥ã€‚</p><p>ä¸€ä¸ªæ›´å¥½çš„æ–¹æ¡ˆæ˜¯åªç»ˆæ­¢å½“å‰ä¼ è¾“çš„æ¶ˆæ¯å¹¶é‡æ–°å‘é€ä¸€ä¸ªæ–°çš„ã€‚åœ¨ HTTP/2 é‡Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å‘é€ RST_STREAM å¸§æ¥å®ç°è¿™ç§éœ€æ±‚ï¼Œä»è€Œé¿å…æµªè´¹å¸¦å®½å’Œä¸­æ–­å·²æœ‰çš„è¿æ¥ã€‚</p><h2>å‚è€ƒæ–‡æ¡£</h2><ul><li><a href="http://www.alloyteam.com/2016/07/httphttp2-0spdyhttps-reading-this-is-enough/#prettyPhoto" target="_blank" rel="noopener">HTTP,HTTP2.0,SPDY,HTTPSä½ åº”è¯¥çŸ¥é“çš„ä¸€äº›äº‹</a></li><li><a href="https://imququ.com/post/http2-resource.html" target="_blank" rel="noopener">HTTP/2 èµ„æ–™æ±‡æ€»</a></li><li><a href="https://www.zhihu.com/question/34074946" target="_blank" rel="noopener">HTTP/2.0 ç›¸æ¯”1.0æœ‰å“ªäº›é‡å¤§æ”¹è¿›ï¼Ÿ</a></li><li><a href="https://zh.wikipedia.org/wiki/HTTP/2" target="_blank" rel="noopener">HTTP/2</a></li><li><a href="https://ye11ow.gitbooks.io/http2-explained/" target="_blank" rel="noopener">http2è®²è§£</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;HTTP/2.0 ç®€ä»‹&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;HTTP/2 æ ‡å‡†äº 2015 å¹´å‘å¸ƒï¼Œç›®å‰å¤§éƒ¨åˆ†ä¸»æµæµè§ˆå™¨å‡å·²æä¾›æ”¯æŒã€‚&lt;/li&gt;
&lt;li&gt;HTTP/2 æ²¡æœ‰æ”¹å˜ HTTP çš„åº”ç”¨è¯­ä¹‰ï¼Œå…¶è¯·æ±‚æ–¹æ³•ã€çŠ¶æ€ç ã€URI ç­‰æ ¸å¿ƒæ¦‚å¿µä¸ HTTP/1.1 ä¿æŒä¸€è‡´ã€‚&lt;/li&gt;
&lt;li&gt;HTTP/2 é‡‡ç”¨äº†äºŒè¿›åˆ¶è€Œéæ˜æ–‡æ¥æ‰“åŒ…ã€ä¼ è¾“å®¢æˆ·ç«¯â€”æœåŠ¡å™¨é—´çš„æ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;HTTP/2 çš„å‰èº«æ˜¯ &lt;a href=&quot;https://zh.wikipedia.org/wiki/SPDY&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;SPDY åè®®&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;HTTP/2 ä¸­ TLS ä¸ºå¯é€‰ï¼Œä½†æ˜¯å¤§å‚å•†å¦‚ chrome å’Œ firefox è¡¨ç¤ºåªä¼šå®ç°åŸºäº TLS çš„ HTTP/2ã€‚æ‰€ä»¥è¦éƒ¨ç½² HTTP/2ï¼Œé¦–å…ˆè¦å‡çº§ HTTPSã€‚&lt;/li&gt;
&lt;li&gt;HTTP/2 é€šè¿‡ä»¥ä¸‹ä¸¾æªï¼Œå‡å°‘ç½‘ç»œå»¶è¿Ÿï¼Œæä¾›æµè§ˆå™¨åŠ è½½é€Ÿåº¦ï¼š
&lt;ul&gt;
&lt;li&gt;å¯¹ HTTP å¤´å­—æ®µè¿›è¡Œæ•°æ®å‹ç¼©(å³ HPACK ç®—æ³•)ï¼›&lt;/li&gt;
&lt;li&gt;HTTP/2 æœåŠ¡ç«¯æ¨é€(Server Push)ï¼›&lt;/li&gt;
&lt;li&gt;è¯·æ±‚ç®¡çº¿åŒ–ï¼›&lt;/li&gt;
&lt;li&gt;ä¿®å¤ HTTP/1. 0ç‰ˆæœ¬ä»¥æ¥æœªä¿®å¤çš„é˜Ÿå¤´é˜»å¡é—®é¢˜ï¼›&lt;/li&gt;
&lt;li&gt;å¯¹æ•°æ®ä¼ è¾“é‡‡ç”¨å¤šè·¯å¤ç”¨ï¼Œè®©å¤šä¸ªè¯·æ±‚åˆå¹¶åœ¨åŒä¸€ TCP è¿æ¥å†…ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
      <category term="ç½‘ç»œ" scheme="https://lz5z.com/categories/%E7%BD%91%E7%BB%9C/"/>
    
    
      <category term="HTTP" scheme="https://lz5z.com/tags/HTTP/"/>
    
      <category term="HTTP2" scheme="https://lz5z.com/tags/HTTP2/"/>
    
  </entry>
  
  <entry>
    <title>Web å®‰å…¨å­¦ä¹ </title>
    <link href="https://lz5z.com/Web%E5%AE%89%E5%85%A8%E5%AD%A6%E4%B9%A0/"/>
    <id>https://lz5z.com/Webå®‰å…¨å­¦ä¹ /</id>
    <published>2018-03-01T19:57:53.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<p>å»å¹´ä¸€å®¶ä¸“é—¨åšä¼ä¸šå®‰å…¨çš„å…¬å¸æ¥æˆ‘ä»¬å…¬å¸åšæµ‹è¯•å’ŒåŸ¹è®­ï¼Œç»è¿‡ä»–ä»¬ä¸€å‘¨å¤šçš„æµ‹è¯•ï¼Œæ‰¾åˆ°äº†å…¬å¸å¤šä¸ªé¡¹ç›®ä¸­å­˜åœ¨çš„å¾ˆå¤šé—®é¢˜ï¼ŒæƒŠå¥‡åœ°å‘ç°ï¼Œæˆ‘ä»¬ç»„çš„å‰ç«¯é¡¹ç›®ç«Ÿç„¶æ²¡æœ‰å‘ç°ä¸€ä¸ªæ¼æ´ã€‚è™½ç„¶æ²¡æœ‰æ‰¾åˆ°å¹¶ä¸ä»£è¡¨æ²¡æœ‰ï¼Œä½†æ˜¯ä»ä¸­ä¹Ÿèƒ½çœ‹å‡ºæˆ‘ä»¬ç»„åœ¨è¿™æ–¹é¢è¿˜æ˜¯æœ‰äº›å®åŠ›çš„ã€‚è€Œæˆ‘å¯¹å®‰å…¨æ–¹é¢å¯ä»¥è¯´æ˜¯æ²¡æœ‰å¤šå°‘ç§¯ç´¯ï¼Œæœ€è¿‘æŠ½æ—¶é—´å­¦ä¹ ä¸€ä¸‹ web å®‰å…¨ç›¸å…³çš„çŸ¥è¯†ã€‚</p><h2>XSS</h2><p>XSS(Cross Site Script) è·¨ç«™è„šæœ¬æ”»å‡»ï¼Œæ˜¯æ”»å‡»è€…åˆ©ç”¨ç½‘ç«™æ¼æ´åœ¨ç½‘ç«™ä¸Šæ³¨å…¥æ¶æ„å®¢æˆ·ç«¯ä»£ç ï¼Œä»¥è·å–è®¿é—®æƒé™ï¼Œå†’å……ç”¨æˆ·ï¼Œä¿®æ”¹ HTML å†…å®¹ç­‰ã€‚æ¶æ„å†…å®¹ä¸€èˆ¬åŒ…æ‹¬ JavaScriptï¼Œä¸»è¦æ–¹å¼æ˜¯è·å–ç”¨æˆ·çš„éšç§æ•°æ®ï¼Œä¾‹å¦‚ cookieï¼Œsession ç­‰ã€‚</p><p>XSS æ”»å‡»å¯ä»¥åˆ†ä¸º 3 ç±»ï¼šå­˜å‚¨å‹ã€åå°„å‹ã€åŸºäº DOMã€‚</p><a id="more"></a><h3>å­˜å‚¨å‹ XSS</h3><p>å­˜å‚¨å‹ XSS æ˜¯æŒ‡æ¶æ„è„šæœ¬æ°¸ä¹…å­˜å‚¨åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šï¼Œå½“å®¢æˆ·ç«¯è¯·æ±‚æ•°æ®æ—¶ï¼Œè„šæœ¬ä»æœåŠ¡å™¨ä¸Šä¼ å›å¹¶ä¸”æ‰§è¡Œã€‚å­˜å‚¨å‹ XSS ä¸€èˆ¬å­˜åœ¨äº form è¡¨å•æäº¤ç­‰äº¤äº’åŠŸèƒ½ï¼Œæ¯”å¦‚å‘å¸–ç•™è¨€ï¼Œæäº¤æ–‡æœ¬ä¿¡æ¯ç­‰ã€‚æ”»å‡»è€…å°†å†…å®¹ç»æ­£å¸¸çš„åŠŸèƒ½æäº¤äºæ•°æ®åº“å­˜å‚¨ï¼Œå½“å‰ç«¯é¡µé¢è·å¾—åç«¯ä»æ•°æ®åº“ä¸­è¯»å–çš„æ³¨å…¥ä»£ç æ—¶ï¼Œå°†å…¶æ¸²æŸ“å¹¶ä¸”æ‰§è¡Œã€‚</p><p>å­˜å‚¨å‹ XSS éœ€è¦æ»¡è¶³ä»¥ä¸‹ 3 ä¸ªæ¡ä»¶ï¼š</p><ul><li>è¯·æ±‚æäº¤çš„æ•°æ®åç«¯æ²¡æœ‰è½¬ä¹‰ç›´æ¥å…¥åº“ã€‚</li><li>åç«¯ä»æ•°æ®åº“ä¸­è¯»å–çš„æ•°æ®æ²¡æœ‰è½¬ä¹‰ç›´æ¥è¾“å‡ºç»™å‰ç«¯ã€‚</li><li>å‰ç«¯æ‹¿åˆ°æ•°æ®åæ²¡æœ‰è½¬ä¹‰ç›´æ¥æ¸²æŸ“ DOMã€‚</li></ul><p>å› æ­¤é˜²æ­¢å­˜å‚¨å‹ XSS éœ€è¦å‰ç«¯å’Œåç«¯å…±åŒåŠªåŠ›ã€‚</p><ul><li>åç«¯è·å–å‰ç«¯æ•°æ®åï¼Œå°†æ‰€æœ‰çš„å­—æ®µç»Ÿä¸€è¿›è¡Œè½¬ä¹‰å¤„ç†ã€‚</li><li>åç«¯è¾“å‡ºç»™å‰ç«¯çš„æ•°æ®ç»Ÿä¸€è¿›è¡Œè½¬ä¹‰å¤„ç†ã€‚</li><li>å‰ç«¯æ¸²æŸ“ DOM çš„æ—¶å€™å¯¹åç«¯è¿”å›çš„æ•°æ®è¿›è¡Œè½¬ä¹‰å¤„ç†ã€‚</li></ul><h3>åå°„å‹ XSS</h3><p>æœåŠ¡å™¨æ¥å—å®¢æˆ·ç«¯çš„è¯·æ±‚åŒ…ï¼Œä¸ä¼šå­˜å‚¨è¯·æ±‚åŒ…çš„å†…å®¹ï¼Œåªæ˜¯ç®€å•çš„æŠŠç”¨æˆ·æ•°æ® â€œåå°„â€ ç»™å®¢æˆ·ç«¯é€ æˆåå°„å‹ XSSã€‚å¸¸è§çš„æœ‰ç”¨æˆ·æœç´¢ï¼Œé”™è¯¯ä¿¡æ¯çš„å¤„ç†ï¼Œè¿™ç§æ”»å‡»æ–¹å¼å…·æœ‰ä¸€æ¬¡æ€§ã€‚</p><p>åå°„å‹ XSS æœ‰ä»¥ä¸‹ç‰¹å¾ï¼š</p><ul><li>å³æ—¶æ€§ï¼Œä¸ç»è¿‡æœåŠ¡å™¨å­˜å‚¨ï¼Œç›´æ¥é€šè¿‡ HTTP è¯·æ±‚å®Œæˆæ”»å‡»ï¼Œæ‹¿åˆ°ç”¨æˆ·éšç§æ•°æ®</li><li>æ”»å‡»è€…éœ€è¦è¯±éª—ç”¨æˆ·ç‚¹å‡»</li></ul><p>ä¸‹é¢å†™ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>xss demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> &gt;</span><span class="tag">&lt;<span class="name">button</span>&gt;</span>æœç´¢<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>æœç´¢ç»“æœä¸ºï¼š </span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"result"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">const</span> $ = <span class="built_in">document</span>.querySelector.bind(<span class="built_in">document</span>)</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> input = $(<span class="string">'input'</span>)</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> button = $(<span class="string">'button'</span>)</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> result = $(<span class="string">'#result'</span>)</span></span><br><span class="line"><span class="actionscript">        button.onclick = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span></span><br><span class="line">            result.innerHTML = input.value</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨é¡µé¢ input ä¸­è¾“å…¥ <code>&lt;img src=&quot;&quot; onerror=&quot;alert(document.cookie)&quot;&gt;</code>ï¼Œå¯ä»¥çœ‹åˆ°é¡µé¢å¼¹å‡ºè­¦å‘Šæ¡†ï¼Œå¹¶ä¸”æ˜¾ç¤ºç”¨æˆ· cookieã€‚</p><h3>åŸºäº DOM çš„ XSS</h3><p>åŸºäº DOM çš„ XSS æ˜¯æŒ‡æ¶æ„è„šæœ¬ä¿®æ”¹é¡µé¢ç»“æ„ï¼Œæ¯”å¦‚ä¸€äº›å…è´¹ wifi ç”¨æ¥æ¤å…¥æ‚¬æµ®å¹¿å‘Šã€‚</p><h3>åŸºäºå­—ç¬¦é›†çš„ XSS</h3><p>ç°é˜¶æ®µå¾ˆå¤šå¼€æºçš„åº“éƒ½ä¸“é—¨é’ˆå¯¹ XSS è¿›è¡Œè½¬ä¹‰å¤„ç†ï¼Œé»˜è®¤æŠµå¾¡å¤§å¤šæ•° XSS æ”»å‡»ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰å¾ˆå¤šæ–¹æ³•ç»•è¿‡è½¬ä¹‰è§„åˆ™ã€‚å‡å¦‚é¡µé¢ä¸è®¾ç½®å­—ç¬¦é›†çš„è¯ï¼Œæµè§ˆå™¨æœ‰è‡ªåŠ¨è¯†åˆ«ç¼–ç çš„æœºåˆ¶ï¼Œæ‰€ä»¥é»‘å®¢é€šè¿‡ä½¿ç”¨éå¸¸è§„å­—ç¬¦é›†æ¥è¾¾åˆ° XSS æ³¨å…¥çš„åŠŸèƒ½ã€‚</p><h3>XSS æ”»å‡»æ£€æµ‹æ–¹æ³•</h3><p>å¸¸ç”¨çš„æœ‰ä»¥ä¸‹å‡ ç§ï¼Œä½ ä¹Ÿå¯ä»¥æ ¹æ®é¡µé¢ DOM ç»“æœå¯¹å…¶è¿›è¡Œä¿®æ”¹</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt;<span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">alert(<span class="built_in">document</span>.cookie)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">=<span class="string">'&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;</span></span><br><span class="line"><span class="string">"&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;script&gt;alert(document.cookie)&lt;/script&gt;</span></span><br><span class="line"><span class="string">%3Cscript%3Ealert('</span>XSS<span class="string">')%3C/script%3E</span></span><br><span class="line"><span class="string">&lt;script&gt;alert('</span>XSS<span class="string">')&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;img src="javascript:alert('</span>XSS<span class="string">')"&gt;</span></span><br><span class="line"><span class="string">&lt;img src="http://xxx.com/yyy.png" onerror="alert('</span>XSS<span class="string">')"&gt;</span></span><br><span class="line"><span class="string">&lt;div style="height:expression(alert('</span>XSS<span class="string">'),1)"&gt;&lt;/div&gt;ï¼ˆè¿™ä¸ªä»…é™IEæœ‰æ•ˆï¼‰</span></span><br></pre></td></tr></table></figure><h3>XSS é¢„é˜²</h3><p>XSS ä¹‹æ‰€ä»¥ä¼šå‘ç”Ÿï¼Œæ˜¯å› ä¸ºç”¨æˆ·è¾“å…¥çš„æ•°æ®å˜æˆäº†ä»£ç ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹æ•°æ®è¿›è¡Œ HTML Encode å¤„ç†ï¼Œå°†å…¶ä¸­çš„ç‰¹æ®Šå­—ç¬¦è¿›è¡Œç¼–ç ã€‚</p><table><thead><tr><th style="text-align:center">HTML character</th><th style="text-align:center">HTML Encoded</th></tr></thead><tbody><tr><td style="text-align:center">&lt;</td><td style="text-align:center"><code>&amp;lt;</code></td></tr><tr><td style="text-align:center">&gt;</td><td style="text-align:center"><code>&amp;gt;</code></td></tr><tr><td style="text-align:center">&amp;</td><td style="text-align:center"><code>&amp;amp;</code></td></tr><tr><td style="text-align:center">â€™</td><td style="text-align:center"><code>&amp;#039;</code></td></tr><tr><td style="text-align:center">&quot;</td><td style="text-align:center"><code>&amp;quot;</code></td></tr><tr><td style="text-align:center">ç©ºæ ¼</td><td style="text-align:center"><code>&amp;nbsp;</code></td></tr></tbody></table><ol><li>å°†é‡è¦çš„ cookie æ ‡è®°ä¸º HTTP Onlyã€‚</li><li>åªå…è®¸ç”¨æˆ·è¾“å…¥æœŸæœ›çš„æ•°æ®ã€‚</li><li>å¯¹æ•°æ®è¿›è¡Œ HTML Encode å¤„ç†ã€‚</li><li>è¿‡æ»¤æˆ–è€…ç§»é™¤ç‰¹æ®Šçš„ HTML æ ‡ç­¾ï¼Œå¦‚æœ <code>&lt;script&gt;</code>ï¼Œ<code>&lt;iframe&gt;</code>ï¼Œ<code>&lt;img&gt;</code> ç­‰ã€‚</li><li>è¿‡æ»¤ç‰¹æ®Šçš„ JavaScript äº‹ä»¶ï¼Œæ¯”å¦‚ <code>onclick</code>ï¼Œ<code>onerror</code>ï¼Œ<code>onfocus</code> ç­‰ã€‚</li></ol><h2>CSRF</h2><p>CSRF(Cross-Site Request Forgery) è·¨ç«™è¯·æ±‚ä¼ªé€ æ”»å‡»ï¼Œæ˜¯æŒ‡æ”»å‡»è€…é€šè¿‡ç›—ç”¨ç”¨æˆ·ç™»å½•ä¿¡æ¯ï¼Œæ¨¡æ‹Ÿå‘é€å„ç§è¯·æ±‚ã€‚æ”»å‡»è€…å€ŸåŠ©èŠå¤©è½¯ä»¶ã€è®ºå›ã€å¾®åšç­‰å‘é€é“¾æ¥ï¼ˆæœ‰äº›ä¼ªè£…æˆçŸ­åŸŸåï¼‰ï¼Œè¿«ä½¿ç”¨æˆ·å»æ‰§è¡Œæ”»å‡»è€…é¢„è®¾çš„æ“ä½œã€‚å¦‚æœå½“å‰ç”¨æˆ·å…·æœ‰ç®¡ç†å‘˜æƒé™çš„è¯ï¼ŒCSRF æ”»å‡»å°†å±åŠåˆ°æ•´ä¸ª Web åº”ç”¨ç¨‹åºã€‚ä¸ XSS ç›¸æ¯”ï¼ŒXSS æ˜¯åˆ©ç”¨ç”¨æˆ·å¯¹æŒ‡å®šç½‘ç«™çš„ä¿¡ä»»ï¼ŒCSRF æ˜¯åˆ©ç”¨ç½‘ç«™å¯¹ç”¨æˆ·æµè§ˆå™¨çš„ä¿¡ä»»ã€‚</p><h3>CSRF åŸç†</h3><ol><li>ç”¨æˆ·ç™»å½•ä¿¡ä»»ç½‘ç«™ Aï¼Œé€šè¿‡éªŒè¯åï¼Œåœ¨æµè§ˆå™¨ä¸­äº§ç”Ÿ cookieï¼Œè®°å½•ç™»å½•çŠ¶æ€ã€‚</li><li>ç”¨æˆ·åœ¨æ²¡æœ‰ç™»å‡ºçš„æƒ…å†µä¸‹ç™»å½•å±é™©çš„ç½‘ç«™ Bã€‚</li><li>ç½‘ç«™ B è¦æ±‚è®¿é—®ç½‘ç«™ Aï¼Œå‘å‡ºä¸€ä¸ªè¯·æ±‚ã€‚</li><li>æµè§ˆå™¨å¸¦ç€ A äº§ç”Ÿçš„ Cookie è®¿é—®ç½‘ç«™ Aï¼Œæ­¤æ—¶ A ä¸çŸ¥é“ä¸­è¯·æ±‚æ˜¯ç”¨æˆ·å‘å‡ºçš„è¿˜æ˜¯ B å‘å‡ºçš„ï¼ŒA æ ¹æ® Cookie ä¸­çš„ä¿¡æ¯å¤„ç†è¯¥è¯·æ±‚ï¼Œç½‘ç«™ B è¾¾åˆ°äº†æ¨¡æ‹Ÿç”¨æˆ·è¯·æ±‚çš„ç›®çš„ã€‚</li></ol><p>è¦å®Œæˆä¸€æ¬¡ CSRF æ”»å‡»ï¼Œç”¨æˆ·å¿…é¡»ä¾æ¬¡å®Œæˆä¸¤ä¸ªæ­¥éª¤ï¼š</p><ol><li>ç™»å½•å—ä¿¡ä»»ç½‘ç«™ Aï¼Œå¹¶åœ¨æœ¬åœ°ç”Ÿæˆ Cookieã€‚</li><li>åœ¨ä¸ç™»å‡º A çš„æƒ…å†µä¸‹ï¼Œè®¿é—®å±é™©ç½‘ç«™ Bã€‚</li></ol><h3>CRSF ä¾‹å­</h3><p>å‡å¦‚ä¸€å®¶é“¶è¡Œçš„è½¬è´¦æ“ä½œçš„ URL åœ°å€æ˜¯ï¼š<code>http://lz5z.com/withdraw?account=AccountName&amp;amount=1000&amp;for=PayeeName</code>ï¼Œæ¶æ„ç½‘ç«™ B ä¸­æ”¾ç½®ä¸€æ®µä»£ç ï¼š<code>&lt;img src=http://lz5z.com/withdraw?account=lizhen&amp;amount=1000&amp;for=BadGuy&gt;</code>ã€‚ç”±äº imgã€scriptã€iframe æ ‡ç­¾ä¸å—åŒæºç­–ç•¥ç°åœ¨ï¼Œå‡å¦‚ç”¨æˆ·åœ¨æœªç™»å‡º A çš„æƒ…å†µä¸‹æ‰“å¼€äº† B ç½‘ç«™ï¼Œåœ¨ Cookie æœªè¿‡æœŸçš„æƒ…å†µä¸‹ï¼Œç”¨æˆ·å°±ä¼šæŸå¤± 1000 å—ã€‚</p><h3>CSRF é˜²å¾¡</h3><ol><li>æ­£ç¡®ä½¿ç”¨ GETã€POST è¯·æ±‚å’Œ cookieã€‚</li><li>æ£€æŸ¥è¯·æ±‚æŠ¥å¤´ä¸­çš„ Referer å‚æ•°ã€‚Referer ç”¨æ¥æ ‡æ˜è¯·æ±‚æ¥æºäºå“ªä¸ªåœ°å€ã€‚æ£€æŸ¥ Referer å­—æ®µå­˜åœ¨å±€é™æ€§ï¼Œå› å…¶å®Œå…¨ä¾èµ–æµè§ˆå™¨å‘é€æ­£ç¡®çš„ Referer å­—æ®µï¼Œè™½ç„¶ HTTP åè®®å¯¹æ­¤å­—æ®µçš„å†…å®¹æœ‰æ˜ç¡®çš„è§„å®šï¼Œä½†æµè§ˆå™¨å…·ä½“å®ç°çš„æ—¶å€™å¯èƒ½å­˜åœ¨é—®é¢˜ï¼Œæ¯”å¦‚æ—©æœŸ IE ä¸­å°±å­˜åœ¨ Referer å¯ä»¥è¢«ä¿®æ”¹çš„ bugã€‚</li><li>åœ¨é GET è¯·æ±‚ä¸­æ·»åŠ æ ¡éªŒ tokenã€‚</li><li>å…³é”®è¯·æ±‚å¢åŠ éªŒè¯ç ã€‚ç¼ºç‚¹æ˜¯ç”¨æˆ·å¤šæ¬¡è¾“å…¥éªŒè¯ç ï¼Œç”¨æˆ·ä½“éªŒè¾ƒå·®ã€‚</li><li>æ¸²æŸ“è¡¨å•çš„æ—¶å€™ï¼Œä¸ºæ¯ä¸€ä¸ªè¡¨å•ç”Ÿæˆä¸€ä¸ª csrfTokenï¼Œæäº¤è¡¨å•çš„æ—¶å€™ï¼Œåç«¯åš csrf éªŒè¯ã€‚</li><li>å¯¹æ¯ä¸ªç”¨æˆ·åˆ›å»º tokenï¼Œå°†å…¶å­˜æ”¾äºæœåŠ¡ç«¯çš„ session å’Œå®¢æˆ·ç«¯çš„ cookie ä¸­ï¼Œå¯¹æ¯æ¬¡è¯·æ±‚ï¼Œéƒ½æ£€æŸ¥äºŒè€…æ˜¯å¦ä¸€è‡´ã€‚ç¼ºç‚¹æ˜¯å¦‚æœç”¨æˆ·è¢« xss æ”»ç ´ï¼Œé»‘å®¢å¯èƒ½åŒæ—¶è·å–ç”¨æˆ·çš„ cookieã€‚</li></ol><h2>DDoS æ”»å‡»</h2><p>DDos(Distributed Denial of Service) åˆ†å¸ƒå¼æ‹’ç»æœåŠ¡ã€‚åŸç†æ˜¯åˆ©ç”¨å¤§é‡çš„è¯·æ±‚é€ æˆèµ„æºè¿‡è½½ï¼Œå¯¼è‡´æœåŠ¡ä¸å¯ç”¨ã€‚DDoS æ”»å‡»ä»å±‚æ¬¡ä¸Šå¯ä»¥åˆ†ä¸ºç½‘ç»œå±‚æ”»å‡»å’Œåº”ç”¨å±‚æ”»å‡»ã€‚</p><h3>ç½‘ç»œå±‚ DDoS</h3><p>ç½‘ç»œå±‚ DDoS æ”»å‡»åŒ…æ‹¬ SYN Floodã€ACK Floodã€UDP Floodã€ICMP Flood ç­‰ã€‚</p><ol><li>SYN Flood æ”»å‡»ï¼šä¸»è¦åˆ©ç”¨ TCP ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹ä¸­å­˜åœ¨çš„é—®é¢˜ï¼ŒTCP ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹æ˜¯è¦å»ºç«‹è¿æ¥çš„åŒæ–¹å‘é€ SYNï¼ŒSYN + ACKï¼ŒACK æ•°æ®åŒ…ï¼Œæ”»å‡»è€…æ„é€  IP å»å‘é€ SYN åŒ…æ—¶ï¼ŒæœåŠ¡å™¨è¿”å›çš„ SYN + ACK å°±å¾—ä¸åˆ°åº”ç­”ï¼Œæ­¤æ—¶æœåŠ¡å™¨ä¼šå°è¯•é‡æ–°å‘é€ï¼Œå¹¶ä¸”è‡³å°‘æœ‰ 30s çš„ç­‰å¾…æ—¶é—´ï¼Œå¯¼è‡´èµ„æºå’ŒæœåŠ¡ä¸å¯ç”¨ã€‚</li><li>ACK Flood æ”»å‡»ï¼šTCP è¿æ¥å»ºç«‹åï¼Œæ‰€æœ‰çš„æ•°æ®ä¼ è¾“ TCP éƒ½æ˜¯å¸¦æœ‰ ACK æ ‡å¿—çš„ï¼Œä¸»æœºæ”¶åˆ° ACK æ ‡å¿—çš„æ•°æ®åŒ…åï¼Œéœ€è¦æ£€æŸ¥æ•°æ®åŒ…çŠ¶æ€åˆæ³•æ€§ã€‚å½“æ”»å‡»ç¨‹åºæ¯ç§’å‘é€ ACK çš„é€Ÿç‡è¾¾åˆ°ä¸€å®šç¨‹åº¦æ—¶ï¼Œä½¿ä¸»æœºå’Œé˜²ç«å¢™è´Ÿè½½å˜å¤§ã€‚</li><li>UDP Flood æ”»å‡»ï¼šå½“å¤§é‡ UDP æ•°æ®åŒ…å‘é€ç»™å—å®³ç³»ç»Ÿæ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´å¸¦å®½é¥±å’Œä»è€Œä½¿å¾—åˆæ³•æœåŠ¡æ— æ³•è¯·æ±‚è®¿é—®å—å®³ç³»ç»Ÿã€‚</li><li>ICMP Flood æ”»å‡»ï¼šICMPï¼ˆäº’è”ç½‘æ§åˆ¶æ¶ˆæ¯åè®®ï¼‰æ´ªæ°´æ”»å‡»æ˜¯é€šè¿‡å‘æœªè‰¯å¥½è®¾ç½®çš„è·¯ç”±å™¨å‘é€å¹¿æ’­ä¿¡æ¯å ç”¨ç³»ç»Ÿèµ„æºçš„åšæ³•ã€‚</li></ol><h3>åº”ç”¨å±‚ DDoS</h3><p>åº”ç”¨å±‚ DDoS æ”»å‡»ä¸æ˜¯å‘ç”Ÿåœ¨ç½‘ç»œå±‚ï¼Œæ˜¯å‘ç”Ÿåœ¨ TCP å»ºç«‹æ¡æ‰‹æˆåŠŸä¹‹åï¼Œåº”ç”¨ç¨‹åºå¤„ç†è¯·æ±‚çš„æ—¶å€™ï¼Œç°åœ¨å¾ˆå¤šå¸¸è§çš„ DDoS æ”»å‡»éƒ½æ˜¯åº”ç”¨å±‚æ”»å‡»ã€‚</p><ol><li>CC æ”»å‡»ï¼šChallenge Collapasarï¼Œå°±æ˜¯é’ˆå¯¹æ¶ˆè€—èµ„æºæ¯”è¾ƒå¤§çš„é¡µé¢ä¸æ–­å‘èµ·ä¸æ­£å¸¸çš„è¯·æ±‚ï¼Œå¯¼è‡´èµ„æºè€—å°½ã€‚</li><li>DNS Floodï¼šæ”»å‡»è€…å‘æœåŠ¡å™¨å‘é€å¤§é‡çš„åŸŸåè§£æè¯·æ±‚ï¼Œé€šå¸¸è¯·æ±‚è§£æçš„åŸŸåæ˜¯éšæœºç”Ÿæˆæˆ–è€…æ˜¯ç½‘ç»œä¸–ç•Œä¸Šæ ¹æœ¬ä¸å­˜åœ¨çš„åŸŸåï¼ŒåŸŸåè§£æçš„è¿‡ç¨‹ç»™æœåŠ¡å™¨å¸¦æ¥äº†å¾ˆå¤§çš„è´Ÿè½½ã€‚</li><li>HTTP æ…¢è¿æ¥æ”»å‡»ï¼šé’ˆå¯¹ HTTP åè®®ï¼Œå…ˆå»ºç«‹èµ· HTTP è¿æ¥ï¼Œè®¾ç½®ä¸€ä¸ªè¾ƒå¤§çš„ Conetnt-Lengthï¼Œæ¯æ¬¡åªå‘é€å¾ˆå°‘çš„å­—èŠ‚ï¼Œè®©æœåŠ¡å™¨ä¸€ç›´ä»¥ä¸º HTTP å¤´éƒ¨æ²¡æœ‰ä¼ è¾“å®Œæˆï¼Œè¿™æ ·è¿æ¥ä¸€å¤šå°±å¾ˆå¿«ä¼šå‡ºç°è¿æ¥è€—å°½ã€‚</li></ol><h3>é˜²å¾¡æ–¹å¼</h3><ol><li>é˜²ç«å¢™ï¼šé€šè¿‡è®¾ç½®é˜²ç«å¢™è§„åˆ™ï¼Œæ¯”å¦‚å…è®¸æˆ–è€…æ‹’ç»ç‰¹ç‚¹é€šè®¯åè®®ã€ç«¯å£æˆ–è€… IP åœ°å€ã€‚</li><li>äº¤æ¢æœºï¼šé€šè¿‡ä½¿ç”¨äº¤æ¢æœºçš„è®¿é—®æ§åˆ¶ï¼Œæ¯”å¦‚é™é€Ÿã€å‡ IP è¿‡æ»¤ã€æµé‡æ•´å½¢ï¼Œæ·±åº¦åŒ…æ£€æµ‹ç­‰åŠŸèƒ½ï¼Œå¯ä»¥æ£€æµ‹å¹¶è¿‡æ»¤æ‹’ç»æœåŠ¡æ”»å‡»ã€‚</li><li>è·¯ç”±å™¨ï¼šä¸äº¤æ¢æœºç±»ä¼¼ã€‚</li><li>æµé‡æ¸…æ´—ï¼šå½“æµé‡è¢«é€åˆ° DDoS é˜²æŠ¤æ¸…æ´—ä¸­å¿ƒæ—¶ï¼Œé€šè¿‡é‡‡ç”¨æŠ— DDoS è½¯ä»¶å¤„ç†ï¼Œå°†æ­£å¸¸æµé‡ä¸æ¶æ„æµé‡åŒºåˆ†ã€‚</li></ol><h2>å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://zh.wikipedia.org/zh-cn/%E8%B7%A8%E7%B6%B2%E7%AB%99%E6%8C%87%E4%BB%A4%E7%A2%BC" target="_blank" rel="noopener">è·¨ç«™è„šæœ¬</a></li><li><a href="https://zoumiaojiang.com/article/common-web-security/" target="_blank" rel="noopener">å¸¸è§ Web å®‰å…¨æ”»é˜²æ€»ç»“</a></li><li><a href="https://zh.wikipedia.org/wiki/%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0" target="_blank" rel="noopener">è·¨ç«™è¯·æ±‚ä¼ªé€ </a></li><li><a href="https://zh.wikipedia.org/wiki/%E9%98%BB%E6%96%B7%E6%9C%8D%E5%8B%99%E6%94%BB%E6%93%8A" target="_blank" rel="noopener">æ‹’ç»æœåŠ¡æ”»å‡»</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å»å¹´ä¸€å®¶ä¸“é—¨åšä¼ä¸šå®‰å…¨çš„å…¬å¸æ¥æˆ‘ä»¬å…¬å¸åšæµ‹è¯•å’ŒåŸ¹è®­ï¼Œç»è¿‡ä»–ä»¬ä¸€å‘¨å¤šçš„æµ‹è¯•ï¼Œæ‰¾åˆ°äº†å…¬å¸å¤šä¸ªé¡¹ç›®ä¸­å­˜åœ¨çš„å¾ˆå¤šé—®é¢˜ï¼ŒæƒŠå¥‡åœ°å‘ç°ï¼Œæˆ‘ä»¬ç»„çš„å‰ç«¯é¡¹ç›®ç«Ÿç„¶æ²¡æœ‰å‘ç°ä¸€ä¸ªæ¼æ´ã€‚è™½ç„¶æ²¡æœ‰æ‰¾åˆ°å¹¶ä¸ä»£è¡¨æ²¡æœ‰ï¼Œä½†æ˜¯ä»ä¸­ä¹Ÿèƒ½çœ‹å‡ºæˆ‘ä»¬ç»„åœ¨è¿™æ–¹é¢è¿˜æ˜¯æœ‰äº›å®åŠ›çš„ã€‚è€Œæˆ‘å¯¹å®‰å…¨æ–¹é¢å¯ä»¥è¯´æ˜¯æ²¡æœ‰å¤šå°‘ç§¯ç´¯ï¼Œæœ€è¿‘æŠ½æ—¶é—´å­¦ä¹ ä¸€ä¸‹ web å®‰å…¨ç›¸å…³çš„çŸ¥è¯†ã€‚&lt;/p&gt;
&lt;h2&gt;XSS&lt;/h2&gt;
&lt;p&gt;XSS(Cross Site Script) è·¨ç«™è„šæœ¬æ”»å‡»ï¼Œæ˜¯æ”»å‡»è€…åˆ©ç”¨ç½‘ç«™æ¼æ´åœ¨ç½‘ç«™ä¸Šæ³¨å…¥æ¶æ„å®¢æˆ·ç«¯ä»£ç ï¼Œä»¥è·å–è®¿é—®æƒé™ï¼Œå†’å……ç”¨æˆ·ï¼Œä¿®æ”¹ HTML å†…å®¹ç­‰ã€‚æ¶æ„å†…å®¹ä¸€èˆ¬åŒ…æ‹¬ JavaScriptï¼Œä¸»è¦æ–¹å¼æ˜¯è·å–ç”¨æˆ·çš„éšç§æ•°æ®ï¼Œä¾‹å¦‚ cookieï¼Œsession ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;XSS æ”»å‡»å¯ä»¥åˆ†ä¸º 3 ç±»ï¼šå­˜å‚¨å‹ã€åå°„å‹ã€åŸºäº DOMã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="å®‰å…¨" scheme="https://lz5z.com/categories/%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="xss" scheme="https://lz5z.com/tags/xss/"/>
    
      <category term="csrf" scheme="https://lz5z.com/tags/csrf/"/>
    
  </entry>
  
  <entry>
    <title>å†è§2017ï¼Œä½ å¥½2018</title>
    <link href="https://lz5z.com/GoodBye2017-Hello2018/"/>
    <id>https://lz5z.com/GoodBye2017-Hello2018/</id>
    <published>2018-02-11T20:11:42.000Z</published>
    <updated>2020-04-21T10:23:54.823Z</updated>
    
    <content type="html"><![CDATA[<h2>2017</h2><p>å¥½ä¹…æ²¡æœ‰æ›´æ–°åšå®¢äº†ã€‚</p><p>2017å¹´è¿‡å¾—çœŸå¿«ï¼Œè½¬çœ¼å·²ç»å¿«è§¦ä¸åˆ°2017çš„å°¾å·´äº†ï¼Œå¦‚æœç®—å†œå†å¹´çš„è¯ï¼Œç•™ç»™å®ƒçš„æ—¶é—´ä¹Ÿå·²ç»ä¸å¤šäº†ã€‚</p><p>2017å¹´å¯¹äºæˆ‘æ¥è¯´å‘ç”Ÿçš„æœ€é‡è¦çš„äº‹æƒ…å°±æ˜¯è·³æ§½äº†ï¼Œä» OOCL ç¦»èŒï¼Œåˆ°å…¥èŒ WPS æ­£å¥½ä¸€å¹´äº†ã€‚è¿™ä¸€å¹´å¯ä»¥è¯´æ˜¯æˆ‘èŒä¸šå‘å±•æœ€ä¸ºé‡è¦çš„ä¸€å¹´ï¼Œä»¥ååº”è¯¥éƒ½ä¼šåœ¨è¿™ä¸ªæ–¹å‘å‰è¡Œäº†ã€‚è¿™ä¸€å¹´å·®ä¸å¤šæ˜¯æˆ‘ä»é—¨å¤–æ±‰é€æ­¥å…¥é—¨çš„è¿‡ç¨‹ï¼Œè™½ç„¶ä¹‹å‰ä¹Ÿæœ‰ä¸€ä¸¤å¹´çš„å·¥ä½œç»éªŒï¼Œä½†å¤§å¤šæ—¶å€™æ˜¯æ‰“é…±æ²¹ï¼Œåœ¨ä¸€ä¸ªå¤§çš„é¡¹ç›®ä¸­ç¼ç¼è¡¥è¡¥ã€‚è€Œç»è¿‡ WPS ä¸€å¹´çš„è®­ç»ƒï¼Œå¦‚ä»Šæˆ‘å¯ä»¥å†™ä¸€äº›å°çš„é¡¹ç›®ï¼Œä¹Ÿå®Œå…¨çœ‹æ‡‚äº†éƒ¨é—¨çš„å¤§é¡¹ç›®çš„æ•´ä¸ªæ¶æ„ã€‚</p><p>ç¬¬äºŒä»¶äº‹å°±æ˜¯ä»Šå¹´å…«æœˆä»½ä¹°äº†äººç”Ÿç¬¬ä¸€è¾†å°è½¦è½¦-æ—¥äº§éªè¾¾ã€‚è¿™è¾†å°è½¦è½¦å¦‚ä»Šå·²ç»æ˜¯æˆ‘ä»¬å®¶ä¸­ç¬¬ä¸‰é‡è¦çš„æˆå‘˜äº†ï¼Œç»™ç”Ÿæ´»æå‡äº†æå¤§çš„å¹¸ç¦æ„Ÿã€‚å°¤å…¶æ˜¯æ¬å®¶çš„æ—¶å€™ï¼Œèº«å¿ƒä¿±ç–²ï¼Œä½†æ˜¯å½“è¿›å…¥å°è½¦çš„ä¸€ç¬é—´ï¼ŒçŸ¥é“è‡ªå·±æ— è®ºå¦‚ä½•æœ‰è½è„šçš„åœ°æ–¹ï¼Œå°±è§‰å¾—å¾ˆå®‰å¿ƒã€‚</p><a id="more"></a><p>ç¬¬ä¸‰ä»¶äº‹å°±æ˜¯å…¬å¸æ¬å®¶ï¼Œä¸‹é¢æ˜¯æˆ‘ç¦»å¼€æ—§é‡‘å±±æ—¶å€™æ‹çš„ç…§ç‰‡ã€‚</p><p>æ—§é‡‘å±±å¤§æ¥¼ï¼š</p><img src="/assets/img/æ—§é‡‘å±±å¤§æ¥¼.jpg" alt="æ—§é‡‘å±±" width="60%"><p>è¿™æ˜¯æ—§é‡‘å±±çš„å·¥ä½ï¼Œå‘†äº†å·®ä¸å¤š10ä¸ªæœˆï¼š</p><img src="/assets/img/æ—§é‡‘å±±å·¥ä½.jpg" alt="æ—§é‡‘å±±å·¥ä½" width="60%"><p>ä¸‹é¢æ˜¯åˆšæ¬åˆ°æ–°åŠå…¬å®¤çš„ç…§ç‰‡ï¼Œä¸€å° PCï¼Œä¸€å° mac miniï¼Œä¸¤å°ç”µè„‘éƒ½å¾ˆå¡ã€‚</p><img src="/assets/img/æ–°å·¥ä½.jpg" alt="æ–°å·¥ä½" width="60%"><p>åé¢è‡ªå·±ä¹°äº† 2k 32 å¯¸çš„æ˜¾ç¤ºå™¨ï¼Œå…¬å¸åˆç»™å‡çº§äº†æœ€æ–°çš„ PC - DELL çš„é«˜é… 7050 + ä¸‰æ˜Ÿ SSDï¼Œç°åœ¨ä¸å†æŠ±æ€¨ç”µè„‘å¡äº†ã€‚æ–°å‡çº§è®¾å¤‡åç»™è‡ªå·±åŠ äº†å¥½å¤šå¤©çš„ç­ï¼Œç”¨æµç•…èˆ’æœçš„è®¾å¤‡æ•²ä»£ç è®©äººæ¬²ç½¢ä¸èƒ½å•Šã€‚ï¼ˆè€æ¿å¬åˆ°åè¯·ç»™æˆ‘åŠ è–ªï¼‰</p><img src="/assets/img/æ–°å·¥ä½2.jpg" alt="æ–°å·¥ä½2" width="60%"><p>è¿˜æœ‰ä¸€ä»¶äº‹å°±æ˜¯éƒ¨é—¨ç»™äº†ä¼˜ç§€å‘˜å·¥å¥–ï¼Œè™½ç„¶æ²¡æœ‰å®è´¨æ€§çš„å¥–åŠ±ï¼Œä½†æ˜¯å¯ä»¥çœ‹åˆ° leader äºˆä»¥çš„å™¨é‡ï¼Œæ‰€ä»¥è¿˜æ˜¯å¾ˆå¼€å¿ƒçš„ã€‚å¹´ç»ˆè€ƒè¯„æ—¶ï¼Œå‰ç«¯è´Ÿè´£äººä¹Ÿç»™äº†å¾ˆä¸é”™çš„è¯„ä»·ï¼Œè¯´ä»¥åä¼šè®©æˆ‘è´Ÿè´£æ›´å¤šçš„ä¸œè¥¿ï¼Œå¤šç»™æˆ‘æˆé•¿çš„æœºä¼šã€‚</p><h2>2018</h2><p>2018å¹´åˆé•¿äº†ä¸€å²äº†ï¼Œæœ€é‡è¦çš„å½“ç„¶æ˜¯ç»“å©šçš„äº‹æƒ…æä¸Šäº†æ—¥ç¨‹ï¼Œä»¥å‰åˆ«äººé—®æ€ä¹ˆè¿˜ä¸ç»“å©šçš„æ—¶å€™ï¼Œæ€»æ˜¯ç­”ï¼Œäººå®¶è¿˜å°å‘¢ã€‚ä½†æ˜¯è¿™å‡ å¹´è¶Šå‘è§‰å¾—è‡ªå·±å…¶å®å·²æ˜¯ä¸€ä¸ªæ²¹è…»çš„ä¸­å¹´äººäº†ï¼Œä¸Šå­¦æ—¶æœ¬æ¥å°±æ¯”å‘¨å›´çš„äººå¤§ï¼Œä¸€ç›´è¢«ç§°ä¸º â€œæŒ¯å“¥â€ï¼Œå·¥ä½œä»¥åå‘ç°åŒç­‰å¹´çºªçš„äººå·²ç»å·¥ä½œä¸‰å››å¹´äº†ï¼Œè¶Šå‘ç„¦æ€¥ï¼Œè§‰å¾—è‡ªå·±ä¸€äº‹æ— æˆï¼Œé©¬é½¿å¾’å¢ã€‚å¤§å­¦æ¯•ä¸šçš„æ—¶å€™é€‰æ‹©å·¥ä½œè€Œæ²¡æœ‰åƒåˆ«çš„åŒå­¦é‚£æ ·è¯»ç ”ä¹Ÿæ˜¯åŒæ ·çš„åŸå› ã€‚è€Œæ˜å¹´çš„ç»“å©šç®—æ˜¯ç»™è‡ªå·±å’Œå®¶äººä¸€ä¸ªäº¤ä»£ï¼Œå®Œæˆäº†äººç”Ÿçš„ä¸€ä»¶å¤§äº‹ã€‚</p><p>2018å¹´å½“ç„¶æ˜¯å¸Œæœ›è‡ªå·±æŠ€æœ¯è¶Šæ¥å¥½ï¼Œèƒ½æ‰¿æ‹…è¶Šæ¥è¶Šå¤šçš„è´£ä»»ã€‚å½“ç„¶æœ€é‡è¦çš„æ˜¯ï¼Œè¦èµšæ›´å¤šçš„é’±ï¼Œå®¶äººéƒ½å¥åº·å¿«ä¹ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;2017&lt;/h2&gt;
&lt;p&gt;å¥½ä¹…æ²¡æœ‰æ›´æ–°åšå®¢äº†ã€‚&lt;/p&gt;
&lt;p&gt;2017å¹´è¿‡å¾—çœŸå¿«ï¼Œè½¬çœ¼å·²ç»å¿«è§¦ä¸åˆ°2017çš„å°¾å·´äº†ï¼Œå¦‚æœç®—å†œå†å¹´çš„è¯ï¼Œç•™ç»™å®ƒçš„æ—¶é—´ä¹Ÿå·²ç»ä¸å¤šäº†ã€‚&lt;/p&gt;
&lt;p&gt;2017å¹´å¯¹äºæˆ‘æ¥è¯´å‘ç”Ÿçš„æœ€é‡è¦çš„äº‹æƒ…å°±æ˜¯è·³æ§½äº†ï¼Œä» OOCL ç¦»èŒï¼Œåˆ°å…¥èŒ WPS æ­£å¥½ä¸€å¹´äº†ã€‚è¿™ä¸€å¹´å¯ä»¥è¯´æ˜¯æˆ‘èŒä¸šå‘å±•æœ€ä¸ºé‡è¦çš„ä¸€å¹´ï¼Œä»¥ååº”è¯¥éƒ½ä¼šåœ¨è¿™ä¸ªæ–¹å‘å‰è¡Œäº†ã€‚è¿™ä¸€å¹´å·®ä¸å¤šæ˜¯æˆ‘ä»é—¨å¤–æ±‰é€æ­¥å…¥é—¨çš„è¿‡ç¨‹ï¼Œè™½ç„¶ä¹‹å‰ä¹Ÿæœ‰ä¸€ä¸¤å¹´çš„å·¥ä½œç»éªŒï¼Œä½†å¤§å¤šæ—¶å€™æ˜¯æ‰“é…±æ²¹ï¼Œåœ¨ä¸€ä¸ªå¤§çš„é¡¹ç›®ä¸­ç¼ç¼è¡¥è¡¥ã€‚è€Œç»è¿‡ WPS ä¸€å¹´çš„è®­ç»ƒï¼Œå¦‚ä»Šæˆ‘å¯ä»¥å†™ä¸€äº›å°çš„é¡¹ç›®ï¼Œä¹Ÿå®Œå…¨çœ‹æ‡‚äº†éƒ¨é—¨çš„å¤§é¡¹ç›®çš„æ•´ä¸ªæ¶æ„ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬äºŒä»¶äº‹å°±æ˜¯ä»Šå¹´å…«æœˆä»½ä¹°äº†äººç”Ÿç¬¬ä¸€è¾†å°è½¦è½¦-æ—¥äº§éªè¾¾ã€‚è¿™è¾†å°è½¦è½¦å¦‚ä»Šå·²ç»æ˜¯æˆ‘ä»¬å®¶ä¸­ç¬¬ä¸‰é‡è¦çš„æˆå‘˜äº†ï¼Œç»™ç”Ÿæ´»æå‡äº†æå¤§çš„å¹¸ç¦æ„Ÿã€‚å°¤å…¶æ˜¯æ¬å®¶çš„æ—¶å€™ï¼Œèº«å¿ƒä¿±ç–²ï¼Œä½†æ˜¯å½“è¿›å…¥å°è½¦çš„ä¸€ç¬é—´ï¼ŒçŸ¥é“è‡ªå·±æ— è®ºå¦‚ä½•æœ‰è½è„šçš„åœ°æ–¹ï¼Œå°±è§‰å¾—å¾ˆå®‰å¿ƒã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Others" scheme="https://lz5z.com/categories/Others/"/>
    
    
      <category term="æ€»ç»“" scheme="https://lz5z.com/tags/%E6%80%BB%E7%BB%93/"/>
    
  </entry>
  
  <entry>
    <title>webpack æ‰“åŒ…åŠ é€Ÿå®æˆ˜</title>
    <link href="https://lz5z.com/webpack%E6%89%93%E5%8C%85%E5%8A%A0%E9%80%9F%E5%AE%9E%E6%88%98/"/>
    <id>https://lz5z.com/webpackæ‰“åŒ…åŠ é€Ÿå®æˆ˜/</id>
    <published>2018-01-13T09:05:31.000Z</published>
    <updated>2020-04-21T10:23:54.831Z</updated>
    
    <content type="html"><![CDATA[<h2>webpack æ‰“åŒ…ä¼˜åŒ–</h2><p>æœ€è¿‘é¡¹ç›®ä¸ç®—å¿™ï¼ŒæŠ½æ—¶é—´é‡æ„äº†ä¸€ä¸‹é¡¹ç›®çš„æ‰“åŒ…ï¼Œå…ˆè¯´ä¸€ä¸‹æˆå°±ã€‚</p><p>åœ¨æˆ‘çš„å¼€å‘ç”µè„‘ä¸Šï¼š</p><p>OS: macOS High Sierra<br>CPU: 2.6 GHz Intel Core i5<br>å†…å­˜: 8G 1600 DDR3<br>ç¡¬ç›˜: 1 TB SATAç£ç›˜</p><p>ä»£ç å…¨é‡ç¼–è¯‘æ—¶é—´ä» 4 åˆ† 51 ç§’ä¼˜åŒ–åˆ° 2 åˆ† 08 - 20 ç§’å·¦å³ã€‚</p><p>åœ¨é¡¹ç›®ç¼–è¯‘ç”µè„‘ä¸Šï¼š</p><p>OS: Ubuntu 16.04.3 LTS<br>CPU: IntelÂ® Coreâ„¢ i5-7500 CPU @ 3.40GHz<br>å†…å­˜: 64G 2133 DDR4<br>ç¡¬ç›˜: 1 TB SSD</p><p>ä»£ç å…¨é‡ç¼–è¯‘æ—¶é—´ä» 4 åˆ† 08 ç§’ä¼˜åŒ–åˆ° 1 åˆ† 10 - 20 ç§’å·¦å³ã€‚</p><a id="more"></a><h2>ç”¨äº†å“ªäº›æ‰‹æ®µ</h2><h3>å‡çº§ç”µè„‘</h3><p>å‡çº§ SSD å¯èƒ½æ˜¯æå‡æ•ˆæœæœ€æ˜æ˜¾çš„å§ï¼Œä»ä¸Šé¢ä¸¤ç»„æ•°æ®ä¸­å°±å¯ä»¥çœ‹å‡ºã€‚ç›¸åŒçš„ä¼˜åŒ–åœ¨ SSD ä¸­è¡¨ç°è¦æ˜æ˜¾å¾ˆå¤šã€‚</p><h3>å‡çº§ webpack3</h3><p><a href="https://medium.com/webpack/webpack-3-official-release-15fd2dd8f07b" target="_blank" rel="noopener">webpack 3: Official Release!!</a></p><p>å¦‚æœä½ çš„é¡¹ç›®è¿˜åœ¨ç”¨ webpack2 çš„è¯ï¼Œå¼ºçƒˆå»ºè®®ä½ å‡çº§åˆ° webpack3ã€‚webpack3 å‘ä¸‹å…¼å®¹ï¼Œåªä¸è¿‡æœ‰ä¸€äº›æ’ä»¶éœ€è¦åŒæ—¶å‡çº§ï¼Œæ³¨æ„çœ‹æ§åˆ¶å°ç»™å‡ºçš„æ—¥å¿—ï¼ŒæŠŠéœ€è¦å‡çº§çš„ä¸€èµ·å‡çº§äº†å°±å¥½äº†ã€‚</p><h4>Scope Hoisting-ä½œç”¨åŸŸæå‡</h4><p>webpack æ‰“åŒ…çš„æ—¶å€™ï¼Œæ¯ä¸ªæ¨¡å—éƒ½è¢«ä¸€ä¸ªé—­åŒ…å‡½æ•°åŒ…è£¹ï¼Œè¿‡å¤šçš„é—­åŒ…å‡½æ•°é™ä½äº†æµè§ˆå™¨ä¸­ JS æ‰§è¡Œæ•ˆç‡ï¼ŒScope Hoisting çš„ä½œç”¨æ˜¯å‡å°‘é—­åŒ…å‡½æ•°çš„æ•°é‡ï¼Œå°†æœ‰å…³è”çš„æ¨¡å—æ”¾åˆ°åŒä¸€ä¸ªé—­åŒ…å‡½æ•°ä¸­ã€‚</p><p>å¯ç”¨æ–¹æ³•</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  plugins: [</span><br><span class="line">  <span class="keyword">new</span> webpack.optimize.ModuleConcatenationPlugin()</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Scope Hoisting æ˜¯åŸºäº ECMAScript Module syntax ï¼Œå¯¹äº Commonjs å’Œ AMD çš„æ¨¡å—ä¸é€‚ç”¨ã€‚</p><p>ä¸Šé¢å‡çº§çš„ç®—æ˜¯å‰¯æœ¬ï¼Œä¸‹é¢æ‰æ˜¯æ­£æ–‡ã€‚</p><h2>æ­£æ–‡å¼€å§‹</h2><p>ç°åœ¨å¼€å‘çš„é¡¹ç›®ç®—æ˜¯æ¯”è¾ƒå¤§çš„é¡¹ç›®ï¼Œä¸¥æ ¼æ¥è¯´ï¼Œæ˜¯å¤šä¸ª SPA ç»„æˆçš„å¤šé¡¹ç›®ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯èƒ½å‡å°‘æ¶æ„å¸ˆçš„å·¥ä½œï¼ŒåŒä¸€ä»½æ¶æ„ç»™å¤šä¸ªé¡¹ç›®ä½¿ç”¨ï¼Œèƒ½ä¿è¯é¡¹ç›®ç¨³å®šæ€§ã€‚åå¤„ä¹Ÿæ¯”è¾ƒæ˜æ˜¾ï¼Œå°±æ˜¯ä¼šé¢å¤–å¼•å…¥æ— ç”¨çš„ä¾èµ–ï¼Œæ¯”å¦‚å…±ç”¨çš„ helper æ¨¡å—ï¼Œå¾ˆå¤šé¡¹ç›®éƒ½å¼•ç”¨äº†ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯æ¯ä¸ªé¡¹ç›®éƒ½ä½¿ç”¨é‡Œé¢çš„æ¯ä¸ªå‡½æ•°ã€‚è¿™ç‚¹ tree-shaking å¯ä»¥ç»™å‡ºè§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯å®é™…å¼€å‘è¿‡ç¨‹ä¸­ï¼Œç”±äºåŒäº‹ä»¬ä»£ç è´¨é‡å‚å·®ä¸é½ï¼Œæœ‰äº›æ²¡ç”¨åˆ°çš„å‡½æ•°å’Œæ¨¡å—ä¹Ÿéƒ½å¼•ç”¨äº†ï¼Œæ‰€ä»¥å¯¼è‡´ tree-shaking çš„æ•ˆæœå¹¶ä¸æ˜¯å¾ˆå¥½ã€‚æ¯”å¦‚åœ¨å¤§é¡¹ç›®ä¸­ï¼ŒåŒäº‹æŠŠå‡ ä¸ª helper é‡Œé¢å‡½æ•°å…¨éƒ¨å°è£…åˆ° vue-filter ä¸­ï¼Œå½“ç„¶é‡Œé¢çš„å†…å®¹ä¸»è¦é¡¹ç›®å¤§å¤šæ•°éƒ½å¼•ç”¨åˆ°äº†ï¼Œä½†æ˜¯åé¢åŒäº‹åœ¨åˆå§‹åŒ–ä¸€ä¸ªå°é¡¹ç›®çš„åŒæ—¶ï¼Œæ— è®ºæ˜¯å¦éœ€è¦ä¹Ÿéƒ½ç”¨äº†ç›¸åŒçš„ä»£ç ï¼ˆcopy and pasteï¼‰ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> helpers <span class="keyword">from</span> <span class="string">'helpers'</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> helpers2 <span class="keyword">from</span> <span class="string">'helpers/string'</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> helpers3 <span class="keyword">from</span> <span class="string">'helpers/...'</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> helpers4 <span class="keyword">from</span> <span class="string">'helpers/...'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// register global utility filters.</span></span><br><span class="line"><span class="keyword">let</span> _filters = <span class="built_in">Object</span>.assign(helpers, helpers2, helpers3, helpers4)</span><br><span class="line"><span class="built_in">Object</span>.keys(_filters).forEach(<span class="function"><span class="params">key</span> =&gt;</span> Vue.filter(key, _filters[key]))</span><br></pre></td></tr></table></figure><p>äºæ˜¯ helper ä¸­æ¯ä¸ª function éƒ½æŒ‚è½½åœ¨ Vue-filter ä¸­ï¼Œæ‰€ä»¥å®Œç¾çš„é¿å¼€äº† tree-shakingã€‚</p><p>å¦å¤– tree-shaking è™½ç„¶èƒ½å¤Ÿä¸€å®šç¨‹åº¦çš„å‡å°‘æ‰“åŒ…åä»£ç çš„ä½“ç§¯ï¼Œä½†æ˜¯å¼€å‘å’Œç¼–è¯‘çš„é€Ÿåº¦è¿˜æ˜¯ä¼šå—åˆ°ä¸€å®šçš„å½±å“ã€‚</p><p>ä¸‹é¢æ˜¯ä»£ç æ‰“åŒ…é€Ÿåº¦ä¼˜åŒ–çš„ä¸€äº›æ€è·¯ï¼Œå¤šæ•°æ¥æºäºç½‘ä¸Šçš„èµ„æ–™ã€‚</p><h3>commonChunkPlugin æŠ½å–å…¬å…±ä»£ç </h3><p>æŠ½å–å…¬å…±ä»£ç æœ‰ä¸¤ä¸ªå¥½å¤„ï¼Œä¸€ä¸ªæ˜¯èƒ½å‡å°‘ç¼–è¯‘ä»£ç çš„æ•°é‡ï¼Œä¸€ä¸ªæ˜¯èƒ½å¤Ÿå……åˆ†åˆ©ç”¨æµè§ˆå™¨ç¼“å­˜ï¼Œæ¯”å¦‚é‡åˆ°é¡¹ç›®åˆ‡æ¢çš„æƒ…å†µï¼Œä½¿ç”¨ service-worker ä¸­ç¼“å­˜å…±ç”¨çš„ common ä»£ç èƒ½å¤Ÿå‡å°‘è¯·æ±‚çš„æ•°é‡ã€‚</p><p>ä»¥ä¸‹æ˜¯ vue-cli ä¸­ç»™å‡ºçš„è§£å†³æ–¹æ¡ˆ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// split vendor js into its own file</span></span><br><span class="line"><span class="keyword">new</span> webpack.optimize.CommonsChunkPlugin(&#123;</span><br><span class="line">  name: <span class="string">'vendor'</span>,</span><br><span class="line">  minChunks(<span class="built_in">module</span>) &#123;</span><br><span class="line">    <span class="comment">// any required modules inside node_modules are extracted to vendor</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="built_in">module</span>.resource &amp;&amp;</span><br><span class="line">      /\.js$/.test(<span class="built_in">module</span>.resource) &amp;&amp;</span><br><span class="line">      <span class="built_in">module</span>.resource.indexOf(</span><br><span class="line">        path.join(__dirname, <span class="string">'../node_modules'</span>)</span><br><span class="line">      ) === <span class="number">0</span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;),</span><br><span class="line"><span class="comment">// extract webpack runtime and module manifest to its own file in order to</span></span><br><span class="line"><span class="comment">// prevent vendor hash from being updated whenever app bundle is updated</span></span><br><span class="line"><span class="keyword">new</span> webpack.optimize.CommonsChunkPlugin(&#123;</span><br><span class="line">  name: <span class="string">'manifest'</span>,</span><br><span class="line">  minChunks: <span class="literal">Infinity</span></span><br><span class="line">&#125;),</span><br><span class="line"><span class="comment">// This instance extracts shared chunks from code splitted chunks and bundles them</span></span><br><span class="line"><span class="comment">// in a separate chunk, similar to the vendor chunk</span></span><br><span class="line"><span class="comment">// see: https://webpack.js.org/plugins/commons-chunk-plugin/#extra-async-commons-chunk</span></span><br><span class="line"><span class="keyword">new</span> webpack.optimize.CommonsChunkPlugin(&#123;</span><br><span class="line">  name: <span class="string">'app'</span>,</span><br><span class="line">  <span class="keyword">async</span>: <span class="string">'vendor-async'</span>,</span><br><span class="line">  children: <span class="literal">true</span>,</span><br><span class="line">  minChunks: <span class="number">3</span></span><br><span class="line">&#125;),</span><br></pre></td></tr></table></figure><h3>DLL é¢„ç¼–è¯‘</h3><p>DLL é¢„ç¼–è¯‘çš„ä½œç”¨æ˜¯å°†é¡¹ç›®ä¸­ç¨³å®šçš„ä¾èµ–å•ç‹¬æ‰“åŒ…ç¼–è¯‘ç”ŸæˆåŠ¨æ€é“¾æ¥åº“ï¼Œåœ¨ä¸šåŠ¡ä»£ç ä¸­å¼•ç”¨ã€‚è¿™ç‚¹åœ¨å¼€å‘è¿‡ç¨‹ä¸­ä¼˜åŠ¿æ¯”è¾ƒæ˜æ˜¾ï¼Œæ¯æ¬¡æ›´æ–°ä»£ç é‡æ–°ç¼–è¯‘çš„æ—¶å€™éƒ½èƒ½å¤Ÿçœå» DLL åº“çš„ç¼–è¯‘ï¼Œæœ‰ä¸å°çš„é€Ÿåº¦æå‡ã€‚</p><p>DLL éœ€è¦æœ‰ä¸€ä¸ªé¢å¤–çš„æ‰“åŒ…è¿‡ç¨‹ï¼Œæ–°å»ºä¸€ä¸ª webpck.dll.conf.js ç”¨æ¥æ‰“åŒ… DLLï¼Œå¹¶ä¸”åœ¨ package.json ä¸­æ·»åŠ æ‰“åŒ…è¿‡ç¨‹ã€‚</p><p>package.json</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"scripts"</span>: &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="string">"build"</span>: <span class="string">"rimraf dist &amp;&amp; npm run dll &amp;&amp; npm run build:server &amp;&amp; npm run build:client"</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="string">"dll"</span>: <span class="string">"cross-env NODE_ENV=dll node build"</span>,</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>webpack.dll.conf.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="keyword">const</span> UglifyJsPlugin = <span class="built_in">require</span>(<span class="string">'uglifyjs-webpack-plugin'</span>)</span><br><span class="line"><span class="keyword">const</span> os = <span class="built_in">require</span>(<span class="string">'os'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> vendors = [</span><br><span class="line">  <span class="string">'babel-polyfill'</span>,</span><br><span class="line">  <span class="string">'es6-promise'</span>,</span><br><span class="line">  <span class="string">'vue/dist/vue.esm.js'</span>,</span><br><span class="line">  <span class="string">'vue-router'</span>,</span><br><span class="line">  <span class="string">'vuex'</span>,</span><br><span class="line">  <span class="string">'vuex-router-sync'</span>,</span><br><span class="line">  <span class="string">'axios'</span>,</span><br><span class="line">  <span class="string">'cookie'</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  output: &#123;</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'../dist'</span>),</span><br><span class="line">    filename: <span class="string">'[name].dll.js'</span>,</span><br><span class="line">    library: <span class="string">'[name]_[hash]'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  entry: &#123;</span><br><span class="line">    <span class="string">'vendor'</span>: vendors,</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> UglifyJsPlugin(&#123;</span><br><span class="line">      ... <span class="comment">// å‹ç¼©å‚æ•°ç•¥</span></span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="keyword">new</span> webpack.DllPlugin(&#123;</span><br><span class="line">      context: __dirname,</span><br><span class="line">      path: path.join(__dirname, <span class="string">'../dist'</span>, <span class="string">'[name]-manifest.json'</span>),</span><br><span class="line">      name: <span class="string">'[name]_[hash]'</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡è¿è¡Œ <code>npm run dll</code> åœ¨ dist ç›®å½•ä¸‹ç”Ÿæˆäº†ä¸¤ä¸ªæ–‡ä»¶ vendor.dll.js å’Œ vendor.manifest.jsonã€‚å…¶ä¸­ vendor.dll.js ä¸­æ˜¯æ‰“åŒ…å‹ç¼©åçš„ vendor ä»£ç ï¼Œvendor.manifest.json æ˜¯ vendor æ–‡ä»¶çš„ node_modle è·¯å¾„å’Œ webpack æ‰“åŒ… id çš„æ˜ å°„ã€‚</p><p>ç„¶åé€šè¿‡ DllReferencePlugin å°† vendor å¼•å…¥ä¸šåŠ¡ä»£ç ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¿™é‡Œå°†ç”Ÿæˆçš„ vendor.dll.js æ–‡ä»¶ copy åˆ° ä½ éœ€è¦çš„ç›®å½• </span></span><br><span class="line"><span class="keyword">new</span> CopyWebpackPlugin([&#123;</span><br><span class="line">  <span class="keyword">from</span>: <span class="string">'dist/vendor.dll.js'</span>,</span><br><span class="line">  to: config.build.assetsSubDirectory,</span><br><span class="line">  flatten: <span class="literal">true</span></span><br><span class="line">&#125;]),</span><br><span class="line"><span class="keyword">new</span> webpack.DllReferencePlugin(&#123;</span><br><span class="line">  context: __dirname,</span><br><span class="line">  manifest: <span class="built_in">require</span>(<span class="string">'../dist/vendor-manifest.json'</span>)</span><br><span class="line">&#125;),</span><br></pre></td></tr></table></figure><p>æœ€åè¿˜éœ€è¦åœ¨ html ä¸­å¼•å…¥ç”Ÿæˆçš„ DLLï¼Œç½‘ä¸Šæœ‰ä¸€äº›æ•™ç¨‹æ˜¯ç›´æ¥æŠŠ script æ ‡ç­¾å†™å…¥ html ä¸­çš„ï¼Œä½†æ˜¯ç”±äºæˆ‘ä»¬å¤šä¸ªé¡¹ç›®åŒæ—¶ä¾èµ–åŒä¸€ä»½ html æ¨¡æ¿ï¼Œå…¶ä¸­æŸä¸€äº›é¡¹ç›®å¹¶ä¸éœ€è¦å¼•å…¥ DLLï¼Œæ¯”å¦‚ä¸€äº›é™æ€é¡µé¢ã€‚äºæ˜¯ä½¿ç”¨ html-webpack-include-assets-plugin å®ç°æŒ‰éœ€åŠ è½½ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">...pkgs.reduce(<span class="function">(<span class="params">pre, current</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> res = [<span class="keyword">new</span> HtmlWebpackPlugin(current.plugin)]</span><br><span class="line">  <span class="keyword">let</span> &#123;assets, filename&#125; = current.plugin || &#123;&#125;</span><br><span class="line">  <span class="keyword">if</span> (pre) res = [...pre, ...res]</span><br><span class="line">  <span class="keyword">if</span> (assets) &#123;</span><br><span class="line">    <span class="keyword">return</span> [...res, <span class="keyword">new</span> HtmlWebpackIncludeAssetsPlugin(&#123;</span><br><span class="line">    files: [filename],</span><br><span class="line">    assets: assets.map(<span class="function"><span class="params">item</span> =&gt;</span> <span class="string">`<span class="subst">$&#123;assetsSubDirectory&#125;</span>/<span class="subst">$&#123;item&#125;</span>`</span>),</span><br><span class="line">    append: <span class="literal">false</span>,</span><br><span class="line">    publicPath: assetsPublicPath</span><br><span class="line">    &#125;)]</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res</span><br><span class="line">&#125;, <span class="literal">null</span>),</span><br></pre></td></tr></table></figure><p>åœ¨ pkgs ä¸­æ§åˆ¶ HtmlWebpackPlugin çš„å‚æ•°ï¼Œå’Œæ˜¯å¦éœ€è¦å¼•å…¥ vendor.dll.jsã€‚</p><p>pkg æ¨¡æ¿å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> extChunks = IS_PROD ? [<span class="string">'manifest'</span>] : []</span><br><span class="line"><span class="keyword">const</span> chunksSortMode = IS_PROD ? <span class="string">'dependency'</span> : <span class="string">'auto'</span></span><br><span class="line"><span class="keyword">const</span> template = <span class="string">'static/templates/index.pug'</span></span><br><span class="line"><span class="keyword">const</span> minfiy = &#123;&#125;</span><br><span class="line"></span><br><span class="line">exports pkg = &#123;</span><br><span class="line">  <span class="string">'index'</span>: &#123;</span><br><span class="line">    buddle: <span class="string">'server-index-bundle.js'</span>,</span><br><span class="line">    entry: path.resolve(__dirname, <span class="string">'...çœç•¥è·¯å¾„../entry.js'</span>),</span><br><span class="line">    plugin: &#123;</span><br><span class="line">      filename: <span class="string">'app/index.html'</span>,</span><br><span class="line">      chunks: [<span class="string">'app'</span>, <span class="string">'vendor'</span>, <span class="string">'common'</span>, ...extChunks],</span><br><span class="line">      inject: <span class="literal">true</span>,</span><br><span class="line">      assets: [<span class="string">'vendor.dll.js'</span>],</span><br><span class="line">      chunksSortMode,</span><br><span class="line">      template,</span><br><span class="line">      minify</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// å¦‚æœæ²¡æœ‰é¢å¤–çš„ä¾èµ– assets ä¸ç”¨ä¼ </span></span><br><span class="line"> <span class="string">'404'</span>: &#123;</span><br><span class="line">    plugin: &#123;</span><br><span class="line">      filename: <span class="string">'404.html'</span>,</span><br><span class="line">      chunks: [<span class="string">'exception'</span>],</span><br><span class="line">      inject: <span class="literal">true</span>,</span><br><span class="line">      chunksSortMode,</span><br><span class="line">      template: <span class="string">'static/404.pug'</span>,</span><br><span class="line">      minify</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰“åŒ…åå¯ä»¥æ˜æ˜¾çœ‹åˆ° app.js å’Œ vendor.js ä½“ç§¯ç¼©å°ï¼Œä½†æ˜¯é¡¹ç›®æ€»ä½“ç§¯ç•¥æœ‰å¢å¤§ã€‚å› ä¸ºé€šè¿‡ DLL çš„æ–¹å¼ï¼Œé¢å¤–å­˜å‚¨äº†å¤–éƒ¨ä¾èµ–çš„è·¯å¾„å’Œ IDã€‚</p><h3>alias å‡å°‘æœç´¢è·¯å¾„</h3><p>è¿™ç‚¹æƒ³å¿…å¤§å®¶éƒ½çŸ¥é“</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  resolve: &#123;</span><br><span class="line">    alias: &#123;</span><br><span class="line">      <span class="string">'vue$'</span>: <span class="string">'vue/dist/vue.esm.js'</span>,</span><br><span class="line">      <span class="string">'static'</span>: path.resolve(__dirname, <span class="string">'../static'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// å¯ä»¥ç”¨å¼•ç”¨ node_modules é‡Œé¢çš„æ–¹æ³•å¼•ç”¨ src ä¸‹é¢çš„æ¨¡å—</span></span><br><span class="line">  modules: [path.resolve(__dirname, <span class="string">'../src'</span>), <span class="string">"node_modules"</span>]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3>å¤šçº¿ç¨‹åŠ é€Ÿ</h3><p>ï¼ˆ1ï¼‰ uglifyjs-webpack-plugin å¤šçº¿ç¨‹æç¤º JS å‹ç¼©æ•ˆç‡</p><p>ä½¿ç”¨ <a href="https://github.com/webpack-contrib/uglifyjs-webpack-plugin" target="_blank" rel="noopener">uglifyjs-webpack-plugin</a> ä¸ä»…å¯ä»¥åŠ é€Ÿ webpack å‹ç¼© js ä»£ç çš„é€Ÿåº¦ï¼Œè¿˜èƒ½ä¸ <a href="https://doc.webpack-china.org/guides/tree-shaking/" target="_blank" rel="noopener">webpack tree-shaking</a> é…åˆï¼Œå‡å°‘ä»£ç ä½“ç§¯ã€‚webpack æœ¬èº«å¹¶ä¸ä¼šæ‰§è¡Œ tree-shakingã€‚å®ƒéœ€è¦ä¾èµ–äºåƒ UglifyJS è¿™æ ·çš„ç¬¬ä¸‰æ–¹å·¥å…·æ¥æ‰§è¡Œå®é™…çš„æœªå¼•ç”¨ä»£ç (dead code)åˆ é™¤å·¥ä½œã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> UglifyJsParallelPlugin(&#123;</span><br><span class="line">  uglifyOptions: &#123;</span><br><span class="line">    ecma: <span class="number">8</span>,</span><br><span class="line">    mangle: <span class="literal">true</span>,</span><br><span class="line">    output: &#123;</span><br><span class="line">      beautify: <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">    compress: &#123;</span><br><span class="line">      drop_console: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  sourceMap: <span class="literal">false</span>,</span><br><span class="line">  cache: <span class="literal">true</span>,</span><br><span class="line">  parallel: os.cpus().length * <span class="number">2</span>,</span><br><span class="line">  exclude: <span class="regexp">/\.min\.js$/</span></span><br><span class="line">&#125;),</span><br></pre></td></tr></table></figure><p>è®°å¾—å¼€å¯ç¼“å­˜ï¼Œèƒ½æœ‰æ•ˆæå‡æ‰“åŒ…æ•ˆç‡ã€‚</p><p>ï¼ˆ2ï¼‰ happypack å¤šçº¿ç¨‹æå‡ loader æ‰§è¡Œæ•ˆç‡ã€‚</p><p>ä½¿ç”¨ happypack ä¹‹å‰ï¼Œä½ å¯ä»¥å…ˆå» <a href="https://github.com/amireh/happypack/wiki/Loader-Compatibility-List" target="_blank" rel="noopener">Loader Compatibility List</a> çœ‹ä¸€ä¸‹ happypack çš„å…¼å®¹æ€§åˆ—è¡¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> os = <span class="built_in">require</span>(<span class="string">'os'</span>)</span><br><span class="line"><span class="keyword">const</span> HappyPack = <span class="built_in">require</span>(<span class="string">'happypack'</span>)</span><br><span class="line"><span class="keyword">const</span> happyThreadPool = HappyPack.ThreadPool(&#123; <span class="attr">size</span>: os.cpus().length &#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">      use: [</span><br><span class="line">        &#123;</span><br><span class="line">          loader: <span class="string">'cache-loader'</span>, <span class="comment">// ä½¿ç”¨ cache-loader ç¼“å­˜</span></span><br><span class="line">          options: &#123;</span><br><span class="line">          cacheDirectory: resolve(<span class="string">'node_modules/.cache'</span>)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">'happypack/loader?id=babel'</span> <span class="comment">// å°† babel loaderæ›¿æ¢ä¸º happypack</span></span><br><span class="line">      ],</span><br><span class="line">      exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">        include: [</span><br><span class="line">          resolve(<span class="string">'src'</span>), resolve(<span class="string">'test'</span>)</span><br><span class="line">       ]</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">  <span class="comment">// ä½¿ç”¨ happypack æ’ä»¶</span></span><br><span class="line">    <span class="keyword">new</span> HappyPack(&#123; </span><br><span class="line">  id: <span class="string">'babel'</span>,</span><br><span class="line">  threadPool: happyThreadPool,</span><br><span class="line">  verbose: <span class="literal">false</span>,</span><br><span class="line">      loaders: [&#123;</span><br><span class="line">        loader: <span class="string">`babel-loader`</span></span><br><span class="line">      &#125;]</span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ happypack åï¼Œæ€§èƒ½æ¯”è¾ƒå·®çš„ mac mini é€Ÿåº¦åè€Œé™ä½äº†ä¸€äº›ï¼Œä½†æ˜¯æ€§èƒ½æ¯”è¾ƒå¼ºçš„ç¼–è¯‘æœºé€Ÿåº¦æœ‰ä¸å°‘çš„æå‡ï¼Œæ‰€ä»¥ happypack å¯ä»¥é…Œæƒ…ä½¿ç”¨ï¼Œæµ‹è¯•åå‘ç°é€Ÿåº¦æœ‰æå‡å†åŠ å…¥ï¼Œæ²¡æœ‰æå‡å°±æœæ–­å¼ƒç”¨ã€‚</p><h3>ç¼“å­˜ HardSourceWebpackPlugin</h3><p><a href="https://github.com/mzgoddard/hard-source-webpack-plugin" target="_blank" rel="noopener">hard-source-webpack-plugin</a> ä¹Ÿæ˜¯åˆ©ç”¨ç¼“å­˜æ•ˆæœæå‡æ‰“åŒ…é€Ÿåº¦ã€‚</p><blockquote><p>HardSourceWebpackPlugin is a plugin for webpack to provide an intermediate caching step for modules.</p></blockquote><p>ç”¨æ³•å¾ˆç®€å•</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> HardSourceWebpackPlugin = <span class="built_in">require</span>(<span class="string">'hard-source-webpack-plugin'</span>)</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> HardSourceWebpackPlugin()</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2>dev ä¼˜åŒ–</h2><p>å¼€å‘çš„æ—¶å€™ï¼Œä½¿ç”¨ koa-webpack-middleware çš„ devMiddleware, hotMiddleware ä¸¤ä¸ªä¸­é—´ä»¶æ˜¯æä¾› dev æœåŠ¡å’Œä»£ç çƒ­æ–°æœåŠ¡ï¼ŒdevMiddleware æœ¬è´¨ä¸Šæ˜¯å¯¹ webpack-dev-middleware çš„ä¸€å±‚å°è£…ï¼Œè€Œ hotMiddleware æ˜¯å¯¹ webpack-hot-middleware çš„ä¸€å±‚å°è£…ã€‚</p><p>å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰çš„ä»£ç å‡è¢«è½½å…¥ä¸¤ä¸ª webpack æœåŠ¡ä¸­ï¼Œå› æ­¤æœ‰ä¸€ä¸ç‚¹çš„ä»£ç æ”¹åŠ¨éƒ½éœ€è¦é‡æ–°ç¼–è¯‘æ‰€æœ‰çš„ buddleï¼Œè¿™å¯¹å¼€å‘è¿‡ç¨‹æ˜¯æå…¶ä¸å¥½çš„ä½“éªŒï¼Œå› æ­¤åˆ’åˆ†ä»£ç ä¾èµ–ï¼Œé€šè¿‡ npm å‚æ•°ç¼–è¯‘ä¸åŒçš„é¡¹ç›®ï¼Œæ¥è¾¾åˆ°åŠ é€Ÿå¼€å‘çš„æ•ˆæœã€‚</p><p>æ¯”å¦‚ä½¿ç”¨ <code>npm run dev project1</code> æ¥å¼€å‘é¡¹ç›® project1ï¼Œè€Œå…¶å®ƒä»£ç å¹¶ä¸åŠ è½½åˆ° webpack ä¸­ã€‚</p><p>æ‹¿åˆ° project1 å‚æ•°å¯ä»¥é€šè¿‡ node.js çš„ process å¯¹è±¡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> projects = process.argv.slice(<span class="number">2</span>)</span><br><span class="line"><span class="keyword">if</span> (!!projects &amp;&amp; projects.length) &#123;</span><br><span class="line">  <span class="comment">// filter your entry</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2>æ€»ç»“</h2><p>ä»¥ä¸Šæ‰“åŒ…ä¼˜åŒ–éƒ½æ˜¯å‚è€ƒç½‘ä¸Šçš„ä¸€äº›ä¸œè¥¿ï¼Œ åœ¨å®é™…ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œå‘ç°æœ‰äº›æ–‡ç« å†…å®¹æ˜¯å†™äº†ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰äº²èº«å®è·µï¼Œæœ‰äº›é”™è¯¯æˆ–è€…ä¸å®Œå–„çš„åœ°æ–¹ç”šè‡³éƒ½æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ï¼Œæ‰€ä»¥è‡ªå·±ç»“åˆå®é™…é¡¹ç›®èµ°äº†ä¸€éæµç¨‹åï¼Œè¿˜æ˜¯å†³å®šæŠŠä¸œè¥¿å†™å‡ºæ¥ï¼Œå¸Œæœ›å¯¹çœ‹åˆ°çš„äººæœ‰å¸®åŠ©ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;webpack æ‰“åŒ…ä¼˜åŒ–&lt;/h2&gt;
&lt;p&gt;æœ€è¿‘é¡¹ç›®ä¸ç®—å¿™ï¼ŒæŠ½æ—¶é—´é‡æ„äº†ä¸€ä¸‹é¡¹ç›®çš„æ‰“åŒ…ï¼Œå…ˆè¯´ä¸€ä¸‹æˆå°±ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æˆ‘çš„å¼€å‘ç”µè„‘ä¸Šï¼š&lt;/p&gt;
&lt;p&gt;OS: macOS High Sierra&lt;br&gt;
CPU: 2.6 GHz Intel Core i5&lt;br&gt;
å†…å­˜: 8G 1600 DDR3&lt;br&gt;
ç¡¬ç›˜: 1 TB SATAç£ç›˜&lt;/p&gt;
&lt;p&gt;ä»£ç å…¨é‡ç¼–è¯‘æ—¶é—´ä» 4 åˆ† 51 ç§’ä¼˜åŒ–åˆ° 2 åˆ† 08 - 20 ç§’å·¦å³ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨é¡¹ç›®ç¼–è¯‘ç”µè„‘ä¸Šï¼š&lt;/p&gt;
&lt;p&gt;OS: Ubuntu 16.04.3 LTS&lt;br&gt;
CPU: IntelÂ® Coreâ„¢ i5-7500 CPU @ 3.40GHz&lt;br&gt;
å†…å­˜: 64G 2133 DDR4&lt;br&gt;
ç¡¬ç›˜: 1 TB SSD&lt;/p&gt;
&lt;p&gt;ä»£ç å…¨é‡ç¼–è¯‘æ—¶é—´ä» 4 åˆ† 08 ç§’ä¼˜åŒ–åˆ° 1 åˆ† 10 - 20 ç§’å·¦å³ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="webpack" scheme="https://lz5z.com/tags/webpack/"/>
    
      <category term="dll" scheme="https://lz5z.com/tags/dll/"/>
    
  </entry>
  
  <entry>
    <title>å¸¸ç”¨å‘½ä»¤</title>
    <link href="https://lz5z.com/%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
    <id>https://lz5z.com/å¸¸ç”¨å‘½ä»¤/</id>
    <published>2017-12-20T08:56:26.000Z</published>
    <updated>2020-04-21T10:23:54.831Z</updated>
    
    <content type="html"><![CDATA[<p>è®°å½•ä¸€äº›å¸¸ç”¨çš„ç³»ç»Ÿæˆ–è€…è½¯ä»¶å‘½ä»¤</p><h2>kill port</h2><p>linux</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ç«¯å£å ç”¨</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> lsof -i :8080</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> ç»“æŸè¿›ç¨‹</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> sudo <span class="built_in">kill</span> -9 [pid]</span></span><br></pre></td></tr></table></figure><p>windows</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ç«¯å£å ç”¨</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> netstat -aon | findstr 8080</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹ pid è¿›ç¨‹</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> tasklist | findstr 19516</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> ç»“æŸè¿›ç¨‹</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> taskkill /pid 19516 /F</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æˆ–è€…ä½¿ç”¨è¿›ç¨‹åå­—</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> taskkill -F -IM node.exe</span></span><br></pre></td></tr></table></figure><a id="more"></a><h2>å®šæ—¶å…³æœº</h2><p>linux</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">shutdown</span><br><span class="line">æœ‰å¦‚ä¸‹é€‰é¡¹ï¼š</span><br><span class="line">- k     =&gt;ä¸æ‰§è¡Œä»»ä½•å…³æœºæ“ä½œï¼Œåªå‘å‡ºè­¦å‘Šä¿¡æ¯ç»™æ‰€æœ‰ç”¨æˆ·</span><br><span class="line">- r     =&gt; é‡æ–°å¯åŠ¨è®¡ç®—æœº</span><br><span class="line">- h    =&gt; å…³æœºå¹¶å½»åº•æ–­ç”µ</span><br><span class="line">- f     =&gt;å¿«é€Ÿå…³æœºä¸”é‡å¯åŠ¨æ—¶è·³è¿‡fsck</span><br><span class="line">- n    =&gt;å¿«é€Ÿå…³æœºä¸ç»è¿‡initç¨‹åº</span><br><span class="line">- c    =&gt; å–æ¶ˆä¹‹å‰çš„å®šæ—¶å…³æœº</span><br><span class="line">ç«‹å³å…³æœºï¼šshutdown -h now</span><br><span class="line">ç«‹å³é‡å¯ï¼šshutdown -r now</span><br><span class="line">æ³¨æ„ï¼šnow ä¸èƒ½çœç•¥</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> shutdown -h +10 <span class="comment"># 10åˆ†é’Ÿåè‡ªåŠ¨å…³æœº</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> shutdown -h 10:00 <span class="comment"># 10ç‚¹æ•´å…³æœº</span></span></span><br></pre></td></tr></table></figure><p>windows</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">shutdown</span><br><span class="line">-a     =&gt;å–æ¶ˆå…³æœº</span><br><span class="line">-s å…³æœº</span><br><span class="line">-f     =&gt;å¼ºè¡Œå…³é—­åº”ç”¨ç¨‹åº</span><br><span class="line">-l     =&gt;æ³¨é”€å½“å‰ç”¨æˆ·</span><br><span class="line">-r     =&gt;å…³æœºå¹¶é‡å¯</span><br><span class="line">-s -t æ—¶é—´     =&gt;è®¾ç½®å…³æœºå€’è®¡æ—¶</span><br><span class="line">-h ä¼‘çœ </span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> shutdown -s -t 3600  <span class="comment"># ä¸€ä¸ªå°æ—¶å€™è‡ªåŠ¨å…³æœº</span></span></span><br></pre></td></tr></table></figure><h2>åˆ·æ–° dns hosts</h2><p>windows</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ipconfig /flushdns</span></span><br></pre></td></tr></table></figure><h2>Git</h2><h3>config</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æ˜¾ç¤ºå½“å‰çš„ Git é…ç½®</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git config --list</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> ç¼–è¾‘Gité…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git config -e [--global] </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> è®¾ç½®æäº¤ä»£ç æ—¶çš„ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git config [--global] user.name <span class="string">"[name]"</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git config [--global] user.email <span class="string">"[email address]"</span></span></span><br></pre></td></tr></table></figure><h3>add</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git add -A (stage all files: new, modified, deleted)</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git add .  (stage files: new, modified, deleted[version 2])</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git add -u (stage files: modified, deleted)</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git add --ignore-removal . (stage files: new, modified)</span></span><br></pre></td></tr></table></figure><h3>commit</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git commit -m [message]</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git commit [file1][file2]... -m [message] <span class="comment"># file è¦åŒ…å«è·¯å¾„</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> amend ä½¿ç”¨ä¸€æ¬¡æ–°çš„ commitï¼Œæ›¿ä»£ä¸Šä¸€æ¬¡æäº¤</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å¦‚æœä»£ç æ²¡æœ‰ä»»ä½•æ–°å˜åŒ–ï¼Œåˆ™ç”¨æ¥æ”¹å†™ä¸Šä¸€æ¬¡ commit çš„æäº¤ä¿¡æ¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git commit --amend -m [message]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡åšä¸Šä¸€æ¬¡commitï¼Œå¹¶åŒ…æ‹¬æŒ‡å®šæ–‡ä»¶çš„æ–°å˜åŒ–</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git commit --amend [file1][file2]... -m[message]</span></span><br></pre></td></tr></table></figure><h3>pull</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> å–å›è¿œç¨‹ä»“åº“çš„å˜åŒ–ï¼Œå¹¶ä¸æœ¬åœ°åˆ†æ”¯åˆå¹¶</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git pull [remote] [branch]</span></span><br></pre></td></tr></table></figure><h3>push</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> ä¸Šä¼ æœ¬åœ°æŒ‡å®šåˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git push [remote] [branch]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> å¼ºè¡Œæ¨é€å½“å‰åˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“ï¼Œå³ä½¿æœ‰å†²çª</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git push [remote] --force</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ¨é€æ‰€æœ‰åˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git push [remote] --all</span></span><br></pre></td></tr></table></figure><h3>branch</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> åˆ—å‡ºæ‰€æœ‰æœ¬åœ°åˆ†æ”¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git branch</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ—å‡ºæ‰€æœ‰è¿œç¨‹åˆ†æ”¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git branch -r</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ—å‡ºæ‰€æœ‰æœ¬åœ°åˆ†æ”¯å’Œè¿œç¨‹åˆ†æ”¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git branch -a</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œä½†ä¾ç„¶åœç•™åœ¨å½“å‰åˆ†æ”¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git branch [branch-name]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œå¹¶åˆ‡æ¢åˆ°è¯¥åˆ†æ”¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git checkout -b [branch]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ‡æ¢åˆ°æŒ‡å®šåˆ†æ”¯ï¼Œå¹¶æ›´æ–°å·¥ä½œåŒº</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git checkout [branch-name]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œä¸æŒ‡å®šçš„è¿œç¨‹åˆ†æ”¯å»ºç«‹è¿½è¸ªå…³ç³»</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git branch --track [branch] [remote-branch]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ é™¤åˆ†æ”¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git branch -d [branch-name]</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ é™¤è¿œç¨‹åˆ†æ”¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git push origin --delete [branch-name]</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git branch -dr [remote/branch]</span></span><br></pre></td></tr></table></figure><h3>cherry-pick</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> é€‰æ‹©ä¸€ä¸ªcommitï¼Œåˆå¹¶è¿›å½“å‰åˆ†æ”¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git cherry-pick [commit id]</span></span><br></pre></td></tr></table></figure><h3>remote</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æ˜¾ç¤ºæ‰€æœ‰è¿œç¨‹ä»“åº“</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git remote -v</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> å¢åŠ ä¸€ä¸ªæ–°çš„è¿œç¨‹ä»“åº“</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git remote add [shortname] [url]</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è®°å½•ä¸€äº›å¸¸ç”¨çš„ç³»ç»Ÿæˆ–è€…è½¯ä»¶å‘½ä»¤&lt;/p&gt;
&lt;h2&gt;kill port&lt;/h2&gt;
&lt;p&gt;linux&lt;/p&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; æŸ¥çœ‹ç«¯å£å ç”¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; lsof -i :8080&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; ç»“æŸè¿›ç¨‹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; sudo &lt;span class=&quot;built_in&quot;&gt;kill&lt;/span&gt; -9 [pid]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;windows&lt;/p&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; æŸ¥çœ‹ç«¯å£å ç”¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; netstat -aon | findstr 8080&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; æŸ¥çœ‹ pid è¿›ç¨‹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; tasklist | findstr 19516&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; ç»“æŸè¿›ç¨‹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; taskkill /pid 19516 /F&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; æˆ–è€…ä½¿ç”¨è¿›ç¨‹åå­—&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; taskkill -F -IM node.exe&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Tools" scheme="https://lz5z.com/categories/Tools/"/>
    
    
      <category term="linux" scheme="https://lz5z.com/tags/linux/"/>
    
      <category term="windows" scheme="https://lz5z.com/tags/windows/"/>
    
      <category term="git" scheme="https://lz5z.com/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>CSS ä¼ªå…ƒç´ æŠ€å·§</title>
    <link href="https://lz5z.com/CSS%E4%BC%AA%E5%85%83%E7%B4%A0%E6%8A%80%E5%B7%A7/"/>
    <id>https://lz5z.com/CSSä¼ªå…ƒç´ æŠ€å·§/</id>
    <published>2017-12-08T20:08:00.000Z</published>
    <updated>2020-04-21T10:23:54.823Z</updated>
    
    <content type="html"><![CDATA[<h2>ä¼ªå…ƒç´ æŠ€å·§</h2><p>åœ¨ <a href="https://lz5z.com/CSS%E4%BC%AA%E5%85%83%E7%B4%A0%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/">CSS ä¼ªå…ƒç´ åŸºæœ¬ç”¨æ³•</a>ä¸€æ–‡ä¸­è®²è¿°äº†ä¼ªå…ƒç´ çš„åŸºç¡€åŠŸèƒ½ï¼Œæœ¬ç« å­¦ä¹ ä¸€äº›è¿›é˜¶åŠŸèƒ½ï¼Œçœ‹çœ‹ä¼ªå…ƒç´ èƒ½å®ç°å“ªäº›æ–¹ä¾¿å¥½ç”¨çš„åŠŸèƒ½ã€‚</p><h3>æ¸…é™¤æµ®åŠ¨</h3><p>å¦‚æœä¸€ä¸ªå…ƒç´ å†…éƒ¨çš„å­å…ƒç´ å…¨éƒ¨éƒ½æ˜¯æµ®åŠ¨çš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ªå…ƒç´ ä¼šå‡ºç°é«˜åº¦å¡Œé™·ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦æ¸…é™¤æµ®åŠ¨ã€‚é«˜åº¦å¡Œé™·çš„è´Ÿé¢ä½œç”¨ä¸»è¦æœ‰ï¼šä¸èƒ½æ­£ç¡®æ˜¾ç¤ºèƒŒæ™¯ï¼Œè¾¹æ¡†ä¸èƒ½æ’‘å¼€ï¼Œmargin å’Œ padding ä¸èƒ½æ­£ç¡®æ˜¾ç¤ºã€‚</p><p>å‡è®¾æœ‰ä»£ç å¦‚ä¸‹ï¼š</p><a id="more"></a><p>html:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"outer"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"inner"</span>&gt;</span>1<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"inner"</span>&gt;</span>2<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"inner"</span>&gt;</span>3<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>css:</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.outer</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#ccc</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">5px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.inner</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">80px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">80px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä¼ªå…ƒç´ æ¸…é™¤æµ®åŠ¨çš„åŠæ³•ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.outer</span> &#123;</span><br><span class="line">  zoom: 1; // IE6/7 å…¼å®¹æ€§</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.outer</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">""</span>;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">clear</span>: both;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶å®ƒæ¸…é™¤æµ®åŠ¨çš„åŠæ³•ï¼š</p><p>ï¼ˆ1ï¼‰ç»™çˆ¶å…ƒç´ è®¾ç½®é«˜åº¦ã€‚<br>ï¼ˆ2ï¼‰<code>clear: both</code> æ¸…é™¤æµ®åŠ¨ã€‚</p><p>å¸¸è§çš„ç”¨æ³•æ˜¯åœ¨çˆ¶å…ƒç´ ç»“æŸä¹‹å‰ï¼Œç»Ÿä¸€å¼•å…¥ä¸€ä¸ªå…ƒç´  <code>clear: both</code> ç”¨æ¥æ¸…é™¤æµ®åŠ¨ã€‚</p><p>html:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"outer"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"inner"</span>&gt;</span>1<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"inner"</span>&gt;</span>2<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"inner"</span>&gt;</span>3<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"clear"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>css:</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.clear</span> &#123;</span><br><span class="line">  <span class="attribute">clear</span>: both;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ç§æ–¹æ³•å®ç°èµ·æ¥å¾ˆç®€å•ï¼Œä¸è¿‡ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œå¼•å…¥äº†é¢å¤–çš„ DOM å…ƒç´ ã€‚</p><p>clear å±æ€§å¯ä»¥å¯¹åº”çš„å±æ€§å€¼æœ‰ï¼š</p><ul><li>left  åœ¨å·¦ä¾§ä¸å…è®¸æµ®åŠ¨å…ƒç´ ã€‚</li><li>right  åœ¨å³ä¾§ä¸å…è®¸æµ®åŠ¨å…ƒç´ ã€‚</li><li>both  åœ¨å·¦å³ä¸¤ä¾§å‡ä¸å…è®¸æµ®åŠ¨å…ƒç´ ã€‚</li><li>none  é»˜è®¤å€¼ã€‚å…è®¸æµ®åŠ¨å…ƒç´ å‡ºç°åœ¨ä¸¤ä¾§ã€‚</li><li>inherit  è§„å®šåº”è¯¥ä»çˆ¶å…ƒç´ ç»§æ‰¿ clear å±æ€§çš„å€¼ã€‚</li></ul><p>ï¼ˆ3ï¼‰ç»™çˆ¶çº§å…ƒç´ å®šä¹‰ <code>overflow: auto</code> æˆ–è€… <code>overflow: hidden</code></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.outer</span> &#123;</span><br><span class="line">  <span class="attribute">overflow</span>: auto;</span><br><span class="line">  zoom: 1; // IE6/7 å…¼å®¹æ€§</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ overflow å±æ€§æ¥æ¸…é™¤æµ®åŠ¨åªå¯ä»¥ä½¿ç”¨ hiddent å’Œ auto ä¸èƒ½ä½¿ç”¨ visibleã€‚ ä¸ºäº†å…¼å®¹ IE æœ€å¥½ç”¨ <code>overflow:hidden</code>ï¼Œç¼ºç‚¹æ˜¯å…ƒç´ ä¼šè¢«æˆªæ–­ã€‚</p><p>æ€»ç»“æ¸…é™¤æµ®åŠ¨æœ€ä½³æ–¹æ¡ˆ</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// å…¨æµè§ˆå™¨é€šç”¨çš„ clearfix æ–¹æ¡ˆ</span><br><span class="line">// å¼•å…¥äº† zoom ä»¥æ”¯æŒ IE6/7</span><br><span class="line">// åŒæ—¶åŠ å…¥ :before ä»¥è§£å†³ç°ä»£æµè§ˆå™¨ä¸Šè¾¹è·æŠ˜å çš„é—®é¢˜</span><br><span class="line"><span class="selector-class">.clearfix</span><span class="selector-pseudo">:before</span>,</span><br><span class="line"><span class="selector-class">.clearfix</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: table;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">" "</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.clearfix</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">  <span class="attribute">clear</span>: both;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.clearfix</span> &#123;</span><br><span class="line">  <span class="attribute">zoom</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3>æ‰©å¤§å¯ç‚¹å‡»èŒƒå›´</h3><p>è¿™ç‚¹åœ¨ç§»åŠ¨ç«¯å¼€å‘æ˜¾å¾—å°¤ä¸ºé‡è¦ï¼Œå¯ä»¥å¢å¼ºç”¨æˆ·ä½“éªŒã€‚</p><p>html:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn"</span>&gt;</span>click<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><p>css:</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.btn</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.btn</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">''</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: -<span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">right</span>: -<span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: -<span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">left</span>: -<span class="number">20px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸€ç§ä¸ä½¿ç”¨ä¼ªå…ƒç´ æ‰©å¤§å¯ç‚¹å‡»èŒƒå›´çš„æ–¹å¼æ˜¯ä½¿ç”¨ border + background-clip</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.btn</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">20px</span> solid transparent;</span><br><span class="line">  <span class="attribute">background-clip</span>: padding-box;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3>å®ç°åˆ†å‰²çº¿æ•ˆæœ</h3><!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.9.0">  <style>  .divide {    width: 100%;    text-align: center;  }  .divide:before, .divide:after {    content: "";    position: absolute;    margin: 14px 14px 10px 10px;    height: 1px;    width: calc(50% - 75px);    background-color: red;    padding: 0 10px;  }  .divide:before {    left: 0;  }  .divide:after {    right: 0;  }  </style></head><body>  <p class="divide">æˆ‘æ˜¯åˆ†å‰²çº¿</p></body></html><p>å®ç°æ–¹å¼</p><p>html:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"divide"</span>&gt;</span>æˆ‘æ˜¯åˆ†å‰²çº¿<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p>css:</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.divide</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.divide</span><span class="selector-pseudo">:before</span>, <span class="selector-class">.divide</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">""</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">14px</span> <span class="number">14px</span> <span class="number">10px</span> <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">1px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="built_in">calc</span>(<span class="number">50%</span> - <span class="number">75px</span>);</span><br><span class="line">  <span class="attribute">background-color</span>: red;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.divide</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.divide</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3>è°ƒç”¨å…ƒç´ å±æ€§</h3><p>é€šè¿‡åœ¨ content ä¸­ä½¿ç”¨ attr å‡½æ•°å¯ä»¥è°ƒç”¨å…ƒç´ çš„å±æ€§ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">a</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="built_in">attr</span>(href);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3>å¼•ç”¨åª’ä½“èµ„æº</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">a</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="built_in">url</span>(https://lz5z.com/assets/img/avatar.svg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3>è®¡æ•°å™¨ counter</h3><ol><li>counter-resetï¼šåˆ›å»ºæˆ–è€…é‡ç½®ä¸€ä¸ªè®¡æ•°å™¨</li><li>counter-incrementï¼šè®¡æ•°å™¨é€’å¢</li><li>contentï¼šé…åˆä¼ªå…ƒç´ æ’å…¥å†…å®¹</li></ol><p>html:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ol</span> <span class="attr">class</span>=<span class="string">"sites"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span>&gt;</span>Apple<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span>&gt;</span>Google<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span>&gt;</span>Amazon<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span>&gt;</span>Facebook<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>ä¸€å…±é€‰æ‹©äº†<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"count"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>ä¸ªç½‘ç«™<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p>css:</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.sites</span> &#123;</span><br><span class="line">  <span class="attribute">counter-reset</span>: site;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.sites</span> <span class="selector-tag">input</span><span class="selector-pseudo">:checked</span> &#123;</span><br><span class="line">  <span class="attribute">counter-increment</span>: site;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.count</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="built_in">counter</span>(site);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3>è‡ªåˆ¶ checked æ ·å¼</h3><!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.9.0">  <meta charset="UTF-8">  <title>Document</title>  <style>  #sites li {    margin: 0 auto;    width: 30px;    font-size: 14px;    line-height: 1.5;    cursor: pointer;  }    #sites li:before {    color: #7cfc00;    background: #fff;    border: 2px solid #d3d3d3;    content: " ";    width: 16px;    height: 16px;    line-height: 1;    margin-left: -38px;    position: absolute;    text-align: center;    vertical-align: middle;    cursor: pointer;    pointer-events: all;  }    #sites li.checked:before {    background: green;    border: 2px solid green;    color: #fff;    content: "\2714";  }  </style></head><body>  <ol id="sites">    <li class="checked">Apple</li>    <li>Google</li>    <li class="checked">Amazon</li>    <li>Facebook</li>  </ol></body><script>function hasClass(el, className) {  if (el.classList) {    return el.classList.contains(className)  } else {    return !!el.className.match(new RegExp('(\\s|^)' + className + '(\\s|$)'))  }}function addClass(el, className) {  if (el.classList) {    el.classList.add(className)  } else if (!hasClass(el, className)) {    el.className += ` ${className}`  }}function removeClass(el, className) {  if (el.classList) {    el.classList.remove(className)  } else if (hasClass(el, className)) {    let reg = new RegExp('(\\s|^)' + className + '(\\s|$)')    el.className = el.className.replace(reg, ' ')  }}function changeStyle(ele) {  if (hasClass(ele, 'checked')) {    removeClass(ele, 'checked')  } else {    addClass(ele, 'checked')  }}let sites = document.querySelector('ol#sites')// äº‹ä»¶å§”æ‰˜sites.addEventListener('click', function(e) {  e = e || window.event  let target = e.target || e.srcElement  if (target.tagName.toLowerCase() === 'li') {    changeStyle(target)  }}, false)</script></html><p>html:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ol</span> <span class="attr">id</span>=<span class="string">"sites"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"checked"</span>&gt;</span>Apple<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>Google<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"checked"</span>&gt;</span>Amazon<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>Facebook<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br></pre></td></tr></table></figure><p>css</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">li</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">1.5</span>;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">li</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#7cfc00</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">2px</span> solid <span class="number">#d3d3d3</span>;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">" "</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">margin-left</span>: -<span class="number">38px</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">  <span class="attribute">pointer-events</span>: all;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">li</span><span class="selector-class">.checked</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: green;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">2px</span> solid green;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">"\2714"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2>æœ€å</h2><p>åœ¨ç½‘ä¸Šè¿˜æœ‰å¾ˆå¤šå…³äºä¼ªå…ƒç´ çš„ç”¨æ³•ï¼Œéå¸¸æœ‰è¶£ï¼Œæ—¢èƒ½å‡å°‘ DOM å…ƒç´ æ•°é‡ï¼Œè¿˜èƒ½ç”¨ CSS å®ç°ä¸€éƒ¨åˆ† JS çš„åŠŸèƒ½ï¼Œéå¸¸é…·ç‚«ï¼Œåé¢è§åˆ°æœ‰è¶£çš„ç”¨æ³•ä¼šä¸æ–­è®°å½•ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;ä¼ªå…ƒç´ æŠ€å·§&lt;/h2&gt;
&lt;p&gt;åœ¨ &lt;a href=&quot;https://lz5z.com/CSS%E4%BC%AA%E5%85%83%E7%B4%A0%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/&quot;&gt;CSS ä¼ªå…ƒç´ åŸºæœ¬ç”¨æ³•&lt;/a&gt;ä¸€æ–‡ä¸­è®²è¿°äº†ä¼ªå…ƒç´ çš„åŸºç¡€åŠŸèƒ½ï¼Œæœ¬ç« å­¦ä¹ ä¸€äº›è¿›é˜¶åŠŸèƒ½ï¼Œçœ‹çœ‹ä¼ªå…ƒç´ èƒ½å®ç°å“ªäº›æ–¹ä¾¿å¥½ç”¨çš„åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;h3&gt;æ¸…é™¤æµ®åŠ¨&lt;/h3&gt;
&lt;p&gt;å¦‚æœä¸€ä¸ªå…ƒç´ å†…éƒ¨çš„å­å…ƒç´ å…¨éƒ¨éƒ½æ˜¯æµ®åŠ¨çš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ªå…ƒç´ ä¼šå‡ºç°é«˜åº¦å¡Œé™·ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦æ¸…é™¤æµ®åŠ¨ã€‚é«˜åº¦å¡Œé™·çš„è´Ÿé¢ä½œç”¨ä¸»è¦æœ‰ï¼šä¸èƒ½æ­£ç¡®æ˜¾ç¤ºèƒŒæ™¯ï¼Œè¾¹æ¡†ä¸èƒ½æ’‘å¼€ï¼Œmargin å’Œ padding ä¸èƒ½æ­£ç¡®æ˜¾ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾æœ‰ä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
    
    </summary>
    
      <category term="CSS" scheme="https://lz5z.com/categories/CSS/"/>
    
    
      <category term="CSS" scheme="https://lz5z.com/tags/CSS/"/>
    
      <category term="ä¼ªå…ƒç´ " scheme="https://lz5z.com/tags/%E4%BC%AA%E5%85%83%E7%B4%A0/"/>
    
      <category term="æ¸…é™¤æµ®åŠ¨" scheme="https://lz5z.com/tags/%E6%B8%85%E9%99%A4%E6%B5%AE%E5%8A%A8/"/>
    
  </entry>
  
  <entry>
    <title>CSS ä¼ªå…ƒç´ åŸºæœ¬ç”¨æ³•</title>
    <link href="https://lz5z.com/CSS%E4%BC%AA%E5%85%83%E7%B4%A0%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/"/>
    <id>https://lz5z.com/CSSä¼ªå…ƒç´ åŸºæœ¬ç”¨æ³•/</id>
    <published>2017-12-08T18:06:19.000Z</published>
    <updated>2020-04-21T10:23:54.823Z</updated>
    
    <content type="html"><![CDATA[<h1>ä¼ªå…ƒç´ </h1><p>CSS ä¸­å¯ä»¥åˆ©ç”¨ä¼ªå…ƒç´ ç»™ DOM å…ƒç´ æ·»åŠ ç‰¹æ®Šçš„æ ·å¼ã€‚æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>:before</code> åœ¨ä¸€ä¸ªå…ƒç´ å‰å¢åŠ ä¸€äº›æ–‡æœ¬ï¼Œå¹¶ä¸ºè¿™äº›æ–‡æœ¬æ·»åŠ æ ·å¼ã€‚è™½ç„¶ç”¨æˆ·å¯ä»¥çœ‹åˆ°è¿™äº›æ–‡æœ¬ï¼Œä½†æ˜¯è¿™äº›æ–‡æœ¬å®é™…ä¸Šä¸åœ¨æ–‡æ¡£æ ‘ä¸­ã€‚</p><p>CSS3 è§„èŒƒä¸­è¦æ±‚ä½¿ç”¨åŒå†’å·(::)æ·»åŠ ä¼ªå…ƒç´ ï¼Œç”¨ä»¥åŒºåˆ†ä¼ªå…ƒç´ å’Œä¼ªç±»ï¼Œæ¯”å¦‚ <code>::before</code> æ˜¯ä¼ªå…ƒç´ ï¼Œ<code>:hover</code> æ˜¯ä¼ªç±»ã€‚ä½†æ˜¯å¤§éƒ¨åˆ†ä¼ªå…ƒç´ ä¾ç„¶æ”¯æŒå•å†’å·çš„å½¢å¼ï¼Œ<code>::before</code> å†™æˆ <code>:before</code> ä¹Ÿå¯ä»¥ï¼Œä¸ºäº†å‘åå…¼å®¹ï¼Œä¸€èˆ¬æ¨èä½¿ç”¨å•å†’å·çš„å½¢å¼ã€‚</p><p>æ”¯æŒå•åŒå†’å·çš„ä¼ªå…ƒç´ æœ‰ï¼š <code>:before/::before</code>ï¼Œ<code>:after/::after</code>ï¼Œ<code>:first-letter/::first-letter</code>ï¼Œ<code>:first-line/::first-line</code>ã€‚</p><p>ä»…æ”¯æŒåŒå†’å·çš„ä¼ªå…ƒç´ æœ‰ï¼š <code>::selection</code>ï¼Œ<code>::placeholder</code>ï¼Œ<code>::backdrop</code>ã€‚</p><a id="more"></a><h2><code>:before</code> &amp; <code>:after</code></h2><p><code>:before</code> å’Œ <code>:after</code> å¯ä»¥åœ¨å…ƒç´ å‰é¢æˆ–è€…åé¢æ’å…¥å†…å®¹ï¼Œç”¨ content å±æ€§è¡¨ç¤ºè¦æ’å…¥çš„å†…å®¹ï¼Œè¿™ä¸ªè™šæ‹Ÿå…ƒç´ é»˜è®¤æ˜¯è¡Œå†…å…ƒç´ ï¼Œå¯ä»¥é…åˆå…¶å®ƒæ ·å¼ä½¿ç”¨ã€‚</p><p>html:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p>css:</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">'Hello'</span>;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">p</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">'World'</span>;</span><br><span class="line">  <span class="attribute">color</span>: black;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>p å…ƒç´ ä¼šæ˜¾ç¤º <strong>Hello World</strong>ï¼Œä½†æ˜¯è¢«æ’å…¥çš„å†…å®¹å®é™…ä¸Šä¸åœ¨æ–‡æ¡£æ ‘ä¸­ã€‚</p><h2><code>:first-letter</code></h2><p><code>:first-letter</code> ç”¨æ¥è·å–å…ƒç´ ä¸­æ–‡æœ¬çš„é¦–å­—æ¯ï¼Œè¢«ä¿®é¥°çš„é¦–å­—æ¯ä¸åœ¨æ–‡æ¡£æ ‘ä¸­ã€‚æ³¨æ„æ²¡æœ‰ <code>:last-letter</code>ã€‚</p><p>é¦–è¡Œåªåœ¨ block-container box å†…éƒ¨æ‰æœ‰æ„ä¹‰, å› æ­¤ <code>:first-letter</code> ä¼ªå…ƒç´  åªåœ¨ display å±æ€§å€¼ä¸º block, inline-block, table-cell, list-item æˆ–è€… table-caption çš„å…ƒç´ ä¸Šæ‰èµ·ä½œç”¨ã€‚ å…¶ä»–æƒ…å†µä¸‹ <code>:first-letter</code> æ¯«æ— æ„ä¹‰ã€‚</p><p><code>:first-letter</code> çš„ä¼˜å…ˆçº§ä½äº <code>:before</code>ï¼Œä¹Ÿå°±æ˜¯å¦‚æœå…ƒç´ ç”¨ <code>:before</code> å…ˆæ’å…¥æ–‡æœ¬ï¼Œä¼šè·å– before ä¼ªå…ƒç´ ä¸­çš„å†…å®¹ã€‚</p><p>html:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>World<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p>css:</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">'Hello '</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">p</span><span class="selector-pseudo">:first-letter</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">40px</span>;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ—¶ï¼Œ<code>:first-letter</code> å®é™…è·å–çš„å…ƒç´ æ˜¯ <code>ï¼šbefore</code> ä¸­çš„ <strong>H</strong>ã€‚</p><p>æ³¨æ„ï¼š åœ¨ä¸€ä¸ªä½¿ç”¨äº† <code>:first-letter</code> ä¼ªå…ƒç´ çš„é€‰æ‹©å™¨ä¸­ï¼Œåªæœ‰å¾ˆå°çš„ä¸€éƒ¨åˆ† css å±æ€§èƒ½è¢«ä½¿ç”¨ <a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/::first-letter" target="_blank" rel="noopener">::first-letter</a></p><h2><code>:first-line</code></h2><p><code>:first-line</code> ç”¨æ¥è·å– <strong>å—çŠ¶å…ƒç´ </strong> ä¸­çš„ç¬¬ä¸€è¡Œæ–‡æœ¬ï¼Œä¸èƒ½ç”¨äºå†…è”å…ƒç´ ã€‚</p><p>html:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello<span class="tag">&lt;/<span class="name">br</span>&gt;</span>World<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure><p>css:</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">h1</span><span class="selector-pseudo">:first-line</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: orange;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸€ä¸ªä½¿ç”¨äº† ::first-line ä¼ªå…ƒç´ çš„é€‰æ‹©å™¨ä¸­ï¼Œåªæœ‰å¾ˆå°çš„ä¸€éƒ¨åˆ†csså±æ€§èƒ½è¢«ä½¿ç”¨ <a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/::first-line" target="_blank" rel="noopener">::first-line</a></p><h2><code>::selection</code></h2><p><code>::selection</code> ä¼ªå…ƒç´ åº”ç”¨äºæ–‡æ¡£ä¸­è¢«ç”¨æˆ·é«˜äº®çš„éƒ¨åˆ†ï¼ˆæ¯”å¦‚ä½¿ç”¨é¼ æ ‡æˆ–å…¶ä»–é€‰æ‹©è®¾å¤‡é€‰ä¸­çš„éƒ¨åˆ†ï¼‰ï¼Œè¯¥ä¼ªå…ƒç´ åªæ”¯æŒåŒå†’å·çš„å½¢å¼ã€‚</p><p>åªæœ‰ Gecko å¼•æ“éœ€è¦åŠ å‰ç¼€ï¼ˆ-mozï¼‰</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-pseudo">::-moz-selection</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: orange;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="selector-pseudo">::selection</span>  &#123;</span><br><span class="line">  <span class="attribute">background</span>: orange;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼š åªæœ‰ä¸€å°éƒ¨åˆ† CSS å±æ€§å¯ä»¥ç”¨äº <code>::selection</code> é€‰æ‹©å™¨ï¼š color, background-color, cursor, outline, text-decoration, text-emphasis-color å’Œ text-shadowã€‚è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œbackground-image ä¼šå¦‚åŒå…¶ä»–å±æ€§ä¸€æ ·è¢«å¿½ç•¥ã€‚</p><h2><code>::placeholder</code> (è¯•éªŒæ€§è´¨)</h2><p><code>:placeholder</code> åŒ¹é…å ä½ç¬¦çš„æ–‡æœ¬ï¼Œåªæœ‰å…ƒç´ è®¾ç½®äº† placeholder å±æ€§æ—¶ï¼Œè¯¥ä¼ªå…ƒç´ æ‰èƒ½ç”Ÿæ•ˆã€‚åœ¨ä¸€äº›æµè§ˆå™¨ä¸­ï¼ˆIE10 å’Œ Firefox18 åŠå…¶ä»¥ä¸‹ç‰ˆæœ¬ï¼‰ä¼šä½¿ç”¨å•å†’å·çš„å½¢å¼ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">input</span><span class="selector-pseudo">::-moz-placeholder</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#666</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="selector-tag">input</span><span class="selector-pseudo">::-webkit-input-placeholder</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#666</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/* IE 10 only */</span></span><br><span class="line"><span class="selector-tag">input</span><span class="selector-pseudo">:-ms-input-placeholder</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#666</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/* Firefox 18 and below */</span></span><br><span class="line"><span class="selector-tag">input</span><span class="selector-pseudo">:-moz-input-placeholder</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#666</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2><code>::backdrop</code> (è¯•éªŒæ€§è´¨)</h2><p>ç”¨äºæ”¹å˜å…¨å±æ¨¡å¼ä¸‹èƒŒæ™¯è‰²ï¼Œå…¨å±æ¨¡å¼é»˜è®¤èƒŒæ™¯è‰²ä¸ºé»‘è‰²ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">h1</span><span class="selector-pseudo">:fullscreen</span><span class="selector-pseudo">::backdrop</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: orange;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>å‚è€ƒæ–‡ç« </h1><ul><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/Pseudo-elements" target="_blank" rel="noopener">MDN - Pseudo-elements</a></li><li><a href="http://www.alloyteam.com/2016/05/summary-of-pseudo-classes-and-pseudo-elements/" target="_blank" rel="noopener">summary-of-pseudo-classes-and-pseudo-elements/</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;ä¼ªå…ƒç´ &lt;/h1&gt;
&lt;p&gt;CSS ä¸­å¯ä»¥åˆ©ç”¨ä¼ªå…ƒç´ ç»™ DOM å…ƒç´ æ·»åŠ ç‰¹æ®Šçš„æ ·å¼ã€‚æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ &lt;code&gt;:before&lt;/code&gt; åœ¨ä¸€ä¸ªå…ƒç´ å‰å¢åŠ ä¸€äº›æ–‡æœ¬ï¼Œå¹¶ä¸ºè¿™äº›æ–‡æœ¬æ·»åŠ æ ·å¼ã€‚è™½ç„¶ç”¨æˆ·å¯ä»¥çœ‹åˆ°è¿™äº›æ–‡æœ¬ï¼Œä½†æ˜¯è¿™äº›æ–‡æœ¬å®é™…ä¸Šä¸åœ¨æ–‡æ¡£æ ‘ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;CSS3 è§„èŒƒä¸­è¦æ±‚ä½¿ç”¨åŒå†’å·(::)æ·»åŠ ä¼ªå…ƒç´ ï¼Œç”¨ä»¥åŒºåˆ†ä¼ªå…ƒç´ å’Œä¼ªç±»ï¼Œæ¯”å¦‚ &lt;code&gt;::before&lt;/code&gt; æ˜¯ä¼ªå…ƒç´ ï¼Œ&lt;code&gt;:hover&lt;/code&gt; æ˜¯ä¼ªç±»ã€‚ä½†æ˜¯å¤§éƒ¨åˆ†ä¼ªå…ƒç´ ä¾ç„¶æ”¯æŒå•å†’å·çš„å½¢å¼ï¼Œ&lt;code&gt;::before&lt;/code&gt; å†™æˆ &lt;code&gt;:before&lt;/code&gt; ä¹Ÿå¯ä»¥ï¼Œä¸ºäº†å‘åå…¼å®¹ï¼Œä¸€èˆ¬æ¨èä½¿ç”¨å•å†’å·çš„å½¢å¼ã€‚&lt;/p&gt;
&lt;p&gt;æ”¯æŒå•åŒå†’å·çš„ä¼ªå…ƒç´ æœ‰ï¼š &lt;code&gt;:before/::before&lt;/code&gt;ï¼Œ&lt;code&gt;:after/::after&lt;/code&gt;ï¼Œ&lt;code&gt;:first-letter/::first-letter&lt;/code&gt;ï¼Œ&lt;code&gt;:first-line/::first-line&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä»…æ”¯æŒåŒå†’å·çš„ä¼ªå…ƒç´ æœ‰ï¼š &lt;code&gt;::selection&lt;/code&gt;ï¼Œ&lt;code&gt;::placeholder&lt;/code&gt;ï¼Œ&lt;code&gt;::backdrop&lt;/code&gt;ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="CSS" scheme="https://lz5z.com/categories/CSS/"/>
    
    
      <category term="CSS" scheme="https://lz5z.com/tags/CSS/"/>
    
      <category term="ä¼ªå…ƒç´ " scheme="https://lz5z.com/tags/%E4%BC%AA%E5%85%83%E7%B4%A0/"/>
    
      <category term="before" scheme="https://lz5z.com/tags/before/"/>
    
      <category term="after" scheme="https://lz5z.com/tags/after/"/>
    
  </entry>
  
  <entry>
    <title>HTML meta æ ‡ç­¾</title>
    <link href="https://lz5z.com/HTML-meta/"/>
    <id>https://lz5z.com/HTML-meta/</id>
    <published>2017-12-02T15:22:13.000Z</published>
    <updated>2020-04-21T10:23:54.823Z</updated>
    
    <content type="html"><![CDATA[<h1>å¼•è¨€</h1><p>æœ€è¿‘åšçš„ä¸€ä¸ªå…³äºç”µå½±çš„ç½‘ç«™ <a href="https://movie.lz5z.com/" target="_blank" rel="noopener">IMDB Top250</a>ï¼Œæƒ³å¯¹å…¶è¿›è¡Œ SEO ä¼˜åŒ–ï¼Œç”¨åˆ° meta ä¿¡æ¯çš„æ—¶å€™ï¼Œå¾ˆå¤šçŸ¥è¯†éƒ½æ˜¯ ã€ä¼¼ä¹ã€ã€ã€å¥½åƒã€ã€ã€å¯èƒ½ã€ çš„æ„Ÿè§‰ï¼Œå›æƒ³è‡ªå·±ä¸€ç›´æ²¡æœ‰ç³»ç»Ÿçš„å­¦ä¹ è¿‡ meta ç›¸å…³çš„çŸ¥è¯†ï¼Œè¿™äº›ä¸œè¥¿è™½ç„¶ç®€å•ï¼Œä½†æ˜¯å¾ˆå¤šæ—¶å€™èƒ½å‘æŒ¥å‡ºæ„æƒ³ä¸åˆ°çš„æ•ˆæœï¼Œå°¤å…¶å¯¹äº SEO æœ‰éå¸¸é‡è¦çš„ä½œç”¨ã€‚</p><h2>meta ç®€ä»‹</h2><p>meta æ ‡ç­¾ä½äºæ–‡æ¡£çš„å¤´éƒ¨ï¼Œå¯æä¾›æœ‰å…³é¡µé¢çš„å…ƒä¿¡æ¯ï¼ˆmeta-informationï¼‰ã€‚ meta æ ‡ç­¾æœ¬èº«ä¸åŒ…å«ä»»ä½•å†…å®¹ï¼Œé€šè¿‡å…¶å±æ€§å®šä¹‰äº†ä¸æ–‡æ¡£ç›¸å…³è”çš„å†…å®¹ã€‚</p><p>meta æ ‡ç­¾ä¸€å…±æœ‰äº”ä¸ªå±æ€§å€¼ï¼š charsetã€contentã€http-equivã€nameã€schemeã€‚ å…¶ä¸­ http-equiv å’Œ name<br>å¿…é¡»ä¸ content é…åˆç»„æˆé”®å€¼å¯¹ä½¿ç”¨ï¼Œ charset ä¸º HTML5 å±æ€§ï¼Œ scheme å±æ€§ HTML5 ä¸æ”¯æŒã€‚</p><a id="more"></a><h3>charset</h3><p>å®šä¹‰ HTML æ–‡æ¡£ç¼–ç æ–¹å¼ï¼Œä¸€èˆ¬ä½¿ç”¨ä¸–ç•Œé€šç”¨è¯­è¨€ç¼–ç  UTF-8ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨ HTML4 ä¸­çš„å†™æ³•æ˜¯</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span></span><br></pre></td></tr></table></figure><h3>http-equiv</h3><p>http-equiv ä¸ºæšä¸¾å±æ€§ï¼Œä¸ content å±æ€§ç»„æˆé”®å€¼å¯¹ï¼Œä¸€èˆ¬ç”¨äºæœåŠ¡å™¨å‘æµè§ˆå™¨ä¼ å›ä¸€äº›ç‰¹å®šçš„ä¿¡æ¯ï¼Œä»¥å¸®åŠ©æµè§ˆå™¨ç¼–è¯‘å’Œæ˜¾ç¤ºé¡µé¢å†…å®¹ã€‚è™½ç„¶æœ‰äº›æœåŠ¡å™¨ä¼šå‘é€è®¸å¤šè¿™ç§é”®å€¼å¯¹ï¼Œä½†æ˜¯æ‰€æœ‰æœåŠ¡å™¨éƒ½è‡³å°‘è¦å‘é€ä¸€ä¸ªï¼š<code>content-type:text/html</code>ã€‚è¿™å°†å‘Šè¯‰æµè§ˆå™¨å‡†å¤‡æ¥æ”¶ä¸€ä¸ª HTML æ–‡æ¡£ã€‚</p><p>http-equiv å¯æšä¸¾çš„å€¼æœ‰ï¼š content-type, default-style, refreshã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"refresh"</span> <span class="attr">content</span>=<span class="string">"3;URL=https://lz5z.com"</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šè¡¨ç¤ºé¡µé¢ 3 ç§’åè‡ªåŠ¨è·³è½¬ã€‚</p><h3>name</h3><p>name å±æ€§æ˜¯ç”¨çš„æœ€å¤šçš„å±æ€§ï¼Œå¸¸ç”¨çš„æœ‰ descriptionï¼Œkeywordsï¼Œauthorï¼Œviewportï¼Œgenerator ç­‰ç­‰ã€‚</p><p>å…¶ä¸­ keywords å¯¹åº” content ç”¨é€—å·åˆ†éš”ï¼Œdescription ä¸ºæœç´¢å¼•æ“æ˜¾ç¤ºç½‘é¡µæ—¶å€™çš„ç®€ä»‹ã€‚</p><p>viewport ç”¨äºæŒ‡å®šè§†çª—çš„å±æ€§ï¼Œåœ¨ç§»åŠ¨ç«¯å¼€å‘æ—¶æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"keywords"</span> <span class="attr">content</span>=<span class="string">"HTML5,meta"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"description"</span> <span class="attr">content</span>=<span class="string">"blabla"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸€äº›å±æ€§å€¼ï¼Œæ¯”å¦‚ referrerï¼Œrobotsï¼Œrendererã€‚</p><p>(1) referrer æ§åˆ¶æ‰€æœ‰ä»è¯¥æ–‡æ¡£å‘å‡ºçš„ HTTP è¯·æ±‚ä¸­ HTTP Referer å¤´çš„å†…å®¹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"referer"</span> <span class="attr">content</span>=<span class="string">"always"</span>&gt;</span></span><br></pre></td></tr></table></figure><p>referrer å¯¹åº”çš„ content å±æ€§å¯å–çš„å€¼ï¼š</p><ul><li><code>no-referrer</code>ä¸è¦å‘é€ HTTP Referer é¦–éƒ¨ã€‚</li><li><code>origin</code>å‘é€å½“å‰æ–‡æ¡£çš„ originã€‚</li><li><code>no-referrer-when-downgrade</code>å½“ç›®çš„åœ°æ˜¯å…ˆéªŒå®‰å…¨çš„(https-&gt;https)åˆ™å‘é€ origin ä½œä¸º referrer ï¼Œä½†æ˜¯å½“ç›®çš„åœ°æ˜¯è¾ƒä¸å®‰å…¨çš„ (https-&gt;http)æ—¶åˆ™ä¸å‘é€ referrer ã€‚è¿™ä¸ªæ˜¯é»˜è®¤çš„è¡Œä¸ºã€‚</li><li><code>origin-when-crossorigin</code>åœ¨åŒæºè¯·æ±‚ä¸‹ï¼Œå‘é€å®Œæ•´çš„URL (ä¸å«æŸ¥è¯¢å‚æ•°) ï¼Œå…¶ä»–æƒ…å†µä¸‹åˆ™ä»…å‘é€å½“å‰æ–‡æ¡£çš„ originã€‚</li><li><code>unsafe-URL</code>åœ¨åŒæºè¯·æ±‚ä¸‹ï¼Œå‘é€å®Œæ•´çš„URL (ä¸å«æŸ¥è¯¢å‚æ•°)ã€‚</li></ul><blockquote><p>HTTP Referer å¤´ï¼š<br>Referer è¯·æ±‚å¤´å­—æ®µå…è®¸ç”±å®¢æˆ·ç«¯æŒ‡å®šèµ„æºçš„ URI æ¥è‡ªäºå“ªä¸€ä¸ªè¯·æ±‚åœ°å€ï¼Œè¿™å¯¹æœåŠ¡å™¨æœ‰å¥½å¤„ã€‚Referer è¯·æ±‚å¤´è®©æœåŠ¡å™¨èƒ½å¤Ÿæ‹¿åˆ°è¯·æ±‚èµ„æºçš„æ¥æºï¼Œå¯ä»¥ç”¨äºåˆ†æç”¨æˆ·çš„å…´è¶£çˆ±å¥½ã€æ”¶é›†æ—¥å¿—ã€ä¼˜åŒ–ç¼“å­˜ç­‰ç­‰ã€‚åŒæ—¶ä¹Ÿè®©æœåŠ¡å™¨èƒ½å¤Ÿå‘ç°è¿‡æ—¶çš„å’Œé”™è¯¯çš„é“¾æ¥å¹¶åŠæ—¶ç»´æŠ¤ã€‚</p></blockquote><p>æ³¨æ„ï¼šåŠ¨æ€åœ°æ’å…¥ <code>&lt;meta name=&quot;referrer&quot;&gt;</code> (é€šè¿‡ document.write æˆ–è€… appendChild) æ˜¯ä¸èµ·ä½œç”¨çš„ã€‚åŒæ ·æ³¨æ„å¦‚æœåŒæ—¶æœ‰å¤šä¸ªå½¼æ­¤å†²çªçš„ç­–ç•¥è¢«å®šä¹‰ï¼Œé‚£ä¹ˆ no-referrer ç­–ç•¥ä¼šç”Ÿæ•ˆã€‚</p><p>(2) robots ç”¨æ¥å‘Šè¯‰æœç´¢å¼•æ“çš„çˆ¬è™«å“ªäº›é¡µé¢éœ€è¦ç´¢å¼•ï¼Œå“ªäº›ä¸éœ€è¦ç´¢å¼•ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"robots"</span> <span class="attr">content</span>=<span class="string">"all"</span>&gt;</span></span><br></pre></td></tr></table></figure><p>robots å¯¹åº”çš„ content å¯å–çš„å€¼ï¼š</p><ul><li>allï¼šæ–‡ä»¶å°†è¢«æ£€ç´¢ï¼Œä¸”é¡µé¢ä¸Šçš„é“¾æ¥å¯ä»¥è¢«æŸ¥è¯¢ã€‚</li><li>noneï¼šæ–‡ä»¶å°†ä¸è¢«æ£€ç´¢ï¼Œä¸”é¡µé¢ä¸Šçš„é“¾æ¥ä¸å¯ä»¥è¢«æŸ¥è¯¢ã€‚</li><li>indexï¼šæ–‡ä»¶å°†è¢«æ£€ç´¢ã€‚</li><li>followï¼šé¡µé¢ä¸Šçš„é“¾æ¥å¯ä»¥è¢«æŸ¥è¯¢ã€‚</li><li>noindexï¼šæ–‡ä»¶å°†ä¸è¢«æ£€ç´¢ï¼Œä½†é¡µé¢ä¸Šçš„é“¾æ¥å¯ä»¥è¢«æŸ¥è¯¢ã€‚</li><li>nofollowï¼šæ–‡ä»¶å°†è¢«æ£€ç´¢ï¼Œä½†é¡µé¢ä¸Šçš„é“¾æ¥ä¸å¯ä»¥è¢«æŸ¥è¯¢ã€‚</li></ul><p>è¿˜æœ‰ä¸€äº›åªæœ‰å›ºå®šçš„æœç´¢å¼•æ“æ”¯æŒçš„å‚æ•°ï¼Œæ¯”å¦‚ noodpï¼Œnoarchive ç­‰ï¼Œè¿™é‡Œå°±ä¸è¯´æ˜äº†ã€‚</p><p>(3) renderer</p><p>renderer å¹¶ä¸æ˜¯ w3c æ ‡å‡†ï¼Œä½†å´ç»å¸¸è§äºä¸€äº›ç½‘é¡µä¸­ï¼Œè¿™ä¸ªå±æ€§ä¸»è¦ç”¨äºåŒæ ¸æˆ–è€…å¤šæ ¸æµè§ˆå™¨ï¼ˆçŒè±¹æµè§ˆå™¨ï¼Œ360æµè§ˆå™¨ï¼‰ä½¿ç”¨æŒ‡å®šçš„å†…æ ¸å¤„ç†è‡ªå·±çš„ç½‘é¡µã€‚ç›®å‰å¤§å¤šæ•° ã€ŒåŒæ ¸ã€ æµè§ˆå™¨å†…éƒ¨çš„ä¸¤ä¸ªå†…æ ¸åˆ†åˆ«æ˜¯ IE å†…æ ¸å’Œ WebKit å†…æ ¸ï¼ŒIE å†…æ ¸ä¸»è¦ç”¨äºå…¼å®¹ã€Œè€ä¸€è¾ˆã€çš„ç½‘é¡µï¼Œä½¿å…¶èƒ½å¤Ÿæ­£å¸¸æ˜¾ç¤ºï¼›WebKit å†…æ ¸åˆ™ç”¨äºæ¸²æŸ“ã€Œæ–°ä¸€ä»£ã€çš„ç½‘é¡µï¼Œä»è€Œå‘æŒ¥å‡ºæ›´å¿«çš„æ˜¾ç¤ºé€Ÿåº¦ã€æ›´å¥½çš„æ˜¾ç¤ºæ•ˆæœã€æ›´ä¼˜å¼‚çš„è„šæœ¬æ‰§è¡Œæ€§èƒ½ã€‚</p><p>ä½œä¸ºç”¨æˆ·æ¥è¯´å¹¶ä¸å…³å¿ƒä½ ä½¿ç”¨å“ªä¸ªå†…æ ¸ï¼Œç®€å•æ˜“ç”¨æ‰æ˜¯ç‹é“ï¼Œå› æ­¤åœ¨ç½‘é¡µä¸­è®¾ç½®é¦–é€‰å†…æ ¸ä¼šè®©ç½‘é¡µæœ‰æ›´å¥½çš„æ•ˆæœã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"renderer"</span> <span class="attr">content</span>=<span class="string">"webkit"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"renderer"</span> <span class="attr">content</span>=<span class="string">"webkit|ie-stand"</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>renderer</code> å¯¹åº”çš„ content ç”¨äºæŒ‡å®šæµè§ˆå™¨å†…æ ¸ï¼Œ<br>webkit(WebKit å†…æ ¸)ã€ie-stand(IE å†…æ ¸-æ ‡å‡†æ¨¡å¼)ã€ie-comp(IE å†…æ ¸-å…¼å®¹æ¨¡å¼)ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥åŒæ—¶æŒ‡å®šå¤šä¸ªå†…æ ¸åç§°ï¼Œä¹‹é—´ä»¥ç¬¦å·&quot;|&quot;è¿›è¡Œåˆ†éš”ï¼Œæ­¤æ—¶æµè§ˆå™¨å°†ä¼šæŒ‰ç…§ä»å·¦åˆ°å³çš„å…ˆåé¡ºåºé€‰æ‹©å…¶å…·å¤‡çš„æ¸²æŸ“å†…æ ¸æ¥å¤„ç†å½“å‰ç½‘é¡µã€‚</p><p>IE8 æœ‰è‡ªå·±ç‹¬ç‰¹çš„å†™æ³• X-UA-Compatible å¯¹äº IE8 ä¹‹å¤–çš„æµè§ˆå™¨æ˜¯ä¸è¯†åˆ«çš„ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// Edge æ¨¡å¼é€šçŸ¥ IE ä»¥æœ€é«˜çº§åˆ«çš„å¯ç”¨æ¨¡å¼æ˜¾ç¤ºå†…å®¹</span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"edge"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">// å¦‚æœ IE æœ‰å®‰è£… Google Chrome Frameï¼Œé‚£ä¹ˆå°±èµ°å®‰è£…çš„ç»„ä»¶ï¼Œå¦‚æœæ²¡æœ‰å°±å’Œä¸Šé¢ä¸€æ ·ã€‚</span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"IE=edge,chrome=1"</span>/&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>æ³¨ï¼š å¦‚æœè®¾ç½®æµè§ˆå™¨å†…æ ¸ä¸º Webkit (æé€Ÿæ¨¡å¼)ï¼Œæ‰“å¼€ç½‘é¡µåå´ä¸º IE (å…¼å®¹æ¨¡å¼)ï¼Œå°è¯•åˆ·æ–°æµè§ˆå™¨åˆ™ä¼šè‡ªåŠ¨åˆ‡æ¢æ¨¡å¼ã€‚</p></blockquote><p>é€šå¸¸æ˜¯è¿™æ ·è®¾ç½®çš„</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"renderer"</span> <span class="attr">content</span>=<span class="string">"webkit"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"IE=edge,chrome=1"</span>&gt;</span></span><br></pre></td></tr></table></figure><p>(4) format-detection</p><p>é˜²æ­¢ ios æŠŠæ•°å­—/å­—ç¬¦ä¸²è¯†åˆ«ä¸ºç”µè¯/é‚®ä»¶/æ—¥æœŸ/åœ°å€</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"format-detection"</span> <span class="attr">content</span>=<span class="string">"telephone=no"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"format-detection"</span> <span class="attr">content</span>=<span class="string">"date=no"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"format-detection"</span> <span class="attr">content</span>=<span class="string">"address=no"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"format-detection"</span> <span class="attr">content</span>=<span class="string">"email=no"</span>&gt;</span></span><br></pre></td></tr></table></figure><h1>å‚è€ƒèµ„æ–™</h1><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/meta" target="_blank" rel="noopener">MDN-meta</a><br><a href="http://web.jobbole.com/86648/" target="_blank" rel="noopener">å…³äºæ§åˆ¶ Referer ä½ æƒ³è¦çŸ¥é“çš„ä¸€åˆ‡</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;å¼•è¨€&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘åšçš„ä¸€ä¸ªå…³äºç”µå½±çš„ç½‘ç«™ &lt;a href=&quot;https://movie.lz5z.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;IMDB Top250&lt;/a&gt;ï¼Œæƒ³å¯¹å…¶è¿›è¡Œ SEO ä¼˜åŒ–ï¼Œç”¨åˆ° meta ä¿¡æ¯çš„æ—¶å€™ï¼Œå¾ˆå¤šçŸ¥è¯†éƒ½æ˜¯ ã€ä¼¼ä¹ã€ã€ã€å¥½åƒã€ã€ã€å¯èƒ½ã€ çš„æ„Ÿè§‰ï¼Œå›æƒ³è‡ªå·±ä¸€ç›´æ²¡æœ‰ç³»ç»Ÿçš„å­¦ä¹ è¿‡ meta ç›¸å…³çš„çŸ¥è¯†ï¼Œè¿™äº›ä¸œè¥¿è™½ç„¶ç®€å•ï¼Œä½†æ˜¯å¾ˆå¤šæ—¶å€™èƒ½å‘æŒ¥å‡ºæ„æƒ³ä¸åˆ°çš„æ•ˆæœï¼Œå°¤å…¶å¯¹äº SEO æœ‰éå¸¸é‡è¦çš„ä½œç”¨ã€‚&lt;/p&gt;
&lt;h2&gt;meta ç®€ä»‹&lt;/h2&gt;
&lt;p&gt;meta æ ‡ç­¾ä½äºæ–‡æ¡£çš„å¤´éƒ¨ï¼Œå¯æä¾›æœ‰å…³é¡µé¢çš„å…ƒä¿¡æ¯ï¼ˆmeta-informationï¼‰ã€‚ meta æ ‡ç­¾æœ¬èº«ä¸åŒ…å«ä»»ä½•å†…å®¹ï¼Œé€šè¿‡å…¶å±æ€§å®šä¹‰äº†ä¸æ–‡æ¡£ç›¸å…³è”çš„å†…å®¹ã€‚&lt;/p&gt;
&lt;p&gt;meta æ ‡ç­¾ä¸€å…±æœ‰äº”ä¸ªå±æ€§å€¼ï¼š charsetã€contentã€http-equivã€nameã€schemeã€‚ å…¶ä¸­ http-equiv å’Œ name&lt;br&gt;
å¿…é¡»ä¸ content é…åˆç»„æˆé”®å€¼å¯¹ä½¿ç”¨ï¼Œ charset ä¸º HTML5 å±æ€§ï¼Œ scheme å±æ€§ HTML5 ä¸æ”¯æŒã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="HTML" scheme="https://lz5z.com/categories/HTML/"/>
    
    
      <category term="HTML5" scheme="https://lz5z.com/tags/HTML5/"/>
    
      <category term="meta" scheme="https://lz5z.com/tags/meta/"/>
    
  </entry>
  
  <entry>
    <title>è¿ç§» github pages åˆ° coding.net</title>
    <link href="https://lz5z.com/%E8%BF%81%E7%A7%BBBlog%E5%88%B0Coding/"/>
    <id>https://lz5z.com/è¿ç§»Blogåˆ°Coding/</id>
    <published>2017-10-27T15:37:59.000Z</published>
    <updated>2020-04-21T10:23:54.831Z</updated>
    
    <content type="html"><![CDATA[<p>ç”±äºä¼—æ‰€å‘¨çŸ¥çš„åŸå› ï¼Œgithub åœ¨å›½å†…æ—¶ä¸æ—¶ä¸èƒ½è®¿é—®ï¼Œè™½ç„¶æœ‰å„ç§åŠæ³•å¯ä»¥è·¨è¶Šå±éšœï¼Œä½†æ˜¯ä½ ä¸èƒ½ç”¨é¢„æµ‹æœªæ¥ä¼šå‘ç”Ÿå“ªäº›äº‹æƒ…ï¼Œäºæ˜¯å†³å®šå°†åšå®¢è¿ç§»åˆ°å›½å†…ï¼Œ<a href="https://coding.net" target="_blank" rel="noopener">coding</a> æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªä¼˜ç‚¹ã€‚</p><ul><li>å›½å†…é€Ÿåº¦æ›´å¿«</li><li>è‡ªå¸¦ SSLï¼Œä¸”å…è´¹</li><li>äº”ä¸ªå…è´¹çš„ç§äººä»“åº“</li><li>åŠŸèƒ½è¾ƒå…¨: pages, webIDE, CI ç­‰</li><li>ç»è¿‡ä¸€æ®µæ—¶é—´è¿­ä»£ï¼Œäº§å“ç»å¾—èµ·è€ƒéªŒ</li></ul><a id="more"></a><h2>æ­¥éª¤</h2><p>é¦–å…ˆç›´æ¥ä» github æŠŠ blog é¡¹ç›®å¯¼å…¥åˆ° codingï¼Œé¡¹ç›®åç§°å‘½åä¸º [name].coding.meï¼Œç›¸å½“äº github ä¸Šé¢çš„ [name].github.ioã€‚</p><p>è¿›å…¥é¡¹ç›®ä»£ç ï¼Œç‚¹å‡»å·¦ä¾§ ã€ä»£ç  -&gt; Pages æœåŠ¡ã€ï¼Œé€‰æ‹©é™æ€ Pages æœåŠ¡ï¼Œcoding éƒ¨ç½²æ¥æºä»…æ”¯æŒ coding-pages åˆ†æ”¯å’Œ master åˆ†æ”¯ï¼Œæ‰€ä»¥é€‰æ‹© master åˆ†æ”¯ã€‚</p><img src="/assets/img/coding.png" alt="æˆ‘æ˜¯ä¸€åªå›¾ç‰‡"><p>è¿™æ—¶ï¼Œé€šè¿‡ [name].coding.me å°±èƒ½å¤Ÿè®¿é—®é¡µé¢äº†ï¼Œä½†æ˜¯è¿™è¿˜è¿œè¿œä¸å¤Ÿï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ·»åŠ è‡ªå®šä¹‰åŸŸåå’Œå¼€å¯ SSL æœåŠ¡ã€‚</p><h2>è‡ªå®šä¹‰åŸŸå SSL</h2><p>é¦–å…ˆç¡®ä¿é¡¹ç›®æ ¹ç›®å½•ä¸­æœ‰ CNAME æ–‡ä»¶ï¼Œé‡Œé¢æ˜¯è‡ªå·±çš„åŸŸåï¼Œæ¯”å¦‚æˆ‘çš„åŸŸå <strong><a href="http://lz5z.com">lz5z.com</a></strong>ï¼Œç„¶ååœ¨ coding é¡µé¢è‡ªå®šä¹‰åŸŸåä¸­è¾“å…¥æ­¤åŸŸåï¼Œå¹¶ä¸”å¼€å¯å¼ºåˆ¶ HTTPS è®¿é—®ã€‚</p><img src="/assets/img/coding_pages.png" alt="æˆ‘æ˜¯ä¸€åªå›¾ç‰‡"><p>ç„¶åå»è‡ªå·±åŸŸåæœåŠ¡å•†é‚£é‡Œä¿®æ”¹ DNS Serverï¼Œæˆ‘çš„åŸŸååœ¨ä¸‡ç½‘è´­ä¹°ï¼Œäºæ˜¯åœ¨ä¸‡ç½‘æ§åˆ¶å°æ·»åŠ ä¸€ä¸ª CNAME è®°å½•å’Œä¸€ä¸ª A è®°å½•ï¼ŒåŠ ä¸Šä¹‹å‰ github pages æ·»åŠ çš„ä¸»æœºè®°å½•ï¼Œæˆªå›¾å¦‚ä¸‹ã€‚</p><img src="/assets/img/coding_dns.png" alt="æˆ‘æ˜¯ä¸€åªå›¾ç‰‡"><p>çº¢è‰²éƒ¨åˆ†ä¸ºæ–°æ·»åŠ çš„è®°å½•ï¼Œå¦‚æœä¸çŸ¥é“ <a href="http://coding.net" target="_blank" rel="noopener">coding.net</a> çš„ ip åœ°å€çš„è¯ï¼Œå¯ä»¥æ‰‹åŠ¨ ping ä¸€ä¸‹ã€‚</p><p>ç”±äºä¹‹å‰ä½¿ç”¨ cloudflare çš„å…è´¹ SSL æœåŠ¡è€Œå°† DNS Server çš„åœ°å€æŒ‡å‘äº† cloudflareï¼Œè¿™ä¸ªæ—¶å€™æŠŠåœ°å€æ”¹å›ä¸‡ç½‘é»˜è®¤é…ç½®å³å¯ã€‚</p><p>ç»è¿‡æ¼«é•¿çš„ç­‰å¾…ï¼ŒDNS è§£æç”Ÿæ•ˆï¼Œæ­¤æ—¶é€šè¿‡ <a href="https://lz5z.com">https://lz5z.com</a> è®¿é—®ï¼Œå‘ç°åŸŸåå·²ç»ç”Ÿæ•ˆäº†ï¼Œä½†æ˜¯å­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼š</p><ul><li>å›½å†…åœ°å€è®¿é—®ç½‘ç«™ï¼Œ SSL æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯å›½å¤–è®¿é—®æ—¶ SSL ä¼šæŠ¥é”™ï¼Œåœ¨ chrome ä¸­æœ‰ä¸€ä¸ªä¸èƒ½å¿å—çš„è­¦å‘Šã€‚</li><li>æ¯æ¬¡è®¿é—®åšå®¢åœ°å€çš„æ—¶å€™ï¼Œé¦–å…ˆä¼šçœ‹åˆ°ä¸€ä¸ª coding çš„å¹¿å‘Šï¼Œç„¶åå†é‡å®šå‘åˆ°è‡ªå·±è¦è®¿é—®çš„åœ°å€ï¼Œè¿™ä¹Ÿæ˜¯ä¸èƒ½å¿å—çš„ã€‚</li></ul><h3>è§£å†³ SSL è¯ä¹¦é”™è¯¯</h3><p>å›½å¤–åœ°å€è®¿é—®ç½‘ç«™æŠ¥ SSL ä¸åˆæ³•ä¸»è¦æ˜¯å› ä¸ºè¿™ä¸ªåŸå› ï¼š</p><blockquote><p>æ³¨æ„ï¼šç”³è¯· SSL/TLS è¯ä¹¦éœ€è¦é€šè¿‡ Letâ€™s Encrypt çš„ HTTP æ–¹å¼éªŒè¯åŸŸåæ‰€æœ‰æƒã€‚å¦‚æœæ‚¨çš„åŸŸååœ¨å¢ƒå¤–æ— æ³•è®¿é—® Coding Pages çš„æœåŠ¡å™¨ï¼Œå°†å¯¼è‡´ SSL/TLS è¯ä¹¦ç”³è¯·å¤±è´¥ã€‚</p></blockquote><p>æŸ¥é˜…èµ„æ–™å‘ç°å¤§å®¶çš„è§£å†³æ–¹å¼éƒ½æ˜¯è®¾ç½®åŒçº¿è§£æï¼Œä¹Ÿå°±æ˜¯å›½å¤–è®¿é—®é€šè¿‡ github pagesï¼Œå›½å†…è®¿é—®é€šè¿‡ <a href="http://coding.net" target="_blank" rel="noopener">coding.net</a>ï¼Œå› æ­¤è¦ä¸ºåŸŸåè®¾ç½®è§£æè·¯çº¿ï¼Œå¦‚æœåŸŸåæœåŠ¡å•†è‡ªå®šä¹‰è§£æè·¯çº¿ï¼Œå¯ä»¥é€‰æ‹©å…è´¹çš„ <a href="https://www.dnspod.cn/" target="_blank" rel="noopener">DNSPod</a> åš DNS è§£æã€‚</p><p>DNSPod æä¾›åŒçº¿è§£æçš„åŸç†æˆ‘ä¸æ˜¯å¾ˆæ˜ç™½ï¼Œè€Œä¸”æ¯”è¾ƒå›°æƒ‘çš„æ˜¯ github pages è‡ªå®šä¹‰åŸŸååŸç”Ÿæ˜¯ä¸èµ„è¾ SSL çš„ï¼Œä¹‹å‰çš„åšæ³•æ˜¯ä½¿ç”¨ cloudflare çš„ SSL æœåŠ¡è¿›è¡Œé‡å®šå‘ï¼Œå‡å¦‚ä½¿ç”¨åŒçº¿è§£æçš„è¯ï¼Œé‚£å›½å¤–åœ°å€ä¸ºä»€ä¹ˆèƒ½å¤Ÿçœ‹åˆ°åˆæ³•çš„ SSL å‘¢ï¼Ÿ</p><p>è€Œä¸”æŒ‰ç…§ç½‘ä¸Šçš„åšæ³•æ”¹äº† DNS è§£æåï¼Œå¹¶æ²¡æœ‰å‘ç”ŸåŒçº¿è§£æï¼Œæ— è®ºæ˜¯å›½å¤–è¿˜æ˜¯å›½å†…éƒ½æ˜¯è§£æåˆ° <a href="http://coding.net" target="_blank" rel="noopener">coding.net</a>ï¼Œä½†æ˜¯è§£å†³äº†å›½å¤–åœ°å€è®¿é—®æŠ¥ SSL è¯ä¹¦é”™è¯¯çš„é—®é¢˜ã€‚ç€å®å¾ˆå¥‡æ€ªï¼Œä»¥ä¸‹æ˜¯æˆ‘çš„åšæ³•ã€‚</p><h3>DNSPod</h3><p>æ³¨å†Œ -&gt; ç™»å½• -&gt; å®åè®¤è¯ -&gt; è¿›å…¥æ§åˆ¶å° -&gt; æ·»åŠ åŸŸå</p><p>æ·»åŠ åŸŸåçš„æ—¶å€™ DNSPod ä¼šè‡ªåŠ¨ç›‘æµ‹åŸŸåä¹‹å‰çš„è§£ææƒ…å†µï¼Œç„¶åç”¨ DNSPod æœåŠ¡å™¨æä¾›çš„ DNS åœ°å€æ›¿ä»£ä¸‡ç½‘æä¾›çš„åœ°å€ã€‚</p><p>DNSPod DNS è®°å½•å¦‚ä¸‹ï¼š</p><img src="/assets/img/coding_dnspod.png" alt="æˆ‘æ˜¯ä¸€åªå›¾ç‰‡"><p>æ›´æ”¹ä¸‡ç½‘ DNS Server ä¸º DNSPod:</p><img src="/assets/img/coding_dnsserver.png" alt="æˆ‘æ˜¯ä¸€åªå›¾ç‰‡"><p>å†æ¬¡ç»è¿‡æ¼«é•¿çš„ç­‰å¾…ï¼ŒDNS ç”Ÿæ•ˆåï¼Œæ— è®ºå›½å†…å›½å¤–è®¿é—®ç½‘ç«™éƒ½æ˜¯åˆæ³•çš„ SSLï¼Œexcitedï¼</p><h3>è§£å†³ coding å¹¿å‘Šåé‡å®šå‘</h3><p>æ¯æ¬¡æ–°å»ºéšç§çª—å£æ‰“å¼€ç½‘ç«™éƒ½æ˜¯å…ˆçœ‹ coding çš„å¹¿å‘Šï¼Œç„¶åå†é‡å®šå‘åˆ°ä¹‹å‰çš„åœ°å€ï¼Œè¿™æ˜¯æå·®çš„ç”¨æˆ·ä½“éªŒï¼Œä¸è¿‡ coding å®˜æ–¹æä¾›äº†è§£å†³åŠæ³•ï¼Œç®€å•çš„å°±æ˜¯è´­ä¹° coding çš„ä¼šå‘˜ï¼Œå…è´¹çš„åŠæ³•å°±æ˜¯åœ¨ç½‘ç«™é¦–é¡µä»»æ„ä½ç½®æ”¾ç½®ã€ŒHosted by Coding Pagesã€çš„æ–‡å­—ç‰ˆæˆ–å›¾ç‰‡ç‰ˆï¼Œå…·ä½“åŠæ³•å‚è€ƒ coding pages æœåŠ¡çš„è¯´æ˜ã€‚æ·»åŠ ä¹‹åå‹¾é€‰ <strong>å·²æ”¾ç½® Hosted by Coding Pages</strong>ï¼Œç­‰å¾…ä¸€å¤©æˆ–è€…ä¸¤å¤©å°±ç”Ÿæ•ˆäº†ã€‚</p><h2>æ€»ç»“</h2><p>è¿™æ¬¡åˆ‡æ¢ github pages åˆ° <a href="http://coding.net" target="_blank" rel="noopener">coding.net</a> çœŸçš„è´¹æ—¶è´¹åŠ›ï¼Œä¸è¿‡å¥½åœ¨ç°åœ¨ç½‘é¡µèƒ½å¤Ÿæ­£å¸¸è®¿é—®ï¼Œè€Œä¸”é€Ÿåº¦ä¹Ÿæ¯”ä¹‹å‰å¿«å¾ˆå¤šï¼Œæ‰€ä»¥è¿˜æ˜¯æ¯”è¾ƒæ»¡æ„çš„ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç”±äºä¼—æ‰€å‘¨çŸ¥çš„åŸå› ï¼Œgithub åœ¨å›½å†…æ—¶ä¸æ—¶ä¸èƒ½è®¿é—®ï¼Œè™½ç„¶æœ‰å„ç§åŠæ³•å¯ä»¥è·¨è¶Šå±éšœï¼Œä½†æ˜¯ä½ ä¸èƒ½ç”¨é¢„æµ‹æœªæ¥ä¼šå‘ç”Ÿå“ªäº›äº‹æƒ…ï¼Œäºæ˜¯å†³å®šå°†åšå®¢è¿ç§»åˆ°å›½å†…ï¼Œ&lt;a href=&quot;https://coding.net&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;coding&lt;/a&gt; æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªä¼˜ç‚¹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å›½å†…é€Ÿåº¦æ›´å¿«&lt;/li&gt;
&lt;li&gt;è‡ªå¸¦ SSLï¼Œä¸”å…è´¹&lt;/li&gt;
&lt;li&gt;äº”ä¸ªå…è´¹çš„ç§äººä»“åº“&lt;/li&gt;
&lt;li&gt;åŠŸèƒ½è¾ƒå…¨: pages, webIDE, CI ç­‰&lt;/li&gt;
&lt;li&gt;ç»è¿‡ä¸€æ®µæ—¶é—´è¿­ä»£ï¼Œäº§å“ç»å¾—èµ·è€ƒéªŒ&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="Blog" scheme="https://lz5z.com/categories/Blog/"/>
    
    
      <category term="github pages" scheme="https://lz5z.com/tags/github-pages/"/>
    
      <category term="coding.net" scheme="https://lz5z.com/tags/coding-net/"/>
    
      <category term="SSL" scheme="https://lz5z.com/tags/SSL/"/>
    
  </entry>
  
  <entry>
    <title>è§£å†³ webpack æ‰“åŒ…å z-index é‡æ–°è®¡ç®—çš„é—®é¢˜</title>
    <link href="https://lz5z.com/%E8%A7%A3%E5%86%B3webpack%E6%89%93%E5%8C%85%E5%90%8Ez-index%E9%87%8D%E6%96%B0%E8%AE%A1%E7%AE%97%E7%9A%84%E9%97%AE%E9%A2%98/"/>
    <id>https://lz5z.com/è§£å†³webpackæ‰“åŒ…åz-indexé‡æ–°è®¡ç®—çš„é—®é¢˜/</id>
    <published>2017-10-24T13:18:37.000Z</published>
    <updated>2020-04-21T10:23:54.831Z</updated>
    
    <content type="html"><![CDATA[<h2>èƒŒæ™¯</h2><p>ä¸ PC ç«¯å…±åŒå¼€å‘ä¸€ä¸ªé¡µé¢ï¼Œé¡µé¢ç”± PC ç«¯æä¾›ï¼Œå†…éƒ¨ iframe åˆ™ç”±æˆ‘ä»¬å‰ç«¯æä¾›ã€‚å¼€å‘æ—¶å€™é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œwebpack æ‰“åŒ…å css çš„ z-index å€¼ä¸åŸå§‹å€¼ä¸ç¬¦ï¼Œå¯¼è‡´ iframe é‡Œé¢çš„ toast è¢«å¤–é¢ z-index è¾ƒå°çš„ dialog è¦†ç›–ã€‚æ›´æ”¹ toast çš„ z-indexï¼Œå‘ç°æ²¡èµ·ä½œç”¨ï¼Œé¡µé¢ä¸Šçš„ z-index ä¾ç„¶æ˜¯ä¹‹å‰çš„å€¼ï¼Œè€Œä¸æ˜¯ css ä¸­èµ‹äºˆçš„å€¼ã€‚ç»™ z-index åŠ ä¸Š !important åä¾ç„¶æ— æ•ˆï¼ŒæŸ¥èµ„æ–™å‘ç°æ˜¯ OptimizeCssAssetsPlugin è°ƒç”¨ cssProcessor cssnano å¯¹ z-index è¿›è¡Œäº†é‡æ–°è®¡ç®—å¯¼è‡´çš„ã€‚</p><p>è¿™æœ¬æ¥æ˜¯ webpack æ’ä»¶çš„ä¸€ä¸ªå–„ä¸¾ï¼ˆè®© z-index æ•°å€¼æ›´åŠ åˆç†ï¼‰ï¼Œä½†æ˜¯å…·ä½“æƒ…å†µæ¥çœ‹ï¼Œè¿™é‡Œæ˜¾ç„¶ä¸éœ€è¦è¿™ä¸ª â€œå–„ä¸¾â€ã€‚</p><a id="more"></a><h2>è§£å†³æ–¹æ¡ˆ</h2><p>è§£å†³æ–¹æ¡ˆæŒ‰ç…§ç½‘ä¸Šçš„èµ„æ–™ï¼Œå¯ä»¥åœ¨ OptimizeCssAssetsPlugin æ’ä»¶ä¸­å…³æ‰ <a href="http://cssnano.co/" target="_blank" rel="noopener">cssnano</a> å¯¹ z-index çš„é‡æ–°è®¡ç®—ï¼ˆcssnano ç§°ä¸º rebaseï¼‰ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> OptimizeCSSPlugin(&#123;</span><br><span class="line">    cssProcessor: <span class="built_in">require</span>(<span class="string">'cssnano'</span>),</span><br><span class="line">    cssProcessorOptions: &#123;</span><br><span class="line">        discardComments: &#123;<span class="attr">removeAll</span>: <span class="literal">true</span>&#125;,</span><br><span class="line">        <span class="comment">// é¿å… cssnano é‡æ–°è®¡ç®— z-index</span></span><br><span class="line">        safe: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    canPrint: <span class="literal">false</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>cssnano å°† z-index rebase å½’ç±»ä¸º unsafeï¼Œåªæœ‰åœ¨å•ä¸ªç½‘é¡µçš„ css å…¨éƒ¨å†™å…¥ä¸€ä¸ª css æ–‡ä»¶ï¼Œå¹¶ä¸”ä¸é€šè¿‡ JavaScript è¿›è¡Œæ”¹åŠ¨æ—¶æ˜¯ safeã€‚</p><p>å‚è€ƒï¼š <a href="http://cssnano.co/optimisations/zindex/" target="_blank" rel="noopener">http://cssnano.co/optimisations/zindex/</a></p><p>cssnano é»˜è®¤è¿›è¡Œ z-index rebaseã€‚</p><p>unsafe (potential bug) ä¼˜åŒ–é¡¹é»˜è®¤ä¸å¼€å¯åº”è¯¥æ¯”è¾ƒå‹å¥½ã€‚</p><h2>å¦å¤–ä¸€ä¸ªæ–¹æ¡ˆ</h2><p>ä»¥ä¸Šæ˜¯ç½‘ä¸Šæä¾›çš„æ–¹æ¡ˆï¼Œè€Œä¸”äº²æµ‹æœ‰æ•ˆï¼Œä½†æ˜¯ç”±äºé¡¹ç›®å¤ªå¤§ï¼Œå› ä¸ºå…¶ä¸­ä¸€ä¸ªå°åŠŸèƒ½æ”¹äº†æ•´ä¸ªé¡¹ç›®çš„ css å¤„ç†ç­–ç•¥ï¼Œéš¾å…æœ‰äº›æ‹…å¿ƒä¼šå½±å“åˆ°å…¶å®ƒé¡µé¢ã€‚æ€è€ƒå†ä¸‰ï¼Œå†³å®šä¸æ”¹ webpack é…ç½®ã€‚</p><p>è§‚å¯Ÿä¹‹å‰é¡¹ç›®ä¸­ä½¿ç”¨çš„æ¡†æ¶ï¼Œåœ¨ç”Ÿæˆ dialog æˆ–è€… toast çš„æ—¶å€™ï¼Œå³ä½¿åœ¨ webpack æ’ä»¶å¯¹ css è¿›è¡Œå¤„ç†ä¹‹åï¼Œå…¶ z-index ä¾ç„¶æ˜¯å¾ˆå¤§çš„ã€‚</p><p>æ¯”å¦‚ element-ui ä¸‹ çš„ popup-manager.js ä¸­é¦–å…ˆè®¾ç½® zIndex ä¸º 2000ï¼Œç„¶ååœ¨ openModal çš„æ—¶å€™åŠ¨æ€æ·»åŠ  css åˆ° DOM ä¸­ï¼Œå¹¶ä¸”æ”¹å˜ zIndex çš„å€¼ï¼Œè€Œåœ¨æµè§ˆå™¨ä¸­è§‚å¯Ÿå¼¹æ¡†çš„ z-indexï¼Œæœç„¶æ˜¯æ²¡æœ‰ç»è¿‡ cssnano rebase çš„ã€‚</p><p>äºæ˜¯ä»¿ç…§ element-ui çš„åšæ³•ï¼ŒæŠŠ z-index ç›¸å…³çš„ css ç”¨ js åŠ¨æ€æ’å…¥åˆ° DOM ä¸­ï¼Œå°±å®Œç¾åœ°è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œå¹¶ä¸”æ²¡æœ‰å¯¹å…¶å®ƒé¡¹ç›®äº§ç”Ÿå½±å“ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ”¹å˜ toast çš„ z-index</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> <span class="title">addToastStyle</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> nod = <span class="built_in">document</span>.createElement(<span class="string">'style'</span>)</span><br><span class="line">    <span class="keyword">let</span> str = <span class="string">`.mint-toast&#123;z-index:2009;&#125;`</span></span><br><span class="line">    nod.type = <span class="string">'text/css'</span></span><br><span class="line">    nod.appendChild(<span class="built_in">document</span>.createTextNode(str))</span><br><span class="line">    <span class="built_in">document</span>.getElementsByTagName(<span class="string">'head'</span>)[<span class="number">0</span>].appendChild(nod)</span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure><h2>æ€»ç»“</h2><p>webpack åœ¨å¯¹ä»£ç è¿›è¡Œæ‰“åŒ…ä¹‹å‰ï¼Œä¼šæ‰«ææ‰€æœ‰çš„æ¨¡å—ï¼Œå»ºç«‹æ¨¡å—ä¹‹é—´çš„ä¾èµ–æ ‘ï¼Œè€Œæ’ä»¶çš„è¿ä½œæ—¶æœºä¹Ÿæ˜¯ç›¸å¯¹äºæ­¤æ—¶çš„é™æ€ä»£ç ï¼Œå› æ­¤ç”¨ js åŠ¨æ€æ’å…¥ cssï¼Œwebpack æ˜¾ç„¶ä¸ä¼šçŸ¥é“è¦æ’å…¥çš„ css æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œå› æ­¤åŠ¨æ€æ’å…¥çš„ css å†…å®¹å°±ä¸ä¼šç»è¿‡æ’ä»¶çš„å¤„ç†ï¼Œä¹Ÿå°±é¿å…äº† OptimizeCssAssetsPlugin çš„ â€œå–„ä¸¾â€ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;èƒŒæ™¯&lt;/h2&gt;
&lt;p&gt;ä¸ PC ç«¯å…±åŒå¼€å‘ä¸€ä¸ªé¡µé¢ï¼Œé¡µé¢ç”± PC ç«¯æä¾›ï¼Œå†…éƒ¨ iframe åˆ™ç”±æˆ‘ä»¬å‰ç«¯æä¾›ã€‚å¼€å‘æ—¶å€™é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œwebpack æ‰“åŒ…å css çš„ z-index å€¼ä¸åŸå§‹å€¼ä¸ç¬¦ï¼Œå¯¼è‡´ iframe é‡Œé¢çš„ toast è¢«å¤–é¢ z-index è¾ƒå°çš„ dialog è¦†ç›–ã€‚æ›´æ”¹ toast çš„ z-indexï¼Œå‘ç°æ²¡èµ·ä½œç”¨ï¼Œé¡µé¢ä¸Šçš„ z-index ä¾ç„¶æ˜¯ä¹‹å‰çš„å€¼ï¼Œè€Œä¸æ˜¯ css ä¸­èµ‹äºˆçš„å€¼ã€‚ç»™ z-index åŠ ä¸Š !important åä¾ç„¶æ— æ•ˆï¼ŒæŸ¥èµ„æ–™å‘ç°æ˜¯ OptimizeCssAssetsPlugin è°ƒç”¨ cssProcessor cssnano å¯¹ z-index è¿›è¡Œäº†é‡æ–°è®¡ç®—å¯¼è‡´çš„ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æœ¬æ¥æ˜¯ webpack æ’ä»¶çš„ä¸€ä¸ªå–„ä¸¾ï¼ˆè®© z-index æ•°å€¼æ›´åŠ åˆç†ï¼‰ï¼Œä½†æ˜¯å…·ä½“æƒ…å†µæ¥çœ‹ï¼Œè¿™é‡Œæ˜¾ç„¶ä¸éœ€è¦è¿™ä¸ª â€œå–„ä¸¾â€ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="webpack" scheme="https://lz5z.com/tags/webpack/"/>
    
      <category term="css" scheme="https://lz5z.com/tags/css/"/>
    
  </entry>
  
  <entry>
    <title>Linux æ–‡ä»¶æƒé™</title>
    <link href="https://lz5z.com/Linux%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90/"/>
    <id>https://lz5z.com/Linuxæ–‡ä»¶æƒé™/</id>
    <published>2017-10-10T19:06:38.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h2>linux æ–‡ä»¶å±æ€§</h2><p>linux ä¸­ç”¨æˆ·ç›¸å¯¹äºæ–‡ä»¶æœ‰ä¸‰ç§èº«ä»½ï¼šownerã€groupã€othersï¼Œæ¯ç§èº«ä»½å„æœ‰ readã€writeã€execute ä¸‰ç§æƒé™ã€‚</p><p>ä½¿ç”¨ <code>ls -l</code> å‘½ä»¤å¯ä»¥æŸ¥çœ‹ä¸æ–‡ä»¶æƒé™ç›¸å…³çš„ä¿¡æ¯ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ls -l</span></span><br><span class="line">drwxr-xr-x  2 lizhen  staff  68 10 10 19:14 foo</span><br><span class="line">-rw-r--r--  1 lizhen  staff   0 10 10 19:14 test.txt</span><br><span class="line">lrwxr-xr-x  1 lizhen  staff  62  7 10 10:01 subl -&gt; /Applications/Sublime Text.app/Contents/SharedSupport/bin/subl</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ç¬¬ä¸€ä¸ªå­—ç¬¦è¡¨ç¤ºæ–‡ä»¶ç±»å‹ï¼šd è¡¨ç¤ºæ–‡ä»¶ä¸ºä¸€ä¸ªç›®å½•ï¼Œ- è¡¨ç¤ºæ–‡ä»¶ä¸ºæ™®é€šæ–‡ä»¶ï¼Œl è¡¨ç¤ºé“¾æ¥ï¼Œ b è¡¨ç¤ºè®¾å¤‡æ–‡ä»¶ã€‚</p><p>æ¥ä¸‹æ¥çš„å­—ç¬¦ä¸­ï¼Œä»¥ä¸‰ä¸ªä¸ºä¸€ç»„ï¼Œä¸”å‡ä¸º r(read)ã€ w(write)ã€ x(execute) ä¸‰ä¸ªå‚æ•°çš„ç»„åˆï¼Œé¦–å…ˆä¸‰ä¸ªå­—ç¬¦è¡¨ç¤ºæ–‡ä»¶æ‰€æœ‰è€…æƒé™ï¼Œåé¢ä¸‰ä¸ªå­—ç¬¦è¡¨ç¤ºç”¨æˆ·ç»„æƒé™ï¼Œæœ€åä¸‰ä¸ªè¡¨ç¤ºå…¶ä»–äººå¯¹æ–‡ä»¶çš„æƒé™ã€‚è¿™ä¸‰ä¸ªæƒé™çš„ä½ç½®ä¸ä¼šæ”¹å˜ï¼Œå¦‚æœæ²¡æœ‰æƒé™ï¼Œå°±ä¼šå‡ºç°å‡å·[ - ]ã€‚</p><img src="/assets/img/linux_permission.png" alt="linux_permission"><p>åé¢çš„å­—æ®µåˆ†åˆ«ä»£è¡¨ï¼šç¡¬é“¾æ¥ä¸ªæ•°ï¼Œæ‰€æœ‰è€…ï¼Œæ‰€åœ¨ç»„ï¼Œæ–‡ä»¶æˆ–è€…ç›®å½•å¤§å°ï¼Œæœ€åè®¿é—®/ä¿®æ”¹æ—¶é—´ï¼Œæ–‡ä»¶æˆ–è€…ç›®å½•åã€‚</p><a id="more"></a><h2>æ›´æ”¹æ–‡ä»¶å±æ€§</h2><p>chgrpï¼šæ”¹å˜æ–‡ä»¶æ‰€å±ç¾¤ç»„ change group<br>chownï¼šæ”¹å˜æ–‡ä»¶æ‹¥æœ‰è€… change owner<br>chmodï¼šæ”¹å˜æ–‡ä»¶çš„æƒé™ change mod</p><h3>chgrp</h3><p>é¦–å…ˆä½¿ç”¨ groups å‘½ä»¤æŸ¥çœ‹å½“å‰ç”¨æˆ·åœ¨å“ªäº›åˆ†ç»„ä¸­ï¼Œç„¶åä½¿ç”¨ chgrp å‘½ä»¤æ”¹å˜æ–‡ä»¶æ‰€å±ç”¨æˆ·ç»„</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> chgrp -R admin foo</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> ls -l </span></span><br><span class="line">drwxr-xr-x  2 lizhen  admin  68 10 10 19:14 foo</span><br></pre></td></tr></table></figure><p>-R è¡¨ç¤ºé€’å½’æ›´æ”¹æ–‡ä»¶å±ç»„ï¼Œå°±æ˜¯åœ¨æ›´æ”¹æŸä¸ªç›®å½•æ–‡ä»¶çš„å±ç»„æ—¶ï¼Œå¦‚æœåŠ ä¸Š -R å‚æ•°ï¼Œé‚£ä¹ˆè¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶çš„å±ç»„éƒ½ä¼šæ›´æ”¹ã€‚å¯ä»¥é€šè¿‡ <code>/etc/group</code> æŸ¥çœ‹å½“å‰ç³»ç»Ÿæ‰€æœ‰çš„åˆ†ç»„ã€‚</p><p>å¯ä»¥çœ‹åˆ°æ–‡ä»¶åˆ†ç»„ç”± staff å˜æˆäº† adminã€‚</p><h3>chown</h3><p>è¯­æ³•</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chown [â€“R] å±ä¸»å æ–‡ä»¶å</span><br><span class="line">chown [-R] å±ä¸»åï¼šå±ç»„å æ–‡ä»¶å</span><br></pre></td></tr></table></figure><p>chown å¯ä»¥æ›´æ”¹æ–‡ä»¶çš„ ownerï¼Œä¹Ÿå¯ä»¥åŒæ—¶æ›´æ”¹æ–‡ä»¶å±ç»„ã€‚å‡å¦‚å½“å‰ç³»ç»Ÿä¸­æœ‰ä¸€ä¸ªåä¸º test çš„ç”¨æˆ·ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sudo chown -R <span class="built_in">test</span> foo</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> ls -l</span></span><br><span class="line">drwxr-xr-x  2 test   admin  68 10 10 19:14 foo</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ foo çš„ owner å˜æˆäº† testã€‚å¯ä»¥é€šè¿‡ <code>/etc/passwd</code> æ–‡ä»¶æŸ¥çœ‹å½“å‰ç³»ç»Ÿæ‰€æœ‰çš„ç”¨æˆ·ã€‚</p><p>chown è¿˜å¯ä»¥ç”¨æˆ·ä¿®æ”¹æ–‡ä»¶æ‰€åœ¨çš„åˆ†ç»„ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sudo chown [-R] lizhen:staff foo</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> ls -l</span></span><br><span class="line">drwxr-xr-x  2 lizhen  staff  68 10 10 19:14 foo</span><br></pre></td></tr></table></figure><p>æ–‡ä»¶å±æ€§åˆå˜å›å»äº†ã€‚</p><h3>chmod</h3><p>chmod ç”¨æ¥æ›´æ”¹æ–‡ä»¶å±æ€§ï¼Œæƒé™å¯ä»¥ä½¿ç”¨ç¬¦å·æˆ–æ•°å­—æ¥è¡¨ç¤ºã€‚</p><p>ä½¿ç”¨ç¬¦å·è¡¨ç¤ºæƒé™ï¼š</p><p>[ + ]ä¸ºæ–‡ä»¶æˆ–ç›®å½•å¢åŠ æƒé™<br>[ - ]åˆ é™¤æ–‡ä»¶æˆ–ç›®å½•çš„æƒé™<br>[ = ]è®¾ç½®æŒ‡å®šçš„æƒé™</p><p>é€šè¿‡ä½¿ç”¨ u(owner)ã€g(group)ã€o(other) æ¥ä»£è¡¨ä¸‰ç§èº«ä»½çš„æƒé™ï¼Œæ­¤å¤– a ä»£è¡¨ allï¼Œå³å…¨éƒ¨èº«ä»½ã€‚</p><p>è¯­æ³•</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod u/g/o/a +/-/= r/w/x filename</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ls -l test.txt</span></span><br><span class="line">-rw-r--r--  1 lizhen  staff  0 10 10 20:33 test.txt</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># ä¿®æ”¹ owner æƒé™å¢åŠ  executeï¼Œgroup å’Œ others å‡å°‘ read</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> chmod u+x,g-r,o-r test.txt </span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> ls -l test.txt</span></span><br><span class="line">-rwx------  1 lizhen  staff  0 10 10 20:33 test.txt</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># ä¿®æ”¹ owner æƒé™ä¸º rwï¼Œgroup å’Œ others ä¸º r</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> chmod u=rw,g=r,o=r test.txt </span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> ls -l test.txt</span></span><br><span class="line">-rw-r--r--  1 lizhen  staff  0 10 10 20:33 test.txt</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># å¢åŠ æ‰€æœ‰ç”¨æˆ·çš„æ‰§è¡Œæƒé™</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> chmod a+x test.txt</span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> ls -l test.txt</span></span><br><span class="line">-rwxr-xr-x  1 lizhen  staff  0 10 10 20:33 test.txt</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ•°å­—æ”¹å˜æƒé™ï¼š</p><p>x: 1<br>w: 2<br>r: 4</p><p>æ‰€ä»¥æƒé™ <code>rwx</code> å°±ç­‰äº <code>4 + 2 + 1 = 7</code>ï¼Œä¹Ÿå°±æ˜¯ <code>chmod a=rwx file</code> ç›¸å½“äº <code>chmod 777 file</code>ã€‚</p><p>-rwâ€”â€”- (600) åªæœ‰æ‰€æœ‰è€…æ‰æœ‰è¯»å’Œå†™çš„æƒé™<br>-rw-râ€“râ€“ (644) åªæœ‰æ‰€æœ‰è€…æ‰æœ‰è¯»å’Œå†™çš„æƒé™ï¼Œç»„ç¾¤å’Œå…¶ä»–äººåªæœ‰è¯»çš„æƒé™<br>-rwxâ€”â€” (700) åªæœ‰æ‰€æœ‰è€…æ‰æœ‰è¯»ï¼Œå†™ï¼Œæ‰§è¡Œçš„æƒé™<br>-rwxr-xr-x (755) åªæœ‰æ‰€æœ‰è€…æ‰æœ‰è¯»ï¼Œå†™ï¼Œæ‰§è¡Œçš„æƒé™ï¼Œç»„ç¾¤å’Œå…¶ä»–äººåªæœ‰è¯»å’Œæ‰§è¡Œçš„æƒé™<br>-rwxâ€“xâ€“x (711) åªæœ‰æ‰€æœ‰è€…æ‰æœ‰è¯»ï¼Œå†™ï¼Œæ‰§è¡Œçš„æƒé™ï¼Œç»„ç¾¤å’Œå…¶ä»–äººåªæœ‰æ‰§è¡Œçš„æƒé™<br>-rw-rw-rw- (666) æ¯ä¸ªäººéƒ½æœ‰è¯»å†™çš„æƒé™<br>-rwxrwxrwx (777) æ¯ä¸ªäººéƒ½æœ‰è¯»å†™å’Œæ‰§è¡Œçš„æƒé™</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> chmod 711 test.txt </span></span><br><span class="line"><span class="meta">$</span><span class="bash"> ls -l test.txt </span></span><br><span class="line">-rwx--x--x  1 lizhen  staff  0 10 10 20:33 test.txt</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;linux æ–‡ä»¶å±æ€§&lt;/h2&gt;
&lt;p&gt;linux ä¸­ç”¨æˆ·ç›¸å¯¹äºæ–‡ä»¶æœ‰ä¸‰ç§èº«ä»½ï¼šownerã€groupã€othersï¼Œæ¯ç§èº«ä»½å„æœ‰ readã€writeã€execute ä¸‰ç§æƒé™ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;ls -l&lt;/code&gt; å‘½ä»¤å¯ä»¥æŸ¥çœ‹ä¸æ–‡ä»¶æƒé™ç›¸å…³çš„ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; ls -l&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;drwxr-xr-x  2 lizhen  staff  68 10 10 19:14 foo&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-rw-r--r--  1 lizhen  staff   0 10 10 19:14 test.txt&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;lrwxr-xr-x  1 lizhen  staff  62  7 10 10:01 subl -&amp;gt; /Applications/Sublime Text.app/Contents/SharedSupport/bin/subl&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å…¶ä¸­ç¬¬ä¸€ä¸ªå­—ç¬¦è¡¨ç¤ºæ–‡ä»¶ç±»å‹ï¼šd è¡¨ç¤ºæ–‡ä»¶ä¸ºä¸€ä¸ªç›®å½•ï¼Œ- è¡¨ç¤ºæ–‡ä»¶ä¸ºæ™®é€šæ–‡ä»¶ï¼Œl è¡¨ç¤ºé“¾æ¥ï¼Œ b è¡¨ç¤ºè®¾å¤‡æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥çš„å­—ç¬¦ä¸­ï¼Œä»¥ä¸‰ä¸ªä¸ºä¸€ç»„ï¼Œä¸”å‡ä¸º r(read)ã€ w(write)ã€ x(execute) ä¸‰ä¸ªå‚æ•°çš„ç»„åˆï¼Œé¦–å…ˆä¸‰ä¸ªå­—ç¬¦è¡¨ç¤ºæ–‡ä»¶æ‰€æœ‰è€…æƒé™ï¼Œåé¢ä¸‰ä¸ªå­—ç¬¦è¡¨ç¤ºç”¨æˆ·ç»„æƒé™ï¼Œæœ€åä¸‰ä¸ªè¡¨ç¤ºå…¶ä»–äººå¯¹æ–‡ä»¶çš„æƒé™ã€‚è¿™ä¸‰ä¸ªæƒé™çš„ä½ç½®ä¸ä¼šæ”¹å˜ï¼Œå¦‚æœæ²¡æœ‰æƒé™ï¼Œå°±ä¼šå‡ºç°å‡å·[ - ]ã€‚&lt;/p&gt;
&lt;img src=&quot;/assets/img/linux_permission.png&quot; alt=&quot;linux_permission&quot;&gt;
&lt;p&gt;åé¢çš„å­—æ®µåˆ†åˆ«ä»£è¡¨ï¼šç¡¬é“¾æ¥ä¸ªæ•°ï¼Œæ‰€æœ‰è€…ï¼Œæ‰€åœ¨ç»„ï¼Œæ–‡ä»¶æˆ–è€…ç›®å½•å¤§å°ï¼Œæœ€åè®¿é—®/ä¿®æ”¹æ—¶é—´ï¼Œæ–‡ä»¶æˆ–è€…ç›®å½•åã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Linux" scheme="https://lz5z.com/categories/Linux/"/>
    
    
      <category term="æƒé™" scheme="https://lz5z.com/tags/%E6%9D%83%E9%99%90/"/>
    
  </entry>
  
  <entry>
    <title>ES2016 å’Œ ES2017 å­¦ä¹ </title>
    <link href="https://lz5z.com/ES2016%E5%92%8CES2017%E5%AD%A6%E4%B9%A0/"/>
    <id>https://lz5z.com/ES2016å’ŒES2017å­¦ä¹ /</id>
    <published>2017-09-12T16:26:44.000Z</published>
    <updated>2020-04-21T10:23:54.823Z</updated>
    
    <content type="html"><![CDATA[<p>ES6 å‘å¸ƒä¹‹åï¼ŒTC-39 å°ç»„æ¯å¹´å‘å¸ƒä¸€æ¬¡ ECMAScript è¯­è¨€æ–°ç‰¹æ€§ï¼Œè¿™ä¸ª repository <a href="https://github.com/tc39/ecma262" target="_blank" rel="noopener">tc39/ecma262</a> ä¸­è®°å½•ç€æœ€æ–°ç‰ˆçš„æè®®ã€‚æ–°ç‰ˆæœ¬çš„ ECMAScript ä½¿ç”¨å¹´ä»½æ¥è¡¨ç¤ºç‰ˆæœ¬ï¼Œæ‰€ä»¥ ES6 è¢«ç§°ä¸º ES2015ï¼Œ ES7 è¢«ç§°ä¸º ES2016ï¼Œæ‰€ä»¥æ ‡å‡†èµ·è§ï¼Œä»¥åæˆ‘ä»¬ä¹Ÿç§°ä¹‹ä¸º ES2016 å’Œ ES2017ã€‚</p><h2>ECMAScript 2016</h2><p>ES2016 åªæœ‰ä¸¤ä¸ªæ–°ç‰¹æ€§</p><ol><li>Array.prototype.includes</li><li>æ±‚å†¥è¿ç®—(Exponentiation Operator)</li></ol><a id="more"></a><h3>Array.prototype.includes</h3><p>includes æŸ¥æ‰¾ä¸€ä¸ªå€¼æ˜¯å¦åœ¨æ•°ç»„ä¸­</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">3</span>)         <span class="comment">//true</span></span><br><span class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>].includes(<span class="string">'d'</span>) <span class="comment">//false</span></span><br></pre></td></tr></table></figure><p>includes è¿˜å¯ä»¥æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªè¡¨ç¤ºè¦æŸ¥æ‰¾çš„å€¼ï¼Œç¬¬äºŒä¸ªè¡¨ç¤ºä»æ•°ç»„ç¬¬ N ä¸ªå…ƒç´ å¼€å§‹æŸ¥æ‰¾ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">2</span>)     <span class="comment">// true</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">4</span>)     <span class="comment">// false</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">3</span>, <span class="number">2</span>)  <span class="comment">// true</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">3</span>, <span class="number">3</span>)  <span class="comment">// false</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">3</span>, <span class="number">-1</span>) <span class="comment">// true</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="literal">NaN</span>].includes(<span class="literal">NaN</span>) <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„ä¸Šé¢ <code>[1, 2, NaN].includes(NaN)</code> çš„è¿”å›å€¼ä¸º trueï¼Œè™½ç„¶ <code>NaN === NaN</code> çš„ç»“æœä¸º falseï¼Œæ‰€ä»¥ã€åŒ…å«ã€å’Œã€ç›¸ç­‰ã€è¿˜æ˜¯æœ‰åŒºåˆ«çš„ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> tt = [<span class="number">-0</span>, <span class="number">1</span>, <span class="literal">NaN</span>]</span><br><span class="line">tt.includes(<span class="number">0</span>)   <span class="comment">// true</span></span><br><span class="line">tt.indexOf(<span class="literal">NaN</span>)  <span class="comment">// -1</span></span><br><span class="line">tt.includes(<span class="literal">NaN</span>) <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>æµ‹è¯•å‘ç° includes å’Œ indexOf åœ¨ node 8 / chrome 61 ä¸‹é€Ÿåº¦å·®å¼‚ä¸å¤§ï¼Œå› æ­¤åœ¨ä½¿ç”¨çš„æ—¶å€™ä¸ç”¨è€ƒè™‘æ€§èƒ½çš„é—®é¢˜ã€‚</p><p>åœ¨ ES2015 ä¸­ï¼ŒString å¯¹è±¡ä¹Ÿæœ‰ includes æ–¹æ³•ï¼ŒString.prototype.includesï¼Œä½†æ˜¯åªèƒ½ç”¨äº Stringï¼Œä¸èƒ½ç”¨äº charactersã€‚</p><h3>å¹‚è¿ç®— Exponentiation operator</h3><p>ES2016 æ–°å¢å¹‚è¿ç®—ç¬¦æ”¹è¿›è¯­æ³•</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span> ** <span class="number">3</span> <span class="comment">// 27</span></span><br><span class="line"><span class="built_in">Math</span>.pow(<span class="number">5</span>, <span class="number">2</span>) === <span class="number">5</span> ** <span class="number">2</span> <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> a = <span class="number">3</span></span><br><span class="line">a **= <span class="number">3</span> <span class="comment">// 27</span></span><br></pre></td></tr></table></figure><p>å¹‚è¿ç®—ç¬¦çš„<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/Operator_Precedence" target="_blank" rel="noopener">ä¼˜å…ˆçº§</a>é«˜äºäºŒå…ƒè¿ç®—ç¬¦ï¼Œä½äºä¸€å…ƒè¿ç®—ç¬¦ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span> * <span class="number">5</span> ** <span class="number">2</span>  <span class="comment">// 50</span></span><br><span class="line">-(<span class="number">5</span> ** <span class="number">2</span>)   <span class="comment">// -25</span></span><br><span class="line">(<span class="number">-5</span>) ** <span class="number">2</span>   <span class="comment">// 25</span></span><br><span class="line"><span class="comment">// è¿ç®—ç¬¦å·¦ä¾§ä¸èƒ½æ˜¯é™¤äº† ++ æˆ– -- ä¹‹å¤–çš„ä»»æ„ä¸€å…ƒè¡¨è¾¾å¼</span></span><br><span class="line"><span class="number">-5</span> ** <span class="number">2</span>     <span class="comment">// Uncaught SyntaxError: Unexpected token ** </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> num = <span class="number">2</span></span><br><span class="line">++num ** <span class="number">2</span>    <span class="comment">// 9</span></span><br><span class="line">num-- ** <span class="number">2</span>    <span class="comment">// 9</span></span><br></pre></td></tr></table></figure><h2>ECMAScript 2017</h2><p>ä¸»è¦æ–°ç‰¹æ€§ï¼š</p><ol><li>å¼‚æ­¥å‡½æ•°(Async/Await)</li><li>å…±äº«å†…å­˜å’ŒåŸå­(Shared memory and atomics)</li></ol><p>å°æ”¹æ¬¾</p><ol><li>Object.values() å’Œ Object.entries()</li><li>å­—ç¬¦ä¸²å¡«å……(padStart å’Œ padEnd)</li><li>Object.getOwnPropertyDescriptors()</li><li>å‡½æ•°å‚æ•°åˆ—è¡¨å’Œè°ƒç”¨ä¸­çš„å°¾é€—å·(Trailing commas)</li></ol><h3>async/await</h3><ul><li>async å‡½æ•°å£°æ˜ï¼š async function foo () {}</li><li>async å‡½æ•°è¡¨è¾¾å¼ï¼š const foo = async function () {}</li><li>async å‡½æ•°å®šä¹‰ï¼š let obj = { async foo () {} }</li><li>async ç®­å¤´å‡½æ•°ï¼š const foo = async () =&gt; {}</li></ul><p>å…³äº async/await å¾ˆæ—©ä»¥å‰å°±å†™è¿‡äº†ï¼Œè€Œä¸”ç°åœ¨åŸºæœ¬ä¸Šå·²ç»æˆäº†å¼‚æ­¥ä»£ç å¿…å¤‡äº†ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†ã€‚</p><p>è¯¦æƒ…å‚è€ƒ<a href="https://lz5z.com/JavaScript%E5%BC%82%E6%AD%A5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/">JavaScriptå¼‚æ­¥è§£å†³æ–¹æ¡ˆasync/await</a></p><h3>å…±äº«å†…å­˜å’ŒåŸå­(Shared memory and atomics)</h3><p>å…±äº«å†…å­˜å’ŒåŸå­å†…å®¹æ¯”è¾ƒå¤šï¼Œåé¢ä¼šå•ç‹¬å†™ä¸€ç¯‡æ–‡ç« ï¼Œæš‚æ—¶ç•™å‘ã€‚</p><h3>Object.entries() å’Œ Object.values()</h3><p>(1) Object.entries()</p><p>è¯¥æ–¹æ³•å°†ä¸€ä¸ªå¯¹è±¡ä¸­æ‰€æœ‰å¯æšä¸¾çš„å±æ€§ä¸å€¼æŒ‰ç…§äºŒç»´æ•°ç»„çš„æ–¹å¼è¿”å›ï¼Œå¦‚æœå¯¹è±¡æ˜¯æ•°ç»„ï¼Œåˆ™æ•°ç»„çš„ä¸‹æ ‡ä½œä¸ºé”®å€¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.entries(&#123; <span class="attr">one</span>: <span class="number">1</span>, <span class="attr">two</span>: <span class="number">2</span>&#125;) <span class="comment">// [['one', 1], ['two', 2]]</span></span><br><span class="line"><span class="built_in">Object</span>.entries([<span class="number">1</span>, <span class="number">2</span>]) <span class="comment">// [['0', 1], ['1', 2]]</span></span><br></pre></td></tr></table></figure><p>è¿”å›æ•°ç»„çš„é¡ºåºä¸ Object.keys() ä¸€è‡´ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;<span class="number">3</span>: <span class="string">'a'</span>, <span class="number">2</span>: <span class="string">'b'</span>, <span class="number">1</span>: <span class="string">'c'</span>&#125;</span><br><span class="line"><span class="built_in">Object</span>.entries(obj)  <span class="comment">// [['1', 'c'], ['2', 'b'], ['3', 'c']]</span></span><br><span class="line"><span class="built_in">Object</span>.keys(obj)     <span class="comment">// ['1', '2', '3']</span></span><br></pre></td></tr></table></figure><p>Object.entries() ä¼šå¿½ç•¥å¯¹è±¡ä¸­ key ä¸º Symbol çš„é”®å€¼å¯¹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.entries(&#123; [<span class="built_in">Symbol</span>()]: <span class="number">123</span>, <span class="attr">foo</span>: <span class="string">'abc'</span> &#125;) <span class="comment">// [ [ 'foo', 'abc' ] ]</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡ Object.entries() è®¾ç½®ä¸€ä¸ª Map å¯¹è±¡ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>(<span class="built_in">Object</span>.entries(&#123;</span><br><span class="line">    one: <span class="number">1</span>,</span><br><span class="line">    two: <span class="number">2</span>,</span><br><span class="line">&#125;))</span><br><span class="line"><span class="built_in">JSON</span>.stringify([...map])  <span class="comment">// [["one",1],["two",2]]</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡ Object.entries() éå†å¯¹è±¡ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123; <span class="attr">one</span>: <span class="number">1</span>, <span class="attr">two</span>: <span class="number">2</span> &#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [k,v] <span class="keyword">of</span> <span class="built_in">Object</span>.entries(obj)) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(k)&#125;</span>: <span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(v)&#125;</span>`</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Output:</span></span><br><span class="line"><span class="comment">// "one": 1</span></span><br><span class="line"><span class="comment">// "two": 2</span></span><br></pre></td></tr></table></figure><p>(2) Object.values()</p><p>è¯¥æ–¹æ³•è¿”å›å¯¹è±¡å¯æšä¸¾é”®å€¼å¯¹ä¸­æ‰€æœ‰çš„ valueã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.values(&#123; <span class="attr">one</span>: <span class="number">1</span>, <span class="attr">two</span>: <span class="number">2</span> &#125;)  <span class="comment">// [ 1, 2 ]</span></span><br></pre></td></tr></table></figure><h3>å­—ç¬¦ä¸²å¡«å……(padStart å’Œ padEnd)</h3><p>(1) String.prototype.padStart</p><p>padStart å‡½æ•°é€šè¿‡å¡«å……å­—ç¬¦ä¸²é¦–éƒ¨ä½¿å­—ç¬¦ä¸²è¾¾åˆ°ä¸€å®šçš„é•¿åº¦ã€‚è¯¥æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªè¡¨ç¤ºç›®æ ‡å­—ç¬¦ä¸²é•¿åº¦ï¼Œç¬¬äºŒä¸ªè¡¨ç¤ºå¡«å……å†…å®¹ï¼Œé»˜è®¤å¡«å……å†…å®¹ä¸ºç©ºæ ¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'abc'</span>.padStart(<span class="number">10</span>)         <span class="comment">// "       abc"</span></span><br><span class="line"><span class="string">'abc'</span>.padStart(<span class="number">10</span>, <span class="string">"foo"</span>)  <span class="comment">// "foofoofabc"</span></span><br><span class="line"><span class="string">'abc'</span>.padStart(<span class="number">6</span>,<span class="string">"123465"</span>) <span class="comment">// "123abc"</span></span><br><span class="line"><span class="string">'abc'</span>.padStart(<span class="number">8</span>, <span class="string">"0"</span>)     <span class="comment">// "00000abc"</span></span><br><span class="line"><span class="string">'abc'</span>.padStart(<span class="number">1</span>)          <span class="comment">// "abc"</span></span><br></pre></td></tr></table></figure><p>(2) String.prototype.padEnd</p><p>padEnd å¡«å……å­—ç¬¦ä¸²çš„æ—¶å€™ä»å°¾éƒ¨å¼€å§‹å¡«å……ï¼Œå…¶å®ƒå‡ä¸ padStart ç›¸åŒã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'abc'</span>.padEnd(<span class="number">10</span>)          <span class="comment">// "abc       "</span></span><br><span class="line"><span class="string">'abc'</span>.padEnd(<span class="number">10</span>, <span class="string">"foo"</span>)   <span class="comment">// "abcfoofoof"</span></span><br><span class="line"><span class="string">'abc'</span>.padEnd(<span class="number">6</span>, <span class="string">"123456"</span>) <span class="comment">// "abc123"</span></span><br><span class="line"><span class="string">'abc'</span>.padEnd(<span class="number">1</span>)           <span class="comment">// "abc"</span></span><br></pre></td></tr></table></figure><h3>Object.getOwnPropertyDescriptors()</h3><p>è¯¥æ–¹æ³•è·å–ç›®æ ‡å¯¹è±¡æ‰€æœ‰å±æ€§çš„å±æ€§æè¿°ç¬¦ï¼Œè¯¥å±æ€§å¿…é¡»æ˜¯è‡ªå·±å®šä¹‰çš„ï¼Œä¸èƒ½æ˜¯é€šè¿‡åŸå‹é“¾ç»§æ‰¿æ¥çš„ã€‚</p><p>å…³äºå±æ€§æè¿°ç¬¦çš„ä½œç”¨ï¼Œå¯ä»¥æŸ¥çœ‹<a href="https://lz5z.com/Object.defineProperty%E4%B8%BA%E5%AF%B9%E8%B1%A1%E5%AE%9A%E4%B9%89%E5%B1%9E%E6%80%A7/">ä½¿ç”¨ Object.defineProperty ä¸ºå¯¹è±¡å®šä¹‰å±æ€§</a></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">    [<span class="built_in">Symbol</span>(<span class="string">'foo'</span>)]: <span class="number">123</span>,</span><br><span class="line">    <span class="keyword">get</span> bar() &#123; <span class="keyword">return</span> <span class="string">'abc'</span> &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.getOwnPropertyDescriptors(obj));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Output:</span></span><br><span class="line"><span class="comment">// &#123; [Symbol('foo')]:</span></span><br><span class="line"><span class="comment">//    &#123; value: 123,</span></span><br><span class="line"><span class="comment">//      writable: true,</span></span><br><span class="line"><span class="comment">//      enumerable: true,</span></span><br><span class="line"><span class="comment">//      configurable: true &#125;,</span></span><br><span class="line"><span class="comment">//   bar:</span></span><br><span class="line"><span class="comment">//    &#123; get: [Function: bar],</span></span><br><span class="line"><span class="comment">//      set: undefined,</span></span><br><span class="line"><span class="comment">//      enumerable: true,</span></span><br><span class="line"><span class="comment">//      configurable: true &#125; &#125;</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ Object.assign() copy ä¸€ä¸ªå¯¹è±¡/å±æ€§ çš„æ—¶å€™ï¼Œä¸èƒ½æ­£ç¡® copy å±æ€§çš„ get å’Œ setï¼Œè€Œé€šè¿‡ getOwnPropertyDescriptors() èƒ½å¤Ÿå®ç°æ­£ç¡® copy ä¸€ä¸ªå¯¹è±¡/å¯¹è±¡å±æ€§ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> Leo =  <span class="built_in">Object</span>.defineProperty(&#123;&#125;, <span class="string">'name'</span>, &#123;</span><br><span class="line">    <span class="keyword">get</span>: function() &#123;</span><br><span class="line">        <span class="keyword">return</span> name</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">set</span>: function(newName) &#123;</span><br><span class="line">        name = newName</span><br><span class="line">    &#125;,</span><br><span class="line">    enumerable: <span class="literal">true</span>,</span><br><span class="line">    configurable: <span class="literal">true</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">const</span> result = &#123;&#125;</span><br><span class="line"><span class="built_in">Object</span>.assign(result, Leo)</span><br><span class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptor(result, <span class="string">'name'</span>)</span><br><span class="line"><span class="comment">// &#123;value: "", writable: true, enumerable: true, configurable: true&#125;</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å‘ç°é€šè¿‡ Object.assign() copy åçš„ â€˜nameâ€™ å±æ€§ï¼Œå…¶ â€˜getâ€™, â€˜setâ€™ å±æ€§ä¸è§äº†</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> result2 = &#123;&#125;</span><br><span class="line"><span class="built_in">Object</span>.defineProperties(result2, <span class="built_in">Object</span>.getOwnPropertyDescriptors(Leo))</span><br><span class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptor(result2, <span class="string">'name'</span>)</span><br><span class="line"><span class="comment">// &#123;enumerable: true, configurable: true, get: Æ’, set: Æ’&#125;</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ Object.getOwnPropertyDescriptors é…åˆ Object.defineProperties å°±å¯ä»¥å®ç°æ­£ç¡® copy äº†ã€‚</p><h3>å‡½æ•°å‚æ•°åˆ—è¡¨å’Œè°ƒç”¨ä¸­çš„å°¾é€—å·(Trailing commas)</h3><p>è¿™ä¸ªæ–°ç‰¹æ€§å¾ˆç®€å•ï¼Œå°±æ˜¯å…è®¸æˆ‘ä»¬åœ¨å®šä¹‰æˆ–è€…è°ƒç”¨å‡½æ•°çš„æ—¶å€™å‚æ•°åé¢å¤šåŠ ä¸€ä¸ªé€—å·è€Œä¸æŠ¥é”™ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span> (<span class="params">a, b,</span>) </span>&#123;&#125; <span class="comment">// correct</span></span><br><span class="line"></span><br><span class="line">foo (<span class="string">'abc'</span>, <span class="string">'def'</span>,)  <span class="comment">// correct</span></span><br></pre></td></tr></table></figure><p>åœ¨æ•°ç»„å’Œå¯¹è±¡ä¸­è¿™æ ·çš„å†™æ³•ä¹Ÿæ²¡æœ‰é—®é¢˜ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>,]</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">first: <span class="string">'Leo'</span>,</span><br><span class="line">last: <span class="string">'Li'</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–°åŠ å…¥è¿™ä¸ªç‰¹æ€§çš„å¥½å¤„å°±æ˜¯å½“æˆ‘ä»¬è°ƒæ•´å‚æ•°æˆ–è€…ä»£ç ç»“æ„çš„æ—¶å€™ï¼Œä¸éœ€è¦å†é¢å¤–åœ°æ·»åŠ æˆ–è€…åˆ é™¤é€—å·äº†ï¼Œå°¤å…¶æ˜¯å¯¹ä»£ç è¿›è¡Œæ³¨é‡Šçš„æ—¶å€™ä¼šæ–¹ä¾¿å¾ˆå¤šã€‚åœ¨ç‰ˆæœ¬ç®¡ç†ä¸Šï¼Œä¸ä¼šå› ä¸ºå‡ºç°ä¸€ä¸ªé€—å·ï¼Œå¯¼è‡´åŸæœ¬åªæœ‰ä¸€è¡Œçš„ä¿®æ”¹å˜æˆä¸¤è¡Œã€‚</p><h2>å‚è€ƒèµ„æ–™</h2><p><a href="http://exploringjs.com/es2016-es2017/" target="_blank" rel="noopener">Exploring ES2016 and ES2017</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ES6 å‘å¸ƒä¹‹åï¼ŒTC-39 å°ç»„æ¯å¹´å‘å¸ƒä¸€æ¬¡ ECMAScript è¯­è¨€æ–°ç‰¹æ€§ï¼Œè¿™ä¸ª repository &lt;a href=&quot;https://github.com/tc39/ecma262&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;tc39/ecma262&lt;/a&gt; ä¸­è®°å½•ç€æœ€æ–°ç‰ˆçš„æè®®ã€‚æ–°ç‰ˆæœ¬çš„ ECMAScript ä½¿ç”¨å¹´ä»½æ¥è¡¨ç¤ºç‰ˆæœ¬ï¼Œæ‰€ä»¥ ES6 è¢«ç§°ä¸º ES2015ï¼Œ ES7 è¢«ç§°ä¸º ES2016ï¼Œæ‰€ä»¥æ ‡å‡†èµ·è§ï¼Œä»¥åæˆ‘ä»¬ä¹Ÿç§°ä¹‹ä¸º ES2016 å’Œ ES2017ã€‚&lt;/p&gt;
&lt;h2&gt;ECMAScript 2016&lt;/h2&gt;
&lt;p&gt;ES2016 åªæœ‰ä¸¤ä¸ªæ–°ç‰¹æ€§&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Array.prototype.includes&lt;/li&gt;
&lt;li&gt;æ±‚å†¥è¿ç®—(Exponentiation Operator)&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="ES7" scheme="https://lz5z.com/tags/ES7/"/>
    
      <category term="ES8" scheme="https://lz5z.com/tags/ES8/"/>
    
      <category term="ES2016" scheme="https://lz5z.com/tags/ES2016/"/>
    
      <category term="ES2017" scheme="https://lz5z.com/tags/ES2017/"/>
    
  </entry>
  
  <entry>
    <title>vue2 ç»„ä»¶é€šä¿¡â€”â€”ä½¿ç”¨ dispatch å’Œ broadcast</title>
    <link href="https://lz5z.com/vue2%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1-%E4%BD%BF%E7%94%A8dispatch%E5%92%8Cbroadcast/"/>
    <id>https://lz5z.com/vue2ç»„ä»¶é€šä¿¡-ä½¿ç”¨dispatchå’Œbroadcast/</id>
    <published>2017-09-01T09:37:44.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨ä½¿ç”¨ <a href="http://element.eleme.io/" target="_blank" rel="noopener">Element</a> è¿‡ç¨‹ä¸­å‘ç°ç»„ä»¶é€šä¿¡å¤§é‡ä½¿ç”¨ <code>dispatch</code> å’Œ <code>broadcast</code> ä¸¤ä¸ªæ–¹æ³•ï¼Œä¹‹å‰åœ¨ <a href="https://lz5z.com/vue2%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1/">vue2 ç»„ä»¶é€šä¿¡</a> ä¹Ÿæåˆ°è¿‡ vue2 ä¸­å–æ¶ˆäº† <code>$dispatch</code> å’Œ <code>$broadcast</code> ä¸¤ä¸ªé‡è¦çš„äº‹ä»¶ï¼Œè€Œ Element é‡æ–°å®ç°äº†è¿™ä¸¤ä¸ªå‡½æ•°ã€‚</p><p>ä»£ç åœ°å€æ”¾åœ¨ <a href="https://github.com/ElemeFE/element/blob/dev/src/mixins/emitter.js" target="_blank" rel="noopener"><code>element-ui/lib/mixins/emitter</code></a></p><a id="more"></a><p><strong>emitter.js</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line"></span><br><span class="line">exports.__esModule = <span class="literal">true</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_broadcast</span>(<span class="params">componentName, eventName, params</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.$children.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">child</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name = child.$options.componentName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (name === componentName) &#123;</span><br><span class="line">      child.$emit.apply(child, [eventName].concat(params));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      _broadcast.apply(child, [componentName, eventName].concat([params]));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line">exports.default = &#123;</span><br><span class="line">  methods: &#123;</span><br><span class="line">    dispatch: <span class="function"><span class="keyword">function</span> <span class="title">dispatch</span>(<span class="params">componentName, eventName, params</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> parent = <span class="keyword">this</span>.$parent || <span class="keyword">this</span>.$root;</span><br><span class="line">      <span class="keyword">var</span> name = parent.$options.componentName;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">while</span> (parent &amp;&amp; (!name || name !== componentName)) &#123;</span><br><span class="line">        parent = parent.$parent;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (parent) &#123;</span><br><span class="line">          name = parent.$options.componentName;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (parent) &#123;</span><br><span class="line">        parent.$emit.apply(parent, [eventName].concat(params));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    broadcast: <span class="function"><span class="keyword">function</span> <span class="title">broadcast</span>(<span class="params">componentName, eventName, params</span>) </span>&#123;</span><br><span class="line">      _broadcast.call(<span class="keyword">this</span>, componentName, eventName, params);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3>è§£æ</h3><p><code>dispatch</code> å’Œ <code>broadcast</code> æ–¹æ³•éƒ½éœ€è¦ 3 ä¸ªå‚æ•°ï¼Œ<code>componentName</code> ç»„ä»¶åç§°ï¼Œ <code>eventName</code> äº‹ä»¶åç§°ï¼Œ <code>params</code> ä¼ é€’çš„å‚æ•°ã€‚</p><p><code>dispatch</code> æ–¹æ³•ä¼šå¯»æ‰¾æ‰€æœ‰çš„çˆ¶ç»„ä»¶ï¼Œç›´åˆ°æ‰¾åˆ°åç§°ä¸º <code>componentName</code> çš„ç»„ä»¶ï¼Œè°ƒç”¨å…¶ <code>$emit()</code> äº‹ä»¶ã€‚<code>broadcast</code> æ–¹æ³•åˆ™æ˜¯éå†å½“å‰ç»„ä»¶çš„æ‰€æœ‰å­ç»„ä»¶ï¼Œæ‰¾åˆ°åç§°ä¸º <code>componentName</code> çš„å­ç»„ä»¶ï¼Œç„¶åè°ƒç”¨å…¶ <code>$emit()</code> äº‹ä»¶ã€‚</p><p>è¿™é‡Œä¹Ÿçœ‹å‡ºäº† Element ä¸­çš„ <code>dispatch</code> ä¸ <code>broadcast</code> çš„ä¸åŒï¼Œvue1 ä¸­çš„ <code>$dispatch</code> å’Œ <code>$broadcast</code> ä¼šå°†äº‹ä»¶é€šçŸ¥ç»™æ‰€æœ‰çš„ çˆ¶/å­ ç»„ä»¶ï¼Œåªè¦å…¶ç›‘å¬äº†ç›¸å…³äº‹ä»¶ï¼Œéƒ½èƒ½å¤Ÿï¼ˆèƒ½å¤Ÿï¼Œä¸æ˜¯ä¸€å®šï¼‰è§¦å‘ï¼›è€Œ Element åˆ™æ›´åƒæ˜¯å®šå‘çˆ†ç ´ï¼ŒæŒ‡å“ªæ‰“å“ªï¼Œå…¶å®æ›´ç¬¦åˆæˆ‘ä»¬æ—¥å¸¸çš„éœ€æ±‚ã€‚</p><h3>ä½¿ç”¨æ–¹å¼</h3><p>å…„å¼Ÿç»„ä»¶ä¹‹é—´çš„é€šä¿¡å¯ä»¥å¾ˆå¥½çš„è¯ é‡Šä¸Šè¿°ä¸¤ä¸ªäº‹ä»¶ã€‚å‡è®¾çˆ¶ç»„ä»¶ <strong>App.vue</strong> ä¸­å¼•å…¥äº†ä¸¤ä¸ªå­ç»„ä»¶ <strong>Hello.vue</strong> å’Œ <strong>Fuck.vue</strong>ã€‚<br>å¦‚æœä½ çš„é¡¹ç›®ä¸­å·§åˆä½¿ç”¨äº† Elementï¼Œé‚£å¯ä»¥æŒ‰ç…§ä¸‹é¢çš„æ–¹å¼å°†å…¶å¼•å…¥è¿›æ¥ï¼Œå¦‚æœæ²¡æœ‰ç”¨ Element ä¹Ÿä¸ç”¨æ‹…å¿ƒï¼Œå¤åˆ¶ä¸Šé¢çš„ <code>emitter.js</code>ï¼Œé€šè¿‡ mixins çš„æ–¹å¼å¼•å…¥å³å¯ã€‚</p><p>åœ¨ <strong>App.vue</strong> ä¸­ç›‘å¬ <code>message</code> äº‹ä»¶ï¼Œæ”¶åˆ°äº‹ä»¶åï¼Œé€šè¿‡ <code>broadcast</code> å’Œæ¥æ”¶åˆ°çš„å‚æ•°ï¼Œå°†äº‹ä»¶å®šå‘ä¼ æ’­ç»™ç›¸å…³ç»„ä»¶ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hello</span>&gt;</span><span class="tag">&lt;/<span class="name">hello</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">fuck</span>&gt;</span><span class="tag">&lt;/<span class="name">fuck</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">import</span> Hello <span class="keyword">from</span> <span class="string">'components/Hello'</span></span></span><br><span class="line"><span class="javascript">  <span class="keyword">import</span> Fuck <span class="keyword">from</span> <span class="string">'components/Fuck'</span></span></span><br><span class="line"><span class="javascript">  <span class="keyword">import</span> Emitter <span class="keyword">from</span> <span class="string">'element-ui/lib/mixins/emitter'</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="actionscript">    name: <span class="string">'app'</span>,</span></span><br><span class="line"><span class="actionscript">    componentName: <span class="string">'ROOT'</span>,</span></span><br><span class="line">    mixins: [Emitter],</span><br><span class="line">    components: &#123;</span><br><span class="line">      Hello,</span><br><span class="line">      Fuck</span><br><span class="line">    &#125;,</span><br><span class="line">    created () &#123;</span><br><span class="line"><span class="actionscript">      <span class="keyword">this</span>.$on(<span class="string">'message'</span>, params =&gt; &#123;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">this</span>.broadcast(params.componentName, params.eventName, params.text)</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>Fuck.vue</strong> ä¸ <strong>Hello.vue</strong> çš„å†…å®¹åŸºæœ¬ç›¸åŒï¼Œä¸‹é¢åªåˆ—å‡º <strong>Fuck.vue</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Emitter <span class="keyword">from</span> <span class="string">'element-ui/lib/mixins/emitter'</span></span><br><span class="line"><span class="keyword">import</span> event <span class="keyword">from</span> <span class="string">'mixins/event'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  componentName: <span class="string">'Fuck'</span>,</span><br><span class="line">  mixins: [Emitter, event],</span><br><span class="line">  data () &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      name: <span class="string">'Fuck'</span>,</span><br><span class="line">      textarea: <span class="string">''</span>,</span><br><span class="line">      tableData: []</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    submit () &#123;</span><br><span class="line">      <span class="keyword">this</span>.communicate(<span class="string">'message'</span>, &#123;</span><br><span class="line">        componentName: <span class="string">'Hello'</span>,</span><br><span class="line">        text: <span class="keyword">this</span>.textarea</span><br><span class="line">      &#125;)</span><br><span class="line">      <span class="keyword">this</span>.textarea = <span class="string">''</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  created () &#123;</span><br><span class="line">    <span class="keyword">this</span>.$on(<span class="string">'message'</span>, text =&gt; &#123;</span><br><span class="line">      <span class="keyword">this</span>.tableData.push(<span class="keyword">this</span>.getMessage(text))</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>mixins/event.js</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Emitter <span class="keyword">from</span> <span class="string">'element-ui/lib/mixins/emitter'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  mixins: [Emitter],</span><br><span class="line">  methods: &#123;</span><br><span class="line">    communicate (event, params = &#123;&#125;) &#123;</span><br><span class="line">      <span class="keyword">this</span>.dispatch(<span class="string">'ROOT'</span>, event, <span class="built_in">Object</span>.assign(&#123;</span><br><span class="line">        eventName: event</span><br><span class="line">      &#125;, params))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Fuck.vue</strong> ä¸­ç›‘å¬äº† <code>message</code> äº‹ä»¶ï¼Œå½“æ”¶åˆ°æ¶ˆæ¯æ—¶ï¼Œå‘ <code>tableData</code> ä¸­åŠ å…¥æ–°çš„å€¼ã€‚è€Œ <code>summit</code> æ–¹æ³•åˆ™è°ƒç”¨ <code>event.js</code> ä¸­çš„ <code>communicate</code> æ–¹æ³•ï¼Œé€šè¿‡ <code>dispatch</code> æ–¹æ³•å°†äº‹ä»¶ä¼ æ’­ç»™ <code>ROOT</code> ç»„ä»¶ã€‚</p><p><a href="https://github.com/Leo555/vue_communication" target="_blank" rel="noopener">å®Œæ•´ä»£ç åœ°å€</a></p><h2>vue ç»„ä»¶é€šä¿¡æ–¹å¼æ€»ç»“</h2><ol><li>çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’ä¿¡æ¯ä½¿ç”¨ props down</li><li>å­ç»„ä»¶å‘çˆ¶ç»„ä»¶ä¼ é€’ä¿¡æ¯ä½¿ç”¨ event up</li><li>å…¶å®ƒå…³ç³»ç±»å‹ç»„ä»¶é€šä¿¡ä½¿ç”¨ global event bus</li><li>å¤§å‹ SPA ç»„ä»¶ä¹‹é—´é€šä¿¡ä½¿ç”¨ Vuex ç®¡ç†ç»„ä»¶çŠ¶æ€</li><li>ä½¿ç”¨ Element ä¸‹ emitter.js ä¸­çš„ dispatch å’Œ broadcast åšäº‹ä»¶å®šå‘ä¼ æ’­</li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ€è¿‘åœ¨ä½¿ç”¨ &lt;a href=&quot;http://element.eleme.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Element&lt;/a&gt; è¿‡ç¨‹ä¸­å‘ç°ç»„ä»¶é€šä¿¡å¤§é‡ä½¿ç”¨ &lt;code&gt;dispatch&lt;/code&gt; å’Œ &lt;code&gt;broadcast&lt;/code&gt; ä¸¤ä¸ªæ–¹æ³•ï¼Œä¹‹å‰åœ¨ &lt;a href=&quot;https://lz5z.com/vue2%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1/&quot;&gt;vue2 ç»„ä»¶é€šä¿¡&lt;/a&gt; ä¹Ÿæåˆ°è¿‡ vue2 ä¸­å–æ¶ˆäº† &lt;code&gt;$dispatch&lt;/code&gt; å’Œ &lt;code&gt;$broadcast&lt;/code&gt; ä¸¤ä¸ªé‡è¦çš„äº‹ä»¶ï¼Œè€Œ Element é‡æ–°å®ç°äº†è¿™ä¸¤ä¸ªå‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;ä»£ç åœ°å€æ”¾åœ¨ &lt;a href=&quot;https://github.com/ElemeFE/element/blob/dev/src/mixins/emitter.js&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;element-ui/lib/mixins/emitter&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Vue" scheme="https://lz5z.com/categories/Vue/"/>
    
    
      <category term="Vue" scheme="https://lz5z.com/tags/Vue/"/>
    
      <category term="dispatch" scheme="https://lz5z.com/tags/dispatch/"/>
    
      <category term="broadcast" scheme="https://lz5z.com/tags/broadcast/"/>
    
  </entry>
  
  <entry>
    <title>å›¾ç‰‡æ‡’åŠ è½½çš„å‡ ç§å®ç°æ–¹å¼</title>
    <link href="https://lz5z.com/%E5%9B%BE%E7%89%87%E6%87%92%E5%8A%A0%E8%BD%BD%E7%9A%84%E5%87%A0%E7%A7%8D%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F/"/>
    <id>https://lz5z.com/å›¾ç‰‡æ‡’åŠ è½½çš„å‡ ç§å®ç°æ–¹å¼/</id>
    <published>2017-08-28T14:55:20.000Z</published>
    <updated>2020-04-21T10:23:54.831Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://lz5z.com/lazyload">demoåœ°å€</a></p><h2>æ‡’åŠ è½½</h2><p>Lazyload å¯ä»¥åŠ å¿«ç½‘é¡µè®¿é—®é€Ÿåº¦ï¼Œå‡å°‘è¯·æ±‚ï¼Œå®ç°æ€è·¯å°±æ˜¯åˆ¤æ–­å›¾ç‰‡å…ƒç´ æ˜¯å¦å¯è§æ¥å†³å®šæ˜¯å¦åŠ è½½å›¾ç‰‡ã€‚å½“å›¾ç‰‡ä½äºæµè§ˆå™¨è§†å£ (viewport) ä¸­æ—¶ï¼ŒåŠ¨æ€è®¾ç½® <code>&lt;img&gt;</code> æ ‡ç­¾çš„ src å±æ€§ï¼Œæµè§ˆå™¨ä¼šæ ¹æ® src å±æ€§å‘é€è¯·æ±‚åŠ è½½å›¾ç‰‡ã€‚</p><h2>æ‡’åŠ è½½å®ç°</h2><p>é¦–å…ˆä¸è®¾ç½® src å±æ€§ï¼Œå°†å›¾ç‰‡çœŸæ­£çš„ url æ”¾åœ¨å¦å¤–ä¸€ä¸ªå±æ€§ data-src ä¸­ï¼Œåœ¨å›¾ç‰‡å³å°†è¿›å…¥æµè§ˆå™¨å¯è§†åŒºåŸŸä¹‹å‰ï¼Œå°† url å–å‡ºæ”¾åˆ° src ä¸­ã€‚</p><p>æ‡’åŠ è½½çš„å…³é”®æ˜¯<strong>å¦‚ä½•åˆ¤æ–­å›¾ç‰‡å¤„äºæµè§ˆå™¨å¯è§†èŒƒå›´å†…</strong>ï¼Œé€šå¸¸æœ‰ä¸‰ç§æ–¹æ³•ï¼š</p><a id="more"></a><h3>æ–¹æ³•ä¸€</h3><p>é€šè¿‡å¯¹æ¯”å±å¹•å¯è§†çª—å£é«˜åº¦å’Œæµè§ˆå™¨æ»šåŠ¨è·ç¦»ä¸å…ƒç´ ç›¸å¯¹æ–‡æ¡£é¡¶éƒ¨çš„è·ç¦»ä¹‹é—´çš„å…³ç³»ï¼Œåˆ¤æ–­å…ƒç´ æ˜¯å¦å¯è§ã€‚</p><p>ç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p><img src="/assets/img/lazyload.svg" alt="lazyload.svg"><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isInSight</span>(<span class="params">el</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> clientHeight = <span class="built_in">window</span>.innerHeight <span class="comment">// è·å–å±å¹•å¯è§†çª—å£é«˜åº¦</span></span><br><span class="line">    <span class="keyword">const</span> scrollTop = <span class="built_in">document</span>.body.scrollTop <span class="comment">// æµè§ˆå™¨çª—å£é¡¶éƒ¨ä¸æ–‡æ¡£é¡¶éƒ¨ä¹‹é—´çš„è·ç¦»</span></span><br><span class="line">    <span class="comment">// el.offsetTop å…ƒç´ ç›¸å¯¹äºæ–‡æ¡£é¡¶éƒ¨çš„è·ç¦» </span></span><br><span class="line">    <span class="comment">// +100æ˜¯ä¸ºäº†æå‰åŠ è½½</span></span><br><span class="line">    <span class="keyword">return</span> el.offsetTop &lt;= clientHeight + scrollTop + <span class="number">100</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3>æ–¹æ³•äºŒ</h3><p>é€šè¿‡ getBoundingClientRect() è·å–å›¾ç‰‡ç›¸å¯¹äºæµè§ˆå™¨è§†çª—çš„ä½ç½®</p><p>ç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p><img src="/assets/img/lazyload1.svg" alt="lazyload1.svg"><p>getBoundingClientRect() æ–¹æ³•è¿”å›ä¸€ä¸ª ClientRect å¯¹è±¡ï¼Œé‡Œé¢åŒ…å«å…ƒç´ çš„ä½ç½®å’Œå¤§å°çš„ä¿¡æ¯</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ClientRect &#123;</span><br><span class="line">bottom: <span class="number">596</span>,</span><br><span class="line">height: <span class="number">596</span>,</span><br><span class="line">left: <span class="number">0</span>,</span><br><span class="line">right: <span class="number">1920</span>,</span><br><span class="line">top: <span class="number">0</span>,</span><br><span class="line">width: <span class="number">1920</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ä½ç½®æ˜¯ç›¸å¯¹äºæµè§ˆå™¨è§†å›¾å·¦ä¸Šè§’è€Œè¨€ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isInSight1</span>(<span class="params">el</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> bound = el.getBoundingClientRect() </span><br><span class="line">    <span class="keyword">const</span> clientHeight = <span class="built_in">window</span>.innerHeight <span class="comment">// è¡¨ç¤ºæµè§ˆå™¨å¯è§†åŒºåŸŸçš„é«˜åº¦</span></span><br><span class="line">    <span class="comment">// bound.top è¡¨ç¤ºå›¾ç‰‡åˆ°å¯è§†åŒºåŸŸé¡¶éƒ¨è·ç¦»</span></span><br><span class="line">    <span class="comment">// +100æ˜¯ä¸ºäº†æå‰åŠ è½½</span></span><br><span class="line">    <span class="keyword">return</span> bound.top &lt;= clientHeight + <span class="number">100</span> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3>æ–¹æ³•ä¸‰</h3><p>ä½¿ç”¨ IntersectionObserver APIï¼Œè§‚å¯Ÿå…ƒç´ æ˜¯å¦å¯è§ã€‚â€œå¯è§â€çš„æœ¬è´¨æ˜¯ç›®æ ‡å…ƒç´ ä¸ viewport æ˜¯å¦æœ‰äº¤å‰åŒºï¼Œæ‰€ä»¥è¿™ä¸ª API å«åšâ€œäº¤å‰è§‚å¯Ÿå™¨â€ã€‚</p><p>å®ç°æ–¹å¼</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadImg</span>(<span class="params">el</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!el.src) &#123;</span><br><span class="line">        <span class="keyword">const</span> source = el.dataset.src</span><br><span class="line">        el.src = source</span><br><span class="line">        el.removeAttribute(<span class="string">'data-src'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> io = <span class="keyword">new</span> IntersectionObserver(<span class="function"><span class="params">entries</span> =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> entry <span class="keyword">of</span> entries) &#123;</span><br><span class="line">        <span class="keyword">const</span> el = entry.target</span><br><span class="line">        <span class="keyword">const</span> intersectionRatio = entry.intersectionRatio</span><br><span class="line">        <span class="keyword">if</span> (intersectionRatio &gt; <span class="number">0</span> &amp;&amp; intersectionRatio &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            loadImg(el)</span><br><span class="line">        &#125;</span><br><span class="line">        el.onload = el.onerror = <span class="function"><span class="params">()</span> =&gt;</span> io.unobserve(el)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkImgs</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> imgs = <span class="built_in">Array</span>.from(<span class="built_in">document</span>.querySelectorAll(<span class="string">'img[data-src]'</span>))</span><br><span class="line">    imgs.forEach(<span class="function"><span class="params">item</span> =&gt;</span> io.observe(item))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2>IntersectionObserver</h2><p>IntersectionObserver çš„ä½œç”¨å°±æ˜¯æ£€æµ‹ä¸€ä¸ªå…ƒç´ æ˜¯å¦å¯è§ï¼Œä»¥åŠå…ƒç´ ä»€ä¹ˆæ—¶å€™è¿›å…¥æˆ–è€…ç¦»å¼€æµè§ˆå™¨è§†å£ã€‚</p><h3>å…¼å®¹æ€§</h3><ul><li>Chrome 51+ï¼ˆå‘å¸ƒäº 2016-05-25ï¼‰</li><li>Android 5+ ï¼ˆChrome 56 å‘å¸ƒäº 2017-02-06ï¼‰</li><li>Edge 15 ï¼ˆ2017-04-11ï¼‰</li><li>iOS ä¸æ”¯æŒ</li></ul><h3>Polyfill</h3><p>WICG æä¾›äº†ä¸€ä¸ª <a href="https://github.com/w3c/IntersectionObserver" target="_blank" rel="noopener">polyfill</a></p><h3>API</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> io = <span class="keyword">new</span> IntersectionObserver(callback, option)</span><br></pre></td></tr></table></figure><p>IntersectionObserver æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¯è§æ€§å˜åŒ–æ—¶çš„å›è°ƒå‡½æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°å®šåˆ¶äº†ä¸€äº›å…³äºå¯è§æ€§çš„å‚æ•°ï¼ˆå¯é€‰ï¼‰ï¼ŒIntersectionObserver å®ä¾‹åŒ–åè¿”å›ä¸€ä¸ªè§‚å¯Ÿå™¨ï¼Œå¯ä»¥æŒ‡å®šè§‚å¯Ÿå“ªäº› DOM èŠ‚ç‚¹ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªæœ€ç®€å•çš„åº”ç”¨ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. è·å– img</span></span><br><span class="line"><span class="keyword">const</span> img = <span class="built_in">document</span>.querySelector(<span class="string">'img'</span>)</span><br><span class="line"><span class="comment">// 2. å®ä¾‹åŒ– IntersectionObserverï¼Œæ·»åŠ  img å‡ºç°åœ¨ viewport ç¬é—´çš„å›è°ƒ</span></span><br><span class="line"><span class="keyword">const</span> observer =  <span class="keyword">new</span> IntersectionObserver(<span class="function"><span class="params">changes</span> =&gt;</span> &#123; </span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'æˆ‘å‡ºç°äº†ï¼'</span>) </span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 3. å¼€å§‹ç›‘å¬ img</span></span><br><span class="line">observer.observe(img)</span><br></pre></td></tr></table></figure><p>(1) callback</p><p>å›è°ƒ callback æ¥å—ä¸€ä¸ªæ•°ç»„ä½œä¸ºå‚æ•°ï¼Œæ•°ç»„å…ƒç´ æ˜¯ IntersectionObserverEntry å¯¹è±¡ã€‚IntersectionObserverEntry å¯¹è±¡ä¸Šæœ‰7ä¸ªå±æ€§ï¼Œ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">IntersectionObserverEntry &#123;</span><br><span class="line">time: <span class="number">72.15500000000002</span>, </span><br><span class="line">rootBounds: ClientRect, </span><br><span class="line">boundingClientRect: ClientRect, </span><br><span class="line">intersectionRatio: <span class="number">0.4502074718475342</span>,</span><br><span class="line">intersectionRect: ClientRect, </span><br><span class="line">isIntersecting: <span class="literal">true</span>,</span><br><span class="line">target: img</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>boundingClientRect: å¯¹ observe çš„å…ƒç´ æ‰§è¡Œ getBoundingClientRect çš„ç»“æœ</li><li>rootBounds: å¯¹æ ¹è§†å›¾æ‰§è¡Œ getBoundingClientRect çš„ç»“æœ</li><li>intersectionRect: ç›®æ ‡å…ƒç´ ä¸è§†å£ï¼ˆæˆ–æ ¹å…ƒç´ ï¼‰çš„äº¤å‰åŒºåŸŸçš„ä¿¡æ¯</li><li>target: observe çš„å¯¹è±¡ï¼Œå¦‚ä¸Šè¿°ä»£ç å°±æ˜¯ img</li><li>time: è¿‡äº†å¤šä¹…æ‰å‡ºç°åœ¨ viewport å†…</li><li>intersectionRatioï¼šç›®æ ‡å…ƒç´ çš„å¯è§æ¯”ä¾‹ï¼ŒintersectionRect å  boundingClientRect çš„æ¯”ä¾‹ï¼Œå®Œå…¨å¯è§æ—¶ä¸º1ï¼Œå®Œå…¨ä¸å¯è§æ—¶å°äºç­‰äº0</li><li>isIntersecting: ç›®æ ‡å…ƒç´ æ˜¯å¦å¤„äºè§†å£ä¸­</li></ul><p>(2) option</p><p>å‡å¦‚æˆ‘ä»¬éœ€è¦ç‰¹æ®Šçš„è§¦å‘æ¡ä»¶ï¼Œæ¯”å¦‚å…ƒç´ å¯è§æ€§ä¸ºä¸€åŠçš„æ—¶å€™è§¦å‘ï¼Œæˆ–è€…æˆ‘ä»¬éœ€è¦æ›´æ”¹æ ¹å…ƒç´ ï¼Œè¿™æ—¶å°±éœ€è¦é…ç½®ç¬¬äºŒä¸ªå‚æ•° option äº†ã€‚</p><p>é€šè¿‡è®¾ç½® option çš„ threshold æ”¹å˜å›è°ƒå‡½æ•°çš„è§¦å‘æ¡ä»¶ï¼Œthreshold æ˜¯ä¸€ä¸ªèŒƒå›´ä¸º0åˆ°1æ•°ç»„ï¼Œé»˜è®¤å€¼æ˜¯[0]ï¼Œä¹Ÿå°±æ˜¯åœ¨å…ƒç´ å¯è§é«˜åº¦å˜ä¸º0æ—¶å°±ä¼šè§¦å‘ã€‚å¦‚æœèµ‹å€¼ä¸º [0, 0.5, 1]ï¼Œé‚£å›è°ƒå°±ä¼šåœ¨å…ƒç´ å¯è§é«˜åº¦æ˜¯0%ï¼Œ50%ï¼Œ100%æ—¶ï¼Œå„è§¦å‘ä¸€æ¬¡å›è°ƒã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> observer =  <span class="keyword">new</span> IntersectionObserver(<span class="function">(<span class="params">changes</span>) =&gt;</span> &#123; </span><br><span class="line">  <span class="built_in">console</span>.log(changes.length); </span><br><span class="line">&#125;, &#123;</span><br><span class="line">  root: <span class="literal">null</span>, </span><br><span class="line">  rootMargin: <span class="string">'20px'</span>, </span><br><span class="line">  threshold: [<span class="number">0</span>, <span class="number">0.5</span>, <span class="number">1</span>]</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>root å‚æ•°é»˜è®¤æ˜¯ nullï¼Œä¹Ÿå°±æ˜¯æµè§ˆå™¨çš„ viewportï¼Œå¯ä»¥è®¾ç½®ä¸ºå…¶å®ƒå…ƒç´ ï¼ŒrootMargin å‚æ•°å¯ä»¥ç»™ root å…ƒç´ æ·»åŠ ä¸€ä¸ª marginï¼Œå¦‚ <code>rootMargin: '20px'</code> æ—¶ï¼Œå›è°ƒä¼šåœ¨å…ƒç´ å‡ºç°å‰ 20px æå‰è°ƒç”¨ï¼Œæ¶ˆå¤±åå»¶è¿Ÿ 20px è°ƒç”¨å›è°ƒã€‚</p><p>(3) è§‚å¯Ÿå™¨</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¼€å§‹è§‚å¯Ÿ</span></span><br><span class="line">io.observe(<span class="built_in">document</span>.getElementById(<span class="string">'root'</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// è§‚å¯Ÿå¤šä¸ª DOM å…ƒç´ </span></span><br><span class="line">io.observe(elementA)</span><br><span class="line">io.observe(elementB)</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœæ­¢è§‚å¯Ÿ</span></span><br><span class="line">io.unobserve(element)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…³é—­è§‚å¯Ÿå™¨</span></span><br><span class="line">io.disconnect()</span><br></pre></td></tr></table></figure><h3>ä½¿ç”¨ IntersectionObserver ä¼˜åŠ¿</h3><p>ä½¿ç”¨å‰ä¸¤ç§æ–¹å¼å®ç° lazyload éƒ½éœ€è¦ç›‘å¬æµè§ˆå™¨ scroll äº‹ä»¶ï¼Œè€Œä¸”è¦å¯¹æ¯ä¸ªç›®æ ‡å…ƒç´ æ‰§è¡Œ getBoundingClientRect() æ–¹æ³•ä»¥è·å–æ‰€éœ€ä¿¡æ¯ï¼Œè¿™äº›ä»£ç éƒ½åœ¨ä¸»çº¿ç¨‹ä¸Šè¿è¡Œï¼Œæ‰€ä»¥å¯èƒ½é€ æˆæ€§èƒ½é—®é¢˜ã€‚</p><p>Intersection Observer API ä¼šæ³¨å†Œä¸€ä¸ªå›è°ƒæ–¹æ³•ï¼Œæ¯å½“æœŸæœ›è¢«ç›‘è§†çš„å…ƒç´ è¿›å…¥æˆ–è€…é€€å‡ºå¦å¤–ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™(æˆ–è€…æµè§ˆå™¨çš„è§†å£)è¯¥å›è°ƒæ–¹æ³•å°†ä¼šè¢«æ‰§è¡Œï¼Œæˆ–è€…ä¸¤ä¸ªå…ƒç´ çš„äº¤é›†éƒ¨åˆ†å¤§å°å‘ç”Ÿå˜åŒ–çš„æ—¶å€™å›è°ƒæ–¹æ³•ä¹Ÿä¼šè¢«æ‰§è¡Œã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œç½‘ç«™å°†ä¸éœ€è¦ä¸ºäº†ç›‘å¬ä¸¤ä¸ªå…ƒç´ çš„äº¤é›†å˜åŒ–è€Œåœ¨ä¸»çº¿ç¨‹é‡Œé¢åšä»»ä½•æ“ä½œï¼Œå¹¶ä¸”æµè§ˆå™¨å¯ä»¥å¸®åŠ©æˆ‘ä»¬ä¼˜åŒ–å’Œç®¡ç†ä¸¤ä¸ªå…ƒç´ çš„äº¤é›†å˜åŒ–ã€‚</p><h2>å‚è€ƒèµ„æ–™</h2><ol><li><a href="https://juejin.im/entry/599a78be6fb9a0247e424d67" target="_blank" rel="noopener">åŸç”Ÿ JS å®ç°æœ€ç®€å•çš„å›¾ç‰‡æ‡’åŠ è½½</a></li><li><a href="https://github.com/justjavac/the-front-end-knowledge-you-may-dont-know/issues/10" target="_blank" rel="noopener">IntersectionObserver</a></li><li><a href="http://www.ruanyifeng.com/blog/2016/11/intersectionobserver_api.html" target="_blank" rel="noopener">IntersectionObserver API ä½¿ç”¨æ•™ç¨‹</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Intersection_Observer_API#Browser_compatibility" target="_blank" rel="noopener">MDN-Intersection Observer API</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://lz5z.com/lazyload&quot;&gt;demoåœ°å€&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;æ‡’åŠ è½½&lt;/h2&gt;
&lt;p&gt;Lazyload å¯ä»¥åŠ å¿«ç½‘é¡µè®¿é—®é€Ÿåº¦ï¼Œå‡å°‘è¯·æ±‚ï¼Œå®ç°æ€è·¯å°±æ˜¯åˆ¤æ–­å›¾ç‰‡å…ƒç´ æ˜¯å¦å¯è§æ¥å†³å®šæ˜¯å¦åŠ è½½å›¾ç‰‡ã€‚å½“å›¾ç‰‡ä½äºæµè§ˆå™¨è§†å£ (viewport) ä¸­æ—¶ï¼ŒåŠ¨æ€è®¾ç½® &lt;code&gt;&amp;lt;img&amp;gt;&lt;/code&gt; æ ‡ç­¾çš„ src å±æ€§ï¼Œæµè§ˆå™¨ä¼šæ ¹æ® src å±æ€§å‘é€è¯·æ±‚åŠ è½½å›¾ç‰‡ã€‚&lt;/p&gt;
&lt;h2&gt;æ‡’åŠ è½½å®ç°&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆä¸è®¾ç½® src å±æ€§ï¼Œå°†å›¾ç‰‡çœŸæ­£çš„ url æ”¾åœ¨å¦å¤–ä¸€ä¸ªå±æ€§ data-src ä¸­ï¼Œåœ¨å›¾ç‰‡å³å°†è¿›å…¥æµè§ˆå™¨å¯è§†åŒºåŸŸä¹‹å‰ï¼Œå°† url å–å‡ºæ”¾åˆ° src ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;æ‡’åŠ è½½çš„å…³é”®æ˜¯&lt;strong&gt;å¦‚ä½•åˆ¤æ–­å›¾ç‰‡å¤„äºæµè§ˆå™¨å¯è§†èŒƒå›´å†…&lt;/strong&gt;ï¼Œé€šå¸¸æœ‰ä¸‰ç§æ–¹æ³•ï¼š&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="lazyload" scheme="https://lz5z.com/tags/lazyload/"/>
    
      <category term="getBoundingClientRect" scheme="https://lz5z.com/tags/getBoundingClientRect/"/>
    
      <category term="IntersectionObserver" scheme="https://lz5z.com/tags/IntersectionObserver/"/>
    
  </entry>
  
  <entry>
    <title>service worker ä½¿ç”¨</title>
    <link href="https://lz5z.com/service-worker%E5%AD%A6%E4%B9%A0/"/>
    <id>https://lz5z.com/service-workerå­¦ä¹ /</id>
    <published>2017-07-09T20:05:46.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h2>service worker ç®€ä»‹</h2><p>service worker çš„åŠŸèƒ½å’Œç‰¹æ€§å¯ä»¥æ€»ç»“ä¸ºä»¥ä¸‹å‡ ç‚¹ï¼š</p><ol><li>service worker æ˜¯ä¸€ä¸ªç‹¬ç«‹ worker çº¿ç¨‹ï¼Œç‹¬ç«‹äºå½“å‰ç½‘é¡µè¿›ç¨‹ï¼Œæœ‰è‡ªå·±ç‹¬ç«‹çš„ worker context</li><li>service worker çš„çº¿ç¨‹èƒ½åŠ›åŸºäº webworker è€Œç”Ÿï¼Œé€šè¿‡ postMessage å’Œ onMessage è¿›è¡Œçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼›ç¼“å­˜æœºåˆ¶æ˜¯ä¾èµ– <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Cache" target="_blank" rel="noopener">cache API</a> å®ç°çš„ã€‚service worker = webworker + cache API</li><li>ä¸€æ—¦è¢« install ä¹‹åï¼Œå°±æ°¸è¿œå­˜åœ¨ï¼Œé™¤éè¢« uninstallï¼›éœ€è¦çš„æ—¶å€™å¯ä»¥ç›´æ¥å”¤é†’ï¼Œä¸éœ€è¦çš„æ—¶å€™è‡ªåŠ¨ç¡çœ </li><li>å¯ä»¥å¯ç¼–ç¨‹æ‹¦æˆªä»£ç†è¯·æ±‚( https è¯·æ±‚)å’Œç¼“å­˜æ–‡ä»¶ï¼Œç¼“å­˜çš„æ–‡ä»¶ç›´æ¥å¯ä»¥è¢«ç½‘é¡µè¿›ç¨‹å–åˆ°ï¼ˆåŒ…æ‹¬ç½‘ç»œç¦»çº¿çŠ¶æ€ï¼‰</li><li>ç¦»çº¿å†…å®¹å¼€å‘è€…å¯æ§ï¼›èƒ½å‘å®¢æˆ·ç«¯æ¨é€æ¶ˆæ¯ï¼›ä¸èƒ½ç›´æ¥æ“ä½œ dom</li><li>å¿…é¡»åœ¨ https ç¯å¢ƒä¸‹æ‰èƒ½å·¥ä½œï¼Œå½“ç„¶ localhost æˆ–è€… 127.0.0.1 ä¹Ÿæ˜¯ ok çš„</li><li>service worker æ˜¯å¼‚æ­¥çš„ï¼Œå†…éƒ¨é€šè¿‡ Promise å®ç°ï¼Œ localStorage æ˜¯åŒæ­¥çš„ï¼Œå› æ­¤ service worker å†…ä¸è®¸ç”¨ä½¿ç”¨ loaclStorage</li><li>ä¾èµ– HTML5 fetch API å’Œ Promise</li></ol><a id="more"></a><h1>service worker ä½¿ç”¨</h1><h2>æ³¨å†Œ</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="string">'serviceWorker'</span> <span class="keyword">in</span> navigator) &#123;</span><br><span class="line">    <span class="built_in">window</span>.addEventListener(<span class="string">'load'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        navigator.serviceWorker.register(<span class="string">'/sw.js'</span>, &#123;<span class="attr">scope</span>: <span class="string">'/'</span>&#125;)</span><br><span class="line">            .then(<span class="function"><span class="keyword">function</span> (<span class="params">registration</span>) </span>&#123;</span><br><span class="line">                <span class="comment">// æ³¨å†ŒæˆåŠŸ</span></span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">'ServiceWorker registration successful with scope: '</span>, </span><br><span class="line">                    registration.scope);</span><br><span class="line">            &#125;)</span><br><span class="line">            .catch(<span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">                <span class="comment">// æ³¨å†Œå¤±è´¥:(</span></span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">'ServiceWorker registration failed: '</span>, err);</span><br><span class="line">            &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¯æ¬¡é¡µé¢åŠ è½½æˆåŠŸåï¼Œå°±ä¼šè°ƒç”¨ register() æ–¹æ³•ï¼Œæµè§ˆå™¨å°†ä¼šåˆ¤æ–­ service worker çº¿ç¨‹æ˜¯å¦å·²æ³¨å†Œå¹¶åšå‡ºç›¸åº”çš„å¤„ç†ã€‚<br>scope å‚æ•°æ˜¯å¯é€‰çš„ï¼Œé»˜è®¤å€¼ä¸º <code>sw.js</code> æ‰€åœ¨çš„æ–‡ä»¶ç›®å½•ã€‚<br>æ‰“å¼€ chrome æµè§ˆå™¨, è¾“å…¥ chrome://inspect/#service-workers å¯ä»¥å¯ä»¥ç”¨ DevTools æŸ¥çœ‹ Service workers çš„å·¥ä½œæƒ…å†µã€‚</p><h2>å®‰è£…</h2><p>service worker æ³¨å†Œåï¼Œæµè§ˆå™¨å°±ä¼šå°è¯•å®‰è£…å¹¶æ¿€æ´»å®ƒï¼Œå¹¶ä¸”åœ¨è¿™é‡Œå®Œæˆé™æ€èµ„æºçš„ç¼“å­˜ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬åœ¨ <code>sw.js</code> ä¸­æ·»åŠ  install äº‹ä»¶</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.addEventListener(<span class="string">'install'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">    event.waitUntil(</span><br><span class="line">        caches.open(<span class="string">'my-test-cache-v1'</span>).then(<span class="function"><span class="keyword">function</span> (<span class="params">cache</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> cache.addAll([</span><br><span class="line">                <span class="string">'/'</span>,</span><br><span class="line">                <span class="string">'/index.html'</span>,</span><br><span class="line">                <span class="string">'/main.css'</span>,</span><br><span class="line">                <span class="string">'/index.js'</span>,</span><br><span class="line">                <span class="string">'/sw-lifecycle.jpg'</span></span><br><span class="line">            ]);</span><br><span class="line">        &#125;)</span><br><span class="line">    );</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>install äº‹ä»¶ä¸€èˆ¬æ˜¯è¢«ç”¨æ¥å®Œæˆæµè§ˆå™¨çš„ç¦»çº¿ç¼“å­˜åŠŸèƒ½ï¼Œservice worker çš„ç¼“å­˜æœºåˆ¶æ˜¯ä¾èµ– <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Cache" target="_blank" rel="noopener">cache API</a> å®ç°çš„ã€‚cache API ä¸ºç»‘å®šåœ¨ service worker ä¸Šçš„å…¨å±€å¯¹è±¡ï¼Œå¯ä»¥ç”¨æ¥å­˜å‚¨ç½‘ç»œå“åº”å‘æ¥çš„èµ„æºï¼Œè¿™äº›èµ„æºåªåœ¨ç«™ç‚¹åŸŸåå†…æœ‰æ•ˆï¼Œå¹¶ä¸”ä¸€ç›´å­˜åœ¨ï¼Œç›´åˆ°ä½ å‘Šè¯‰å®ƒä¸å†å­˜å‚¨ã€‚</p><h3>ç¼“å­˜å’Œè¿”å›è¯·æ±‚</h3><p>æ¯æ¬¡ä»»ä½•è¢« service worker æ§åˆ¶çš„èµ„æºè¢«è¯·æ±‚åˆ°æ—¶ï¼Œéƒ½ä¼šè§¦å‘ fetch äº‹ä»¶ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ fetch äº‹ä»¶å¯¹èµ„æºå“åº”åšä¸€äº›æ‹¦æˆªæ“ä½œ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.addEventListener(<span class="string">'fetch'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">    event.respondWith(</span><br><span class="line">        caches.match(event.request).then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">            <span class="comment">// å¦‚æœ service worker æœ‰è‡ªå·±çš„è¿”å›ï¼Œå°±ç›´æ¥è¿”å›ï¼Œå‡å°‘ä¸€æ¬¡ http è¯·æ±‚</span></span><br><span class="line">            <span class="keyword">if</span> (response) &#123;</span><br><span class="line">                <span class="keyword">return</span> response;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å¦‚æœ service worker æ²¡æœ‰è¿”å›ï¼Œä»æœåŠ¡å™¨è¯·æ±‚èµ„æº</span></span><br><span class="line">            <span class="keyword">var</span> request = event.request.clone(); <span class="comment">// æŠŠåŸå§‹è¯·æ±‚æ‹·è¿‡æ¥</span></span><br><span class="line">            <span class="keyword">return</span> fetch(request).then(<span class="function"><span class="keyword">function</span> (<span class="params">httpRes</span>) </span>&#123;</span><br><span class="line">                <span class="comment">// è¯·æ±‚å¤±è´¥äº†ï¼Œç›´æ¥è¿”å›å¤±è´¥çš„ç»“æœå°±å¥½äº†ã€‚ã€‚</span></span><br><span class="line">                <span class="keyword">if</span> (!httpRes &amp;&amp; httpRes.status !== <span class="number">200</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> response;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// è¯·æ±‚æˆåŠŸçš„è¯ï¼Œå†ä¸€æ¬¡ç¼“å­˜èµ·æ¥ã€‚</span></span><br><span class="line">                <span class="keyword">var</span> responseClone = httpRes.clone();</span><br><span class="line">                caches.open(<span class="string">'my-test-cache-v1'</span>).then(<span class="function"><span class="keyword">function</span> (<span class="params">cache</span>) </span>&#123;</span><br><span class="line">                    cache.put(event.request, responseClone);</span><br><span class="line">                &#125;);</span><br><span class="line">                <span class="keyword">return</span> httpRes;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;)</span><br><span class="line">    );</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¿™æ ·çœ‹æ¥ï¼Œå…¶å®å¯ä»¥æŠŠ service worker ç†è§£ä¸ºä¸€ä¸ªæµè§ˆå™¨ç«¯çš„ä»£ç†æœåŠ¡å™¨ï¼Œè¿™ä¸ªä»£ç†æœåŠ¡å™¨é€šè¿‡ scope å’Œ fetch äº‹ä»¶æ¥ hook ç«™ç‚¹çš„è¯·æ±‚ï¼Œæ¥è¾¾åˆ°èµ„æºç¼“å­˜çš„åŠŸèƒ½ã€‚</p><p>æ³¨æ„ï¼šrequest å’Œ response ä¸èƒ½ç›´æ¥ä½¿ç”¨è€Œæ˜¯é€šè¿‡ clone çš„æ–¹å¼ä½¿ç”¨æ˜¯å› ä¸ºä»–ä»¬æ˜¯ streamï¼Œå› æ­¤åªèƒ½ä½¿ç”¨ä¸€æ¬¡ã€‚</p><h3>install vs fetch</h3><ul><li>install çš„ä¼˜ç‚¹æ˜¯ç¬¬äºŒæ¬¡è®¿é—®å³å¯ç¦»çº¿ï¼Œç¼ºç‚¹æ˜¯éœ€è¦å°†éœ€è¦ç¼“å­˜çš„èµ„æº URL åœ¨ç¼–è¯‘æ—¶æ’å…¥åˆ°è„šæœ¬ä¸­ï¼Œå¢åŠ ä»£ç é‡å’Œé™ä½å¯ç»´æŠ¤æ€§ï¼›</li><li>fetch çš„ä¼˜ç‚¹æ˜¯æ— éœ€æ›´æ”¹ç¼–è¯‘è¿‡ç¨‹ï¼Œä¹Ÿä¸ä¼šäº§ç”Ÿé¢å¤–çš„æµé‡ï¼Œç¼ºç‚¹æ˜¯éœ€è¦å¤šä¸€æ¬¡è®¿é—®æ‰èƒ½ç¦»çº¿å¯ç”¨ã€‚</li></ul><h2>service worker æ›´æ–°</h2><p><code>/sw.js</code> æ§åˆ¶ç€é¡µé¢èµ„æºå’Œè¯·æ±‚çš„ç¼“å­˜ï¼Œå¦‚æœ <code>/sw.js</code> éœ€è¦æ›´æ–°åº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p><ul><li>service worker æ§åˆ¶ç€æ•´ä¸ª App çš„ç¦»çº¿ç¼“å­˜ã€‚ ä¸ºäº†é¿å… service worker ç¼“å­˜è‡ªå·±å¯¼è‡´æ­»é”æ— æ³•å‡çº§ï¼Œé€šå¸¸å°† sw.js æœ¬èº«çš„ç¼“å­˜ç›´æ¥äº¤ç»™ HTTP æœåŠ¡å™¨ç¼“å­˜ã€‚</li><li>æ›´æ–° <code>sw.js</code> æ–‡ä»¶ï¼Œå½“æµè§ˆå™¨è·å–åˆ°äº†æ–°çš„æ–‡ä»¶ï¼Œå‘ç° <code>sw.js</code> æ–‡ä»¶å‘ç”Ÿæ›´æ–°ï¼Œå°±ä¼šå®‰è£…æ–°çš„æ–‡ä»¶å¹¶è§¦å‘ install äº‹ä»¶ã€‚</li><li>ä½†æ˜¯æ­¤æ—¶å·²ç»å¤„äºæ¿€æ´»çŠ¶æ€çš„æ—§çš„ service worker è¿˜åœ¨è¿è¡Œï¼Œæ–°çš„ service worker å®Œæˆå®‰è£…åä¼šè¿›å…¥ waiting çŠ¶æ€ï¼Œç›´åˆ°æ‰€æœ‰å·²æ‰“å¼€çš„é¡µé¢éƒ½å…³é—­ã€‚</li><li>æ–°æœåŠ¡å·¥ä½œçº¿ç¨‹å–å¾—æ§åˆ¶æƒåï¼Œå°†ä¼šè§¦å‘å…¶ activate äº‹ä»¶ã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®‰è£…é˜¶æ®µè·³è¿‡ç­‰å¾…ï¼Œç›´æ¥è¿›å…¥ activate</span></span><br><span class="line">self.addEventListener(<span class="string">'install'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">    event.waitUntil(self.skipWaiting());</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">self.addEventListener(<span class="string">'activate'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">evnet</span>) </span>&#123;</span><br><span class="line">    event.waitUntil(</span><br><span class="line">        <span class="built_in">Promise</span>.all([</span><br><span class="line">            <span class="comment">// æ›´æ–°å®¢æˆ·ç«¯</span></span><br><span class="line">            self.clients.claim(),</span><br><span class="line">            <span class="comment">// æ¸…ç†æ—§ç‰ˆæœ¬</span></span><br><span class="line">            caches.keys().then(<span class="function"><span class="keyword">function</span> (<span class="params">cacheList</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">Promise</span>.all(</span><br><span class="line">                    cacheList.map(<span class="function"><span class="keyword">function</span> (<span class="params">cacheName</span>) </span>&#123;</span><br><span class="line">                        <span class="keyword">if</span> (cacheName !== <span class="string">'my-test-cache-v1'</span>) &#123;</span><br><span class="line">                            <span class="keyword">return</span> caches.delete(cacheName);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;)</span><br><span class="line">                );</span><br><span class="line">            &#125;)</span><br><span class="line">        ])</span><br><span class="line">    );</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šå¦‚æœ <code>sw.js</code> æ–‡ä»¶è¢«æµè§ˆå™¨ç¼“å­˜ï¼Œåˆ™å¯èƒ½å¯¼è‡´æ›´æ–°å¾—ä¸åˆ°å“åº”ã€‚å¦‚é‡åˆ°è¯¥é—®é¢˜ï¼Œå¯å°è¯•è¿™ä¹ˆåšï¼šåœ¨ webserver ä¸Šæ·»åŠ å¯¹è¯¥æ–‡ä»¶çš„è¿‡æ»¤è§„åˆ™ï¼Œä¸ç¼“å­˜æˆ–è®¾ç½®è¾ƒçŸ­çš„æœ‰æ•ˆæœŸã€‚</p><h3>æ‰‹åŠ¨æ›´æ–° /sw.js</h3><p>ä¹Ÿå¯ä»¥å€ŸåŠ© <code>Registration.update()</code> æ‰‹åŠ¨æ›´æ–°</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> version = <span class="string">'1.0.1'</span>;</span><br><span class="line"></span><br><span class="line">navigator.serviceWorker.register(<span class="string">'/sw.js'</span>).then(<span class="function"><span class="keyword">function</span> (<span class="params">reg</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (localStorage.getItem(<span class="string">'sw_version'</span>) !== version) &#123;</span><br><span class="line">        reg.update().then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            localStorage.setItem(<span class="string">'sw_version'</span>, version)</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3>è‡ªåŠ¨æ›´æ–°</h3><p>é™¤äº†æµè§ˆå™¨è§¦å‘æ›´æ–°ä¹‹å¤–ï¼Œservice worker è¿˜æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ç¼“å­˜ç­–ç•¥ï¼š å¦‚æœè¯¥æ–‡ä»¶å·² 24 å°æ—¶æ²¡æœ‰æ›´æ–°ï¼Œå½“ Update è§¦å‘æ—¶ä¼šå¼ºåˆ¶æ›´æ–°ã€‚è¿™æ„å‘³ç€æœ€åæƒ…å†µä¸‹ service worker ä¼šæ¯å¤©æ›´æ–°ä¸€æ¬¡ã€‚</p><h3>è°ƒè¯•æ—¶æ›´æ–°</h3><p>å¯ä»¥å•ç‹¬è®¾ç½®è°ƒè¯•æ—¶ service worker å®‰è£…åç«‹å³æ¿€æ´»ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">self.addEventListener(<span class="string">'install'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    self.skipWaiting();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2>service worker ç”Ÿå‘½å‘¨æœŸ</h2><img src="/assets/img/sw-lifecycle.png" alt="sw-lifecycle"><h3>service worker å·¥ä½œæµç¨‹</h3><p>service worker åŸºäºæ³¨å†Œã€å®‰è£…ã€æ¿€æ´»ç­‰æ­¥éª¤åœ¨æµè§ˆå™¨ js ä¸»çº¿ç¨‹ä¸­ç‹¬ç«‹åˆ†æ‹…ç¼“å­˜ä»»åŠ¡ã€‚</p><ul><li>é¦–å…ˆåœ¨é¡µé¢çš„ javaScript ä¸»çº¿ç¨‹ä¸­ä½¿ç”¨ navigator.serviceWorker.register() æ¥æ³¨å†Œ servcie workerã€‚</li><li>å¦‚æœæ³¨å†ŒæˆåŠŸï¼Œservice worker åœ¨ ServiceWorkerGlobalScope ç¯å¢ƒä¸­è¿è¡Œï¼› è¿™æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ worker contextï¼Œä¸ä¸»è„šæœ¬çš„è¿è¡Œçº¿ç¨‹ç›¸ç‹¬ç«‹ï¼ŒåŒæ—¶ä¹Ÿæ²¡æœ‰è®¿é—® DOM çš„èƒ½åŠ›ã€‚</li><li>åå°å¼€å§‹å®‰è£…æ­¥éª¤ï¼Œé€šå¸¸åœ¨å®‰è£…çš„è¿‡ç¨‹ä¸­éœ€è¦ç¼“å­˜ä¸€äº›é™æ€èµ„æºã€‚install äº‹ä»¶å›è°ƒä¸­æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼š<ul><li>event.waitUntil()ï¼šä¼ å…¥ä¸€ä¸ª Promise ä¸ºå‚æ•°ï¼Œç­‰åˆ°è¯¥ Promise ä¸º resolve çŠ¶æ€ä¸ºæ­¢ã€‚</li><li>self.skipWaiting()ï¼šself æ˜¯å½“å‰ context çš„ global å˜é‡ï¼Œæ‰§è¡Œè¯¥æ–¹æ³•è¡¨ç¤ºå¼ºåˆ¶å½“å‰å¤„åœ¨ waiting çŠ¶æ€çš„ Service Worker è¿›å…¥ activate çŠ¶æ€ã€‚</li></ul></li><li>å½“ service worker å®‰è£…å®Œæˆåï¼Œä¼šæ¥æ”¶åˆ°ä¸€ä¸ªæ¿€æ´»äº‹ä»¶ï¼ˆactivate eventï¼‰ã€‚æ¿€æ´»äº‹ä»¶çš„å¤„ç†å‡½æ•°ä¸­ï¼Œä¸»è¦æ“ä½œæ˜¯æ¸…ç†æ—§ç‰ˆæœ¬çš„ service worker è„šæœ¬ä¸­ä½¿ç”¨èµ„æºã€‚activate å›è°ƒä¸­æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼š<ul><li>event.waitUntil()ï¼šä¼ å…¥ä¸€ä¸ª Promise ä¸ºå‚æ•°ï¼Œç­‰åˆ°è¯¥ Promise ä¸º resolve çŠ¶æ€ä¸ºæ­¢ã€‚</li><li>self.clients.claim()ï¼šåœ¨ activate äº‹ä»¶å›è°ƒä¸­æ‰§è¡Œè¯¥æ–¹æ³•è¡¨ç¤ºå–å¾—é¡µé¢çš„æ§åˆ¶æƒ, è¿™æ ·ä¹‹åæ‰“å¼€é¡µé¢éƒ½ä¼šä½¿ç”¨ç‰ˆæœ¬æ›´æ–°çš„ç¼“å­˜ã€‚æ—§çš„ Service Worker è„šæœ¬ä¸å†æ§åˆ¶ç€é¡µé¢ï¼Œä¹‹åä¼šè¢«åœæ­¢ã€‚</li></ul></li><li>æ¿€æ´»æˆåŠŸå service worker å¯ä»¥æ§åˆ¶é¡µé¢äº†ï¼Œåˆ·æ–°é¡µé¢å¯ä»¥æŸ¥çœ‹ service worker çš„å·¥ä½œæˆæœã€‚</li></ul><h3>service worker äº‹ä»¶</h3><ul><li>install: service worker å®‰è£…æˆåŠŸåè¢«è§¦å‘çš„äº‹ä»¶ï¼Œåœ¨äº‹ä»¶å¤„ç†å‡½æ•°ä¸­å¯ä»¥æ·»åŠ éœ€è¦ç¼“å­˜çš„æ–‡ä»¶ã€‚</li><li>activateï¼šå½“ service worker å®‰è£…å®Œæˆåå¹¶è¿›å…¥æ¿€æ´»çŠ¶æ€ï¼Œä¼šè§¦å‘ activate äº‹ä»¶ã€‚é€šè¿‡ç›‘å¬ activate äº‹ä»¶ä½ å¯ä»¥åšä¸€äº›é¢„å¤„ç†ï¼Œå¦‚å¯¹äºæ—§ç‰ˆæœ¬çš„æ›´æ–°ã€å¯¹äºæ— ç”¨ç¼“å­˜çš„æ¸…ç†ç­‰ã€‚</li><li>messageï¼šservice worker é€šè¿‡ postMessage APIï¼Œå¯ä»¥å®ç°ä¸ä¸»çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚</li></ul><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ service worker çš„ postMessage API åšçš„ä¸€ä¸ªç®€å•è®¡ç®—å™¨ï¼Œå…¶ä¸­è®¡ç®—éƒ¨åˆ†åœ¨ service worker çº¿ç¨‹ä¸­å®Œæˆã€‚å‡å¦‚æœ‰ä¸€äº›æ¯”è¾ƒè€—æ—¶çš„å·¥ä½œï¼Œæ¯”å¦‚å¤§é‡è®¡ç®—ï¼Œæˆ–è€… fetch æ•°æ®ï¼Œå¯ä»¥å°†å…¶æ”¾å…¥ service worker çº¿ç¨‹ä¸­ï¼Œä»¥è¾¾åˆ°æé«˜é¡µé¢å“åº”çš„ç›®çš„ã€‚</p><iframe defer src="https://lz5z.com/service_worker_postMessage/" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="width:500px;height:50px;" width="500" height="50" allowtransparency="true"></iframe><p><a href="https://lz5z.com/service_worker_postMessage/">åœ¨çº¿æ¼”ç¤º</a><br><a href="https://github.com/Leo555/service_worker_postMessage" target="_blank" rel="noopener">æºç </a></p><ul><li>fetch (è¯·æ±‚)ï¼šå½“æµè§ˆå™¨åœ¨å½“å‰æŒ‡å®šçš„ scope ä¸‹å‘èµ·è¯·æ±‚æ—¶ï¼Œä¼šè§¦å‘ fetch äº‹ä»¶ï¼Œå¹¶å¾—åˆ°ä¼ æœ‰ response å‚æ•°çš„å›è°ƒå‡½æ•°ï¼Œå›è°ƒä¸­å°±å¯ä»¥åšå„ç§ä»£ç†ç¼“å­˜çš„äº‹æƒ…äº†ã€‚</li><li>push (æ¨é€)ï¼špush äº‹ä»¶æ˜¯ä¸ºæ¨é€å‡†å¤‡çš„ã€‚ä¸è¿‡é¦–å…ˆéœ€è¦äº†è§£ä¸€ä¸‹ <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/notification" target="_blank" rel="noopener">Notification API</a> å’Œ <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Push_API" target="_blank" rel="noopener">PUSH API</a>ã€‚é€šè¿‡ PUSH APIï¼Œå½“è®¢é˜…äº†æ¨é€æœåŠ¡åï¼Œå¯ä»¥ä½¿ç”¨æ¨é€æ–¹å¼å”¤é†’ Service Worker ä»¥å“åº”æ¥è‡ªç³»ç»Ÿæ¶ˆæ¯ä¼ é€’æœåŠ¡çš„æ¶ˆæ¯ï¼Œå³ä½¿ç”¨æˆ·å·²ç»å…³é—­äº†é¡µé¢ã€‚</li></ul><h2>ç¤ºä¾‹</h2><p>è¿™ä¸ª<a href="http://service-worker.org/" target="_blank" rel="noopener">ç½‘ç«™</a>è®°å½•äº†å¾ˆå¤š service worker demoã€‚</p><h2>å‚è€ƒæ–‡æ¡£</h2><ul><li><a href="https://lavas.baidu.com/doc/offline-and-cache-loading/service-worker/service-worker-introduction" target="_blank" rel="noopener">lavas</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Service_Worker_API" target="_blank" rel="noopener">Service Worker API-MDN</a></li><li><a href="https://developers.google.com/web/fundamentals/getting-started/primers/service-workers?hl=zh-cn" target="_blank" rel="noopener">æœåŠ¡å·¥ä½œçº¿ç¨‹</a></li><li><a href="http://harttle.com/2017/04/10/service-worker-update.html" target="_blank" rel="noopener">Service Worker æ›´æ–°æœºåˆ¶</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;service worker ç®€ä»‹&lt;/h2&gt;
&lt;p&gt;service worker çš„åŠŸèƒ½å’Œç‰¹æ€§å¯ä»¥æ€»ç»“ä¸ºä»¥ä¸‹å‡ ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;service worker æ˜¯ä¸€ä¸ªç‹¬ç«‹ worker çº¿ç¨‹ï¼Œç‹¬ç«‹äºå½“å‰ç½‘é¡µè¿›ç¨‹ï¼Œæœ‰è‡ªå·±ç‹¬ç«‹çš„ worker context&lt;/li&gt;
&lt;li&gt;service worker çš„çº¿ç¨‹èƒ½åŠ›åŸºäº webworker è€Œç”Ÿï¼Œé€šè¿‡ postMessage å’Œ onMessage è¿›è¡Œçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼›ç¼“å­˜æœºåˆ¶æ˜¯ä¾èµ– &lt;a href=&quot;https://developer.mozilla.org/zh-CN/docs/Web/API/Cache&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;cache API&lt;/a&gt; å®ç°çš„ã€‚service worker = webworker + cache API&lt;/li&gt;
&lt;li&gt;ä¸€æ—¦è¢« install ä¹‹åï¼Œå°±æ°¸è¿œå­˜åœ¨ï¼Œé™¤éè¢« uninstallï¼›éœ€è¦çš„æ—¶å€™å¯ä»¥ç›´æ¥å”¤é†’ï¼Œä¸éœ€è¦çš„æ—¶å€™è‡ªåŠ¨ç¡çœ &lt;/li&gt;
&lt;li&gt;å¯ä»¥å¯ç¼–ç¨‹æ‹¦æˆªä»£ç†è¯·æ±‚( https è¯·æ±‚)å’Œç¼“å­˜æ–‡ä»¶ï¼Œç¼“å­˜çš„æ–‡ä»¶ç›´æ¥å¯ä»¥è¢«ç½‘é¡µè¿›ç¨‹å–åˆ°ï¼ˆåŒ…æ‹¬ç½‘ç»œç¦»çº¿çŠ¶æ€ï¼‰&lt;/li&gt;
&lt;li&gt;ç¦»çº¿å†…å®¹å¼€å‘è€…å¯æ§ï¼›èƒ½å‘å®¢æˆ·ç«¯æ¨é€æ¶ˆæ¯ï¼›ä¸èƒ½ç›´æ¥æ“ä½œ dom&lt;/li&gt;
&lt;li&gt;å¿…é¡»åœ¨ https ç¯å¢ƒä¸‹æ‰èƒ½å·¥ä½œï¼Œå½“ç„¶ localhost æˆ–è€… 127.0.0.1 ä¹Ÿæ˜¯ ok çš„&lt;/li&gt;
&lt;li&gt;service worker æ˜¯å¼‚æ­¥çš„ï¼Œå†…éƒ¨é€šè¿‡ Promise å®ç°ï¼Œ localStorage æ˜¯åŒæ­¥çš„ï¼Œå› æ­¤ service worker å†…ä¸è®¸ç”¨ä½¿ç”¨ loaclStorage&lt;/li&gt;
&lt;li&gt;ä¾èµ– HTML5 fetch API å’Œ Promise&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
      <category term="HTML" scheme="https://lz5z.com/categories/HTML/"/>
    
    
      <category term="HTML5" scheme="https://lz5z.com/tags/HTML5/"/>
    
      <category term="service worker" scheme="https://lz5z.com/tags/service-worker/"/>
    
      <category term="ç¦»çº¿ç¼“å­˜" scheme="https://lz5z.com/tags/%E7%A6%BB%E7%BA%BF%E7%BC%93%E5%AD%98/"/>
    
      <category term="postMessage" scheme="https://lz5z.com/tags/postMessage/"/>
    
  </entry>
  
  <entry>
    <title>hexo æ”¯æŒ emoji</title>
    <link href="https://lz5z.com/hexo%E6%94%AF%E6%8C%81emoji/"/>
    <id>https://lz5z.com/hexoæ”¯æŒemoji/</id>
    <published>2017-07-05T16:24:06.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h3>æ·»åŠ æ–¹æ³•</h3><p>å¾ˆç®€å•ï¼Œæ¢ä¸€ä¸ª markdown å¼•æ“ï¼Œç„¶åå†å¢åŠ  emoji æ’ä»¶å³å¯ã€‚ğŸ˜Š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npm un hexo-renderer-marked --save</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> npm i hexo-renderer-markdown-it --save </span></span><br><span class="line"><span class="meta">$</span><span class="bash"> npm install markdown-it-emoji --save</span></span><br></pre></td></tr></table></figure><p>æ®è¯´ <a href="https://github.com/hexojs/hexo-renderer-markdown-it" target="_blank" rel="noopener">hexo-renderer-markdown-it</a> çš„é€Ÿåº¦è¦æ¯” Hexo åŸè£…æ’ä»¶è¦å¿«ï¼Œè€Œä¸”åŠŸèƒ½æ›´å¤šï¼š</p><a id="more"></a><blockquote><p>Main Features</p><ul><li>Support for <a href="http://daringfireball.net/projects/markdown/" target="_blank" rel="noopener">Markdown</a>, <a href="https://help.github.com/articles/github-flavored-markdown/" target="_blank" rel="noopener">GFM</a> and <a href="http://commonmark.org/" target="_blank" rel="noopener">CommonMark</a></li><li>Extensive configuration</li><li>Faster than the default renderer | <code>hexo-renderer-marked</code></li><li>Safe ID for headings</li><li>Anchors for headings with ID</li><li>Footnotes</li><li><code>&lt;sub&gt;</code> H<sub>2</sub>O</li><li><code>&lt;sup&gt;</code> x<sup>2</sup></li><li><code>&lt;ins&gt;</code> <ins>Inserted</ins></li></ul></blockquote><p>ç„¶åç¼–è¾‘ <code>_config.yml</code>ï¼š</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">markdown:</span><br><span class="line">  plugins:</span><br><span class="line">    - markdown-<span class="keyword">it</span>-footnote</span><br><span class="line">    - markdown-<span class="keyword">it</span>-sup</span><br><span class="line">    - markdown-<span class="keyword">it</span>-sub</span><br><span class="line">    - markdown-<span class="keyword">it</span>-<span class="keyword">abbr</span></span><br><span class="line">    - markdown-<span class="keyword">it</span>-emoji</span><br></pre></td></tr></table></figure><h3>ä½¿ç”¨æ–¹æ³•</h3><ol><li>åœ¨ <a href="https://emoji.codes/" target="_blank" rel="noopener">Emoji</a> ä¸­æ‰¾åˆ°ä½ æƒ³è¦çš„è¡¨æƒ…ï¼Œç„¶åç‚¹å‡»å³å¯å¤åˆ¶ã€‚</li><li>æ¯”å¦‚ä½ æƒ³å‘ä¸€ä¸ªç¬‘è„¸ ğŸ˜„ ç›´æ¥è¾“å…¥ç¬‘è„¸å¯¹åº”çš„ emoji ç¼–ç  <code>:smile:</code> å°±å¯ä»¥ã€‚</li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h3&gt;æ·»åŠ æ–¹æ³•&lt;/h3&gt;
&lt;p&gt;å¾ˆç®€å•ï¼Œæ¢ä¸€ä¸ª markdown å¼•æ“ï¼Œç„¶åå†å¢åŠ  emoji æ’ä»¶å³å¯ã€‚ğŸ˜Š&lt;/p&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; npm un hexo-renderer-marked --save&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; npm i hexo-renderer-markdown-it --save &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; npm install markdown-it-emoji --save&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æ®è¯´ &lt;a href=&quot;https://github.com/hexojs/hexo-renderer-markdown-it&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;hexo-renderer-markdown-it&lt;/a&gt; çš„é€Ÿåº¦è¦æ¯” Hexo åŸè£…æ’ä»¶è¦å¿«ï¼Œè€Œä¸”åŠŸèƒ½æ›´å¤šï¼š&lt;/p&gt;
    
    </summary>
    
      <category term="Blog" scheme="https://lz5z.com/categories/Blog/"/>
    
    
      <category term="Hexo" scheme="https://lz5z.com/tags/Hexo/"/>
    
      <category term="emoji" scheme="https://lz5z.com/tags/emoji/"/>
    
  </entry>
  
  <entry>
    <title>ä¸ºä»€ä¹ˆ call çš„é€Ÿåº¦å¿«äº apply</title>
    <link href="https://lz5z.com/call-faster-than-apply/"/>
    <id>https://lz5z.com/call-faster-than-apply/</id>
    <published>2017-06-29T16:43:04.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨ stackoverflow çœ‹åˆ°ä¸€ä¸ªæœ‰è¶£çš„é—®é¢˜: <a href="https://stackoverflow.com/questions/23769556/why-is-call-so-much-faster-than-apply" target="_blank" rel="noopener">Why is call so much faster than apply?</a> äºæ˜¯ä½¿ç”¨ <a href="https://benchmarkjs.com/" target="_blank" rel="noopener">benchmark.js</a> åœ¨ node ä¸­è‡ªå·±æµ‹è¯•äº†ä¸€ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Benchmark = <span class="built_in">require</span>(<span class="string">'benchmark'</span>)</span><br><span class="line"><span class="keyword">const</span> suite = <span class="keyword">new</span> Benchmark.Suite</span><br><span class="line"><span class="keyword">const</span> applyFun = <span class="function"><span class="keyword">function</span> (<span class="params">str</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> [].slice.apply(str, [<span class="number">1</span>])</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> callFun = <span class="function"><span class="keyword">function</span> (<span class="params">str</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> [].slice.call(str, <span class="number">1</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// add tests</span></span><br><span class="line">suite.add(<span class="string">'apply'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    applyFun(<span class="string">'apple'</span>)</span><br><span class="line">&#125;).add(<span class="string">'call'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    callFun(<span class="string">'apple'</span>)</span><br><span class="line">&#125;).on(<span class="string">'cycle'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">String</span>(event.target))</span><br><span class="line">&#125;).on(<span class="string">'complete'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Fastest is '</span> + <span class="keyword">this</span>.filter(<span class="string">'fastest'</span>).map(<span class="string">'name'</span>))</span><br><span class="line">&#125;).run(&#123;<span class="string">'async'</span>: <span class="literal">true</span>&#125;)</span><br></pre></td></tr></table></figure><a id="more"></a><h3>æµ‹è¯•ç¯å¢ƒï¼š</h3><p>ç³»ç»Ÿï¼šmacOS Sierra<br>CPUï¼š2.6 GHz Intel Core i5<br>å†…å­˜ï¼š8 GB 1600 MHz DDR3<br>Node: 8.1.0</p><h3>æµ‹è¯•ç»“æœï¼š</h3><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apply x <span class="number">951</span>,<span class="number">707</span> ops/sec Â±<span class="number">0.46</span>% (<span class="number">87</span> runs sampled)</span><br><span class="line">call x <span class="number">969</span>,<span class="number">699</span> ops/sec Â±<span class="number">0.52</span>% (<span class="number">91</span> runs sampled)</span><br><span class="line">Fastest <span class="keyword">is</span> call</span><br></pre></td></tr></table></figure><p>å¯è§è™½ç„¶ call æ¯” apply è¦å¿«ä¸€äº›ï¼Œä½†æ˜¯å·®åˆ«å¹¶ä¸æ˜¯å¾ˆå¤§ï¼Œé‚£ä¹ˆåœ¨æµè§ˆå™¨ä¸Šé¢è¡¨ç°å¦‚ä½•å‘¢ï¼Ÿ</p><img src="/assets/img/call_vs_apply.jpg" alt="call_vs_apply_in_browsers"><p>ä½ ä¹Ÿå¯ä»¥ç‚¹å‡»ä¸‹é¢çš„ button åœ¨è‡ªå·±çš„æµè§ˆå™¨ä¸ŠæŸ¥çœ‹è¿è¡Œæ•ˆæœã€‚</p><!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.9.0">    <meta charset="UTF-8">    <title>call vs apply</title>    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.4/lodash.min.js"></script>    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/platform/1.3.4/platform.min.js"></script>    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/benchmark/2.1.4/benchmark.min.js"></script>    <script>    window.onload = () => {        let log = document.getElementById("log")        let btn = document.getElementById("btn")        const applyFun = str => {            return [].slice.apply(str, [1])        }        const callFun = str => {            return [].slice.call(str, 1)        }        const logMessage = arg => {            let eDiv = document.createElement("div")            eDiv.innerHTML = typeof arg === "string" ? arg : arg.toString()            log.appendChild(eDiv)        }        const prepare = () => {            log.innerHTML = ''            btn.disabled = true        }        window.run = () => {            prepare()            const suite = new Benchmark.Suite            // add tests            suite.add('apply', function() {                applyFun('apple')            }).add('call', function() {                callFun('apple')            }).on('cycle', function(event) {                logMessage(String(event.target))            }).on('complete', function() {                logMessage('Fastest is ' + this.filter('fastest').map('name'))                btn.disabled = false            }).run({                'async': true            })        }    }    </script></head><body>    <button id="btn" onclick="run()">run test</button>    <span id="log"></span>    <hr></body></html><p>å¯ä»¥çœ‹åˆ°å‡ ä¸ªæµè§ˆå™¨ä¸­éƒ½æ˜¯ call çš„é€Ÿåº¦è¦å¿«äº applyï¼Œä¸è¿‡éƒ½æ²¡æœ‰ç‰¹åˆ«æ˜æ˜¾ã€‚å…¶ä¸­ Safari çš„é€Ÿåº¦è®©æˆ‘å¤§åƒä¸€æƒŠï¼Œç›´æ¥æ¯”å…¶å®ƒå‡ ä¸ªæµè§ˆå™¨å¿«äº†ä¸€ä¸ªæ•°é‡çº§ã€‚çœ‹æ¥ WWDC 2017 å‘å¸ƒä¼šä¸Šè‹¹æœå¹çš„ç‰›æ²¡æœ‰é‚£ä¹ˆå¤§å•Šï¼Œä¸è¿‡ä¹Ÿå¯èƒ½ mac ä»ç¡¬ä»¶å±‚é¢å¯¹ Safari è¿›è¡Œä¼˜åŒ–ã€‚</p><h3>ä¸ºä»€ä¹ˆ call è¦å¿«äº apply</h3><p>SO ä¸Šé¢è§£é‡Šçš„æ¯”è¾ƒè¯¦ç»†ï¼Œåœ¨è¯­è¨€è®¾è®¡çš„æ—¶å€™ï¼Œapply éœ€è¦æ‰§è¡Œçš„æ­¥æ•°å°±æ¯” call è¦å¤šï¼šæ— è®º call è¿˜æ˜¯ applyï¼Œæœ€ç»ˆéƒ½æ˜¯è°ƒç”¨ä¸€ä¸ªå«åš <code>[[Call]]</code> çš„å†…éƒ¨å‡½æ•°ï¼Œè€Œ apply ç›¸å¯¹äº call å¤šåšäº†ä¸€äº›å‚æ•°å¤„ç†ï¼Œå¦‚å‚æ•°åˆ¤æ–­ã€æ ¼å¼åŒ–ç­‰ã€‚</p><h3>å›°æƒ‘</h3><p>SO ä¸Šé¢æåˆ° call çš„æ€§èƒ½æ˜¯ apply çš„ 4 å€ç”šè‡³ 30 å€ï¼Œä¸ºä»€ä¹ˆåœ¨æˆ‘è¿™é‡Œçš„æµ‹è¯•åªæœ‰ä¸€ä¸ç‚¹å·®è·å‘¢ï¼Ÿ<br>çªç„¶æƒ³åˆ°æ˜¯å¦å‚æ•°é—®é¢˜ï¼Œäºæ˜¯å»æ‰å‚æ•°å’Œå¢åŠ å‚æ•°ï¼Œåˆ†åˆ«äº node ç¯å¢ƒä¸­æµ‹è¯•ï¼Œå‘ç°å˜åŒ–å¹¶ä¸å¤§ï¼Œå·®è·ä¾ç„¶å¾ˆå°ã€‚é‚£ä¹ˆçŒœæƒ³å¯èƒ½æ˜¯ ES5 ä¸ ES6 çš„å·®è·å¯¼è‡´çš„ã€‚</p><p>å¯¹æ¯” <a href="http://es5.github.io/#x15.3.4.3" target="_blank" rel="noopener">ES5</a> å’Œ <a href="http://www.ecma-international.org/ecma-262/6.0/#sec-function.prototype.apply" target="_blank" rel="noopener">ES6</a> ä¸­å¯¹è¿™ä¸¤ä¸ªå‡½æ•°çš„å®šä¹‰ï¼Œå‘ç° Function.prototype.call çš„å˜åŒ–å¹¶ä¸å¤§ï¼Œä¸»è¦å˜åŒ–å‘ç”Ÿåœ¨ Function.prototype.apply ä¸Šï¼Œä» ES5 çš„ 9 æ­¥å˜æˆäº† ES6 çš„ 6æ­¥ã€‚ä¸»è¦å˜åŒ–å‘ç”Ÿåœ¨å¯¹å‚æ•°å¤„ç†çš„éƒ¨åˆ†ï¼Œå…¶å®ƒå…³äºå†…éƒ¨å‡½æ•°è°ƒç”¨çš„éƒ¨åˆ†ï¼Œçœ‹èµ·æ¥å¹¶æ²¡æœ‰å¤ªå¤šå·®å¼‚ã€‚</p><h3>æ€»ç»“</h3><p>é€šè¿‡æµ‹è¯•å‘ç°éšç€ ECMAScript è¯­è¨€å’Œ JavaScript è§£é‡Šå™¨æ€§èƒ½ä¸æ–­å¢å¼ºï¼Œcall vs apply åœ¨æ€§èƒ½ä¸Šçš„å·®è·è¶Šæ¥è¶Šå°ï¼Œ SO ä¸Šé¢æåˆ°çš„æ•°å€ç”šè‡³å‡ åå€çš„å·®è·ï¼Œç›®å‰å·²ç»ä¸å­˜åœ¨äº†ï¼Œå› æ­¤åœ¨ä½¿ç”¨ä¸Šå¯ä»¥éšå¿ƒæ‰€æ¬²äº†ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨ stackoverflow çœ‹åˆ°ä¸€ä¸ªæœ‰è¶£çš„é—®é¢˜: &lt;a href=&quot;https://stackoverflow.com/questions/23769556/why-is-call-so-much-faster-than-apply&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Why is call so much faster than apply?&lt;/a&gt; äºæ˜¯ä½¿ç”¨ &lt;a href=&quot;https://benchmarkjs.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;benchmark.js&lt;/a&gt; åœ¨ node ä¸­è‡ªå·±æµ‹è¯•äº†ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Benchmark = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;benchmark&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; suite = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Benchmark.Suite&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; applyFun = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;str&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; [].slice.apply(str, [&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; callFun = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;str&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; [].slice.call(str, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// add tests&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;suite.add(&lt;span class=&quot;string&quot;&gt;&#39;apply&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    applyFun(&lt;span class=&quot;string&quot;&gt;&#39;apple&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;).add(&lt;span class=&quot;string&quot;&gt;&#39;call&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    callFun(&lt;span class=&quot;string&quot;&gt;&#39;apple&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;).on(&lt;span class=&quot;string&quot;&gt;&#39;cycle&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;event&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;built_in&quot;&gt;String&lt;/span&gt;(event.target))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;).on(&lt;span class=&quot;string&quot;&gt;&#39;complete&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;Fastest is &#39;&lt;/span&gt; + &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.filter(&lt;span class=&quot;string&quot;&gt;&#39;fastest&#39;&lt;/span&gt;).map(&lt;span class=&quot;string&quot;&gt;&#39;name&#39;&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;).run(&amp;#123;&lt;span class=&quot;string&quot;&gt;&#39;async&#39;&lt;/span&gt;: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="https://lz5z.com/tags/JavaScript/"/>
    
      <category term="call" scheme="https://lz5z.com/tags/call/"/>
    
      <category term="apply" scheme="https://lz5z.com/tags/apply/"/>
    
  </entry>
  
  <entry>
    <title>CSS Modules å­¦ä¹ </title>
    <link href="https://lz5z.com/CSS_Modules/"/>
    <id>https://lz5z.com/CSS_Modules/</id>
    <published>2017-06-21T10:39:32.000Z</published>
    <updated>2020-04-21T10:23:54.823Z</updated>
    
    <content type="html"><![CDATA[<p>CSS Modules çš„ç”¨æ³•å¾ˆç®€å•ï¼Œä¸è¿‡ç°é˜¶æ®µè¿˜éœ€è¦ webpack çš„æ”¯æŒã€‚CSS Modules çš„åŠŸèƒ½éå¸¸å°‘ï¼Œå®ƒä¸€å…±å°±å¹²äº†ä¸¤ä»¶äº‹ï¼šå±€éƒ¨ä½œç”¨åŸŸå’Œæ¨¡å—ä¾èµ–ã€‚</p><h2>CSS Modules ç¤ºä¾‹</h2><p><a href="https://github.com/Leo555/css_modules_study" target="_blank" rel="noopener">ä»£ç åœ°å€</a></p><p>é¡¹ç›®è·¯å¾„</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">â”œâ”€â”€ <span class="selector-tag">README</span><span class="selector-class">.md</span></span><br><span class="line">â”œâ”€â”€ <span class="selector-tag">index</span><span class="selector-class">.html</span></span><br><span class="line">â”œâ”€â”€ <span class="selector-tag">node_modules</span></span><br><span class="line">â”‚Â Â  â””â”€â”€ ...</span><br><span class="line">â”œâ”€â”€ <span class="selector-tag">package</span><span class="selector-class">.json</span></span><br><span class="line">â”œâ”€â”€ <span class="selector-tag">src</span></span><br><span class="line">â”‚Â Â  â”œâ”€â”€ <span class="selector-tag">animation</span><span class="selector-class">.css</span></span><br><span class="line">â”‚Â Â  â”œâ”€â”€ <span class="selector-tag">colors</span><span class="selector-class">.css</span></span><br><span class="line">â”‚Â Â  â”œâ”€â”€ <span class="selector-tag">index</span><span class="selector-class">.js</span></span><br><span class="line">â”‚Â Â  â””â”€â”€ <span class="selector-tag">style</span><span class="selector-class">.css</span></span><br><span class="line">â””â”€â”€ <span class="selector-tag">webpack</span><span class="selector-class">.config</span><span class="selector-class">.js</span></span><br></pre></td></tr></table></figure><a id="more"></a><p>æŠŠæ–‡ä»¶ clone ä¸‹æ¥åï¼Œå®‰è£…ä¾èµ–ï¼Œç„¶åå°±å¯ä»¥è¿è¡Œäº†</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">clone</span> https://github.com/Leo555/css_modules_study.git</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> css_modules_study</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> npm install</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> npm run start</span></span><br></pre></td></tr></table></figure><p>æµè§ˆå™¨ä¼šè‡ªåŠ¨æ‰“å¼€é™æ€æ–‡ä»¶ï¼Œæ–¹ä¾¿æŸ¥çœ‹æ•ˆæœã€‚</p><h2>CSS Modules ç”¨æ³•</h2><h3>webpack</h3><p>é¦–å…ˆé…ç½® webpack ç¯å¢ƒ(æœ¬æ–‡ä½¿ç”¨webpack2)ï¼Œç»™ css-loader å¢åŠ ä¸€ä¸ª modules æŸ¥è¯¢å‚æ•°ï¼Œè¡¨ç¤ºæ‰“å¼€ CSS Modules åŠŸèƒ½ã€‚</p><p>ç®€å•çš„ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">  rules: [&#123;</span><br><span class="line">    test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">    loader: <span class="string">"style-loader!css-loader?modules"</span></span><br><span class="line">  &#125;]</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>å¦‚æœéœ€è¦ç»™ CSS Modules ä¼ é€’ä¸€äº›å‚æ•°ï¼Œå¯ä»¥ç”¨å¯¹è±¡çš„æ–¹å¼ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">  rules: [&#123;</span><br><span class="line">    test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">    use: [<span class="string">"style-loader"</span>, </span><br><span class="line">    &#123;</span><br><span class="line">      loader: <span class="string">"css-loader"</span>,</span><br><span class="line">      options: &#123;</span><br><span class="line">        modules: <span class="literal">true</span>,</span><br><span class="line">        localIdentName: <span class="string">'[path][name]__[local]--[hash:base64:5]'</span>,</span><br><span class="line">        importLoaders: <span class="number">1</span>,</span><br><span class="line">        camelCase: <span class="literal">true</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;]</span><br><span class="line">  &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3>ä½œç”¨åŸŸ</h3><p>å¼€å¯ CSS Modules åï¼Œæ‰€æœ‰çš„ CSS é€‰æ‹©å™¨éƒ½æ˜¯å±€éƒ¨ä½œç”¨åŸŸï¼Œé™¤éå£°æ˜å®ƒä¸ºå…¨å±€çš„ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*Scoped Selectors*/</span></span><br><span class="line"><span class="selector-class">.className</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: green;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">10px</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*Global Selectors*/</span></span><br><span class="line"><span class="selector-pseudo">:global(.text)</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">22px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šä¸¤ä¸ª CSS class é€šè¿‡å¦‚ä¸‹æ–¹æ³•è¢« JS å¼•ç”¨</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> styles <span class="keyword">from</span> <span class="string">"./style.css"</span>;</span><br><span class="line"><span class="comment">// import &#123; className &#125; from "./style.css";</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> app = <span class="built_in">document</span>.getElementById(<span class="string">'app'</span>)</span><br><span class="line">app.innerHTML = </span><br><span class="line"><span class="string">`</span></span><br><span class="line"><span class="string">&lt;div class="<span class="subst">$&#123;styles.className&#125;</span>"&gt;Hello CSS Modules&lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;div class="text"&gt;Global Selectors&lt;/div&gt;</span></span><br><span class="line"><span class="string">`</span></span><br></pre></td></tr></table></figure><p>åé¢çš„å¼•ç”¨æ–¹å¼éƒ½ç›¸åŒï¼Œå› æ­¤ç•¥å»ï¼Œå…·ä½“å¯æŸ¥çœ‹ <a href="https://github.com/Leo555/css_modules_study/blob/master/src/index.js" target="_blank" rel="noopener">index.js</a>ã€‚</p><p>æŸ¥çœ‹æ„å»ºåçš„ CSSï¼Œå‘ç°å±€éƒ¨å˜é‡çš„åå­—è¢«ç¼–è¯‘æˆ hash (<code>localIdentName: '[path][name]__[local]--[hash:base64:5]'</code>)ï¼Œè€Œå…¨å±€å˜é‡çš„åå­—ä¸å˜ã€‚</p><img src="/assets/img/css-modules.png" alt="css-modules"><p>åŸæ¥ CSS Modules å°±åšäº†è¿™ä¹ˆä¸€ç‚¹å¾®å°çš„å·¥ä½œã€‚</p><h3>class ç»§æ‰¿å’Œé‡å†™</h3><p>CSS Modules é€šè¿‡ç»„åˆçš„æ–¹å¼è¿›è¡Œé›†æˆï¼Œä»¥è¾¾æˆä»£ç å¤ç”¨çš„æ•ˆæœã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*Class Composes*/</span></span><br><span class="line"><span class="selector-class">.otherClassName</span> &#123;</span><br><span class="line">  <span class="attribute">composes</span>: className;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">220px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">60px</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">60px</span>;</span><br><span class="line">  <span class="attribute">border-width</span>: <span class="number">2px</span>;</span><br><span class="line">  <span class="attribute">border-style</span>: solid;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*Composes Overrides*/</span></span><br><span class="line"><span class="selector-class">.background</span> &#123;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#efefef</span>;</span><br><span class="line">  <span class="attribute">composes</span>: otherClassName;</span><br><span class="line">  <span class="attribute">border-style</span>: dotted;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>otherClassName ç»§æ‰¿ classNameï¼Œå› ä¸ºæ‹¥æœ‰äº† color å’Œ margin å±æ€§ï¼Œè€Œ background ç»§æ‰¿ otherClassNameï¼Œå´é‡å†™äº† border-styleã€‚</p><h3>å±€éƒ¨åŠ¨ç”»</h3><p>åœ¨ animation.css ä¸­ï¼Œå®šä¹‰äº†åŠ¨ç”» tadaï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@keyframes</span> tada &#123;</span><br><span class="line">  <span class="selector-tag">from</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">scale3d</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  10%, 20% &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">scale3d</span>(.<span class="number">9</span>, .<span class="number">9</span>, .<span class="number">9</span>) <span class="built_in">rotate3d</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, -<span class="number">3deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  30%, 50%, 70%, 90% &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">scale3d</span>(<span class="number">1.1</span>, <span class="number">1.1</span>, <span class="number">1.1</span>) <span class="built_in">rotate3d</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">3deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  40%, 60%, 80% &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">scale3d</span>(<span class="number">1.1</span>, <span class="number">1.1</span>, <span class="number">1.1</span>) <span class="built_in">rotate3d</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, -<span class="number">3deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">to</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">scale3d</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.tada</span> &#123;</span><br><span class="line">  <span class="attribute">animation</span>: tada <span class="number">2s</span> infinite;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ style ä¸­çš„å¼•ç”¨æ–¹å¼å¦‚ä¸‹ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*Scoped Animations*/</span></span><br><span class="line"><span class="selector-class">.backgroundAnimation</span> &#123;</span><br><span class="line">  <span class="attribute">composes</span>: background;</span><br><span class="line">  <span class="attribute">composes</span>: tada from <span class="string">'./animation.css'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ç¬¬äºŒä¸ª composes ä¹Ÿå±•ç¤ºäº†å¦‚ä½•ä»å…¶å®ƒ CSS æ¨¡å—ä¸­å¼•ç”¨é€‰æ‹©å™¨ã€‚</p><h3>å®šä¹‰å˜é‡</h3><p>é€šè¿‡ @value å®šä¹‰å˜é‡å’Œå¼•ç”¨å˜é‡</p><p>colors.css</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@value</span> <span class="attribute">color:</span> black;</span><br><span class="line"><span class="keyword">@value</span> <span class="attribute">fontSize:</span> <span class="number">22px</span>;</span><br></pre></td></tr></table></figure><p>å¼•ç”¨æ–¹å¼</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*Define variables*/</span></span><br><span class="line"><span class="keyword">@value</span> <span class="attribute">colors:</span> <span class="string">"./colors.css"</span>;</span><br><span class="line"><span class="keyword">@value</span> color, fontSize from colors;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.color</span> &#123;</span><br><span class="line">  <span class="attribute">composes</span>: otherClassName;</span><br><span class="line">  <span class="attribute">color</span>: color;</span><br><span class="line">  <span class="attribute">font-size</span>: fontSize;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2>Vue ç»“åˆ CSS Modules</h2><p>vue-loader ä¸­é›†æˆäº† CSS Modulesï¼Œå¯ä»¥ä½œä¸ºæ¨¡æ‹Ÿ CSS ä½œç”¨åŸŸçš„æ›¿ä»£æ–¹æ¡ˆã€‚</p><h3>ä½¿ç”¨</h3><p>åœ¨ <code>&lt;style&gt;</code> ä¸Šæ·»åŠ  module å±æ€§å³å¯å¼€å¯ CSS Modules æ¨¡å¼ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">module</span>&gt;</span></span><br><span class="line"><span class="css"><span class="selector-class">.red</span> &#123;</span></span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.bold</span> &#123;</span></span><br><span class="line">  font-weight: bold;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p>css-loader ä¼šè‡ªåŠ¨å°†ç”Ÿæˆçš„ CSS å¯¹è±¡æ³¨å…¥åˆ° $style ä¸­ï¼Œåªéœ€è¦åœ¨ <code>&lt;template&gt;</code> ä¸­ä½¿ç”¨åŠ¨æ€ class ç»‘å®šï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">:class</span>=<span class="string">"$style.red"</span>&gt;</span></span><br><span class="line">    This should be red</span><br><span class="line">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç”±äºå®ƒæ˜¯ä¸€ä¸ªè®¡ç®—å±æ€§ï¼Œå®ƒä¹Ÿé€‚ç”¨äº <code>:class</code> çš„ object/array è¯­æ³•ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">:class</span>=<span class="string">"&#123; [$style.red]: isRed &#125;"</span>&gt;</span></span><br><span class="line">      Am I red?</span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">:class</span>=<span class="string">"[$style.red, $style.bold]"</span>&gt;</span></span><br><span class="line">      Red and bold</span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨ JavaScript è®¿é—®å®ƒï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line">  created () &#123;</span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.$style.red)</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h3>è‡ªå®šä¹‰æ³¨å…¥åç§°</h3><p>åœ¨ .vue ä¸­å¯ä»¥å®šä¹‰ä¸æ­¢ä¸€ä¸ª <code>&lt;style&gt;</code>ï¼Œä¸ºäº†é¿å…è¢«è¦†ç›–ï¼Œä½ å¯ä»¥é€šè¿‡è®¾ç½® module å±æ€§æ¥ä¸ºå®ƒä»¬å®šä¹‰æ³¨å…¥åè®¡ç®—å±æ€§çš„åç§°ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">module</span>=<span class="string">"a"</span>&gt;</span></span><br><span class="line"><span class="css">  <span class="comment">/* identifiers injected as a */</span></span></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><h2>æ€»ç»“</h2><p>åœ¨å‰ç«¯æ¨¡å—åŒ–çš„é“è·¯ä¸Šï¼ŒCSS æ˜¾ç„¶è½å JS éå¸¸å¤šã€‚ES2015/ES2016 çš„å¿«é€Ÿæ™®åŠå’Œ Babel/webpack ç­‰å·¥å…·çš„å‘å±•ï¼Œè®© JS åœ¨å¤§å‹é¡¹ç›®å·¥ç¨‹åŒ–ä¸­è¶Šå‘å¼ºå¤§ï¼Œ<a href="http://www.infoq.com/cn/news/2017/05/JavaScript-become-language" target="_blank" rel="noopener">æœ€ç»ˆæˆä¸ºä¸€æµè¯­è¨€</a> ã€‚</p><p>CSS Modules è§£å†³äº†å“ªäº›é—®é¢˜å‘¢ï¼Ÿ</p><ol><li>æ¶ˆé™¤äº†å…¨å±€å‘½åçš„é—®é¢˜ï¼Œå†ä¹Ÿä¸ç”¨æ‹…å¿ƒä¸åŒæ–‡ä»¶ä¹‹é—´çš„å‘½åå†²çªäº†ï¼Œä¹Ÿä¸ç”¨å†™ä¸€å±‚åˆä¸€å±‚çš„é€‰æ‹©å™¨äº†ã€‚</li><li>é€šè¿‡ JS å»ç®¡ç† CSS ä¹‹é—´çš„ä¾èµ–ï¼Œåœ¨å¼•å…¥ç»„ä»¶çš„æ—¶å€™ï¼Œå¯ä»¥åªå¼•å…¥æ¬¡ç»„ä»¶éœ€è¦çš„ CSSï¼Œç»„ä»¶æ›´åŠ ç‹¬ç«‹ã€‚</li><li>CSS å˜é‡ å¯ä»¥åœ¨ CSS å’Œ JS ä¸­å…±äº«ï¼Œå¯¹äºå¤æ‚ç»„ä»¶çš„ä½¿ç”¨ä¼šæœ‰å¥‡æ•ˆã€‚</li><li>å¯¹ä»£ç å‹ç¼©ä¹Ÿæœ‰ä¸€å®šå¸®åŠ©ã€‚</li></ol><blockquote><p>CSS æ¨¡å—åŒ–çš„è§£å†³æ–¹æ¡ˆæœ‰å¾ˆå¤šï¼Œä½†ä¸»è¦æœ‰ä¸¤ç±»ã€‚ä¸€ç±»æ˜¯å½»åº•æŠ›å¼ƒ CSSï¼Œä½¿ç”¨ JS æˆ– JSON æ¥å†™æ ·å¼ã€‚Radiumï¼Œjsxstyleï¼Œreact-style å±äºè¿™ä¸€ç±»ã€‚ä¼˜ç‚¹æ˜¯èƒ½ç»™ CSS æä¾› JS åŒæ ·å¼ºå¤§çš„æ¨¡å—åŒ–èƒ½åŠ›ï¼›ç¼ºç‚¹æ˜¯ä¸èƒ½åˆ©ç”¨æˆç†Ÿçš„ CSS é¢„å¤„ç†å™¨ï¼ˆæˆ–åå¤„ç†å™¨ï¼‰ Sass/Less/PostCSSï¼Œ:hover å’Œ :active ä¼ªç±»å¤„ç†èµ·æ¥å¤æ‚ã€‚å¦ä¸€ç±»æ˜¯ä¾æ—§ä½¿ç”¨ CSSï¼Œä½†ä½¿ç”¨ JS æ¥ç®¡ç†æ ·å¼ä¾èµ–ï¼Œä»£è¡¨æ˜¯ CSS Modulesã€‚CSS Modules èƒ½æœ€å¤§åŒ–åœ°ç»“åˆç°æœ‰ CSS ç”Ÿæ€å’Œ JS æ¨¡å—åŒ–èƒ½åŠ›ï¼ŒAPI ç®€æ´åˆ°å‡ ä¹é›¶å­¦ä¹ æˆæœ¬ã€‚å‘å¸ƒæ—¶ä¾æ—§ç¼–è¯‘å‡ºå•ç‹¬çš„ JS å’Œ CSSã€‚å®ƒå¹¶ä¸ä¾èµ–äº Reactï¼Œåªè¦ä½ ä½¿ç”¨ Webpackï¼Œå¯ä»¥åœ¨ Vue/Angular/jQuery ä¸­ä½¿ç”¨ã€‚æ˜¯æˆ‘è®¤ä¸ºç›®å‰æœ€å¥½çš„ CSS æ¨¡å—åŒ–è§£å†³æ–¹æ¡ˆã€‚</p></blockquote><p>å¼•è‡ª <a href="https://github.com/camsong/blog/issues/5" target="_blank" rel="noopener">CSS Modules è¯¦è§£åŠ React ä¸­å®è·µ</a></p><h2>å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://github.com/camsong/blog/issues/5" target="_blank" rel="noopener">CSS Modules è¯¦è§£åŠ React ä¸­å®è·µ</a></li><li><a href="https://github.com/css-modules/css-modules" target="_blank" rel="noopener">css-modules</a></li><li><a href="http://www.ruanyifeng.com/blog/2016/06/css_modules.html" target="_blank" rel="noopener">CSS Modules ç”¨æ³•æ•™ç¨‹</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;CSS Modules çš„ç”¨æ³•å¾ˆç®€å•ï¼Œä¸è¿‡ç°é˜¶æ®µè¿˜éœ€è¦ webpack çš„æ”¯æŒã€‚CSS Modules çš„åŠŸèƒ½éå¸¸å°‘ï¼Œå®ƒä¸€å…±å°±å¹²äº†ä¸¤ä»¶äº‹ï¼šå±€éƒ¨ä½œç”¨åŸŸå’Œæ¨¡å—ä¾èµ–ã€‚&lt;/p&gt;
&lt;h2&gt;CSS Modules ç¤ºä¾‹&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/Leo555/css_modules_study&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ä»£ç åœ°å€&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é¡¹ç›®è·¯å¾„&lt;/p&gt;
&lt;figure class=&quot;highlight css&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;â”œâ”€â”€ &lt;span class=&quot;selector-tag&quot;&gt;README&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.md&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;â”œâ”€â”€ &lt;span class=&quot;selector-tag&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.html&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;â”œâ”€â”€ &lt;span class=&quot;selector-tag&quot;&gt;node_modules&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â””â”€â”€ ...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;â”œâ”€â”€ &lt;span class=&quot;selector-tag&quot;&gt;package&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.json&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;â”œâ”€â”€ &lt;span class=&quot;selector-tag&quot;&gt;src&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”œâ”€â”€ &lt;span class=&quot;selector-tag&quot;&gt;animation&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.css&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”œâ”€â”€ &lt;span class=&quot;selector-tag&quot;&gt;colors&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.css&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â”œâ”€â”€ &lt;span class=&quot;selector-tag&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;â”‚Â Â  â””â”€â”€ &lt;span class=&quot;selector-tag&quot;&gt;style&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.css&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;â””â”€â”€ &lt;span class=&quot;selector-tag&quot;&gt;webpack&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.config&lt;/span&gt;&lt;span class=&quot;selector-class&quot;&gt;.js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="CSS" scheme="https://lz5z.com/categories/CSS/"/>
    
    
      <category term="CSS Modules" scheme="https://lz5z.com/tags/CSS-Modules/"/>
    
      <category term="webpack" scheme="https://lz5z.com/tags/webpack/"/>
    
      <category term="vue" scheme="https://lz5z.com/tags/vue/"/>
    
  </entry>
  
  <entry>
    <title>CSS3 åŠ¨ç”»â€”animation</title>
    <link href="https://lz5z.com/CSS3%E5%8A%A8%E7%94%BB%E2%80%94animation/"/>
    <id>https://lz5z.com/CSS3åŠ¨ç”»â€”animation/</id>
    <published>2017-06-12T17:23:48.000Z</published>
    <updated>2020-04-21T10:23:54.823Z</updated>
    
    <content type="html"><![CDATA[<p>animation å±æ€§ç›®å‰è¿˜å­˜åœ¨æµè§ˆå™¨å…¼å®¹æ€§é—®é¢˜ï¼Œå»ºè®®ä½¿ç”¨ PostCSS æˆ–æ‰‹åŠ¨æ·»åŠ æµè§ˆå™¨å‰ç¼€ã€‚æœ¬æ–‡å­¦ä¹ ä½¿ç”¨ animation å±æ€§åˆ›å»ºç®€å•åŠ¨ç”»ã€‚</p><!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.9.0">  <style>  .anima_div {    width: 60px;    height: 40px;    background: #92B901;    position: relative;    padding: 20px 10px 0px 10px;    animation: animated_div 5s infinite;    border-radius: 5px;  }  @keyframes animated_div {    0%  {transform: rotate(0deg);left:0px;}    25%  {transform: rotate(20deg);left:0px;}    50%  {transform: rotate(0deg);left:300px;}    55%  {transform: rotate(0deg);left:300px;}    70%  {transform: rotate(0deg);left:300px;background:#1ec7e6;}    100%  {transform: rotate(-360deg);left:0px;}  }  </style></head><body>  <div class="anima_div"></div></body></html><a id="more"></a><h2>animation</h2><p>animation æ˜¯å¤åˆå±æ€§ï¼Œå…¶å­å±æ€§æœ‰ï¼š</p><p>(1) animation-delay åŠ¨ç”»å»¶æ—¶<br>(2) animation-direction åŠ¨ç”»åœ¨æ¯æ¬¡è¿è¡Œå®Œåæ˜¯åå‘è¿è¡Œè¿˜æ˜¯é‡æ–°å›åˆ°å¼€å§‹ä½ç½®é‡å¤è¿è¡Œ<br>(3) animation-duration åŠ¨ç”»ä¸€ä¸ªå‘¨æœŸçš„æ—¶é•¿<br>(4) animation-iteration-count åŠ¨ç”»é‡å¤æ¬¡æ•°ï¼Œinfiniteæ— é™æ¬¡é‡å¤åŠ¨ç”»<br>(5) animation-name æŒ‡å®šç”± @keyframes<br>(6) animation-timing-function è®¾ç½®åŠ¨ç”»é€Ÿåº¦æ›²çº¿ï¼Œé»˜è®¤æ˜¯ â€œeaseâ€<br>(7) animation-fill-mode æŒ‡å®šåŠ¨ç”»æ‰§è¡Œåè·³å›åˆ°åˆå§‹çŠ¶æ€è¿˜æ˜¯ä¿ç•™åœ¨ç»“æŸçŠ¶æ€<br>æ­¤å¤–ï¼Œè¿˜æœ‰ animation-play-state å±æ€§ï¼Œä½†æ˜¯ä¸èƒ½ç®€å†™åˆ° animation å±æ€§ä¸­ï¼Œè¯¥å±æ€§å…è®¸æš‚åœå’Œæ¢å¤åŠ¨ç”»ã€‚</p><p>åŸºæœ¬è¯­æ³•</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">animation-name</span>: <span class="selector-tag">first_animation</span>;</span><br><span class="line"><span class="selector-tag">animation-duration</span>: 5<span class="selector-tag">s</span>;</span><br><span class="line"><span class="selector-tag">animation-timing-function</span>: <span class="selector-tag">linear</span>;</span><br><span class="line"><span class="selector-tag">animation-delay</span>: 2<span class="selector-tag">s</span>;</span><br><span class="line"><span class="selector-tag">animation-iteration-count</span>: <span class="selector-tag">infinite</span>;</span><br><span class="line"><span class="selector-tag">animation-direction</span>: <span class="selector-tag">alternate</span>;</span><br><span class="line"><span class="selector-tag">animation-play-state</span>: <span class="selector-tag">running</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ç®€å†™ */</span></span><br><span class="line"><span class="selector-tag">animation</span>: <span class="selector-tag">first_animation</span> 5<span class="selector-tag">s</span> <span class="selector-tag">linear</span> 2<span class="selector-tag">s</span> <span class="selector-tag">infinite</span> <span class="selector-tag">alternate</span>;</span><br></pre></td></tr></table></figure><blockquote><p>animation: name duration timing-function delay iteration-count direction;</p></blockquote><h3>@keyframes</h3><p>@keyframes ç”¨äºè§„å®šåŠ¨ç”»å¦‚ä½•ä»ä¸€ç§æ ·å¼é€æ¸å˜åŒ–ä¸ºå¦ä¸€ç§æ ·å¼ï¼Œå…¶åŸºæœ¬ç”¨æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@keyframes</span> first_animation &#123;</span><br><span class="line">  0%   &#123;<span class="attribute">background</span>: red; <span class="attribute">left</span>:<span class="number">0px</span>; <span class="attribute">top</span>:<span class="number">0px</span>;&#125;</span><br><span class="line">  25%  &#123;<span class="attribute">background</span>: yellow; <span class="attribute">left</span>:<span class="number">200px</span>; <span class="attribute">top</span>:<span class="number">0px</span>;&#125;</span><br><span class="line">  50%  &#123;<span class="attribute">background</span>: blue; <span class="attribute">left</span>:<span class="number">200px</span>; <span class="attribute">top</span>:<span class="number">200px</span>;&#125;</span><br><span class="line">  75%  &#123;<span class="attribute">background</span>: green; <span class="attribute">left</span>:<span class="number">0px</span>; <span class="attribute">top</span>:<span class="number">200px</span>;&#125;</span><br><span class="line">  100% &#123;<span class="attribute">background</span>: red; <span class="attribute">left</span>:<span class="number">0px</span>; <span class="attribute">top</span>:<span class="number">0px</span>;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> first_animation &#123;</span><br><span class="line">  <span class="selector-tag">from</span> &#123;<span class="attribute">background</span>: red;&#125;</span><br><span class="line">  50% &#123; <span class="attribute">background</span>: orange &#125;</span><br><span class="line">  <span class="selector-tag">to</span> &#123;<span class="attribute">background</span>: yellow;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…³é”®è¯ â€œfromâ€ å’Œ â€œtoâ€ï¼Œç­‰åŒäº 0% å’Œ 100%ï¼Œè¡¨ç¤ºåŠ¨ç”»å¼€å§‹çŠ¶æ€å’Œç»“æŸçŠ¶æ€ã€‚ä¸­é—´çŠ¶æ€ç”±æµè§ˆå™¨è‡ªåŠ¨æ¨ç®—ã€‚</p><h3>animation-iteration-count</h3><p>animation-iteration-count æŒ‡å®šåŠ¨ç”»æ’­æ”¾çš„æ¬¡æ•°ï¼Œé»˜è®¤å€¼ä¸º 1ã€‚å¯ä»¥æŒ‡å®šå…·ä½“çš„æ¬¡æ•°ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å…³é”®å­— infinite è®©åŠ¨ç”»æ— é™æ¬¡æ’­æ”¾ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">animation-name</span>: <span class="selector-tag">first_animation</span>;</span><br><span class="line"><span class="selector-tag">animation-duration</span>: 5<span class="selector-tag">s</span>;</span><br><span class="line"><span class="selector-tag">animation-iteration-count</span>: 1;</span><br><span class="line"><span class="comment">/* ç­‰åŒäº */</span></span><br><span class="line"><span class="selector-tag">animation</span>: <span class="selector-tag">first_animation</span> 5<span class="selector-tag">s</span> <span class="selector-tag">infinite</span>;</span><br></pre></td></tr></table></figure><h3>animation-fill-mode</h3><p>animation-fill-mode æŒ‡å®šåŠ¨ç”»æ‰§è¡Œåè·³å›åˆ°åˆå§‹çŠ¶æ€è¿˜æ˜¯ä¿ç•™åœ¨ç»“æŸçŠ¶æ€ã€‚</p><blockquote><p>animation-fill-mode : none | forwards | backwards | both;</p></blockquote><p>none: ä¸æ”¹å˜é»˜è®¤è¡Œä¸º<br>forwardsï¼šå½“åŠ¨ç”»å®Œæˆåï¼Œä¿æŒæœ€åä¸€ä¸ªå±æ€§å€¼(åœ¨æœ€åä¸€ä¸ªå…³é”®å¸§ä¸­å®šä¹‰)<br>backwardsï¼šè®©åŠ¨ç”»å›åˆ°ç¬¬ä¸€å¸§çš„çŠ¶æ€(åœ¨ç¬¬ä¸€ä¸ªå…³é”®å¸§ä¸­å®šä¹‰)<br>bothï¼šæ ¹æ® animation-direction è½®æµåº”ç”¨ forwards å’Œ backwards è§„åˆ™</p><script async src="//jsfiddle.net/Leo555/3nrjmak2/1/embed/result,html,css/"></script><h3>animation-direction</h3><p>animation-direction æŒ‡å®šå¯¹è±¡åŠ¨ç”»è¿åŠ¨çš„æ–¹å‘ï¼Œæœ‰ä»¥ä¸‹å››ç§å–å€¼ï¼š</p><p>normalï¼šæ­£å¸¸æ–¹å‘ï¼Œé»˜è®¤<br>reverseï¼šåŠ¨ç”»åå‘è¿è¡Œ,æ–¹å‘å§‹ç»ˆä¸normalç›¸å<br>alternateï¼šåŠ¨ç”»ä¼šå¾ªç¯æ­£åæ–¹å‘äº¤æ›¿è¿åŠ¨<br>alternate-reverseï¼šåŠ¨ç”»ä»åå‘å¼€å§‹ï¼Œå†æ­£åæ–¹å‘äº¤æ›¿è¿åŠ¨</p><h3>animation-play-state</h3><p>animation-play-state ç”¨äºæ‰‹åŠ¨æ§åˆ¶åŠ¨ç”»çš„çŠ¶æ€ï¼Œæœ‰ paused å’Œ running ä¸¤ç§å–å€¼ï¼š</p><p>runningï¼šé»˜è®¤å€¼ï¼Œè¡¨ç¤ºåŠ¨ç”»æ­£å¸¸è¿åŠ¨<br>pausedï¼šè¡¨ç¤ºæš‚åœåŠ¨ç”»</p><script async src="//jsfiddle.net/Leo555/0yzvd9nL/2/embed/result,css/"></script><h2>å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/CSS_Animations" target="_blank" rel="noopener">MDN-CSS Animations</a></li><li><a href="http://www.cnblogs.com/imwtr/p/5885885.html" target="_blank" rel="noopener">CSS3çš„å˜å½¢transformã€è¿‡æ¸¡transitionã€åŠ¨ç”»animationå­¦ä¹ </a></li><li><a href="http://www.ruanyifeng.com/blog/2014/02/css_transition_and_animation.html" target="_blank" rel="noopener">CSSåŠ¨ç”»ç®€ä»‹</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;animation å±æ€§ç›®å‰è¿˜å­˜åœ¨æµè§ˆå™¨å…¼å®¹æ€§é—®é¢˜ï¼Œå»ºè®®ä½¿ç”¨ PostCSS æˆ–æ‰‹åŠ¨æ·»åŠ æµè§ˆå™¨å‰ç¼€ã€‚æœ¬æ–‡å­¦ä¹ ä½¿ç”¨ animation å±æ€§åˆ›å»ºç®€å•åŠ¨ç”»ã€‚&lt;/p&gt;

&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;&lt;meta name=&quot;generator&quot; content=&quot;Hexo 3.9.0&quot;&gt;
  &lt;style&gt;
  .anima_div {
    width: 60px;
    height: 40px;
    background: #92B901;
    position: relative;
    padding: 20px 10px 0px 10px;
    animation: animated_div 5s infinite;
    border-radius: 5px;
  }

  @keyframes animated_div {
    0%  {transform: rotate(0deg);left:0px;}
    25%  {transform: rotate(20deg);left:0px;}
    50%  {transform: rotate(0deg);left:300px;}
    55%  {transform: rotate(0deg);left:300px;}
    70%  {transform: rotate(0deg);left:300px;background:#1ec7e6;}
    100%  {transform: rotate(-360deg);left:0px;}
  }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div class=&quot;anima_div&quot;&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
    
    </summary>
    
      <category term="CSS" scheme="https://lz5z.com/categories/CSS/"/>
    
    
      <category term="animation" scheme="https://lz5z.com/tags/animation/"/>
    
      <category term="åŠ¨ç”»" scheme="https://lz5z.com/tags/%E5%8A%A8%E7%94%BB/"/>
    
  </entry>
  
  <entry>
    <title>CSS3 åŠ¨ç”»â€”transition</title>
    <link href="https://lz5z.com/CSS3%E5%8A%A8%E7%94%BB%E2%80%94transition/"/>
    <id>https://lz5z.com/CSS3åŠ¨ç”»â€”transition/</id>
    <published>2017-06-12T10:21:22.000Z</published>
    <updated>2020-04-21T10:23:54.823Z</updated>
    
    <content type="html"><![CDATA[<p>CSS3 è¿‡æ¸¡å±æ€§è¢«å°è£…åœ¨ transition è§„èŒƒä¸­ï¼Œè¿‡æ¸¡çš„æ„ä¹‰åœ¨äºï¼Œç»™äº† CSS æ—¶é—´è½´çš„æ¦‚å¿µï¼Œåœ¨æ­¤ä¹‹å‰æ‰€æœ‰çš„ CSS çŠ¶æ€å˜åŒ–éƒ½æ˜¯ç¬é—´å®Œæˆçš„ã€‚è¿‡æ¸¡å¯ä»¥è§†ä¸ºç®€å•ç‰ˆçš„åŠ¨ç”»ï¼Œé€šè¿‡å®šä¹‰å¼€å§‹çŠ¶æ€å’Œç»“æŸçŠ¶æ€ï¼Œè¾¾åˆ°æ ·å¼è½¬å˜çš„åŠŸèƒ½ã€‚</p><p>ç›®å‰å„å¤§æµè§ˆå™¨éƒ½æ”¯æŒ transitionï¼Œæ‰€ä»¥ä¸åŠ æµè§ˆå™¨å‰ç¼€å³å¯ä½¿ç”¨ã€‚</p><p>CSS3 transition è§„èŒƒå®šä¹‰äº†ä»¥ä¸‹å››ä¸ª CSS å±æ€§ï¼š</p><p>transition-delay(è¿‡æ¸¡å»¶è¿Ÿæ—¶é—´)<br>transition-duration(è¿‡æ¸¡æŒç»­æ—¶é—´)<br>transition-property(è¿‡æ¸¡å±æ€§)<br>transition-timing-function(è¿‡æ¸¡æ•ˆæœçš„æ—¶é—´æ›²çº¿)</p><a id="more"></a><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* transition: 1s 1s width ease; */</span></span><br><span class="line"><span class="selector-tag">transition-property</span>: <span class="selector-tag">width</span>;</span><br><span class="line"><span class="selector-tag">transition-duration</span>: 1<span class="selector-tag">s</span>;</span><br><span class="line"><span class="selector-tag">transition-delay</span>: 1<span class="selector-tag">s</span>;</span><br><span class="line"><span class="selector-tag">transition-timing-function</span>: <span class="selector-tag">ease</span>;</span><br></pre></td></tr></table></figure><script async src="//jsfiddle.net/Leo555/kd7f9khw/embed/result,html,css/"></script><h3>è¿‡æ¸¡å±æ€§ transition-property</h3><p>é»˜è®¤å€¼ä¸º allï¼Œè¡¨ç¤ºæµè§ˆå™¨æ‰€æœ‰èƒ½æ¥å—çš„å¯è¿‡æ¸¡å±æ€§ï¼Œå¯ä»¥ä½¿ç”¨å•ä¸ªå€¼æˆ–ä»¥é€—å·éš”å¼€çš„å¤šä¸ªå€¼ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">transition-property</span>: <span class="selector-tag">width</span>,<span class="selector-tag">height</span>;</span><br><span class="line"><span class="selector-tag">transition-duration</span>: 1<span class="selector-tag">s</span>,2<span class="selector-tag">s</span>;</span><br><span class="line"><span class="comment">/* transition: 1s width, 2s height; */</span></span><br><span class="line"><span class="comment">/* transition: width 1s, height 2s; */</span></span><br></pre></td></tr></table></figure><script async src="//jsfiddle.net/Leo555/whanfhLk/2/embed/result,html,css/"></script><p>å¯ä»¥åœ¨ <a href="http://oli.jp/2010/css-animatable-properties/" target="_blank" rel="noopener">è¿™é‡Œ</a> å’Œ <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_animated_properties" target="_blank" rel="noopener">è¿™é‡Œ</a> æŸ¥çœ‹å“ªäº› CSS å±æ€§æ”¯æŒ transitionã€‚</p><h3>å»¶è¿Ÿæ—¶é—´ transition-delay</h3><p>transition-delay å±æ€§è§„å®šäº†åœ¨æ‰§è¡Œä¸€ä¸ªè¿‡æ¸¡ä¹‹å‰çš„ç­‰å¾…æ—¶é—´ã€‚IE å’Œ Opera ä¸æ¥å— transition-duration åœ¨-10mså’Œ10msä¹‹é—´çš„å€¼ã€‚é»˜è®¤å€¼0è¡¨ç¤ºä¸è¿‡æ¸¡ç›´æ¥çœ‹åˆ°æ‰§è¡Œåçš„ç»“æœã€‚å•ä½æ˜¯ç§’sï¼Œä¹Ÿå¯ä»¥æ˜¯æ¯«ç§’msã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">transition-delay</span>: 1<span class="selector-tag">s</span>;</span><br><span class="line"><span class="selector-tag">transition-delay</span>: 1000<span class="selector-tag">ms</span>;</span><br></pre></td></tr></table></figure><h3>è¿‡æ¸¡æ—¶é—´ transition-duration</h3><p>åŠ¨ç”»çš„æ‰§è¡Œæ—¶é—´ï¼Œé»˜è®¤å€¼0è¡¨ç¤ºä¸è¿‡æ¸¡ã€‚å•ä½æ˜¯ç§’sï¼Œä¹Ÿå¯ä»¥æ˜¯æ¯«ç§’msã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">transition-duration</span>: 1<span class="selector-tag">s</span>;</span><br><span class="line"><span class="selector-tag">transition-duration</span>: 1000<span class="selector-tag">ms</span>;</span><br></pre></td></tr></table></figure><h3>è¿‡æ¸¡æ•ˆæœ transition-timing-function</h3><p>easeï¼šé»˜è®¤å€¼ï¼Œç¼“è§£æ•ˆæœï¼Œå˜åŒ–é€Ÿåº¦é€æ¸æ”¾æ…¢<br>linearï¼šçº¿æ€§æ•ˆæœï¼ŒåŒ€é€Ÿå˜åŒ–<br>ease-inï¼šæ¸æ˜¾æ•ˆæœï¼ŒåŠ é€Ÿå˜åŒ–<br>ease-outï¼šæ¸éšæ•ˆæœï¼Œå‡é€Ÿå˜åŒ–<br>ease-in-outï¼šæ¸æ˜¾æ¸éšæ•ˆæœ<br>cubic-bezierï¼š è‡ªå®šä¹‰å˜åŒ–é€Ÿåº¦ï¼Œå¯ä»¥ä½¿ç”¨ <a href="http://cubic-bezier.com/#.17,.67,.83,.67" target="_blank" rel="noopener">cubic-bezier</a> å®šåˆ¶æƒ³è¦çš„æ•ˆæœã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">transition</span>: <span class="selector-tag">width</span> <span class="selector-tag">cubic-bezier</span>(<span class="selector-class">.14</span>,<span class="selector-class">.78</span>,<span class="selector-class">.92</span>,<span class="selector-class">.36</span>) 1<span class="selector-tag">s</span>;</span><br></pre></td></tr></table></figure><script async src="//jsfiddle.net/Leo555/37m1tc5a/1/embed/result,html,css/"></script><h3>transition</h3><p>transition æ˜¯ä¸€ä¸ªå¤åˆå±æ€§ï¼Œå¯ä»¥åŒæ—¶å®šä¹‰<br>transition-propertyã€transition-durationã€transition-timing-functionã€transition-delay å­å±æ€§å€¼ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* property name | duration | timing function | delay */</span></span><br><span class="line"><span class="selector-tag">transition</span>: <span class="selector-tag">margin-left</span> 4<span class="selector-tag">s</span> <span class="selector-tag">ease-in-out</span> 1<span class="selector-tag">s</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* property name | duration | delay */</span></span><br><span class="line"><span class="selector-tag">transition</span>: <span class="selector-tag">margin-left</span> 4<span class="selector-tag">s</span> 1<span class="selector-tag">s</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* property name | duration */</span></span><br><span class="line"><span class="selector-tag">transition</span>: <span class="selector-tag">margin-left</span> 4<span class="selector-tag">s</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Apply to all changed properties */</span></span><br><span class="line"><span class="selector-tag">transition</span>: <span class="selector-tag">all</span> 0<span class="selector-class">.5s</span> <span class="selector-tag">ease-out</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Apply to multiple properties */</span></span><br><span class="line"><span class="selector-tag">transition</span>: <span class="selector-tag">width</span> 2<span class="selector-tag">s</span>, <span class="selector-tag">height</span> 2<span class="selector-tag">s</span>, <span class="selector-tag">background-color</span> 2<span class="selector-tag">s</span>, <span class="selector-tag">transform</span> 2<span class="selector-tag">s</span>;</span><br></pre></td></tr></table></figure><p>å†™å¤åˆå±æ€§çš„æ—¶å€™ï¼Œå››ä¸ªå±æ€§æ˜¯å¯ä»¥æ”¹å˜é¡ºåºçš„ï¼Œä¸è¿‡ä¸¤ä¸ªæ—¶é—´å±æ€§è‹¥åŒæ—¶å‡ºç°ï¼Œç¬¬ä¸€ä¸ªä»£è¡¨ durationï¼Œç¬¬äºŒä¸ªä»£è¡¨ delayï¼Œå¦‚æœåªå‡ºç°ä¸€ä¸ªæ—¶é—´å±æ€§ï¼Œåˆ™è¡¨ç¤º durationã€‚</p><h3>transition ç»“åˆ transform</h3><p>ä½¿ç”¨ transition ç»“åˆ transform èƒ½å¤Ÿå®Œæˆä¸€äº›ç®€å•çš„åŠ¨ç”»æ•ˆæœ</p><script async src="//jsfiddle.net/Leo555/e7j3p7ru/2/embed/result,html,css/"></script><p>ä½¿ç”¨ transition åšåŠ¨ç”»ç®€å•æ˜“ç”¨ï¼Œä¸è¿‡ä¹Ÿå­˜åœ¨ä¸€äº›ç¼ºç‚¹ï¼š</p><p>(1) åŠ¨ç”»éœ€è¦äº‹ä»¶è§¦å‘<br>(2) åŠ¨ç”»åªèƒ½æ‰§è¡Œä¸€æ¬¡<br>(3) transition åªèƒ½å®šä¹‰å¼€å§‹çŠ¶æ€å’Œç»“æŸçŠ¶æ€ï¼Œä¸èƒ½å®šä¹‰ä¸­é—´çŠ¶æ€</p><p>å› æ­¤å¦‚æœæƒ³è¦å®Œæˆæ¯”è¾ƒå¤æ‚çš„åŠ¨ç”»ï¼Œè¿˜æ˜¯è¦ç”¨ css3 ä¸­çš„ animation å±æ€§ã€‚</p><h2>å‚è€ƒèµ„æ–™</h2><ul><li><a href="http://www.ruanyifeng.com/blog/2014/02/css_transition_and_animation.html" target="_blank" rel="noopener">CSSåŠ¨ç”»ç®€ä»‹</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Transitions/Using_CSS_transitions" target="_blank" rel="noopener">MDN-Using CSS transitions</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;CSS3 è¿‡æ¸¡å±æ€§è¢«å°è£…åœ¨ transition è§„èŒƒä¸­ï¼Œè¿‡æ¸¡çš„æ„ä¹‰åœ¨äºï¼Œç»™äº† CSS æ—¶é—´è½´çš„æ¦‚å¿µï¼Œåœ¨æ­¤ä¹‹å‰æ‰€æœ‰çš„ CSS çŠ¶æ€å˜åŒ–éƒ½æ˜¯ç¬é—´å®Œæˆçš„ã€‚è¿‡æ¸¡å¯ä»¥è§†ä¸ºç®€å•ç‰ˆçš„åŠ¨ç”»ï¼Œé€šè¿‡å®šä¹‰å¼€å§‹çŠ¶æ€å’Œç»“æŸçŠ¶æ€ï¼Œè¾¾åˆ°æ ·å¼è½¬å˜çš„åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;ç›®å‰å„å¤§æµè§ˆå™¨éƒ½æ”¯æŒ transitionï¼Œæ‰€ä»¥ä¸åŠ æµè§ˆå™¨å‰ç¼€å³å¯ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;CSS3 transition è§„èŒƒå®šä¹‰äº†ä»¥ä¸‹å››ä¸ª CSS å±æ€§ï¼š&lt;/p&gt;
&lt;p&gt;transition-delay(è¿‡æ¸¡å»¶è¿Ÿæ—¶é—´)&lt;br&gt;
transition-duration(è¿‡æ¸¡æŒç»­æ—¶é—´)&lt;br&gt;
transition-property(è¿‡æ¸¡å±æ€§)&lt;br&gt;
transition-timing-function(è¿‡æ¸¡æ•ˆæœçš„æ—¶é—´æ›²çº¿)&lt;/p&gt;
    
    </summary>
    
      <category term="CSS" scheme="https://lz5z.com/categories/CSS/"/>
    
    
      <category term="åŠ¨ç”»" scheme="https://lz5z.com/tags/%E5%8A%A8%E7%94%BB/"/>
    
      <category term="transition" scheme="https://lz5z.com/tags/transition/"/>
    
      <category term="è¿‡æ¸¡" scheme="https://lz5z.com/tags/%E8%BF%87%E6%B8%A1/"/>
    
  </entry>
  
  <entry>
    <title>CSS3 åŠ¨ç”»â€”transform</title>
    <link href="https://lz5z.com/CSS3%E5%8A%A8%E7%94%BB%E2%80%94transform/"/>
    <id>https://lz5z.com/CSS3åŠ¨ç”»â€”transform/</id>
    <published>2017-06-09T16:23:31.000Z</published>
    <updated>2020-04-21T10:23:54.823Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨ CSS3 ä¸­ï¼Œè·ŸåŠ¨ç”»ç›¸å…³çš„å±æ€§æœ‰ï¼šå˜å½¢ transformã€è¿‡æ¸¡ transitionã€åŠ¨ç”» animationã€‚å…ˆæ”¾ä¸€ä¸ª Lea Verou å¤§ç¥çš„é“¾æ¥ <a href="http://leaverou.github.io/animatable/" target="_blank" rel="noopener">animatable</a>ã€‚</p><p>æœ¬ç« å­¦ä¹  CSS3 ä¸­çš„ transform å±æ€§ã€‚</p><a id="more"></a><h2>å˜å½¢ transform</h2><p>transform å±æ€§ç›®å‰è¿˜å­˜åœ¨æµè§ˆå™¨å…¼å®¹æ€§é—®é¢˜ï¼Œå»ºè®®ä½¿ç”¨ PostCSS æˆ–æ‰‹åŠ¨æ·»åŠ æµè§ˆå™¨å‰ç¼€ã€‚<br>ä½¿ç”¨ transformï¼Œå…ƒç´ å¯ä»¥è¢«è½¬æ¢ï¼ˆtranslateï¼‰ã€æ—‹è½¬ï¼ˆrotateï¼‰ã€ç¼©æ”¾ï¼ˆscaleï¼‰ã€å€¾æ–œï¼ˆskewï¼‰ã€‚<br>transform å±æ€§åªå¯¹ block å…ƒç´ ç”Ÿæ•ˆã€‚</p><script async src="//jsfiddle.net/Leo555/jeejj6yL/13/embed/result,html,css/"></script><h3>ç§»åŠ¨ translate</h3><p>transform: translate(x, y); è¡¨ç¤ºä½¿å…ƒç´ åœ¨ X è½´å’Œ Y è½´ç§»åŠ¨ï¼Œy å¯ä»¥çœç•¥ï¼Œè¡¨ç¤ºä¸ç§»åŠ¨ã€‚å¦‚æœå‚æ•°ä¸ºè´Ÿï¼Œåˆ™è¡¨ç¤ºå¾€ç›¸åçš„æ–¹å‘ç§»åŠ¨ã€‚åŒæ—¶è¿˜å¯ä»¥ä½¿ç”¨ translateXã€translateY å’Œ translateZ è¡¨ç¤ºåœ¨æŸä¸€ä¸ªæ–¹å‘ç§»åŠ¨ã€‚Z è½´ç§»åŠ¨çš„å‰ææ˜¯å…ƒç´ æœ¬èº«æˆ–è€…å…ƒç´ çš„çˆ¶å…ƒç´ è®¾å®šäº†é€è§†å€¼ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">transform</span>: <span class="selector-tag">translate</span>(12<span class="selector-tag">px</span>, 50%);</span><br><span class="line"><span class="selector-tag">transform</span>: <span class="selector-tag">translateX</span>(2<span class="selector-tag">em</span>);</span><br><span class="line"><span class="selector-tag">transform</span>: <span class="selector-tag">translateY</span>(0<span class="selector-class">.3in</span>);</span><br><span class="line"><span class="selector-tag">transform</span>: <span class="selector-tag">translateZ</span>(20<span class="selector-tag">px</span>);</span><br></pre></td></tr></table></figure><script async src="//jsfiddle.net/Leo555/bhotf9bb/embed/result,html,css/"></script><h3>æ—‹è½¬ rotate</h3><p>æ—‹è½¬ transform: rotate(angle) angle å–å€¼æœ‰ï¼šè§’åº¦å€¼degï¼Œå¼§åº¦å€¼radï¼Œæ¢¯åº¦gardï¼Œè½¬/åœˆturnï¼Œæ­£æ•°å€¼ä»£è¡¨é¡ºæ—¶é’ˆæ—‹è½¬ï¼Œåä¹‹é€†æ—¶é’ˆã€‚</p><p>rotateXã€rotateYã€rotateZ è¡¨ç¤ºåˆ†åˆ«åœ¨ Xã€Yã€Z è½´ä¸Šæ—‹è½¬ã€‚rotate3d(x, y, z, angle) è¡¨ç¤ºåœ¨3ç»´ç©ºé—´æ—‹è½¬ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">transform</span>: <span class="selector-tag">rotate</span>(<span class="selector-tag">-30deg</span>);</span><br><span class="line"><span class="selector-tag">transform</span>: <span class="selector-tag">rotate</span>(0<span class="selector-class">.5turn</span>);</span><br><span class="line"><span class="selector-tag">transform</span>: <span class="selector-tag">rotate3d</span>(1, 2<span class="selector-class">.0</span>, 3<span class="selector-class">.0</span>, 10<span class="selector-tag">deg</span>);</span><br><span class="line"><span class="selector-tag">transform</span>: <span class="selector-tag">rotateX</span>(0<span class="selector-class">.5deg</span>);</span><br><span class="line"><span class="selector-tag">transform</span>: <span class="selector-tag">rotateY</span>(0<span class="selector-class">.5deg</span>);</span><br><span class="line"><span class="selector-tag">transform</span>: <span class="selector-tag">rotateZ</span>(0<span class="selector-class">.5deg</span>);</span><br></pre></td></tr></table></figure><script async src="//jsfiddle.net/Leo555/L5xfztsb/2/embed/result,html,css/"></script><h3>ç¼©æ”¾ scale</h3><p>ç¼©æ”¾ transform: scale(x, y) è¡¨ç¤ºä½¿å…ƒç´ åœ¨ X è½´å’Œ Y è½´ç¼©æ”¾ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">transform</span>: <span class="selector-tag">scale</span>(2, 0<span class="selector-class">.5</span>);</span><br><span class="line"><span class="selector-tag">transform</span>: <span class="selector-tag">scaleX</span>(2);</span><br><span class="line"><span class="selector-tag">transform</span>: <span class="selector-tag">scaleY</span>(0<span class="selector-class">.5</span>);</span><br><span class="line"><span class="selector-tag">transform</span>: <span class="selector-tag">scale3d</span>(2<span class="selector-class">.5</span>, 1<span class="selector-class">.2</span>, 0<span class="selector-class">.3</span>);</span><br><span class="line"><span class="selector-tag">transform</span>: <span class="selector-tag">scaleZ</span>(0<span class="selector-class">.3</span>);</span><br></pre></td></tr></table></figure><script async src="//jsfiddle.net/Leo555/bo2zu0fv/embed/result,html,css/"></script><h3>å€¾æ–œ skew</h3><p>å€¾æ–œ transform: skew(x, y) è¡¨ç¤º X è½´å’Œ Y è½´å€¾æ–œçš„è§’åº¦ï¼Œå–å€¼ç±»å‹ä¸ºè§’åº¦å€¼degã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">transform</span>: <span class="selector-tag">skew</span>(30<span class="selector-tag">deg</span>, 20<span class="selector-tag">deg</span>);</span><br><span class="line"><span class="selector-tag">transform</span>: <span class="selector-tag">skewX</span>(30<span class="selector-tag">deg</span>);</span><br><span class="line"><span class="selector-tag">transform</span>: <span class="selector-tag">skewY</span>(1<span class="selector-class">.07rad</span>);</span><br></pre></td></tr></table></figure><script async src="//jsfiddle.net/Leo555/h7pox5r3/4/embed/result,html,css/"></script><h3>çŸ©é˜µå˜å½¢ matrix</h3><p>çŸ©é˜µå˜å½¢transform: matrix(a,c,e,b,d,f) ç›¸å½“äºç›´æ¥åº”ç”¨ä¸€ä¸ª[a c e b d f]å˜æ¢çŸ©é˜µã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">transform</span>:  <span class="selector-tag">matrix</span>(<span class="selector-tag">a</span>, <span class="selector-tag">c</span>, <span class="selector-tag">b</span>, <span class="selector-tag">d</span>, <span class="selector-tag">tx</span>, <span class="selector-tag">ty</span>)</span><br></pre></td></tr></table></figure><script async src="//jsfiddle.net/Leo555/nn7q512z/embed/result,html,css/"></script><h3>å˜å½¢åŸç‚¹ transform-origin</h3><p>transform-origin ç”¨æ¥å®šä¹‰è½¬æ¢å…ƒç´ çš„ä½ç½®ï¼Œåœ¨æ²¡æœ‰é‡ç½® transform-origin æ”¹å˜å…ƒç´ åŸç‚¹ä½ç½®çš„æƒ…å†µä¸‹ï¼ŒCSS çš„å˜å½¢æ“ä½œéƒ½æ˜¯ä»¥å…ƒç´ è‡ªå·±ä¸­å¿ƒä½ç½®è¿›è¡Œã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">transform-origin</span>: <span class="selector-tag">left</span>;</span><br><span class="line"><span class="selector-tag">transform-origin</span>: <span class="selector-tag">left</span> <span class="selector-tag">top</span>;</span><br><span class="line"><span class="selector-tag">transform-origin</span>: 50% 100%;</span><br><span class="line"><span class="selector-tag">transform-origin</span>: 50% <span class="selector-tag">bottom</span>;</span><br><span class="line"><span class="selector-tag">transform</span>: <span class="selector-tag">rotate</span>(30<span class="selector-tag">deg</span>);</span><br></pre></td></tr></table></figure><script async src="//jsfiddle.net/Leo555/o992vtgg/embed/result,html,css/"></script><h2>å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/transform" target="_blank" rel="noopener">MDN</a></li><li><a href="http://www.cnblogs.com/imwtr/p/5885885.html" target="_blank" rel="noopener">CSS3çš„å˜å½¢transformã€è¿‡æ¸¡transitionã€åŠ¨ç”»animationå­¦ä¹ </a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨ CSS3 ä¸­ï¼Œè·ŸåŠ¨ç”»ç›¸å…³çš„å±æ€§æœ‰ï¼šå˜å½¢ transformã€è¿‡æ¸¡ transitionã€åŠ¨ç”» animationã€‚å…ˆæ”¾ä¸€ä¸ª Lea Verou å¤§ç¥çš„é“¾æ¥ &lt;a href=&quot;http://leaverou.github.io/animatable/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;animatable&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬ç« å­¦ä¹  CSS3 ä¸­çš„ transform å±æ€§ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="CSS" scheme="https://lz5z.com/categories/CSS/"/>
    
    
      <category term="åŠ¨ç”»" scheme="https://lz5z.com/tags/%E5%8A%A8%E7%94%BB/"/>
    
      <category term="transform" scheme="https://lz5z.com/tags/transform/"/>
    
      <category term="å˜å½¢" scheme="https://lz5z.com/tags/%E5%8F%98%E5%BD%A2/"/>
    
  </entry>
  
  <entry>
    <title>å¼‚å½¢ï¼šå¥‘çº¦</title>
    <link href="https://lz5z.com/%E5%BC%82%E5%BD%A2%E5%A5%91%E7%BA%A6/"/>
    <id>https://lz5z.com/å¼‚å½¢å¥‘çº¦/</id>
    <published>2017-05-16T22:49:25.000Z</published>
    <updated>2020-04-21T10:23:54.831Z</updated>
    
    <content type="html"><![CDATA[<p>ä»Šå¹´æœ€æœŸå¾…çš„ç”µå½±ï¼Œæ²¡æœ‰ä¹‹ä¸€ã€‚ã€Šå¼‚å½¢ã€‹ç³»åˆ—ç”µå½±å¿ å®ç²‰ä¸ï¼Œä¸çŸ¥é“çœ‹äº†å¤šå°‘éã€‚2012å¹´çš„ã€Šæ™®ç½—ç±³ä¿®æ–¯ã€‹ä¹Ÿæ˜¯ä¸äºšäºã€Šå¼‚å½¢1ã€‹çš„ç»å…¸ä¹‹ä½œï¼Œé›·å¾·åˆ©Â·æ–¯ç§‘ç‰¹æ›´æ˜¯è¶Šè€ç”µå½±è¶Šå…·æœ‰å“²æ€ã€‚</p><a id="more"></a><p>ä¸‹é¢æ˜¯ B ç«™ä¸Šçš„ä¸€åˆ™å½±è¯„ï¼Œå»ºè®®é«˜æ¸…é£Ÿç”¨ã€‚</p><p><embed height="415" width="544" quality="high" allowfullscreen="true" type="application/x-shockwave-flash" src="//static.hdslb.com/miniloader.swf" flashvars="aid=10597309&page=1" pluginspage="//www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä»Šå¹´æœ€æœŸå¾…çš„ç”µå½±ï¼Œæ²¡æœ‰ä¹‹ä¸€ã€‚ã€Šå¼‚å½¢ã€‹ç³»åˆ—ç”µå½±å¿ å®ç²‰ä¸ï¼Œä¸çŸ¥é“çœ‹äº†å¤šå°‘éã€‚2012å¹´çš„ã€Šæ™®ç½—ç±³ä¿®æ–¯ã€‹ä¹Ÿæ˜¯ä¸äºšäºã€Šå¼‚å½¢1ã€‹çš„ç»å…¸ä¹‹ä½œï¼Œé›·å¾·åˆ©Â·æ–¯ç§‘ç‰¹æ›´æ˜¯è¶Šè€ç”µå½±è¶Šå…·æœ‰å“²æ€ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Movies" scheme="https://lz5z.com/categories/Movies/"/>
    
    
      <category term="ç”µå½±" scheme="https://lz5z.com/tags/%E7%94%B5%E5%BD%B1/"/>
    
      <category term="å¼‚å½¢" scheme="https://lz5z.com/tags/%E5%BC%82%E5%BD%A2/"/>
    
  </entry>
  
  <entry>
    <title>æœºå™¨å­¦ä¹ â€”é€šè¿‡ APP é¢„æµ‹ç”¨æˆ·æ€§åˆ«</title>
    <link href="https://lz5z.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E2%80%94app%E9%A2%84%E6%B5%8B%E7%94%A8%E6%88%B7%E6%80%A7%E5%88%AB/"/>
    <id>https://lz5z.com/æœºå™¨å­¦ä¹ â€”appé¢„æµ‹ç”¨æˆ·æ€§åˆ«/</id>
    <published>2017-05-16T14:32:51.000Z</published>
    <updated>2020-04-21T10:23:54.831Z</updated>
    
    <content type="html"><![CDATA[<h2>é¡¹ç›®æè¿°</h2><p>å…¬å¸ç»„ç»‡çš„ä¸€ä¸ªæœºå™¨å­¦ä¹ çš„å°æ¯”èµ›ï¼Œ<s> æ•°æ®<a href>ä¸‹è½½åœ°å€</a> </s> ã€‚å¤§æ„æ˜¯æ ¹æ®ç”¨æˆ·æ‰€å®‰è£…çš„ APP (åŠ å¯†)é¢„æµ‹ç”¨æˆ·çš„æ€§åˆ«ï¼Œè®­ç»ƒæ•°æ®æ ‡è®° label (æ€§åˆ«)ï¼Œå…¸å‹çš„ç›‘ç£å­¦ä¹ æ–¹æ¡ˆã€‚</p><h2>æ•°æ®æè¿°</h2><p>ä¸‹è½½ä¹‹åï¼Œè§£å‹æˆä¸ºæ–‡æœ¬æ–‡ä»¶ã€‚ æ•°æ®æ ¼å¼å¦‚ä¸‹ï¼š<br>æ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªç”¨æˆ·çš„æ•°æ®ï¼Œä¸€å…±120ä¸‡ä¸ªæ ·æœ¬ç”¨æˆ·æ•°æ®<br>æ¯ä¸€è¡Œéƒ½æœ‰5åˆ—ï¼Œæ¯ä¸€åˆ—ä»¥åˆ¶è¡¨ç¬¦ tab åˆ†å‰²ï¼ˆ\t)ã€‚<br>ç¬¬ä¸€åˆ—æ˜¯ç”¨æˆ·ç¼–å·ï¼ˆå·²ç»è„±æ•ï¼Œè½¬åŒ–æˆ1 ~1,200,000çš„ç¼–å·)<br>ç¬¬äºŒåˆ—æ˜¯ç”¨æˆ·çš„æ€§åˆ« ï¼ˆmale/female)<br>ç¬¬ä¸‰åˆ—æ˜¯ç”¨æˆ·çš„ç§»åŠ¨è®¾å¤‡ç±»å‹<br>ç¬¬å››åˆ—æ˜¯ç”¨æˆ·çš„ APP åˆ—è¡¨ï¼Œæ¯ä¸ª APP å·²ç»è„±æ•ï¼Œä»¥æ•°å­—ç¼–å·ä»£æ›¿ APP åç§°ã€‚å¤šä¸ª APP ä¹‹é—´ä»¥é€—å·ï¼ˆ,)ä½œä¸ºåˆ†éš”ç¬¦<br>ç¬¬äº”åˆ—æ˜¯ç”¨æˆ·æ‰€åœ¨åŒºåŸŸã€‚</p><p>å…¶ä¸­ç§»åŠ¨è®¾å¤‡ç±»å‹/APP åˆ—è¡¨/åŒºåŸŸæ˜¯ç‰¹å¾æ•°æ®ã€‚æ€§åˆ«æ˜¯ç»“æœæ•°æ®ã€‚</p><a id="more"></a><h2>æ–¹æ¡ˆ</h2><p>é¦–å…ˆåˆ†ææ•°æ®ï¼Œä¸€å…±æœ‰æœºå‹ã€APPã€åŒºåŸŸä¸‰ä¸ªç»´åº¦ã€‚æ€§åˆ«å¯èƒ½å¯¹ APP å’Œæœºå‹æœ‰åå¥½ï¼Œä½†æ˜¯ä¸èƒ½å¯¹åŒºåŸŸæœ‰åå¥½ï¼Œè€Œæ˜¯ä¸åŒçš„åŒºåŸŸå¯èƒ½å¯¹ APP æœ‰ä¸åŒçš„åå¥½ï¼Œæ¯”å¦‚æŸçœç”¨æˆ·åçˆ±ç›´æ’­ï¼ŒæŸçœç”¨æˆ·åçˆ±äº¤å‹ç­‰ç­‰ã€‚</p><p>å»ºæ¨¡æ–¹æ¡ˆï¼ŒæŠŠ APP å’Œ æœºå‹ï¼ˆæ•°å€¼åŒ–ï¼‰ä½œä¸ºä¸¤ä¸ªç»´åº¦å¯¹æ•°æ®è¿›è¡Œè®­ç»ƒï¼Œåˆ†åŒºåŸŸå»ºæ¨¡ï¼Œä¸åŒçš„åŒºåŸŸä½¿ç”¨ä¸åŒçš„æ¨¡å‹ã€‚ç„¶åä½¿ç”¨å…¨éƒ¨æ•°æ®æˆ–éšæœºéƒ¨åˆ†æ•°æ®å»ºæ¨¡å½¢æˆå…¬å…±æ•°æ®æ¨¡å‹ï¼Œå…¬å…±æ¨¡å‹ç”¨æ¥åˆ†æç”¨æˆ·åŒºåŸŸæ•°æ®ä¸è¶³æˆ–è€…æ¥è‡ªæœªå»ºæ¨¡åŒºåŸŸçš„æ•°æ®ã€‚</p><h2>å…·ä½“å®ç°</h2><p>æŠ€æœ¯æ–¹æ¡ˆï¼šPython + scikit-learn + pandas + numpy</p><p>ç¯å¢ƒæ­å»ºä½¿ç”¨ Anaconda</p><p><s> <a href="https://github.com/Leo555/wps_ai_war" target="_blank" rel="noopener">ä»£ç åœ°å€</a> </s></p><h2>é¡¹ç›®éš¾ç‚¹</h2><p>é¡¹ç›®å›°éš¾ä¸»è¦å‡ºç°åœ¨ APP é™ç»´ï¼Œä¹Ÿå°±æ˜¯åˆ¤æ–­å“ªäº› APP ä¸æ€§åˆ«ç›¸å…³ï¼Œè¿™æ˜¯ä¸€ä¸ªç›¸å…³æ€§åˆ†æçš„é—®é¢˜ã€‚ç½‘ä¸Šæ‰¾äº†å¾ˆå¤šèµ„æ–™ï¼Œç®—æ³•æè¿°ä¹Ÿæœ‰ï¼Œä¸è¿‡æ²¡æœ‰æ‰¾åˆ°åˆé€‚çš„ Python å®ç°ã€‚Spark ç‰ˆæœ¬çš„å€’æ˜¯å¾ˆå¤šï¼Œå¯æ˜¯ä¸æƒ³åœ¨ä¸€ä¸ªå°é¡¹ç›®é‡Œé¢ä½¿ç”¨ä¸¤ç§æŠ€æœ¯æ ˆã€‚</p><h2>è¿›åº¦</h2><p>ç›®å‰ä½¿ç”¨ä¸Šæµ·æ•°æ®å»ºæ¨¡ï¼Œåªä½¿ç”¨ APP ä¿¡æ¯ï¼ŒæœªåŠ å…¥æœºå‹ä¿¡æ¯ï¼Œé¢„æµ‹å‡†ç¡®åº¦å¤§çº¦ä¸º79%ã€‚<br>åé¢ä¼šåŠ å…¥æœºå‹ä¿¡æ¯ï¼Œå¹¶ä½¿ç”¨ç‰¹å¾æå–å¯¹ APP ä¿¡æ¯è¿›è¡Œé™ç»´ï¼Œå¸Œæœ›èƒ½æé«˜å‡†ç¡®ç‡ã€‚</p><h2>è¯´æ˜</h2><p>ç”±äºå…¬å¸æ”¿ç­–åŸå› ï¼Œä»£ç ä¸èƒ½æ”¾å…¥ githubï¼Œåç»­ä¼šæŠŠæ€è·¯å’Œæ ¸å¿ƒä»£ç å†™å‡ºæ¥ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;é¡¹ç›®æè¿°&lt;/h2&gt;
&lt;p&gt;å…¬å¸ç»„ç»‡çš„ä¸€ä¸ªæœºå™¨å­¦ä¹ çš„å°æ¯”èµ›ï¼Œ&lt;s&gt; æ•°æ®&lt;a href&gt;ä¸‹è½½åœ°å€&lt;/a&gt; &lt;/s&gt; ã€‚å¤§æ„æ˜¯æ ¹æ®ç”¨æˆ·æ‰€å®‰è£…çš„ APP (åŠ å¯†)é¢„æµ‹ç”¨æˆ·çš„æ€§åˆ«ï¼Œè®­ç»ƒæ•°æ®æ ‡è®° label (æ€§åˆ«)ï¼Œå…¸å‹çš„ç›‘ç£å­¦ä¹ æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;h2&gt;æ•°æ®æè¿°&lt;/h2&gt;
&lt;p&gt;ä¸‹è½½ä¹‹åï¼Œè§£å‹æˆä¸ºæ–‡æœ¬æ–‡ä»¶ã€‚ æ•°æ®æ ¼å¼å¦‚ä¸‹ï¼š&lt;br&gt;
æ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªç”¨æˆ·çš„æ•°æ®ï¼Œä¸€å…±120ä¸‡ä¸ªæ ·æœ¬ç”¨æˆ·æ•°æ®&lt;br&gt;
æ¯ä¸€è¡Œéƒ½æœ‰5åˆ—ï¼Œæ¯ä¸€åˆ—ä»¥åˆ¶è¡¨ç¬¦ tab åˆ†å‰²ï¼ˆ\t)ã€‚&lt;br&gt;
ç¬¬ä¸€åˆ—æ˜¯ç”¨æˆ·ç¼–å·ï¼ˆå·²ç»è„±æ•ï¼Œè½¬åŒ–æˆ1 ~1,200,000çš„ç¼–å·)&lt;br&gt;
ç¬¬äºŒåˆ—æ˜¯ç”¨æˆ·çš„æ€§åˆ« ï¼ˆmale/female)&lt;br&gt;
ç¬¬ä¸‰åˆ—æ˜¯ç”¨æˆ·çš„ç§»åŠ¨è®¾å¤‡ç±»å‹&lt;br&gt;
ç¬¬å››åˆ—æ˜¯ç”¨æˆ·çš„ APP åˆ—è¡¨ï¼Œæ¯ä¸ª APP å·²ç»è„±æ•ï¼Œä»¥æ•°å­—ç¼–å·ä»£æ›¿ APP åç§°ã€‚å¤šä¸ª APP ä¹‹é—´ä»¥é€—å·ï¼ˆ,)ä½œä¸ºåˆ†éš”ç¬¦&lt;br&gt;
ç¬¬äº”åˆ—æ˜¯ç”¨æˆ·æ‰€åœ¨åŒºåŸŸã€‚&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ç§»åŠ¨è®¾å¤‡ç±»å‹/APP åˆ—è¡¨/åŒºåŸŸæ˜¯ç‰¹å¾æ•°æ®ã€‚æ€§åˆ«æ˜¯ç»“æœæ•°æ®ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Machine Learning" scheme="https://lz5z.com/categories/Machine-Learning/"/>
    
    
      <category term="Python" scheme="https://lz5z.com/tags/Python/"/>
    
      <category term="scikit-learn" scheme="https://lz5z.com/tags/scikit-learn/"/>
    
      <category term="æ€§åˆ«é¢„æµ‹" scheme="https://lz5z.com/tags/%E6%80%A7%E5%88%AB%E9%A2%84%E6%B5%8B/"/>
    
      <category term="APP" scheme="https://lz5z.com/tags/APP/"/>
    
  </entry>
  
  <entry>
    <title>å†ä¸å­¦ flex å°±ä¸ä¼šå†™å¸ƒå±€äº†</title>
    <link href="https://lz5z.com/FlexLayoutLearning/"/>
    <id>https://lz5z.com/FlexLayoutLearning/</id>
    <published>2017-04-19T20:35:52.000Z</published>
    <updated>2020-04-21T10:23:54.823Z</updated>
    
    <content type="html"><![CDATA[<h2>å¦‚ä½•å±…ä¸­çš„é—®é¢˜</h2><p>å—çŠ¶å…ƒç´ å±…ä¸­æ˜¯ä¸€ä¸ªè€ç”Ÿå¸¸è°ˆçš„è¯é¢˜ï¼Œä¹‹å‰é¢è¯•çš„æ—¶å€™è€ƒå®˜ä¹Ÿæ›¾é—®åˆ°è¿‡è¿™ä¸ªã€‚ä¸‹é¢å†™å‡ ç§å¸¸è§çš„å—çŠ¶å…ƒç´ å±…ä¸­çš„æ–¹å¼ã€‚</p><a id="more"></a><p>å‡å¦‚æƒ³è¦ con åœ¨ box ä¸­å±…ä¸­</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"con"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h3>ç»å¯¹å¸ƒå±€ï¼Œä½¿ç”¨ margin</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#ebebeb</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.con</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#000</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">200px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3>ç›¸å¯¹å¸ƒå±€ï¼Œè®¡ç®— left å’Œ top</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#ebebeb</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.con</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#000</span>;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">200px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3>çˆ¶å®¹å™¨å®½é«˜ä¸ç¡®å®šæˆ–è€…ä¸å®¹æ˜“ç¡®å®šï¼Œç»¼åˆç›¸å¯¹å¸ƒå±€ + ç»å¯¹å¸ƒå±€</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">500px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#ebebeb</span>;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.con</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#000</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">margin-top</span>: -<span class="number">50px</span>;</span><br><span class="line">    <span class="attribute">margin-left</span>: -<span class="number">50px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3>ä½¿ç”¨ flex</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">500px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#ebebeb</span>;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.con</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#000</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3>flex + margin</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">500px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#ebebeb</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.con</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#000</span>;</span><br><span class="line">    <span class="attribute">margin</span>: auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ flex å¸ƒå±€çš„ä¼˜åŠ¿ä¸å¯è°“ä¸æ˜æ˜¾ï¼š</p><ul><li>å…å»äº†å¾ˆå¤šè®¡ç®—ã€‚æœ€åä¸¤ä¸ªä½¿ç”¨ flex å¸ƒå±€çš„ä¾‹å­ä¸­ï¼Œæ— è®ºçˆ¶å…ƒç´ è¿˜æ˜¯å­å…ƒç´ çš„å®½åº¦å’Œé«˜åº¦å‘ç”Ÿæ”¹å˜ï¼Œéƒ½èƒ½ä¾ç„¶èƒ½ä¿æŒå±…ä¸­ï¼›è€Œå‰é¢ä¸‰ç§æ–¹æ³•ä¸­ï¼Œåˆ™éœ€è¦éƒ½è¦æ”¹å˜å…¶ä»–å€¼ï¼Œæ‰èƒ½ä¿æŒå±…ä¸­ã€‚</li><li>ä½¿ç”¨ flex å¸ƒå±€çš„è¯­ä¹‰åŒ–è¦æ¯”å‰é¢å‡ ç§éƒ½å¥½ï¼Œå‰é¢ä¸‰ç§æ–¹æ³•ç»™äº†ä¸€å¤§å †æ•°å­—ï¼Œä¸å»è®¤çœŸçœ‹ä¸€çœ‹ã€ç®—ä¸€ç®—ï¼Œå¾ˆéš¾ç¡®å®šæ˜¯å¦æ˜¯å±…ä¸­ï¼Œè¿™å¯¹ä»£ç é˜…è¯»è€…ä¹Ÿæ˜¯éå¸¸ä¸å‹å¥½ã€‚</li><li>flex å¯¹å“åº”å¼å¸ƒå±€çš„æ”¯æŒæ›´å¥½ã€‚è™½ç„¶å‰é¢å‡ ç§æ–¹æ³•ä¹Ÿèƒ½å®ç°å“åº”å¼å¸ƒå±€ï¼Œä½†æ˜¯å®ç°èµ·æ¥æ¯”è¾ƒéº»çƒ¦ï¼Œä¸å¦‚ flex æ¥å¾—å®åœ¨ã€‚</li><li>flex æ”¯æŒè¡Œå†…å…ƒç´ ã€‚</li></ul><h2>ä»€ä¹ˆæ˜¯ flex å¸ƒå±€</h2><p>ä¼ ç»Ÿå¸ƒå±€çš„æ ¸å¿ƒæ˜¯ç›’å­æ¨¡å‹ï¼Œä¾èµ– display å±æ€§ + position å±æ€§ + float å±æ€§ã€‚å¯ä»¥çœ‹å‡ºæ¥ä¼ ç»Ÿå¸ƒå±€éå¸¸å®¹æ˜“å®ç°åƒ word å·¦å¯¹é½ï¼Œå³å¯¹é½è¿™æ ·çš„åŠŸèƒ½ï¼Œå¯ä»¥è¯´ï¼Œä¼ ç»Ÿå¸ƒå±€æ›´é€‚åˆäºæ–‡å­—æ’ç‰ˆã€‚</p><p>flex æ˜¯ flexible Box çš„ç¼©å†™ï¼Œå¯ä»¥çœ‹åšå¼¹æ€§çš„ç›’å­æ¨¡å‹ã€‚</p><h3>flex ç”¨æ³•</h3><p>ä½¿ç”¨ flex é¦–å…ˆè¦è®¾ç½®çˆ¶å…ƒç´  <code>display: flex</code>ã€‚ä»»ä½•å…ƒç´ éƒ½å¯ä»¥æŒ‡å®šä¸º flex å¸ƒå±€ï¼š</p><p>å—çŠ¶å…ƒç´ ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¡Œå†…å…ƒç´ </p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline-box;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è®¾ä¸º flex å¸ƒå±€ä»¥åï¼Œå­å…ƒç´ çš„ floatã€clear å’Œ vertical-align å±æ€§å°†å¤±æ•ˆã€‚</p><h2>flex ä¸¤ä¸ªåŸºæœ¬æ¦‚å¿µ</h2><p>flex çš„æ ¸å¿ƒçš„æ¦‚å¿µå°±æ˜¯ <strong>å®¹å™¨</strong> å’Œ <strong>è½´</strong>ã€‚å®¹å™¨åŒ…æ‹¬å¤–å±‚çš„ <strong>çˆ¶å®¹å™¨</strong> å’Œå†…å±‚çš„ <strong>å­å®¹å™¨</strong>ï¼Œè½´åŒ…æ‹¬ <strong>ä¸»è½´</strong> å’Œ <strong>äº¤å‰è½´</strong>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><img src="/assets/img/flex-layout.png" alt="æˆ‘æ˜¯ä¸€åªçš„å›¾ç‰‡"><p>å®¹å™¨é»˜è®¤å­˜åœ¨ä¸¤æ ¹è½´ï¼šæ°´å¹³çš„ä¸»è½´ï¼ˆmain axisï¼‰å’Œå‚ç›´çš„äº¤å‰è½´ï¼ˆcross axisï¼‰ã€‚ä¸»è½´çš„å¼€å§‹ä½ç½®å«åš main startï¼Œç»“æŸä½ç½®å«åš main endï¼›äº¤å‰è½´åŒç†ï¼Œ<br>å­å®¹å™¨é»˜è®¤æ²¿ä¸»è½´æ’åˆ—ã€‚å•ä¸ªå­å®¹å™¨å æ®çš„ä¸»è½´ç©ºé—´å«åš main sizeï¼Œå æ®çš„äº¤å‰è½´ç©ºé—´å«åš cross sizeã€‚</p><p>å®¹å™¨å…·æœ‰è¿™æ ·çš„ç‰¹ç‚¹ï¼šçˆ¶å®¹å™¨å¯ä»¥ç»Ÿä¸€è®¾ç½®å­å®¹å™¨çš„æ’åˆ—æ–¹å¼ï¼Œå­å®¹å™¨ä¹Ÿå¯ä»¥å•ç‹¬è®¾ç½®è‡ªèº«çš„æ’åˆ—æ–¹å¼ï¼Œå¦‚æœä¸¤è€…åŒæ—¶è®¾ç½®ï¼Œä»¥å­å®¹å™¨çš„è®¾ç½®ä¸ºå‡†ã€‚</p><h2>çˆ¶å®¹å™¨</h2><p>çˆ¶å®¹å™¨ä¸€å…±æœ‰6ä¸ªå±æ€§: <strong>flex-direction, flex-wrap, flex-flow, justify-content, align-items, align-content</strong></p><h3>flex-direction å±æ€§å†³å®šä¸»è½´çš„æ–¹å‘</h3><table><thead><tr><th style="text-align:left">å±æ€§</th><th style="text-align:left">æè¿°</th><th style="text-align:left">æ•ˆæœ</th></tr></thead><tbody><tr><td style="text-align:left">flex-direction: row</td><td style="text-align:left">ï¼ˆé»˜è®¤å€¼ï¼‰ä¸»è½´ä¸ºæ°´å¹³æ–¹å‘ï¼Œèµ·ç‚¹åœ¨å·¦ç«¯</td><td style="text-align:left"><img src="/assets/img/flex-direction-row.png" alt="flex-direction-row"></td></tr><tr><td style="text-align:left">flex-direction: row-reverse</td><td style="text-align:left">ä¸»è½´ä¸ºæ°´å¹³æ–¹å‘ï¼Œèµ·ç‚¹åœ¨å³ç«¯</td><td style="text-align:left"><img src="/assets/img/flex-direction-row-reverse.png" alt="flex-direction-row-reverse"></td></tr><tr><td style="text-align:left">flex-direction: column</td><td style="text-align:left">ä¸»è½´ä¸ºå‚ç›´æ–¹å‘ï¼Œèµ·ç‚¹åœ¨ä¸Šæ²¿</td><td style="text-align:left"><img src="/assets/img/flex-direction-column.png" alt="flex-direction-column"></td></tr><tr><td style="text-align:left">flex-direction: column-reverse</td><td style="text-align:left">ä¸»è½´ä¸ºå‚ç›´æ–¹å‘ï¼Œèµ·ç‚¹åœ¨ä¸‹æ²¿</td><td style="text-align:left"><img src="/assets/img/flex-direction-column-reverse.png" alt="flex-direction-column-reverse"></td></tr></tbody></table><h3>flex-wrap å†³å®šå­å®¹å™¨æ˜¯å¦æ¢è¡Œæ’åˆ—</h3><table><thead><tr><th style="text-align:left">å±æ€§</th><th style="text-align:left">æè¿°</th><th style="text-align:left">æ•ˆæœ</th></tr></thead><tbody><tr><td style="text-align:left">flex-wrap: nowrap</td><td style="text-align:left">ï¼ˆé»˜è®¤ï¼‰ä¸æ¢è¡Œ</td><td style="text-align:left"><img src="/assets/img/flex-wrap-nowrap.png" alt="flex-wrap-nowrap"></td></tr><tr><td style="text-align:left">flex-wrap: wrap</td><td style="text-align:left">æ¢è¡Œï¼Œç¬¬ä¸€è¡Œåœ¨ä¸Šæ–¹</td><td style="text-align:left"><img src="/assets/img/flex-wrap-wrap.png" alt="flex-wrap-wrap"></td></tr><tr><td style="text-align:left">flex-wrap: wrap-reverse</td><td style="text-align:left">æ¢è¡Œï¼Œç¬¬ä¸€è¡Œåœ¨ä¸‹æ–¹</td><td style="text-align:left"><img src="/assets/img/flex-wrap-wrap-reverse.png" alt="flex-wrap-wrap-reverse"></td></tr></tbody></table><h2>flex-flow</h2><p>flex-direction å±æ€§å’Œ flex-wrap å±æ€§çš„ç®€å†™å½¢å¼ï¼Œé»˜è®¤å€¼ä¸º row nowrap</p><h3>justify-content è®¾ç½®å­å®¹å™¨åœ¨ä¸»è½´ä¸Šçš„å¯¹é½æ–¹å¼</h3><table><thead><tr><th style="text-align:left">å±æ€§</th><th style="text-align:left">æè¿°</th><th style="text-align:left">æ•ˆæœ</th></tr></thead><tbody><tr><td style="text-align:left">justify-content: flex-start</td><td style="text-align:left">ï¼ˆé»˜è®¤ï¼‰èµ·å§‹ç«¯å¯¹é½</td><td style="text-align:left"><img src="/assets/img/flex-start.png" alt="flex-start"></td></tr><tr><td style="text-align:left">justify-content: flex-end</td><td style="text-align:left">æœ«å°¾æ®µå¯¹é½</td><td style="text-align:left"><img src="/assets/img/flex-end.png" alt="flex-end"></td></tr><tr><td style="text-align:left">justify-content: center</td><td style="text-align:left">å±…ä¸­å¯¹é½</td><td style="text-align:left"><img src="/assets/img/flex-center.png" alt="flex-center"></td></tr><tr><td style="text-align:left">justify-content: space-around</td><td style="text-align:left">å­å®¹å™¨æ²¿ä¸»è½´å‡åŒ€åˆ†å¸ƒï¼Œä½äºé¦–å°¾ä¸¤ç«¯çš„å­å®¹å™¨åˆ°çˆ¶å®¹å™¨çš„è·ç¦»æ˜¯å­å®¹å™¨é—´è·çš„ä¸€åŠã€‚</td><td style="text-align:left"><img src="/assets/img/flex-space-around.png" alt="space-around"></td></tr><tr><td style="text-align:left">justify-content: space-between</td><td style="text-align:left">å­å®¹å™¨æ²¿ä¸»è½´å‡åŒ€åˆ†å¸ƒï¼Œä½äºé¦–å°¾ä¸¤ç«¯çš„å­å®¹å™¨ä¸çˆ¶å®¹å™¨ç›¸åˆ‡ã€‚</td><td style="text-align:left"><img src="/assets/img/flex-space-between.png" alt="space-between"></td></tr></tbody></table><h3>align-items è®¾ç½®å­å®¹å™¨æ²¿äº¤å‰è½´çš„å¯¹é½æ–¹å¼</h3><table><thead><tr><th style="text-align:left">å±æ€§</th><th style="text-align:left">æè¿°</th><th style="text-align:left">æ•ˆæœ</th></tr></thead><tbody><tr><td style="text-align:left">align-items: flex-start</td><td style="text-align:left">äº¤å‰è½´çš„èµ·ç‚¹å¯¹é½</td><td style="text-align:left"><img src="/assets/img/align-flex-start.png" alt="flex-start"></td></tr><tr><td style="text-align:left">align-items: flex-end</td><td style="text-align:left">äº¤å‰è½´çš„ç»ˆç‚¹å¯¹é½</td><td style="text-align:left"><img src="/assets/img/align-flex-end.png" alt="flex-start"></td></tr><tr><td style="text-align:left">align-items: center</td><td style="text-align:left">äº¤å‰è½´çš„ä¸­ç‚¹å¯¹é½</td><td style="text-align:left"><img src="/assets/img/align-center.png" alt="align-center"></td></tr><tr><td style="text-align:left">align-items: baseline</td><td style="text-align:left">åŸºçº¿å¯¹é½ï¼ˆé¦–è¡Œæ–‡å­—å¯¹é½ï¼‰æ‰€æœ‰å­å®¹å™¨å‘åŸºçº¿å¯¹é½ï¼Œäº¤å‰è½´èµ·ç‚¹åˆ°å…ƒç´ åŸºçº¿è·ç¦»æœ€å¤§çš„å­å®¹å™¨å°†ä¼šä¸äº¤å‰è½´èµ·å§‹ç«¯ç›¸åˆ‡ä»¥ç¡®å®šåŸºçº¿ã€‚</td><td style="text-align:left"><img src="/assets/img/align-baseline.png" alt="align-baseline"></td></tr><tr><td style="text-align:left">align-items: stretch</td><td style="text-align:left">ï¼ˆé»˜è®¤ï¼‰å¦‚æœå­å®¹å™¨æœªè®¾ç½®é«˜åº¦æˆ–è®¾ä¸ºautoï¼Œå­å®¹å™¨æ²¿äº¤å‰è½´æ–¹å‘çš„å°ºå¯¸æ‹‰ä¼¸è‡³ä¸çˆ¶å®¹å™¨ä¸€è‡´</td><td style="text-align:left"><img src="/assets/img/align-stretch.png" alt="align-stretch"></td></tr></tbody></table><h2>å­å®¹å™¨</h2><p>å­å®¹å™¨ä¸€å…±æœ‰6ä¸ªå±æ€§ï¼š <strong>order, flex-grow, flex-shrink, flex-basis, flex, align-self</strong></p><h3>order æ”¹å˜å­å®¹å™¨çš„æ’åˆ—é¡ºåº</h3><p>é»˜è®¤å€¼ä¸º 0ï¼Œå¯ä»¥ä¸ºè´Ÿå€¼ï¼Œæ•°å€¼è¶Šå°æ’åˆ—è¶Šé å‰ã€‚order åªèƒ½ä¸ºæ•´æ•°ã€‚</p><table><thead><tr><th style="text-align:left">å±æ€§</th><th style="text-align:left">æ•ˆæœ</th></tr></thead><tbody><tr><td style="text-align:left">order: -1</td><td style="text-align:left"><img src="/assets/img/flex-order.png" alt="flex-order"></td></tr></tbody></table><h3>flex-grow å®šä¹‰å­å®¹å™¨å¦‚ä½•ç“œåˆ†å‰©ä½™ç©ºé—´</h3><p>é»˜è®¤å€¼ä¸º 0ï¼Œå°±æ˜¯å³ä½¿å­˜åœ¨å‰©ä½™ç©ºé—´ï¼Œä¹Ÿä¸ç“œåˆ†ã€‚å¦‚æœå®šä¹‰äº†é 0 å€¼ï¼Œåˆ™æŒ‰ç…§æ¯”ä¾‹ç“œåˆ†ã€‚flex-grow åªèƒ½ä¸ºæ•´æ•°ã€‚</p><table><thead><tr><th style="text-align:left">å±æ€§</th><th style="text-align:left">æ•ˆæœ</th></tr></thead><tbody><tr><td style="text-align:left">flex-grow: 1</td><td style="text-align:left"><img src="/assets/img/flex-grow.png" alt="flex-grow"></td></tr></tbody></table><h3>flex-shrink å®šä¹‰äº†å­å®¹å™¨çš„ç¼©å°æ¯”ä¾‹ã€‚</h3><p>é»˜è®¤ä¸º1ï¼Œå³å¦‚æœç©ºé—´ä¸è¶³ï¼Œåˆ™å­å®¹å™¨å°†ç¼©å°ã€‚å¦‚æœæ‰€æœ‰å­å®¹å™¨çš„ flex-shrink éƒ½ä¸º1ï¼Œå½“ç©ºé—´ä¸è¶³æ—¶ï¼Œéƒ½å°†ç­‰æ¯”ä¾‹ç¼©å°ã€‚å¦‚æœæŸä¸ªå­å®¹å™¨çš„ flex-shrink ä¸º0ï¼Œå…¶ä»–å­å®¹å™¨éƒ½ä¸º1ï¼Œåˆ™ç©ºé—´ä¸è¶³æ—¶ï¼Œå‰è€…ä¸ç¼©å°ã€‚</p><table><thead><tr><th style="text-align:left">å±æ€§</th><th style="text-align:left">æ•ˆæœ</th></tr></thead><tbody><tr><td style="text-align:left">flex-shrink: 0</td><td style="text-align:left"><img src="/assets/img/flex-shrink.png" alt="flex-shrink"></td></tr></tbody></table><h3>flex-basis ç”¨æ¥æ”¹å˜å­å®¹å™¨å æ®ä¸»è½´ç©ºé—´çš„å¤§å°</h3><p>è¡¨ç¤ºåœ¨ä¸ä¼¸ç¼©çš„æƒ…å†µä¸‹å­å®¹å™¨å æ®ä¸»è½´ç©ºé—´çš„å¤§å°ï¼Œé»˜è®¤ä¸º autoï¼Œè¡¨ç¤ºå­å®¹å™¨æœ¬æ¥çš„å¤§å°ã€‚</p><h3>flex</h3><p>flex-grow, flex-shrink å’Œ flex-basis çš„ç®€å†™ï¼Œé»˜è®¤å€¼ä¸º 0 1 auto</p><h3>align-self ç”¨æ¥è¦†ç›–çˆ¶å®¹å™¨çš„ align-items å±æ€§</h3><p>align-self å±æ€§å…è®¸å•ä¸ªå­å®¹å™¨æœ‰ä¸å…¶ä»–å­å®¹å™¨ä¸ä¸€æ ·çš„å¯¹é½æ–¹å¼ï¼Œé»˜è®¤å€¼ä¸ºautoï¼Œè¡¨ç¤ºç»§æ‰¿çˆ¶å…ƒç´ çš„ align-items å±æ€§ï¼Œå¦‚æœæ²¡æœ‰çˆ¶å…ƒç´ ï¼Œåˆ™ç­‰åŒäº stretchã€‚æ”¹å±æ€§çš„å–å€¼ä¸ align-items ç›¸åŒã€‚</p><table><thead><tr><th style="text-align:left">å±æ€§</th><th style="text-align:left">æ•ˆæœ</th></tr></thead><tbody><tr><td style="text-align:left">align-self: flex-end</td><td style="text-align:left"><img src="/assets/img/flex-align-self.png" alt="flex-align-self"></td></tr></tbody></table><h2>å‚è€ƒèµ„æ–™</h2><ol><li><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Flexible_Box_Layout" target="_blank" rel="noopener">MDN CSS Flexible Box Layout</a></li><li><a href="http://www.ruanyifeng.com/blog/2015/07/flex-grammar.html?utm_source=tuicool" target="_blank" rel="noopener">Flex å¸ƒå±€æ•™ç¨‹ï¼šè¯­æ³•ç¯‡</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;å¦‚ä½•å±…ä¸­çš„é—®é¢˜&lt;/h2&gt;
&lt;p&gt;å—çŠ¶å…ƒç´ å±…ä¸­æ˜¯ä¸€ä¸ªè€ç”Ÿå¸¸è°ˆçš„è¯é¢˜ï¼Œä¹‹å‰é¢è¯•çš„æ—¶å€™è€ƒå®˜ä¹Ÿæ›¾é—®åˆ°è¿‡è¿™ä¸ªã€‚ä¸‹é¢å†™å‡ ç§å¸¸è§çš„å—çŠ¶å…ƒç´ å±…ä¸­çš„æ–¹å¼ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="css" scheme="https://lz5z.com/categories/css/"/>
    
    
      <category term="flex" scheme="https://lz5z.com/tags/flex/"/>
    
      <category term="css" scheme="https://lz5z.com/tags/css/"/>
    
      <category term="å±…ä¸­" scheme="https://lz5z.com/tags/%E5%B1%85%E4%B8%AD/"/>
    
  </entry>
  
  <entry>
    <title>JavaScript ä¸­çš„ä½œç”¨åŸŸå’Œå£°æ˜æå‡</title>
    <link href="https://lz5z.com/JavaScript%E4%B8%AD%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E5%A3%B0%E6%98%8E%E6%8F%90%E5%8D%87/"/>
    <id>https://lz5z.com/JavaScriptä¸­çš„ä½œç”¨åŸŸå’Œå£°æ˜æå‡/</id>
    <published>2017-04-03T20:19:35.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<p>é¦–å…ˆçœ‹ä¸€ä¸ªå°é—®é¢˜ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="string">'Hello'</span>;</span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  alert(a)</span><br><span class="line">  <span class="keyword">var</span> a = <span class="string">'World'</span></span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure><p>çŒœçŒœå¼¹æ¡†ä¸­ä¼šè¾“å‡º â€˜Helloâ€™ è¿˜æ˜¯ â€˜Worldâ€™ã€‚æ­æ™“ç­”æ¡ˆï¼š â€˜undefinedâ€™ã€‚è¿™é‡Œæ˜¯ä¸€ä¸ª JavaScript çš„å°é™·é˜±â€“JavaScript å˜é‡æå‡ï¼ˆHoistingï¼‰ã€‚</p><a id="more"></a><h2>JavaScript Scoping</h2><p>åœ¨ ES6 ä¹‹å‰ï¼ŒJavaScript æ²¡æœ‰å—çŠ¶ä½œç”¨åŸŸï¼ˆblock-level scopeï¼‰ï¼Œåªæœ‰å‡½æ•°çº§ä½œç”¨åŸŸï¼ˆfunction-level scopeï¼‰ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å—çº§ä½œç”¨åŸŸ</span></span><br><span class="line"><span class="keyword">var</span> name = <span class="string">'Leo'</span></span><br><span class="line"><span class="keyword">if</span> (name) &#123;</span><br><span class="line">  name = <span class="string">'Jack'</span> <span class="comment">// è¿™é‡Œçš„ name æ˜¯å…¨å±€å˜é‡</span></span><br><span class="line">  <span class="built_in">console</span>.log(name) <span class="comment">// Jack</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(name) <span class="comment">// Jack</span></span><br><span class="line"><span class="comment">// å‡½æ•°ä½œç”¨åŸŸ</span></span><br><span class="line"><span class="keyword">var</span> name = <span class="string">'Leo'</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayName</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> name = <span class="string">'Jack'</span></span><br><span class="line">  <span class="built_in">console</span>.log(name) <span class="comment">// Jack    </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(name) <span class="comment">// Leo</span></span><br></pre></td></tr></table></figure><p>å¦‚æœåœ¨å£°æ˜ä¸€ä¸ªå˜é‡çš„æ—¶å€™æ²¡æœ‰ä½¿ç”¨ var å…³é”®å­—ï¼Œé‚£ä¹ˆå˜é‡å°†æˆä¸ºä¸€ä¸ªå…¨å±€å˜é‡ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  a = <span class="string">'Hello World'</span></span><br><span class="line">&#125;)()</span><br><span class="line">alert(a) <span class="comment">// Hello World</span></span><br></pre></td></tr></table></figure><p>åœ¨ setTimeout ä¸­çš„å‡½æ•°æ˜¯åœ¨å…¨å±€ä½œç”¨åŸŸä¸­æ‰§è¡Œçš„ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">1</span></span><br><span class="line"><span class="keyword">var</span> b = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  a: <span class="number">10</span>,</span><br><span class="line">  b: <span class="number">20</span>,</span><br><span class="line">  doCalculate: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="keyword">this</span>.a + <span class="keyword">this</span>.b) <span class="comment">// 3</span></span><br><span class="line">    &#125;, <span class="number">1000</span>)</span><br><span class="line">  &#125;  </span><br><span class="line">&#125;</span><br><span class="line">obj.doCalculate() <span class="comment">// 3</span></span><br></pre></td></tr></table></figure><p>ä¸ºäº†é¿å…å¯¹å…¨å±€ä½œç”¨åŸŸçš„æ±¡æŸ“ï¼Œ æ‰€ä»¥ä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬å°½å¯èƒ½å°‘çš„å£°æ˜å…¨å±€å˜é‡ã€‚</p><p>å…³äº ES6 ä¸­ ä½¿ç”¨ let å’Œ const å£°æ˜å—çº§ä½œç”¨åŸŸçš„å†…å®¹ï¼Œå¯ä»¥å‚è€ƒ <a href="https://lz5z.com/JavaScript%E4%B8%AD%E7%9A%84let%E5%92%8Cconst/">JavaScript ä¸­çš„ let å’Œ const</a>ã€‚</p><p>å…³äº ES5 ä¸­ä¸¥æ ¼æ¨¡å¼çš„å†…å®¹å¯ä»¥å‚è€ƒ <a href="https://lz5z.com/JavaScript%E4%B8%A5%E6%A0%BC%E6%A8%A1%E5%BC%8F/">JavaScript ä¸¥æ ¼æ¨¡å¼</a>ã€‚</p><p>å…³äº JavaScript ä¸­ this çš„è¯¦ç»†ç”¨æ³•å¯ä»¥å‚è€ƒ <a href="https://lz5z.com/JavaScript%E4%B8%AD%E7%9A%84this/">JavaScript ä¸­ çš„this</a>ã€‚</p><h2>JavaScript Hoisting</h2><p>åœ¨ JavaScript ä¸­ï¼Œå‡½æ•°ã€å˜é‡çš„å£°æ˜éƒ½ä¼šè¢«æå‡ï¼ˆhoistingï¼‰åˆ°è¯¥å‡½æ•°æˆ–å˜é‡æ‰€åœ¨çš„ scope çš„é¡¶éƒ¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a </span><br><span class="line"><span class="built_in">console</span>.log(a) <span class="comment">// undefined</span></span><br><span class="line"><span class="built_in">console</span>.log(b) <span class="comment">// undefined</span></span><br><span class="line"><span class="keyword">var</span> b</span><br><span class="line">b = a = <span class="number">10</span></span><br><span class="line"><span class="built_in">console</span>.log(a, b) <span class="comment">// 10 10</span></span><br></pre></td></tr></table></figure><p>åœ¨ JavaScript ä¸­ï¼Œå¦‚æœå£°æ˜ä¸€ä¸ªå˜é‡ï¼Œä½†æ˜¯ä¸ºå¯¹å…¶è¿›è¡Œèµ‹å€¼ï¼Œé‚£ä¹ˆ JS å¼•æ“ä¼šé»˜è®¤è®©å…¶ç­‰äº undefinedã€‚æ‰€ä»¥ä¸Šè¿°ä¾‹å­ä¸­å¯ä»¥çœ‹åˆ°å˜é‡ b åœ¨å£°æ˜åï¼Œè¢«æå‡åˆ°ä½œç”¨åŸŸé¡¶éƒ¨ï¼Œå’Œ a ä¸€æ ·ï¼Œè·å¾—äº† undefined çš„å€¼ã€‚</p><p>é™¤äº†å˜é‡å£°æ˜ä¼šæå‡ï¼Œå‡½æ•°å£°æ˜ä¹Ÿä¼šæå‡ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(add(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)) <span class="comment">// 6</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">eval</span>(<span class="built_in">Array</span>.prototype.join.call(<span class="built_in">arguments</span>, <span class="string">'+'</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼šå‡½æ•°å£°æ˜å¯ä»¥æå‡ï¼Œä½†æ˜¯å‡½æ•°è¡¨è¾¾å¼ä¸èƒ½æå‡ã€‚</p><p>å‡½æ•°å£°æ˜ï¼š <code>function fun(arguments) {}</code><br>å‡½æ•°è¡¨è¾¾å¼ï¼š <code>var fun = function (arguments) {}</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">add(<span class="number">1</span>, <span class="number">2</span>) <span class="comment">// æŠ¥é”™ï¼šUncaught TypeError: add is not a function</span></span><br><span class="line"><span class="keyword">var</span> add = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">eval</span>(<span class="built_in">Array</span>.prototype.join.call(<span class="built_in">arguments</span>, <span class="string">'+'</span>))  </span><br><span class="line">&#125;</span><br><span class="line">add(<span class="number">1</span>, <span class="number">2</span>) <span class="comment">// 3</span></span><br></pre></td></tr></table></figure><p>å‡½æ•°å£°æ˜ä¼šè¦†ç›–å˜é‡å£°æ˜ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> test </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'test'</span>)  </span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> test) <span class="comment">// 'function'</span></span><br></pre></td></tr></table></figure><p>å¦‚æœå˜é‡å·²ç»èµ‹å€¼ï¼Œåˆ™æ— æ³•åˆ«è¦†ç›–ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> test = <span class="string">'test'</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> test) <span class="comment">// 'string'</span></span><br><span class="line">test = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> test) <span class="comment">// 'function'</span></span><br></pre></td></tr></table></figure><h2>ä¼˜å…ˆçº§</h2><p>åœ¨ JavaScript ä¸­ï¼Œä¸€ä¸ªå˜é‡ä»¥å››ç§æ–¹å¼è¿›å…¥ä½œç”¨åŸŸ scopeï¼š</p><ol><li>è¯­è¨€å†…ç½®ï¼šæ‰€æœ‰çš„ä½œç”¨åŸŸä¸­éƒ½æœ‰ this å’Œ arguments å…³é”®å­—ï¼ˆglobal æ²¡æœ‰ argumentsï¼‰;</li><li>å½¢å¼å‚æ•°ï¼šå‡½æ•°çš„å‚æ•°åœ¨å‡½æ•°ä½œç”¨åŸŸä¸­éƒ½æ˜¯æœ‰æ•ˆçš„;</li><li>å‡½æ•°å£°æ˜ï¼šå½¢å¦‚ <code>function foo() {}</code>;</li><li>å˜é‡å£°æ˜ï¼šå½¢å¦‚ <code>var bar</code>;</li></ol><p>å‡½æ•°å£°æ˜å’Œå˜é‡å£°æ˜æ€»æ˜¯ä¼šè¢«ç§»åŠ¨ï¼ˆå³ hoistingï¼‰åˆ°å®ƒä»¬æ‰€åœ¨çš„ä½œç”¨åŸŸçš„é¡¶éƒ¨ã€‚è€Œå˜é‡çš„è§£æé¡ºåºï¼ˆä¼˜å…ˆçº§ï¼‰ï¼Œä¸å˜é‡è¿›å…¥ä½œç”¨åŸŸçš„ 4 ç§æ–¹å¼çš„é¡ºåºä¸€è‡´ï¼Œå¦‚æœä¸€ä¸ªå˜é‡çš„åå­—ä¸å‡½æ•°çš„åå­—ç›¸åŒï¼Œé‚£ä¹ˆå‡½æ•°çš„åå­—ä¼šè¦†ç›–å˜é‡çš„åå­—ï¼Œæ— è®ºå…¶åœ¨ä»£ç ä¸­çš„é¡ºåºå¦‚ä½•ï¼Œä½†æ˜¯åå­—çš„åˆå§‹åŒ–å´æ˜¯æŒ‰å…¶åœ¨ä»£ç ä¸­ä¹¦å†™çš„é¡ºåºè¿›è¡Œçš„ï¼Œä¸å—ä»¥ä¸Šä¼˜å…ˆçº§çš„å½±å“ã€‚</p><p>è€Œå˜é‡çš„è§£æé¡ºåºï¼ˆä¼˜å…ˆçº§ï¼‰ï¼Œä¸å˜é‡è¿›å…¥ä½œç”¨åŸŸçš„ 4 ç§æ–¹å¼çš„é¡ºåºä¸€è‡´ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. var å£°æ˜å¹¶ä¸”èµ‹å€¼é«˜äºå‡½æ•°å£°æ˜</span></span><br><span class="line"><span class="keyword">var</span> test = <span class="string">'test'</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> test) <span class="comment">// 'string'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. å‡½æ•°å£°æ˜é«˜äºå½¢å‚</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span> (<span class="params">a</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">typeof</span> a) <span class="comment">// 'function'</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">a</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line">test(<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. å½¢å‚é«˜äºè¯­è¨€å†…ç½®å˜é‡</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span> (<span class="params">arguments</span>) </span>&#123;</span><br><span class="line">  alert(<span class="built_in">arguments</span>)</span><br><span class="line">&#125;</span><br><span class="line">test(<span class="number">100</span>) <span class="comment">// 100</span></span><br><span class="line"><span class="comment">/*--å¯¹æ¯”ä»¥ä¸‹--*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test1</span> (<span class="params">a</span>) </span>&#123;</span><br><span class="line">  alert(<span class="built_in">arguments</span>) <span class="comment">// [object Arguments]</span></span><br><span class="line">&#125;</span><br><span class="line">test1(<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. å½¢å‚ä¼˜å…ˆçº§é«˜äº var å£°æ˜ä¸èµ‹å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  alert(<span class="built_in">arguments</span>)</span><br><span class="line">  <span class="keyword">var</span> <span class="built_in">arguments</span></span><br><span class="line">&#125;</span><br><span class="line">test() <span class="comment">// [Object Arguments]</span></span><br></pre></td></tr></table></figure><p>å˜é‡å£°æ˜ï¼ˆèµ‹å€¼ï¼‰ &gt; å½¢å‚ &gt; è¯­è¨€å†…ç½®å˜é‡ &gt; å˜é‡å£°æ˜ä¸èµ‹å€¼ &gt; å‡½æ•°å¤–éƒ¨ä½œç”¨åŸŸçš„å…¶ä»–æ‰€æœ‰å£°æ˜</p><p>æ€»ç»“å˜é‡ä¼˜å…ˆçº§æ­£å¥½éªŒè¯äº†ä½œç”¨åŸŸé“¾å¼æŸ¥æ‰¾ï¼Œå±€éƒ¨ä½œç”¨åŸŸ -&gt; ä¸Šä¸€çº§å±€éƒ¨ä½œç”¨åŸŸ -&gt; å…¨å±€ä½œç”¨åŸŸ -&gt; TypeErrorã€‚</p><p>æœ€åçœ‹ä¸€ä¸ªä¾‹å­ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params">arguments</span>) </span>&#123;</span><br><span class="line">  alert(<span class="keyword">typeof</span> <span class="built_in">arguments</span>) <span class="comment">// 'function'</span></span><br><span class="line">  <span class="keyword">var</span> <span class="built_in">arguments</span> = <span class="number">20</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">arguments</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">  alert(<span class="built_in">arguments</span>) <span class="comment">// 20</span></span><br><span class="line">&#125;</span><br><span class="line">test(<span class="number">100</span>)</span><br></pre></td></tr></table></figure><h2>å‚è€ƒæ–‡ç« </h2><p><a href="http://enml.github.io/site/2014/06/13/js-resolution/" target="_blank" rel="noopener">javascriptå˜é‡å£°æ˜ä¼˜å…ˆçº§</a><br><a href="https://github.com/creeperyang/blog/issues/16" target="_blank" rel="noopener">æ·±å…¥ç†è§£JSä¸­å£°æ˜æå‡ã€ä½œç”¨åŸŸï¼ˆé“¾ï¼‰å’Œ this å…³é”®å­—</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;é¦–å…ˆçœ‹ä¸€ä¸ªå°é—®é¢˜ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; a = &lt;span class=&quot;string&quot;&gt;&#39;Hello&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  alert(a)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; a = &lt;span class=&quot;string&quot;&gt;&#39;World&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;)()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;çŒœçŒœå¼¹æ¡†ä¸­ä¼šè¾“å‡º â€˜Helloâ€™ è¿˜æ˜¯ â€˜Worldâ€™ã€‚æ­æ™“ç­”æ¡ˆï¼š â€˜undefinedâ€™ã€‚è¿™é‡Œæ˜¯ä¸€ä¸ª JavaScript çš„å°é™·é˜±â€“JavaScript å˜é‡æå‡ï¼ˆHoistingï¼‰ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="Scoping" scheme="https://lz5z.com/tags/Scoping/"/>
    
      <category term="Hoisting" scheme="https://lz5z.com/tags/Hoisting/"/>
    
  </entry>
  
  <entry>
    <title>PostCSS åˆè¯†</title>
    <link href="https://lz5z.com/PostCSS%E5%88%9D%E8%AF%86/"/>
    <id>https://lz5z.com/PostCSSåˆè¯†/</id>
    <published>2017-03-29T18:20:33.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h2>èƒŒæ™¯</h2><p>ä»Šå¤©åœ¨åƒæ—©é¥­çš„æ—¶å€™å°±è¢«åŒäº‹@ï¼Œè¯´æœ‰ä¸€å—é¡µé¢æ•ˆæœåœ¨æµ‹è¯•æœåŠ¡å™¨çš„éƒ¨ç½²æ•ˆæœè·Ÿæœ¬åœ°ä¸ä¸€æ ·ï¼šä»£ç åœ¨æœ¬åœ°è¿è¡Œæ²¡æœ‰é—®é¢˜ï¼Œéƒ¨ç½²åå‘ç°æœ‰ä¸€ä¸ªåˆ†å‰²çº¿çš„ä½ç½®æ˜æ˜¾ä¸å¯¹ã€‚æ¥åˆ°å…¬å¸åçœ‹äº†åŒäº‹çš„æ¼”ç¤ºï¼Œè§‰å¾—å¯èƒ½æ˜¯ css ä»£ç å‹ç¼©æ—¶å‡ºç°äº†é—®é¢˜ã€‚</p><a id="more"></a><p>é€šè¿‡ chrome æŸ¥çœ‹ç›¸å…³ cssï¼Œå‘ç°äº†é—®é¢˜æ‰€åœ¨ï¼Œæœ‰ä¸€æ®µä»£ç æ˜¯è¿™æ ·å†™çš„ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.clz_editor_container</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: -moz-box;</span><br><span class="line">  <span class="attribute">display</span>: -webkit-flex;</span><br><span class="line">  <span class="attribute">display</span>: -ms-flexbox;</span><br><span class="line">  <span class="attribute">-webkit-box-orient</span>: vertical;</span><br><span class="line">  <span class="attribute">-webkit-flex-direction</span>: column;</span><br><span class="line">  <span class="attribute">-ms-flex-direction</span>: column;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‹ç¼©ååœ¨ chrome ä¸­ä»£ç å˜æˆäº†è¿™æ ·çš„ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.clz_editor_container</span><span class="selector-attr">[data-v-5fd4dedf]</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>: -ms-flexbox;</span><br><span class="line">  <span class="attribute">-ms-flex-direction</span>: column;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶è€Œå®é™…æµè§ˆå™¨ä¸­å‰ä¸¤å¥éƒ½æ²¡æœ‰ç”Ÿæ•ˆã€‚</p><p>å› ä¸ºåœ¨ä»£ç å‹ç¼©æ—¶ï¼Œç›¸åŒçš„ä»£ç ä¼šé»˜è®¤é€‰æ‹©æ¯”è¾ƒé åçš„ï¼Œå› æ­¤ <code>display: -ms-flexbox; -ms-flex-direction: column;</code>ï¼Œè€Œ <code>-ms-flexbox</code> å’Œ <code>-ms-flex-direction</code> æ˜¯ä¸ºäº†å…¼å®¹ IE æµè§ˆå™¨è€Œå­˜åœ¨çš„ï¼Œ æ‰€ä»¥è¿™ä¸¤å¥ css éƒ½æ²¡æœ‰ç”Ÿæ•ˆã€‚</p><p>è€Œæ²¡æœ‰å‹ç¼©çš„ä»£ç åœ¨æµè§ˆå™¨ä¸­è¿è¡Œæ—¶ï¼Œæµè§ˆå™¨è‡ªåŠ¨é€‰æ‹©äº†åˆé€‚çš„ css è¯­å¥æ‰€ä»¥æ²¡æœ‰å‡ºç°é—®é¢˜ã€‚</p><p>è§£å†³æ–¹æ¡ˆå¾ˆç®€å•å•¦ï¼Œè¿™åº”è¯¥æ˜¯åŒäº‹å†™ä»£ç ç²—å¿ƒå¯¼è‡´çš„ï¼Œç›´æ¥æŠŠ <code>display: flex; flex-direction: column;</code>åŠ ä¸Šå°±è¡Œäº†ã€‚è€Œä¸” idea é‡Œé¢è‡ªåŠ¨ä»£ç å…¼å®¹æ€§è¡¥å…¨åŠŸèƒ½ï¼Œæ‰€ä»¥ç”¨ idea å†™å‡ºçš„ä»£ç åº”è¯¥ä¸ä¼šå‡ºç°è¿™ä¸ªé—®é¢˜ã€‚</p><p>ç„¶åæœ‰åŒäº‹è¯´åº”è¯¥æœ‰ä¸€äº›å·¥å…·èƒ½å¤Ÿè‡ªåŠ¨è¡¥å…¨çš„ï¼Œäºæ˜¯ google äº†ä¸€ä¸‹ï¼Œå‘ç°è¿™ç§é—®é¢˜æ—©å°±æœ‰éå¸¸å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œé‚£å°±æ˜¯ PostCSS çš„æ’ä»¶ <a href="https://github.com/postcss/autoprefixer" target="_blank" rel="noopener">autoprefixer</a>ã€‚</p><h2>è§£å†³æ–¹æ¡ˆ</h2><p>é¦–å…ˆå®‰è£… webpack æ’ä»¶ postcss-loader å’Œ autoprefixer</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm i autoprefixer postcss-loader --save-dev</span><br></pre></td></tr></table></figure><p>ç„¶åä¿®æ”¹ webpack é…ç½®æ–‡ä»¶ï¼Œåœ¨æ’ä»¶ç³»ç»Ÿä¸­æ›´æ”¹ LoaderOptionsPluginï¼Œåœ¨ options ä¸­å¢åŠ  postcss</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> webpack.LoaderOptionsPlugin(&#123;</span><br><span class="line">    minimize: process.env.NODE_ENV === <span class="string">'production'</span>,</span><br><span class="line">    options: &#123;</span><br><span class="line">        postcss:[autoprefixer()]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨æ‰€æœ‰ css ç›¸å…³çš„ loader ä¸­å¢åŠ  postcss-loader</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    test: <span class="regexp">/\.vue$/</span>,</span><br><span class="line">    loader: <span class="string">'vue-loader'</span>,</span><br><span class="line">    options: &#123;</span><br><span class="line">        loaders: &#123;</span><br><span class="line">            js: <span class="string">'...'</span>,</span><br><span class="line">            css: ExtractTextPlugin.extract(&#123;</span><br><span class="line">                use: <span class="string">'css-loader!postcss-loader'</span>,</span><br><span class="line">                fallback: <span class="string">'vue-style-loader'</span></span><br><span class="line">            &#125;),</span><br><span class="line">            less: ExtractTextPlugin.extract(&#123;</span><br><span class="line">                fallback: <span class="string">'vue-style-loader'</span>,</span><br><span class="line">                use: <span class="string">'css-loader!postcss-loader!less-loader'</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">    test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">    loader: ExtractTextPlugin.extract(&#123;</span><br><span class="line">        fallback: <span class="string">'style-loader'</span>,</span><br><span class="line">        use: <span class="string">'css-loader!postcss-loader'</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">    test: <span class="regexp">/\.less$/</span>,</span><br><span class="line">    loader: ExtractTextPlugin.extract(&#123;</span><br><span class="line">        fallback: <span class="string">'style-loader'</span>,</span><br><span class="line">        use: <span class="string">'css-loader!postcss-loader!less-loader'</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ postcss-loader åº”è¯¥æ”¾åœ¨ less-loader å’Œ css-loader ä¹‹é—´ï¼Œå¤„ç†é¡ºåºä¸º:<br>less-loader -&gt; postcss-loader -&gt; css-loader -&gt; style-loader</p><p>ä¿®æ”¹å‰é¢å‡ºé—®é¢˜çš„ css ä¸ºåŸç”Ÿ</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.clz_editor_container</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: column;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‡æ–°æ‰“åŒ…å‹ç¼©åçš„ css å¦‚ä¸‹</p><img src="/assets/img/postcss-css.png" alt="cssæ–‡ä»¶"><p>é‡æ–°æ‰“å¼€æŸ¥çœ‹æ•ˆæœï¼Œé—®é¢˜è§£å†³ã€‚</p><p>æ³¨æ„å¦‚æœä½ åœ¨ css ä¸­ä½¿ç”¨ <code>@import</code> å¼•å…¥å…¶å®ƒ css æ–‡ä»¶ï¼Œè€Œè¢«å¼•å…¥çš„æ–‡ä»¶åœ¨ webpack æ‰“åŒ…ååˆæ²¡æœ‰åŠ å…¥æµè§ˆå™¨å‰ç¼€çš„è¯ï¼Œå»ºè®®åœ¨ css-loader ä¸­åŠ å…¥ <code>importLoaders=1</code> å‚æ•°</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">    loader: ExtractTextPlugin.extract(&#123;</span><br><span class="line">        fallback: <span class="string">'style-loader'</span>,</span><br><span class="line">        use: <span class="string">'css-loader?importLoaders=1!postcss-loader'</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2><a href="http://postcss.org/" target="_blank" rel="noopener">PostCSS</a></h2><p>PostCSS æ˜¯ä»€ä¹ˆï¼Ÿå®˜æ–¹ç»™å‡ºçš„å®šä¹‰æ˜¯ï¼š PostCSS æ˜¯ä¸€ä¸ªç”¨ JavaScript è½¬åŒ– CSS çš„å·¥å…·ã€‚å‡†ç¡®çš„è¯´ï¼ŒPostCSS æ˜¯ä¸€ä¸ªå¹³å°ï¼Œé€šè¿‡ä¸€äº›æ’ä»¶ï¼Œèƒ½åšå¾ˆå¤šäº‹æƒ…ï¼š</p><p>ï¼ˆ1ï¼‰ å¢åŠ ä»£ç å¯è¯»æ€§<br>æ¯”å¦‚åˆšæ‰æˆ‘ä»¬ç”¨çš„ <a href="https://github.com/postcss/autoprefixer" target="_blank" rel="noopener">autoprefixer</a>ï¼Œé€šè¿‡ç»™ css æ·»åŠ ä¾›åº”å•†å‰ç¼€ï¼Œè®©æˆ‘ä»¬çš„ css ä»£ç æ›´åŠ ä¼˜é›…ã€‚</p><p>ï¼ˆ2ï¼‰ ä½¿ç”¨æœªæ¥ CSS çš„è¯­æ³•ç‰¹æ€§<br>é€šè¿‡ä½¿ç”¨ <a href="http://cssnext.io/" target="_blank" rel="noopener">cssnext</a> æ’ä»¶ï¼Œå¯ä»¥å…è®¸æˆ‘ä»¬ä½¿ç”¨æœ€æ–°çš„ css è¯­æ³•ï¼Œè€Œä¸ç”¨ç­‰å¾…æµè§ˆå™¨æ”¯æŒã€‚</p><p>ï¼ˆ3ï¼‰global css ç»ˆç»“è€…<br>PostCSS é€šè¿‡ <a href="https://github.com/css-modules/css-modules" target="_blank" rel="noopener">CSS Modules</a> å¯¹ css å‘½ååšæ¨¡å—åŒ–å¤„ç†ï¼Œä¸€èˆ¬ä¸ºæ·»åŠ å‰ç¼€å’Œåç¼€ï¼Œè®©æˆ‘ä»¬å†™ css çš„æ—¶å€™ä¸å¿…æ‹…å¿ƒå‘½åå¤ªé€šç”¨ï¼Œåªè¦è§‰å¾—æœ‰æ„ä¹‰å³å¯ã€‚</p><p>ï¼ˆ4ï¼‰é¿å… css errors<br>é€šè¿‡ä½¿ç”¨ <a href="https://stylelint.io/" target="_blank" rel="noopener">stylelint</a> æ¥é¿å… css errorsã€‚</p><p>ï¼ˆ4ï¼‰æ›´å¼ºå¤§çš„æ …æ ¼ç³»ç»Ÿ<br><a href="http://lostgrid.org" target="_blank" rel="noopener">LostGrid</a> é€šè¿‡ calc() è½»æ¾åˆ›å»ºå¼ºå¤§çš„æ …æ ¼ç³»ç»Ÿã€‚</p><p>ï¼ˆ5ï¼‰<a href="http://postcss.parts/" target="_blank" rel="noopener">æ›´å¤šæ’ä»¶</a> æ›´å¤šåŠŸèƒ½</p><h2>PostCSS webpack</h2><p>åœ¨ webpack ä¸­ä½¿ç”¨ PostCSS çš„ä¸€èˆ¬æ–¹å¼</p><ol><li>å®‰è£…ç›¸å…³ä¾èµ–</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install postcss-loader --save-dev</span><br></pre></td></tr></table></figure><ol start="2"><li>åˆ›å»º postcss.config.js</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="built_in">require</span>(<span class="string">'postcss-smart-import'</span>)(&#123; <span class="comment">/* ...options */</span> &#125;),</span><br><span class="line">    <span class="built_in">require</span>(<span class="string">'precss'</span>)(&#123; <span class="comment">/* ...options */</span> &#125;),</span><br><span class="line">    <span class="built_in">require</span>(<span class="string">'autoprefixer'</span>)(&#123; <span class="comment">/* ...options */</span> &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥é€šè¿‡åœ¨ä¸åŒè·¯å¾„ä¸‹åˆ›å»ºä¸åŒçš„ config æ¥å®ç°é…ç½®è¦†ç›–çš„åŠŸèƒ½ï¼Œåœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºçš„ postcss.config.js ä¼šè¢«å­ç›®å½•ä¸­çš„é…ç½®æ–‡ä»¶è¦†ç›–ã€‚</p><ol start="3"><li>æ·»åŠ  PostCSS Loader åˆ° webpack.config.js ä¸­ï¼Œè®°å¾—è¦æŠŠå®ƒæ”¾åœ¨ css-loader å’Œ style-loader åé¢ï¼Œå¦‚æœæœ‰å…¶å®ƒ loaderï¼Œå¦‚ sass-loader æˆ–è€… less-loaderï¼Œ è¦æ”¾åœ¨å®ƒä»¬å‰é¢ã€‚</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          <span class="string">'style-loader'</span>,</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'css-loader'</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              importLoaders: <span class="number">1</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="string">'postcss-loader'</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="4"><li>å¦‚æœä¸æƒ³ä½¿ç”¨ postcss.config.js çš„è¯ï¼Œä¹Ÿå¯ä»¥æŠŠæ’ä»¶ç›´æ¥å†™å…¥åˆ° webpack.config.js ä¸­</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [&#123;</span><br><span class="line">      test: <span class="regexp">/\.css/</span>,</span><br><span class="line">      use: [â€¦&#123;</span><br><span class="line">        loader: <span class="string">'postcss-loader'</span>,</span><br><span class="line">        options: &#123;</span><br><span class="line">          plugins: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> [</span><br><span class="line">              <span class="built_in">require</span>(<span class="string">'precss'</span>),</span><br><span class="line">              <span class="built_in">require</span>(<span class="string">'autoprefixer'</span>)</span><br><span class="line">            ];</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;]</span><br><span class="line">    &#125;]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2>demo</h2><p>å‡å¦‚æœ‰ style.css å¦‚ä¸‹</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line"> <span class="attribute">--base-color</span>: gray;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">transition</span>: all <span class="number">0.8s</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">var</span>(--base-color);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>webpack é…ç½®æ–‡ä»¶ä¸‹</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> cssnext = <span class="built_in">require</span>(<span class="string">'cssnext'</span>);</span><br><span class="line"><span class="keyword">var</span> autoprefixer = <span class="built_in">require</span>(<span class="string">'autoprefixer'</span>);</span><br><span class="line"><span class="keyword">var</span> px2rem = <span class="built_in">require</span>(<span class="string">'postcss-px2rem'</span>);</span><br><span class="line"><span class="keyword">var</span> Ex = <span class="built_in">require</span>(<span class="string">'extract-text-webpack-plugin'</span>);</span><br><span class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="string">'./src/style.css'</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">"./dist/[name].css"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    loaders: [&#123;</span><br><span class="line">      test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">      loader: Ex.extract(&#123;</span><br><span class="line">        fallback: <span class="string">'style-loader'</span>,</span><br><span class="line">        use: <span class="string">'css-loader!postcss-loader'</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> Ex(&#123;</span><br><span class="line">      filename: <span class="string">'./dist/style.css'</span></span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="keyword">new</span> webpack.LoaderOptionsPlugin(&#123;</span><br><span class="line">      options: &#123;</span><br><span class="line">        postcss: [autoprefixer(&#123;<span class="attr">browsers</span>: [<span class="string">'last 2 versions'</span>]&#125;), </span><br><span class="line">          cssnext(), px2rem(&#123;<span class="attr">remUnit</span>: <span class="number">100</span>&#125;)]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œ webpack å‘½ä»¤åï¼Œdist æ–‡ä»¶å¤¹ä¸‹é¢çš„ style.css å¦‚ä¸‹</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: -webkit-box;</span><br><span class="line">  <span class="attribute">display</span>: -ms-flexbox;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">0.1rem</span>;</span><br><span class="line">  <span class="attribute">-webkit-transition</span>: all <span class="number">0.8s</span>;</span><br><span class="line">  <span class="attribute">transition</span>: all <span class="number">0.8s</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">1rem</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">0.5rem</span>;</span><br><span class="line">  <span class="attribute">background</span>: gray;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä¸€å…±ä½¿ç”¨äº†ä¸‰ä¸ªæ’ä»¶ï¼Œcssnext è§£æ css è‡ªå®šä¹‰å±æ€§å’Œ val() å‡½æ•°ï¼Œautoprefixer æ·»åŠ æµè§ˆå™¨å‰ç¼€ï¼Œpostcss-px2rem å®Œæˆ px åˆ° rem å•ä½çš„è½¬åŒ–ã€‚</p><h2>å‚è€ƒèµ„æ–™</h2><ol><li>å‚è€ƒ <a href="http://postcss.org/" target="_blank" rel="noopener">PostCSS</a> å®˜æ–¹ç½‘ç«™ï¼Œäº†è§£ PostCSS çš„æ›´å¤šå†…å®¹ã€‚</li><li><a href="https://github.com/postcss/autoprefixer" target="_blank" rel="noopener">autoprefixer</a></li><li><a href="http://cssnext.io/" target="_blank" rel="noopener">cssnext</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;èƒŒæ™¯&lt;/h2&gt;
&lt;p&gt;ä»Šå¤©åœ¨åƒæ—©é¥­çš„æ—¶å€™å°±è¢«åŒäº‹@ï¼Œè¯´æœ‰ä¸€å—é¡µé¢æ•ˆæœåœ¨æµ‹è¯•æœåŠ¡å™¨çš„éƒ¨ç½²æ•ˆæœè·Ÿæœ¬åœ°ä¸ä¸€æ ·ï¼šä»£ç åœ¨æœ¬åœ°è¿è¡Œæ²¡æœ‰é—®é¢˜ï¼Œéƒ¨ç½²åå‘ç°æœ‰ä¸€ä¸ªåˆ†å‰²çº¿çš„ä½ç½®æ˜æ˜¾ä¸å¯¹ã€‚æ¥åˆ°å…¬å¸åçœ‹äº†åŒäº‹çš„æ¼”ç¤ºï¼Œè§‰å¾—å¯èƒ½æ˜¯ css ä»£ç å‹ç¼©æ—¶å‡ºç°äº†é—®é¢˜ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="https://lz5z.com/tags/JavaScript/"/>
    
      <category term="webpack" scheme="https://lz5z.com/tags/webpack/"/>
    
      <category term="CSS" scheme="https://lz5z.com/tags/CSS/"/>
    
      <category term="PostCSS" scheme="https://lz5z.com/tags/PostCSS/"/>
    
  </entry>
  
  <entry>
    <title>webpack ä»å…¥é—¨åˆ°æ”¾å¼ƒ</title>
    <link href="https://lz5z.com/webpack/"/>
    <id>https://lz5z.com/webpack/</id>
    <published>2017-03-11T18:06:04.000Z</published>
    <updated>2020-04-21T10:23:54.831Z</updated>
    
    <content type="html"><![CDATA[<h2>ç®€ä»‹</h2><p>Webpack + ES6 å·²ç»æˆä¸ºç›®å‰æœ€æµè¡Œçš„å‰ç«¯è§£å†³æ–¹æ¡ˆï¼Œæœ¬æ–‡æ˜¯ Webpack2 å­¦ä¹ æ•™ç¨‹ã€‚</p><p>åœ¨ ã€Œ<a href="https://webpack.github.io/docs/what-is-webpack.html" target="_blank" rel="noopener">What is webpack</a>ã€ä¸€æ–‡ä¸­ä½œè€…è®²è¿°äº†è‡ªå·±ä¸ºä»€ä¹ˆè¦å¼€å‘å‡º webpackã€‚</p><ol><li>åˆ‡åˆ†ä»£ç ä¾èµ–æ ‘åˆ°ä¸åŒçš„ä»£ç å—ï¼ŒæŒ‰éœ€åŠ è½½</li><li>ä¿æŒæ›´å°‘çš„åˆå§‹åŒ–åŠ è½½æ—¶é—´</li><li>æŠŠä»»ä½•é™æ€èµ„æºéƒ½è§†ä¸ºæ¨¡å—</li><li>æŠŠä»»ä½•ç¬¬ä¸‰æ–¹ç±»åº“ä¹Ÿå½“ä½œæ¨¡å—</li><li>åœ¨æ¨¡å—æ‰“åŒ…ä¸­æ¯ä¸€éƒ¨åˆ†éƒ½å…è®¸è‡ªå®šä¹‰</li><li>æ›´åŠ é€‚åˆå¤§å‹é¡¹ç›®</li></ol><a id="more"></a><h2>ä½¿ç”¨</h2><h3>å®‰è£…</h3><p>æ–°å»º webpack-demo æ–‡ä»¶å¤¹ï¼Œå®‰è£… webpack åˆ° dev</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> mkdir webpack-demo</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> npm init -y</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> npm i webpack --save-dev</span></span><br></pre></td></tr></table></figure><h3>å‘½ä»¤è¡Œæ‰“åŒ…</h3><p>æ–°å»ºä¸€ä¸ª hello.js æ–‡ä»¶</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hello</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="string">'Hello webpack'</span>)</span><br><span class="line">&#125;</span><br><span class="line">hello()</span><br></pre></td></tr></table></figure><p>åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ä¸‹é¢å†…å®¹è¿›è¡Œæ‰“åŒ…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> webpack hello.js hello.bundle.js</span></span><br></pre></td></tr></table></figure><p>æ‰“å¼€æ‰“åŒ…åçš„æ–‡ä»¶å‘ç°é‡Œé¢æ³¨å…¥äº†å¾ˆå¤š webpack æ‰€éœ€çš„ä¸€äº›å†…ç½®å‡½æ•°ï¼Œæ¯”å¦‚ <strong><code>__webpack_require__</code></strong>ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œwebpack è¿˜å¯¹æˆ‘ä»¬å†™çš„ä»£ç è¿›è¡Œç¼–å·ï¼Œæ¯”å¦‚åˆšæ‰æˆ‘ä»¬å†™çš„ hello function åœ¨ hello.bundle.js ä¸­çš„ç¼–å·å°±æ˜¯  <code>/* 0 */</code>ã€‚</p><h3>å¼•å…¥cssæ–‡ä»¶</h3><p>æ–°å»º style.css æ–‡ä»¶</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: gray;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ hello.js ä¸­å¼•å…¥è¯¥æ–‡ä»¶</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">'./style.css'</span>)</span><br></pre></td></tr></table></figure><p>å†æ¬¡ä½¿ç”¨åˆšæ‰çš„å‘½ä»¤æ‰“åŒ…ï¼Œå‘ç°å‘½ä»¤è¡ŒæŠ¥é”™</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ERROR </span>in ./style.css</span><br><span class="line">Module parse failed: D:\webpack-demo\style.css Unexpected token (1:11)</span><br><span class="line">You may need an appropriate loader to handle this file type.</span><br><span class="line">| html, body &#123;</span><br><span class="line">|       background-color: gray;</span><br><span class="line"> @ ./hello.js 2:0<span class="string">-22</span></span><br></pre></td></tr></table></figure><p>é”™è¯¯æç¤ºå¾ˆæ˜æ˜¾ï¼šæ¨¡å—è§£æé”™è¯¯ï¼Œä½ å¯èƒ½éœ€è¦ä¸€ä¸ªåˆé€‚çš„ loader å»å¤„ç†è¿™ç§ç±»å‹çš„æ–‡ä»¶ã€‚</p><p>webpack é»˜è®¤ä¸æ”¯æŒ css æ–‡ä»¶ç±»å‹ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥å®‰è£… css-loader å’Œ style-loader</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npm i css-loader style-loader --save-dev</span></span><br></pre></td></tr></table></figure><p>css-loader æ˜¯ä½¿ webpack å¯ä»¥å¤„ç† css æ–‡ä»¶ï¼›style-loader æŠŠ css-loader å¤„ç†å®Œçš„ä»£ç ï¼Œæ–°å»ºä¸€ä¸ª style æ ‡ç­¾ï¼Œæ’å…¥åˆ° HTML ä»£ç ä¸­ã€‚</p><p>ç„¶åå°†è¿™ä¸¤ä¸ª loader å¼•å…¥ hello.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">'style-loader!css-loader!./style.css'</span>)</span><br></pre></td></tr></table></figure><p>å†æ¬¡è¿è¡Œæ‰“åŒ…å‘½ä»¤å°±å¯ä»¥åœ¨ hello.bundle.js ä¸­æ‰¾åˆ°ä¸‹é¢è¿™å¥è¯</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exports.push([<span class="built_in">module</span>.i, <span class="string">"body &#123;\r\n\tbackground-color: gray;\r\n&#125;"</span>, <span class="string">""</span>]);</span><br></pre></td></tr></table></figure><p>ä¸ºäº†æŸ¥çœ‹æ•ˆæœï¼Œæˆ‘ä»¬æ–°å»º index.html</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>webpack demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./hello.bundle.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ‰“å¼€ index.html æŸ¥çœ‹æ•ˆæœï¼Œå‘ç° style-loader åœ¨ head ä¸­æ’å…¥äº†ä¸€ä¸ª style æ ‡ç­¾å°† css æ’å…¥ html ä¸­ã€‚</p><h2>webpack <a href="https://webpack.js.org/configuration/" target="_blank" rel="noopener">é…ç½®æ–‡ä»¶</a></h2><p>åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ <code>webpack</code> å‘½ä»¤ï¼Œwebpack ä¼šè‡ªåŠ¨å¯»æ‰¾ webpack.config.js æ–‡ä»¶ï¼Œå¹¶æŒ‰ç…§é‡Œé¢çš„é…ç½®å¯¹é¡¹ç›®è¿›è¡Œæ‰“åŒ…ã€‚è¿˜å¯ä»¥é€šè¿‡ <code>--config</code> å‚æ•°æŒ‡å®š webpack é…ç½®æ–‡ä»¶ã€‚</p><p>webpack.config.js ä½¿ç”¨ CommonJS è§„èŒƒï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªæœ€åŸºç¡€çš„é…ç½®æ–‡ä»¶</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="string">'./src/script/main.js'</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    path: <span class="string">'./dist/js'</span>,</span><br><span class="line">    filename: <span class="string">'bundle.js'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>entry</code> å‚æ•°è¡¨æ˜æˆ‘ä»¬çš„æ‰“åŒ…æ˜¯ä»å“ªä¸ªæ–‡ä»¶å¼€å§‹çš„ï¼Œ<code>output</code> å‚æ•°å®šä¹‰æ‰“åŒ…åçš„æ–‡ä»¶å¦‚ä½•å­˜å‚¨ã€‚</p><p>å¦‚æœéœ€è¦ä½¿ç”¨ä¸€äº› webpack çš„å‚æ•°ï¼Œå¯ä»¥ä½¿ç”¨ npm è„šæœ¬æ¥å®ç°ï¼Œæ¯”å¦‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"webpack"</span>: <span class="string">"webpack --display-modules --sort-modules-by size"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢æ˜¯æˆ‘ä»¬åˆ†æ webpack æ‰“åŒ…åæ–‡ä»¶å¸¸ç”¨çš„æ–¹å¼ï¼ŒæŠŠæ¯ä¸ª modules æ˜¾ç¤ºå‡ºæ¥ï¼Œå¹¶ä¸”æŒ‰ç…§æ–‡ä»¶å¤§å°æ’åºã€‚</p><h2>webpack å‡ ä¸ªé‡è¦æ¦‚å¿µ</h2><h3><a href="https://webpack.js.org/concepts/entry-points/" target="_blank" rel="noopener">entry</a></h3><p>webpack æ ¹æ® entry åˆ›å»ºæ‰€æœ‰åº”ç”¨ç¨‹åºä¾èµ–å›¾è¡¨ï¼Œentry å‘Šè¯‰ webpack ä»å“ªé‡Œå¼€å§‹ï¼Œå¹¶éµå¾ªç€ä¾èµ–å…³ç³»å›¾æ‰“åŒ…ã€‚</p><p>entry æœ‰ä»¥ä¸‹å‡ ç§å†™æ³•</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">entry: <span class="string">'./src/app.js'</span></span><br><span class="line">entry: [<span class="string">'./src/app.js'</span>, <span class="string">'./src/vendors.js'</span>]</span><br><span class="line">entry: &#123;</span><br><span class="line">    main: <span class="string">'./src/app.js'</span></span><br><span class="line">&#125;</span><br><span class="line">entry: &#123;</span><br><span class="line">    app: <span class="string">'./src/app.js'</span>,</span><br><span class="line">    vendors: <span class="string">'./src/vendors.js'</span></span><br><span class="line">&#125;</span><br><span class="line">entry: &#123;</span><br><span class="line">    pageOne: <span class="string">'./src/pageOne/index.js'</span>,</span><br><span class="line">    pageTwo: <span class="string">'./src/pageTwo/index.js'</span>,</span><br><span class="line">    pageThree: <span class="string">'./src/pageThree/index.js'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŒ‡å®šå¤šå…¥å£ä¸»è¦ä¸ºäº†è§£å†³ä¸¤ç§åœºæ™¯ï¼Œä¸€ä¸ªæ˜¯å°†ä¸šåŠ¡ä»£ç å’Œæ¡†æ¶ä»£ç åˆ†å‰²ï¼Œä¸€ä¸ªæ˜¯ä¸ºäº†å¤„ç†å¤šé¡µé¢åº”ç”¨ã€‚ä½¿ç”¨ <a href="https://github.com/webpack/docs/wiki/list-of-plugins#commonschunkplugin" target="_blank" rel="noopener">CommonsChunkPlugin</a> æ’ä»¶å¯ä»¥å°†å…¬å…±çš„ç±»åº“ä»£ç æ‰“åŒ…æˆä¸€ä¸ª common æ¨¡å—ã€‚è¿™æ ·åœ¨å¤šé¡µé¢ç¨‹åºä¸­å¯ä»¥æŠŠå…±ç”¨ä»£ç ç¼“å­˜èµ·æ¥ï¼Œæ–¹ä¾¿å…¶ä»–é¡µé¢ä½¿ç”¨ã€‚</p><h3><a href="https://webpack.js.org/concepts/output/" target="_blank" rel="noopener">output</a></h3><p>output å‚æ•°å‘Šè¯‰ webpack å¦‚ä½•æŠŠç¼–è¯‘åçš„æ–‡ä»¶å†™å…¥åˆ°ç£ç›˜é‡Œï¼Œæ— è®ºæœ‰å¤šå°‘ä¸ª entry éƒ½åªæœ‰ä¸€ä¸ª output é…ç½®ã€‚ä¸€èˆ¬å½¢å¼çš„å†™æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">output: &#123;</span><br><span class="line">    filename: <span class="string">'bundle.js'</span>,</span><br><span class="line">    path: __dirname + <span class="string">'/build'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>output.path æ˜¯ä¸€ä¸ªç»å¯¹è·¯å¾„ï¼Œfilename æŒ‡ç”Ÿäº§æ‰“åŒ…æ–‡ä»¶åçš„åç§°</p><p>å‡å¦‚ entry ä¸ºå¤šå…¥å£ï¼Œä½¿ç”¨ä¸Šè¿°å†™æ³•åªä¼šç”Ÿäº§ä¸€ä¸ª bundle.jsï¼Œä¸ç¬¦åˆæˆ‘ä»¬ä»£ç åˆ†å‰²çš„éœ€æ±‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨ä¸€äº›å ä½ç¬¦æ¥è¡¨ç¤ºè¾“å‡ºçš„ç»“æœã€‚ä¸€å…±æœ‰å››ç§å ä½ç¬¦ï¼š[id], [name], [hash], [chunkhash]ã€‚æ³¨æ„ [hash] æŒ‡çš„æ˜¯æœ¬æ¬¡æ‰“åŒ…çš„ hashï¼Œè¿™ä¸ª hash åœ¨ webpack æ‰“åŒ…æ—¶æ—¥å¿—çš„ç¬¬ä¸€è¡Œæ˜¾ç¤ºã€‚è€Œ [chunkhash] æ˜¯æ¯ä¸€ä¸ª chunk è‡ªå·±çš„ hash å€¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">entry: &#123;</span><br><span class="line">    app: <span class="string">'./src/app.js'</span>,</span><br><span class="line">    search: <span class="string">'./src/search.js'</span></span><br><span class="line">&#125;,</span><br><span class="line">output: &#123;</span><br><span class="line">    filename: <span class="string">'[name]-[chunkhash].js'</span>,</span><br><span class="line">    path: __dirname + <span class="string">'/build'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>hash å€¼ç”± md5 ç®—æ³•ç”Ÿæˆï¼Œå¯ä»¥å½“åšæ¯ä¸ªæ–‡ä»¶çš„ç‰ˆæœ¬å·ï¼Œè¿™ç‚¹å¯¹äºæˆ‘ä»¬ç®¡ç†äº§å“æ—¶æ¯æ¬¡åªä¸Šçº¿è¢«æ›´æ”¹çš„æ–‡ä»¶éå¸¸æœ‰ç”¨ã€‚å¦‚æœè§‰å¾—é»˜è®¤ hash å€¼å¤ªé•¿äº†ï¼Œå¯ä»¥é€šè¿‡ [chunkhash:8] æ¥æŒ‡å®š hash ä½æ•°ã€‚</p><p>é€šå¸¸æˆ‘ä»¬ä¸Šçº¿äº§å“ä¼šä½¿ç”¨ cdn åŠ é€Ÿé™æ€èµ„æºæ–‡ä»¶çš„è·å–ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ cdn å†™å…¥åˆ° output.publicPath ä¸­ã€‚publicPath è¡¨ç¤ºå¦‚æœäº§å“ä¸Šçº¿ï¼Œjs çš„è·¯å¾„å°±ä¼šè‡ªåŠ¨åŠ ä¸Š publicPathã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">output: &#123;</span><br><span class="line">    filename: <span class="string">'[name]-[chunkhash].js'</span>,</span><br><span class="line">    path: __dirname + <span class="string">'/build'</span>,</span><br><span class="line">    publicPath: <span class="string">'http://cdn.example.com/'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3><a href="https://webpack.js.org/concepts/loaders/" target="_blank" rel="noopener">loaders</a></h3><p>webpack ä¸­æŠŠæ‰€æœ‰çš„èµ„æºéƒ½å½“åšä¸€ä¸ªæ¨¡å—ï¼Œæ— è®ºè¿™ä¸ªæ–‡ä»¶æ˜¯ä»£ç æ–‡ä»¶ï¼Œè¿˜æ˜¯å›¾ç‰‡æ–‡ä»¶ï¼Œåªè¦æœ‰å¯¹åº”çš„ loader å‡å¯ä»¥åœ¨ webpack ä¸­è½¬æ¢ä½¿ç”¨ï¼Œè¿™ä¹Ÿæ˜¯ webpack æœ€å¤§çš„ä¼˜åŠ¿æ‰€åœ¨ã€‚</p><p>å‰é¢ã€Œå¼•å…¥cssæ–‡ä»¶ã€ä¸­å·²ç»å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ loaderï¼Œé€šå¸¸é…ç½®æ–¹å¼å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">        &#123;</span><br><span class="line">            test: <span class="regexp">/\.(js|jsx)$/</span>,</span><br><span class="line">            use: <span class="string">'babel-loader'</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>test è¯´æ˜äº†å½“å‰ loader èƒ½å¤„ç†é‚£äº›ç±»å‹çš„æ–‡ä»¶çš„æ­£åˆ™åŒ¹é…ï¼Œuse åˆ™æŒ‡å®šäº† loader çš„ç±»å‹ã€‚</p><p>æ³¨ï¼šè¿™é‡Œè¯´ä¸€ä¸‹ webpack1 ä¸ webpack2 çš„åŒºåˆ«ï¼Œåœ¨ webpack1 ä¸­ï¼Œä½¿ç”¨ module.loaders å£°æ˜ loaderï¼Œè€Œ webpack2 ä¸­ä½¿ç”¨åŠŸèƒ½æ›´ä¸ºå¼ºå¤§çš„ module.rulesã€‚ ä¸ºäº†å…¼å®¹æ—§ç‰ˆï¼Œmodule.loaders è¯­æ³•ä»ç„¶æœ‰æ•ˆï¼Œæ—§çš„å±æ€§åä¾ç„¶å¯ä»¥è¢«è§£æã€‚</p><p>loader è¿˜å¯ä»¥åœ¨ä½¿ç”¨çš„æ—¶å€™ä¼ å…¥ç›¸å…³çš„å‚æ•°ï¼Œæ¯”å¦‚æˆ‘ä»¬ä½¿ç”¨ css-loader æ—¶</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [&#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">            <span class="string">'style-loader'</span>, </span><br><span class="line">            &#123;</span><br><span class="line">                loader: <span class="string">'css-loader'</span>,</span><br><span class="line">                options: &#123;</span><br><span class="line">                    importLoaders: <span class="number">1</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨ï¼šåœ¨ webpack 1 ä¸­ï¼Œloader å¯ä»¥é“¾å¼è°ƒç”¨ï¼Œä¸Šä¸€ä¸ª loader çš„è¾“å‡ºè¢«ä½œä¸ºè¾“å…¥ä¼ ç»™ä¸‹ä¸€ä¸ª loaderï¼Œé€šå¸¸è¢«ç”¨ ! è¿å†™ï¼Œå¦‚ <code>loader: &quot;style-loader!css-loader!less-loader&quot;</code>ã€‚è¿™ä¸€å†™æ³•åœ¨ webpack 2 ä¸­åªåœ¨ä½¿ç”¨æ—§çš„é€‰é¡¹ module.loaders æ—¶æ‰æœ‰æ•ˆã€‚ä½¿ç”¨ rule.use é…ç½®é€‰é¡¹ï¼Œuse å¯ä»¥è®¾ç½®ä¸ºä¸€ä¸ª loader æ•°ç»„ã€‚ä½¿ç”¨ module.rules æ—¶ï¼Œå¦‚æœåªæœ‰ä¸€ä¸ª loaderï¼Œæ—¢å¯ä»¥ç”¨ loader åˆå¯ä»¥ç”¨ useï¼Œä½†æ˜¯å¦‚æœæ˜¯å¤š loaderï¼Œåˆ™åªèƒ½ä½¿ç”¨ useã€‚</p><h4>å¤„ç† ES6 è¯­æ³•</h4><p>é¦–å…ˆå®‰è£… babel</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npm install babel-loader babel-core --save-dev</span></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ webpack é…ç½®æ–‡ä»¶</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [&#123;</span><br><span class="line">        test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">        exclude: path.resolve(__dirname, <span class="string">'node_modules/'</span>),</span><br><span class="line">        include: path.resolve(__dirname, <span class="string">'src/'</span>),</span><br><span class="line">        loader: <span class="string">"babel-loader"</span></span><br><span class="line">    &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„è¿™é‡Œä¸€å®šè¦åŠ ä¸Š exclude æˆ–è€… includeï¼Œå› ä¸º babel-loader å¤„ç†çš„é€Ÿåº¦éå¸¸æ…¢ã€‚<br>ç„¶åè¿˜éœ€è¦æŒ‡å®šæ‰€ç”¨ ECMAScript çš„ç‰ˆæœ¬ï¼Œå‡å¦‚ä½¿ç”¨ ES6 è¯­æ³•</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npm install babel-preset-es2015 --save-dev</span></span><br></pre></td></tr></table></figure><p>å‘Šè¯‰ webpack babel ä½¿ç”¨å“ªä¸ªç‰ˆæœ¬çš„ preset æœ‰ä¸‰ç§æ–¹å¼</p><p>(1) åœ¨ webpack ä¸­å£°æ˜</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [&#123;</span><br><span class="line">        test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">        exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">        loader: <span class="string">"babel-loader"</span>,</span><br><span class="line">        query: &#123;</span><br><span class="line">            presets: [<span class="string">"es2015"</span>]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨ï¼š å¦‚æœ loader éœ€è¦ä¼ å‚æ•°çš„è¯ï¼Œæ—¢å¯ä»¥å†™æˆ query çš„å½¢å¼ï¼Œä¹Ÿå¯ä»¥å†™æˆåƒ url ä¼ å‚ä¸€æ ·çš„å½¢å¼ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rules: [&#123;</span><br><span class="line">    test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">    exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">    loader: <span class="string">"babel-loader?presets=es2015"</span></span><br><span class="line">&#125;]</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯å¦‚æœä¸ºå¤š loader çš„è¯ï¼Œåªèƒ½ç”¨ use + options çš„å½¢å¼ã€‚</p><p>(2) åœ¨æ ¹ç›®å½•åˆ›å»º .babelrc æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"presets"</span>: [<span class="string">"es2015"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(3) åœ¨ package.json ä¸­æŒ‡å®š preset</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"babel"</span>: &#123;</span><br><span class="line">  <span class="string">"presets"</span>: [<span class="string">"es2015"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3><a href="https://webpack.js.org/concepts/plugins/" target="_blank" rel="noopener">plugins</a></h3><p>æ’ä»¶æ˜¯ wepback çš„æ”¯æŸ±åŠŸèƒ½ã€‚åœ¨ä½ ä½¿ç”¨ webpack é…ç½®æ—¶ï¼Œwebpack è‡ªèº«ä¹Ÿæ„å»ºäºåŒæ ·çš„æ’ä»¶ç³»ç»Ÿä¸Šï¼æ’ä»¶ç›®çš„åœ¨äºè§£å†³ loader æ— æ³•å®ç°çš„å…¶ä»–äº‹ï¼Œåœ¨<a href="https://webpack.js.org/plugins/" target="_blank" rel="noopener">è¿™ä¸ªé¡µé¢</a>ä½ å¯ä»¥çœ‹åˆ°ä¸€äº› webpack å¸¸ç”¨çš„æ’ä»¶ã€‚</p><p>ç”±äº plugin å¯ä»¥ä¼ é€’å‚æ•°ï¼Œä½ å¿…é¡»åœ¨ wepback é…ç½®ä¸­ï¼Œå‘ plugins å±æ€§ä¼ å…¥ new å®ä¾‹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>); <span class="comment">//é€šè¿‡ npm å®‰è£…</span></span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>); <span class="comment">//è®¿é—®å†…ç½®çš„æ’ä»¶</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> config = &#123;</span><br><span class="line">  entry: <span class="string">'./path/to/my/entry/file.js'</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">'my-first-webpack.bundle.js'</span>,</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'dist'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    loaders: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(js|jsx)$/</span>,</span><br><span class="line">        loader: <span class="string">'babel-loader'</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> webpack.optimize.UglifyJsPlugin(),</span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(&#123;<span class="attr">template</span>: <span class="string">'./src/index.html'</span>&#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = config;</span><br></pre></td></tr></table></figure><h3>html-webpack-plugin ä½¿ç”¨</h3><p>ä¸‹é¢æˆ‘ä»¬ä»¥æœ€å¸¸ç”¨çš„ <strong><a href="https://github.com/jantimon/html-webpack-plugin" target="_blank" rel="noopener">html-webpack-plugin</a></strong> ä¸ºä¾‹ï¼Œè®²è§£æ’ä»¶çš„ç”¨æ³•ã€‚</p><p>é¦–å…ˆä½¿ç”¨ npm å®‰è£…æ’ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npm i html-webpack-plugin --save-dev</span></span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨ webpack.config.js é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> htmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>)</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: &#123;</span><br><span class="line">        app: <span class="string">'./src/script/main.js'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    output: &#123;</span><br><span class="line">        filename: <span class="string">'[name]-[chunkhash:8].js'</span>,</span><br><span class="line">        path: __dirname + <span class="string">'/build'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> htmlWebpackPlugin(&#123;</span><br><span class="line">            filename: <span class="string">'index-[hash].html'</span>,</span><br><span class="line">            template: <span class="string">'index.html'</span></span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>html-webpack-plugin</strong> æ’ä»¶è¿˜èƒ½æ¥å—ä¸€äº›å…¶å®ƒå‚æ•°ï¼Œæ¯”å¦‚<code>title</code>ã€<code>inject: (true | 'head' | 'body' | false)</code>ã€<code>favicon</code>ã€<code>minify</code>ã€<code>hash</code>ã€<code>cache</code>ç­‰ã€‚</p><p>è¿˜å¯ä»¥è®¾ç½®ä¸€äº›è‡ªå®šä¹‰çš„å‚æ•°ï¼Œåœ¨ html æ–‡ä»¶ä¸­é€šè¿‡ç±»ä¼¼ js æ¨¡æ¿è¯­è¨€çš„æ–¹å¼è¿›è¡Œå¼•ç”¨ã€‚<br>æ¯”å¦‚åœ¨ webpack é…ç½®æ–‡ä»¶ä¸­</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">plugins: [</span><br><span class="line">    <span class="keyword">new</span> htmlWebpackPlugin(&#123;</span><br><span class="line">        template: <span class="string">'index.html'</span>,</span><br><span class="line">        date: <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line">    &#125;)</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨ index.html ä¸­ä½¿ç”¨ <code>&lt;%= htmlWebpackPlugin.options.date %&gt;</code> å¯¹ date è¿›è¡Œå¼•ç”¨ï¼Œè¿™æ ·å°±ç»™äº†æˆ‘ä»¬æ›´å¤§çš„è‡ªç”±åº¦ï¼Œç”¨ç›¸åŒçš„ html æ¨¡æ¿ç”Ÿæˆä¸åŒçš„ html æ–‡ä»¶ã€‚</p><p>é€šè¿‡åŠ ä¸Š minify æ¥å®ç°å¯¹ html æ–‡ä»¶çš„å‹ç¼©ï¼Œminify ä¼ å…¥ä¸€ä¸ª <a href="https://github.com/kangax/html-minifier#options-quick-reference" target="_blank" rel="noopener">html-minify</a> å¯¹è±¡ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">plugins: [</span><br><span class="line">    <span class="keyword">new</span> htmlWebpackPlugin(&#123;</span><br><span class="line">        template: <span class="string">'index.html'</span>,</span><br><span class="line">        minify: &#123;</span><br><span class="line">            removeComments: <span class="literal">true</span>,</span><br><span class="line">            collapseInlineTagWhitespace: <span class="literal">true</span>,</span><br><span class="line">            collapseWhitespace: <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>å¯¹äºä¸€ä¸ªå¤šé¡µé¢åº”ç”¨ç¨‹åºï¼Œéœ€è¦ç”Ÿæˆå¤šå°‘ä¸ªé¡µé¢ï¼Œå°± new å¤šå°‘ä¸ª htmlWebpackPlugin å®ä¾‹ã€‚å‡å¦‚ä¸åŒçš„é¡µé¢ä¾èµ–ä¸åŒçš„ chunksï¼Œ é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ chunks å‚æ•°æŒ‡å®šå½“å‰é¡µé¢æ‰€ä½¿ç”¨çš„ chunksã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨ excludeChunks æ¥æŒ‡å®šæ’é™¤äº†æŸäº› chunks ä»¥åçš„å…¨éƒ¨ chunksã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> htmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: &#123;</span><br><span class="line">        a: <span class="string">'./src/script/a.js'</span>,</span><br><span class="line">        b: <span class="string">'./src/script/b.js'</span>,</span><br><span class="line">        c: <span class="string">'./src/script/c.js'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    output: &#123;</span><br><span class="line">        filename: <span class="string">'js/[name]-[chunkhash:8].js'</span>,</span><br><span class="line">        path: __dirname + <span class="string">'/build'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> htmlWebpackPlugin(&#123;</span><br><span class="line">            filename: <span class="string">'a.html'</span>,</span><br><span class="line">            template: <span class="string">'index.html'</span>,</span><br><span class="line">            title: <span class="string">'page a'</span>,</span><br><span class="line">            chunks: [<span class="string">'a'</span>]</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> htmlWebpackPlugin(&#123;</span><br><span class="line">            filename: <span class="string">'b.html'</span>,</span><br><span class="line">            template: <span class="string">'index.html'</span>,</span><br><span class="line">            title: <span class="string">'page b'</span>,</span><br><span class="line">            chunks: [<span class="string">'b'</span>]</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> htmlWebpackPlugin(&#123;</span><br><span class="line">            filename: <span class="string">'c.html'</span>,</span><br><span class="line">            template: <span class="string">'index.html'</span>,</span><br><span class="line">            title: <span class="string">'page c'</span>,</span><br><span class="line">            chunks: [<span class="string">'c'</span>]</span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹åº”çš„ html æ¨¡æ¿æ–‡ä»¶ä¸ºï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;<span class="name">%=</span> <span class="attr">htmlWebpackPlugin.options.title</span> %&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œ<code>npm run webpack</code>åç”Ÿæˆ 3 ä¸ª html æ–‡ä»¶ï¼Œåˆ†åˆ«å¼•å…¥å…¶æ‰€éœ€è¦çš„ä¾èµ–ã€‚</p><h2>webpack å¤„ç†èµ„æºæ–‡ä»¶</h2><h3>æ ·å¼æ–‡ä»¶ less/sass</h3><p>å‡å¦‚æœ‰è¿™ä¹ˆä¸€æ®µ less</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.layer</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">600px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: green;</span><br><span class="line">    &gt; div &#123;</span><br><span class="line">        <span class="selector-tag">width</span>: 400<span class="selector-tag">px</span>;</span><br><span class="line">        <span class="selector-tag">height</span>: 200<span class="selector-tag">px</span>;</span><br><span class="line">        <span class="selector-tag">background</span>: <span class="selector-tag">gray</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆå®‰è£… less å’Œ less-loader</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npm install less less-loader --save-dev</span></span><br></pre></td></tr></table></figure><p>åœ¨ webpack é…ç½®æ–‡ä»¶ä¸­åŠ å…¥ less-loader</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">    &#123;</span><br><span class="line">        test: <span class="regexp">/\.less$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">            <span class="string">"style-loader"</span>,</span><br><span class="line">            <span class="string">"css-loader"</span>,</span><br><span class="line">            <span class="string">"less-loader"</span></span><br><span class="line">       ]</span><br><span class="line">    &#125;]</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>loader çš„æ‰§è¡Œé¡ºåºä¸ºä»åå¾€å‰æ‰§è¡Œï¼Œæ‰€ä»¥å…¶é¡ºåºä¸º less-loader -&gt; css-loader -&gt; style-loaderã€‚ å¦‚æœéœ€è¦å¼•å…¥ postcss-loader çš„è¯ï¼Œåº”è¯¥æ”¾åœ¨ less-loader å’Œ css-loader ä¸­é—´ã€‚</p><h3>å›¾ç‰‡æ–‡ä»¶</h3><p>å›¾ç‰‡æ–‡ä»¶ä¸€èˆ¬ä½¿ç”¨ <a href="https://github.com/webpack-contrib/file-loader" target="_blank" rel="noopener">file-loader</a> é…åˆ <a href="https://github.com/webpack-contrib/url-loader" target="_blank" rel="noopener">url-loader</a>ï¼Œå¦‚æœæœ‰å‹ç¼©éœ€æ±‚çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ <a href="https://github.com/tcoopman/image-webpack-loader" target="_blank" rel="noopener">image-webpack-loader</a></p><p>å®‰è£…ä¸¤ä¸ª loader</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npm i file-loader url-loader --save-dev</span></span><br></pre></td></tr></table></figure><p>url-loader çš„åŠŸèƒ½ä¸ file-loader ååˆ†ç›¸ä¼¼ï¼Œä¸åŒçš„æ˜¯ url-loader å¯ä»¥æŒ‡å®šä¸€ä¸ª limit å‚æ•°ï¼Œ å½“å›¾ç‰‡æˆ–è€…æ–‡ä»¶çš„å¤§å°å¤§äº limit çš„æ—¶å€™ï¼Œurl-loader æŠŠèµ„æºç›´æ¥äº¤ç»™ file-loader å¤„ç†ï¼Œè€Œå½“èµ„æºå°äº limit çš„æ—¶å€™ï¼Œurl-loader ä¼šæŠŠå›¾ç‰‡è½¬ä¸º base64 çš„ç¼–ç ï¼Œå¹¶ç›´æ¥æ‰“åŒ…åˆ°å¼•ç”¨çš„æ–‡ä»¶ä¸­ã€‚</p><p>file-loader æ‰“åŒ…çš„æ–‡ä»¶é€šè¿‡ http è¯·æ±‚è·å–ï¼Œurl-loader æ‰“åŒ…çš„æ–‡ä»¶é€šè¿‡ base64 çš„æ–¹å¼è·å–ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•å„æœ‰å„çš„ä¼˜åŠ¿ã€‚é€šè¿‡ http è½½å…¥çš„å›¾ç‰‡å¯ä»¥äº«å—åˆ°æµè§ˆå™¨çš„å›¾ç‰‡ç¼“å­˜ï¼Œå½“å›¾ç‰‡é‡å¤ä½¿ç”¨æ¬¡æ•°æ¯”è¾ƒå¤šçš„æ—¶å€™å…·æœ‰ä¸€å®šçš„ä¾¿åˆ©ã€‚base64 çš„æ–¹å¼å¼•å…¥å›¾ç‰‡å¯ä»¥é™ä½ http è¯·æ±‚çš„æ¬¡æ•°ï¼Œä½†æ˜¯ä¹Ÿä¼šå¸¦æ¥ä¸€å®šç¨‹åº¦çš„ä»£ç å†—ä½™ã€‚</p><p>(1) ä½¿ç”¨ file-loader</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [&#123;</span><br><span class="line">        test: <span class="regexp">/\.(ico|jpe?g|png|svg|gif)$/i</span>,</span><br><span class="line">        loader: <span class="string">'file-loader'</span></span><br><span class="line">    &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(2) ä½¿ç”¨ url-loader</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [&#123;</span><br><span class="line">        test: <span class="regexp">/\.(ico|jpe?g|png|svg|gif)$/i</span>,</span><br><span class="line">        loader: <span class="string">'url-loader'</span>,</span><br><span class="line">        query: &#123;</span><br><span class="line">            limit: <span class="number">10000</span>,</span><br><span class="line">            name: <span class="string">'assets/[name]-[hash].[ext]'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(3) image-webpack-loader å¯ä»¥å¯¹å›¾ç‰‡æ–‡ä»¶è¿›è¡Œå‹ç¼©ï¼Œå¹¶ä¸”é…åˆ url-loader å’Œ file-loader å…±åŒä½¿ç”¨</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [&#123;</span><br><span class="line">        test: <span class="regexp">/\.(ico|jpe?g|png|svg|gif)$/i</span>,</span><br><span class="line">        use: [</span><br><span class="line">            <span class="string">'url-loader?limit=10000&amp;name=assets/[name]-[hash].[ext]'</span>,</span><br><span class="line">            <span class="string">'image-webpack-loader?options=&#123;&#125;'</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>loader çš„å‚æ•°ä¹Ÿå¯ä»¥é€šè¿‡ options ä¼ é€’</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">test: <span class="regexp">/\.(ico|jpe?g|png|svg|gif)$/i</span>,</span><br><span class="line">use: [</span><br><span class="line">    &#123;</span><br><span class="line">        loader: <span class="string">'url-loader'</span>,</span><br><span class="line">        options: &#123;</span><br><span class="line">            limit: <span class="number">10000</span>,</span><br><span class="line">            name: <span class="string">'assets/[name]-[hash].[ext]'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        loader: <span class="string">'image-webpack-loader'</span>,</span><br><span class="line">        options: &#123;&#125;</span><br><span class="line">    &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>image-webpack-loader å¯ä»¥é’ˆå¯¹ä¸åŒçš„å›¾ç‰‡ç±»å‹å°±è¡Œå‹ç¼©ï¼Œè¯¦ç»†çš„ä¿¡æ¯å¯ä»¥åœ¨<a href="https://github.com/tcoopman/image-webpack-loader" target="_blank" rel="noopener">å®˜ç½‘</a>é‡Œé¢æŸ¥è¯¢ã€‚</p><p>æ³¨ï¼šåœ¨ image-webpack-loader å®é™…ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œå¿…é¡»ä¼ å…¥ä¸€ä¸ª options å‚æ•°ï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼Œä½¿ç”¨çš„æ—¶å€™æ³¨æ„ä¸€ä¸‹ã€‚</p><blockquote><p>ERROR in   Error: Child compilation failed:<br>Module build failed: TypeError: Cannot read property â€˜bypassOnDebugâ€™ of null</p></blockquote><h2>æ€»ç»“</h2><p>æœ¬æ–‡åªæ˜¯ webpack æ‰“åŒ…çš„ä¸€äº›çŸ¥è¯†ï¼Œåªæ¶‰åŠåˆ°ä¸€äº›åŸºæœ¬ä½¿ç”¨ï¼Œå…³äº webpack åœ¨é¡¹ç›®ä¸­çš„å®é™…åº”ç”¨ï¼Œä»¥åŠæ‰“åŒ…çš„ä¸€äº›æŠ€å·§å’Œä¼˜åŒ–ï¼Œä¼šåœ¨ä¸‹ä¸€èŠ‚ä¸­è®²èµ·ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;ç®€ä»‹&lt;/h2&gt;
&lt;p&gt;Webpack + ES6 å·²ç»æˆä¸ºç›®å‰æœ€æµè¡Œçš„å‰ç«¯è§£å†³æ–¹æ¡ˆï¼Œæœ¬æ–‡æ˜¯ Webpack2 å­¦ä¹ æ•™ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ ã€Œ&lt;a href=&quot;https://webpack.github.io/docs/what-is-webpack.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;What is webpack&lt;/a&gt;ã€ä¸€æ–‡ä¸­ä½œè€…è®²è¿°äº†è‡ªå·±ä¸ºä»€ä¹ˆè¦å¼€å‘å‡º webpackã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åˆ‡åˆ†ä»£ç ä¾èµ–æ ‘åˆ°ä¸åŒçš„ä»£ç å—ï¼ŒæŒ‰éœ€åŠ è½½&lt;/li&gt;
&lt;li&gt;ä¿æŒæ›´å°‘çš„åˆå§‹åŒ–åŠ è½½æ—¶é—´&lt;/li&gt;
&lt;li&gt;æŠŠä»»ä½•é™æ€èµ„æºéƒ½è§†ä¸ºæ¨¡å—&lt;/li&gt;
&lt;li&gt;æŠŠä»»ä½•ç¬¬ä¸‰æ–¹ç±»åº“ä¹Ÿå½“ä½œæ¨¡å—&lt;/li&gt;
&lt;li&gt;åœ¨æ¨¡å—æ‰“åŒ…ä¸­æ¯ä¸€éƒ¨åˆ†éƒ½å…è®¸è‡ªå®šä¹‰&lt;/li&gt;
&lt;li&gt;æ›´åŠ é€‚åˆå¤§å‹é¡¹ç›®&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="https://lz5z.com/tags/JavaScript/"/>
    
      <category term="webpack" scheme="https://lz5z.com/tags/webpack/"/>
    
  </entry>
  
  <entry>
    <title>CSS ä¸­çš„å„ç§å•ä½</title>
    <link href="https://lz5z.com/CSS%E4%B8%AD%E7%9A%84%E5%90%84%E7%A7%8D%E5%8D%95%E4%BD%8D/"/>
    <id>https://lz5z.com/CSSä¸­çš„å„ç§å•ä½/</id>
    <published>2017-02-23T14:15:49.000Z</published>
    <updated>2020-04-21T10:23:54.823Z</updated>
    
    <content type="html"><![CDATA[<p>ä¹‹å‰é‡åˆ° css ä¸­éœ€è¦ä½¿ç”¨å•ä½çš„æƒ…å†µï¼Œéƒ½è‰è‰ç”¨ px æˆ–è€…ç™¾åˆ†æ¯”ç³Šå¼„è¿‡å»ï¼Œå¯¼è‡´å½“éœ€è¦åšä¸€ä¸ªå“åº”å¼çš„é¡µé¢çš„æ—¶å€™ï¼Œè¦é‡æ–°è¡¥ä¸€ä¸‹ css å•ä½çš„æŠ€æœ¯å€ºã€‚</p><a id="more"></a><h2>px</h2><p>px æ˜¯ css ä¸­æœ€å¸¸ç”¨çš„å­—ä½“å¤§å°å•ä½ã€‚<br>px å°±æ˜¯è¡¨ç¤º pixelï¼Œåƒç´ ï¼Œæ˜¯å±å¹•ä¸Šæ˜¾ç¤ºæ•°æ®çš„æœ€åŸºæœ¬çš„ç‚¹ï¼›è¿˜æœ‰ä¸€ä¸ªçœ‹èµ·æ¥å¾ˆåƒçš„å•ä½ ptï¼Œpt å°±æ˜¯ pointï¼Œæ˜¯å°åˆ·è¡Œä¸šå¸¸ç”¨å•ä½ï¼Œç­‰äº1/72è‹±å¯¸ï¼Œä¸€èˆ¬åœ¨æ‰“å°çš„æ—¶å€™ä½¿ç”¨ã€‚<br>åƒç´  px æ˜¯ç›¸å¯¹äºæ˜¾ç¤ºå™¨å±å¹•åˆ†è¾¨ç‡è€Œè¨€çš„ï¼Œæ‰€ä»¥ä¸€èˆ¬æŠŠå®ƒçœ‹åšä¸€ä¸ªåŸºç¡€å•ä½ï¼Œå¾ˆå¤šå…¶å®ƒå•ä½éƒ½æ˜¯ä»¥ px ä¸ºå‚ç…§çš„ã€‚</p><h2>em rem</h2><p>em æŒ‡çš„æ˜¯ç›¸å¯¹äºå½“å‰å¯¹è±¡å†…æ–‡æœ¬çš„å­—ä½“å¤§å°ï¼Œæ¯”å¦‚è®¾ç½® body çš„å­—ä½“å¤§å°(font-size)ä¸º 14pxï¼Œè€Œå¯¹ body å†…æ‰€æœ‰çš„ div è®¾ç½®å­—ä½“å¤§å°ä¸º 1.5emï¼Œé‚£ä¹ˆ div å†…å­—ä½“å¤§å°å°±æ˜¯ 14px * 1.5 = 21px</p><p>é€šå¸¸å†™ html çš„æ—¶å€™ä¼šå‘ç”Ÿå¾ˆå¤šåµŒå¥—ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½ä»çˆ¶èŠ‚ç‚¹ç»§æ‰¿å­—ä½“å¤§å°ï¼Œè¿™æ ·å¾ˆéš¾æ§åˆ¶æ¯ä¸ªå±‚çº§çš„å­—ä½“å¤§å°ã€‚rem (roo em) åº”è¿è€Œç”Ÿï¼Œrem æ˜¯æŒ‡ç›¸å¯¹äºæ ¹èŠ‚ç‚¹å­—ä½“å¤§å°ï¼Œé€šå¸¸æ ¹èŠ‚ç‚¹æ˜¯æŒ‡ html å…ƒç´ ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">html</span> &#123; <span class="attribute">font-size</span>: <span class="number">14px</span>; &#125; </span><br><span class="line"><span class="selector-tag">div</span> &#123; <span class="attribute">font-size</span>: <span class="number">1.5rem</span>; &#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·æ‰€æœ‰ div ä¸­å­—ä½“çš„å¤§å°éƒ½æ˜¯ 21px äº†ã€‚</p><h2>ç™¾åˆ†æ¯”</h2><p>css ä¸­çš„ç™¾åˆ†æ¯”æ˜¯ä¸€ç§ç›¸å¯¹å€¼ï¼Œä½¿ç”¨ç™¾åˆ†æ¯”çš„å…³é”®æ˜¯æ‰¾åˆ°å®ƒçš„å‚ç…§ç‰©ã€‚</p><table><thead><tr><th style="text-align:center">å±æ€§</th><th style="text-align:center">å‚ç…§</th></tr></thead><tbody><tr><td style="text-align:center">width &amp; height</td><td style="text-align:center">å®½å’Œé«˜åœ¨ä½¿ç”¨ç™¾åˆ†æ¯”å€¼æ—¶ï¼Œå…¶å‚ç…§ä¸€èˆ¬éƒ½æ˜¯çˆ¶å…ƒç´ çš„ content çš„å®½å’Œé«˜ã€‚</td></tr><tr><td style="text-align:center">margin &amp; padding</td><td style="text-align:center">margin å’Œ paddingï¼Œå…¶ä»»æ„æ–¹å‘çš„ç™¾åˆ†æ¯”å€¼ï¼Œå‚ç…§éƒ½æ˜¯åŒ…å«å—çš„å®½åº¦ã€‚</td></tr><tr><td style="text-align:center">border-radius</td><td style="text-align:center">ä¸ºä¸€ä¸ªå…ƒç´ çš„border-radiuså®šä¹‰çš„ç™¾åˆ†æ¯”å€¼ï¼Œå‚ç…§ç‰©æ˜¯è¿™ä¸ªå…ƒç´ è‡ªèº«çš„å°ºå¯¸ã€‚border-radius:50%;</td></tr><tr><td style="text-align:center">font-size</td><td style="text-align:center">å‚ç…§æ˜¯ç›´æ¥çˆ¶å…ƒç´ çš„ font-sizeã€‚</td></tr><tr><td style="text-align:center">line-height</td><td style="text-align:center">å‚ç…§æ˜¯å…ƒç´ è‡ªèº«çš„font-size</td></tr><tr><td style="text-align:center">vertical-align</td><td style="text-align:center">å‚ç…§æ˜¯å…ƒç´ è‡ªèº«çš„line-height</td></tr><tr><td style="text-align:center">bottomã€leftã€rightã€top</td><td style="text-align:center">å‚ç…§æ˜¯å…ƒç´ çš„åŒ…å«å—ã€‚leftå’Œrightæ˜¯å‚ç…§åŒ…å«å—çš„å®½åº¦ï¼Œbottomå’Œtopæ˜¯å‚ç…§åŒ…å«å—çš„é«˜åº¦ã€‚</td></tr><tr><td style="text-align:center">transform: translate</td><td style="text-align:center">å‚ç…§æ˜¯å…ƒç´ è‡ªå·±çš„è¾¹ç•Œæ¡†çš„å°ºå¯¸</td></tr></tbody></table><h2>vh vm</h2><p>ç§»åŠ¨äº’è”ç½‘æ—¶ä»£å„ç§è®¾å¤‡å¤§å°ä¸ä¸€ï¼Œå“åº”å¼çš„å¸ƒå±€å˜å¾—æ›´åŠ æµè¡Œï¼Œè€Œå“åº”å¼å¸ƒå±€å¾ˆå¤§ç¨‹åº¦ä¸Šä¾èµ–æ¯”ä¾‹è§„åˆ™ã€‚</p><p>vh å’Œ vm ä¹Ÿæ˜¯ç›¸å¯¹é•¿åº¦ï¼Œä¸è¿‡å…¶å‚ç…§æ˜¯æ˜¾ç¤ºçª—å£çš„å®½åº¦æˆ–é«˜åº¦ï¼Œä¸€èˆ¬æ¥è¯´ 100 vh = viewport çš„é«˜åº¦ï¼Œ100vm = viewport çš„å®½åº¦ã€‚</p><p>ä¸‹é¢ä¸€æ®µè¯æ˜¯å“åº”å¼çš„ï¼Œä½ å¯ä»¥ç¼©æ”¾æµè§ˆå™¨å¤§å°æ¥æŸ¥çœ‹æ•ˆæœã€‚</p><!DOCTYPE html><html><body><div class="css-vm-test">ç¼©æ”¾æµè§ˆå™¨å¤§å°æ¥æŸ¥çœ‹æ•ˆæœ</div></body><style>.css-vm-test { font-size: 3vw; color: red; }</style></html><h2>vmin å’Œ vmax</h2><p>vmin å’Œ vmax çš„å‡ºç°ä¸»è¦æ˜¯ä¸ºäº†ç§»åŠ¨è®¾å¤‡æ¨ªç«–å±åˆ‡æ¢ã€‚vmax æ˜¯ç›¸å¯¹äº viewport å®½åº¦æˆ–è€…é«˜åº¦ä¸­æ¯”è¾ƒå¤§çš„ä¸€ä¸ªï¼Œvmin åˆ™æ˜¯æ¯”è¾ƒå°çš„é‚£ä¸ªã€‚æ¯”å¦‚æ‰‹æœºå±å¹•å®½åº¦ä¸º1100pxï¼Œé«˜åº¦ä¸º700pxï¼Œé‚£ä¹ˆ 100vmin = 700px, 100vmax = 1100pxã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¹‹å‰é‡åˆ° css ä¸­éœ€è¦ä½¿ç”¨å•ä½çš„æƒ…å†µï¼Œéƒ½è‰è‰ç”¨ px æˆ–è€…ç™¾åˆ†æ¯”ç³Šå¼„è¿‡å»ï¼Œå¯¼è‡´å½“éœ€è¦åšä¸€ä¸ªå“åº”å¼çš„é¡µé¢çš„æ—¶å€™ï¼Œè¦é‡æ–°è¡¥ä¸€ä¸‹ css å•ä½çš„æŠ€æœ¯å€ºã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="CSS" scheme="https://lz5z.com/categories/CSS/"/>
    
    
      <category term="CSS" scheme="https://lz5z.com/tags/CSS/"/>
    
  </entry>
  
  <entry>
    <title>vue2.0 ç»„ä»¶é€šä¿¡</title>
    <link href="https://lz5z.com/vue2%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1/"/>
    <id>https://lz5z.com/vue2ç»„ä»¶é€šä¿¡/</id>
    <published>2017-02-17T10:46:29.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<p>Vue é‡‡ç”¨åŸºäºç»„ä»¶çš„å¼€å‘æ–¹å¼ï¼Œé‚£ä¹ˆç»„ä»¶ä¹‹é—´çš„é€šä¿¡å¿…ä¸å¯å°‘ï¼šæ¯”å¦‚çˆ¶ç»„ä»¶è¦ç»™å­ç»„ä»¶ä¼ é€’æ•°æ®ï¼Œå­ç»„ä»¶å°†å®ƒå†…éƒ¨å‘ç”Ÿçš„äº‹æƒ…å‘ŠçŸ¥ç»™çˆ¶ç»„ä»¶ï¼Œå› æ­¤å®šä¹‰ä¸€ä¸ªè‰¯å¥½çš„æ¥å£å°½å¯èƒ½å°†ç»„ä»¶è§£è€¦æ˜¾å¾—å°¤ä¸ºé‡è¦ï¼Œè¿™ä¿è¯ä¸åŒçš„ç»„ä»¶å¯ä»¥åœ¨ç›¸å¯¹ç‹¬ç«‹çš„ç¯å¢ƒä¸­å¼€å‘æµ‹è¯•ï¼Œè€Œä¸”æ›´æ–¹ä¾¿é˜…è¯»ç†è§£ä»¥åŠç»„ä»¶å¤ç”¨ã€‚</p><p>Vue çˆ¶å­ç»„ä»¶ä¹‹é—´é€šä¿¡ä¸»è¦é‡‡å–ä¸¤ç§æ–¹å¼ï¼Œé€šå¸¸å¯ä»¥æ€»ç»“ä¸º <strong>props down</strong>ã€<strong>events up</strong>ï¼Œçˆ¶ç»„ä»¶é€šè¿‡ props å‘ä¸‹ä¼ é€’æ•°æ®ç»™å­ç»„ä»¶ï¼Œå­ç»„ä»¶é€šè¿‡ events ç»™çˆ¶ç»„ä»¶å‘é€æ¶ˆæ¯ï¼Œè¿™ç‚¹è·Ÿ React ä¸€æ¨¡ä¸€æ ·ã€‚</p><a id="more"></a><p>Vue2.0 åºŸé™¤äº† <code>events</code>ã€<code>$dispatch</code>ã€<code>$broadcast</code> å‡ ä¸ªäº‹ä»¶ï¼Œå®˜æ–¹æ¨èä½¿ç”¨ <a href="https://github.com/vuejs/vue/issues/2873" target="_blank" rel="noopener">å…¨å±€äº‹ä»¶é©±åŠ¨ æˆ–è€… vuex</a>ä»£æ›¿ï¼Œç›®å‰åªå‰©ä¸‹ <code>vm.$on</code>ã€<code>vm.$once</code>ã€<code>vm.$off</code>ã€<code>vm.$emit</code> å‡ ä¸ªäº‹ä»¶ã€‚</p><h2>props down</h2><p>Vue ç»„ä»¶ä¹‹é—´çš„ä½œç”¨åŸŸæ˜¯ç›¸äº’éš”ç¦»çš„ï¼Œçˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ å€¼åªèƒ½é€šè¿‡ props çš„æ–¹å¼ï¼Œå­ç»„ä»¶ä¸èƒ½ç›´æ¥è°ƒç”¨çˆ¶ç»„ä»¶çš„æ•°æ®ã€‚åœ¨å­ç»„ä»¶ä¸­ï¼Œå¦‚æœéœ€è¦è°ƒç”¨çˆ¶ç»„ä»¶ä¼ æ¥çš„å‚æ•°ï¼Œå¿…é¡»æ˜¾å¼çš„å£°æ˜ propsã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Vue.component(<span class="string">'child'</span>, &#123;</span><br><span class="line">  props: [<span class="string">'message'</span>],</span><br><span class="line">  template: <span class="string">'&lt;span&gt;&#123;&#123; message &#125;&#125;&lt;/span&gt;'</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ å€¼</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">child</span> <span class="attr">message</span>=<span class="string">"hello!"</span>&gt;</span><span class="tag">&lt;/<span class="name">child</span>&gt;</span></span><br></pre></td></tr></table></figure><h3>å•å‘æ•°æ®æµ</h3><p>props ä¼ é€’å€¼åªèƒ½çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’ï¼Œä¸èƒ½åå›æ¥ï¼Œæ¯å½“çˆ¶ç»„ä»¶æ›´æ–°æ—¶ï¼Œå­ç»„ä»¶ä¸­çš„ props ä¼šè‡ªåŠ¨æ›´æ–°ã€‚å¦‚æœåœ¨å­ç»„ä»¶ä¸­æ›´æ”¹ propsï¼ŒVue æ§åˆ¶å°ä¼šç»™å‡º warningã€‚å› æ­¤å¦‚æœéœ€è¦åœ¨å­ç»„ä»¶ä¸­æ›´æ”¹ props é€šå¸¸ä¼šæŠŠå…¶ä½œä¸ºåˆå§‹å€¼èµ‹å€¼ç»™æŸä¸ªå˜é‡ï¼Œç„¶åå˜é‡çš„å€¼ï¼Œæˆ–è€…åœ¨è®¡ç®—å±æ€§ä¸­å®šä¹‰ä¸€ä¸ªåŸºäº props çš„å€¼ã€‚</p><h2>events up</h2><p>å¦‚æœå­ç»„ä»¶éœ€è¦æŠŠä¿¡æ¯ä¼ è¾¾ç»™çˆ¶ç»„ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>v-on</code> ç»‘å®šè‡ªå®šä¹‰äº‹ä»¶</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"counter-event-example"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; total &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button-counter</span> <span class="attr">v-on:increment</span>=<span class="string">"incrementTotal"</span>&gt;</span><span class="tag">&lt;/<span class="name">button-counter</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button-counter</span> <span class="attr">v-on:increment</span>=<span class="string">"incrementTotal"</span>&gt;</span><span class="tag">&lt;/<span class="name">button-counter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ç»™ button-counter ç»‘å®šäº†ä¸€ä¸ªè‡ªå®šä¹‰äº‹ä»¶ <code>increment</code>ï¼Œv-on ç»‘å®šäº‹ä»¶è¿˜å¯ä»¥ç®€å†™ä¸º <code>@increment=&quot;&quot;</code>ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Vue.component(<span class="string">'button-counter'</span>, &#123;</span><br><span class="line">  template: <span class="string">'&lt;button v-on:click="increment"&gt;&#123;&#123; counter &#125;&#125;&lt;/button&gt;'</span>,</span><br><span class="line">  data: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      counter: <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    increment() &#123;</span><br><span class="line">      <span class="keyword">this</span>.counter += <span class="number">1</span></span><br><span class="line">      <span class="keyword">this</span>.$emit(<span class="string">'increment'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">'#counter-event-example'</span>,</span><br><span class="line">  data: &#123;</span><br><span class="line">    total: <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    incrementTotal() &#123;</span><br><span class="line">      <span class="keyword">this</span>.total += <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>button-counter ç»„ä»¶çš„æ¨¡æ¿ä¸­åŒ…å«ä¸€ä¸ª buttonï¼Œå…¶ click äº‹ä»¶ä¼šè§¦å‘($emit)è‡ªå®šä¹‰äº‹ä»¶ <code>increment</code>ï¼Œå› æ­¤æ¯æ¬¡åœ¨å­ç»„ä»¶ä¸­ç‚¹å‡»ä¸€æ¬¡ buttonï¼Œçˆ¶ç»„ä»¶ä¸­éƒ½ä¼šè°ƒç”¨ incrementTotal() æ–¹æ³•ã€‚</p><h2>éçˆ¶å­ç»„ä»¶é€šä¿¡</h2><p>ä¸Šé¢è®²çš„ä¸¤ç§æ–¹æ³•éƒ½çˆ¶å­ç»„ä»¶ä¹‹é—´çš„é€šä¿¡ï¼Œæœ‰æ—¶å€™éçˆ¶å­å…³ç³»çš„ç»„ä»¶ä¹Ÿéœ€è¦é€šä¿¡ã€‚åœ¨ Vue1.0 æ—¶ä»£ï¼Œå¯ä»¥é€šè¿‡ $dispatch å’Œ $broadcast æ¥è§£å†³ï¼Œé¦–å…ˆ dispatch åˆ°æ ¹ç»„ä»¶ï¼Œç„¶åå† broadcast åˆ°å­ç»„ä»¶ã€‚Vue2.0 ä¸­å®˜æ–¹æ¨èç”¨ event bus æˆ–è€… vuex è§£å†³ï¼Œevent bus çš„æœ¬è´¨æ˜¯ä¸€ä¸ªå‘å¸ƒè€…è®¢é˜…è€…æ¨¡å¼ã€‚</p><ul><li>ä½¿ç”¨ä¸€ä¸ªç©ºçš„ Vue å®ä¾‹ä½œä¸ºä¸­å¤®äº‹ä»¶æ€»çº¿<br><code>var bus = new Vue()</code></li><li>è§¦å‘ç»„ä»¶ A ä¸­çš„äº‹ä»¶(å‘å¸ƒæ¶ˆæ¯)<br><code>bus.$emit('id-selected', 1)</code></li><li>åœ¨ç»„ä»¶ B åˆ›å»ºçš„é’©å­ä¸­ç›‘å¬äº‹ä»¶ï¼ˆè®¢é˜…æ¶ˆæ¯ï¼‰<br><code>bus.$on('id-selected', function (id) {})</code></li></ul><p>ä¸‹é¢æ˜¯ <a href="https://stackoverflow.com/questions/38064054/vue-js-global-event-bus" target="_blank" rel="noopener">stackoverflow</a> ä¸Šé¢çš„ä¸€ä¸ªä¾‹å­</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"example"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Display</span>&gt;</span><span class="tag">&lt;/<span class="name">Display</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Increment</span>&gt;</span><span class="tag">&lt;/<span class="name">Increment</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> bus = <span class="keyword">new</span> Vue()</span><br><span class="line"></span><br><span class="line">Vue.component(<span class="string">'Increment'</span>, &#123;</span><br><span class="line">  template: <span class="string">`&lt;button @click="increment"&gt;+&lt;/button&gt;`</span>,</span><br><span class="line">  data: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">   <span class="keyword">return</span> &#123;<span class="attr">count</span>: <span class="number">1</span>&#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    increment: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="keyword">var</span> increment = <span class="keyword">this</span>.count++</span><br><span class="line">      bus.$emit(<span class="string">'inc'</span>, increment)</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">Vue.component(<span class="string">'Display'</span>, &#123;</span><br><span class="line">  template: <span class="string">`&lt;h3&gt;Clicked: &#123;&#123;count&#125;&#125; times&lt;/h3&gt;`</span>,</span><br><span class="line">  data: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;<span class="attr">count</span>: <span class="number">0</span>&#125;</span><br><span class="line">  &#125;,</span><br><span class="line"> created: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">   bus.$on(<span class="string">'inc'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">num</span>)</span>&#123;</span><br><span class="line">     <span class="keyword">this</span>.count = num</span><br><span class="line">   &#125;.bind(<span class="keyword">this</span>))</span><br><span class="line"> &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line"> el: <span class="string">"#example"</span>,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2>å…¨å±€çŠ¶æ€ç®¡ç† <a href="https://vuex.vuejs.org" target="_blank" rel="noopener">Vuex</a></h2><p>Vuex æ˜¯ Vue ç»„ä»¶çš„ä¸€ä¸ªçŠ¶æ€ç®¡ç†å™¨ï¼Œç›¸å½“äºä¸€ä¸ªåªä¸º Vue æœåŠ¡çš„ <a href="http://redux.js.org/" target="_blank" rel="noopener">Redux</a>ã€‚ä¸‹é¢ä¸€ä¸ªå›¾èƒ½å¾ˆå¥½çš„åæ˜ å‡º Vuex æ˜¯å¦‚ä½•è®©ç»„ä»¶ä¹‹é—´é€šä¿¡çš„ã€‚</p><img src="/assets/img/vuex.png" alt="vuex" width="50%"><p>ä¸‹é¢æ˜¯ Vuex å®˜ç½‘ä¸Šç»™å‡ºçš„ä¸€ä¸ª <a href="https://jsfiddle.net/n9jmu5v7/341/" target="_blank" rel="noopener">è®¡æ•°å™¨çš„ä¾‹å­</a></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; count &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"increment"</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"decrement"</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  state: &#123;</span><br><span class="line">    count: <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  mutations: &#123;</span><br><span class="line">    increment: <span class="function"><span class="params">state</span> =&gt;</span> state.count++,</span><br><span class="line">    decrement: <span class="function"><span class="params">state</span> =&gt;</span> state.count--</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">'#app'</span>,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    count() &#123;</span><br><span class="line">      <span class="keyword">return</span> store.state.count</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    increment() &#123;</span><br><span class="line">      store.commit(<span class="string">'increment'</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    decrement() &#123;</span><br><span class="line">      store.commit(<span class="string">'decrement'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>ç‚¹å‡»æŸ¥çœ‹æ•ˆæœ</p><!DOCTYPE html><html lang="en"><body><div id="app">  <p>{{ count }}</p>  <p>    <button @click="increment">+</button>    <button @click="decrement">-</button>  </p></div></body><script src="https://unpkg.com/vue/dist/vue.js"></script><script src="https://unpkg.com/vuex@2.0.0"></script><script type="text/javascript">const store = new Vuex.Store({  state: {    count: 0  },  mutations: {    increment: state => state.count++,    decrement: state => state.count--  }})const app = new Vue({  el: '#app',  computed: {    count() {      return store.state.count    }  },  methods: {    increment() {      store.commit('increment')    },    decrement() {      store.commit('decrement')    }  }})</script></html><p>åœ¨ Vuex ä¸­ï¼Œstore æ˜¯ç»„ä»¶çŠ¶æ€çš„ä¸€ä¸ªå®¹å™¨ï¼Œä¸Šé¢çš„ store ä¸­å®šä¹‰äº†ä¸€ä¸ªåˆå§‹çš„ state å¯¹è±¡ï¼Œå’Œä¸¤ä¸ª mutations å‡½æ•°ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ store.state æ¥è·å–çŠ¶æ€å¯¹è±¡ï¼Œä»¥åŠé€šè¿‡ store.commit æ–¹æ³•è§¦å‘çŠ¶æ€å˜æ›´ã€‚è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥æ›´æ”¹ store ä¸­çš„çŠ¶æ€ï¼Œæ”¹å˜ store ä¸­çš„çŠ¶æ€çš„å”¯ä¸€é€”å¾„å°±æ˜¯æ˜¾å¼åœ°æäº¤(commit) mutationsã€‚</p><h2>æ€»ç»“</h2><ol><li>çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’ä¿¡æ¯ä½¿ç”¨ props down</li><li>å­ç»„ä»¶å‘çˆ¶ç»„ä»¶ä¼ é€’ä¿¡æ¯ä½¿ç”¨ event up</li><li>å…¶å®ƒå…³ç³»ç±»å‹ç»„ä»¶é€šä¿¡ä½¿ç”¨ global event bus</li><li>å¤§å‹ SPA ç»„ä»¶ä¹‹é—´é€šä¿¡ä½¿ç”¨ Vuex ç®¡ç†ç»„ä»¶çŠ¶æ€</li></ol><p>å¦‚æœæƒ³è¦åœ¨ vue2 ä¸­ä½¿ç”¨ dispatch å’Œ broadcastï¼Œå¯ä»¥å‚è€ƒ <a href="https://lz5z.com/vue2%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1-%E4%BD%BF%E7%94%A8dispatch%E5%92%8Cbroadcast/">vue2 ç»„ä»¶é€šä¿¡â€”â€”ä½¿ç”¨ dispatch å’Œ broadcast</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Vue é‡‡ç”¨åŸºäºç»„ä»¶çš„å¼€å‘æ–¹å¼ï¼Œé‚£ä¹ˆç»„ä»¶ä¹‹é—´çš„é€šä¿¡å¿…ä¸å¯å°‘ï¼šæ¯”å¦‚çˆ¶ç»„ä»¶è¦ç»™å­ç»„ä»¶ä¼ é€’æ•°æ®ï¼Œå­ç»„ä»¶å°†å®ƒå†…éƒ¨å‘ç”Ÿçš„äº‹æƒ…å‘ŠçŸ¥ç»™çˆ¶ç»„ä»¶ï¼Œå› æ­¤å®šä¹‰ä¸€ä¸ªè‰¯å¥½çš„æ¥å£å°½å¯èƒ½å°†ç»„ä»¶è§£è€¦æ˜¾å¾—å°¤ä¸ºé‡è¦ï¼Œè¿™ä¿è¯ä¸åŒçš„ç»„ä»¶å¯ä»¥åœ¨ç›¸å¯¹ç‹¬ç«‹çš„ç¯å¢ƒä¸­å¼€å‘æµ‹è¯•ï¼Œè€Œä¸”æ›´æ–¹ä¾¿é˜…è¯»ç†è§£ä»¥åŠç»„ä»¶å¤ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;Vue çˆ¶å­ç»„ä»¶ä¹‹é—´é€šä¿¡ä¸»è¦é‡‡å–ä¸¤ç§æ–¹å¼ï¼Œé€šå¸¸å¯ä»¥æ€»ç»“ä¸º &lt;strong&gt;props down&lt;/strong&gt;ã€&lt;strong&gt;events up&lt;/strong&gt;ï¼Œçˆ¶ç»„ä»¶é€šè¿‡ props å‘ä¸‹ä¼ é€’æ•°æ®ç»™å­ç»„ä»¶ï¼Œå­ç»„ä»¶é€šè¿‡ events ç»™çˆ¶ç»„ä»¶å‘é€æ¶ˆæ¯ï¼Œè¿™ç‚¹è·Ÿ React ä¸€æ¨¡ä¸€æ ·ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Vue" scheme="https://lz5z.com/categories/Vue/"/>
    
    
      <category term="JavaScript" scheme="https://lz5z.com/tags/JavaScript/"/>
    
      <category term="Vue" scheme="https://lz5z.com/tags/Vue/"/>
    
      <category term="Vuex" scheme="https://lz5z.com/tags/Vuex/"/>
    
  </entry>
  
  <entry>
    <title>è·³æ§½å°è®°</title>
    <link href="https://lz5z.com/%E8%B7%B3%E6%A7%BD%E5%B0%8F%E8%AE%B0/"/>
    <id>https://lz5z.com/è·³æ§½å°è®°/</id>
    <published>2017-02-15T13:26:28.000Z</published>
    <updated>2020-04-21T10:23:54.831Z</updated>
    
    <content type="html"><![CDATA[<img src="/assets/img/è·³æ§½.png" alt="è·³æ§½"><h2>é¢è¯•ç»å†</h2><p>ä¸€å…±å»é‡‘å±±é¢äº†ä¸‰æ¬¡è¯•ï¼Œä¸€æ¬¡æ˜¯åå°å¼€å‘ï¼Œä¸¤æ¬¡æ˜¯å‰å°å¼€å‘ã€‚å»å¹´11æœˆä»½çš„æ—¶å€™ç¬¬ä¸€æ¬¡å»é‡‘å±±é¢è¯•æœåŠ¡å™¨å¼€å‘çš„èŒä½ï¼Œå¾ˆå¤šé—®é¢˜éƒ½æ²¡æœ‰ç­”ä¸Šæ¥ï¼Œå°±æƒ¨æ·¡ç¦»å»äº†ã€‚åæ¥åˆæœ‰ä¸€ä¸ªå‰ç«¯å¼€å‘çš„å²—ä½ï¼ŒæŠ±ç€è¯•ä¸€è¯•çš„æ€åº¦å°±å»äº†ã€‚</p><a id="more"></a><h3>ç¬¬ä¸€æ¬¡å‰ç«¯é¢è¯•</h3><p>åˆšå¼€å§‹è·Ÿç¬¬ä¸€ä¸ªé¢è¯•å®˜èŠå¾—æŒºä¸é”™ï¼ŒæŠ€æœ¯é—®é¢˜è®¨è®ºå®Œäº†ï¼Œé¢è¯•å®˜é—®æˆ‘èƒ½å¦å¸¦é¡¹ç›®ï¼Œæˆ‘è¡¨ç¤ºè‡ªå·±æš‚æ—¶æ²¡æœ‰é‚£ä¸ªèƒ½åŠ›ã€‚é¢è¯•å®˜åˆé—®åŠå­¦ä¹ èƒ½åŠ›ï¼Œæˆ‘è¡¨ç¤ºè‡ªå·±å¹³æ—¶ä¸€ç›´åšæŒå­¦ä¹ æ–°çŸ¥è¯†ï¼Œä¹Ÿæœ‰è¯»ä¸€äº›ä¹¦ï¼Œç„¶åè¿™ä¸ªé¢è¯•å®˜å°±å‡ºå»äº†ã€‚å‡ºå»ä»¥åå¬åˆ°å¤–é¢æœ‰äººåœ¨è®¨è®ºï¼Œæˆ‘éšçº¦å¬åˆ°åˆšæ‰çš„é¢è¯•å®˜è¯´ï¼šã€Œä»–å®Œå…¨ä¸ç¬¦åˆè¿™ä¸ªå²—ä½çš„è¦æ±‚ã€ã€‚æˆ‘æƒ³ï¼Œçœ‹æ¥è¿™æ¬¡åˆæ²¡æˆäº†ï¼Œç„¶åå®‰æ…°è‡ªå·±ï¼šæ²¡å…³ç³»ï¼Œå›å»ç»§ç»­å­¦ä¹ å°±å¥½äº†ï¼Œåæ­£çŸ¥è¯†éƒ½æ˜¯è‡ªå·±çš„ã€‚</p><p>è¿‡äº†ä¸€ä¼šï¼Œè¿›æ¥äº†ä¸¤ä¸ªäººï¼Œä¸€ä¸ªæ˜¯é¡¹ç›®ç»„çš„ç»ç†ï¼Œå¦å¤–ä¸€ä¸ªä¸çŸ¥é“æ˜¯ä»€ä¹ˆèŒä½ã€‚ç»ç†é¦–å…ˆè·Ÿæˆ‘è¯´ï¼Œä»–ä»¬ä¸æ˜¯è¿›æ¥é¢è¯•çš„ï¼Œå°±æ˜¯æƒ³è·Ÿæˆ‘èŠä¸€ä¸‹ã€‚é‚£å°±èŠå‘—ã€‚åŸæ¥ä»–ä»¬æ˜¯æƒ³æ‹›ä¸€ä¸ªæœ‰ä¸‰äº”å¹´ç»éªŒçš„å¯ä»¥ç›´æ¥å¸¦é¡¹ç›®çš„äººï¼Œç›®å‰æœ‰ä¸€ä¸ªé¡¹ç›®çš„é‡æ„å·¥ä½œè¦åšï¼Œä¸è¿‡çœ‹æˆ‘è¡¨ç°è¿˜è¡Œï¼Œå°±æƒ³çœ‹ä¸‹æˆ‘æœ‰æ²¡æœ‰è¿™ä¸ªèƒ½åŠ›åœ¨çŸ­æ—¶é—´å†…æˆé•¿ä¸ºè¿™æ ·çš„è§’è‰²ã€‚è¿™ä¸ªæ—¶å€™æˆ‘å†…å¿ƒæ˜¯çªƒå–œçš„ï¼Œå¯¹äºä¸€ä¸ªåªæœ‰ä¸€å¹´å¤šå·¥ä½œç»éªŒçš„æ–°äººæ¥è¯´ï¼Œèƒ½æœ‰è¿™æ ·ä¸€ä¸ªé”»ç‚¼çš„æœºä¼šæ˜¯å¤šä¹ˆå®è´µï¼Œå¯æ˜¯åˆè§‰å¾—å‹åŠ›æŒºå¤§ï¼Œæ¯•ç«Ÿä¹‹å‰éƒ½æ˜¯åœ¨ leader æ‰‹ä¸‹å·¥ä½œï¼Œåªæ˜¯åšä¸€ä¸‹ taskï¼Œæ¡†æ¶è®¾è®¡ç±»çš„å·¥ä½œéƒ½æ˜¯ leader åšå¥½çš„ï¼Œæˆ‘åªåœ¨é‡Œé¢æ·»åŠ åŠŸèƒ½è€Œå·²ã€‚</p><p>åé¢ä¸€ç›´èŠï¼Œå…³äºèƒ½å¦èƒœä»»è¿™ä¸ªèŒä½ï¼Œæˆ‘å§‹ç»ˆéƒ½æ²¡æœ‰ç»™ç»ç†ä¸€ä¸ªå‡†ç¡®çš„ç­”å¤ï¼Œåªè¡¨ç¤ºè¿™å¯¹æˆ‘æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„æŒ‘æˆ˜ï¼Œä¹Ÿæ˜¯æˆ‘åŠªåŠ›çš„æ–¹å‘ã€‚æˆ‘æƒ³ï¼Œåæ¥æ²¡æœ‰æ‹¿åˆ°è¿™ä¸ªèŒä½ä¸»è¦ä¹Ÿæ˜¯å› ä¸ºè¿™ä¸ªåŸå› å§ã€‚ä¸è¿‡èŒä½æ˜¯åŒå‘é€‰æ‹©çš„ï¼Œå³ä½¿æˆ‘æ„¿æ„ï¼Œä»–ä»¬ä¹Ÿè‚¯å®šä¼šæŠŠæˆ‘è·Ÿå…¶ä»–åº”è˜è€…æ¯”è¾ƒï¼Œæœ€ç»ˆé€‰å‡ºåˆé€‚çš„äººé€‰ã€‚</p><p>è·Ÿè¿™ä¸ªç»ç†èŠå®Œå·²ç»å¿«è¦å…­ç‚¹äº†ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘åˆç´¯åˆæ¸´ï¼ŒèŠäº†è¿™ä¹ˆä¹…å£å¹²èˆŒç‡¥ã€‚ç»ç†å‡ºå»åï¼ŒHR åŠ©ç†è¿‡æ¥è¯´ HR è¿˜åœ¨é¢è¯•åˆ«äººï¼Œç­‰ä¸‹ä¼šè¿‡æ¥ï¼Œè®©æˆ‘å†ç¨ç­‰ä¸€ä¼šã€‚é‚£å¤©å¥½åƒæœ‰å¾ˆå¤šå®ä¹ ç”Ÿè¿‡æ¥ï¼Œæ‰€ä»¥å°±æŠŠæˆ‘æ’åœ¨äº†æœ€åã€‚</p><p>ç»ˆäºç­‰åˆ°äº† HRï¼ŒHR çœ‹èµ·æ¥ä¹Ÿå¾ˆç–²å€¦ï¼Œæˆ‘å°±é¦–å…ˆå‘å¥¹æ…°é—®ï¼Œè¡¨ç¤ºè¾›è‹¦äº†ã€‚ç„¶å HR ç®€å•åœ°èŠäº†å‡ å¥ï¼Œå°±ç»“æŸäº†ï¼Œæ•´ä¸ªè¿‡ç¨‹ä¸åˆ°äº”åˆ†é’Ÿã€‚</p><p>ç¬¬äºŒå¤© HR åŠ©ç†æ‰“æ¥ç”µè¯ï¼Œè¯´æˆ‘è·ŸèŒä½è¦æ±‚ä¸æ˜¯ç‰¹åˆ«ç¬¦åˆï¼Œä¸è¿‡æœ‰å¦å¤–ä¸€ä¸ªéƒ¨é—¨çš„èŒä½é—®æˆ‘æ„¿ä¸æ„¿æ„è¯•ä¸€ä¸‹ã€‚æˆ‘è¯´æ„¿æ„å•Šï¼Œç„¶åç­”åº”è¿‡å‡ å¤©å†å»é¢è¯•ã€‚æ„Ÿè§‰å¥½ç´¯å•Šã€‚</p><h3>ç¬¬äºŒæ¬¡é¢è¯•</h3><p>å†ä¸€æ¬¡å»é¢è¯•å°±è½»æ¾å¤šäº†ï¼Œè·Ÿç¬¬ä¸€ä¸ªé¢è¯•å®˜ç®€å•èŠäº†å‡ ä¸ªæŠ€æœ¯é—®é¢˜ï¼Œå†™äº†å‡ è¡Œä»£ç ä»–å°±å‡ºå»äº†ã€‚ç¬¬äºŒä¸ªé¢è¯•å®˜æ˜¯ç»ç†ï¼Œä¹Ÿæ²¡æœ‰å¤šèŠï¼Œé—®äº†ä¸€äº› HTTP çš„é—®é¢˜ï¼Œå°± OK äº†ï¼Œä¸¤ä¸ªé¢è¯•åŠ ä¸€èµ·åŠä¸ªå°æ—¶ä¸åˆ°ã€‚</p><p>ç„¶å HR åŠ©ç†è¿‡æ¥è¯´ä¹‹å‰ä¹Ÿè·Ÿ HR èŠè¿‡äº†ï¼Œè®©æˆ‘å…ˆå›å»ç­‰é€šçŸ¥ï¼Œæˆ‘å°±å›å»äº†ã€‚</p><p>ç¬¬äºŒå¤©æ”¶åˆ°äº† offerï¼Œå·¥èµ„æ¯”æˆ‘è¦çš„ä½äº†ä¸€ç‚¹ï¼Œä¸è¿‡æ€»ä½“è¿˜ç®—æ»¡æ„ï¼Œå°±ç­”åº”äº†ã€‚</p><h2>ä¸ºä»€ä¹ˆè·³æ§½</h2><p>é¦–å…ˆæˆ‘çš„è€ä¸œå®¶ OOCL çœŸæ˜¯ä¸€å®¶æŒºä¸é”™çš„å…¬å¸ï¼Œå°¤å…¶åœ¨åŸ¹å…»äººæ–¹é¢éå¸¸èˆå¾—æŠ•å…¥ã€‚è€Œä¸”å„ç§åˆ†äº«ï¼Œæ¼”è®²éƒ½éå¸¸å¤šã€‚å…¥èŒçš„æ—¶å€™è·Ÿ OOCL ç­¾çš„åŸ¹è®­åè®®ï¼Œå¦‚æœå¹²ä¸æ»¡ä¸¤å¹´ï¼Œéœ€è¦èµ”å¿ X ç¾é‡‘ï¼ˆæŒ‰æœˆé€’å‡ï¼‰çš„è¿çº¦é‡‘ã€‚è¿çº¦é‡‘è¿˜æŒºå¤šçš„ï¼Œä¸è¿‡ä¸ªäººè§‰å¾—éå¸¸å€¼ï¼Œæ¯”åœ¨ç¤¾ä¼šä¸ŠæŠ¥é‚£äº›ä¹±ä¸ƒå…«ç³Ÿçš„åŸ¹è®­ç­å¼ºå¤šäº†ã€‚å·¥ä½œå‰ä¸‰ä¸ªæœˆåŠå°é—­è„±äº§åŸ¹è®­ï¼Œè¯·çš„ä¸­ç§‘é™¢çš„è€å¸ˆï¼Œè®²è¯¾æ·±å…¥æµ…å‡ºï¼Œåœ¨é‚£å‡ ä¸ªæœˆå†…æˆ‘ä¹Ÿè¿›æ­¥å¾ˆå¤§ã€‚æœ€åç¦»èŒçš„æ—¶å€™ç”±äºæˆ‘åªå·¥ä½œäº†ä¸€å¹´åŠï¼Œèµ”å¿äº†ä¸€éƒ¨åˆ†é’±ã€‚é™¤äº†åŸ¹è®­ä»¥å¤–ï¼ŒOOCL æ•´ä¸ªç¦åˆ©å¾…é‡åœ¨ç æµ·æ¥è¯´ä¹Ÿéƒ½ç®—ä¸é”™ï¼Œæ¯å¹´ä¸¤æ¬¡è°ƒè–ªï¼Œç«äº‰åŠ›è¿˜æ˜¯æ¯”è¾ƒå¤§ã€‚</p><p>OOCL è¿™ä¹ˆå¥½ä½ ä¸ºå•¥è¦èµ°å‘¢ï¼Ÿ</p><p>OOCL æ˜¯ä¸€ä¸ªèˆ¹è¿å…¬å¸ï¼Œæœ‰éå¸¸å¤æ‚çš„ä¸šåŠ¡ã€‚åœ¨ OOCL çš„æ—¶é—´å¤§éƒ¨åˆ†éƒ½åœ¨æä¸šåŠ¡ï¼Œè€Œä¸”åšçš„ä¸œè¥¿å¾ˆæ‚ï¼Œæ„Ÿè§‰å­¦äº†å¾ˆå¤šä¸œè¥¿ï¼Œåˆæ ·æ ·éƒ½ä¸ç²¾é€šã€‚å»é¢è¯•åç«¯çš„æ—¶å€™ï¼Œå…³äºç¼“å­˜ï¼Œé«˜å¹¶å‘ä¹‹ç±»çš„é—®é¢˜éƒ½æ²¡èƒ½ç­”ä¸Šæ¥ã€‚è€Œåœ¨äº’è”ç½‘å…¬å¸ä¼šè§‰å¾—è‡ªå·±è·Ÿç”¨æˆ·æ›´è¿‘ä¸€äº›ï¼Œä¸šåŠ¡æ–¹é¢ä¹Ÿä¼šå¾ˆå¥½ç†è§£ã€‚ä¸“èŒåšå‰ç«¯æˆ–è€…åç«¯ä¼šè®©è‡ªå·±åœ¨æŸä¸ªé¢†åŸŸæ›´ç²¾é€šä¸€äº›ï¼Œæˆ‘è¿˜æ˜¯å¸Œæœ›æˆä¸ºæŸä¸ªé¢†åŸŸçš„ç –å®¶ï¼Œåœ¨é‡‘å±±è¿™ä¸ªç†æƒ³å®ç°èµ·æ¥ä¼šæ›´å¿«ä¸€äº›ã€‚</p><h2>é‡‘å±±æ€ä¹ˆæ ·å•Šï¼Ÿ</h2><p>ä»Šå¤©æ˜¯å…¥èŒç¬¬äºŒå¤©ï¼Œè¯´å®è¯ç»™ä¸äº†å¤ªå¤šçš„è¯„ä»·ï¼Œåªèƒ½ä»å¤–éƒ¨ç®€å•å¯¹æ¯”ä¸€ä¸‹ OOCL å’Œé‡‘å±±ã€‚</p><h3>ç©¿ç€</h3><p>OOCL æ˜¯é¦™æ¸¯çš„å…¬å¸ï¼Œæ„Ÿè§‰å¤§å®¶æ›´ formal ä¸€äº›ï¼Œé‚®ä»¶ã€IM åŸºæœ¬éƒ½æ˜¯è‹±æ–‡ï¼Œç©¿ç€ä¹Ÿä¸ä¼šå¤ªéšæ„ã€‚é‡‘å±±æ˜¯å…¸å‹çš„äº’è”ç½‘å…¬å¸ï¼Œç©¿æ‹–é‹çŸ­è£¤æ˜¯å®¶å¸¸ä¾¿é¥­ã€‚</p><h3>é£Ÿå ‚</h3><p>OOCL æ²¡æœ‰é£Ÿå ‚ï¼Œä¸è¿‡åŸ¹è®­çš„æ—¶å€™æœ‰ä¸­é¤å¯ä»¥åƒï¼Œè´¨é‡å‚å·®ä¸é½ï¼Œå¥½åçœ‹è¿æ°”ã€‚é‡‘å±±çš„é£Ÿå ‚çœŸå¿ƒä¸é”™ï¼Œè¤ç´ æ­é…ï¼Œç±³é¢æ±¤ç²‰éƒ½æœ‰ï¼Œè€Œä¸”ä¸‰é¤å…è´¹ï¼Œèµã€‚</p><h3>åŠå…¬ç¯å¢ƒ</h3><p>åŠå…¬ç¯å¢ƒçš„è¯ OOCL å°±ç•¥èƒœä¸€ç­¹äº†ï¼Œå®‰é™æ•´æ´ï¼Œç©ºè°ƒå…¨å¹´æ’æ¸©ã€‚é‡‘å±±è¦ä¹±ä¸€äº›ï¼Œå¹³æ—¶å¾ˆå¤šäººè¯´è¯ï¼Œç”šè‡³è¿˜æœ‰äººæˆ´ç€è€³æœºå¬æ­Œçš„æ—¶å€™è·Ÿç€å¹å£å“¨<img src="/assets/img/æˆ‘ä¹Ÿæ˜¯é†‰äº†.jpg" alt="é†‰äº†">ã€‚è¿˜æœ‰ä¸€ä¸ªè¦åæ§½é‡‘å±±çš„æ˜¯ï¼Œæ–°åˆ°èŒï¼Œæ²¡æœ‰æ–°ç”µè„‘ç”¨ï¼Œä¸ºä»€ä¹ˆå¤§å®¶éƒ½æœ‰ mac ç”¨ï¼Œæˆ‘åªèƒ½ç”¨ winï¼Ÿ</p><h3>åŠ ç­</h3><p>OOCL æ˜¯ä¸åŠ ç­çš„ï¼Œå³ä½¿æœ‰é¡¹ç›®ç‰¹åˆ«ç´§çš„æ—¶å€™åŠ ç­ï¼Œä¹Ÿä¼šæŠŠåŠ ç­çš„æ—¶é—´è¡¥ç»™ä½ ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥åœ¨é¡¹ç›®æ²¡é‚£ä¹ˆç´§çš„æ—¶å€™å¤šä¼‘å‡ å¤©å‡ï¼Œè¿™ç‚¹å¾ˆäººæ€§åŒ–ã€‚é‡‘å±±æ®è¯´åŠ ç­æŒºä¸¥é‡çš„ï¼Œç›®å‰è¿˜ä¸çŸ¥é“å¦‚ä½•ã€‚</p><h3>å¾…é‡</h3><p>å…¶å®è¿™æ¬¡è·³æ§½ï¼Œæ²¡æœ‰æ¶¨å¤šå°‘å·¥èµ„ï¼Œæ„Ÿè§‰å¾…é‡å·®ä¸å¤ªå¤šã€‚ä¸çŸ¥é“è¿™è¾¹å·¥èµ„ä¸Šå‡ç©ºé—´å¤§ä¸å¤§ã€‚ä¸è¿‡é‡‘å±±ä½æˆ¿å…¬ç§¯é‡‘äº¤ 12%ï¼Œè¿™ç‚¹ä¸é”™ã€‚</p><h3>æŠ€æœ¯</h3><p>æŠ€æœ¯ä¸Šå…¶å® OOCL ç®—æ˜¯ä¸€ä¸ªæ¯”è¾ƒæ•¢å°æ–°çš„å…¬å¸ï¼Œé™¤äº†å…¬å¸ä¸»è¦ä¸šåŠ¡ç½‘ç«™ä¸€ç›´åšæŒ JavaEE çš„æŠ€æœ¯æ ˆä»¥å¤–ï¼Œå¾ˆå¤šæ–°çš„ä¸šåŠ¡éƒ½æ˜¯ç”¨æ¯”è¾ƒæ–°çš„æŠ€æœ¯åšçš„ã€‚æ¯”å¦‚æˆ‘å»å¹´å°±æ¥è§¦äº† MEANã€Hadoopã€Scalaã€Sparkã€HBaseã€Hiveã€Impalaã€æœºå™¨å­¦ä¹ ç­‰å¾ˆå¤šæ¯”è¾ƒæ–°æ½®çš„æŠ€æœ¯ï¼Œè™½ç„¶å¾ˆå¤šéƒ½æ˜¯æµ…å°è¾„æ­¢ã€‚ä¹Ÿæ˜¯å‰é¢å‡ ä¸ªæœˆç»´æŠ¤ä¸€ä¸ª Node.JS çš„é¡¹ç›®è®©æˆ‘å¯¹ JavaScript ç”Ÿæ€äº§ç”Ÿäº†å…´è¶£ï¼Œæœ€ç»ˆè½¬å…¥å‰ç«¯è¡Œä¸šçš„ã€‚é‡‘å±±è¿™è¾¹ä¼¼ä¹ä¹Ÿæ˜¯æ¯”è¾ƒæ„¿æ„æ¥å—å¸çº³æ–°æŠ€æœ¯ï¼Œå°±æˆ‘åœ¨çš„é¡¹ç›®ç»„è€Œè¨€ï¼Œå·²ç»å¼€å§‹å®Œå…¨ç”¨ ES6 å¼€å‘äº§å“ï¼Œå¯¹ React å’Œ Vue ä¹Ÿé‡‡å–ä¹è§‚çš„æ€åº¦ã€‚</p><h2>æœ€å</h2><p>ä»Šå¹´æˆ‘çš„ç›®æ ‡æ˜¯ä¸°å¯Œè‡ªå·±å‰ç«¯æŠ€æœ¯æ ˆï¼Œæé«˜è‡ªå·±ç‹¬ç«‹å¼€å‘çš„èƒ½åŠ›ï¼Œå¼¥è¡¥è‡ªå·± CSS æ–¹é¢çš„åŠ£åŠ¿ã€‚æ— è®ºå¦‚ä½•ï¼Œå¸Œæœ›ä»Šåèƒ½è¿‡å¾—æ›´å¥½ï¼ŒæŠ€æœ¯è¦æ¥è¶Šå¥½ï¼Œé’±è¶Šæ¥è¶Šå¤šã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;img src=&quot;/assets/img/è·³æ§½.png&quot; alt=&quot;è·³æ§½&quot;&gt;
&lt;h2&gt;é¢è¯•ç»å†&lt;/h2&gt;
&lt;p&gt;ä¸€å…±å»é‡‘å±±é¢äº†ä¸‰æ¬¡è¯•ï¼Œä¸€æ¬¡æ˜¯åå°å¼€å‘ï¼Œä¸¤æ¬¡æ˜¯å‰å°å¼€å‘ã€‚å»å¹´11æœˆä»½çš„æ—¶å€™ç¬¬ä¸€æ¬¡å»é‡‘å±±é¢è¯•æœåŠ¡å™¨å¼€å‘çš„èŒä½ï¼Œå¾ˆå¤šé—®é¢˜éƒ½æ²¡æœ‰ç­”ä¸Šæ¥ï¼Œå°±æƒ¨æ·¡ç¦»å»äº†ã€‚åæ¥åˆæœ‰ä¸€ä¸ªå‰ç«¯å¼€å‘çš„å²—ä½ï¼ŒæŠ±ç€è¯•ä¸€è¯•çš„æ€åº¦å°±å»äº†ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Work" scheme="https://lz5z.com/categories/Work/"/>
    
    
      <category term="è·³æ§½" scheme="https://lz5z.com/tags/%E8%B7%B3%E6%A7%BD/"/>
    
  </entry>
  
  <entry>
    <title>ReactJS å­¦ä¹ â€”â€”ç»„ä»¶2</title>
    <link href="https://lz5z.com/ReactJS%E2%80%94%E7%BB%84%E4%BB%B62/"/>
    <id>https://lz5z.com/ReactJSâ€”ç»„ä»¶2/</id>
    <published>2017-02-13T19:35:03.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h2>ç»„ä»¶åˆ—è¡¨</h2><p>ä½¿ç”¨å¾ªç¯çš„æ–¹å¼åˆ›å»ºç»„ä»¶åˆ—è¡¨</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="keyword">const</span> listItems = numbers.map(<span class="function">(<span class="params">number</span>) =&gt;</span></span><br><span class="line">  &lt;li&gt;&#123;number&#125;&lt;<span class="regexp">/li&gt;</span></span><br><span class="line"><span class="regexp">);</span></span><br><span class="line"><span class="regexp">ReactDOM.render(</span></span><br><span class="line"><span class="regexp">  &lt;ul&gt;&#123;listItems&#125;&lt;/u</span>l&gt;,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><a id="more"></a><p>ä½¿ç”¨å‚æ•°</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">NumberList</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> numbers = props.numbers;</span><br><span class="line">  <span class="keyword">const</span> listItems = numbers.map(<span class="function">(<span class="params">number</span>) =&gt;</span></span><br><span class="line">    &lt;li key=&#123;number.toString()&#125;&gt;</span><br><span class="line">      &#123;number&#125;</span><br><span class="line">    &lt;<span class="regexp">/li&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;ul&gt;&#123;listItems&#125;&lt;/u</span>l&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;NumberList numbers=&#123;numbers&#125; /&gt;,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>æ³¨æ„ä¸Šé¢ä»£ç ä¸­çš„ <code>key</code>ï¼Œå®ƒæ˜¯ä¸€ä¸ª string ç±»å‹çš„å±æ€§ï¼Œåœ¨åˆ›å»º lists å…ƒç´ çš„æ—¶å€™ï¼Œä½ éœ€è¦æ·»åŠ è¿™ä¸ªå±æ€§ï¼Œå¦‚æœä¸æ·»åŠ ä¼šæœ‰ warningã€‚</p><h2>Keys</h2><p>React å…ƒç´ å¯ä»¥å…·æœ‰ä¸€ä¸ªç‰¹æ®Šçš„å±æ€§ keyï¼Œè¿™ä¸ªå±æ€§ä¸æ˜¯ç»™ç”¨æˆ·ç”¨çš„ï¼Œè€Œæ˜¯ç»™ React è‡ªå·±ç”¨çš„ã€‚å¦‚æœæˆ‘ä»¬åŠ¨æ€åœ°åˆ›å»º React å…ƒç´ ï¼Œè€Œä¸” React å…ƒç´ å†…åŒ…å«æ•°é‡æˆ–é¡ºåºä¸ç¡®å®šçš„å­å…ƒç´ æ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦æä¾› key è¿™ä¸ªç‰¹æ®Šçš„å±æ€§ã€‚</p><p>ä¸ºä»€ä¹ˆéœ€è¦ç»™æ¯ä¸€ä¸ªå…ƒç´ ä¸€ä¸ªæ ‡è¯†å‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“å½“ç»„ä»¶çš„å±æ€§å‘ç”Ÿäº†å˜åŒ–ï¼Œå…¶ render æ–¹æ³•ä¼šè¢«é‡æ–°è°ƒç”¨ï¼Œç»„ä»¶ä¼šè¢«é‡æ–°æ¸²æŸ“ã€‚æ¯”å¦‚å…ƒç´ é‡Œé¢ <code>[{name: 'Leo'}] =&gt; [{name: 'Jack'}]</code> é‚£ä¹ˆæœ‰å¯èƒ½æ˜¯åˆ é™¤äº† Leoï¼Œç„¶åä¸º Jack æ–°å»ºäº†ä¸€ä¸ªï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯æ›´æ”¹äº† name å±æ€§ï¼Œå› æ­¤ä¸ºæ•°ç»„ä¸­çš„å…ƒç´ ä¼ ä¸€ä¸ªå”¯ä¸€çš„ keyï¼ˆæ¯”å¦‚ç”¨æˆ·çš„ IDï¼‰ï¼Œå°±å¾ˆå¥½åœ°è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚React æ¯”è¾ƒæ›´æ–°å‰åçš„å…ƒç´  key å€¼ï¼Œå¦‚æœç›¸åŒåˆ™æ›´æ–°ï¼Œå¦‚æœä¸åŒåˆ™é”€æ¯ä¹‹å‰çš„ï¼Œé‡æ–°åˆ›å»ºä¸€ä¸ªå…ƒç´ ã€‚</p><h3>Keys çš„ç”¨æ³•</h3><p>Keys åªèƒ½è¢«å®šä¹‰åœ¨å¾ªç¯é‡Œé¢</p><p>ä»¥ä¸‹ç”¨æ³•éƒ½æ˜¯é”™è¯¯çš„</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ListItem</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> value = props.value;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="comment">// Wrong! There is no need to specify the key here:</span></span><br><span class="line">    &lt;li key=&#123;value.toString()&#125;&gt;</span><br><span class="line">      &#123;value&#125;</span><br><span class="line">    &lt;<span class="regexp">/li&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">function NumberList(props) &#123;</span></span><br><span class="line"><span class="regexp">  const numbers = props.numbers;</span></span><br><span class="line"><span class="regexp">  const listItems = numbers.map((number) =&gt;</span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/ Wrong! The key should have been specified here:</span></span><br><span class="line"><span class="regexp">    &lt;ListItem value=&#123;number&#125; /</span>&gt;</span><br><span class="line">  );</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">      &#123;listItems&#125;</span><br><span class="line">    &lt;<span class="regexp">/ul&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const numbers = [1, 2, 3, 4, 5];</span></span><br><span class="line"><span class="regexp">ReactDOM.render(</span></span><br><span class="line"><span class="regexp">  &lt;NumberList numbers=&#123;numbers&#125; /</span>&gt;,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯æ­£ç¡®çš„ç”¨æ³•ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ListItem</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Correct! There is no need to specify the key here:</span></span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123;props.value&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">NumberList</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> numbers = props.numbers;</span><br><span class="line">  <span class="keyword">const</span> listItems = numbers.map(<span class="function">(<span class="params">number</span>) =&gt;</span></span><br><span class="line">    <span class="comment">// Correct! Key should be specified inside the array.</span></span><br><span class="line">    &lt;ListItem key=&#123;number.toString()&#125;</span><br><span class="line">              value=&#123;number&#125; /&gt;</span><br><span class="line">  );</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">      &#123;listItems&#125;</span><br><span class="line">    &lt;<span class="regexp">/ul&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const numbers = [1, 2, 3, 4, 5];</span></span><br><span class="line"><span class="regexp">ReactDOM.render(</span></span><br><span class="line"><span class="regexp">  &lt;NumberList numbers=&#123;numbers&#125; /</span>&gt;,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;ç»„ä»¶åˆ—è¡¨&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨å¾ªç¯çš„æ–¹å¼åˆ›å»ºç»„ä»¶åˆ—è¡¨&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; numbers = [&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; listItems = numbers.map(&lt;span class=&quot;function&quot;&gt;(&lt;span class=&quot;params&quot;&gt;number&lt;/span&gt;) =&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;lt;li&amp;gt;&amp;#123;number&amp;#125;&amp;lt;&lt;span class=&quot;regexp&quot;&gt;/li&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;regexp&quot;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;regexp&quot;&gt;ReactDOM.render(&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;regexp&quot;&gt;  &amp;lt;ul&amp;gt;&amp;#123;listItems&amp;#125;&amp;lt;/u&lt;/span&gt;l&amp;gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.getElementById(&lt;span class=&quot;string&quot;&gt;&#39;root&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="React" scheme="https://lz5z.com/categories/React/"/>
    
    
      <category term="JavaScript" scheme="https://lz5z.com/tags/JavaScript/"/>
    
      <category term="ES6" scheme="https://lz5z.com/tags/ES6/"/>
    
      <category term="React" scheme="https://lz5z.com/tags/React/"/>
    
  </entry>
  
  <entry>
    <title>Fetch API ä½¿ç”¨</title>
    <link href="https://lz5z.com/FetchAPI/"/>
    <id>https://lz5z.com/FetchAPI/</id>
    <published>2017-02-12T16:25:06.000Z</published>
    <updated>2020-04-21T10:23:54.823Z</updated>
    
    <content type="html"><![CDATA[<h1>èƒŒæ™¯</h1><p>åœ¨ä¸Šä¸€ç« å­¦ä¹  <a href="https://lz5z.com/ReactJS%E2%80%94%E7%BB%84%E4%BB%B6/">React ç»„ä»¶</a>çš„æ—¶å€™ï¼Œæƒ³å¢åŠ  React å¯¹ Ajax æ”¯æŒçš„å†…å®¹ï¼Œå´å‘ç°ç½‘ä¸Šçš„æ•™ç¨‹ç«Ÿç„¶ç”¨ jQuery å®Œæˆ Ajax è¯·æ±‚ï¼Œä¸ªäººè§‰å¾—ä¸ºäº†å‘é€ä¸€ä¸ªç®€å•çš„è¯·æ±‚å¼•å…¥ jQuery åº“æ€é¸¡ç„‰ç”¨å®°ç‰›åˆ€å•Šã€‚å…¶å® W3C å·²ç»æœ‰äº†æ›´å¥½çš„æ›¿ä»£å“ï¼Œé‚£å°±æ˜¯ï¼š <a href="https://fetch.spec.whatwg.org/" target="_blank" rel="noopener">Fetch API</a>ã€‚</p><a id="more"></a><h2><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Fetch_API" target="_blank" rel="noopener">Fetch API</a></h2><p>Fetch API çš„å‡ºç°ä¸ JavaScript å¼‚æ­¥ç¼–ç¨‹æ¨¡å‹ Promise æ¯æ¯ç›¸å…³ï¼Œåœ¨ Fetch API å‡ºç°ä¹‹å‰ï¼ŒJavaScript é€šè¿‡ XMLHttpRequest(XHR) æ¥æ‰§è¡Œå¼‚æ­¥è¯·æ±‚ï¼ŒXHR å°†è¾“å…¥ã€è¾“å‡ºå’Œäº‹ä»¶æ¨¡å‹æ··æ‚åœ¨ä¸€ä¸ªå¯¹è±¡é‡Œï¼Œè¿™ç§è®¾è®¡å¹¶ä¸ç¬¦åˆèŒè´£åˆ†ç¦»çš„åŸåˆ™ã€‚è€Œä¸”ï¼ŒåŸºäºäº‹ä»¶çš„æ¨¡å‹ä¸ Promise ä»¥åŠåŸºäº Generator çš„å¼‚æ­¥ç¼–ç¨‹æ¨¡å‹ä¸å¤ªæ­ã€‚</p><p>Fetch API æä¾›äº†å¯¹ <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Headers" target="_blank" rel="noopener">Headers</a>ï¼Œ<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Request" target="_blank" rel="noopener">Request</a>ï¼Œ<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Response" target="_blank" rel="noopener">Response</a> ä¸‰ä¸ªå¯¹è±¡çš„å°è£…ï¼Œä»¥åŠä¸€ä¸ª <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/GlobalFetch" target="_blank" rel="noopener">fetch()</a> å‡½æ•°ç”¨æ¥è·å–ç½‘ç»œèµ„æºï¼Œå¹¶ä¸”åœ¨ç¦»çº¿ç”¨æˆ·ä½“éªŒæ–¹é¢ï¼Œç”±äº ServiceWorkers çš„ä»‹å…¥ï¼ŒFetch API ä¹Ÿèƒ½æä¾›å¼ºå¤§çš„æ”¯æŒã€‚</p><h3>å…¼å®¹æ€§</h3><p>fetch() æ–¹æ³•è¢«å®šä¹‰åœ¨ window å¯¹è±¡ä¸­ï¼Œä½ å¯ä»¥ç›´æ¥åœ¨æ§åˆ¶å°ä¸­è¾“å…¥ fetch() æŸ¥çœ‹æµè§ˆå™¨æ˜¯å¦æ”¯æŒï¼ŒgitHub ä¸Šæœ‰åŸºäºä½ç‰ˆæœ¬æµè§ˆå™¨çš„<a href="https://github.com/github/fetch" target="_blank" rel="noopener">å…¼å®¹å®ç°</a>ã€‚</p><h3>ç®€å•ç¤ºä¾‹</h3><p>fetch() æ–¹æ³•æ¥å—ä¸€ä¸ªå‚æ•°â€”â€”èµ„æºçš„è·¯å¾„ã€‚æ— è®ºè¯·æ±‚æˆåŠŸä¸å¦ï¼Œå®ƒéƒ½è¿”å›ä¸€ä¸ª promise å¯¹è±¡ï¼Œresolve å¯¹åº”è¯·æ±‚çš„ Response å¯¹è±¡ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> myImage = <span class="built_in">document</span>.querySelector(<span class="string">'.my-image'</span>);</span><br><span class="line">fetch(<span class="string">'https://lz5z.com/assets/img/avatar.png'</span>)</span><br><span class="line">  .then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!response.ok) <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Error</span>(response);</span><br><span class="line">    <span class="keyword">return</span> response.blob();</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="params">myBlob</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> objectURL = URL.createObjectURL(myBlob);</span><br><span class="line">    myImage.src = objectURL;</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p>ç‚¹å‡»æŸ¥çœ‹<a href="/assets/demo/fetch-demo/index.html">æ•ˆæœ</a></p><p>åœ¨è·å–è¯·æ±‚çš„ Response å¯¹è±¡åï¼Œé€šè¿‡è¯¥å¯¹è±¡çš„ json() æ–¹æ³•å¯ä»¥å°†ç»“æœä½œä¸º JSON å¯¹è±¡è¿”å›ï¼Œresponse.json() åŒæ ·ä¼šè¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå› æ­¤å¯ä»¥ç»§ç»­é“¾æ¥ä¸€ä¸ª then() æ–¹æ³•ã€‚ç›¸æ¯”ä¼ ç»Ÿçš„ XHR çš„åŸºäºäº‹ä»¶ç±»å‹çš„ç¼–ç¨‹æ–¹å¼ï¼Œå››ä¸å››ç®€å•å¾ˆå¤šå“ˆã€‚</p><h3>Request å¯¹è±¡</h3><p>Fetch API å¼•å…¥äº†3ä¸ªæ¥å£ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ Headersï¼ŒRequest ä»¥åŠ Response ã€‚ä»–ä»¬ç›´æ¥å¯¹åº”äº†ç›¸åº”çš„ HTTP æ¦‚å¿µï¼Œä½†æ˜¯åŸºäºå®‰å…¨è€ƒè™‘ï¼Œæœ‰äº›åŒºåˆ«ï¼Œä¾‹å¦‚æ”¯æŒCORSè§„åˆ™ä»¥åŠä¿è¯ cookies ä¸èƒ½è¢«ç¬¬ä¸‰æ–¹è·å–ã€‚</p><p>é€šè¿‡ Request æ„é€ å™¨å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„è¯·æ±‚å¯¹è±¡ï¼Œè¿™ä¹Ÿæ˜¯å»ºè®®æ ‡å‡†çš„ä¸€éƒ¨åˆ†ã€‚ ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¯·æ±‚çš„ urlï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªé€‰é¡¹å¯¹è±¡ï¼Œç”¨äºé…ç½®è¯·æ±‚ã€‚ç„¶åå°† Request å¯¹è±¡ä¼ é€’ç»™ fetch() æ–¹æ³•ï¼Œç”¨äºæ›¿ä»£é»˜è®¤çš„ url å­—ç¬¦ä¸²ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä¸ç¼“å­˜å“åº”ç»“æœï¼Œ æ–¹æ³•ä¸º GET</span></span><br><span class="line"><span class="keyword">let</span> req = <span class="keyword">new</span> Request(url, &#123;<span class="attr">method</span>: <span class="string">'GET'</span>, <span class="attr">cache</span>: <span class="string">'reload'</span>&#125;);</span><br><span class="line">fetch(req).then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">&#125;).catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(err);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥åŸºäº Request å¯¹è±¡åˆ›å»ºæ–°å¯¹è±¡ï¼Œæ¯”å¦‚å°†ä¸€ä¸ª GET è¯·æ±‚åˆ›å»ºæˆä¸ºä¸€ä¸ª POST è¯·æ±‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> postReq = <span class="keyword">new</span> Request(req, &#123;<span class="attr">method</span>: <span class="string">'POST'</span>&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(postReq.method); <span class="comment">//"POST"</span></span><br></pre></td></tr></table></figure><h3>Headers å¯¹è±¡</h3><p>æ¯ä¸ª Request å¯¹è±¡éƒ½æœ‰ä¸€ä¸ª header å±æ€§ï¼Œåœ¨ Fetch API ä¸­å®ƒå¯¹åº”äº†ä¸€ä¸ª Headers å¯¹è±¡ã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Headers å¯¹è±¡æ„å»º Request å¯¹è±¡ã€‚è€Œåœ¨ Response å¯¹è±¡ä¸­ä¹Ÿæœ‰ä¸€ä¸ª header å±æ€§ï¼Œä½†æ˜¯å“åº”å¤´æ˜¯åªè¯»çš„ã€‚</p><p>Headers æ¥å£æ˜¯ä¸€ä¸ªç®€å•çš„å¤šæ˜ å°„çš„å-å€¼è¡¨</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> headers = <span class="keyword">new</span> Headers();</span><br><span class="line">headers.append(<span class="string">'Accept'</span>, <span class="string">'application/json'</span>);</span><br><span class="line"><span class="keyword">let</span> request = <span class="keyword">new</span> Request(url, &#123;<span class="attr">headers</span>: headers&#125;);</span><br><span class="line">fetch(request).then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(response.headers);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ä¼ ä¸€ä¸ªå¤šç»´æ•°ç»„æˆ–è€… jsonï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">reqHeaders = <span class="keyword">new</span> Headers(&#123;</span><br><span class="line">  <span class="string">"Content-Type"</span>: <span class="string">"text/plain"</span>,</span><br><span class="line">  <span class="string">"Content-Length"</span>: content.length.toString(),</span><br><span class="line">  <span class="string">"X-Custom-Header"</span>: <span class="string">"ProcessThisImmediately"</span>,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//æ“ä½œ Headers ä¸­çš„å†…å®¹</span></span><br><span class="line">reqHeaders.has(<span class="string">"Content-Type"</span>) <span class="comment">//true</span></span><br><span class="line">reqHeaders.get(<span class="string">"Content-Type"</span>) <span class="comment">//"text/plain"</span></span><br><span class="line">reqHeaders.set(<span class="string">"Content-Type"</span>, <span class="string">"text/html"</span>)</span><br><span class="line">reqHeaders.delete(<span class="string">"X-Custom-Header"</span>);</span><br></pre></td></tr></table></figure><h3>Response å¯¹è±¡</h3><p>æ„å»º Respondse å¯¹è±¡æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿé€šå¸¸ Response çš„å†…å®¹åœ¨æœåŠ¡ç«¯ç”Ÿæˆï¼Œä½†æ˜¯ Fetch API æ˜¯æµè§ˆå™¨é‡Œé¢çš„å†…å®¹å•Šã€‚</p><p>å¯¹äº†ï¼Œå°±æ˜¯ä¸ºäº†ç¦»çº¿åº”ç”¨ï¼Œé€šè¿‡ Service Worker æµè§ˆå™¨èƒ½å¤Ÿè·å–è¯·æ±‚å¤´çš„å†…å®¹ï¼Œç„¶åé€šè¿‡åœ¨æµè§ˆå™¨ä¸­æ„å»ºå“åº”å¤´æ¥æ›¿æ¢æ¥è‡ªæœåŠ¡å™¨çš„å“åº”å¤´ä»¥è¾¾åˆ°æ„å»ºç¦»çº¿åº”ç”¨çš„ç›®çš„ï¼ˆè¿™æ–¹é¢å†…å®¹ä»¥åå†è¯´ï¼‰ã€‚</p><p>æ„å»ºæ–¹æ³•</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> response = <span class="keyword">new</span> Response(</span><br><span class="line">  <span class="built_in">JSON</span>.stringify(&#123;<span class="attr">photos</span>: &#123;<span class="attr">photo</span>: []&#125;&#125;),</span><br><span class="line">    &#123;<span class="attr">status</span>: <span class="number">200</span>, <span class="attr">headers</span>: headers&#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h3>steam æ”¯æŒ</h3><p>Request å’Œ Response å¯¹è±¡ä¸­çš„ body åªèƒ½è¢«è¯»å–ä¸€æ¬¡ï¼Œå®ƒä»¬æœ‰ä¸€ä¸ªå±æ€§å« bodyUsedï¼Œè¯»å–ä¸€æ¬¡ä¹‹åè®¾ç½®ä¸º trueï¼Œå°±ä¸èƒ½å†è¯»å–äº†ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> res = <span class="keyword">new</span> Response(<span class="string">"one time use"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(res.bodyUsed); <span class="comment">//false</span></span><br><span class="line">res.text().then(<span class="function"><span class="params">v</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(v); <span class="comment">//"one time use"</span></span><br><span class="line">  <span class="built_in">console</span>.log(res.bodyUsed); <span class="comment">// true</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¿™æ ·è®¾è®¡çš„ç›®çš„æ˜¯ä¸ºäº†ä¹‹åå…¼å®¹åŸºäºæµçš„ APIï¼Œè®©åº”ç”¨åªèƒ½æ¶ˆè´¹ä¸€æ¬¡ dataï¼Œè¿™æ ·å°±å…è®¸äº† JavaScript å¤„ç†å¤§æ–‡ä»¶ä¾‹å¦‚è§†é¢‘ï¼Œå¹¶ä¸”å¯ä»¥æ”¯æŒå®æ—¶å‹ç¼©å’Œç¼–è¾‘ã€‚</p><h3>clone æ”¯æŒ</h3><p>å¦‚ä½•è®© body èƒ½ç»å¾—èµ·å¤šæ¬¡è¯»å–å‘¢ï¼ŸFetch API æä¾›äº†ä¸€ä¸ª clone() æ–¹æ³•ã€‚è°ƒç”¨è¿™ä¸ªæ–¹æ³•å¯ä»¥å¾—åˆ°ä¸€ä¸ªå…‹éš†å¯¹è±¡ã€‚ä¸è¿‡è¦è®°å¾—ï¼Œclone() å¿…é¡»è¦åœ¨è¯»å–ä¹‹å‰è°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯å…ˆ clone() å†è¯»å–ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> res = <span class="keyword">new</span> Response(<span class="string">"many times use"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(res.bodyUsed); <span class="comment">//false</span></span><br><span class="line"><span class="keyword">let</span> clone = sheep.clone();</span><br><span class="line"><span class="built_in">console</span>.log(res.bodyUsed); <span class="comment">//false</span></span><br></pre></td></tr></table></figure><h2>æ€»ç»“</h2><p>è™½ç„¶ Fetch API æä¾›äº†æ›´åŠ ç®€æ´çš„æ¥å£ï¼ŒPromise å½¢å¼çš„ç¼–ç¨‹ä½“éªŒï¼Œä½†æ˜¯å®ƒä¹Ÿä¸æ˜¯å®Œç¾çš„ï¼Œæœ€å¤§çš„é—®é¢˜å°±æ˜¯ä¸èƒ½ä¸­æ–­ä¸€ä¸ªè¯·æ±‚ï¼Œå¹¶ä¸”æ— æ³•æ£€æµ‹ä¸€ä¸ªè¯·æ±‚çš„è¿›åº¦ï¼Œè¿™äº›åœ¨ XHR ä¸­æ—©å°±æœ‰å¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆã€‚ä¹Ÿè¡Œ Fetch API éœ€è¦æ›´å¤šçš„æ—¶é—´ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;èƒŒæ™¯&lt;/h1&gt;
&lt;p&gt;åœ¨ä¸Šä¸€ç« å­¦ä¹  &lt;a href=&quot;https://lz5z.com/ReactJS%E2%80%94%E7%BB%84%E4%BB%B6/&quot;&gt;React ç»„ä»¶&lt;/a&gt;çš„æ—¶å€™ï¼Œæƒ³å¢åŠ  React å¯¹ Ajax æ”¯æŒçš„å†…å®¹ï¼Œå´å‘ç°ç½‘ä¸Šçš„æ•™ç¨‹ç«Ÿç„¶ç”¨ jQuery å®Œæˆ Ajax è¯·æ±‚ï¼Œä¸ªäººè§‰å¾—ä¸ºäº†å‘é€ä¸€ä¸ªç®€å•çš„è¯·æ±‚å¼•å…¥ jQuery åº“æ€é¸¡ç„‰ç”¨å®°ç‰›åˆ€å•Šã€‚å…¶å® W3C å·²ç»æœ‰äº†æ›´å¥½çš„æ›¿ä»£å“ï¼Œé‚£å°±æ˜¯ï¼š &lt;a href=&quot;https://fetch.spec.whatwg.org/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Fetch API&lt;/a&gt;ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="https://lz5z.com/tags/JavaScript/"/>
    
      <category term="W3C" scheme="https://lz5z.com/tags/W3C/"/>
    
      <category term="Fetch API" scheme="https://lz5z.com/tags/Fetch-API/"/>
    
  </entry>
  
  <entry>
    <title>ReactJS å­¦ä¹ â€”â€”ç»„ä»¶</title>
    <link href="https://lz5z.com/ReactJS%E2%80%94%E7%BB%84%E4%BB%B6/"/>
    <id>https://lz5z.com/ReactJSâ€”ç»„ä»¶/</id>
    <published>2017-02-08T17:02:15.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h1>ReactJS ç»„ä»¶</h1><p>React æå€¡<a href="https://facebook.github.io/react/docs/react-component.html" target="_blank" rel="noopener">ç»„ä»¶åŒ–</a>çš„å¼€å‘æ–¹å¼ï¼Œæ¯ä¸ªç»„ä»¶åªå…³å¿ƒè‡ªå·±éƒ¨åˆ†çš„é€»è¾‘ï¼Œä½¿å¾—åº”ç”¨æ›´åŠ å®¹æ˜“ç»´æŠ¤å’Œå¤ç”¨ã€‚</p><p>React è¿˜æœ‰ä¸€ä¸ªå¾ˆå¤§çš„ä¼˜åŠ¿æ˜¯åŸºäºç»„ä»¶çš„çŠ¶æ€æ›´æ–°è§†å›¾ï¼Œå¯¹äºæµ‹è¯•éå¸¸å‹å¥½ã€‚</p><a id="more"></a><h2>æ•°æ®æ¨¡å‹</h2><h3>state</h3><p>React æ¯ä¸€ä¸ªç»„ä»¶çš„å®è´¨æ˜¯çŠ¶æ€æœºï¼ˆState Machinesï¼‰ï¼Œåœ¨ React çš„æ¯ä¸€ä¸ªç»„ä»¶é‡Œï¼Œé€šè¿‡æ›´æ–° this.stateï¼Œå†è°ƒç”¨ render() æ–¹æ³•è¿›è¡Œæ¸²æŸ“ï¼ŒReact ä¼šè‡ªåŠ¨æŠŠæœ€æ–°çš„çŠ¶æ€æ¸²æŸ“åˆ°ç½‘é¡µä¸Šã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloMessage</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>() &#123;</span><br><span class="line">    <span class="keyword">super</span>();</span><br><span class="line">    <span class="keyword">this</span>.handleClick = <span class="keyword">this</span>.handleClick.bind(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123;<span class="attr">enable</span>: <span class="literal">false</span>&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  handleClick() &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;<span class="attr">enable</span>: !<span class="keyword">this</span>.state.enable&#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;input type=<span class="string">"text"</span> disabled=&#123;<span class="keyword">this</span>.state.enable&#125; /&gt; </span><br><span class="line">        &lt;button onClick=&#123;<span class="keyword">this</span>.handleClick&#125;&gt;click <span class="keyword">this</span>&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">    &lt;HelloMessage /&gt;,</span><br><span class="line">    <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>é€šè¿‡åœ¨ç»„ä»¶çš„ constructor ä¸­ç»™ this.state èµ‹å€¼ï¼Œæ¥è®¾ç½® state çš„åˆå§‹å€¼ï¼Œæ¯å½“ state çš„å€¼å‘ç”Ÿå˜åŒ–ï¼Œ React é‡æ–°æ¸²æŸ“é¡µé¢ã€‚</p><p>æ³¨æ„ï¼š</p><p>(1) <strong>è¯·ä¸è¦ç›´æ¥ç¼–è¾‘ this.state</strong>ï¼Œå› ä¸ºè¿™æ ·ä¼šå¯¼è‡´é¡µé¢ä¸é‡æ–°æ¸²æŸ“</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Wrong</span></span><br><span class="line"><span class="keyword">this</span>.state.comment = <span class="string">'Hello'</span>;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ this.setState() æ–¹æ³•æ¥æ”¹å˜å®ƒçš„å€¼</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Correct</span></span><br><span class="line"><span class="keyword">this</span>.setState(&#123;<span class="attr">comment</span>: <span class="string">'Hello'</span>&#125;);</span><br></pre></td></tr></table></figure><p>(2) <strong>this.state</strong> çš„æ›´æ–°å¯èƒ½æ˜¯å¼‚æ­¥çš„(this.props ä¹Ÿæ˜¯å¦‚æ­¤)</p><p>React å¯èƒ½ä¼šæ‰¹é‡åœ°è°ƒç”¨ this.setState() æ–¹æ³•ï¼Œthis.state å’Œ this.props ä¹Ÿå¯èƒ½ä¼šå¼‚æ­¥åœ°æ›´æ–°ï¼Œæ‰€ä»¥ä½ ä¸èƒ½ä¾èµ–å®ƒä»¬ç›®å‰çš„å€¼å»è®¡ç®—å®ƒä»¬ä¸‹ä¸€ä¸ªçŠ¶æ€ã€‚</p><p>æ¯”å¦‚ä¸‹é¢æ›´æ–°è®¡æ•°å™¨çš„æ–¹æ³•ä¼šå¤±è´¥ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Wrong</span></span><br><span class="line"><span class="keyword">this</span>.setState(&#123;</span><br><span class="line">  counter: <span class="keyword">this</span>.state.counter + <span class="keyword">this</span>.props.increment,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§å½¢å¼çš„ setState() æ–¹æ³•æ¥æ”¶çš„å‚æ•°ä¸ºä¸€ä¸ªå‡½æ•°è€Œä¸æ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸º previous stateï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºå½“å‰çš„ props</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Correct</span></span><br><span class="line"><span class="keyword">this</span>.setState(<span class="function">(<span class="params">prevState, props</span>) =&gt;</span> (&#123;</span><br><span class="line">  counter: prevState.counter + props.increment</span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure><p>å®ç°ä¸€ä¸ªè®¡æ•°å™¨</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloMessage</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.handleClick = <span class="keyword">this</span>.handleClick.bind(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123;<span class="attr">counter</span>: <span class="number">0</span>&#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handleClick() &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(<span class="function">(<span class="params">prevState, props</span>) =&gt;</span> (&#123;</span><br><span class="line">      counter: prevState.counter + <span class="built_in">parseInt</span>(props.increment)</span><br><span class="line">    &#125;));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;&#123;<span class="keyword">this</span>.state.counter&#125;&lt;<span class="regexp">/h1&gt; </span></span><br><span class="line"><span class="regexp">        &lt;button onClick=&#123;this.handleClick&#125;&gt;click this&lt;/</span>button&gt;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">ReactDOM.render(</span></span><br><span class="line"><span class="regexp">    &lt;HelloMessage increment="1" /</span>&gt;,</span><br><span class="line">    <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h3>props</h3><p>React çš„æ•°æ®æµæ˜¯å•å‘çš„ï¼Œæ˜¯è‡ªä¸Šå‘ä¸‹çš„å±‚çº§ä¼ é€’çš„ï¼Œprops å¯ä»¥å¯¹å›ºå®šçš„æ•°æ®è¿›è¡Œä¼ é€’ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Welcome</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, &#123;this.props.name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3>state vs props</h3><p>state å’Œ props çœ‹èµ·æ¥å¾ˆç›¸ä¼¼ï¼Œå…¶å®æ˜¯å®Œå…¨ä¸åŒçš„ä¸œè¥¿ã€‚</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œthis.props è¡¨ç¤ºé‚£äº›ä¸€æ—¦å®šä¹‰ï¼Œå°±ä¸å†æ”¹å˜çš„ç‰¹æ€§ï¼Œæ¯”å¦‚è´­ç‰©è½¦é‡Œçš„å•†å“åç§°ã€ä»·æ ¼ï¼Œè€Œ this.state æ˜¯ä¼šéšç€ç”¨æˆ·äº’åŠ¨è€Œäº§ç”Ÿå˜åŒ–çš„ç‰¹æ€§ï¼Œæ¯”å¦‚ç”¨æˆ·è´­ä¹°å•†å“çš„ä¸ªæ•°ã€‚</p><h2>è·å– DOM</h2><p>åœ¨ React ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ this.refs æ–¹ä¾¿åœ°è·å– DOMï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloMessage</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>() &#123;</span><br><span class="line">    <span class="keyword">super</span>();</span><br><span class="line">    <span class="keyword">this</span>.handleClick = <span class="keyword">this</span>.handleClick.bind(<span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  handleClick() &#123;</span><br><span class="line">    alert(<span class="keyword">this</span>.refs.myInput.value);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;input ref=<span class="string">"myInput"</span> /&gt; </span><br><span class="line">        &lt;button onClick=&#123;<span class="keyword">this</span>.handleClick&#125;&gt;click <span class="keyword">this</span>&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">    &lt;HelloMessage /&gt;,</span><br><span class="line">    <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h2>ç”Ÿå‘½å‘¨æœŸ</h2><p>React ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸåˆ†ä¸ºä¸‰ç±»ï¼š</p><p>(1) æŒ‚è½½(Mounting): å·²æ’å…¥çœŸå® DOM</p><p>componentWillMount()ï¼š åœ¨åˆæ¬¡æ¸²æŸ“ä¹‹å‰æ‰§è¡Œä¸€æ¬¡ï¼Œæœ€æ—©çš„æ‰§è¡Œç‚¹<br>componentDidMount()ï¼š åœ¨åˆæ¬¡æ¸²æŸ“ä¹‹åæ‰§è¡Œ</p><p>getInitialState() â€“&gt; componentWillMount() â€“&gt; render() â€“&gt; componentDidMount()</p><p>(2) æ›´æ–°(Updating): æ­£åœ¨è¢«é‡æ–°æ¸²æŸ“</p><p>componentWillReceiveProps()ï¼š åœ¨ç»„ä»¶æ¥æ”¶åˆ°æ–°çš„ props çš„æ—¶å€™è°ƒç”¨ã€‚åœ¨åˆå§‹åŒ–æ¸²æŸ“çš„æ—¶å€™ï¼Œè¯¥æ–¹æ³•ä¸ä¼šè°ƒç”¨ã€‚<br>shouldComponentUpdate()ï¼š åœ¨æ¥æ”¶åˆ°æ–°çš„ props æˆ–è€… stateï¼Œå°†è¦æ¸²æŸ“ä¹‹å‰è°ƒç”¨ã€‚<br>componentWillUpdate()ï¼š åœ¨æ¥æ”¶åˆ°æ–°çš„ props æˆ–è€… state ä¹‹å‰ç«‹åˆ»è°ƒç”¨ã€‚<br>componentDidUpdate()ï¼š åœ¨ç»„ä»¶çš„æ›´æ–°å·²ç»åŒæ­¥åˆ° DOM ä¸­ä¹‹åç«‹åˆ»è¢«è°ƒç”¨ã€‚</p><p>componentWillReceiveProps() â€“&gt; shouldComponentUpdate() â€“&gt; componentWillUpdate â€“&gt; render() â€“&gt; componentDidUpdate()</p><p>(3) ç§»é™¤(Unmounting): å·²ç§»å‡ºçœŸå® DOM</p><p>componentWillUnmount()ï¼š åœ¨ç»„ä»¶ä» DOM ä¸­ç§»é™¤çš„æ—¶å€™ç«‹åˆ»è¢«è°ƒç”¨ã€‚</p><p>ä¸‹é¢ä¸¾ React å®˜ç½‘çš„ä¸€ä¸ªè¾“å‡ºæ—¶é—´çš„ä¾‹å­ï¼Œåœ¨ Clock æ¸²æŸ“ä¹‹å‰è®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨ï¼Œæ¯éš”ä¸€ç§’æ›´æ–°ä¸€ä¸‹ this.state.date çš„å€¼ï¼Œå¹¶åœ¨ç»„ä»¶ç§»é™¤çš„æ—¶å€™æ¸…é™¤å®šæ—¶å™¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Clock</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123;<span class="attr">date</span>: <span class="keyword">new</span> <span class="built_in">Date</span>()&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//ç»„ä»¶åˆæ¬¡æ¸²æŸ“ä¹‹åæ‰§è¡Œ</span></span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    <span class="keyword">this</span>.timerID = setInterval(</span><br><span class="line">      () =&gt; <span class="keyword">this</span>.tick(),</span><br><span class="line">      <span class="number">1000</span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//ç»„ä»¶ç§»é™¤çš„æ—¶å€™æ‰§è¡Œ</span></span><br><span class="line">  componentWillUnmount() &#123;</span><br><span class="line">    clearInterval(<span class="keyword">this</span>.timerID);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  tick() &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">      date: <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;Hello, world!&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">        &lt;h2&gt;It is &#123;this.state.date.toLocaleTimeString()&#125;.&lt;/</span>h2&gt;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/æ¸²æŸ“</span></span><br><span class="line"><span class="regexp">ReactDOM.render(</span></span><br><span class="line"><span class="regexp">  &lt;Clock /</span>&gt;,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h2>äº‹ä»¶</h2><p>React å†…å»ºçš„è·¨æµè§ˆå™¨çš„<a href="https://facebook.github.io/react/docs/events.html" target="_blank" rel="noopener">äº‹ä»¶ç³»ç»Ÿ</a>ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç»„ä»¶é‡Œæ·»åŠ å±æ€§æ¥ç»‘å®šäº‹ä»¶å’Œç›¸åº”çš„<a href="https://facebook.github.io/react/docs/handling-events.html" target="_blank" rel="noopener">å¤„ç†å‡½æ•°</a>ã€‚è¿™ç§äº‹ä»¶ç»‘å®šæ–¹æ³•æå¤§çš„æ–¹ä¾¿äº†äº‹ä»¶æ“ä½œï¼Œä¸ç”¨å†åƒä»¥å‰å…ˆå®šä½åˆ° DOM èŠ‚ç‚¹ï¼Œå†é€šè¿‡ addEventListener ç»‘å®šäº‹ä»¶ï¼Œè¿˜è¦ç”¨ removeEventListener è§£ç»‘ã€‚å½“ç»„ä»¶æ³¨é”€æ—¶ï¼ŒReact ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬è§£ç»‘äº‹ä»¶ã€‚</p><p>React å¤„ç†äº‹ä»¶ä¸ DOM å¤„ç†äº‹ä»¶éå¸¸ç›¸ä¼¼ï¼Œæœ‰ä»¥ä¸‹ä¸¤ç‚¹ä¸åŒï¼š</p><ul><li>React äº‹ä»¶ç”¨é©¼å³°å‘½åæ³•ï¼Œè€Œä¸æ˜¯å…¨å°å†™</li><li>é€šè¿‡ JSX è¯­æ³•ä¼ é€’å‡½æ•°ä½œä¸ºäº‹ä»¶å¤„ç†å™¨ï¼Œè€Œä¸æ˜¯å­—ç¬¦ä¸²</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LoggingButton</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  handleClick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'this is:'</span>, <span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;button onClick=&#123;<span class="keyword">this</span>.handleClick&#125;&gt;</span><br><span class="line">        Click me</span><br><span class="line">      &lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure><p>å¦å¤–ä¸€ä¸ªä¸åŒçš„æ˜¯ React ä¸æ”¯æŒå‘äº‹ä»¶å¤„ç†å‡½æ•° <code>return false</code>ï¼Œä¸€èˆ¬ HTML äº‹ä»¶å‡½æ•°ä¸­ï¼Œå¯ä»¥é€šè¿‡ <code>return false</code> æ¥é˜»æ­¢é»˜è®¤è¡Œä¸ºï¼Œæ¯”å¦‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=<span class="string">"#"</span> onclick=<span class="string">"console.log('The link was clicked.'); return false"</span>&gt;</span><br><span class="line">  Click me</span><br><span class="line">&lt;<span class="regexp">/a&gt;</span></span><br></pre></td></tr></table></figure><p>Vue é˜»æ­¢æµè§ˆå™¨é»˜è®¤è¡Œä¸ºçš„æ–¹å¼æœ€ç®€å•ï¼Œç”¨ä¸€ä¸ªè£…é¥°ç¬¦å°±å¯ä»¥æå®š <code>&lt;form v-on:submit.prevent=&quot;onSubmit&quot;&gt;&lt;/form&gt;</code>ã€‚</p><p>è€Œåœ¨ React ä¸­ï¼Œå¿…é¡»è°ƒç”¨ preventDefault æ–¹æ³•æ‰èƒ½å®Œæˆä»¥ä¸ŠåŠŸèƒ½ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ActionLink</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">handleClick</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    e.preventDefault();</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'The link was clicked.'</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;a href=<span class="string">"#"</span> onClick=&#123;handleClick&#125;&gt;</span><br><span class="line">      Click me</span><br><span class="line">    &lt;<span class="regexp">/a&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure><p>åœ¨è¿™é‡Œçš„ <code>e</code> æ˜¯ React å°è£…è¿‡åçš„ï¼Œå› æ­¤ä¸ç”¨æ‹…å¿ƒæ¸¸è§ˆå™¨å·®å¼‚å¸¦æ¥çš„å½±å“ã€‚â˜º</p><h2>æ¡ä»¶æ¸²æŸ“</h2><p>å‡è®¾ Greeting ç»„ä»¶æ ¹æ®çŠ¶æ€é€‰æ‹©æ¸²æŸ“ UserGreeting å’Œ GuestGreeting ä¸­çš„ä¸€ä¸ªã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">UserGreeting</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Welcome back!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">GuestGreeting</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Please sign up.<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Greeting</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> isLoggedIn = props.isLoggedIn;</span><br><span class="line">  <span class="keyword">if</span> (isLoggedIn) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">UserGreeting</span> /&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">GuestGreeting</span> /&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LoginControl</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.handleLogoutClick = <span class="keyword">this</span>.handleLogoutClick.bind(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123;<span class="attr">isLoggedIn</span>: <span class="literal">false</span>&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  handleLogoutClick() &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;<span class="attr">isLoggedIn</span>: !<span class="keyword">this</span>.state.isLoggedIn&#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">const</span> isLoggedIn = <span class="keyword">this</span>.state.isLoggedIn;</span><br><span class="line">    <span class="keyword">let</span> button = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (isLoggedIn) &#123;</span><br><span class="line">      button = <span class="xml"><span class="tag">&lt;<span class="name">LogoutButton</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleLogoutClick&#125;</span> /&gt;</span></span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      button = <span class="xml"><span class="tag">&lt;<span class="name">LoginButton</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleLogoutClick&#125;</span> /&gt;</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;Greeting isLoggedIn=&#123;isLoggedIn&#125; /&gt;</span><br><span class="line">        &#123;button&#125;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure><h3>è¡Œå†…æ¡ä»¶åˆ¤æ–­</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Mailbox</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> unreadMessages = props.unreadMessages;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h1&gt;Hello!&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">      &#123;unreadMessages.length &gt; 0 &amp;&amp;</span></span><br><span class="line"><span class="regexp">        &lt;h2&gt;</span></span><br><span class="line"><span class="regexp">          You have &#123;unreadMessages.length&#125; unread messages.</span></span><br><span class="line"><span class="regexp">        &lt;/</span>h2&gt;</span><br><span class="line">      &#125;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const messages = ['React', 'Re: React', 'Re:Re: React'];</span></span><br><span class="line"><span class="regexp">ReactDOM.render(</span></span><br><span class="line"><span class="regexp">  &lt;Mailbox unreadMessages=&#123;messages&#125; /</span>&gt;,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>å…¶å®ƒç±»å‹çš„é€»è¾‘åˆ¤æ–­ï¼Œåƒä¸‰å…ƒè¿ç®—ç¬¦ï¼Œ<code>if else</code> React ä¹Ÿå‡æ”¯æŒã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">render() &#123;</span><br><span class="line">  <span class="keyword">const</span> isLoggedIn = <span class="keyword">this</span>.state.isLoggedIn;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      The user is &lt;b&gt;&#123;isLoggedIn ? <span class="string">'currently'</span> : <span class="string">'not'</span>&#125;&lt;<span class="regexp">/b&gt; logged in.</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">render() &#123;</span><br><span class="line">  <span class="keyword">const</span> isLoggedIn = <span class="keyword">this</span>.state.isLoggedIn;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &#123;isLoggedIn ? (</span><br><span class="line">        &lt;LogoutButton onClick=&#123;<span class="keyword">this</span>.handleLogoutClick&#125; /&gt;</span><br><span class="line">      ) : (</span><br><span class="line">        &lt;LoginButton onClick=&#123;<span class="keyword">this</span>.handleLoginClick&#125; /&gt;</span><br><span class="line">      )&#125;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure><h3>é˜»æ­¢ç»„ä»¶æ¸²æŸ“</h3><p>é€šè¿‡åœ¨ç»„ä»¶å†…éƒ¨ <code>return null</code> å¯ä»¥è¾¾åˆ°é˜»æ­¢ç»„ä»¶æ¸²æŸ“çš„</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">WarningBanner</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!props.warn) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div className=<span class="string">"warning"</span>&gt;</span><br><span class="line">      Warning!</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure><h2>æœ€å</h2><p>ç¬¬ä¸€ç«  <a href="https://lz5z.com/ReactJS%E2%80%94%E5%85%A5%E9%97%A8/">React å…¥é—¨</a> å’Œæœ¬ç«  React ç»„ä»¶éƒ½æ˜¯æ¯”è¾ƒåŸºç¡€çš„å†…å®¹ï¼Œåé¢ä¼šå­¦ä¹ å…¨æ–°çš„ç¨‹åºè®¾è®¡æ¨¡å¼ Flux å’Œ Redux æ¥ç®¡ç†åº”ç”¨çš„çŠ¶æ€ï¼Œå¾ˆå¤šå‡½æ•°å¼ç¼–ç¨‹çš„æ€æƒ³æ­£å¥½åŠªåŠ›å­¦ä¹ ä¸€ä¸‹ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;ReactJS ç»„ä»¶&lt;/h1&gt;
&lt;p&gt;React æå€¡&lt;a href=&quot;https://facebook.github.io/react/docs/react-component.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ç»„ä»¶åŒ–&lt;/a&gt;çš„å¼€å‘æ–¹å¼ï¼Œæ¯ä¸ªç»„ä»¶åªå…³å¿ƒè‡ªå·±éƒ¨åˆ†çš„é€»è¾‘ï¼Œä½¿å¾—åº”ç”¨æ›´åŠ å®¹æ˜“ç»´æŠ¤å’Œå¤ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;React è¿˜æœ‰ä¸€ä¸ªå¾ˆå¤§çš„ä¼˜åŠ¿æ˜¯åŸºäºç»„ä»¶çš„çŠ¶æ€æ›´æ–°è§†å›¾ï¼Œå¯¹äºæµ‹è¯•éå¸¸å‹å¥½ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="React" scheme="https://lz5z.com/categories/React/"/>
    
    
      <category term="JavaScript" scheme="https://lz5z.com/tags/JavaScript/"/>
    
      <category term="ES6" scheme="https://lz5z.com/tags/ES6/"/>
    
      <category term="React" scheme="https://lz5z.com/tags/React/"/>
    
  </entry>
  
  <entry>
    <title>ReactJS å­¦ä¹ â€”â€”å…¥é—¨</title>
    <link href="https://lz5z.com/ReactJS%E2%80%94%E5%85%A5%E9%97%A8/"/>
    <id>https://lz5z.com/ReactJSâ€”å…¥é—¨/</id>
    <published>2017-02-05T14:45:55.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h1>ReactJS ç®€ä»‹</h1><p><a href="https://facebook.github.io/react/" target="_blank" rel="noopener">React</a> é¦–æ¬¡è¢«æå‡ºæ˜¯åœ¨2014å¹´çš„ F8 å¤§ä¼šä¸Šï¼Œå½“æœŸçš„ä¸»é¢˜ä¸º â€œRethinking Web App Development at Facebookâ€ï¼Œè¿™ä¹Ÿæ˜¯ React åå­—çš„ç”±æ¥ã€‚</p><p>React ä»¥ç»„ä»¶åŒ–çš„å¼€å‘æ–¹å¼ï¼Œä¸“æ³¨äº MVC æ¶æ„ä¸­çš„ Viewï¼Œå³è§†å›¾ï¼Œ è¿™ä½¿å¾—Reactå¾ˆå®¹æ˜“å’Œå¼€å‘è€…å·²æœ‰çš„å¼€å‘æ ˆè¿›è¡Œèåˆã€‚React æ¨èå°† UI ä¸Šæ¯ä¸€ä¸ªåŠŸèƒ½ç›¸å¯¹ç‹¬ç«‹çš„æ¨¡å—å®šä¹‰æˆç»„ä»¶ï¼Œç„¶åå°†å°çš„ç»„ä»¶é€šè¿‡ç»„åˆæˆ–è€…åµŒå¥—çš„æ–¹å¼æ„æˆå¤§çš„ç»„ä»¶ï¼Œæœ€ç»ˆå®Œæˆæ•´ä½“ UI çš„æ„å»ºã€‚</p><a id="more"></a><h1>ReactJS åŸç†</h1><p>Web å¼€å‘çš„æœ€ç»ˆç›®çš„æ˜¯æŠŠæ•°æ®åæ˜ åˆ° UI ä¸Šï¼Œè¿™æ—¶å°±éœ€è¦å¯¹ DOM è¿›è¡Œæ“ä½œï¼Œå¤æ‚æˆ–è€…é¢‘ç¹çš„ DOM æ“ä½œé€šå¸¸æ˜¯æ€§èƒ½ç“¶é¢ˆäº§ç”Ÿçš„åŸå› ã€‚React ä¸ºæ­¤å¼•å…¥äº†è™šæ‹Ÿ DOMï¼ˆVirtual DOMï¼‰ çš„æœºåˆ¶ï¼šå¼€å‘è€…æ“ä½œè™šæ‹Ÿ DOMï¼ŒReact åœ¨å¿…è¦çš„æ—¶å€™å°†å®ƒä»¬æ¸²æŸ“åˆ°çœŸæ­£çš„ DOM ä¸Šã€‚</p><h2>Virtual DOM</h2><p>åŸºäº React è¿›è¡Œå¼€å‘æ—¶æ‰€æœ‰çš„ DOM æ„é€ éƒ½æ˜¯é€šè¿‡è™šæ‹Ÿ DOM è¿›è¡Œï¼Œæ¯å½“æ•°æ®å˜åŒ–æ—¶ï¼ŒReact éƒ½ä¼šé‡æ–°æ„å»ºæ•´ä¸ª DOM æ ‘ï¼Œç„¶å React å°†å½“å‰æ•´ä¸ª DOM æ ‘å’Œä¸Šä¸€æ¬¡çš„ DOM æ ‘è¿›è¡Œå¯¹æ¯”ï¼Œå¾—åˆ° DOM ç»“æ„çš„åŒºåˆ«ï¼Œç„¶åä»…ä»…å°†éœ€è¦å˜åŒ–çš„éƒ¨åˆ†æ›´æ–°åˆ°å®é™…çš„æµè§ˆå™¨ã€‚</p><p>åŒæ—¶ React èƒ½å¤Ÿæ‰¹å¤„ç†è™šæ‹Ÿ DOM çš„åˆ·æ–°ï¼Œåœ¨ä¸€ä¸ªäº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰å†…çš„ä¸¤æ¬¡æ•°æ®å˜åŒ–ä¼šè¢«åˆå¹¶ï¼Œä¾‹å¦‚ä½ è¿ç»­çš„å…ˆå°†èŠ‚ç‚¹å†…å®¹ä» A å˜æˆ Bï¼Œç„¶ååˆä» B å˜æˆ Aï¼ŒReact ä¼šè®¤ä¸º UI ä¸å‘ç”Ÿä»»ä½•å˜åŒ–ã€‚å°½ç®¡æ¯ä¸€æ¬¡éƒ½éœ€è¦æ„é€ å®Œæ•´çš„è™šæ‹Ÿ DOM æ ‘ï¼Œä½†æ˜¯å› ä¸ºè™šæ‹Ÿ DOM æ˜¯å†…å­˜æ•°æ®ï¼Œæ€§èƒ½æ˜¯æé«˜çš„ï¼Œè€Œå¯¹å®é™… DOM è¿›è¡Œæ“ä½œçš„ä»…ä»…æ˜¯ Diff éƒ¨åˆ†ï¼Œå› è€Œèƒ½è¾¾åˆ°æé«˜æ€§èƒ½çš„ç›®çš„ã€‚</p><h2>Hello World</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://unpkg.com/react@latest/dist/react.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://unpkg.com/react-dom@latest/dist/react-dom.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://unpkg.com/babel-standalone@6.15.0/babel.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/babel"</span>&gt;</span></span><br><span class="line">      ReactDOM.render(</span><br><span class="line"><span class="handlebars"><span class="xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, world!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>,</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span></span><br><span class="line">      );</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ Hello World çš„ä¾‹å­ä¸­ï¼Œå¼•å…¥äº†ä¸‰ä¸ªåº“æ–‡ä»¶ï¼Œreact.jsï¼Œreact-dom.js å’Œ babel.jsï¼Œå®ƒä»¬å¿…é¡»é¦–å…ˆåŠ è½½ã€‚åœ¨ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼Œéœ€è¦åŠ è½½ â€œJSXTransformer.jsâ€ï¼Œåæ¥ React å®˜æ–¹ä¸å†ç»´æŠ¤è¿™ä¸ªåº“ï¼Œç”± babel å¯¹ JSX è¯­æ³•è¿›è¡Œç¼–è¯‘ã€‚<br>ReactDOM.render æ˜¯ React çš„æœ€åŸºæœ¬æ–¹æ³•ï¼Œç”¨äºå°†æ¨¡æ¿è½¬ä¸º HTML è¯­è¨€ï¼Œå¹¶æ’å…¥æŒ‡å®šçš„ DOM èŠ‚ç‚¹ã€‚</p><h2>create-react-app</h2><p>ä¸€èˆ¬æˆ‘ä»¬å¯åŠ¨ä¸€ä¸ª React é¡¹ç›®ä¼šä½¿ç”¨ React è„šæ‰‹æ¶å·¥å…· <a href="https://github.com/facebookincubator/create-react-app" target="_blank" rel="noopener">create-react-app</a>,å®ƒä¼šå¸®åŠ©ä½ åˆ›å»ºä¸€ä¸ªåŸºäº webpackã€Babel å’Œ ESLint çš„å•é¡µé¢é¡¹ç›®ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> yarn global add create-react-app</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> create-react-app react-demo</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> react-demo</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> yarn start</span></span><br></pre></td></tr></table></figure><p>é¡¹ç›®å¯åŠ¨åä¼šæœ‰ä¸€ä¸ª â€œWelcome to Reactâ€ çš„é¡µé¢è‡ªåŠ¨æ‰“å¼€ã€‚</p><p>æ‰“å¼€ package.json æ–‡ä»¶ï¼Œå‘ç°å¹¶æ²¡æœ‰æ‰¾åˆ° webpackã€Babel ç­‰ package ç›¸å…³çš„ä¾èµ–ï¼Œæ‰€æœ‰çš„å·¥ä½œéƒ½æ˜¯ â€œreact-scriptsâ€ å¸®åŠ©æˆ‘ä»¬åšçš„ï¼Œè¿™æ ·æå¤§åœ°é™ä½äº†åˆå­¦è€…å…¥é—¨å­¦ä¹  React çš„æˆæœ¬ã€‚</p><h2><a href="https://facebook.github.io/react/docs/introducing-jsx.html" target="_blank" rel="noopener">JSX</a></h2><p>HTML è¯­è¨€ç›´æ¥å†™åœ¨ JavaScript è¯­è¨€ä¹‹ä¸­ï¼Œä¸åŠ ä»»ä½•å¼•å·ï¼Œè¿™å°±æ˜¯ JSX çš„è¯­æ³•ï¼Œå®ƒå…è®¸ HTML ä¸ JavaScript çš„æ··å†™ã€‚</p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> names = [<span class="string">'Leo'</span>, <span class="string">'Jack'</span>, <span class="string">'John'</span>];</span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">  &#123;</span><br><span class="line">    names.map(<span class="function">(<span class="params">name</span>)=&gt;</span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;name&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;,</span></span><br><span class="line"><span class="regexp">  document.getElementById('root')</span></span><br><span class="line"><span class="regexp">);</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä½“ç°äº† JSX çš„åŸºæœ¬è¯­æ³•è§„åˆ™ï¼šé‡åˆ° HTML æ ‡ç­¾ï¼ˆä»¥ &lt; å¼€å¤´ï¼‰ï¼Œå°±ç”¨ HTML è§„åˆ™è§£æï¼›é‡åˆ°ä»£ç å—ï¼ˆä»¥ { å¼€å¤´ï¼‰ï¼Œå°±ç”¨ JavaScript è§„åˆ™è§£æã€‚</p><p>JSX å…è®¸ç›´æ¥åœ¨æ¨¡æ¿æ’å…¥ JavaScript å˜é‡ã€‚å¦‚æœè¿™ä¸ªå˜é‡æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œåˆ™ä¼šå±•å¼€è¿™ä¸ªæ•°ç»„çš„æ‰€æœ‰æˆå‘˜ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [</span><br><span class="line">  &lt;h1&gt;Hello&lt;<span class="regexp">/h1&gt;, </span></span><br><span class="line"><span class="regexp">  &lt;h1&gt;world&lt;/</span>h1&gt;</span><br><span class="line">];</span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">  &#123;arr&#125;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;,</span></span><br><span class="line"><span class="regexp">  document.getElementById('root')</span></span><br><span class="line"><span class="regexp">);</span></span><br></pre></td></tr></table></figure><p>ReactDOM.render æ–¹æ³•ä¹Ÿå¯ä»¥å†™åœ¨å‡½æ•°ä¸­ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> t0 = <span class="keyword">new</span> <span class="built_in">Date</span>().getTime();</span><br><span class="line">setInterval(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">  <span class="keyword">let</span> t = <span class="keyword">new</span> <span class="built_in">Date</span>().getTime(),</span><br><span class="line">  delta = t - t0;</span><br><span class="line">  <span class="comment">//åœ¨è™šæ‹ŸDOMä¸Šåˆ›å»ºå…ƒç´ </span></span><br><span class="line">  <span class="keyword">let</span> el = React.createElement(<span class="string">"p"</span>,<span class="literal">null</span>,delta);</span><br><span class="line">  <span class="comment">//æ¸²æŸ“åˆ°çœŸå®DOM</span></span><br><span class="line">  ReactDOM.render(el,<span class="built_in">document</span>.getElementById(<span class="string">'root'</span>));</span><br><span class="line">&#125;,<span class="number">16</span>);</span><br></pre></td></tr></table></figure><h2>React ç»„ä»¶</h2><p>å®šä¹‰ React ç»„ä»¶æœ‰ä¸‰ç§æ–¹æ³•ï¼Œç¬¬ä¸€ç§æ˜¯ JavaScript å‡½æ•°ï¼Œç¬¬äºŒç§æ˜¯ç”¨ ES6 classes çš„æ–¹å¼ï¼Œä¸€ä¸ªæ˜¯ç”¨ React.createClass(å·²ç»è¿‡æ—¶)</p><h3>JavaScript å‡½æ•°</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">HelloMessage</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, &#123;props.name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line">ReactDOM.render(</span><br><span class="line">    &lt;HelloMessage name=<span class="string">"Leo"</span>/&gt;,</span><br><span class="line">    <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>æ³¨æ„è¿™é‡Œè°ƒç”¨å±æ€§çš„æ—¶å€™æ²¡æœ‰ thisã€‚</p><h3>React.Component</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloMessage</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, &#123;this.props.name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;HelloMessage name=<span class="string">"Leo"</span>/&gt;,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h3>React.createClass</h3><p>React.createClass(meta) æ–¹æ³•ç”¨äºç”Ÿæˆç»„ä»¶ç±»ï¼Œå‚æ•° meta æ˜¯ä¸€ä¸ªå®ç°é¢„å®šä¹‰æ¥å£çš„ JavaScript å¯¹è±¡ï¼Œç”¨æ¥å¯¹ React ç»„ä»¶åŸå‹è¿›è¡Œæ‰©å±•ã€‚<br>åœ¨ meta ä¸­ï¼Œè‡³å°‘éœ€è¦å®ç°ä¸€ä¸ª render() æ–¹æ³•ï¼Œè€Œè¿™ä¸ªæ–¹æ³•ï¼Œ å¿…é¡»è€Œä¸”åªèƒ½è¿”å›ä¸€ä¸ªæœ‰æ•ˆçš„ React å…ƒç´ ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœä½ çš„ç»„ä»¶æ˜¯ç”±å¤šä¸ªå…ƒç´ æ„æˆçš„ï¼Œé‚£ä¹ˆä½ å¿…é¡»åœ¨å¤–è¾¹åŒ…ä¸€ä¸ªé¡¶å±‚å…ƒç´ ï¼Œç„¶åè¿”å›è¿™ä¸ªé¡¶å±‚å…ƒç´ ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> HelloMessage = React.createClass(&#123;</span><br><span class="line">  render: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello &#123;this.props.name&#125;!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;HelloMessage name=<span class="string">"Leo"</span>/&gt;,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><ol><li>ç»„ä»¶åå¿…é¡»ä»¥å¤§å†™å­—æ¯å¼€å¤´</li><li>ç»„ä»¶ç±»åªèƒ½åŒ…å«ä¸€ä¸ªé¡¶å±‚æ ‡ç­¾</li><li>è·å–å±æ€§çš„å€¼ç”¨çš„æ˜¯ this.props.å±æ€§å</li><li>ä¸ºå…ƒç´ æ·»åŠ  css çš„ class æ—¶ï¼Œè¦ç”¨ classNameï¼Œfor å±æ€§éœ€è¦å†™æˆ htmlForï¼Œ å› ä¸º class å’Œ for æ˜¯ ES6 å…³é”®å­—</li></ol><h2>å†…è” css</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> HelloMessage = React.createClass(&#123;</span><br><span class="line">  render: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;color:</span>"<span class="attr">red</span>",<span class="attr">fontSize:</span> "<span class="attr">44px</span>"&#125;&#125;&gt;</span></span></span><br><span class="line"><span class="xml">          Hello &#123;this.props.name&#125;!<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>å†…è” css çš„å†™æ³•ä¸ç”¨ JavaScript ç›´æ¥æ“ä½œæ ·å¼ç›¸åŒï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">'root'</span>).style.paddingLeft=<span class="string">'104px'</span>;</span><br></pre></td></tr></table></figure><h3>ç»„ä»¶ç»„åˆ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç»„åˆç»„ä»¶</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WebSite</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;Name name=&#123;<span class="keyword">this</span>.props.name&#125; /&gt;</span><br><span class="line">        &lt;Link site=&#123;<span class="keyword">this</span>.props.site&#125; /&gt;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/Nameç»„ä»¶</span></span><br><span class="line"><span class="regexp">class Name extends React.Component &#123;</span></span><br><span class="line"><span class="regexp">  render() &#123;</span></span><br><span class="line"><span class="regexp">    return (</span></span><br><span class="line"><span class="regexp">      &lt;h1&gt;&#123;this.props.name&#125;&lt;/</span>h1&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//L****inkç»„ä»¶</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Link</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;a href=&#123;<span class="keyword">this</span>.props.site&#125;&gt;</span><br><span class="line">        &#123;<span class="keyword">this</span>.props.site&#125;</span><br><span class="line">      &lt;<span class="regexp">/a&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">ReactDOM.render(</span></span><br><span class="line"><span class="regexp">  &lt;WebSite name="Leo" site="https:/</span><span class="regexp">/lz5z.com" /</span>&gt;,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h1>æœ€å</h1><p>ReactJS å…¥é—¨æš‚æ—¶å°±åˆ°è¿™é‡Œï¼Œåé¢ä¼šæœ‰æ›´åŠ è¯¦ç»†çš„å†…å®¹ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;ReactJS ç®€ä»‹&lt;/h1&gt;
&lt;p&gt;&lt;a href=&quot;https://facebook.github.io/react/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;React&lt;/a&gt; é¦–æ¬¡è¢«æå‡ºæ˜¯åœ¨2014å¹´çš„ F8 å¤§ä¼šä¸Šï¼Œå½“æœŸçš„ä¸»é¢˜ä¸º â€œRethinking Web App Development at Facebookâ€ï¼Œè¿™ä¹Ÿæ˜¯ React åå­—çš„ç”±æ¥ã€‚&lt;/p&gt;
&lt;p&gt;React ä»¥ç»„ä»¶åŒ–çš„å¼€å‘æ–¹å¼ï¼Œä¸“æ³¨äº MVC æ¶æ„ä¸­çš„ Viewï¼Œå³è§†å›¾ï¼Œ è¿™ä½¿å¾—Reactå¾ˆå®¹æ˜“å’Œå¼€å‘è€…å·²æœ‰çš„å¼€å‘æ ˆè¿›è¡Œèåˆã€‚React æ¨èå°† UI ä¸Šæ¯ä¸€ä¸ªåŠŸèƒ½ç›¸å¯¹ç‹¬ç«‹çš„æ¨¡å—å®šä¹‰æˆç»„ä»¶ï¼Œç„¶åå°†å°çš„ç»„ä»¶é€šè¿‡ç»„åˆæˆ–è€…åµŒå¥—çš„æ–¹å¼æ„æˆå¤§çš„ç»„ä»¶ï¼Œæœ€ç»ˆå®Œæˆæ•´ä½“ UI çš„æ„å»ºã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="React" scheme="https://lz5z.com/categories/React/"/>
    
    
      <category term="JavaScript" scheme="https://lz5z.com/tags/JavaScript/"/>
    
      <category term="ES6" scheme="https://lz5z.com/tags/ES6/"/>
    
      <category term="React" scheme="https://lz5z.com/tags/React/"/>
    
  </entry>
  
  <entry>
    <title>Yarn ç®¡ç† JavaScript æ¨¡å—</title>
    <link href="https://lz5z.com/Yarn%E7%AE%A1%E7%90%86JavaScript%E6%A8%A1%E5%9D%97/"/>
    <id>https://lz5z.com/Yarnç®¡ç†JavaScriptæ¨¡å—/</id>
    <published>2017-02-01T19:42:03.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h1><a href="https://yarnpkg.com/" target="_blank" rel="noopener">Yarn</a> ç®€ä»‹</h1><p>Yarn æ˜¯ Facebook å¼€å‘çš„ä¸€æ¬¾æ–°çš„ JavaScript åŒ…ç®¡ç†å·¥å…·ï¼Œ ä½œä¸º NPM çš„æ›¿ä»£äº§å“ï¼Œä¸»è¦æ˜¯ä¸ºäº†è§£å†³ä¸‹é¢ä¸¤ä¸ªé—®é¢˜ï¼š</p><ul><li>å®‰è£…çš„æ—¶å€™æ— æ³•ä¿è¯é€Ÿåº¦/ä¸€è‡´æ€§</li><li>å®‰å…¨é—®é¢˜ï¼Œå› ä¸º NPM å®‰è£…æ—¶å…è®¸è¿è¡Œä»£ç </li></ul><a id="more"></a><h1>Yarn vs NPM</h1><h2>é€Ÿåº¦å¿«</h2><p>ç›¸æ¯”äº NPMï¼ŒYarn çš„é€Ÿåº¦æ›´å¿«ï¼ŒYarn ä¼šæŠŠä½¿ç”¨è¿‡çš„æ¨¡å—åœ¨æœ¬åœ°ç¼“å­˜ä¸€ä»½ï¼Œå¦‚æœä¸‹æ¬¡è¿˜è¦ç”¨åˆ°ç›¸åŒç‰ˆæœ¬çš„æ¨¡å—ï¼Œé‚£ä¹ˆå°†ä¼šç›´æ¥ä½¿ç”¨æœ¬åœ°çš„è€Œä¸æ˜¯è®¿é—®ç½‘ç»œé‡æ–°è·å–ä¸€ä»½ã€‚è€Œ NPM ä½¿ç”¨çš„æ—¶å€™ï¼Œå¦‚æœä¸å…¨å±€å®‰è£…é‚£ä¹ˆæ¯ä¸ªé¡¹ç›®éƒ½è¦é‡æ–°ä¸‹è½½ä¸€æ¬¡åŒ…ï¼Œæµªè´¹æ—¶é—´å’Œèµ„æºã€‚</p><h2>å®‰å…¨æ€§</h2><p>Yarn åœ¨å®‰è£…æ¨¡å—ä¹‹å‰ä¼šéªŒè¯æ–‡ä»¶å®Œæ•´æ€§ã€‚</p><h2>å¹¶è¡Œå®‰è£…</h2><p>æ¯å½“ NPM æˆ– Yarn éœ€è¦å®‰è£…ä¸€ä¸ªåŒ…æ—¶ï¼Œå®ƒä¼šè¿›è¡Œä¸€ç³»åˆ—çš„ä»»åŠ¡ã€‚åœ¨ NPM ä¸­è¿™äº›ä»»åŠ¡æ˜¯æŒ‰åŒ…çš„é¡ºåºä¸€ä¸ªä¸ªæ‰§è¡Œï¼Œè¿™æ„å‘³ç€å¿…é¡»ç­‰å¾…ä¸Šä¸€ä¸ªåŒ…è¢«å®Œæ•´å®‰è£…æ‰ä¼šè¿›å…¥ä¸‹ä¸€ä¸ªï¼›Yarn åˆ™å¹¶è¡Œçš„æ‰§è¡Œè¿™äº›ä»»åŠ¡ï¼Œæé«˜äº†æ€§èƒ½ã€‚</p><h2>è¾“å‡ºæ¸…æ™°</h2><p>NPM å®‰è£…åŒ…çš„æ—¶å€™è¾“å‡ºæƒ¨ä¸å¿ç¹ï¼Œè€Œ Yarn çš„è¾“å‡ºå°±æ¸…æ™°å¤šäº†ã€‚</p><img src="/assets/img/yarn.png" alt="yarn"><h1>ä½¿ç”¨</h1><h2>å¸¸ç”¨å‘½ä»¤å¯¹ç…§è¡¨</h2><table><thead><tr><th style="text-align:left">ä½œç”¨</th><th style="text-align:left">NPM å‘½ä»¤</th><th style="text-align:left">Yarn å‘½ä»¤</th></tr></thead><tbody><tr><td style="text-align:left">åˆå§‹åŒ–</td><td style="text-align:left">npm init</td><td style="text-align:left">yarn init</td></tr><tr><td style="text-align:left">å®‰è£… package.json ä¸­çš„åŒ…</td><td style="text-align:left">npm install</td><td style="text-align:left">yarn</td></tr><tr><td style="text-align:left">å®‰è£…æŸä¸ªåŒ…</td><td style="text-align:left">npm install xxx --save</td><td style="text-align:left">yarn add xxx</td></tr><tr><td style="text-align:left">åˆ é™¤æŸä¸ªåŒ…</td><td style="text-align:left">npm uninstall xxx --save</td><td style="text-align:left">yarn remove xxx</td></tr><tr><td style="text-align:left">å¼€å‘æ¨¡å¼ä¸‹å®‰è£…æŸä¸ªåŒ…</td><td style="text-align:left">npm install xxx --save-dev</td><td style="text-align:left">yarn add xxx -dev</td></tr><tr><td style="text-align:left">æ›´æ–°</td><td style="text-align:left">npm update --save</td><td style="text-align:left">yarn upgrade</td></tr><tr><td style="text-align:left">å…¨å±€å®‰è£…</td><td style="text-align:left">npm install xxx â€“global</td><td style="text-align:left">yarn global add xxx</td></tr><tr><td style="text-align:left">æ¸…é™¤ç¼“å­˜</td><td style="text-align:left">npm cache clean</td><td style="text-align:left">yarn cache clean</td></tr><tr><td style="text-align:left">æŸ¥çœ‹æ¨¡å—ä¿¡æ¯</td><td style="text-align:left">npm info xxx</td><td style="text-align:left">yarn info xxx</td></tr><tr><td style="text-align:left">è¿è¡Œscript</td><td style="text-align:left">npm run</td><td style="text-align:left">yarn run</td></tr><tr><td style="text-align:left">æµ‹è¯•</td><td style="text-align:left">npm test</td><td style="text-align:left">yarn test</td></tr></tbody></table><h2><a href="https://yarnpkg.com/docs/configuration/#toc-use-yarn-lock-to-pin-your-dependencies" target="_blank" rel="noopener">yarn.lock</a> æ–‡ä»¶</h2><p>åœ¨ä½¿ç”¨ NPM ç®¡ç† JavaScript æ¨¡å—çš„æ—¶å€™ï¼Œå¯ä»¥ç”¨æ¯”è¾ƒå®½æ¾çš„æ–¹å¼å®šä¹‰æŸä¸ªæ¨¡å—çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¦‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">*: ä»»æ„ç‰ˆæœ¬</span><br><span class="line">~<span class="number">1.1</span><span class="number">.0</span>: &gt;=<span class="number">1.1</span><span class="number">.0</span> &amp;&amp; &lt; <span class="number">1.2</span><span class="number">.0</span></span><br><span class="line">^<span class="number">1.1</span><span class="number">.0</span>: &gt;=<span class="number">1.1</span><span class="number">.0</span> &amp;&amp; &lt; <span class="number">2.0</span><span class="number">.0</span></span><br><span class="line">&gt;= <span class="number">1.0</span><span class="number">.0</span>: &gt;= <span class="number">1.0</span><span class="number">.0</span></span><br><span class="line"><span class="number">3.</span>x: ä»»æ„ <span class="number">3</span> ç‰ˆæœ¬</span><br></pre></td></tr></table></figure><p>ç†æƒ³çŠ¶æ€ä¸‹ä½¿ç”¨<a href="http://deadhorse.me/nodejs/2014/04/27/semver-in-nodejs.html" target="_blank" rel="noopener">è¯­ä¹‰åŒ–</a>ç‰ˆæœ¬å‘å¸ƒè¡¥ä¸ä¸ä¼šåŒ…å«å¤§çš„å˜åŒ–ï¼Œä½†ä¸å¹¸çš„å¾ˆå¤šæ—¶å€™å¹¶éå¦‚æ­¤ã€‚NPM çš„è¿™ç§ç­–ç•¥å¯èƒ½å¯¼è‡´ä¸¤å°æ‹¥æœ‰ç›¸åŒ package.json æ–‡ä»¶çš„ç”µè„‘å®‰è£…äº†ä¸åŒç‰ˆæœ¬çš„åŒ…ï¼Œè¿™å¯èƒ½å¯¼è‡´ä¸€äº›é”™è¯¯ã€‚å¾ˆå¤šæ¨¡å—çš„å®‰è£…é”™è¯¯å’Œç¯å¢ƒé—®é¢˜éƒ½æ˜¯ç”±äºè¿™ä¸ªåŸå› å¯¼è‡´ã€‚</p><p>ä¸ºäº†é¿å…åŒ…ç‰ˆæœ¬çš„é”™è¯¯åŒ¹é…ï¼Œä¸€ä¸ªç¡®å®šçš„å®‰è£…ç‰ˆæœ¬è¢«å›ºå®šåœ¨ä¸€ä¸ªé”æ–‡ä»¶ä¸­ã€‚æ¯æ¬¡æ¨¡å—è¢«æ·»åŠ æ—¶ï¼ŒYarn å°±ä¼šåˆ›å»ºï¼ˆæˆ–æ›´æ–°ï¼‰ yarn.lock æ–‡ä»¶ï¼Œè¿™æ ·ä½ å°±å¯ä»¥ä¿è¯å…¶å®ƒç”µè„‘ä¹Ÿå®‰è£…ç›¸åŒç‰ˆæœ¬çš„åŒ…ï¼ŒåŒæ—¶åŒ…å«äº† package.json ä¸­å®šä¹‰çš„ä¸€ç³»åˆ—å…è®¸çš„ç‰ˆæœ¬ã€‚</p><p>åœ¨ npm ä¸­åŒæ ·å¯ä»¥ä½¿ç”¨ <a href="https://docs.npmjs.com/cli/shrinkwrap" target="_blank" rel="noopener">npm shrinkwrap</a> å‘½ä»¤æ¥ç”Ÿæˆä¸€ä¸ªé”æ–‡ä»¶ï¼Œè¿™æ ·åœ¨ä½¿ç”¨ npm install æ—¶ä¼šåœ¨è¯»å– package.json å‰å…ˆè¯»å–è¿™ä¸ªæ–‡ä»¶ï¼Œå°±åƒ Yarn ä¼šå…ˆè¯»å– yarn.lock ä¸€æ ·ã€‚è¿™é‡Œçš„åŒºåˆ«æ˜¯ Yarn æ€»ä¼šè‡ªåŠ¨æ›´æ–° yarn.lockï¼Œè€Œ npm éœ€è¦ä½ é‡æ–°æ“ä½œã€‚</p><h2><a href="https://yarnpkg.com/en/docs/cli/install" target="_blank" rel="noopener">yarn install</a></h2><p>npm install å‘½ä»¤ä¼šæ ¹æ® package.json å®‰è£…ä¾èµ–ä»¥åŠå…è®¸ä½ æ·»åŠ æ–°çš„æ¨¡å—ï¼› yarn install ä»…ä¼šæŒ‰ç…§ yarn.lock æˆ– package.json é‡Œé¢çš„ä¾èµ–é¡ºåºæ¥å®‰è£…æ¨¡å—ã€‚</p><h2><a href="https://yarnpkg.com/en/docs/cli/add" target="_blank" rel="noopener">yarn add [â€“dev]</a></h2><p>ä¸ npm install ç±»ä¼¼ï¼Œyarn add å…è®¸ä½ æ·»åŠ ä¸å®‰è£…æ¨¡å—ï¼Œæ·»åŠ ä¾èµ–çš„åŒæ—¶ä¹Ÿä¼šå°†ä¾èµ–å†™å…¥ package.jsonï¼Œç±»ä¼¼ npm çš„ --save å‚æ•°ï¼›Yarn çš„ --dev å‚æ•°åˆ™æ˜¯æ·»åŠ å¼€å‘ä¾èµ–ï¼Œç±»ä¼¼ npm çš„ --save-dev å‚æ•°ã€‚</p><h2><a href="https://yarnpkg.com/en/docs/cli/global" target="_blank" rel="noopener">yarn global</a></h2><p>ä¸åƒ npm æ·»åŠ  -g æˆ– --global å¯ä»¥è¿›è¡Œå…¨å±€å®‰è£…ï¼ŒYarn ä½¿ç”¨çš„æ˜¯ global å‰ç¼€ï¼ˆyarn global add xxxï¼‰ã€‚global å‰ç¼€åªèƒ½ç”¨äº yarn add, yarn bin, yarn ls å’Œ yarn removeã€‚</p><h2><a href="https://yarnpkg.com/en/docs/cli/why" target="_blank" rel="noopener">yarn why</a></h2><p>è¯¥å‘½ä»¤ä¼šæŸ¥æ‰¾ä¾èµ–å…³ç³»å¹¶æ‰¾å‡ºä¸ºä»€ä¹ˆä¼šå°†æŸäº›åŒ…å®‰è£…åœ¨ä½ çš„é¡¹ç›®ä¸­ã€‚ä¹Ÿè®¸ä½ çŸ¥é“ä¸ºä»€ä¹ˆæ·»åŠ ï¼Œä¹Ÿè®¸å®ƒåªæ˜¯ä½ å®‰è£…åŒ…ä¸­çš„ä¸€ä¸ªä¾èµ–ï¼Œyarn why å¯ä»¥å¸®ä½ æ‰¾å‡ºã€‚<br><img src="/assets/img/yarn_why.png" alt="yarn_why"></p><h1>æ€»ç»“</h1><p>ç›¸æ¯” NPMï¼ŒYarn å¯ä»¥æ–¹ä¾¿ç”Ÿæˆé”æ–‡ä»¶ï¼Œå®‰è£…æ¨¡å—æ—¶éå¸¸è¿…é€Ÿå¹¶ä¸”ä¼šå°†ä¾èµ–è‡ªåŠ¨æ·»åŠ è¿› package.jsonï¼Œæ¨¡å—å¯ä»¥å¹¶è¡Œå®‰è£…ã€‚ä¸è¿‡ä¸ªäººè®¤ä¸ºï¼ŒYarn çš„ä¼˜åŠ¿ä¸æ˜¯ç»å¯¹çš„ï¼Œæ¯•ç«Ÿ NPM ä¹…ç»è€ƒéªŒï¼Œæˆ–è®¸ä¸ä¹…çš„å°†æ¥ï¼ŒNPM ä¹Ÿä¼šæ‹¥æœ‰è¿™äº›ç‰¹æ€§ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;&lt;a href=&quot;https://yarnpkg.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Yarn&lt;/a&gt; ç®€ä»‹&lt;/h1&gt;
&lt;p&gt;Yarn æ˜¯ Facebook å¼€å‘çš„ä¸€æ¬¾æ–°çš„ JavaScript åŒ…ç®¡ç†å·¥å…·ï¼Œ ä½œä¸º NPM çš„æ›¿ä»£äº§å“ï¼Œä¸»è¦æ˜¯ä¸ºäº†è§£å†³ä¸‹é¢ä¸¤ä¸ªé—®é¢˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å®‰è£…çš„æ—¶å€™æ— æ³•ä¿è¯é€Ÿåº¦/ä¸€è‡´æ€§&lt;/li&gt;
&lt;li&gt;å®‰å…¨é—®é¢˜ï¼Œå› ä¸º NPM å®‰è£…æ—¶å…è®¸è¿è¡Œä»£ç &lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="Node" scheme="https://lz5z.com/tags/Node/"/>
    
      <category term="JavaScript" scheme="https://lz5z.com/tags/JavaScript/"/>
    
      <category term="Yarn" scheme="https://lz5z.com/tags/Yarn/"/>
    
  </entry>
  
  <entry>
    <title>Gulp å¿«é€Ÿå…¥é—¨</title>
    <link href="https://lz5z.com/Gulp%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/"/>
    <id>https://lz5z.com/Gulpå¿«é€Ÿå…¥é—¨/</id>
    <published>2017-01-18T16:09:35.000Z</published>
    <updated>2020-04-21T10:23:54.823Z</updated>
    
    <content type="html"><![CDATA[<img src="/assets/img/è‡ªåŠ¨åŒ–.jpg" alt="è‡ªåŠ¨åŒ–">[å›¾ç‰‡æ‘˜è‡ªã€Œç¨‹åºå‘˜çš„é‚£äº›äº‹ã€]<h2>ä»€ä¹ˆæ˜¯ gulp</h2><p>ç®€å•çš„è®²ï¼Œgulp æ˜¯ä¸€ä¸ªæ„å»ºå·¥å…·ï¼Œä¸€ä¸ªåŸºäºæµçš„æ„å»ºå·¥å…·ï¼Œä¸€ä¸ª nodejs å†™çš„æ„å»ºå·¥å…·ï¼Œä½¿ç”¨ gulp çš„ç›®çš„å°±æ˜¯ä¸ºäº†è‡ªåŠ¨åŒ–æ„å»ºï¼Œæé«˜ç¨‹åºå‘˜å·¥ä½œæ•ˆç‡ğŸ˜‚ã€‚</p><a id="more"></a><h2>å…¥é—¨æŒ‡å—</h2><ol><li>å…¨å±€å®‰è£… gulpï¼š</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npm install --global gulp</span></span><br></pre></td></tr></table></figure><ol start="2"><li>ä½œä¸ºé¡¹ç›®çš„å¼€å‘ä¾èµ–ï¼ˆdevDependenciesï¼‰å®‰è£…ï¼š</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npm install --save-dev gulp</span></span><br></pre></td></tr></table></figure><ol start="3"><li>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º gulpfile.js çš„æ–‡ä»¶ï¼š</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</span><br><span class="line"><span class="comment">// é»˜è®¤task</span></span><br><span class="line">gulp.task(<span class="string">'default'</span>, () =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'Hello World'</span>)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ol start="4"><li>è¿è¡Œ gulpï¼š</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> gulp</span></span><br></pre></td></tr></table></figure><p>é»˜è®¤çš„åä¸º default çš„ä»»åŠ¡ï¼ˆtaskï¼‰å°†ä¼šè¢«è¿è¡Œã€‚</p><p>æƒ³è¦å•ç‹¬æ‰§è¡Œç‰¹å®šçš„ä»»åŠ¡ï¼ˆtaskï¼‰ï¼Œè¯·è¾“å…¥</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> gulp &lt;task&gt; &lt;othertask&gt;ã€‚</span></span><br></pre></td></tr></table></figure><h2>tasks ä¾èµ–</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</span><br><span class="line"><span class="comment">// task1</span></span><br><span class="line">gulp.task(<span class="string">'task1'</span>, () =&gt; &#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'task1'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// task2</span></span><br><span class="line">gulp.task(<span class="string">'task2'</span>, () =&gt; &#123;</span><br><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'task2'</span>)</span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// åœ¨æ‰§è¡Œ default ä¹‹å‰å…ˆæ‰§è¡Œ task1 å’Œ task2</span></span><br><span class="line">gulp.task(<span class="string">'default'</span>, [<span class="string">'task1'</span>, <span class="string">'task2'</span>], () =&gt; &#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'Hello World'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¾“å‡ºé¡ºåºä¸ºï¼š</p><blockquote><p>task1<br>Hello World<br>task2</p></blockquote><h2>æµå¼å¤„ç†</h2><p>(1) åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»º src æ–‡ä»¶ç›®å½•ï¼Œé‡Œé¢åˆ›å»º index.js<br>(2) åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»º dist æ–‡ä»¶ç›®å½•<br>(3) å®‰è£… gulp-uglify</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npm install gulp-uglify --save-dev</span></span><br></pre></td></tr></table></figure><p>(4) ä½¿ç”¨ gulp å‹ç¼© index.js å¹¶å°†ç»“æœè¾“å‡º</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</span><br><span class="line"><span class="keyword">var</span> uglify = <span class="built_in">require</span>(<span class="string">'gulp-uglify'</span>);</span><br><span class="line"><span class="comment">// å‹ç¼©js</span></span><br><span class="line">gulp.task(<span class="string">'default'</span>, () =&gt; &#123;</span><br><span class="line">gulp.src(<span class="string">'src/*.js'</span>)</span><br><span class="line">.pipe(uglify())</span><br><span class="line">.pipe(gulp.dest(<span class="string">'dist'</span>))</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>(5) è¿è¡Œ â€œgulpâ€ å‘½ä»¤åå‘ç°åœ¨ dist ç›®å½•ä¸‹ç”Ÿäº§äº†å‹ç¼©åçš„ index.js</p><p>(6) è§£é‡Š</p><p>gulp.src æ˜¯è¾“å…¥ï¼› gulp.dest æ˜¯è¾“å‡º<br>pipe æ˜¯ç®¡é“çš„æ„æ€ï¼Œä¹Ÿæ˜¯ stream é‡Œæ ¸å¿ƒæ¦‚å¿µï¼Œpipe å°†ä¸Šä¸€ä¸ªçš„è¾“å‡ºä½œä¸ºä¸‹ä¸€ä¸ªçš„è¾“å…¥ã€‚src é‡Œæ‰€æœ‰ jsï¼Œç»è¿‡å¤„ç†1ï¼Œå¤„ç†2ï¼Œå˜æˆè¾“å‡ºç»“æœï¼Œä¸­é—´çš„å¤„ç† pipe å¯ä»¥1æ­¥ï¼Œä¹Ÿå¯ä»¥æ˜¯næ­¥ã€‚ç¬¬ä¸€æ­¥å¤„ç†çš„ç»“æœæ˜¯ç¬¬äºŒæ­¥çš„è¾“å…¥ï¼Œä»¥æ­¤ç±»æ¨ï¼Œå°±åƒç”Ÿäº§çº¿ä¸€æ ·ï¼Œæ¯ä¸€æ­¥éƒ½æ˜¯ä¸€ä¸ª task æ˜¯ä¸æ˜¯å¾ˆå¥½ç†è§£å‘¢ï¼Ÿ</p><p>æ¯ä¸ªç‹¬ç«‹æ“ä½œå•å…ƒéƒ½æ˜¯ä¸€ä¸ª taskï¼Œä½¿ç”¨ pipe æ¥ç»„è£… tasksï¼Œäºæ˜¯ gulp å°±å˜æˆäº†åŸºäº task çš„ç»„è£…å·¥å…·ã€‚</p><h2>gulp.src()</h2><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œgulp.src() å‡½æ•°ç”¨å­—ç¬¦ä¸²åŒ¹é…ä¸€ä¸ªæ–‡ä»¶æˆ–è€…æ–‡ä»¶çš„ç¼–å·ï¼ˆè¢«ç§°ä¸ºâ€œglobâ€ï¼‰,ç„¶ååˆ›å»ºä¸€ä¸ªå¯¹è±¡æµæ¥ä»£è¡¨è¿™äº›æ–‡ä»¶ï¼Œæ¥ç€ä¼ é€’ç»™ uglify() å‡½æ•°ï¼Œå®ƒæ¥å—æ–‡ä»¶å¯¹è±¡ä¹‹åè¿”å›æœ‰æ–°å‹ç¼©æºæ–‡ä»¶çš„æ–‡ä»¶å¯¹è±¡ï¼Œæœ€åé‚£äº›è¾“å‡ºçš„æ–‡ä»¶è¢«è¾“å…¥ gulp.dest()å‡½æ•°ï¼Œå¹¶ä¿å­˜ä¸‹æ¥ã€‚</p><p>gulp.src() å¯ä»¥æ¥æ”¶ä»¥ä¸‹ç±»å‹çš„å‚æ•°ï¼š</p><blockquote><p>js/app.js ç²¾ç¡®åŒ¹é…æ–‡ä»¶<br>js/<em>.js ä»…åŒ¹é… js ç›®å½•ä¸‹çš„æ‰€æœ‰åç¼€ä¸º .js çš„æ–‡ä»¶<br>js/</em>/.js åŒ¹é… js ç›®å½•åŠå…¶å­ç›®å½•ä¸‹æ‰€æœ‰åç¼€ä¸º .js çš„æ–‡ä»¶<br>!js/app.js ä»åŒ¹é…ç»“æœä¸­æ’é™¤ js/app.jsï¼Œè¿™ç§æ–¹æ³•åœ¨ä½ æƒ³è¦åŒ¹é…é™¤äº†ç‰¹æ®Šæ–‡ä»¶ä¹‹å¤–çš„æ‰€æœ‰æ–‡ä»¶æ—¶éå¸¸å¥½ç”¨<br>*.+(js|css) åŒ¹é…æ ¹ç›®å½•ä¸‹æ‰€æœ‰åç¼€ä¸º .js æˆ–è€… .css çš„æ–‡ä»¶</p></blockquote><p>å‡å¦‚ js ç›®å½•ä¸‹åŒ…å«äº†å‹ç¼©å’Œæœªå‹ç¼©çš„ JavaScript æ–‡ä»¶ï¼Œç°åœ¨æˆ‘ä»¬æƒ³è¦åˆ›å»ºä¸€ä¸ªä»»åŠ¡æ¥å‹ç¼©è¿˜æ²¡æœ‰è¢«å‹ç¼©çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦å…ˆåŒ¹é…ç›®å½•ä¸‹æ‰€æœ‰çš„ JavaScript æ–‡ä»¶ï¼Œç„¶åæ’é™¤åç¼€ä¸º .min.js çš„æ–‡ä»¶:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gulp.src([<span class="string">'js/**/*.js'</span>, <span class="string">'!js/**/*.min.js'</span>])</span><br></pre></td></tr></table></figure><h2>babel</h2><p>babel ç”¨äºè½¬åŒ– JavaScript ä»£ç ï¼Œæ¯”å¦‚å°† ES6 çš„è¯­æ³•è½¬åŒ–æˆ ES5ï¼Œæˆ–è€…å°† JSX è¯­æ³•è½¬åŒ–ä¸º JavaScript è¯­æ³•ã€‚</p><p>å‡å¦‚ä¸Šæ–‡ä¸­æåˆ°çš„ index.js é‡Œé¢çš„å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">'use strict'</span>;</span><br><span class="line"><span class="keyword">import</span> express, &#123; Router &#125; <span class="keyword">from</span> <span class="string">'express'</span>;</span><br><span class="line"><span class="keyword">import</span> bodyParser <span class="keyword">from</span> <span class="string">'body-parser'</span>;</span><br><span class="line"><span class="comment">// å®šä¹‰appå’Œrouter</span></span><br><span class="line"><span class="keyword">let</span> app = express();</span><br><span class="line"><span class="keyword">let</span> router = Router();</span><br><span class="line"><span class="comment">//ä¸­é—´ä»¶</span></span><br><span class="line">app.use(bodyParser.json());</span><br><span class="line">app.use(bodyParser.urlencoded(&#123; <span class="attr">extended</span>: <span class="literal">true</span> &#125;));</span><br><span class="line"><span class="comment">//è·¯ç”±</span></span><br><span class="line">router.get(<span class="string">'/'</span>, (req, res, next) =&gt; &#123;</span><br><span class="line">  res.end(<span class="string">'Hello World!'</span>);</span><br><span class="line">&#125;);</span><br><span class="line">app.use(<span class="string">'/'</span>, router);</span><br><span class="line"><span class="comment">//å¯åŠ¨app</span></span><br><span class="line">app.listen(<span class="number">3000</span>, () =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'server listening at port 3000...'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ babel è½¬åŒ–ä¸º ES5 è¯­æ³•ï¼š</p><p>(1) å®‰è£… babel-core babel-preset-es2015</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npm install --save-dev babel-core babel-preset-es2015</span></span><br></pre></td></tr></table></figure><p>(2) åˆ›å»º <strong>.babelrc</strong> æ–‡ä»¶ï¼Œ é…ç½®å¦‚ä¸‹</p><blockquote><p>{<br>â€œpresetsâ€: [â€œes2015â€]<br>}</p></blockquote><p>(3) æ‰‹åŠ¨ä½¿ç”¨ babel è½¬è¯‘ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> babel src -d lib</span></span><br></pre></td></tr></table></figure><p>(4) å®‰è£… gulp-babel</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">  npm install --save-dev gulp-babel</span></span><br></pre></td></tr></table></figure><p>(5) ç¼–å†™ gulpfile</p><p>åœ¨æ ¹ç›®å½•æ–°å»ºä¸€ä¸ª gulpfile.babel.js æ–‡ä»¶ã€‚<br>gulp åŸç”Ÿå¹¶ä¸æ”¯æŒ ES6 è¯­æ³•ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å‘Šè¯‰ gulp ä½¿ç”¨ babel å°† gulpfile è½¬æ¢ä¸º ES5ï¼Œæ–¹æ³•å°±æ˜¯å°† gulpfile å‘½åä¸º <strong>gulpfile.babel.js</strong>ã€‚</p><p>(6) ä½¿ç”¨ ES6 ç¼–å†™ <strong>gulpfile.babel.js</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gulp <span class="keyword">from</span> <span class="string">'gulp'</span>;</span><br><span class="line"><span class="keyword">import</span> babel <span class="keyword">from</span> <span class="string">'gulp-babel'</span>;</span><br><span class="line"><span class="comment">// è¯­æ³•è½¬åŒ–+å‹ç¼©</span></span><br><span class="line">gulp.task(<span class="string">'default'</span>, () =&gt; &#123;</span><br><span class="line">gulp.src(<span class="string">'src/*.js'</span>)</span><br><span class="line">.pipe(babel())</span><br><span class="line">.pipe(gulp.dest(<span class="string">'lib'</span>))</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>æ‰“å¼€ lib ç›®å½•ä¸‹çš„ index.js æ–‡ä»¶ï¼Œå°±å¯ä»¥æŸ¥çœ‹ babel ç¼–è¯‘åçš„ ES5 è¯­æ³•çš„æ–‡ä»¶äº†ã€‚</p><h2>gulp-watch</h2><p>å¼€å§‹å·¥ä½œä»¥åï¼Œæ¯æ¬¡æ”¹åŠ¨ index.js éƒ½è¦æ‰‹åŠ¨ gulp ä¸€ä¸‹å®åœ¨å¤ªéº»çƒ¦äº†ï¼Œä½¿ç”¨ gulp-watch å¯ä»¥ç›‘å¬æ–‡ä»¶å˜åŒ–ï¼Œå½“æ–‡ä»¶è¢«ä¿®æ”¹ä¹‹åï¼Œè‡ªåŠ¨å°†æ–‡ä»¶è½¬æ¢ã€‚</p><p>(1) å®‰è£… gulp-watch</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npm install gulp-watch --save-dev</span></span><br></pre></td></tr></table></figure><p>(2) æ–°å¢ task</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">gulp.task(<span class="string">'watch'</span>, () =&gt; &#123;</span><br><span class="line">gulp.src(<span class="string">'src/*.js'</span>)</span><br><span class="line">.pipe(watch(<span class="string">'src/*.js'</span>), &#123;</span><br><span class="line">verbose: <span class="literal">true</span></span><br><span class="line">&#125;)</span><br><span class="line">.pipe(babel())</span><br><span class="line">.pipe(gulp.dest(<span class="string">'lib'</span>))</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>(3) å¯åŠ¨ watch task</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> gulp watch</span></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ index.js å lib/index.js ä¹Ÿä¼šéšä¹‹æ”¹å˜ã€‚(â‰§âˆ€â‰¦)ã‚</p><h2>æŸ¥çœ‹å…¨éƒ¨ tasks</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> gulp -T</span></span><br><span class="line">[16:06:54] Requiring external module babel-register</span><br><span class="line">[16:06:54] â”œâ”€â”€ default</span><br><span class="line">[16:06:54] â””â”€â”€ watch</span><br></pre></td></tr></table></figure><h2>gulp é¡ºåºæ‰§è¡Œ</h2><p>é»˜è®¤çš„ï¼Œtask å°†ä»¥æœ€å¤§çš„å¹¶å‘æ•°æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œgulp ä¼šä¸€æ¬¡æ€§è¿è¡Œæ‰€æœ‰çš„ task å¹¶ä¸”ä¸åšä»»ä½•ç­‰å¾…ã€‚å¦‚æœä½ æƒ³è¦åˆ›å»ºä¸€ä¸ªåºåˆ—åŒ–çš„ task é˜Ÿåˆ—ï¼Œå¹¶ä»¥ç‰¹å®šçš„é¡ºåºæ‰§è¡Œï¼Œéœ€è¦åšä¸¤ä»¶äº‹ï¼š</p><ol><li>ç»™å‡ºä¸€ä¸ªæç¤ºï¼Œæ¥å‘ŠçŸ¥ task ä»€ä¹ˆæ—¶å€™æ‰§è¡Œå®Œæ¯•ï¼Œ</li><li>å¹¶ä¸”å†ç»™å‡ºä¸€ä¸ªæç¤ºï¼Œæ¥å‘ŠçŸ¥ä¸€ä¸ª task ä¾èµ–å¦ä¸€ä¸ª task çš„å®Œæˆã€‚</li></ol><p>å‡å¦‚æˆ‘æƒ³è¦ task1 æ‰§è¡Œå®Œæˆåå†æ‰§è¡Œ task2ï¼Œ å¯ä»¥ç”¨ä»¥ä¸‹ä¸‰ç§æ–¹å¼ï¼š</p><h3>ç›´æ¥è¿”å›ä¸€ä¸ªæµ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gulp.task(<span class="string">'task1'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.watch(<span class="string">'src/*.js'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//åªè¦åŠ ä¸€ä¸ªreturnå°±å¥½äº†</span></span><br></pre></td></tr></table></figure><h3>è¿”å›ä¸€ä¸ªpromise</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">gulp.task(<span class="string">'task1'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> Q = <span class="built_in">require</span>(<span class="string">'q'</span>);</span><br><span class="line">  <span class="keyword">var</span> deferred = Q.defer();</span><br><span class="line">  <span class="comment">// do async stuff</span></span><br><span class="line">  setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    deferred.resolve();</span><br><span class="line">  &#125;, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> deferred.promise;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3>ä½¿ç”¨å›è°ƒcallback</h3><p>task çš„æ‰§è¡Œå‡½æ•°å…¶å®éƒ½æœ‰ä¸ªå›è°ƒï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨å¼‚æ­¥é˜Ÿåˆ—å®Œæˆçš„æ—¶å€™è°ƒç”¨å®ƒå°±å¥½äº†ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">gulp.task(<span class="string">'task1'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">cb</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// do async stuff</span></span><br><span class="line">  setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    cb()</span><br><span class="line">  &#125;, <span class="number">1</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥åªè¦ä¾èµ–çš„ä»»åŠ¡æ˜¯ä¸Šé¢ä¸‰ç§æƒ…å†µä¹‹ä¸€ï¼Œå°±èƒ½ä¿è¯å½“å‰ä»»åŠ¡åœ¨ä¾èµ–ä»»åŠ¡æ‰§è¡Œå®Œæˆåå†æ‰§è¡Œã€‚è¿™è¾¹éœ€è¦æ³¨æ„çš„æ˜¯ä¾èµ–çš„ä»»åŠ¡ç›¸äº’ä¹‹é—´è¿˜æ˜¯å¹¶è¡Œçš„ã€‚éœ€è¦ä»–ä»¬æŒ‰é¡ºåºçš„è¯ã€‚è®°å¾—ç»™æ¯ä¸ªä¾èµ–çš„ä»»åŠ¡ä¹Ÿé…ç½®å¥½ä¾èµ–å…³ç³»ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</span><br><span class="line">gulp.task(<span class="string">'one'</span>, () =&gt; &#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'one'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// two ä¾èµ– one</span></span><br><span class="line">gulp.task(<span class="string">'two'</span>, [<span class="string">'one'</span>], () =&gt; &#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'two'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// default ä¾èµ– oneï¼Œtwo</span></span><br><span class="line">gulp.task(<span class="string">'default'</span>, [<span class="string">'one'</span>, <span class="string">'two'</span>], () =&gt; &#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'default'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;img src=&quot;/assets/img/è‡ªåŠ¨åŒ–.jpg&quot; alt=&quot;è‡ªåŠ¨åŒ–&quot;&gt;
[å›¾ç‰‡æ‘˜è‡ªã€Œç¨‹åºå‘˜çš„é‚£äº›äº‹ã€]
&lt;h2&gt;ä»€ä¹ˆæ˜¯ gulp&lt;/h2&gt;
&lt;p&gt;ç®€å•çš„è®²ï¼Œgulp æ˜¯ä¸€ä¸ªæ„å»ºå·¥å…·ï¼Œä¸€ä¸ªåŸºäºæµçš„æ„å»ºå·¥å…·ï¼Œä¸€ä¸ª nodejs å†™çš„æ„å»ºå·¥å…·ï¼Œä½¿ç”¨ gulp çš„ç›®çš„å°±æ˜¯ä¸ºäº†è‡ªåŠ¨åŒ–æ„å»ºï¼Œæé«˜ç¨‹åºå‘˜å·¥ä½œæ•ˆç‡ğŸ˜‚ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="https://lz5z.com/tags/JavaScript/"/>
    
      <category term="Gulp" scheme="https://lz5z.com/tags/Gulp/"/>
    
      <category term="Babel" scheme="https://lz5z.com/tags/Babel/"/>
    
      <category term="streaming" scheme="https://lz5z.com/tags/streaming/"/>
    
  </entry>
  
  <entry>
    <title>æœºå™¨å­¦ä¹ å¸¸ç”¨ç®—æ³•â€”â€”éšæœºæ£®æ—</title>
    <link href="https://lz5z.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%B8%B8%E7%94%A8%E7%AE%97%E6%B3%95%E2%80%94%E9%9A%8F%E6%9C%BA%E6%A3%AE%E6%9E%97/"/>
    <id>https://lz5z.com/æœºå™¨å­¦ä¹ å¸¸ç”¨ç®—æ³•â€”éšæœºæ£®æ—/</id>
    <published>2017-01-10T21:27:24.000Z</published>
    <updated>2020-04-21T10:23:54.831Z</updated>
    
    <content type="html"><![CDATA[<h1>éšæœºæ£®æ—</h1><p>éšæœºæ£®æ—ï¼ˆRandom Forestï¼Œç®€ç§°RFï¼‰ï¼Œé€šè¿‡é›†æˆå­¦ä¹ çš„æ€æƒ³å°†å¤šæ£µå†³ç­–æ ‘é›†æˆçš„ä¸€ç§ç®—æ³•ï¼Œå®ƒçš„åŸºæœ¬å•å…ƒæ˜¯<a href="https://lz5z.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%B8%B8%E7%94%A8%E7%AE%97%E6%B3%95%E2%80%94%E5%86%B3%E7%AD%96%E6%A0%91/">å†³ç­–æ ‘</a>ã€‚ä»ç›´è§‚è§’åº¦æ¥è§£é‡Šï¼Œæ¯æ£µå†³ç­–æ ‘éƒ½æ˜¯ä¸€ä¸ªåˆ†ç±»å™¨ï¼ˆå‡è®¾ç°åœ¨é’ˆå¯¹çš„æ˜¯åˆ†ç±»é—®é¢˜ï¼‰ï¼Œé‚£ä¹ˆå¯¹äºä¸€ä¸ªè¾“å…¥æ ·æœ¬ï¼ŒNæ£µæ ‘ä¼šæœ‰Nä¸ªåˆ†ç±»ç»“æœã€‚è€Œéšæœºæ£®æ—é›†æˆäº†æ‰€æœ‰çš„åˆ†ç±»æŠ•ç¥¨ç»“æœï¼Œå°†æŠ•ç¥¨æ¬¡æ•°æœ€å¤šçš„ç±»åˆ«æŒ‡å®šä¸ºæœ€ç»ˆçš„è¾“å‡ºã€‚</p><img src="/assets/img/randforest.png" alt="éšæœºæ£®æ—"><a id="more"></a><h2>éšæœºæ£®æ—æ„å»º</h2><h3>éšæœºé‡‡æ ·</h3><p>é¦–å…ˆæ˜¯ä¸¤ä¸ªéšæœºé‡‡æ ·çš„è¿‡ç¨‹ï¼Œrandom forest å¯¹è¾“å…¥çš„æ•°æ®è¦è¿›è¡Œè¡Œã€åˆ—çš„é‡‡æ ·ã€‚</p><p>å¯¹äºè¡Œé‡‡æ ·ï¼Œé‡‡ç”¨æœ‰æ”¾å›çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯åœ¨é‡‡æ ·å¾—åˆ°çš„æ ·æœ¬é›†åˆä¸­ï¼Œå¯èƒ½æœ‰é‡å¤çš„æ ·æœ¬ã€‚å‡è®¾è¾“å…¥æ ·æœ¬ä¸º N ä¸ªï¼Œé‚£ä¹ˆé‡‡æ ·çš„æ ·æœ¬ä¹Ÿä¸º N ä¸ªï¼Œè¿™é€‰æ‹©å¥½äº†çš„ N ä¸ªæ ·æœ¬ç”¨æ¥è®­ç»ƒä¸€ä¸ªå†³ç­–æ ‘ï¼Œä½œä¸ºå†³ç­–æ ‘æ ¹èŠ‚ç‚¹å¤„çš„æ ·æœ¬ï¼ŒåŒæ—¶ä½¿å¾—åœ¨è®­ç»ƒçš„æ—¶å€™ï¼Œæ¯ä¸€æ£µæ ‘çš„è¾“å…¥æ ·æœ¬éƒ½ä¸æ˜¯å…¨éƒ¨çš„æ ·æœ¬ï¼Œä½¿å¾—ç›¸å¯¹ä¸å®¹æ˜“å‡ºç° over-fittingã€‚</p><p>å¯¹äºåˆ—é‡‡æ ·ï¼Œä» M ä¸ª feature ä¸­ï¼Œé€‰æ‹© m ä¸ª (m &lt;&lt; M)ï¼Œå³ï¼šå½“æ¯ä¸ªæ ·æœ¬æœ‰Mä¸ªå±æ€§æ—¶ï¼Œåœ¨å†³ç­–æ ‘çš„æ¯ä¸ªèŠ‚ç‚¹éœ€è¦åˆ†è£‚æ—¶ï¼Œéšæœºä»è¿™ M ä¸ªå±æ€§ä¸­é€‰å–å‡º m ä¸ªå±æ€§ï¼Œæ»¡è¶³æ¡ä»¶ m &lt;&lt; Mã€‚</p><h3>å®Œå…¨åˆ†è£‚</h3><p>å¯¹é‡‡æ ·ä¹‹åçš„æ•°æ®ä½¿ç”¨å®Œå…¨åˆ†è£‚çš„æ–¹å¼å»ºç«‹å‡ºå†³ç­–æ ‘ï¼Œè¿™æ ·å†³ç­–æ ‘çš„æŸä¸€ä¸ªå¶å­èŠ‚ç‚¹è¦ä¹ˆæ˜¯æ— æ³•ç»§ç»­åˆ†è£‚çš„ï¼Œè¦ä¹ˆé‡Œé¢çš„æ‰€æœ‰æ ·æœ¬çš„éƒ½æ˜¯æŒ‡å‘çš„åŒä¸€ä¸ªåˆ†ç±»ã€‚åˆ†è£‚çš„åŠæ³•æ˜¯ï¼šé‡‡ç”¨ä¸Šé¢è¯´çš„åˆ—é‡‡æ ·çš„è¿‡ç¨‹ä»è¿™mä¸ªå±æ€§ä¸­é‡‡ç”¨æŸç§ç­–ç•¥ï¼ˆæ¯”å¦‚è¯´ä¿¡æ¯å¢ç›Šï¼‰æ¥é€‰æ‹©1ä¸ªå±æ€§ä½œä¸ºè¯¥èŠ‚ç‚¹çš„åˆ†è£‚å±æ€§ã€‚</p><p>å†³ç­–æ ‘å½¢æˆè¿‡ç¨‹ä¸­æ¯ä¸ªèŠ‚ç‚¹éƒ½è¦æŒ‰å®Œå…¨åˆ†è£‚çš„æ–¹å¼æ¥åˆ†è£‚ï¼Œä¸€ç›´åˆ°ä¸èƒ½å¤Ÿå†åˆ†è£‚ä¸ºæ­¢ï¼ˆå¦‚æœä¸‹ä¸€æ¬¡è¯¥èŠ‚ç‚¹é€‰å‡ºæ¥çš„é‚£ä¸€ä¸ªå±æ€§æ˜¯åˆšåˆšå…¶çˆ¶èŠ‚ç‚¹åˆ†è£‚æ—¶ç”¨è¿‡çš„å±æ€§ï¼Œåˆ™è¯¥èŠ‚ç‚¹å·²ç»è¾¾åˆ°äº†å¶å­èŠ‚ç‚¹ï¼Œæ— é¡»ç»§ç»­åˆ†è£‚äº†ï¼‰ã€‚</p><h2>éšæœºæ£®æ—çš„ä¼˜ç‚¹</h2><ol><li>æ¯”è¾ƒé€‚åˆåšå¤šåˆ†ç±»é—®é¢˜ï¼Œè®­ç»ƒå’Œé¢„æµ‹é€Ÿåº¦å¿«ï¼Œåœ¨æ•°æ®é›†ä¸Šè¡¨ç°è‰¯å¥½ï¼›</li><li>å¯¹è®­ç»ƒæ•°æ®çš„å®¹é”™èƒ½åŠ›å¼ºï¼Œæ˜¯ä¸€ç§æœ‰æ•ˆåœ°ä¼°è®¡ç¼ºå¤±æ•°æ®çš„ä¸€ç§æ–¹æ³•ï¼Œå½“æ•°æ®é›†ä¸­æœ‰å¤§æ¯”ä¾‹çš„æ•°æ®ç¼ºå¤±æ—¶ä»ç„¶å¯ä»¥ä¿æŒç²¾åº¦ä¸å˜å’Œèƒ½å¤Ÿæœ‰æ•ˆåœ°å¤„ç†å¤§çš„æ•°æ®é›†ï¼›</li><li>èƒ½å¤Ÿå¤„ç†å¾ˆé«˜ç»´åº¦çš„æ•°æ®ï¼Œå¹¶ä¸”ä¸ç”¨åšç‰¹å¾é€‰æ‹©ï¼Œå³ï¼šå¯ä»¥å¤„ç†æ²¡æœ‰åˆ å‡çš„æˆåƒä¸Šä¸‡çš„å˜é‡ï¼›</li><li>èƒ½å¤Ÿåœ¨åˆ†ç±»çš„è¿‡ç¨‹ä¸­å¯ä»¥ç”Ÿæˆä¸€ä¸ªæ³›åŒ–è¯¯å·®çš„å†…éƒ¨æ— åä¼°è®¡ï¼›</li><li>èƒ½å¤Ÿåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­æ£€æµ‹åˆ°ç‰¹å¾ä¹‹é—´çš„ç›¸äº’å½±å“ä»¥åŠç‰¹å¾çš„é‡è¦æ€§ç¨‹åº¦ï¼›</li><li>ä¸ä¼šå‡ºç°è¿‡åº¦æ‹Ÿåˆï¼›</li><li>å®ç°ç®€å•å¹¶ä¸”å®¹æ˜“å®ç°å¹¶è¡ŒåŒ–ã€‚</li></ol><h1>ä¾‹å­</h1><p>å‡è®¾æœ‰ä¸€ç»„ç›¸äº²ç½‘ç«™æä¾›çš„æ•°æ®ï¼ŒæŠ½å–ç‰¹å¾åå‘ç°æ˜¯å¦ç›¸äº²æœ‰å››ä¸ªå› ç´ ç»„æˆï¼š å¹´é¾„ï¼Œæ˜¯å¦æœ‰æˆ¿ï¼Œæ”¶å…¥ï¼Œæ˜¯å¦å…¬åŠ¡å‘˜</p><blockquote><p>age, house, income, governor, go_date<br>30, 1, 80, 1, 1<br>28, 0, 30, 0, 0<br>29, 0, 80, 1, 1<br>32, 1, 40, 1, 1<br>32, 0, 100, 1, 1<br>40, 1, 30, 1, 0<br>28, 1, 40, 1, 1<br>57, 0, 80, 1, 0<br>45, 0, 78, 0, 0<br>34, 0, 70, 1, 0<br>â€¦</p></blockquote><p>é‚£ä¹ˆå‡å¦‚æœ‰ä¸€ä¸ªæ–°çš„ä¼šå‘˜æ³¨å†Œåï¼Œå¡«å†™äº†ä¿¡æ¯å¦‚ä¸‹ï¼Œ</p><blockquote><p>å¹´é¾„ï¼š 33<br>æ˜¯å¦æœ‰æˆ¿ï¼š æ— <br>æ”¶å…¥ï¼š 80<br>æ˜¯å¦å…¬åŠ¡å‘˜ï¼š æ˜¯</p></blockquote><p>é‚£ä¹ˆè¯·é—®è¿™ä½ä¼šå‘˜æ˜¯å¦èƒ½å¾—åˆ°ç›¸äº²çš„æœºä¼šï¼Ÿ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> genfromtxt</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier</span><br><span class="line"><span class="comment"># åŠ è½½æ•°æ®</span></span><br><span class="line">dataset = genfromtxt(<span class="string">'data.csv'</span>, delimiter=<span class="string">","</span>)</span><br><span class="line">x = dataset[<span class="number">1</span>:, <span class="number">0</span>:<span class="number">4</span>]</span><br><span class="line">y = dataset[<span class="number">1</span>:, <span class="number">4</span>]</span><br><span class="line">clf = RandomForestClassifier(n_jobs=<span class="number">2</span>, oob_score=<span class="literal">True</span>)</span><br><span class="line">clf = clf.fit(x, y)</span><br><span class="line"><span class="comment"># é¢„æµ‹</span></span><br><span class="line">print(clf.predict_proba([[<span class="number">33</span>, <span class="number">0</span>, <span class="number">80</span>, <span class="number">1</span>]]))</span><br></pre></td></tr></table></figure><p><a href="https://github.com/Leo555/scikit-learn_demo/tree/master/06Random_Forest" target="_blank" rel="noopener">ä»£ç åœ°å€</a></p><h1>å‚è€ƒæ–‡çŒ®</h1><ul><li><a href="http://www.cnblogs.com/maybe2030/p/4585705.html" target="_blank" rel="noopener">[Machine Learning &amp; Algorithm] éšæœºæ£®æ—ï¼ˆRandom Forestï¼‰</a></li><li><a href="http://blog.csdn.net/u011301133/article/details/52562874" target="_blank" rel="noopener">sklearnä¸­éšæœºæ£®æ—çš„å‚æ•°</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;éšæœºæ£®æ—&lt;/h1&gt;
&lt;p&gt;éšæœºæ£®æ—ï¼ˆRandom Forestï¼Œç®€ç§°RFï¼‰ï¼Œé€šè¿‡é›†æˆå­¦ä¹ çš„æ€æƒ³å°†å¤šæ£µå†³ç­–æ ‘é›†æˆçš„ä¸€ç§ç®—æ³•ï¼Œå®ƒçš„åŸºæœ¬å•å…ƒæ˜¯&lt;a href=&quot;https://lz5z.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%B8%B8%E7%94%A8%E7%AE%97%E6%B3%95%E2%80%94%E5%86%B3%E7%AD%96%E6%A0%91/&quot;&gt;å†³ç­–æ ‘&lt;/a&gt;ã€‚ä»ç›´è§‚è§’åº¦æ¥è§£é‡Šï¼Œæ¯æ£µå†³ç­–æ ‘éƒ½æ˜¯ä¸€ä¸ªåˆ†ç±»å™¨ï¼ˆå‡è®¾ç°åœ¨é’ˆå¯¹çš„æ˜¯åˆ†ç±»é—®é¢˜ï¼‰ï¼Œé‚£ä¹ˆå¯¹äºä¸€ä¸ªè¾“å…¥æ ·æœ¬ï¼ŒNæ£µæ ‘ä¼šæœ‰Nä¸ªåˆ†ç±»ç»“æœã€‚è€Œéšæœºæ£®æ—é›†æˆäº†æ‰€æœ‰çš„åˆ†ç±»æŠ•ç¥¨ç»“æœï¼Œå°†æŠ•ç¥¨æ¬¡æ•°æœ€å¤šçš„ç±»åˆ«æŒ‡å®šä¸ºæœ€ç»ˆçš„è¾“å‡ºã€‚&lt;/p&gt;
&lt;img src=&quot;/assets/img/randforest.png&quot; alt=&quot;éšæœºæ£®æ—&quot;&gt;
    
    </summary>
    
      <category term="Machine Learning" scheme="https://lz5z.com/categories/Machine-Learning/"/>
    
    
      <category term="Python" scheme="https://lz5z.com/tags/Python/"/>
    
      <category term="Machine Learning" scheme="https://lz5z.com/tags/Machine-Learning/"/>
    
      <category term="scikit-learn" scheme="https://lz5z.com/tags/scikit-learn/"/>
    
  </entry>
  
  <entry>
    <title>æœºå™¨å­¦ä¹ å¸¸ç”¨ç®—æ³•â€”â€”å†³ç­–æ ‘</title>
    <link href="https://lz5z.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%B8%B8%E7%94%A8%E7%AE%97%E6%B3%95%E2%80%94%E5%86%B3%E7%AD%96%E6%A0%91/"/>
    <id>https://lz5z.com/æœºå™¨å­¦ä¹ å¸¸ç”¨ç®—æ³•â€”å†³ç­–æ ‘/</id>
    <published>2017-01-07T21:27:24.000Z</published>
    <updated>2020-04-21T10:23:54.831Z</updated>
    
    <content type="html"><![CDATA[<h1>å†³ç­–æ ‘</h1><p>å†³ç­–æ ‘æ˜¯ä¸€ä¸ªéå‚æ•°çš„ç›‘ç£å¼å­¦ä¹ æ–¹æ³•ï¼Œä¸»è¦ç”¨äºåˆ†ç±»å’Œå›å½’ï¼Œç®—æ³•çš„ç›®æ ‡æ˜¯é€šè¿‡æ¨æ–­æ•°æ®ç‰¹å¾ï¼Œå­¦ä¹ å†³ç­–è§„åˆ™ä»è€Œåˆ›å»ºä¸€ä¸ªé¢„æµ‹ç›®æ ‡å˜é‡çš„æ¨¡å‹ã€‚å†³ç­–æ ‘ï¼ˆdecision treeï¼‰æ˜¯ä¸€ä¸ªæ ‘ç»“æ„ï¼ˆå¯ä»¥æ˜¯äºŒå‰æ ‘æˆ–éäºŒå‰æ ‘ï¼‰ã€‚å…¶æ¯ä¸ªéå¶èŠ‚ç‚¹è¡¨ç¤ºä¸€ä¸ªç‰¹å¾å±æ€§ä¸Šçš„æµ‹è¯•ï¼Œæ¯ä¸ªåˆ†æ”¯ä»£è¡¨è¿™ä¸ªç‰¹å¾å±æ€§åœ¨æŸä¸ªå€¼åŸŸä¸Šçš„è¾“å‡ºï¼Œè€Œæ¯ä¸ªå¶èŠ‚ç‚¹å­˜æ”¾ä¸€ä¸ªç±»åˆ«ã€‚ä½¿ç”¨å†³ç­–æ ‘è¿›è¡Œå†³ç­–çš„è¿‡ç¨‹å°±æ˜¯ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œæµ‹è¯•å¾…åˆ†ç±»é¡¹ä¸­ç›¸åº”çš„ç‰¹å¾å±æ€§ï¼Œå¹¶æŒ‰ç…§å…¶å€¼é€‰æ‹©è¾“å‡ºåˆ†æ”¯ï¼Œç›´åˆ°åˆ°è¾¾å¶å­èŠ‚ç‚¹ï¼Œå°†å¶å­èŠ‚ç‚¹å­˜æ”¾çš„ç±»åˆ«ä½œä¸ºå†³ç­–ç»“æœã€‚</p><img src="/assets/img/å†³ç­–æ ‘.png" alt="å†³ç­–æ ‘"><a id="more"></a><p>å†³ç­–æ ‘ï¼ˆDecision Treeï¼‰æ˜¯ä¸€ç§ç®€å•ä½†æ˜¯å¹¿æ³›ä½¿ç”¨çš„åˆ†ç±»å™¨ã€‚é€šè¿‡è®­ç»ƒæ•°æ®æ„å»ºå†³ç­–æ ‘ï¼Œå¯ä»¥é«˜æ•ˆçš„å¯¹æœªçŸ¥çš„æ•°æ®è¿›è¡Œåˆ†ç±»ã€‚å†³ç­–æ•°æœ‰ä¸¤å¤§ä¼˜ç‚¹ï¼š</p><ol><li>å†³ç­–æ ‘æ¨¡å‹å¯ä»¥è¯»æ€§å¥½ï¼Œå…·æœ‰æè¿°æ€§ï¼Œæœ‰åŠ©äºäººå·¥åˆ†æï¼›</li><li>æ•ˆç‡é«˜ï¼Œå†³ç­–æ ‘åªéœ€è¦ä¸€æ¬¡æ„å»ºï¼Œåå¤ä½¿ç”¨ï¼Œæ¯ä¸€æ¬¡é¢„æµ‹çš„æœ€å¤§è®¡ç®—æ¬¡æ•°ä¸è¶…è¿‡å†³ç­–æ ‘çš„æ·±åº¦ã€‚</li></ol><p>å†³ç­–æ ‘æ—¢å¯ä»¥åšåˆ†ç±»ï¼Œä¹Ÿå¯ä»¥åšå›å½’ã€‚</p><ol><li>åˆ†ç±»æ ‘çš„è¾“å‡ºæ˜¯æ ·æœ¬çš„ç±»æ ‡ã€‚</li><li>å›å½’æ ‘çš„è¾“å‡ºæ˜¯ä¸€ä¸ªå®æ•° (ä¾‹å¦‚æˆ¿å­çš„ä»·æ ¼ï¼Œç—…äººå‘†åœ¨åŒ»é™¢çš„æ—¶é—´ç­‰)ã€‚</li></ol><h2>åˆ†ç±»</h2><p>ä»¥æ–‡ç« å¼€å§‹çš„å›¾ç‰‡ä¸ºä¾‹å­ï¼Œå‡è®¾é“¶è¡Œè´·æ¬¾å‰éœ€è¦å®¡æŸ¥ç”¨æˆ·ä¿¡æ¯ï¼Œæ¥ç¡®å®šæ˜¯å¦æ‰¹å‡†è´·æ¬¾ï¼Œæ„é€ æ•°æ® data.scv å¦‚ä¸‹:</p><blockquote><p>house, married, income, give_loan<br>1, 1, 80, 1<br>1, 0, 30, 1<br>1, 1, 30, 1<br>0, 1, 30, 1<br>0, 1, 40, 1<br>0, 0, 80, 1<br>0, 0, 78, 0<br>0, 0, 70, 1<br>0, 0, 88, 1<br>0, 0, 45, 0<br>0, 1, 87, 1<br>0, 0, 89, 1<br>0, 0, 100, 1</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> genfromtxt</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> tree</span><br><span class="line"><span class="comment"># åŠ è½½æ•°æ®</span></span><br><span class="line">dataset = genfromtxt(<span class="string">'data.csv'</span>, delimiter=<span class="string">","</span>)</span><br><span class="line">x = dataset[<span class="number">1</span>:, <span class="number">0</span>:<span class="number">3</span>]</span><br><span class="line">y = dataset[<span class="number">1</span>:, <span class="number">3</span>]</span><br><span class="line">clf = tree.DecisionTreeClassifier()</span><br><span class="line">clf = clf.fit(x, y)</span><br><span class="line"><span class="comment"># é¢„æµ‹</span></span><br><span class="line">print(clf.predict([[<span class="number">0</span>, <span class="number">0</span>, <span class="number">50</span>]])) <span class="comment"># [ 0.] è¯´æ˜æ­¤ç”¨æˆ·ä¸æ»¡è¶³è´·æ¬¾æ¡ä»¶</span></span><br></pre></td></tr></table></figure><h2>å›å½’</h2><p>å›å½’å’Œåˆ†ç±»ä¸åŒçš„æ˜¯å‘é‡ y å¯ä»¥æ˜¯æµ®ç‚¹æ•°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> tree</span><br><span class="line">X = [[<span class="number">0</span>, <span class="number">0</span>], [<span class="number">2</span>, <span class="number">2</span>]]</span><br><span class="line">y = [<span class="number">0.5</span>, <span class="number">2.5</span>]</span><br><span class="line">clf = tree.DecisionTreeRegressor()</span><br><span class="line">clf = clf.fit(X, y)</span><br><span class="line">clf.predict([[<span class="number">1</span>, <span class="number">1</span>]])</span><br></pre></td></tr></table></figure><p>scikit-learn å®˜ç½‘ç»™å‡ºçš„ä¾‹å­æ˜¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeRegressor</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment"># åˆ›å»ºéšæœºæ•°æ®é›†</span></span><br><span class="line">rng = np.random.RandomState(<span class="number">1</span>)</span><br><span class="line">X = np.sort(<span class="number">5</span> * rng.rand(<span class="number">80</span>, <span class="number">1</span>), axis=<span class="number">0</span>)</span><br><span class="line">y = np.sin(X).ravel()</span><br><span class="line">y[::<span class="number">5</span>] += <span class="number">3</span> * (<span class="number">0.5</span> - rng.rand(<span class="number">16</span>))</span><br><span class="line"><span class="comment"># è®­ç»ƒå†³ç­–æ ‘å›å½’æ¨¡å‹</span></span><br><span class="line">regr_1 = DecisionTreeRegressor(max_depth=<span class="number">2</span>)</span><br><span class="line">regr_2 = DecisionTreeRegressor(max_depth=<span class="number">5</span>)</span><br><span class="line">regr_1.fit(X, y)</span><br><span class="line">regr_2.fit(X, y)</span><br><span class="line"><span class="comment"># é¢„æµ‹</span></span><br><span class="line">X_test = np.arange(<span class="number">0.0</span>, <span class="number">5.0</span>, <span class="number">0.01</span>)[:, np.newaxis]</span><br><span class="line">y_1 = regr_1.predict(X_test)</span><br><span class="line">y_2 = regr_2.predict(X_test)</span><br><span class="line"><span class="comment"># ç»“æœå±•ç¤º</span></span><br><span class="line">plt.figure()</span><br><span class="line">plt.scatter(X, y, c=<span class="string">"darkorange"</span>, label=<span class="string">"data"</span>)</span><br><span class="line">plt.plot(X_test, y_1, color=<span class="string">"cornflowerblue"</span>, label=<span class="string">"max_depth=2"</span>, linewidth=<span class="number">2</span>)</span><br><span class="line">plt.plot(X_test, y_2, color=<span class="string">"yellowgreen"</span>, label=<span class="string">"max_depth=5"</span>, linewidth=<span class="number">2</span>)</span><br><span class="line">plt.xlabel(<span class="string">"data"</span>)</span><br><span class="line">plt.ylabel(<span class="string">"target"</span>)</span><br><span class="line">plt.title(<span class="string">"Decision Tree Regression"</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><h2>å†³ç­–æ ‘çš„ä½¿ç”¨</h2><ol><li>å¦‚æœæ•°æ®é‡å¤§ï¼Œå†³ç­–æ ‘å®¹æ˜“è¿‡æ‹Ÿåˆã€‚æ ·æœ¬å’Œç‰¹å¾çš„æ¯”ä¾‹éå¸¸é‡è¦ã€‚å¦‚æœå†³ç­–æ ‘æ ·æœ¬å°‘ï¼Œç‰¹å¾å¤šï¼Œéå¸¸å¯èƒ½è¿‡æ‹Ÿåˆã€‚</li><li>å¯ä»¥è€ƒè™‘äº‹å…ˆåšç»´åº¦çº¦å‡(PCAï¼ŒICA)ï¼Œä»¥äº§ç”Ÿä¸€ä¸ªç‰¹å¾ä¹‹é—´åŒºåˆ«æ€§å¤§çš„å†³ç­–æ ‘</li><li>é€šè¿‡ export å°†ä½ çš„è®­ç»ƒçš„å†³ç­–æ ‘å¯è§†åŒ–ï¼Œä½¿ç”¨ max_depth =3 ä½œä¸ºä¸€ä¸ªåˆå§‹çš„æ ‘çš„æ·±åº¦ï¼Œæœ‰ä¸€ä¸ªæ•°æ®æ‹Ÿåˆå†³ç­–æ ‘æ¨¡å‹çš„å¤§æ¦‚æ„Ÿè§‰ï¼Œç„¶åé€æ¸å¢åŠ æ·±åº¦<br>æ•°æ®çš„æ ·æœ¬é‡çš„å¢åŠ å°†åŠ æ·±å†³ç­–æ ‘çš„æ·±åº¦ï¼Œä½¿ç”¨ max_depth æ§åˆ¶å†³ç­–æ ‘çš„å°ºå¯¸ä»¥é˜²æ­¢è¿‡æ‹Ÿåˆ</li><li>ä½¿ç”¨ min_samples_split æˆ–è€… min_samples_leaf æ¥æ§åˆ¶å¶èŠ‚ç‚¹çš„æ ·æœ¬æ•°é‡ã€‚ä¸€ä¸ªéå¸¸å°çš„æ•°é‡å¾€å¾€æ„å‘³ç€è¿‡æ‹Ÿåˆï¼Œè€Œä¸€ä¸ªè¾ƒå¤§çš„æ•°å¯ä»¥é˜²æ­¢è¿‡æ‹Ÿåˆã€‚å¯ä»¥å°† min_samples_leaf=5 ä½œä¸ºä¸€ä¸ªåˆå§‹å€¼ã€‚å¦‚æœæ ·æœ¬æ•°æ®å˜åŒ–å·¨å¤§ï¼Œå¯ä»¥é‡‡ç”¨ä¸€ä¸ªæµ®ç‚¹æ•°ã€‚ä¸¤è€…çš„åŒºåˆ«åœ¨äº min_samples_leaf ä¿è¯äº†å¶èŠ‚ç‚¹æœ€å°çš„æ•°é‡ï¼Œmin_samples_split èƒ½å¤Ÿå»ºç«‹ä»»æ„æ•°é‡çš„å¶å­èŠ‚ç‚¹ï¼Œåœ¨æ–‡å­¦ä¸Šç”¨åˆ°ä¹Ÿæ›´å¤š</li><li>å¦‚æœæ ·æœ¬æ˜¯æœ‰æƒé‡çš„ï¼Œå¯ä»¥ä½¿ç”¨ min_weight_fraction_leaf æ¥å®ç°åŸºäºæƒé‡çš„é¢„ä¿®å‰ªè§„åˆ™æ¥ä¼˜åŒ–å†³ç­–æ ‘ç»“æ„</li><li>å†³ç­–æ ‘å†…éƒ¨ä½¿ç”¨ np.float32 å‘é‡ï¼Œå¦‚æœæ ·æœ¬ä¸æ˜¯è¿™ä¸ªå½¢å¼çš„ï¼Œå°†äº§ç”Ÿä¸€ä¸ªæ•°æ®é›†çš„æ ·æœ¬</li><li>å¦‚æœæ•°æ®çŸ©é˜µ X æ˜¯éå¸¸ç¨€ç–çš„ï¼Œå»ºè®®åœ¨æ‹Ÿåˆå’Œé¢„æµ‹ä¹‹å‰è½¬æ¢ä¸ºç¨€ç–çŸ©é˜µ csc_matrixã€‚ç¨€ç–çŸ©é˜µå°†æ¯”ç¨ å¯†çŸ©é˜µå¿«æ•°é‡çº§çš„é€Ÿåº¦</li></ol><p><a href="https://github.com/Leo555/scikit-learn_demo/tree/master/03DecisionTree" target="_blank" rel="noopener">ä»£ç åœ°å€</a></p><h1>å‚è€ƒæ–‡çŒ®</h1><ul><li><a href="http://www.cnblogs.com/leoo2sk/archive/2010/09/19/decision-tree.html" target="_blank" rel="noopener">ç®—æ³•æ‚è´§é“ºâ€”â€”åˆ†ç±»ç®—æ³•ä¹‹å†³ç­–æ ‘(Decision tree)</a></li><li><a href="http://blog.csdn.net/gamer_gyt/article/details/51242815" target="_blank" rel="noopener">ã€Šæœºå™¨å­¦ä¹ å®æˆ˜ã€‹åŸºäºä¿¡æ¯è®ºçš„ä¸‰ç§å†³ç­–æ ‘ç®—æ³•(ID3,C4.5,CART)</a></li><li><a href="http://python.jobbole.com/86911/" target="_blank" rel="noopener">Scikit-learnä¸­çš„å†³ç­–æ ‘</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;å†³ç­–æ ‘&lt;/h1&gt;
&lt;p&gt;å†³ç­–æ ‘æ˜¯ä¸€ä¸ªéå‚æ•°çš„ç›‘ç£å¼å­¦ä¹ æ–¹æ³•ï¼Œä¸»è¦ç”¨äºåˆ†ç±»å’Œå›å½’ï¼Œç®—æ³•çš„ç›®æ ‡æ˜¯é€šè¿‡æ¨æ–­æ•°æ®ç‰¹å¾ï¼Œå­¦ä¹ å†³ç­–è§„åˆ™ä»è€Œåˆ›å»ºä¸€ä¸ªé¢„æµ‹ç›®æ ‡å˜é‡çš„æ¨¡å‹ã€‚å†³ç­–æ ‘ï¼ˆdecision treeï¼‰æ˜¯ä¸€ä¸ªæ ‘ç»“æ„ï¼ˆå¯ä»¥æ˜¯äºŒå‰æ ‘æˆ–éäºŒå‰æ ‘ï¼‰ã€‚å…¶æ¯ä¸ªéå¶èŠ‚ç‚¹è¡¨ç¤ºä¸€ä¸ªç‰¹å¾å±æ€§ä¸Šçš„æµ‹è¯•ï¼Œæ¯ä¸ªåˆ†æ”¯ä»£è¡¨è¿™ä¸ªç‰¹å¾å±æ€§åœ¨æŸä¸ªå€¼åŸŸä¸Šçš„è¾“å‡ºï¼Œè€Œæ¯ä¸ªå¶èŠ‚ç‚¹å­˜æ”¾ä¸€ä¸ªç±»åˆ«ã€‚ä½¿ç”¨å†³ç­–æ ‘è¿›è¡Œå†³ç­–çš„è¿‡ç¨‹å°±æ˜¯ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œæµ‹è¯•å¾…åˆ†ç±»é¡¹ä¸­ç›¸åº”çš„ç‰¹å¾å±æ€§ï¼Œå¹¶æŒ‰ç…§å…¶å€¼é€‰æ‹©è¾“å‡ºåˆ†æ”¯ï¼Œç›´åˆ°åˆ°è¾¾å¶å­èŠ‚ç‚¹ï¼Œå°†å¶å­èŠ‚ç‚¹å­˜æ”¾çš„ç±»åˆ«ä½œä¸ºå†³ç­–ç»“æœã€‚&lt;/p&gt;
&lt;img src=&quot;/assets/img/å†³ç­–æ ‘.png&quot; alt=&quot;å†³ç­–æ ‘&quot;&gt;
    
    </summary>
    
      <category term="Machine Learning" scheme="https://lz5z.com/categories/Machine-Learning/"/>
    
    
      <category term="Python" scheme="https://lz5z.com/tags/Python/"/>
    
      <category term="Machine Learning" scheme="https://lz5z.com/tags/Machine-Learning/"/>
    
      <category term="scikit-learn" scheme="https://lz5z.com/tags/scikit-learn/"/>
    
  </entry>
  
  <entry>
    <title>æœºå™¨å­¦ä¹ å¸¸ç”¨ç®—æ³•â€”â€”é€»è¾‘å›å½’</title>
    <link href="https://lz5z.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%B8%B8%E7%94%A8%E7%AE%97%E6%B3%95%E2%80%94%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/"/>
    <id>https://lz5z.com/æœºå™¨å­¦ä¹ å¸¸ç”¨ç®—æ³•â€”é€»è¾‘å›å½’/</id>
    <published>2017-01-06T21:27:24.000Z</published>
    <updated>2020-04-21T10:23:54.831Z</updated>
    
    <content type="html"><![CDATA[<h1>é€»è¾‘å›å½’</h1><p>é¦–å…ˆï¼Œé€»è¾‘å›å½’æ˜¯ä¸€ä¸ªåˆ†ç±»ç®—æ³•è€Œä¸æ˜¯ä¸€ä¸ªå›å½’ç®—æ³•ï¼Œè¯¥ç®—æ³•å¯æ ¹æ®å·²çŸ¥çš„ä¸€ç³»åˆ—å› å˜é‡ä¼°è®¡ç¦»æ•£æ•°å€¼ï¼ˆæ¯”æ–¹è¯´äºŒè¿›åˆ¶æ•°å€¼ 0 æˆ– 1 ï¼Œæ˜¯æˆ–å¦ï¼ŒçœŸæˆ–å‡ï¼‰ï¼Œå®ƒé€šè¿‡å°†æ•°æ®æ‹Ÿåˆè¿›ä¸€ä¸ª <strong>é€»è¾‘å‡½æ•°</strong> æ¥é¢„ä¼°ä¸€ä¸ªäº‹ä»¶å‡ºç°çš„æ¦‚ç‡ã€‚å› ä¸ºå®ƒé¢„ä¼°çš„æ˜¯æ¦‚ç‡ï¼Œæ‰€ä»¥å®ƒçš„è¾“å‡ºå€¼å¤§å°åœ¨ 0 å’Œ 1 ä¹‹é—´ï¼ˆæ­£å¦‚æ‰€é¢„è®¡çš„ä¸€æ ·ï¼‰ã€‚</p><img src="/assets/img/é€»è¾‘å›å½’.jpg" alt="çº¿æ€§å›å½’">[æ¯”åˆ©æ—¶çš„äººå£å¢é•¿æ•°é‡å›¾]<a id="more"></a><p>é€»è¾‘å‡½æ•°ç”±äºå®ƒçš„Så½¢ï¼Œæœ‰æ—¶ä¹Ÿè¢«ç§°ä¸ºsigmoidå‡½æ•°ã€‚</p><p>é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥ç†è§£è¿™ä¸ªç®—æ³•ã€‚<br>å‡è®¾ä½ çš„æœ‹å‹è®©ä½ è§£å¼€ä¸€ä¸ªè°œé¢˜ã€‚è¿™åªä¼šæœ‰ä¸¤ä¸ªç»“æœï¼šä½ è§£å¼€äº†æˆ–æ˜¯ä½ æ²¡æœ‰è§£å¼€ï¼ˆç¦»æ•£å€¼ï¼‰ã€‚æƒ³è±¡ä½ è¦è§£ç­”å¾ˆå¤šé“é¢˜æ¥æ‰¾å‡ºä½ æ‰€æ“…é•¿çš„ä¸»é¢˜ã€‚è¿™ä¸ªç ”ç©¶çš„ç»“æœå°±ä¼šåƒæ˜¯è¿™æ ·ï¼šå‡è®¾é¢˜ç›®æ˜¯ä¸€é“åå¹´çº§çš„ä¸‰è§’å‡½æ•°é¢˜ï¼Œä½ æœ‰ 70% çš„å¯èƒ½ä¼šè§£å¼€è¿™é“é¢˜ã€‚ç„¶è€Œï¼Œè‹¥é¢˜ç›®æ˜¯ä¸ªäº”å¹´çº§çš„å†å²é¢˜ï¼Œä½ åªæœ‰ 30% çš„å¯èƒ½æ€§å›ç­”æ­£ç¡®ã€‚è¿™å°±æ˜¯é€»è¾‘å›å½’èƒ½æä¾›ç»™ä½ çš„ä¿¡æ¯ã€‚</p><h2>ç”¨é€”</h2><p>é€»è¾‘å›å½’ä¸»è¦ç”¨äºåˆ†ç±»ï¼Œæ¯”å¦‚é‚®ä»¶åˆ†ç±»ï¼Œæ˜¯å¦è‚¿ç˜¤ã€ç™Œç—‡è¯Šæ–­ï¼Œç”¨æˆ·æ€§åˆ«åˆ¤æ–­ï¼Œé¢„æµ‹ç”¨æˆ·è´­ä¹°äº§å“ç±»åˆ«ï¼Œåˆ¤æ–­è¯„è®ºæ˜¯æ­£é¢è¿˜æ˜¯è´Ÿé¢ç­‰ã€‚</p><p>é€»è¾‘å›å½’çš„æ•°å­¦æ¨¡å‹å’Œæ±‚è§£éƒ½ç›¸å¯¹æ¯”è¾ƒç®€æ´ï¼Œå®ç°ç›¸å¯¹ç®€å•ã€‚é€šè¿‡å¯¹ç‰¹å¾åšç¦»æ•£åŒ–å’Œå…¶ä»–æ˜ å°„ï¼Œé€»è¾‘å›å½’ä¹Ÿå¯ä»¥å¤„ç†éçº¿æ€§é—®é¢˜ï¼Œæ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„åˆ†ç±»å™¨ã€‚å› æ­¤åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå½“æˆ‘ä»¬èƒ½å¤Ÿæ‹¿åˆ°è®¸å¤šä½å±‚æ¬¡çš„ç‰¹å¾æ—¶ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨é€»è¾‘å›å½’æ¥è§£å†³æˆ‘ä»¬çš„é—®é¢˜ã€‚</p><h2>åŠ è½½æ•°æ®(Data Loading)</h2><p>æˆ‘ä»¬å‡è®¾è¾“å…¥æ˜¯ä¸€ä¸ªç‰¹å¾çŸ©é˜µæˆ–è€… csv æ–‡ä»¶ï¼Œæˆ‘ä»¬ä½¿ç”¨ NumPy æ¥è½½å…¥ csv æ–‡ä»¶ã€‚<br>ä»¥ä¸‹æ˜¯ä» UCI æœºå™¨å­¦ä¹ æ•°æ®ä»“åº“ä¸­ä¸‹è½½çš„æ•°æ®ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> urllib.request</span><br><span class="line"><span class="comment"># åŠ è½½æ•°æ®</span></span><br><span class="line">url = <span class="string">"http://archive.ics.uci.edu/ml/machine-learning-databases/pima-indians-diabetes/pima-indians-diabetes.data"</span></span><br><span class="line">raw_data = urllib.request.urlopen(url)</span><br><span class="line"><span class="comment"># æŠŠCSVæ–‡ä»¶è½¬åŒ–ä¸ºnumpy matrix</span></span><br><span class="line">dataset = np.loadtxt(raw_data, delimiter=<span class="string">","</span>)</span><br><span class="line"><span class="comment"># è®­ç»ƒé›†å’Œç»“æœ</span></span><br><span class="line">X = dataset[:, <span class="number">0</span>:<span class="number">7</span>]</span><br><span class="line">y = dataset[:, <span class="number">8</span>]</span><br></pre></td></tr></table></figure><h2>æ•°æ®å½’ä¸€åŒ–(Data Normalization)ä¸æ ‡å‡†åŒ–</h2><p>æ•°æ®å½’ä¸€åŒ–æ˜¯æŒ‡æŠŠæ•°å­—å˜æˆï¼ˆ0,1ï¼‰ä¹‹é—´çš„å°æ•°ã€‚</p><p>æ•°æ®çš„æ ‡å‡†åŒ–æ˜¯å°†æ•°æ®æŒ‰æ¯”ä¾‹ç¼©æ”¾ï¼Œä½¿ä¹‹è½å…¥ä¸€ä¸ªå°çš„ç‰¹å®šåŒºé—´ã€‚</p><p>å¤§å¤šæ•°æœºå™¨å­¦ä¹ ç®—æ³•ä¸­çš„æ¢¯åº¦æ–¹æ³•å¯¹äºæ•°æ®çš„ç¼©æ”¾å’Œå°ºåº¦éƒ½æ˜¯å¾ˆæ•æ„Ÿçš„ï¼Œåœ¨å¼€å§‹è·‘ç®—æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬åº”è¯¥è¿›è¡Œå½’ä¸€åŒ–æˆ–è€…æ ‡å‡†åŒ–çš„è¿‡ç¨‹ï¼Œè¿™ä½¿å¾—ç‰¹å¾æ•°æ®ç¼©æ”¾åˆ° 0-1 èŒƒå›´ä¸­ã€‚scikit-learn æä¾›äº†å½’ä¸€åŒ–å’Œæ ‡å‡†åŒ–çš„æ–¹æ³•ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> preprocessing</span><br><span class="line"><span class="comment"># å½’ä¸€åŒ–</span></span><br><span class="line">normalized_X = preprocessing.normalize(X)</span><br><span class="line"><span class="comment"># æ ‡å‡†åŒ–</span></span><br><span class="line">standardized_X = preprocessing.scale(X)</span><br></pre></td></tr></table></figure><h2>ç‰¹å¾é€‰æ‹©(Feature Selection)</h2><p>åœ¨è§£å†³ä¸€ä¸ªå®é™…é—®é¢˜çš„è¿‡ç¨‹ä¸­ï¼Œé€‰æ‹©åˆé€‚çš„ç‰¹å¾æˆ–è€…æ„å»ºç‰¹å¾çš„èƒ½åŠ›ç‰¹åˆ«é‡è¦ã€‚è¿™æˆä¸ºç‰¹å¾é€‰æ‹©æˆ–è€…ç‰¹å¾å·¥ç¨‹ã€‚<br>ç‰¹å¾é€‰æ‹©æ—¶ä¸€ä¸ªå¾ˆéœ€è¦åˆ›é€ åŠ›çš„è¿‡ç¨‹ï¼Œæ›´å¤šçš„ä¾èµ–äºç›´è§‰å’Œä¸“ä¸šçŸ¥è¯†ï¼Œå¹¶ä¸”æœ‰å¾ˆå¤šç°æˆçš„ç®—æ³•æ¥è¿›è¡Œç‰¹å¾çš„é€‰æ‹©ã€‚<br>ä¸‹é¢çš„æ ‘ç®—æ³•(Tree algorithms)è®¡ç®—ç‰¹å¾çš„ä¿¡æ¯é‡ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> metrics</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> ExtraTreesClassifier</span><br><span class="line">model = ExtraTreesClassifier()</span><br><span class="line">model.fit(X, y)</span><br><span class="line"><span class="comment"># æ˜¾ç¤ºæ¯ä¸ªå±æ€§ç›¸å¯¹é‡è¦æ€§</span></span><br><span class="line">print(model.feature_importances_)</span><br></pre></td></tr></table></figure><h3>å…³äºç‰¹å¾æå–</h3><p>æœºå™¨å­¦ä¹ æ˜¯ä¸€ä¸ªè¿‡ç¨‹ï¼Œè¿™æ ·çš„è¿‡ç¨‹åŒ…æ‹¬æ•°æ®å¤„ç† + æ¨¡å‹è®­ç»ƒï¼Œè€Œç‰¹å¾æå–æ˜¯æ•°æ®å¤„ç†ä¸­ä¸å¯æˆ–ç¼ºçš„ä¸€ç¯ã€‚</p><p>æ¯”å¦‚é¢„æµ‹ä»€ä¹ˆæ ·çš„ç”Ÿæ´»æ–¹å¼ç‰¹å¾æ˜¯å¼•å‘å† å¿ƒç—… (CHD) çš„å±é™©å› ç´ ï¼Ÿç»™å®šå…·æœ‰å¸çƒŸçŠ¶æ€ã€é¥®é£Ÿã€é”»ç‚¼ã€é¥®é…’å’Œ CHD çŠ¶æ€åº¦é‡çš„æ‚£è€…æ ·æœ¬ï¼Œå¯ä»¥ä½¿ç”¨è¿™å››ä¸ªç”Ÿæ´»æ–¹å¼å˜é‡å»ºç«‹ä¸€ä¸ªæ¨¡å‹ï¼Œç”¨äºé¢„æµ‹æ‚£è€…æ ·æœ¬ä¸­ CHD çš„å­˜åœ¨æ€§ã€‚ç„¶åå¯ä½¿ç”¨æ­¤æ¨¡å‹ä¸ºæ¯ä¸ªå› å­æ¨å¯¼å‡ ç‡æ¯”ä¼°è®¡å€¼ï¼Œä»è€Œè·çŸ¥æŸäº›ä¿¡æ¯ï¼Œä¾‹å¦‚å¸çƒŸè€…æ¯”éå¸çƒŸè€…åœ¨ä½•ç§ç¨‹åº¦ä¸Šæ›´æ˜“æ‚£ CHDã€‚</p><h2>ç®—æ³•é€‰æ‹©â€“é€»è¾‘å›å½’</h2><p>å¤§å¤šæ•°é—®é¢˜éƒ½å¯ä»¥å½’ç»“ä¸ºäºŒå…ƒåˆ†ç±»é—®é¢˜ã€‚è¿™ä¸ªç®—æ³•çš„ä¼˜ç‚¹æ˜¯å¯ä»¥ç»™å‡ºæ•°æ®æ‰€åœ¨ç±»åˆ«çš„æ¦‚ç‡ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> metrics</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line">model = LogisticRegression()</span><br><span class="line">model.fit(X, y)</span><br><span class="line"><span class="comment"># é¢„æµ‹</span></span><br><span class="line">expected = y</span><br><span class="line">predicted = model.predict(X)</span><br><span class="line"><span class="comment"># æ¨¡å‹æ‹Ÿåˆæ¦‚è¿°</span></span><br><span class="line">print(metrics.classification_report(expected, predicted))</span><br><span class="line">print(metrics.confusion_matrix(expected, predicted))</span><br></pre></td></tr></table></figure><h2>æœ€å</h2><p>ä»¥ä¸Š <strong>åŠ è½½æ•°æ®</strong> -&gt; <strong>æ•°æ®å½’ä¸€åŒ–</strong> -&gt; <strong>ç‰¹å¾é€‰æ‹©</strong> -&gt; <strong>ç®—æ³•é€‰æ‹©</strong> æ—¢æ˜¯æœºå™¨å­¦ä¹ çš„ä¸€èˆ¬ä»£ç é€»è¾‘ã€‚å¦‚æœé€‰æ‹©å…¶å®ƒç®—æ³•ï¼Œåªéœ€è¦æ›´æ”¹æœ€åä¸€æ­¥ç®—æ³•é€‰æ‹©å³å¯ã€‚</p><p><a href="https://github.com/Leo555/scikit-learn_demo/tree/master/02LogisticRegression" target="_blank" rel="noopener">ä»£ç åœ°å€</a></p><h1>å‚è€ƒæ–‡çŒ®</h1><ul><li><a href="http://tech.meituan.com/intro_to_logistic_regression.html" target="_blank" rel="noopener">Logistic Regression æ¨¡å‹ç®€ä»‹</a></li><li><a href="http://www.ibm.com/support/knowledgecenter/zh/SSLVMB_22.0.0/com.ibm.spss.statistics.help/spss/regression/idh_lreg.htm" target="_blank" rel="noopener">Logistic å›å½’</a></li><li><a href="http://blog.jasonding.top/2015/04/17/Machine%20Learning%20Experiments/%E3%80%90%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%AE%9E%E9%AA%8C%E3%80%91scikit-learn%E7%9A%84%E4%B8%BB%E8%A6%81%E6%A8%A1%E5%9D%97%E5%92%8C%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/#%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92" target="_blank" rel="noopener">scikit-learnçš„ä¸»è¦æ¨¡å—å’ŒåŸºæœ¬ä½¿ç”¨</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;é€»è¾‘å›å½’&lt;/h1&gt;
&lt;p&gt;é¦–å…ˆï¼Œé€»è¾‘å›å½’æ˜¯ä¸€ä¸ªåˆ†ç±»ç®—æ³•è€Œä¸æ˜¯ä¸€ä¸ªå›å½’ç®—æ³•ï¼Œè¯¥ç®—æ³•å¯æ ¹æ®å·²çŸ¥çš„ä¸€ç³»åˆ—å› å˜é‡ä¼°è®¡ç¦»æ•£æ•°å€¼ï¼ˆæ¯”æ–¹è¯´äºŒè¿›åˆ¶æ•°å€¼ 0 æˆ– 1 ï¼Œæ˜¯æˆ–å¦ï¼ŒçœŸæˆ–å‡ï¼‰ï¼Œå®ƒé€šè¿‡å°†æ•°æ®æ‹Ÿåˆè¿›ä¸€ä¸ª &lt;strong&gt;é€»è¾‘å‡½æ•°&lt;/strong&gt; æ¥é¢„ä¼°ä¸€ä¸ªäº‹ä»¶å‡ºç°çš„æ¦‚ç‡ã€‚å› ä¸ºå®ƒé¢„ä¼°çš„æ˜¯æ¦‚ç‡ï¼Œæ‰€ä»¥å®ƒçš„è¾“å‡ºå€¼å¤§å°åœ¨ 0 å’Œ 1 ä¹‹é—´ï¼ˆæ­£å¦‚æ‰€é¢„è®¡çš„ä¸€æ ·ï¼‰ã€‚&lt;/p&gt;
&lt;img src=&quot;/assets/img/é€»è¾‘å›å½’.jpg&quot; alt=&quot;çº¿æ€§å›å½’&quot;&gt;
[æ¯”åˆ©æ—¶çš„äººå£å¢é•¿æ•°é‡å›¾]
    
    </summary>
    
      <category term="Machine Learning" scheme="https://lz5z.com/categories/Machine-Learning/"/>
    
    
      <category term="Python" scheme="https://lz5z.com/tags/Python/"/>
    
      <category term="Machine Learning" scheme="https://lz5z.com/tags/Machine-Learning/"/>
    
      <category term="scikit-learn" scheme="https://lz5z.com/tags/scikit-learn/"/>
    
  </entry>
  
  <entry>
    <title>æœºå™¨å­¦ä¹ å¸¸ç”¨ç®—æ³•â€”â€”çº¿æ€§å›å½’</title>
    <link href="https://lz5z.com/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%B8%B8%E7%94%A8%E7%AE%97%E6%B3%95%E2%80%94%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/"/>
    <id>https://lz5z.com/æœºå™¨å­¦ä¹ å¸¸ç”¨ç®—æ³•â€”çº¿æ€§å›å½’/</id>
    <published>2017-01-05T21:27:24.000Z</published>
    <updated>2020-04-21T10:23:54.831Z</updated>
    
    <content type="html"><![CDATA[<h1>èƒŒæ™¯</h1><p>ä¸Šæ¬¡çš„ ITA é¡¹ç›®å¼€å§‹æ¥è§¦æœºå™¨å­¦ä¹ ç›¸å…³çš„çŸ¥è¯†ï¼Œä»æœ¬æ–‡å¼€å§‹ï¼Œæˆ‘å°†å­¦ä¹ å¹¶ä»‹ç»æœºå™¨å­¦ä¹ æœ€å¸¸ç”¨çš„å‡ ç§ç®—æ³•ï¼Œå¹¶ä½¿ç”¨ <a href="http://scikit-learn.org/" target="_blank" rel="noopener">scikit-learn</a> ç›¸å…³æ¨¡å‹å®Œæˆç›¸å…³ç®—æ³•çš„ demoã€‚</p><h1>çº¿æ€§å›å½’</h1><img src="/assets/img/çº¿æ€§å›å½’.jpg" alt="çº¿æ€§å›å½’"><a id="more"></a><p>çº¿æ€§å›å½’ï¼Œæ˜¯åˆ©ç”¨æ•°ç†ç»Ÿè®¡ä¸­å›å½’åˆ†æï¼Œæ¥ç¡®å®šä¸¤ç§æˆ–ä¸¤ç§ä»¥ä¸Šå˜é‡é—´ç›¸äº’ä¾èµ–çš„å®šé‡å…³ç³»çš„ä¸€ç§ç»Ÿè®¡åˆ†ææ–¹æ³•ã€‚æˆ‘ä»¬é€šè¿‡æ‹Ÿåˆæœ€ä½³ç›´çº¿æ¥å»ºç«‹è‡ªå˜é‡å’Œå› å˜é‡çš„å…³ç³»ï¼Œè¿™æ¡æœ€ä½³ç›´çº¿å«åšå›å½’çº¿ï¼Œå¹¶ä¸”ç”¨ <code>Y= a*x + b</code>è¿™æ¡çº¿æ€§ç­‰å¼æ¥è¡¨ç¤ºã€‚</p><p>ç†è§£çº¿æ€§å›å½’å¯ä»¥æƒ³è±¡ä¸€ä¸‹ä¸€èˆ¬äººèº«é«˜ä¸ä½“é‡ä¹‹é—´çš„å…³ç³»ï¼Œåœ¨ä¸èƒ½å‡†ç¡®æµ‹è¯•ä½“é‡çš„æƒ…å†µä¸‹ï¼ŒæŒ‰ç…§èº«é«˜è¿›è¡Œæ’åºï¼Œä¹Ÿèƒ½å¤§ä½“å¾—å‡ºä½“é‡çš„å¤§å°ã€‚è¿™æ˜¯ç°å®ç”Ÿæ´»ä¸­ä½¿ç”¨çº¿æ€§å›å½’çš„ä¾‹å­ã€‚<br>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒY æ˜¯ä½“é‡ï¼ˆå› å˜é‡ï¼‰ï¼Œx æ˜¯èº«é«˜ï¼ˆè‡ªå˜é‡ï¼‰ï¼Œa å’Œ b åˆ†åˆ«ä¸ºæ–œç‡å’Œæˆªè·ï¼Œå¯ä»¥é€šè¿‡æœ€å°äºŒä¹˜æ³•è·å¾—ã€‚</p><h2>èº«é«˜ä½“é‡</h2><h3>å‡†å¤‡æ•°æ®</h3><p>è‡ªå·±ä¼ªé€ äº†ä¸€äº›æ•°æ®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">runplt</span><span class="params">()</span>:</span></span><br><span class="line">    plt.figure()</span><br><span class="line">    plt.title(<span class="string">u'Height-Weight'</span>)</span><br><span class="line">    plt.xlabel(<span class="string">u'Height'</span>)</span><br><span class="line">    plt.ylabel(<span class="string">u'Weight'</span>)</span><br><span class="line">    plt.axis([<span class="number">150</span>, <span class="number">190</span>, <span class="number">40</span>, <span class="number">90</span>])</span><br><span class="line">    plt.grid(<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">return</span> plt</span><br><span class="line"></span><br><span class="line">plt = runplt()</span><br><span class="line">x = [[<span class="number">155</span>], [<span class="number">157</span>], [<span class="number">166</span>], [<span class="number">177</span>], [<span class="number">187</span>]]</span><br><span class="line">y = [[<span class="number">55</span>], [<span class="number">60</span>], [<span class="number">63</span>], [<span class="number">70</span>], [<span class="number">79</span>]]</span><br><span class="line">plt.plot(x, y, <span class="string">'k.'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><img src="/assets/img/çº¿æ€§å›å½’_1.png" alt="çº¿æ€§å›å½’"><h3>åˆ›å»ºå¹¶æ‹Ÿåˆæ¨¡å‹</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="comment"># åˆ›å»ºå¹¶æ‹Ÿåˆæ¨¡å‹</span></span><br><span class="line">model = LinearRegression()</span><br><span class="line">model.fit(x, y)</span><br><span class="line">print(<span class="string">'é¢„æµ‹èº«é«˜180åŒå­¦çš„ä½“é‡ï¼š$%.2f'</span> % model.predict(np.array([<span class="number">180</span>]).reshape(<span class="number">-1</span>, <span class="number">1</span>))[<span class="number">0</span>])</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ä¸­ sklearn.linear_model.LinearRegression ç±»æ˜¯ä¸€ä¸ªä¼°è®¡å™¨ï¼ˆestimatorï¼‰ã€‚ä¼°è®¡å™¨ä¾æ®è§‚æµ‹å€¼æ¥é¢„æµ‹ç»“æœã€‚åœ¨ scikit-learn é‡Œé¢ï¼Œæ‰€æœ‰çš„ä¼°è®¡å™¨éƒ½å¸¦æœ‰:</p><ul><li>fit()</li><li>predict()</li></ul><p>fit() ç”¨æ¥åˆ†ææ¨¡å‹å‚æ•°ï¼Œpredict() æ˜¯é€šè¿‡ fit()ç®—å‡ºçš„æ¨¡å‹å‚æ•°æ„æˆçš„æ¨¡å‹ï¼Œå¯¹è§£é‡Šå˜é‡è¿›è¡Œé¢„æµ‹è·å¾—çš„å€¼ã€‚<br>å› ä¸ºæ‰€æœ‰çš„ä¼°è®¡å™¨éƒ½æœ‰è¿™ä¸¤ç§æ–¹æ³•ï¼Œæ‰€æœ‰ scikit-learn å¾ˆå®¹æ˜“å®ç°ä¸åŒçš„æ¨¡å‹ã€‚</p><h2>çº¿æ€§å›å½’åˆ†ç±»</h2><p>çº¿æ€§å›å½’çš„ä¸¤ç§ä¸»è¦ç±»å‹æ˜¯ä¸€å…ƒçº¿æ€§å›å½’å’Œå¤šå…ƒçº¿æ€§å›å½’ã€‚ä¸€å…ƒçº¿æ€§å›å½’çš„ç‰¹ç‚¹æ˜¯åªæœ‰ä¸€ä¸ªè‡ªå˜é‡ã€‚å¤šå…ƒçº¿æ€§å›å½’åˆ™å­˜åœ¨å¤šä¸ªè‡ªå˜é‡ã€‚æ‰¾æœ€ä½³æ‹Ÿåˆç›´çº¿çš„æ—¶å€™ï¼Œä½ å¯ä»¥æ‹Ÿåˆåˆ°å¤šé¡¹æˆ–è€…æ›²çº¿å›å½’ã€‚è¿™äº›å°±è¢«å«åšå¤šé¡¹æˆ–æ›²çº¿å›å½’ã€‚</p><h3>ä¸€å…ƒçº¿æ€§å›å½’</h3><p>ä¸€å…ƒçº¿æ€§å›å½’æ¨¡å‹æ˜¯ <code>Y= a*x + b</code>ï¼Œæ±‚è§£ä¸€å…ƒçº¿æ€§å›å½’æ¨¡å‹çš„æœ¬è´¨å°±æ˜¯æ±‚è§£å‚æ•° a å’Œ b çš„è¿‡ç¨‹ï¼Œæœ€å¸¸ç”¨çš„æ–¹æ³•ä¸ºæœ€å°äºŒä¹˜æ³•ã€‚</p><h4>æ®‹å·®é¢„æµ‹å€¼</h4><p>æ¨¡å‹çš„æ®‹å·®æ˜¯è®­ç»ƒæ ·æœ¬ç‚¹ä¸çº¿æ€§å›å½’æ¨¡å‹çš„çºµå‘è·ç¦»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ®‹å·®é¢„æµ‹å€¼</span></span><br><span class="line">y2 = model.predict(x)</span><br><span class="line">plt.plot(x, y, <span class="string">'k.'</span>)</span><br><span class="line">plt.plot(x, y2, <span class="string">'g-'</span>)</span><br><span class="line"><span class="keyword">for</span> idx, x <span class="keyword">in</span> enumerate(x):</span><br><span class="line">    plt.plot([x, x], [y[idx], y2[idx]], <span class="string">'r-'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p>å¦‚å›¾æ‰€ç¤ºï¼š<br><img src="/assets/img/çº¿æ€§å›å½’_2.jpg" alt="çº¿æ€§å›å½’"></p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡æ®‹å·®ä¹‹å’Œæœ€å°åŒ–å®ç°æœ€ä½³æ‹Ÿåˆï¼Œä¹Ÿå°±æ˜¯è¯´æ¨¡å‹é¢„æµ‹çš„å€¼ä¸è®­ç»ƒé›†çš„æ•°æ®æœ€æ¥è¿‘å°±æ˜¯æœ€ä½³æ‹Ÿåˆã€‚å¯¹æ¨¡å‹çš„æ‹Ÿåˆåº¦è¿›è¡Œè¯„ä¼°çš„å‡½æ•°ç§°ä¸ºæ®‹å·®å¹³æ–¹å’Œï¼ˆresidual sum of squaresï¼‰æˆæœ¬å‡½æ•°ã€‚å°±æ˜¯è®©æ‰€æœ‰è®­ç»ƒæ•°æ®ä¸æ¨¡å‹çš„æ®‹å·®çš„å¹³æ–¹ä¹‹å’Œæœ€å°åŒ–ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br><img src="/assets/img/çº¿æ€§å›å½’_3.png" alt="çº¿æ€§å›å½’"></p><p>å…¶ä¸­ï¼Œ yi æ˜¯è§‚æµ‹å€¼ï¼Œ f(xi)f(xi) æ˜¯é¢„æµ‹å€¼ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">print(<span class="string">'æ®‹å·®å¹³æ–¹å’Œ: %.2f'</span> % np.mean((model.predict(x) - y) ** <span class="number">2</span>))</span><br></pre></td></tr></table></figure><p>æ®‹å·®å¹³æ–¹å’Œ: 2.05</p><h4>æ¨¡å‹è¯„ä¼°</h4><p>ä½¿ç”¨çº¿æ€§å›å½’å¾—å‡ºæ¨¡å‹åï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ R æ–¹ï¼ˆr-squaredï¼‰è¯„ä¼°æ¨¡å‹çš„æ•ˆæœã€‚Ræ–¹ä¹Ÿå«ç¡®å®šç³»æ•°ï¼ˆcoefficient of determinationï¼‰ï¼Œè¡¨ç¤ºæ¨¡å‹å¯¹ç°å®æ•°æ®æ‹Ÿåˆçš„ç¨‹åº¦ã€‚</p><p>ä¸€å…ƒçº¿æ€§å›å½’ä¸­Ræ–¹ç­‰äºçš®å°”é€Šç§¯çŸ©ç›¸å…³ç³»æ•°ï¼ˆPearson product moment correlation coefficientæˆ–Pearsonâ€™s rï¼‰çš„å¹³æ–¹ã€‚è¿™ç§æ–¹æ³•è®¡ç®—çš„Ræ–¹ä¸€å®šä»‹äº0ï½1ä¹‹é—´çš„æ­£æ•°ã€‚å…¶ä»–è®¡ç®—æ–¹æ³•ï¼ŒåŒ…æ‹¬scikit-learnä¸­çš„æ–¹æ³•ï¼Œä¸æ˜¯ç”¨çš®å°”é€Šç§¯çŸ©ç›¸å…³ç³»æ•°çš„å¹³æ–¹è®¡ç®—çš„ï¼Œå› æ­¤å½“æ¨¡å‹æ‹Ÿåˆæ•ˆæœå¾ˆå·®çš„æ—¶å€™Ræ–¹ä¼šæ˜¯è´Ÿå€¼ã€‚</p><img src="/assets/img/çº¿æ€§å›å½’_4.png" alt="çº¿æ€§å›å½’"><p>LinearRegressionçš„scoreæ–¹æ³•å¯ä»¥è®¡ç®—Ræ–¹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## æµ‹è¯•é›†</span></span><br><span class="line">x_test = [[<span class="number">156</span>], [<span class="number">163</span>], [<span class="number">166</span>], [<span class="number">170</span>], [<span class="number">188</span>]]</span><br><span class="line">y_test = [[<span class="number">56</span>], [<span class="number">63</span>], [<span class="number">63</span>], [<span class="number">72</span>], [<span class="number">80</span>]]</span><br><span class="line">print(<span class="string">'Ræ–¹ï¼š '</span>, model.score(x_test, y_test))</span><br></pre></td></tr></table></figure><p>R æ–¹ï¼š  0.898422638707</p><p>R æ–¹æ˜¯ 0.898 è¯´æ˜æµ‹è¯•é›†é‡Œé¢å¤§å¤šæ•°çš„æ•°æ®éƒ½å¯ä»¥é€šè¿‡æ¨¡å‹è§£é‡Š</p><h3>å¤šå…ƒå›å½’</h3><p>å¤šå…ƒå›å½’å³å­˜åœ¨å¤šä¸ªè‡ªå˜é‡ï¼Œæ¯”å¦‚å½±å“ä½“é‡çš„å› ç´ ä¸ä»…ä»…æœ‰èº«é«˜ï¼Œè¿˜æœ‰èƒ¸å›´ï¼Œå‡è®¾ x ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºèº«é«˜ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºèƒ¸å›´ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"><span class="comment">## ä¼ªé€ æ•°æ®</span></span><br><span class="line">x = [[<span class="number">155</span>, <span class="number">80</span>], [<span class="number">157</span>, <span class="number">82</span>], [<span class="number">166</span>, <span class="number">85</span>], [<span class="number">177</span>, <span class="number">90</span>], [<span class="number">187</span>, <span class="number">97</span>]]</span><br><span class="line">y = [[<span class="number">55</span>], [<span class="number">60</span>], [<span class="number">63</span>], [<span class="number">70</span>], [<span class="number">79</span>]]</span><br><span class="line">model = LinearRegression()</span><br><span class="line">model.fit(x, y)</span><br><span class="line"><span class="comment">## ä¼ªé€ æµ‹è¯•é›†</span></span><br><span class="line">x_test = [[<span class="number">156</span>, <span class="number">80</span>], [<span class="number">163</span>, <span class="number">83</span>], [<span class="number">166</span>, <span class="number">84</span>], [<span class="number">170</span>, <span class="number">87</span>], [<span class="number">188</span>, <span class="number">99</span>]]</span><br><span class="line">y_test = [[<span class="number">56</span>], [<span class="number">63</span>], [<span class="number">63</span>], [<span class="number">72</span>], [<span class="number">80</span>]]</span><br><span class="line">predictions = model.predict(x_test)</span><br><span class="line"><span class="keyword">for</span> i, prediction <span class="keyword">in</span> enumerate(predictions):</span><br><span class="line">    print(<span class="string">'Predicted: %.2f, Target: %s'</span> % (prediction, y_test[i]))</span><br><span class="line">print(<span class="string">'R-squared: %.2f'</span> % model.score(x_test, y_test))</span><br></pre></td></tr></table></figure><p>Predicted: 56.05, Target: [56]<br>Predicted: 60.03, Target: [63]<br>Predicted: 61.30, Target: [63]<br>Predicted: 65.56, Target: [72]<br>Predicted: 82.42, Target: [80]<br>R-squared: 0.83</p><h3>å¤šé¡¹å¼å›å½’</h3><p>ä¸Šé¢ä¸¤ä¸ªä¾‹ä¸­ï¼Œéƒ½å‡è®¾è‡ªå˜é‡å’Œå“åº”å˜é‡çš„å…³ç³»æ˜¯çº¿æ€§çš„ã€‚çœŸå®æƒ…å†µæœªå¿…å¦‚æ­¤ï¼Œç°å®ä¸–ç•Œä¸­çš„æ›²çº¿å…³ç³»éƒ½æ˜¯é€šè¿‡å¢åŠ å¤šé¡¹å¼å®ç°çš„ï¼Œå…¶å®ç°æ–¹å¼å’Œå¤šå…ƒçº¿æ€§å›å½’ç±»ä¼¼ã€‚åœ¨ scikit-learn ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <strong>PolynomialFeatures</strong> æ„å»ºå¤šé¡¹å¼å›å½’æ¨¡å‹ã€‚ä¸‹é¢æ¯”è¾ƒå¤šé¡¹å¼å›å½’å’Œçº¿æ€§å›å½’çš„åŒºåˆ«ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> PolynomialFeatures</span><br><span class="line"><span class="comment"># å»ºç«‹çº¿æ€§å›å½’ï¼Œå¹¶ç”¨è®­ç»ƒçš„æ¨¡å‹ç»˜å›¾</span></span><br><span class="line">model = LinearRegression()</span><br><span class="line">model.fit(x, y)</span><br><span class="line">xx = np.linspace(<span class="number">150</span>, <span class="number">190</span>, <span class="number">100</span>)</span><br><span class="line">yy = model.predict(xx.reshape(xx.shape[<span class="number">0</span>], <span class="number">1</span>))</span><br><span class="line">plt = runplt()</span><br><span class="line">plt.plot(x, y, <span class="string">'k.'</span>)</span><br><span class="line">plt.plot(xx, yy)</span><br><span class="line"><span class="comment"># degree=3è¡¨ç¤ºå¤šé¡¹å¼æœ€é«˜é¡¹ä¸º3</span></span><br><span class="line">polynomial_featurizer = PolynomialFeatures(degree=<span class="number">3</span>)</span><br><span class="line">x_train_polynomial = polynomial_featurizer.fit_transform(x)</span><br><span class="line">x_test_polynomial = polynomial_featurizer.transform(x_test)</span><br><span class="line">model_polynomial = LinearRegression()</span><br><span class="line">model_polynomial.fit(x_train_polynomial, y)</span><br><span class="line">xx_polynomial = polynomial_featurizer.transform(xx.reshape(xx.shape[<span class="number">0</span>], <span class="number">1</span>))</span><br><span class="line">plt.plot(xx, model_polynomial.predict(xx_polynomial), <span class="string">'r-'</span>)</span><br><span class="line">plt.show()</span><br><span class="line"><span class="comment"># è¾“å‡ºç»“æœ</span></span><br><span class="line">print(x)</span><br><span class="line">print(x_train_polynomial)</span><br><span class="line">print(x_test)</span><br><span class="line">print(x_test_polynomial)</span><br><span class="line">print(<span class="string">'1 r-squared'</span>, model.score(x_test, y_test))</span><br><span class="line">print(<span class="string">'2 r-squared'</span>, model_polynomial.score(x_test_polynomial, y_test))</span><br></pre></td></tr></table></figure><img src="/assets/img/çº¿æ€§å›å½’_5.jpg" alt="çº¿æ€§å›å½’"><h3>æ‹Ÿåˆè¿‡åº¦</h3><p>æˆ‘ä»¬ä¸æ–­æ”¹å˜ polynomial_featurizer = PolynomialFeatures(degree=3) ä¸­ degree çš„å‚æ•°ï¼Œå½“ degree = 5 çš„æ—¶å€™æ›²çº¿ç»è¿‡æ‰€æœ‰çš„ç‚¹ï¼Œè¿™ç§æƒ…å†µå°±æˆä¸ºæ‹Ÿåˆè¿‡åº¦ï¼ˆover-fittingï¼‰ã€‚å½“æ¨¡å‹å‡ºç°æ‹Ÿåˆè¿‡åº¦çš„æ—¶å€™ï¼Œå¹¶æ²¡æœ‰ä»è¾“å…¥å’Œè¾“å‡ºä¸­æ¨å¯¼å‡ºä¸€èˆ¬çš„è§„å¾‹ï¼Œè€Œæ˜¯è®°å¿†è®­ç»ƒé›†çš„ç»“æœï¼Œè¿™æ ·åœ¨æµ‹è¯•é›†çš„æµ‹è¯•æ•ˆæœå°±ä¸å¥½äº†ã€‚</p><img src="/assets/img/çº¿æ€§å›å½’_6.jpg" alt="çº¿æ€§å›å½’"><p><a href="https://github.com/Leo555/scikit-learn_demo/tree/master/01LinearRegression" target="_blank" rel="noopener">ä»£ç åœ°å€</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;èƒŒæ™¯&lt;/h1&gt;
&lt;p&gt;ä¸Šæ¬¡çš„ ITA é¡¹ç›®å¼€å§‹æ¥è§¦æœºå™¨å­¦ä¹ ç›¸å…³çš„çŸ¥è¯†ï¼Œä»æœ¬æ–‡å¼€å§‹ï¼Œæˆ‘å°†å­¦ä¹ å¹¶ä»‹ç»æœºå™¨å­¦ä¹ æœ€å¸¸ç”¨çš„å‡ ç§ç®—æ³•ï¼Œå¹¶ä½¿ç”¨ &lt;a href=&quot;http://scikit-learn.org/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;scikit-learn&lt;/a&gt; ç›¸å…³æ¨¡å‹å®Œæˆç›¸å…³ç®—æ³•çš„ demoã€‚&lt;/p&gt;
&lt;h1&gt;çº¿æ€§å›å½’&lt;/h1&gt;
&lt;img src=&quot;/assets/img/çº¿æ€§å›å½’.jpg&quot; alt=&quot;çº¿æ€§å›å½’&quot;&gt;
    
    </summary>
    
      <category term="Machine Learning" scheme="https://lz5z.com/categories/Machine-Learning/"/>
    
    
      <category term="Python" scheme="https://lz5z.com/tags/Python/"/>
    
      <category term="Machine Learning" scheme="https://lz5z.com/tags/Machine-Learning/"/>
    
      <category term="scikit-learn" scheme="https://lz5z.com/tags/scikit-learn/"/>
    
  </entry>
  
  <entry>
    <title>JavaScript æ•°æ®ç±»å‹</title>
    <link href="https://lz5z.com/JavaScript%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/"/>
    <id>https://lz5z.com/JavaScriptæ•°æ®ç±»å‹/</id>
    <published>2016-12-27T14:02:32.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<p>JavaScript è¯­è¨€å¯ä»¥è¯†åˆ« 7 ä¸­ä¸åŒçš„æ•°æ®ç±»å‹ï¼Œé™¤ Object å¤–ï¼Œå…¶å®ƒå‡ä¸ºåŸºæœ¬æ•°æ®ç±»å‹ï¼ŒObject ä¸ºå¼•ç”¨æ•°æ®ç±»å‹ã€‚</p><ul><li>Undefined, åªæœ‰ä¸€ä¸ªå€¼ï¼Œå³ç‰¹æ®Šå€¼ undefinedï¼Œä½¿ç”¨ var/let/const å£°æ˜ä½†æœªåˆå§‹åŒ–çš„å€¼ã€‚</li><li>Nullï¼Œåªæœ‰ä¸€ä¸ªå€¼ï¼Œå³ç‰¹æ®Šå€¼ nullï¼Œnull å€¼è¡¨ç¤ºä¸€ä¸ªç©ºå¯¹è±¡æŒ‡é’ˆã€‚</li><li>Booleanï¼Œå¸ƒå°”å‹ï¼Œtrue å’Œ falseã€‚</li><li>Number, æ•´æ•°å’Œæµ®ç‚¹æ•°ã€‚</li><li>String, å­—ç¬¦ä¸²ï¼Œç”±é›¶ä¸ªæˆ–è€…å¤šä¸ª 16 ä½ Unicode å­—ç¬¦ä¸²ç»„æˆçš„å­—ç¬¦åºåˆ—ã€‚</li><li>Symbol, ES6 æ–°å¢ç±»å‹ï¼Œå®ƒçš„å®ä¾‹æ˜¯å”¯ä¸€ä¸”ä¸å¯æ”¹å˜çš„ã€‚</li><li>Object, ä¸€ç»„æ•°æ®å’ŒåŠŸèƒ½çš„é›†åˆã€‚å¯ä»¥é€šè¿‡ new åŠ å¯¹è±¡åç§°åˆ›å»ºã€‚</li></ul><a id="more"></a><h3>Undefined ç±»å‹</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> message <span class="comment">// å˜é‡å£°æ˜ä¹‹åé»˜è®¤å–å¾—äº† undefined å€¼</span></span><br><span class="line">message == <span class="literal">undefined</span> <span class="comment">// true</span></span><br><span class="line">message === <span class="literal">undefined</span> <span class="comment">// true</span></span><br></pre></td></tr></table></figure><h3>Null ç±»å‹</h3><p>Null ç±»å‹åªæœ‰ä¸€ä¸ªå€¼ nullï¼Œnull è¡¨ç¤ºä¸€ä¸ªç©ºæŒ‡é’ˆå¯¹è±¡ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typeof</span> <span class="literal">null</span> <span class="comment">// "objec"</span></span><br></pre></td></tr></table></figure><p>å¦‚æœå®šä¹‰å˜é‡å‡†å¤‡åœ¨å°†æ¥ä¿å­˜å¯¹è±¡ï¼Œæœ€å¥½è®²è¯¥å˜é‡åˆå§‹åŒ–ä¸º nullï¼Œè¿™æ ·å¯ä»¥é€šè¿‡æ£€æŸ¥ null æ¥åˆ¤æ–­æ˜¯å¦å·²ç»ä¿å­˜äº†ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ã€‚</p><p>å®é™…ä¸Šï¼Œundefined å€¼æ´¾ç”Ÿè‡ª null</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">null</span> == <span class="literal">undefined</span> <span class="comment">// true</span></span><br><span class="line"><span class="literal">null</span> === <span class="literal">undefined</span> <span class="comment">// false</span></span><br></pre></td></tr></table></figure><p>null vs undefined</p><p>å°½ç®¡ null å’Œ undefined ä¹‹é—´çš„ç›¸ç­‰æ“ä½œç¬¦ï¼ˆ==ï¼‰è¿”å› trueï¼Œä¸è¿‡å®ƒä»¬çš„ç”¨é€”å®Œå…¨ä¸åŒï¼Œå¦‚å‰æ‰€è¿°ï¼Œæ— è®ºä»€ä¹ˆæƒ…å†µä¸‹ï¼Œæ²¡æœ‰å¿…è¦æŠŠä¸€ä¸ªå˜é‡çš„å€¼è®¾ä¸º undefinedï¼Œè€Œå¦‚æœä¸€ä¸ªå˜é‡å°†æ¥è¦ä¿å­˜å¯¹è±¡ï¼Œåº”è¯¥å°†å…¶æ˜¾å¼åœ°è®¾ä¸º nullã€‚</p><h3>Boolean ç±»å‹</h3><p>å¯¹äºä»»ä½•æ•°æ®ç±»å‹ï¼Œè°ƒç”¨ Boolean() å‡½æ•°ï¼Œæ€»æ˜¯ä¼šè¿”å›ä¸€ä¸ª Boolean å€¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Boolean</span>(<span class="number">0</span>) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Boolean</span>(<span class="literal">NaN</span>) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Boolean</span>(<span class="literal">null</span>) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Boolean</span>(<span class="literal">undefined</span>) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Boolean</span>(<span class="string">'/t'</span>) <span class="comment">// false</span></span><br></pre></td></tr></table></figure><h3>Number ç±»å‹</h3><p>(1) æ•´æ•°ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> intNum = <span class="number">55</span></span><br><span class="line"><span class="keyword">var</span> octalNum = <span class="number">070</span> <span class="comment">// å…«è¿›åˆ¶çš„ 56</span></span><br><span class="line"><span class="keyword">var</span> hexNum = <span class="number">0xA</span> <span class="comment">// åå…­è¿›åˆ¶çš„ 10</span></span><br><span class="line"></span><br><span class="line">+<span class="number">0</span> === <span class="number">-0</span> <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>(2) æµ®ç‚¹æ•°ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3e-17</span> <span class="comment">// 0.000...03</span></span><br><span class="line"></span><br><span class="line"><span class="number">0.1</span> + <span class="number">0.2</span> <span class="comment">// 0.30000000000000004 æµ®ç‚¹æ•°æœ€é«˜ç²¾åº¦ä¸º 17 ä½å°æ•°</span></span><br><span class="line"><span class="number">0.1</span> + <span class="number">0.2</span> === <span class="number">0.3</span> <span class="comment">// false</span></span><br></pre></td></tr></table></figure><p>ECMAScript æœ€å°æ•°ï¼šNumber.MIN_VALUEï¼Œåœ¨å¤§å¤šæ•°æµè§ˆå™¨ä¸­ä¸º 5e-324ã€‚<br>ECMAScript æœ€å¤§æ•°ï¼šNumber.MAX_VALUEï¼Œåœ¨å¤§å¤šæ•°æµè§ˆå™¨ä¸­ä¸º 1.7976931348623157e+308ã€‚</p><p>å¦‚æœè®¡ç®—è¶…è¿‡ JavaScript æ•°å€¼èŒƒå›´ï¼Œä¼šè‡ªåŠ¨è½¬ä¸ºç‰¹æ®Šçš„ Infinity å€¼ï¼Œè´Ÿæ•°åˆ™ä¸º -Infinityã€‚Infinity ä¸èƒ½å‚ä¸æ•°å€¼è®¡ç®—ã€‚é€šè¿‡ isFinite() å‡½æ•°åˆ¤æ–­å‚æ•°æ˜¯å¦ä½äºæœ€å¤§å€¼å’Œæœ€å°å€¼ä¹‹é—´ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> / <span class="number">0</span> <span class="comment">// Infinity</span></span><br><span class="line"><span class="built_in">isFinite</span>(<span class="built_in">Number</span>.MAX_VALUE + <span class="built_in">Number</span>.MAX_VALUE) <span class="comment">// false</span></span><br></pre></td></tr></table></figure><p>(3) NaN ï¼ˆNot a Numberï¼‰</p><p>NaN ç”¨æ¥è¡¨ç¤ºæœ¬æ¥è¦è¿”å›æ•°å€¼çš„æ“ä½œæ•°æœªè¿”å›æ•°å€¼çš„æƒ…å†µï¼Œé¿å…æŠ›å‡ºé”™è¯¯ã€‚</p><p>NaN çš„è®¾è®¡æœ‰ä¸¤ä¸ªç‰¹ç‚¹ï¼š</p><p>1.ä»»ä½•æ¶‰åŠ NaN çš„æ“ä½œéƒ½è¿”å› NaN<br>2.NaNä¸ä»»ä½•å€¼éƒ½ä¸ç›¸ç­‰ï¼ŒåŒ…æ‹¬ NaN æœ¬èº«</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>/<span class="number">0</span> <span class="comment">// NaN</span></span><br><span class="line"><span class="literal">NaN</span>/<span class="number">10</span> <span class="comment">// NaN</span></span><br><span class="line"><span class="literal">NaN</span> == <span class="literal">NaN</span> <span class="comment">// false</span></span><br></pre></td></tr></table></figure><p>é’ˆå¯¹è¿™ä¸¤ä¸ªç‰¹ç‚¹ï¼ŒECMAScript è®¾è®¡äº† isNaN() å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°å¸®åŠ©æˆ‘ä»¬åˆ¤æ–­å‚æ•°æ˜¯å¦ â€œä¸æ˜¯æ•°å€¼â€ã€‚isNaN() æ¥å—å‚æ•°åï¼Œä¼šå°è¯•å°†è¿™ä¸ªå€¼è½¬æ¢ä¸ºæ•°å€¼ï¼Œå¦‚æœè¿™ä¸ªå€¼ä¸èƒ½è¢«è½¬æ¢ä¸ºæ•°å€¼ï¼Œåˆ™è¿”å› trueã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">isNaN</span>(<span class="literal">NaN</span>) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">isNaN</span>(<span class="number">10</span>) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">isNaN</span>(<span class="string">'10'</span>) <span class="comment">// false å¯ä»¥è½¬æ¢ä¸ºæ•°å€¼ 10</span></span><br><span class="line"><span class="built_in">isNaN</span>(<span class="string">'blue'</span>) <span class="comment">// true ä¸èƒ½è½¬æ¢ä¸ºæ•°å€¼</span></span><br><span class="line"><span class="built_in">isNaN</span>(<span class="literal">true</span>) <span class="comment">// false å¯ä»¥è½¬æ¢ä¸ºæ•°å€¼ 1</span></span><br></pre></td></tr></table></figure><p>(4) æ•°å€¼è½¬æ¢</p><p>Number() å‡½æ•°è½¬æ¢è§„åˆ™å¦‚ä¸‹ï¼š</p><p>1.å¦‚æœæ˜¯ Boolean å€¼ï¼Œè¿”å› 1 æˆ–è€… 0ã€‚<br>2.æ•°å­—ç›´æ¥è¿”å›ã€‚<br>3.null è¿”å› 0ã€‚<br>4.undefined è¿”å› NaNã€‚<br>5.å­—ç¬¦ä¸²ï¼šå¦‚æœæ˜¯åè¿›åˆ¶æ•´æ•°ï¼Œå…«è¿›åˆ¶æ•´æ•°æˆ–è€…åå…­è¿›åˆ¶æ•´æ•°è¿”å›åè¿›åˆ¶æ•´æ•°ï¼Œç©ºå­—ç¬¦ä¸²è¿”å› 0ï¼Œå…¶å®ƒå‡è¿”å› NaNã€‚<br>6.å¦‚æœæ˜¯å¯¹è±¡ï¼Œè°ƒç”¨å¯¹è±¡çš„ valueOf() æ–¹æ³•ï¼Œç„¶åæŒ‰ç…§å‰é¢çš„è½¬æ¢è§„åˆ™è½¬æ¢ï¼Œå¦‚æœè½¬æ¢å€¼ä¸º NaNï¼Œåˆ™è°ƒç”¨å¯¹è±¡çš„ toString() æ–¹æ³•ã€‚</p><p>parseInt()</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">parseInt</span>(<span class="string">'1234blue'</span>) <span class="comment">// 1234</span></span><br><span class="line"><span class="built_in">parseInt</span>(<span class="string">''</span>) <span class="comment">// NaN</span></span><br><span class="line"><span class="built_in">parseInt</span>(<span class="string">'0xA'</span>) <span class="comment">// 10</span></span><br><span class="line"><span class="built_in">parseInt</span>(<span class="number">22.5</span>) <span class="comment">// 22</span></span><br><span class="line"><span class="built_in">parseInt</span>(<span class="number">070</span>) <span class="comment">// 56</span></span><br></pre></td></tr></table></figure><p>parseInt() è§£æå…«è¿›åˆ¶å­—é¢é‡çš„å­—ç¬¦ä¸²æ—¶ï¼ŒES3 å’Œ ES5 å­˜åœ¨åŒºåˆ«ï¼Œåœ¨ ES3 ä¸­ â€˜070â€™ è¢«å½“åšå…«è¿›åˆ¶å­—é¢é‡ï¼ŒES5 åˆ™å½“åš â€˜70â€™ã€‚<br>å› æ­¤ parseInt å¯ä»¥æ¥æ”¶ç¬¬äºŒä¸ªå‚æ•°ï¼Œè¡¨ç¤ºä»¥å¤šå°‘è¿›åˆ¶è§£æç¬¬ä¸€ä¸ªå‚æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">parseInt</span>(<span class="string">'0xAF'</span>, <span class="number">16</span>) <span class="comment">// 175</span></span><br><span class="line"><span class="built_in">parseInt</span>(<span class="string">'070'</span>) <span class="comment">// 70</span></span><br><span class="line"><span class="built_in">parseInt</span>(<span class="string">'070'</span>, <span class="number">8</span>) <span class="comment">// 56</span></span><br></pre></td></tr></table></figure><h3>Symbol ç±»å‹</h3><p>Symbol æ˜¯ ES6 æ–°å¢çš„æ•°æ®ç±»å‹ï¼Œç”¨æ¥è§£å†³å¯¹è±¡ä¸­å±æ€§åé‡å¤çš„é—®é¢˜ï¼ŒSymbol è¡¨ç¤ºç‹¬ä¸€æ— äºŒçš„å€¼ï¼Œé€šè¿‡ Symbol å‡½æ•°ç”Ÿæˆã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Symbol</span>(<span class="string">"foo"</span>) !== <span class="built_in">Symbol</span>(<span class="string">"foo"</span>) <span class="comment">// true</span></span><br><span class="line"><span class="keyword">const</span> foo = <span class="built_in">Symbol</span>()</span><br><span class="line"><span class="keyword">const</span> bar = <span class="built_in">Symbol</span>()</span><br><span class="line"><span class="keyword">typeof</span> foo === <span class="string">"symbol"</span> <span class="comment">// true</span></span><br><span class="line"><span class="keyword">typeof</span> bar === <span class="string">"symbol"</span> <span class="comment">// true</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123;&#125;</span><br><span class="line">obj[foo] = <span class="string">"foo"</span></span><br><span class="line">obj[bar] = <span class="string">"bar"</span></span><br><span class="line"><span class="built_in">JSON</span>.stringify(obj) <span class="comment">// &#123;&#125;</span></span><br><span class="line"><span class="built_in">Object</span>.keys(obj) <span class="comment">// []</span></span><br><span class="line"><span class="built_in">Object</span>.getOwnPropertyNames(obj) <span class="comment">// []</span></span><br><span class="line"><span class="built_in">Object</span>.getOwnPropertySymbols(obj) <span class="comment">// [ foo, bar ]</span></span><br></pre></td></tr></table></figure><h3>Object ç±»å‹</h3><p>Object å¯¹è±¡æ˜¯ä¸€ç»„æ•°æ®å’ŒåŠŸèƒ½çš„é›†åˆã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = <span class="keyword">new</span> <span class="built_in">Object</span>()</span><br><span class="line"><span class="keyword">var</span> o = <span class="keyword">new</span> <span class="built_in">Object</span></span><br></pre></td></tr></table></figure><p>å…³äº Object å¯¹è±¡çš„è¯¦ç»†å†…å®¹ï¼Œå¯ä»¥å‚è€ƒ <a href="https://lz5z.com/JavaScript%E4%B8%AD%E7%9A%84Object%E5%AF%B9%E8%B1%A1/">æ·±å…¥å­¦ä¹ JavaScriptâ€”â€”Objectå¯¹è±¡</a> å’Œ <a href="https://lz5z.com/Object.defineProperty%E4%B8%BA%E5%AF%B9%E8%B1%A1%E5%AE%9A%E4%B9%89%E5%B1%9E%E6%80%A7/">ä½¿ç”¨ Object.defineProperty ä¸ºå¯¹è±¡å®šä¹‰å±æ€§</a>ã€‚</p><h3>å¦‚ä½•åˆ¤æ–­æ•°æ®ç±»å‹</h3><p>(1) typeof æ“ä½œç¬¦</p><p>typeof æ“ä½œç¬¦è¿”å›å€¼ä¸€å…±æœ‰7ç§ï¼šnumberï¼Œbooleanï¼Œsymbolï¼Œstringï¼Œobjectï¼Œundefinedï¼Œfunctionã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typeof</span> <span class="string">''</span> <span class="comment">// string æœ‰æ•ˆ</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="number">1</span> <span class="comment">// number æœ‰æ•ˆ</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="built_in">Symbol</span>() <span class="comment">// symbol æœ‰æ•ˆ</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="literal">true</span> <span class="comment">//boolean æœ‰æ•ˆ</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="literal">undefined</span> <span class="comment">//undefined æœ‰æ•ˆ</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="literal">null</span> <span class="comment">//object æ— æ•ˆ</span></span><br><span class="line"><span class="keyword">typeof</span> [] <span class="comment">//object æ— æ•ˆ</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="keyword">new</span> <span class="built_in">Function</span>() <span class="comment">// function æœ‰æ•ˆ</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="keyword">new</span> <span class="built_in">Date</span>() <span class="comment">//object æ— æ•ˆ</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="keyword">new</span> <span class="built_in">RegExp</span>() <span class="comment">//object æ— æ•ˆ</span></span><br></pre></td></tr></table></figure><ul><li>å¯¹äºåŸºæœ¬ç±»å‹ï¼Œé™¤ null ä»¥å¤–ï¼Œå‡å¯ä»¥è¿”å›æ­£ç¡®çš„ç»“æœã€‚</li><li>å¯¹äºå¼•ç”¨ç±»å‹ï¼Œé™¤ function ä»¥å¤–ï¼Œä¸€å¾‹è¿”å› object ç±»å‹ã€‚</li><li>å¯¹äº null ï¼Œè¿”å› object ç±»å‹ã€‚</li><li>å¯¹äº function è¿”å›  function ç±»å‹ã€‚</li></ul><p>(2) instanceof</p><p>instanceof ç”¨æ¥åˆ¤æ–­ A æ˜¯å¦ä¸º B çš„å®ä¾‹ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œinstanceof æ£€æµ‹çš„æ˜¯åŸå‹ã€‚</p><p>å¯ä»¥ç†è§£ä¸ºï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">instanceof</span> (A, B) &#123;</span><br><span class="line">  <span class="keyword">var</span> L = A.__proto__</span><br><span class="line">  <span class="keyword">var</span> R = B.prototype</span><br><span class="line">  <span class="keyword">return</span> L === R    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[] <span class="keyword">instanceof</span> <span class="built_in">Array</span> <span class="comment">// true</span></span><br><span class="line">&#123;&#125; <span class="keyword">instanceof</span> <span class="built_in">Object</span> <span class="comment">// true</span></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Date</span>() <span class="keyword">instanceof</span> <span class="built_in">Date</span> <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">A</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="keyword">new</span> A() <span class="keyword">instanceof</span> A <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">[] <span class="keyword">instanceof</span> <span class="built_in">Object</span> <span class="comment">// true</span></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Date</span>() <span class="keyword">instanceof</span> <span class="built_in">Object</span> <span class="comment">// true</span></span><br><span class="line"><span class="keyword">new</span> A() <span class="keyword">instanceof</span> <span class="built_in">Object</span> <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>[] çš„ <code>__proto__</code> æŒ‡å‘äº† Array.prototypeï¼Œè€Œ <code>Array.prototype.__proto__</code> åˆæŒ‡å‘äº† Object.prototypeï¼Œè€Œ <code>Object.prototype.__proto__</code> æŒ‡å‘äº† nullï¼Œå› æ­¤ []ã€Arrayã€Object åœ¨å†…éƒ¨å½¢æˆäº†ä¸€æ¡åŸå‹é“¾ã€‚instanceof åªèƒ½ç”¨æ¥åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦å±äºå®ä¾‹å…³ç³»ï¼Œè€Œä¸èƒ½åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡å®ä¾‹å…·ä½“å±äºå“ªç§ç±»å‹ã€‚</p><p>(3) constructor</p><p>å½“ä¸€ä¸ªå‡½æ•° F è¢«å®šä¹‰çš„æ—¶å€™ï¼ŒJS å¼•æ“ä¼šè‡ªåŠ¨å¸®å…¶æ·»åŠ  prototypeï¼Œå¹¶åœ¨ prototype ä¸Šæ·»åŠ ä¸€ä¸ª constructor å±æ€§ï¼Œå¹¶è®©å…¶æŒ‡å‘ F çš„å¼•ç”¨ã€‚</p><img src="/assets/img/js_constructor.png" alt="js_constructor"><p>å½“å®ä¾‹åŒ– F çš„æ—¶å€™ï¼Œ<code>var f = new F()</code>ï¼ŒF åŸå‹ä¸Šçš„ constructor ä¼ é€’åˆ°äº† f ä¸Šï¼Œå› æ­¤ <code>f.constructor === F</code>ã€‚</p><p>F åˆ©ç”¨åŸå‹å¯¹è±¡ä¸Šçš„ constructor å¼•ç”¨äº†è‡ªèº«ï¼Œå½“ F ä½œä¸ºæ„é€ å‡½æ•°æ¥åˆ›å»ºå¯¹è±¡æ—¶ï¼ŒåŸå‹ä¸Šçš„ constructor å°±è¢«é—ä¼ åˆ°äº†æ–°åˆ›å»ºçš„å¯¹è±¡ä¸Šï¼Œ ä»åŸå‹é“¾è§’åº¦è®²ï¼Œæ„é€ å‡½æ•° F å°±æ˜¯æ–°å¯¹è±¡çš„ç±»å‹ã€‚è¿™æ ·åšçš„æ„ä¹‰æ˜¯ï¼Œè®©æ–°å¯¹è±¡åœ¨è¯ç”Ÿä»¥åï¼Œå°±å…·æœ‰å¯è¿½æº¯çš„æ•°æ®ç±»å‹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">''</span>.constructor === <span class="built_in">String</span></span><br><span class="line">(<span class="number">1</span>).constructor === <span class="built_in">Number</span></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Number</span>(<span class="number">1</span>).constructor === <span class="built_in">Number</span></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Function</span>().constructor === <span class="built_in">Function</span></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Date</span>().constructor === <span class="built_in">Date</span></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Error</span>().constructor === <span class="built_in">Error</span></span><br><span class="line">[].constructor === <span class="built_in">Array</span></span><br><span class="line"><span class="built_in">document</span>.constructor === HTMLDocument</span><br><span class="line"><span class="built_in">window</span>.constructor === Window</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨ constructor åˆ¤æ–­æ•°æ®ç±»å‹å­˜åœ¨çš„é—®é¢˜ï¼š</p><ol><li>null å’Œ undefined æ˜¯æ— æ•ˆå¯¹è±¡ï¼Œå› æ­¤æ²¡æœ‰ constructor å­˜åœ¨ã€‚</li><li>å‡½æ•°çš„ constructor å¯ä»¥è¢«é‡å†™ï¼Œå› æ­¤å¯èƒ½ä¼šå‡ºç°åˆ¤æ–­é”™è¯¯ã€‚</li></ol><p>(4) toString</p><p>toString() æ˜¯ Object çš„åŸå‹æ–¹å¼ï¼Œè°ƒç”¨è¯¥æ–¹æ³•ï¼Œé»˜è®¤è¿”å›å½“å‰å¯¹è±¡çš„ <code>[[CLass]]</code>ï¼Œå…¶æ ¼å¼ä¸º [object Xxx]ï¼Œå…¶ä¸­ Xxx å°±æ˜¯å¯¹è±¡çš„ç±»å‹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="string">''</span>) <span class="comment">// [object String]</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="number">1</span>) <span class="comment">// [object Number]</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="literal">true</span>) <span class="comment">// [object Boolean]</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="built_in">Symbol</span>()) <span class="comment">//[object Symbol]</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="literal">undefined</span>) <span class="comment">// [object Undefined]</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="literal">null</span>) <span class="comment">// [object Null]</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="keyword">new</span> <span class="built_in">Function</span>()) <span class="comment">// [object Function]</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="keyword">new</span> <span class="built_in">Date</span>()) <span class="comment">// [object Date]</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call([]) <span class="comment">// [object Array]</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="keyword">new</span> <span class="built_in">RegExp</span>()) <span class="comment">// [object RegExp]</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="keyword">new</span> <span class="built_in">Error</span>()) <span class="comment">// [object Error]</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="built_in">document</span>) <span class="comment">// [object HTMLDocument]</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="built_in">window</span>) <span class="comment">// [object Window]</span></span><br></pre></td></tr></table></figure><h2>å¼•ç”¨æ•°æ®ç±»å‹ vs åŸºæœ¬æ•°æ®ç±»å‹</h2><p>åŸºæœ¬æ•°æ®ç±»å‹å¤åˆ¶ç›¸å½“äºåœ¨å†…å­˜ä¸­æ–°å¼€è¾Ÿä¸€å—å†…å­˜ï¼Œå¼•ç”¨æ•°æ®ç±»å‹çš„å¤åˆ¶ç›¸å½“äºåœ¨å†…å­˜ä¸­åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„æŒ‡é’ˆï¼ŒæŒ‡å‘å­˜å‚¨åœ¨å †ä¸­çš„ä¸€ä¸ªå¯¹è±¡ã€‚</p><p>ECMAScript ä¸­æ‰€æœ‰çš„å‡½æ•°éƒ½æ˜¯ <strong>æŒ‰å€¼ä¼ é€’å‚æ•°</strong> çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒæŠŠå‡½æ•°å¤–éƒ¨çš„å€¼å¤åˆ¶ç»™å‡½æ•°å†…éƒ¨çš„å‚æ•°ï¼Œå°±å’ŒæŠŠå€¼ä»ä¸€ä¸ªå˜é‡å¤åˆ¶åˆ°å¦å¤–ä¸€ä¸ªå˜é‡ä¸€æ ·ã€‚<br>åœ¨å‘å‚æ•°ä¼ é€’åŸºæœ¬æ•°æ®ç±»å‹çš„å€¼æ—¶ï¼Œè¢«ä¼ é€’çš„å€¼ä¼šè¢«å¤åˆ¶ç»™ä¸€ä¸ªå±€éƒ¨å˜é‡ï¼ˆå³å‘½åå‚æ•°ï¼Œä¹Ÿå°±æ˜¯ arguments å¯¹è±¡ä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼‰ã€‚åœ¨å‘å‚æ•°ä¼ é€’å¼•ç”¨ç±»å‹çš„å€¼æ—¶ï¼Œä¼šæŠŠè¿™ä¸ªå€¼åœ¨å†…å­˜ä¸­çš„åœ°å€å¤åˆ¶ç»™ä¸€ä¸ªå±€éƒ¨å˜é‡ï¼Œå› æ­¤è¿™ä¸ªå±€éƒ¨å˜é‡çš„å˜åŒ–ä¼šåæ˜ åœ¨å‡½æ•°å¤–éƒ¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setName</span> (<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  obj.name = <span class="string">'Leo'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person = <span class="keyword">new</span> <span class="built_in">Object</span>()</span><br><span class="line">setName(person)</span><br><span class="line"><span class="built_in">console</span>.log(person.name) <span class="comment">// "Leo"</span></span><br></pre></td></tr></table></figure><h2>å‚è€ƒèµ„æ–™</h2><ul><li>ã€ŠJavaScripté«˜çº§ç¨‹åºè®¾è®¡ã€‹</li><li><a href="https://www.cnblogs.com/onepixel/p/5126046.html" target="_blank" rel="noopener">åˆ¤æ–­JSæ•°æ®ç±»å‹çš„4ç§æ–¹æ³•</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Grammar_and_types" target="_blank" rel="noopener">è¯­æ³•å’Œæ•°æ®ç±»å‹</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;JavaScript è¯­è¨€å¯ä»¥è¯†åˆ« 7 ä¸­ä¸åŒçš„æ•°æ®ç±»å‹ï¼Œé™¤ Object å¤–ï¼Œå…¶å®ƒå‡ä¸ºåŸºæœ¬æ•°æ®ç±»å‹ï¼ŒObject ä¸ºå¼•ç”¨æ•°æ®ç±»å‹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Undefined, åªæœ‰ä¸€ä¸ªå€¼ï¼Œå³ç‰¹æ®Šå€¼ undefinedï¼Œä½¿ç”¨ var/let/const å£°æ˜ä½†æœªåˆå§‹åŒ–çš„å€¼ã€‚&lt;/li&gt;
&lt;li&gt;Nullï¼Œåªæœ‰ä¸€ä¸ªå€¼ï¼Œå³ç‰¹æ®Šå€¼ nullï¼Œnull å€¼è¡¨ç¤ºä¸€ä¸ªç©ºå¯¹è±¡æŒ‡é’ˆã€‚&lt;/li&gt;
&lt;li&gt;Booleanï¼Œå¸ƒå°”å‹ï¼Œtrue å’Œ falseã€‚&lt;/li&gt;
&lt;li&gt;Number, æ•´æ•°å’Œæµ®ç‚¹æ•°ã€‚&lt;/li&gt;
&lt;li&gt;String, å­—ç¬¦ä¸²ï¼Œç”±é›¶ä¸ªæˆ–è€…å¤šä¸ª 16 ä½ Unicode å­—ç¬¦ä¸²ç»„æˆçš„å­—ç¬¦åºåˆ—ã€‚&lt;/li&gt;
&lt;li&gt;Symbol, ES6 æ–°å¢ç±»å‹ï¼Œå®ƒçš„å®ä¾‹æ˜¯å”¯ä¸€ä¸”ä¸å¯æ”¹å˜çš„ã€‚&lt;/li&gt;
&lt;li&gt;Object, ä¸€ç»„æ•°æ®å’ŒåŠŸèƒ½çš„é›†åˆã€‚å¯ä»¥é€šè¿‡ new åŠ å¯¹è±¡åç§°åˆ›å»ºã€‚&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="æ•°æ®ç±»å‹" scheme="https://lz5z.com/tags/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/"/>
    
      <category term="typeof" scheme="https://lz5z.com/tags/typeof/"/>
    
  </entry>
  
  <entry>
    <title>async å’Œ defer çš„åŒºåˆ«</title>
    <link href="https://lz5z.com/async%E5%92%8Cdefer%E7%9A%84%E5%8C%BA%E5%88%AB/"/>
    <id>https://lz5z.com/asyncå’Œdeferçš„åŒºåˆ«/</id>
    <published>2016-12-26T15:43:58.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<p>HTML ä¸­çš„ <code>&lt;script&gt;</code> å…ƒç´ å®šä¹‰äº†6ä¸ªå±æ€§ï¼š</p><ul><li>asyncï¼šå¯é€‰ï¼Œè¡¨ç¤ºç«‹å³ä¸‹è½½è„šæœ¬ï¼Œä½†ä¸åº”è¯¥å¦¨ç¢é¡µé¢ä¸­å…¶å®ƒçš„æ“ä½œï¼Œæ¯”å¦‚ä¸‹è½½å…¶å®ƒèµ„æºæˆ–è€…ç­‰å¾…åŠ è½½å…¶å®ƒè„šæœ¬ï¼Œåªå¯¹å¤–éƒ¨è„šæœ¬æ–‡ä»¶æœ‰æ•ˆã€‚</li><li>charsetï¼šå¯é€‰ï¼Œsrc å±æ€§æŒ‡å®šçš„ä»£ç çš„å­—ç¬¦é›†ã€‚å¤šæ•°æµè§ˆå™¨ä¼šå¿½ç•¥å®ƒçš„å€¼ã€‚</li><li>deferï¼šå¯é€‰ï¼Œè¡¨ç¤ºè„šæœ¬å¯ä»¥å»¶è¿Ÿåˆ°æ–‡æ¡£å®Œå…¨è¢«è§£æå’Œæ˜¾ç¤ºåå†æ‰§è¡Œã€‚åªå¯¹å¤–éƒ¨è„šæœ¬æœ‰æ•ˆã€‚</li><li>languageï¼šå·²åºŸå¼ƒã€‚</li><li>srcï¼šå¯é€‰ï¼Œè¡¨ç¤ºè¦æ‰§è¡Œä»£ç çš„å¤–éƒ¨æ–‡ä»¶ã€‚src å¯ä»¥åŒ…å«æ¥è‡ªå¤–éƒ¨åŸŸçš„æ–‡ä»¶ã€‚</li><li>typeï¼šå¯é€‰ï¼Œå¯ä»¥çœ‹æˆ language çš„æ›¿ä»£å±æ€§ã€‚è¡¨ç¤ºç¼–å†™ä»£ç ä½¿ç”¨çš„è„šæœ¬è¯­è¨€çš„å†…å®¹ç±»å‹ï¼ˆMIMEï¼‰ï¼Œé»˜è®¤å€¼ä¸º text/javascriptã€‚</li></ul><p>è¦æ³¨æ„çš„æ˜¯ï¼Œå¸¦æœ‰ src çš„ <code>&lt;script&gt;</code> å…ƒç´ ä¸­ä¸åº”è¯¥å†åŒ…å«é¢å¤–çš„ä»£ç ï¼Œå¦‚æœåŒ…å«äº†åµŒå…¥çš„ä»£ç ï¼Œåˆ™åªä¼šä¸‹è½½å¤–éƒ¨æ–‡ä»¶ï¼ŒåµŒå…¥çš„ä»£ç ä¸ä¼šæ‰§è¡Œã€‚</p><a id="more"></a><h2>æ ‡ç­¾çš„ä½ç½®</h2><p>æŒ‰ç…§æƒ¯ä¾‹ï¼Œæ‰€æœ‰çš„ <code>&lt;script&gt;</code> éƒ½åº”è¯¥æ”¾å…¥ <code>&lt;head&gt;</code> ä¸­ï¼Œä½†æ˜¯è¿™å°±æ„å‘³ç€å¿…é¡»è¦ç­‰æ‰€æœ‰çš„ JavaScript ä»£ç ä¸‹è½½è§£æå’Œæ‰§è¡Œå®Œæ¯•åæ‰èƒ½å¼€å§‹å‘ˆç°é¡µé¢å†…å®¹ï¼ˆæµè§ˆå™¨åœ¨é‡åˆ° body æ ‡ç­¾æ—¶ï¼Œæ‰å¼€å§‹å‘ˆç°é¡µé¢å†…å®¹ï¼‰ã€‚å‡å¦‚æœ‰å¾ˆå¤š JavaScript ä»£ç éœ€è¦æ‰§è¡Œçš„è¯ï¼Œå°±ä¼šå¯¼è‡´æµè§ˆå™¨çª—å£å‡ºç°ç©ºç™½ï¼Œå› æ­¤æ¯”è¾ƒå¥½çš„åšæ³•æ˜¯æŠŠ JavaScript ä»£ç æ”¾åœ¨ <code>&lt;body&gt;</code> çš„æœ€åã€‚</p><h2>å»¶è¿Ÿè„šæœ¬ defer</h2><p>HTML4.01 ä¸­ä¸º <code>&lt;script&gt;</code> å¢åŠ äº† defer å±æ€§ï¼Œè¿™ä¸ªå±æ€§ç”¨æ¥è¡¨æ˜è„šæœ¬æ‰§è¡Œçš„æ—¶å€™ä¸ä¼šå½±å“é¡µé¢ç»“æ„ï¼Œä¹Ÿå°±æ˜¯è¯´è„šæœ¬ä¼šå»¶è¿Ÿåˆ°æ•´é¡µé¢è§£æå®Œæ¯•åå†è¿è¡Œã€‚å› æ­¤åœ¨ <code>&lt;script&gt;</code> ä¸­è®¾ç½® defer å±æ€§ï¼Œç›¸å½“äºå‘Šè¯‰æµè§ˆå™¨ï¼Œç«‹å³ä¸‹è½½ï¼Œä½†å»¶è¿Ÿæ‰§è¡Œã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">defer</span> <span class="attr">src</span>=<span class="string">"./a.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">defer</span> <span class="attr">src</span>=<span class="string">"./b.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span>&gt;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè™½ç„¶ <code>&lt;script&gt;</code> æ”¾åœ¨äº† head ä¸­ï¼Œä½†æ˜¯å…¶ä¸­åŒ…å«çš„è„šæœ¬å°†å»¶è¿Ÿåˆ°æµè§ˆå™¨è§£æåˆ° <code>&lt;/html&gt;</code> æ ‡ç­¾æ‰ä¼šå¼€å§‹æ‰§è¡Œã€‚HTML5 è§„èŒƒè¦æ±‚è„šæœ¬æŒ‰ç…§ä»–ä»¬å‡ºç°çš„å…ˆåé¡ºåºæ‰§è¡Œï¼Œå› æ­¤ç¬¬ä¸€ä¸ªå»¶è¿Ÿè„šæœ¬ a.js ä¼šä¼˜å…ˆäº b.js æ‰§è¡Œï¼Œè€Œè¿™ä¸¤ä¸ªè„šæœ¬ä¼šå…ˆäº <a href="https://developer.mozilla.org/zh-CN/docs/Web/Events/DOMContentLoaded" target="_blank" rel="noopener">DOMContentLoaded</a> äº‹ä»¶æ‰§è¡Œã€‚åœ¨ç°å®ä¸­ï¼Œå»¶è¿Ÿè„šæœ¬ä¸ä¸€å®šä¼šæŒ‰ç…§é¡ºåºæ‰§è¡Œï¼Œä¹Ÿä¸ä¸€å®šä¼šåœ¨ DOMContentLoaded äº‹ä»¶è§¦å‘ä¹‹å‰æ‰§è¡Œï¼Œå› æ­¤æœ€å¥½åªåŒ…å«ä¸€ä¸ªå»¶è¿Ÿè„šæœ¬ã€‚</p><p>defer å±æ€§åªé€‚ç”¨äºå¤–éƒ¨è„šæœ¬æ–‡ä»¶ï¼Œå› æ­¤åµŒå…¥è„šæœ¬çš„ defer å±æ€§ä¼šè¢«æµè§ˆå™¨å¿½ç•¥ï¼Œè€Œä¸”å„ä¸ªæµè§ˆå™¨å¯¹ defer å±æ€§çš„å¤„ç†ä¸å°½ç›¸åŒï¼Œå› æ­¤æŠŠå»¶è¿Ÿè„šæœ¬æ”¾åœ¨é¡µé¢åº•éƒ¨ä»æ˜¯æœ€ä½³é€‰æ‹©ã€‚</p><blockquote><p>åœ¨ XHTML æ–‡æ¡£ä¸­ï¼Œè¦æŠŠ defer å±æ€§è®¾ç½®ä¸º defer=â€œdeferâ€</p></blockquote><h2>å¼‚æ­¥è„šæœ¬ async</h2><p>HTML5 ä¸º <code>&lt;script&gt;</code> å…ƒç´ å®šä¹‰äº† async å±æ€§ã€‚async åªé€‚ç”¨äºå¤–éƒ¨è„šæœ¬æ–‡ä»¶ï¼Œå¹¶ä¸”å‘Šè¯‰æµè§ˆå™¨ç«‹å³ä¸‹è½½æ–‡ä»¶ã€‚ä½†ä¸ defer ä¸åŒçš„æ˜¯ï¼Œæ ‡è®°ä¸º async çš„è„šæœ¬å¹¶ä¸èƒ½ä¿è¯æŒ‰ç…§æŒ‡å®šå®ƒä»¬çš„å…ˆåé¡ºåºæ‰§è¡Œã€‚ä¾‹å¦‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scrpt</span> <span class="attr">async</span> <span class="attr">src</span>=<span class="string">"a.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">scrpt</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scrpt</span> <span class="attr">async</span> <span class="attr">src</span>=<span class="string">"b.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">scrpt</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œb.js å¯èƒ½ä¼šåœ¨ a.js ä¹‹å‰æ‰§è¡Œï¼Œå› æ­¤ï¼Œç¡®ä¿ä¸¤è€…ä¹‹é—´äº’ä¸ä¾èµ–éå¸¸é‡è¦ï¼ŒæŒ‡å®š async å±æ€§çš„ç›®çš„æ˜¯ä¸è®©é¡µé¢ç­‰å¾…ä¸¤ä¸ªè„šæœ¬ä¸‹è½½å’Œæ‰§è¡Œï¼Œä»è€Œå¼‚æ­¥è„šåœ¨é¡µé¢å…¶å®ƒå†…å®¹ã€‚å› æ­¤ï¼Œå»ºè®®å¼‚æ­¥è„šæœ¬ä¸è¦åœ¨åŠ è½½æœŸé—´ä¿®æ”¹ DOMã€‚</p><p>å¼‚æ­¥è„šæœ¬ä¸€å®šä¼šåœ¨é¡µé¢ <a href="https://developer.mozilla.org/en-US/docs/Web/Events/load" target="_blank" rel="noopener">load</a> äº‹ä»¶ä¹‹å‰æ‰§è¡Œï¼Œä½†å¯èƒ½ä¼šåœ¨ DOMContentLoaded äº‹ä»¶è§¦å‘ä¹‹å‰æˆ–ä¹‹åæ‰§è¡Œã€‚</p><h2>defer vs async</h2><p>ä¸‹é¢è¿™å¼ å›¾èƒ½å¾ˆå¥½åœ°è¯´æ˜ defer ä¸ async ä¹‹é—´çš„å…³ç³»ï¼š</p><img src="/assets/img/async_vs_defer.svg" alt="defer_vs_async"><p>ä»å›¾ä¸­æˆ‘ä»¬å¯ä»¥å¾—å‡ºä»¥ä¸‹å‡ ç‚¹ï¼š</p><ul><li>defer å’Œ async åœ¨ä¸‹è½½æ—¶æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯å¼‚æ­¥çš„ï¼ˆç›¸è¾ƒ HTML è§£æï¼‰ã€‚</li><li>defer ä¼šåœ¨ HTML è§£æå®Œæˆåæ‰§è¡Œçš„ï¼Œasync åˆ™æ˜¯ä¸‹è½½å®Œæˆåæ‰§è¡Œã€‚</li><li>defer æ˜¯æŒ‰ç…§åŠ è½½é¡ºåºæ‰§è¡Œçš„ï¼Œasync æ˜¯å“ªä¸ªæ–‡ä»¶å…ˆåŠ è½½å®Œï¼Œå“ªä¸ªå…ˆæ‰§è¡Œã€‚</li><li>async åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œå¯ä»¥ç”¨äºå®Œå…¨æ— ä¾èµ–çš„è„šæœ¬ï¼Œæ¯”å¦‚ç™¾åº¦åˆ†ææˆ–è€… Google Analyticsã€‚</li></ul><h2>chrome æ˜¯æ€ä¹ˆæ ·åšçš„</h2><p>ä¸Šé¢æåˆ°çš„åªæ˜¯è§„èŒƒï¼Œä½†æ˜¯å„ä¸ªå‚å•†çš„å®ç°å¯èƒ½æœ‰æ‰€ä¸åŒï¼Œchrome æµè§ˆå™¨é¦–å…ˆä¼šè¯·æ±‚ HTML æ–‡æ¡£ï¼Œç„¶åå¯¹å…¶ä¸­çš„å„ç§èµ„æºï¼ˆå›¾ç‰‡ã€CSSã€è§†é¢‘ç­‰ï¼‰è°ƒç”¨ç›¸åº”çš„èµ„æºåŠ è½½å™¨è¿›è¡Œ<strong>å¼‚æ­¥ç½‘ç»œè¯·æ±‚</strong>ï¼ŒåŒæ—¶è¿›è¡Œ DOM æ¸²æŸ“ï¼Œç›´åˆ°é‡åˆ° <code>&lt;script&gt;</code> æ ‡ç­¾çš„æ—¶å€™ï¼Œä¸»è¿›ç¨‹æ‰ä¼šåœæ­¢æ¸²æŸ“ç­‰å¾…æ­¤èµ„æºåŠ è½½å®Œæ¯•ç„¶åè°ƒç”¨ V8 å¼•æ“å¯¹ js è§£æï¼Œç»§è€Œç»§ç»­è¿›è¡Œ DOM è§£æã€‚å¯ä»¥ç†è§£ä¸ºå¦‚æœåŠ äº† async å±æ€§å°±ç›¸å½“äºå•ç‹¬å¼€äº†ä¸€ä¸ªè¿›ç¨‹å»ç‹¬ç«‹åŠ è½½å’Œæ‰§è¡Œï¼Œè€Œ defer æ˜¯å’Œå°† <code>&lt;script&gt;</code> æ”¾åˆ° body åº•éƒ¨ä¸€æ ·çš„æ•ˆæœã€‚</p><p>ä¸ºéªŒè¯æˆ‘ä»¬è®¾è®¡æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.css"</span> <span class="attr">ref</span>=<span class="string">"stylesheet"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.0/css/bootstrap.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.3.3/backbone.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdnjs.cloudflare.com/ajax/libs/quill/1.3.6/quill.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdnjs.cloudflare.com/ajax/libs/react/16.3.2/umd/react.development.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.6.5/angular.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdnjs.cloudflare.com/ajax/libs/vue/2.5.16/vue.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3>æ”¾åœ¨ head ä¸­</h3><img src="/assets/img/async_vs_defer_script.png" alt="async_vs_defer_script"><p>å¯ä»¥çœ‹åˆ°å‡ ä¸ªèµ„æºæ˜¯å¼‚æ­¥åŠ è½½å¹¶ä¸”æ‰§è¡Œåæ‰å¼€å§‹å‡ºç°é¦–å±æ•ˆæœï¼Œé¦–å±æ—¶é—´æ¥è¿‘ 1000msï¼Œè¿˜æ˜¯æ¯”è¾ƒæ…¢çš„ã€‚</p><h3>æ”¾åœ¨ body åº•éƒ¨</h3><img src="/assets/img/async_vs_defer_body.png" alt="async_vs_defer_body"><p>æ”¾åœ¨ body åº•éƒ¨çš„æ—¶å€™ï¼Œé¦–å±å‡ºç°çš„æ—¶é—´å¿«äº†å¾ˆå¤šï¼Œå¤§çº¦åœ¨ 500ms å·¦å³ï¼Œèµ„æºæ–‡ä»¶åœ¨ HTML è§£æåæŒ‰é¡ºåºåŠ è½½æ‰§è¡Œã€‚</p><h3>æ”¾åœ¨ head ä¸­å¹¶ä¸”ä½¿ç”¨ defer</h3><img src="/assets/img/async_vs_defer_head_defer.png" alt="async_vs_defer_head_defer"><p>defer ä¸ºå»¶è¿Ÿæ‰§è¡Œï¼Œä½†æ˜¯ä¸‹è½½æ˜¯å¯ä»¥å¼‚æ­¥ä¸‹è½½çš„ï¼Œé¦–å±æ—¶é—´ä¸åˆ° 600msï¼Œä½†æ˜¯æ…¢äº script æ”¾äº body åº•éƒ¨ã€‚</p><h3>æ”¾åœ¨ head ä¸­å¹¶ä¸”ä½¿ç”¨ async</h3><img src="/assets/img/async_vs_defer_head_async.png" alt="async_vs_defer_head_async"><p>async ä¸ºå¼‚æ­¥ä»£ç ï¼Œæ‰€æœ‰çš„ä»£ç éƒ½æ˜¯åœ¨é¡µé¢è§£æå®Œæˆåæ‰§è¡Œï¼Œä½†æ˜¯æ‰§è¡Œé¡ºåºå¹¶éæŒ‰ç…§ä»£ç ä¹¦å†™é¡ºåºã€‚</p><h3>defer vs async</h3><p>ä¸¤ä¸ªæ”¾åœ¨ä¸€èµ·æ›´èƒ½çœ‹å‡ºæ•ˆæœ</p><img src="/assets/img/async_vs_defer.png" alt="async_vs_defer"><h2>å‚è€ƒèµ„æ–™</h2><ul><li>ã€ŠJavaScript é«˜çº§ç¨‹åºè®¾è®¡ã€‹</li><li><a href="https://segmentfault.com/a/1190000006778717" target="_blank" rel="noopener">æµ…è°ˆscriptæ ‡ç­¾çš„deferå’Œasync</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;HTML ä¸­çš„ &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; å…ƒç´ å®šä¹‰äº†6ä¸ªå±æ€§ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;asyncï¼šå¯é€‰ï¼Œè¡¨ç¤ºç«‹å³ä¸‹è½½è„šæœ¬ï¼Œä½†ä¸åº”è¯¥å¦¨ç¢é¡µé¢ä¸­å…¶å®ƒçš„æ“ä½œï¼Œæ¯”å¦‚ä¸‹è½½å…¶å®ƒèµ„æºæˆ–è€…ç­‰å¾…åŠ è½½å…¶å®ƒè„šæœ¬ï¼Œåªå¯¹å¤–éƒ¨è„šæœ¬æ–‡ä»¶æœ‰æ•ˆã€‚&lt;/li&gt;
&lt;li&gt;charsetï¼šå¯é€‰ï¼Œsrc å±æ€§æŒ‡å®šçš„ä»£ç çš„å­—ç¬¦é›†ã€‚å¤šæ•°æµè§ˆå™¨ä¼šå¿½ç•¥å®ƒçš„å€¼ã€‚&lt;/li&gt;
&lt;li&gt;deferï¼šå¯é€‰ï¼Œè¡¨ç¤ºè„šæœ¬å¯ä»¥å»¶è¿Ÿåˆ°æ–‡æ¡£å®Œå…¨è¢«è§£æå’Œæ˜¾ç¤ºåå†æ‰§è¡Œã€‚åªå¯¹å¤–éƒ¨è„šæœ¬æœ‰æ•ˆã€‚&lt;/li&gt;
&lt;li&gt;languageï¼šå·²åºŸå¼ƒã€‚&lt;/li&gt;
&lt;li&gt;srcï¼šå¯é€‰ï¼Œè¡¨ç¤ºè¦æ‰§è¡Œä»£ç çš„å¤–éƒ¨æ–‡ä»¶ã€‚src å¯ä»¥åŒ…å«æ¥è‡ªå¤–éƒ¨åŸŸçš„æ–‡ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;typeï¼šå¯é€‰ï¼Œå¯ä»¥çœ‹æˆ language çš„æ›¿ä»£å±æ€§ã€‚è¡¨ç¤ºç¼–å†™ä»£ç ä½¿ç”¨çš„è„šæœ¬è¯­è¨€çš„å†…å®¹ç±»å‹ï¼ˆMIMEï¼‰ï¼Œé»˜è®¤å€¼ä¸º text/javascriptã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¦æ³¨æ„çš„æ˜¯ï¼Œå¸¦æœ‰ src çš„ &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; å…ƒç´ ä¸­ä¸åº”è¯¥å†åŒ…å«é¢å¤–çš„ä»£ç ï¼Œå¦‚æœåŒ…å«äº†åµŒå…¥çš„ä»£ç ï¼Œåˆ™åªä¼šä¸‹è½½å¤–éƒ¨æ–‡ä»¶ï¼ŒåµŒå…¥çš„ä»£ç ä¸ä¼šæ‰§è¡Œã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="async" scheme="https://lz5z.com/tags/async/"/>
    
      <category term="defer" scheme="https://lz5z.com/tags/defer/"/>
    
      <category term="script" scheme="https://lz5z.com/tags/script/"/>
    
  </entry>
  
  <entry>
    <title>DOM äº‹ä»¶æœºåˆ¶</title>
    <link href="https://lz5z.com/DOM%E4%BA%8B%E4%BB%B6%E6%9C%BA%E5%88%B6/"/>
    <id>https://lz5z.com/DOMäº‹ä»¶æœºåˆ¶/</id>
    <published>2016-12-25T17:44:44.000Z</published>
    <updated>2020-04-21T10:23:54.823Z</updated>
    
    <content type="html"><![CDATA[<p>DOM äº‹ä»¶æµï¼ˆevent  flowï¼‰å­˜åœ¨ä¸‰ä¸ªé˜¶æ®µï¼šäº‹ä»¶æ•è· --&gt; äº‹ä»¶ç›®æ ‡ --&gt; äº‹ä»¶å†’æ³¡ã€‚</p><p>äº‹ä»¶æ•è·ï¼šå½“äº‹ä»¶å‘ç”Ÿæ—¶ï¼ˆonclick, onmouseoverâ€¦â€¦ï¼‰ï¼Œæµè§ˆå™¨ä¼šä»æ ¹èŠ‚ç‚¹å¼€å§‹ç”±å¤–åˆ°å†…è¿›è¡Œäº‹ä»¶ä¼ æ’­ï¼Œå³ç‚¹å‡»äº†å­å…ƒç´ ï¼Œå¦‚æœçˆ¶å…ƒç´ é€šè¿‡äº‹ä»¶æ•è·æ–¹å¼æ³¨å†Œäº†å¯¹åº”çš„äº‹ä»¶çš„è¯ï¼Œä¼šå…ˆè§¦å‘çˆ¶å…ƒç´ ç»‘å®šçš„äº‹ä»¶ã€‚ï¼ˆIE10 åŠä»¥ä¸‹æµè§ˆå™¨ä¸æ”¯æŒæ•è·å‹äº‹ä»¶ï¼‰</p><p>äº‹ä»¶å†’æ³¡ï¼šä¸äº‹ä»¶æ•è·æ°æ°ç›¸åï¼Œäº‹ä»¶å†’æ³¡é¡ºåºæ˜¯ç”±å†…åˆ°å¤–è¿›è¡Œäº‹ä»¶ä¼ æ’­ï¼Œç›´åˆ°æ ¹èŠ‚ç‚¹ã€‚</p><a id="more"></a><h2>äº‹ä»¶</h2><p>(1) onlick --&gt;äº‹ä»¶å†’æ³¡ï¼Œé‡å†™ onlick ä¼šè¦†ç›–ä¹‹å‰å±æ€§ï¼Œæ²¡æœ‰å…¼å®¹æ€§é—®é¢˜ã€‚DOM0 çº§äº‹ä»¶å¤„ç†ç¨‹åºï¼Œæ¯ä¸ªå…ƒç´ éƒ½æœ‰è‡ªå·±çš„äº‹ä»¶å¤„ç†ç¨‹åºå±æ€§ï¼Œè¿™äº›å±æ€§é€šå¸¸å…¨éƒ¨å°å†™ï¼Œå°†è¿™äº›å±æ€§çš„å€¼å…¨éƒ¨è®¾ç½®ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œå°±å¯ä»¥æŒ‡å®šäº‹ä»¶å¤„ç†ç¨‹åºã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> el = <span class="built_in">document</span>.getElementById(<span class="string">'myBtn'</span>)</span><br><span class="line"><span class="comment">// ç»‘å®šå•å‡»äº‹ä»¶</span></span><br><span class="line">el.onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  alert(<span class="string">'hello'</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è§£ç»‘å•å‡»äº‹ä»¶ï¼Œå°† onclick å±æ€§è®¾ä¸º null å³å¯</span></span><br><span class="line">el.onclick = <span class="literal">null</span></span><br></pre></td></tr></table></figure><p>(2) addEventListener(event, listener, useCapture)</p><p>å‚æ•°å®šä¹‰ï¼ševentâ€”ï¼ˆäº‹ä»¶åç§°ï¼Œå¦‚ clickï¼Œä¸å¸¦ onï¼‰ï¼Œlistenerâ€”äº‹ä»¶ç›‘å¬å‡½æ•°ï¼ŒuseCaptureâ€”æ˜¯å¦é‡‡ç”¨äº‹ä»¶æ•è·è¿›è¡Œäº‹ä»¶æ•æ‰ï¼Œé»˜è®¤ä¸º falseï¼Œå³é‡‡ç”¨äº‹ä»¶å†’æ³¡æ–¹å¼ã€‚ IE8  åŠä»¥ä¸‹ä¸æ”¯æŒï¼Œå±äº DOM2 çº§çš„æ–¹æ³•ï¼Œ<strong>å¯æ·»åŠ å¤šä¸ªæ–¹æ³•ä¸è¢«è¦†ç›–</strong>ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// äº‹ä»¶ç±»å‹æ²¡æœ‰ onï¼Œfalse è¡¨ç¤ºåœ¨äº‹ä»¶ç¬¬ä¸‰é˜¶æ®µï¼ˆå†’æ³¡ï¼‰è§¦å‘ï¼Œtrueè¡¨ç¤ºåœ¨äº‹ä»¶ç¬¬ä¸€é˜¶æ®µï¼ˆæ•è·ï¼‰è§¦å‘ã€‚ å¦‚æœhandleæ˜¯åŒä¸€ä¸ªæ–¹æ³•ï¼Œåªæ‰§è¡Œä¸€æ¬¡ã€‚</span></span><br><span class="line">ele.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; &#125;, <span class="literal">false</span>) </span><br><span class="line"><span class="comment">// è§£ç»‘äº‹ä»¶ï¼Œå‚æ•°å’Œç»‘å®šä¸€æ ·</span></span><br><span class="line">ele.removeEventListener(event.type, handle, boolean)</span><br></pre></td></tr></table></figure><p>(3) attachEvent(event.type, handle) IE ç‰¹æœ‰ï¼Œå…¼å®¹ IE8 åŠä»¥ä¸‹ï¼Œå¯æ·»åŠ å¤šä¸ªäº‹ä»¶å¤„ç†ç¨‹åºï¼Œä¸ DOM æ–¹æ³•ä¸åŒçš„æ˜¯ï¼Œå¤šä¸ªäº‹ä»¶çš„æ‰§è¡Œé¡ºåºä¸æ·»åŠ é¡ºåºç›¸åï¼ŒattachEvent åªæ”¯æŒå†’æ³¡é˜¶æ®µã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¦‚æœ handle æ˜¯åŒä¸€ä¸ªæ–¹æ³•ï¼Œç»‘å®šå‡ æ¬¡æ‰§è¡Œå‡ æ¬¡ï¼Œè¿™ç‚¹å’Œ addEventListener ä¸åŒ,äº‹ä»¶ç±»å‹è¦åŠ  on, ä¾‹å¦‚ onclick è€Œä¸æ˜¯ click</span></span><br><span class="line">ele.attachEvent(<span class="string">'onclick'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; &#125;)</span><br><span class="line"><span class="comment">// è§£ç»‘äº‹ä»¶ï¼Œå‚æ•°å’Œç»‘å®šä¸€æ ·</span></span><br><span class="line">ele.detachEvent(<span class="string">'onclick'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; &#125;)</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ attachEvent() æ·»åŠ çš„äº‹ä»¶å¯ä»¥é€šè¿‡ detachEvent() æ¥ç§»é™¤ï¼Œæ¡ä»¶æ˜¯å¿…é¡»æä¾›ç›¸åŒçš„å‚æ•°ï¼Œä¸ DOM æ–¹æ³•ä¸€æ ·ï¼Œè¿™ä¹Ÿæ„å‘³ç€æ·»åŠ çš„åŒ¿åå‡½æ•°ä¸èƒ½è¢«ç§»é™¤ã€‚</p><p>(4) é»˜è®¤äº‹ä»¶è¡Œä¸ºï¼šhref=â€™â€™ï¼Œsubmitè¡¨å•æäº¤ç­‰</p><ul><li>return false é˜»æ­¢ç‹¬äº«å±æ€§ï¼ˆé€šè¿‡onè¿™ç§æ–¹å¼ï¼‰ç»‘å®šçš„äº‹ä»¶çš„é»˜è®¤äº‹ä»¶</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ele.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  â€¦â€¦             <span class="comment">// ä½ çš„ä»£ç </span></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>   <span class="comment">// é€šè¿‡è¿”å›falseå€¼é˜»æ­¢é»˜è®¤äº‹ä»¶è¡Œä¸º</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>event.preventDefault() é˜»æ­¢é€šè¿‡ addEventListener() æ·»åŠ çš„äº‹ä»¶çš„é»˜è®¤äº‹ä»¶</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">element.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> event = e || <span class="built_in">window</span>.event</span><br><span class="line">  â€¦â€¦</span><br><span class="line">  event.preventDefault()    <span class="comment">// é˜»æ­¢é»˜è®¤äº‹ä»¶</span></span><br><span class="line">&#125;,<span class="literal">false</span>)</span><br></pre></td></tr></table></figure><ul><li>event.returnValue = false é˜»æ­¢é€šè¿‡ attachEvent() æ·»åŠ çš„äº‹ä»¶çš„é»˜è®¤äº‹ä»¶</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">element.attachEvent(<span class="string">"onclick"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> event = e || <span class="built_in">window</span>.event</span><br><span class="line">  â€¦â€¦</span><br><span class="line">  event.returnValue = <span class="literal">false</span>     <span class="comment">// é˜»æ­¢é»˜è®¤äº‹ä»¶</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2>DOM ä¸­çš„äº‹ä»¶å¯¹è±¡</h2><table><thead><tr><th style="text-align:left">å±æ€§/æ–¹æ³•</th><th style="text-align:left">ç±»å‹</th><th style="text-align:left">è¯»å†™</th><th style="text-align:left">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left">Event.bubbles</td><td style="text-align:left">Boolean</td><td style="text-align:left">åªè¯»</td><td style="text-align:left">è¡¨ç¤ºè¯¥äº‹ä»¶æ˜¯å¦åœ¨ DOM ä¸­å†’æ³¡</td></tr><tr><td style="text-align:left">Event.cancelable</td><td style="text-align:left">Boolean</td><td style="text-align:left">åªè¯»</td><td style="text-align:left">è¡¨ç¤ºè¿™ä¸ªäº‹ä»¶æ˜¯å¦å¯ä»¥å–æ¶ˆ</td></tr><tr><td style="text-align:left">Event.currentTarget</td><td style="text-align:left">Element</td><td style="text-align:left">åªè¯»</td><td style="text-align:left">å½“å‰æ³¨å†Œäº‹ä»¶çš„å¯¹è±¡çš„å¼•ç”¨ï¼Œå½“å‰äº‹ä»¶éœ€è¦ä¼ é€’åˆ°çš„å¯¹è±¡</td></tr><tr><td style="text-align:left">Event.defaultPrevented</td><td style="text-align:left">Boolean</td><td style="text-align:left">åªè¯»</td><td style="text-align:left">è¡¨ç¤ºäº†æ˜¯å¦å·²ç»æ‰§è¡Œè¿‡äº† event.preventDefault()</td></tr><tr><td style="text-align:left">Event.eventPhase</td><td style="text-align:left">Integer</td><td style="text-align:left">åªè¯»</td><td style="text-align:left">æŒ‡ç¤ºäº‹ä»¶æµæ­£åœ¨å¤„ç†å“ªä¸ªé˜¶æ®µ: 1.æ•è· 2.ç›®æ ‡ 3. å†’æ³¡</td></tr><tr><td style="text-align:left">Event.target</td><td style="text-align:left">Element</td><td style="text-align:left">åªè¯»</td><td style="text-align:left">å¯¹äº‹ä»¶èµ·æºç›®æ ‡çš„å¼•ç”¨</td></tr><tr><td style="text-align:left">Event.timeStamp</td><td style="text-align:left">Number</td><td style="text-align:left">åªè¯»</td><td style="text-align:left">äº‹ä»¶åˆ›å»ºæ—¶çš„æ—¶é—´æˆ³ï¼Œæ¯«ç§’çº§åˆ«</td></tr><tr><td style="text-align:left">Event.type</td><td style="text-align:left">String</td><td style="text-align:left">åªè¯»</td><td style="text-align:left">äº‹ä»¶çš„ç±»å‹ï¼ˆâ€˜clickâ€™ï¼‰</td></tr><tr><td style="text-align:left">event.preventDefault</td><td style="text-align:left">Function</td><td style="text-align:left">åªè¯»</td><td style="text-align:left">å–æ¶ˆäº‹ä»¶çš„é»˜è®¤è¡Œä¸ºï¼Œå¦‚æœ cancelable æ˜¯ trueï¼Œåˆ™å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•</td></tr><tr><td style="text-align:left">event.stopImmediatePropagation</td><td style="text-align:left">Function</td><td style="text-align:left">åªè¯»</td><td style="text-align:left">å–æ¶ˆäº‹ä»¶çš„è¿›ä¸€æ­¥æ•è·æˆ–è€…å†’æ³¡ï¼ŒåŒæ—¶é˜»æ­¢ä»»ä½•äº‹ä»¶å¤„ç†ç¨‹åºè¢«è°ƒç”¨ï¼ˆDOM3ï¼‰</td></tr><tr><td style="text-align:left">event.stopPropagation</td><td style="text-align:left">Function</td><td style="text-align:left">åªè¯»</td><td style="text-align:left">å–æ¶ˆäº‹ä»¶çš„é»˜è®¤è¡Œä¸ºï¼Œå¦‚æœ bubbles æ˜¯ trueï¼Œåˆ™å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•</td></tr></tbody></table><h3>target vs currnetTarget</h3><p>åœ¨äº‹ä»¶å¤„ç†ç¨‹åºçš„å†…éƒ¨ï¼Œå¯¹è±¡çš„ this å§‹ç»ˆç­‰äº currentTarget çš„å€¼ï¼Œè€Œ target åˆ™åªåŒ…å«äº‹ä»¶çš„å®é™…ç›®æ ‡ã€‚å¦‚æœç›´æ¥å°†äº‹ä»¶å¤„ç†ç¨‹åºæŒ‡å®šç»™äº†ç›®æ ‡å…ƒç´ ï¼Œåˆ™ thisï¼Œ currentTarget å’Œ target åŒ…å«ç›¸åŒçš„å€¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">'myBtn'</span>)</span><br><span class="line">btn.onclick = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">  e.currentTarget === <span class="keyword">this</span> <span class="comment">// true</span></span><br><span class="line">  e.target === <span class="keyword">this</span> <span class="comment">// true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±äº click äº‹ä»¶çš„ç›®æ ‡æ˜¯æŒ‰é’®ï¼Œå› æ­¤è¿™ä¸‰ä¸ªå€¼æ˜¯ç›¸ç­‰çš„ï¼Œä½†å¦‚æœäº‹ä»¶å¤„ç†ç¨‹åºå­˜åœ¨äºæŒ‰é’®çš„çˆ¶èŠ‚ç‚¹ä¸­ï¼Œç»“æœå°±ä¸ä¸€æ ·äº†ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.body.onclick = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">  e.target === <span class="built_in">document</span>.getElementById(<span class="string">'myBtn'</span>) <span class="comment">// true</span></span><br><span class="line">  e.currentTarget === <span class="built_in">document</span>.body <span class="comment">// true</span></span><br><span class="line">  <span class="keyword">this</span> === <span class="built_in">document</span>.body <span class="comment">// true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å•å‡»è¿™ä¸ªæŒ‰é’®æ—¶ï¼Œthis å’Œ currentTarget éƒ½ç­‰äº document.bodyï¼Œå› ä¸ºäº‹ä»¶å¤„ç†ç¨‹åºæ˜¯æ³¨å†Œåˆ°è¿™ä¸ªå…ƒç´ ä¸Šçš„ã€‚ç„¶è€Œ target å…ƒç´ å´ç­‰äºæŒ‰é’®å…ƒç´ ï¼Œå› ä¸ºå®ƒæ˜¯ click äº‹ä»¶çš„çœŸæ­£ç›®æ ‡ã€‚</p><h2>IE äº‹ä»¶å¯¹è±¡</h2><p>è®¿é—® IE ä¸­çš„ event å¯¹è±¡æ—¶ï¼Œå¦‚æœä½¿ç”¨ DOM0 çº§æ–¹æ³•æ·»åŠ äº‹ä»¶å¤„ç†ç¨‹åºï¼Œevent å¯¹è±¡ä½œä¸º window å¯¹è±¡çš„ä¸€ä¸ªå±æ€§å­˜åœ¨ã€‚ä½¿ç”¨ attachEvent() æ·»åŠ äº‹ä»¶å¤„ç†ç¨‹åºæ—¶ï¼Œevent ä¼šä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œä¹Ÿå¯ä»¥ä» window å¯¹è±¡ä¸­è®¿é—® event å¯¹è±¡ï¼Œå°±åƒ DOM0 çº§æ–¹æ³•ä¸€æ ·ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// onclick</span></span><br><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">'myBtn'</span>)</span><br><span class="line">btn.onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> event = <span class="built_in">window</span>.event</span><br><span class="line">  alert(event.type) <span class="comment">// 'click'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// attachEvent</span></span><br><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">'myBtn'</span>)</span><br><span class="line">btn.attachEvent(<span class="string">'onclick'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">  alert(event.type) <span class="comment">// 'click'</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:left">å±æ€§/æ–¹æ³•</th><th style="text-align:left">ç±»å‹</th><th style="text-align:left">è¯»å†™</th><th style="text-align:left">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left">Event.cancelable</td><td style="text-align:left">Boolean</td><td style="text-align:left">è¯»/å†™</td><td style="text-align:left">é»˜è®¤ä¸º falseï¼Œä½†å°†å…¶è®¾ç½®ä¸º true å°±å¯ä»¥å–æ¶ˆäº‹ä»¶å†’æ³¡ï¼ˆä¸ DOM0 çº§çš„ stopPropagation()æ–¹æ³•çš„ä½œç”¨ç›¸åŒï¼‰</td></tr><tr><td style="text-align:left">Event.returnValue</td><td style="text-align:left">Boolean</td><td style="text-align:left">è¯»/å†™</td><td style="text-align:left">é»˜è®¤ä¸º falseï¼Œä½†å°†å…¶è®¾ç½®ä¸º true å°±å¯ä»¥å–æ¶ˆäº‹ä»¶çš„é»˜è®¤è¡Œä¸ºï¼ˆä¸ DOM ä¸­çš„ preventDefault()æ–¹æ³•çš„ä½œç”¨ç›¸åŒï¼‰</td></tr><tr><td style="text-align:left">Event.srcElement</td><td style="text-align:left">Element</td><td style="text-align:left">åªè¯»</td><td style="text-align:left">äº‹ä»¶çš„ç›®æ ‡ï¼ˆDOM ä¸­çš„ targetï¼‰</td></tr><tr><td style="text-align:left">Event.type</td><td style="text-align:left">String</td><td style="text-align:left">åªè¯»</td><td style="text-align:left">äº‹ä»¶çš„ç±»å‹</td></tr></tbody></table><p>äº‹ä»¶å¤„ç†ç¨‹åºçš„ä½œç”¨åŸŸæ˜¯æ ¹æ®æŒ‡å®šå®ƒçš„æ–¹å¼æ¥ç¡®å®šçš„ï¼Œæ‰€ä»¥å…¶ this ä¹Ÿä¼šæœ‰æ‰€ä¸åŒï¼Œæ¯”è¾ƒå¥½çš„åŠæ³•æ˜¯ç”¨ event.srcElementã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">'myBtn'</span>)</span><br><span class="line">btn.onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">window</span>.event.srcElement === <span class="keyword">this</span> <span class="comment">// true</span></span><br><span class="line">&#125;</span><br><span class="line">btn.attachEvent(<span class="string">'onclick'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">  event.srcElement === <span class="keyword">this</span> <span class="comment">// false</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>IE äº‹ä»¶ä¸­çš„ returnValue ç›¸å½“äº DOM ä¸­çš„ preventDefault() æ–¹æ³•ï¼Œå®ƒä»¬çš„ä½œç”¨éƒ½æ˜¯å–æ¶ˆäº‹ä»¶çš„é»˜è®¤è¡Œä¸ºï¼Œä¸è¿‡è¿™é‡Œä¸èƒ½ç¡®å®šäº‹ä»¶çš„é»˜è®¤è¡Œä¸ºæ˜¯å¦å·²ç»è¢«å–æ¶ˆã€‚</p><p>cancelBubble å±æ€§ä¸ DOM ä¸­çš„ stopPropagation() æ–¹æ³•ä½œç”¨ç›¸åŒï¼Œç”¨æ¥é˜»æ­¢äº‹ä»¶å†’æ³¡ï¼Œç”±äº IE ä¸æ”¯æŒäº‹ä»¶æ•è·ï¼Œå› æ­¤åªèƒ½é˜»æ­¢äº‹ä»¶å†’æ³¡ï¼Œè€Œ stopPropagation() åŒæ—¶å¯ä»¥å–æ¶ˆäº‹ä»¶å†’æ³¡å’Œæ•è·ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">'myBtn'</span>)</span><br><span class="line">btn.onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">window</span>.event.returnValue = <span class="literal">false</span> <span class="comment">// é˜»æ­¢é»˜è®¤äº‹ä»¶</span></span><br><span class="line">  <span class="built_in">window</span>.event.cancelBubble = <span class="literal">true</span> <span class="comment">// é˜»æ­¢äº‹ä»¶å†’æ³¡</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2>äº‹ä»¶å°è£…</h2><p>JavaScript ä¸­å®ç°äº‹ä»¶ç»‘å®šä¸»è¦ä½¿ç”¨ä¸¤ä¸ªæ–¹æ³•ï¼š <a href="https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener" target="_blank" rel="noopener">addEventListener</a>ã€<a href="https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/attachEvent" target="_blank" rel="noopener">attachEvent</a>ã€‚</p><p>ä¸ºäº†å…¼å®¹æµè§ˆå™¨ï¼ŒæŒ‰ç…§ç½‘ä¸Šé€šç”¨çš„æ–¹æ¡ˆå¯¹äº‹ä»¶è¿›è¡Œå°è£…</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// äº‹ä»¶ç»‘å®š</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addEvent</span>(<span class="params">element, eType, handle, bol</span>) </span>&#123;</span><br><span class="line"> <span class="keyword">if</span> (element.addEventListener) &#123;       <span class="comment">// å¦‚æœæ”¯æŒaddEventListener</span></span><br><span class="line">   element.addEventListener(eType, handle, bol)</span><br><span class="line"> &#125; <span class="keyword">else</span> <span class="keyword">if</span> (element.attachEvent) &#123;      <span class="comment">// å¦‚æœæ”¯æŒattachEvent</span></span><br><span class="line">   element.attachEvent(<span class="string">'on'</span> + eType, handle)</span><br><span class="line"> &#125; <span class="keyword">else</span> &#123;                  <span class="comment">// å¦åˆ™ä½¿ç”¨å…¼å®¹çš„onclickç»‘å®š</span></span><br><span class="line">   element[<span class="string">'on'</span> + eType] = handle</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// äº‹ä»¶è§£ç»‘</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">removeEvent</span>(<span class="params">element, eType, handle, bol</span>) </span>&#123;</span><br><span class="line"> <span class="keyword">if</span> (element.addEventListener) &#123;</span><br><span class="line">   element.removeEventListener(eType, handle, bol)</span><br><span class="line"> &#125; <span class="keyword">else</span> <span class="keyword">if</span> (element.attachEvent) &#123;</span><br><span class="line">   element.detachEvent(<span class="string">'on'</span> + eType, handle)</span><br><span class="line"> &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">   element[<span class="string">'on'</span> + eType] = <span class="literal">null</span></span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2>é˜»æ­¢äº‹ä»¶å†’æ³¡ã€äº‹ä»¶æ•è·</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é˜»æ­¢é»˜è®¤äº‹ä»¶</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">preventDefault</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (event.preventDefault) &#123;</span><br><span class="line">    event.preventDefault()</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    event.returnValue = <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// é˜»æ­¢äº‹ä»¶è¿›ä¸€æ­¥ä¼ æ’­</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">stopPropagation</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (event.stopPropagation) &#123;</span><br><span class="line">    event.stopPropagation() <span class="comment">// é˜»æ­¢äº‹ä»¶çš„è¿›ä¸€æ­¥ä¼ æ’­ï¼ŒåŒ…æ‹¬ï¼ˆå†’æ³¡ï¼Œæ•è·ï¼‰ï¼Œæ— å‚æ•°</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    event.cancelBubble = <span class="literal">true</span> <span class="comment">// true ä¸ºé˜»æ­¢å†’æ³¡</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">// è·å–äº‹ä»¶ç›®æ ‡</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getTarget</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> event.target || event.srcElement</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2>äº‹ä»¶æµ</h2><h3>äº‹ä»¶å†’æ³¡</h3><p>HTMLå†…å®¹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"parent"</span>&gt;</span></span><br><span class="line">    çˆ¶å…ƒç´ </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"child"</span>&gt;</span></span><br><span class="line">      å­å…ƒç´ </span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><p>css</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#parent</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>:<span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">3</span>;</span><br><span class="line">  <span class="attribute">background</span>: green;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#child</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">  <span class="attribute">background</span>: orange;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>JavaScript</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> parent = <span class="built_in">document</span>.getElementById(<span class="string">'parent'</span>)</span><br><span class="line"><span class="keyword">let</span> child = <span class="built_in">document</span>.getElementById(<span class="string">'child'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.body.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'click-body'</span>)</span><br><span class="line">&#125;, <span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line">parent.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'click-parent'</span>)</span><br><span class="line">&#125;, <span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line">child.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'click-child'</span>)</span><br><span class="line">&#125;, <span class="literal">false</span>)</span><br></pre></td></tr></table></figure><p>é€šè¿‡ â€˜addEventListenerâ€™ æ–¹æ³•ï¼Œé‡‡ç”¨äº‹ä»¶å†’æ³¡æ–¹å¼ç»™ DOM å…ƒç´ æ³¨å†Œ click äº‹ä»¶ï¼Œç‚¹å‡»â€œå­å…ƒç´ â€ï¼Œæ§åˆ¶å°ä¾æ¬¡è¾“å‡º â€œclick-childâ€ --&gt; â€œclick-parentâ€ --&gt; â€œclick-bodyâ€ã€‚</p><p>äº‹ä»¶è§¦å‘é¡ºåºæ˜¯ç”±å†…åˆ°å¤–çš„ï¼Œè¿™å°±æ˜¯äº‹ä»¶å†’æ³¡ï¼Œè™½ç„¶åªç‚¹å‡»å­å…ƒç´ ï¼Œä½†æ˜¯å®ƒçš„çˆ¶å…ƒç´ ä¹Ÿä¼šè§¦å‘ç›¸åº”çš„äº‹ä»¶ã€‚</p><!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.9.0">  <meta charset="utf-8">  <title>DOM äº‹ä»¶</title>  <style>    #parent{      width: 200px;      height:200px;      text-align: center;      line-height: 3;      background: green;    }    #child{      width: 100px;      height: 100px;      margin: 0 auto;      background: orange;    }  </style></head><body>  <div id="parent">    çˆ¶å…ƒç´     <div id="child">      å­å…ƒç´     </div>  </div>  <script type="text/javascript">    let parent = document.getElementById('parent')    let child = document.getElementById('child')      document.body.addEventListener('click', function(e) {      console.log('click-body')    }, false)        parent.addEventListener('click', function(e) {      console.log('click-parent')    }, false)    child.addEventListener('click', function(e) {      console.log('click-child')    }, false)  </script></body></html>ï¼ˆF12 æ‰“å¼€æ§åˆ¶å°ï¼Œç‚¹å‡»æŸ¥çœ‹æ•ˆæœï¼‰<p>å¦‚æœç‚¹å‡»å­å…ƒç´ ä¸æƒ³è§¦å‘çˆ¶å…ƒç´ çš„äº‹ä»¶æ€ä¹ˆåŠï¼Ÿ<br>é‚£å°±æ˜¯åœæ­¢äº‹ä»¶ä¼ æ’­â€”event.stopPropagation()</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">child.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'click-child'</span>)</span><br><span class="line">  ã€€e.stopPropagation()</span><br><span class="line">&#125;, <span class="literal">false</span>)</span><br></pre></td></tr></table></figure><!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.9.0">  <meta charset="utf-8">  <title>DOM äº‹ä»¶</title>  <style>    #parent2{      width: 200px;      height:200px;      text-align: center;      line-height: 3;      background: green;    }    #child2{      width: 100px;      height: 100px;      margin: 0 auto;      background: orange;    }  </style></head><body>  <div id="parent2">    çˆ¶å…ƒç´     <div id="child2">      å­å…ƒç´     </div>  </div>  <script type="text/javascript">    let parent2 = document.getElementById('parent2')    let child2 = document.getElementById('child2')        parent2.addEventListener('click', function(e) {      console.log('click-parent')    }, false)    child2.addEventListener('click', function(e) {      console.log('click-child')      e.stopPropagation()    }, false)  </script></body></html>ï¼ˆF12 æ‰“å¼€æ§åˆ¶å°ï¼Œç‚¹å‡»æŸ¥çœ‹æ•ˆæœï¼‰<h3>äº‹ä»¶æ•è·</h3><p>ä¿®æ”¹ä¸Šé¢äº‹ä»¶å†’æ³¡çš„ä¾‹å­</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> parent = <span class="built_in">document</span>.getElementById(<span class="string">'parent'</span>)</span><br><span class="line"><span class="keyword">let</span> child = <span class="built_in">document</span>.getElementById(<span class="string">'child'</span>)</span><br><span class="line"></span><br><span class="line">parent.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'click-parent---äº‹ä»¶ä¼ æ’­'</span>)</span><br><span class="line">&#125;, <span class="literal">false</span>)</span><br><span class="line"><span class="comment">// æ–°å¢äº‹ä»¶æ•è·</span></span><br><span class="line">parent.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'click-parent--äº‹ä»¶æ•è·'</span>)</span><br><span class="line">&#125;, <span class="literal">true</span>)</span><br><span class="line"></span><br><span class="line">child.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'click-child'</span>)</span><br><span class="line">&#125;, <span class="literal">false</span>)</span><br></pre></td></tr></table></figure><!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.9.0">  <meta charset="utf-8">  <title>DOM äº‹ä»¶</title>  <style>    #parent3{      width: 200px;      height:200px;      text-align: center;      line-height: 3;      background: green;    }    #child3{      width: 100px;      height: 100px;      margin: 0 auto;      background: orange;    }  </style></head><body>  <div id="parent3">    çˆ¶å…ƒç´     <div id="child3">      å­å…ƒç´     </div>  </div>  <script type="text/javascript">    let parent3 = document.getElementById('parent3')    let child3 = document.getElementById('child3')    parent3.addEventListener('click', function(e) {      console.log('click-parent---äº‹ä»¶ä¼ æ’­')    }, false)            // æ–°å¢äº‹ä»¶æ•è·    parent3.addEventListener('click', function(e) {      console.log('click-parent--äº‹ä»¶æ•è·')    }, true)    child3.addEventListener('click', function(e) {      console.log('click-child')    }, false)  </script></body></html>ï¼ˆF12 æ‰“å¼€æ§åˆ¶å°ï¼Œç‚¹å‡»æŸ¥çœ‹æ•ˆæœï¼‰<p>çˆ¶å…ƒç´ é€šè¿‡äº‹ä»¶æ•è·çš„æ–¹å¼æ³¨å†Œäº† click äº‹ä»¶ï¼Œæ‰€ä»¥åœ¨äº‹ä»¶æ•è·é˜¶æ®µå°±ä¼šè§¦å‘ï¼Œç„¶ååˆ°äº†ç›®æ ‡é˜¶æ®µï¼Œå³äº‹ä»¶æºï¼Œä¹‹åè¿›è¡Œäº‹ä»¶ä¼ æ’­ï¼Œparent åŒæ—¶ä¹Ÿç”¨å†’æ³¡æ–¹å¼æ³¨å†Œäº† click äº‹ä»¶ï¼Œæ‰€ä»¥è¿™é‡Œä¼šè§¦å‘å†’æ³¡äº‹ä»¶ï¼Œæœ€ååˆ°æ ¹èŠ‚ç‚¹ã€‚è¿™å°±æ˜¯æ•´ä¸ªäº‹ä»¶æµç¨‹ã€‚</p><h3>äº‹ä»¶å§”æ‰˜</h3><p>äº‹ä»¶å§”æ‰˜(äº‹ä»¶ä»£ç†)ï¼šåˆ©ç”¨äº‹ä»¶å†’æ³¡çš„ç‰¹æ€§ï¼Œå°†é‡Œå±‚çš„äº‹ä»¶å§”æ‰˜ç»™å¤–å±‚äº‹ä»¶ï¼Œæ ¹æ® event å¯¹è±¡çš„å±æ€§è¿›è¡Œäº‹ä»¶å§”æ‰˜ï¼Œæ”¹å–„æ€§èƒ½ã€‚<br>ä½¿ç”¨äº‹ä»¶å§”æ‰˜èƒ½å¤Ÿé¿å…å¯¹ç‰¹å®šçš„æ¯ä¸ªèŠ‚ç‚¹æ·»åŠ äº‹ä»¶ç›‘å¬å™¨ï¼›äº‹ä»¶ç›‘å¬å™¨æ˜¯è¢«æ·»åŠ åˆ°å®ƒä»¬çš„çˆ¶å…ƒç´ ä¸Šã€‚äº‹ä»¶ç›‘å¬å™¨ä¼šåˆ†æä»å­å…ƒç´ å†’æ³¡ä¸Šæ¥çš„äº‹ä»¶ï¼Œæ‰¾åˆ°æ˜¯å“ªä¸ªå­å…ƒç´ çš„äº‹ä»¶ã€‚</p><p>å§”æ‰˜åœ¨ JQuery ä¸­å·²ç»å¾—åˆ°äº†å®ç°ï¼Œå³é€šè¿‡ <strong>$(selector).on(event,childSelector,data,function,map)</strong> å®ç°å§”æ‰˜ï¼Œä¸€èˆ¬ç”¨äºåŠ¨æ€ç”Ÿæˆçš„å…ƒç´ ï¼Œå½“ç„¶ JQuery ä¹Ÿæ˜¯é€šè¿‡åŸç”Ÿçš„ js å»å®ç°çš„ï¼Œä¸‹é¢ä¸¾ä¸€ä¸ªç®€å•çš„æ —å­ï¼Œå¦‚æœè¦å•ç‹¬ç‚¹å‡» table é‡Œé¢çš„ tdï¼Œæ™®é€šåšæ³•æ˜¯ for å¾ªç¯ç»™æ¯ä¸ª td ç»‘å®šäº‹ä»¶ï¼Œtd å°‘çš„è¯æ€§èƒ½ä»€ä¹ˆå·®åˆ«ï¼Œtd å¦‚æœå¤šäº†ï¼Œå°±ä¸è¡Œäº†ï¼Œæˆ‘ä»¬ä½¿ç”¨äº‹ä»¶å§”æ‰˜:</p><p>HTML</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">id</span>=<span class="string">"outside"</span> <span class="attr">border</span>=<span class="string">"1"</span> <span class="attr">style</span>=<span class="string">"cursor: pointer;"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>table01<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>table02<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>table03<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>table04<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>table05<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>table06<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>table07<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>table08<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>table09<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>table10<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure><p>JavaScript</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> out = <span class="built_in">document</span>.getElementById(<span class="string">'outside'</span>)</span><br><span class="line"><span class="keyword">if</span> (out.addEventListener) &#123;</span><br><span class="line">  out.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    e = e || <span class="built_in">window</span>.event</span><br><span class="line">    <span class="comment">// IEæ²¡æœ‰e.targetï¼Œæœ‰e.srcElement</span></span><br><span class="line">    <span class="keyword">let</span> target = e.target || e.srcElement</span><br><span class="line">    <span class="comment">// åˆ¤æ–­äº‹ä»¶ç›®æ ‡æ˜¯å¦æ˜¯tdï¼Œæ˜¯çš„è¯targetå³ä¸ºç›®æ ‡èŠ‚ç‚¹td</span></span><br><span class="line">    <span class="keyword">if</span> (target.tagName.toLowerCase() == <span class="string">'td'</span>) &#123;</span><br><span class="line">      changeStyle(target)</span><br><span class="line">      <span class="built_in">console</span>.log(target.innerHTML)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, <span class="literal">false</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  out.attachEvent(<span class="string">'onclick'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    e = e || <span class="built_in">window</span>.event</span><br><span class="line">    <span class="comment">// IEæ²¡æœ‰e.targetï¼Œæœ‰e.srcElement</span></span><br><span class="line">    <span class="keyword">let</span> target = e.target || e.srcElement</span><br><span class="line">    <span class="comment">// åˆ¤æ–­äº‹ä»¶ç›®æ ‡æ˜¯å¦æ˜¯tdï¼Œæ˜¯çš„è¯targetå³ä¸ºç›®æ ‡èŠ‚ç‚¹td</span></span><br><span class="line">    <span class="keyword">if</span> (target.tagName.toLowerCase() == <span class="string">'td'</span>) &#123;</span><br><span class="line">      changeStyle(target)</span><br><span class="line">      <span class="built_in">console</span>.log(target.innerHTML)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">changeStyle</span>(<span class="params">ele</span>) </span>&#123;</span><br><span class="line">  ele.innerHTML = <span class="string">'å·²ç‚¹å‡»'</span></span><br><span class="line">  ele.style.background = <span class="string">'#900'</span></span><br><span class="line">  ele.style.color = <span class="string">'#fff'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.9.0">  <meta charset="utf-8">  <title>DOM äº‹ä»¶</title></head><body>  <table id="outside" border="1" style="cursor: pointer;">  <tr>    <td>table01</td>    <td>table02</td>    <td>table03</td>    <td>table04</td>    <td>table05</td>    <td>table06</td>    <td>table07</td>    <td>table08</td>    <td>table09</td>    <td>table10</td>  </tr>  </table>  <script type="text/javascript">    let out = document.getElementById('outside')    if (out.addEventListener) {      out.addEventListener('click', function(e) {        e = e || window.event          // IE æ²¡æœ‰ e.targetï¼Œæœ‰ e.srcElement        let target = e.target || e.srcElement          // åˆ¤æ–­äº‹ä»¶ç›®æ ‡æ˜¯å¦æ˜¯tdï¼Œæ˜¯çš„è¯ target å³ä¸ºç›®æ ‡èŠ‚ç‚¹ td        if (target.tagName.toLowerCase() == 'td') {          changeStyle(target)          console.log(target.innerHTML)        }      }, false)    } else {      out.attachEvent('onclick', function(e) {        e = e || window.event          // IE æ²¡æœ‰ e.targetï¼Œæœ‰ e.srcElement        let target = e.target || e.srcElement          // åˆ¤æ–­äº‹ä»¶ç›®æ ‡æ˜¯å¦æ˜¯ tdï¼Œæ˜¯çš„è¯ target å³ä¸ºç›®æ ‡èŠ‚ç‚¹ td        if (target.tagName.toLowerCase() == 'td') {          changeStyle(target)          console.log(target.innerHTML)        }      })    }    function changeStyle(ele) {      ele.innerHTML = 'å·²ç‚¹å‡»'      ele.style.background = '#900'      ele.style.color = '#fff'    }  </script></body></html>ï¼ˆç‚¹å‡»æŸ¥çœ‹æ•ˆæœï¼‰<h2>æ€»ç»“</h2><p>äº‹ä»¶çš„ä¸‰ä¸ªé˜¶æ®µåˆ†åˆ«ä¸ºï¼šæ•è·ï¼Œç›®æ ‡å’Œå†’æ³¡ï¼Œä½ç‰ˆæœ¬ IE ä¸æ”¯æŒæ•è·ã€‚ç»‘å®šäº‹ä»¶çš„æ–¹æ³•ä¸º <strong>addEventListener</strong> å’Œ <strong>attachEvent</strong>ã€‚addEventListener æ–¹æ³•çš„ç¬¬ä¸‰ä¸ª boolean å‹å‚æ•°è¡¨ç¤ºæ·»åŠ çš„äº‹ä»¶ä¸ºæ•è·æˆ–è€…å†’æ³¡ï¼Œtrue ä»£è¡¨æ•è·ï¼Œfalse ä»£è¡¨å†’æ³¡ã€‚</p><p>äº‹ä»¶å†’æ³¡çš„ä¼˜ç‚¹ä¸ºï¼š</p><ol><li>å¯ä»¥å¤§é‡èŠ‚çœå†…å­˜å ç”¨ï¼Œå‡å°‘äº‹ä»¶æ³¨å†Œï¼Œæ¯”å¦‚åœ¨ table ä¸Šä»£ç†æ‰€æœ‰ td çš„ click äº‹ä»¶ã€‚</li><li>å¯ä»¥å®ç°ä¸ºåŠ¨æ€å¢åŠ çš„ DOM ç»‘å®šäº‹ä»¶çš„åŠŸèƒ½ã€‚</li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;DOM äº‹ä»¶æµï¼ˆevent  flowï¼‰å­˜åœ¨ä¸‰ä¸ªé˜¶æ®µï¼šäº‹ä»¶æ•è· --&amp;gt; äº‹ä»¶ç›®æ ‡ --&amp;gt; äº‹ä»¶å†’æ³¡ã€‚&lt;/p&gt;
&lt;p&gt;äº‹ä»¶æ•è·ï¼šå½“äº‹ä»¶å‘ç”Ÿæ—¶ï¼ˆonclick, onmouseoverâ€¦â€¦ï¼‰ï¼Œæµè§ˆå™¨ä¼šä»æ ¹èŠ‚ç‚¹å¼€å§‹ç”±å¤–åˆ°å†…è¿›è¡Œäº‹ä»¶ä¼ æ’­ï¼Œå³ç‚¹å‡»äº†å­å…ƒç´ ï¼Œå¦‚æœçˆ¶å…ƒç´ é€šè¿‡äº‹ä»¶æ•è·æ–¹å¼æ³¨å†Œäº†å¯¹åº”çš„äº‹ä»¶çš„è¯ï¼Œä¼šå…ˆè§¦å‘çˆ¶å…ƒç´ ç»‘å®šçš„äº‹ä»¶ã€‚ï¼ˆIE10 åŠä»¥ä¸‹æµè§ˆå™¨ä¸æ”¯æŒæ•è·å‹äº‹ä»¶ï¼‰&lt;/p&gt;
&lt;p&gt;äº‹ä»¶å†’æ³¡ï¼šä¸äº‹ä»¶æ•è·æ°æ°ç›¸åï¼Œäº‹ä»¶å†’æ³¡é¡ºåºæ˜¯ç”±å†…åˆ°å¤–è¿›è¡Œäº‹ä»¶ä¼ æ’­ï¼Œç›´åˆ°æ ¹èŠ‚ç‚¹ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="https://lz5z.com/tags/JavaScript/"/>
    
      <category term="DOM" scheme="https://lz5z.com/tags/DOM/"/>
    
      <category term="äº‹ä»¶æµ" scheme="https://lz5z.com/tags/%E4%BA%8B%E4%BB%B6%E6%B5%81/"/>
    
      <category term="HTML" scheme="https://lz5z.com/tags/HTML/"/>
    
      <category term="äº‹ä»¶å§”æ‰˜/ä»£ç†" scheme="https://lz5z.com/tags/%E4%BA%8B%E4%BB%B6%E5%A7%94%E6%89%98-%E4%BB%A3%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>JavaScript ä¸­ çš„ DOM å’Œ BOM</title>
    <link href="https://lz5z.com/JavaScript%E4%B8%AD%E7%9A%84DOM%E5%92%8CBOM/"/>
    <id>https://lz5z.com/JavaScriptä¸­çš„DOMå’ŒBOM/</id>
    <published>2016-12-24T13:23:25.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h2>JavaScript ä¸ ECMAScript å…³ç³»</h2><p>JavaScript = ECMAScript + DOM + BOM</p><p>1.ECMAScript ä¸º JavaScript æä¾›æ ¸å¿ƒè¯­è¨€åŠŸèƒ½ï¼Œæ˜¯ç”±æ¬§æ´²è®¡ç®—æœºåˆ¶é€ å•†åä¼šï¼ˆECMAï¼‰39å·æŠ€æœ¯å§”å‘˜ä¼šï¼ˆTC39ï¼‰åˆ¶å®šçš„ä¸€ç§é€šç”¨ã€è·¨å¹³å°ã€ä¾›åº”å•†ä¸­ç«‹çš„è„šæœ¬è¯­è¨€å’Œè¯­ä¹‰ã€‚ECMAScript æ˜¯ä¸€ç§ç”± ECMA ç»„ç»‡é€šè¿‡ ECMA-262 æ ‡å‡†åŒ–çš„è„šæœ¬ç¨‹åºè®¾è®¡è¯­è¨€ã€‚ECMA-262 æ ‡å‡†æ²¡æœ‰å‚è€ƒ Web æµè§ˆå™¨ï¼Œå®ƒè§„å®šäº†è¯­è¨€çš„è¯­æ³•ã€ç±»å‹ã€è¯­å¥ã€å…³é”®å­—ã€ä¿ç•™å­—ã€æ“ä½œç¬¦ã€å¯¹è±¡ã€‚</p><p>2.DOM (æ–‡æ¡£å¯¹è±¡æ¨¡å‹) æ˜¯é’ˆå¯¹ XML ä½†æ˜¯ç»è¿‡æ‰©å±•ç”¨äº HTML çš„åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£ï¼ˆAPIï¼‰ã€‚DOM æŠŠ HTML é¡µé¢æ˜ å°„ä¸ºä¸€ä¸ªå¤šå±‚èŠ‚ç‚¹ç»“æ„ï¼Œå¼€å‘äººå‘˜å€ŸåŠ© DOM æä¾›çš„ APIï¼Œå¯ä»¥è½»æ¾åœ°åˆ é™¤ï¼Œæ·»åŠ ï¼Œæ›¿æ¢æˆ–è€…ä¿®æ”¹èŠ‚ç‚¹ã€‚</p><p>3.BOMï¼ˆæµè§ˆå™¨å¯¹è±¡æ¨¡å‹ï¼‰æŒ‡çš„æ˜¯ç”± Web æµè§ˆå™¨æš´éœ²çš„æ‰€æœ‰å¯¹è±¡ç»„æˆçš„è¡¨ç¤ºæ¨¡å‹ã€‚ä»æ ¹æœ¬ä¸Šå°† BOM åªå¤„ç†æµè§ˆå™¨çª—å£å’Œæ¡†æ¶ï¼Œä½†æ˜¯äººä»¬ä¹ æƒ¯æŠŠé’ˆå¯¹æµè§ˆå™¨çš„ JavaScript æ‰©å±•ä¹Ÿç®—ä½œ BOM çš„ä¸€éƒ¨åˆ†ï¼Œä¾‹å¦‚ï¼šæµè§ˆå™¨å¼¹å‡ºæ–°çª—å£çš„åŠŸèƒ½ï¼›ç§»åŠ¨ã€ç¼©æ”¾å’Œå…³é—­æµè§ˆå™¨çª—å£çš„åŠŸèƒ½ï¼›navigator å¯¹è±¡ï¼›location å¯¹è±¡ï¼› screen å¯¹è±¡ï¼›cookies æ”¯æŒï¼›XMLHttpRequest å’Œ IE çš„ ActiveXObject å¯¹è±¡ã€‚BOM ç›´åˆ° HTML5 æ‰æœ‰äº†è§„èŒƒå¯ä»¥éµå®ˆï¼Œåœ¨æ­¤ä¹‹å‰æ¯ä¸ªæµè§ˆå™¨éƒ½æœ‰è‡ªå·±ä¸åŒçš„å®ç°ã€‚</p><a id="more"></a><h3>DOM çº§åˆ«</h3><p>DOM1 çº§ç”±ä¸¤ä¸ªæ¨¡å—ç»„æˆï¼ŒDOM æ ¸å¿ƒï¼ˆDOM Coreï¼‰å’Œ DOM HTMLã€‚å…¶ä¸­ï¼ŒDOM Core è§„å®šå¦‚ä½•æ˜ å°„åŸºäº XML çš„æ–‡æ¡£ç»“æ„ï¼ŒDOM HTML æ¨¡å—åˆ™åœ¨ DOM Core åŸºç¡€ä¸ŠåŠ ä»¥æ‰©å±•ï¼Œæ·»åŠ äº†é’ˆå¯¹ HTML çš„å¯¹è±¡å’Œæ–¹æ³•ã€‚</p><p>DOM2 åœ¨åŸæœ‰çš„ DOM åŸºç¡€ä¸Šåˆæ‰©å……äº†é¼ æ ‡å’Œç”¨æˆ·ç•Œé¢äº‹ä»¶ã€èŒƒå›´ã€éå†ï¼ˆè¿­ä»£ DOM æ–‡æ¡£çš„æ–¹æ³•ï¼‰ç­‰ç»†åˆ†æ¨¡å—ï¼Œå¹¶ä¸”é€šè¿‡å¯¹è±¡æ¥å£å¢åŠ äº†å¯¹ CSS çš„æ”¯æŒã€‚DOM2 çº§å¼•å…¥çš„æ¨¡å—æœ‰ï¼š<br>- DOM è§†å›¾ï¼ˆDOM Viewsï¼‰ï¼šå®šä¹‰äº†è¿½è¸ªä¸åŒæ–‡æ¡£çš„è§†å›¾æ¥å£ã€‚<br>- DOM äº‹ä»¶ï¼ˆDOM Eventsï¼‰ï¼šå®šä¹‰äº†äº‹ä»¶å’Œäº‹ä»¶å¤„ç†çš„æ¥å£ã€‚<br>- DOM æ ·å¼ï¼ˆDOM Styleï¼‰ï¼šå®šä¹‰äº†åŸºäº CSS ä¸ºå…ƒç´ æ ·å¼çš„æ¥å£ã€‚<br>- DOM éå†å’ŒèŒƒå›´ï¼ˆDOM Traversal and Rangeï¼‰ï¼šå®šä¹‰äº†éå†å’Œæ“ä½œæ–‡æ¡£æ ‘çš„æ¥å£ã€‚</p><p>DOM3 çº§è¿›ä¸€æ­¥æ‰©å±• DOMï¼Œå¼•å…¥äº†ä»¥ç»Ÿä¸€æ–¹å¼åŠ è½½å’Œä¿å­˜æ–‡æ¡£çš„æ–¹æ³•â€”â€”åœ¨ DOM åŠ è½½å’Œä¿å­˜ï¼ˆDOM Load and Saveï¼‰æ¨¡å—ä¸­å®šä¹‰ï¼Œæ–°å¢äº† DOM éªŒè¯ï¼ˆDOM Validationï¼‰ã€‚DOM3 çº§ä¹Ÿå¯¹ DOM Core è¿›è¡Œäº†æ‰©å±•ï¼Œå¼€å§‹æ”¯æŒ XML 1.0 è§„èŒƒã€‚</p><blockquote><p>DOM0 çº§ï¼ŒDOM0 çº§æ ‡å‡†æœ¬è´¨ä¸Šä¸å­˜åœ¨ï¼Œæ‰€è°“ DOM0 åªæ˜¯ DOM å†å²åæ ‡ä¸­çš„ä¸€ä¸ªå‚ç…§ç‚¹ï¼Œå…·ä½“æ¥è¯´ï¼ŒDOM0 çº§æ˜¯æŒ‡ Internet Explorer 4.0 å’Œ Netscape Navigator 4.0 æœ€åˆæ”¯æŒçš„ DHTMLã€‚</p></blockquote><p>å¯ä»¥é€šè¿‡ä»¥ä¸‹ä»£ç ç¡®å®šæµè§ˆå™¨æ˜¯å¦æ”¯æŒ DOM æ¨¡å—ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> supportsDOM2Core = <span class="built_in">document</span>.implementation.hasFeature(<span class="string">'core'</span>, <span class="string">'2.0'</span>)</span><br><span class="line"><span class="keyword">var</span> supportsDOM3Core = <span class="built_in">document</span>.implementation.hasFeature(<span class="string">'core'</span>, <span class="string">'3.0'</span>)</span><br><span class="line"><span class="keyword">var</span> supportsDOM2HTML = <span class="built_in">document</span>.implementation.hasFeature(<span class="string">'HTML'</span>, <span class="string">'2.0'</span>)</span><br><span class="line"><span class="keyword">var</span> supportsDOM2Views = <span class="built_in">document</span>.implementation.hasFeature(<span class="string">'Views'</span>, <span class="string">'2.0'</span>)</span><br><span class="line"><span class="keyword">var</span> supportsDOM2XML =  <span class="built_in">document</span>.implementation.hasFeature(<span class="string">'XML'</span>, <span class="string">'2.0'</span>)</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;JavaScript ä¸ ECMAScript å…³ç³»&lt;/h2&gt;
&lt;p&gt;JavaScript = ECMAScript + DOM + BOM&lt;/p&gt;
&lt;p&gt;1.ECMAScript ä¸º JavaScript æä¾›æ ¸å¿ƒè¯­è¨€åŠŸèƒ½ï¼Œæ˜¯ç”±æ¬§æ´²è®¡ç®—æœºåˆ¶é€ å•†åä¼šï¼ˆECMAï¼‰39å·æŠ€æœ¯å§”å‘˜ä¼šï¼ˆTC39ï¼‰åˆ¶å®šçš„ä¸€ç§é€šç”¨ã€è·¨å¹³å°ã€ä¾›åº”å•†ä¸­ç«‹çš„è„šæœ¬è¯­è¨€å’Œè¯­ä¹‰ã€‚ECMAScript æ˜¯ä¸€ç§ç”± ECMA ç»„ç»‡é€šè¿‡ ECMA-262 æ ‡å‡†åŒ–çš„è„šæœ¬ç¨‹åºè®¾è®¡è¯­è¨€ã€‚ECMA-262 æ ‡å‡†æ²¡æœ‰å‚è€ƒ Web æµè§ˆå™¨ï¼Œå®ƒè§„å®šäº†è¯­è¨€çš„è¯­æ³•ã€ç±»å‹ã€è¯­å¥ã€å…³é”®å­—ã€ä¿ç•™å­—ã€æ“ä½œç¬¦ã€å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;2.DOM (æ–‡æ¡£å¯¹è±¡æ¨¡å‹) æ˜¯é’ˆå¯¹ XML ä½†æ˜¯ç»è¿‡æ‰©å±•ç”¨äº HTML çš„åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£ï¼ˆAPIï¼‰ã€‚DOM æŠŠ HTML é¡µé¢æ˜ å°„ä¸ºä¸€ä¸ªå¤šå±‚èŠ‚ç‚¹ç»“æ„ï¼Œå¼€å‘äººå‘˜å€ŸåŠ© DOM æä¾›çš„ APIï¼Œå¯ä»¥è½»æ¾åœ°åˆ é™¤ï¼Œæ·»åŠ ï¼Œæ›¿æ¢æˆ–è€…ä¿®æ”¹èŠ‚ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;3.BOMï¼ˆæµè§ˆå™¨å¯¹è±¡æ¨¡å‹ï¼‰æŒ‡çš„æ˜¯ç”± Web æµè§ˆå™¨æš´éœ²çš„æ‰€æœ‰å¯¹è±¡ç»„æˆçš„è¡¨ç¤ºæ¨¡å‹ã€‚ä»æ ¹æœ¬ä¸Šå°† BOM åªå¤„ç†æµè§ˆå™¨çª—å£å’Œæ¡†æ¶ï¼Œä½†æ˜¯äººä»¬ä¹ æƒ¯æŠŠé’ˆå¯¹æµè§ˆå™¨çš„ JavaScript æ‰©å±•ä¹Ÿç®—ä½œ BOM çš„ä¸€éƒ¨åˆ†ï¼Œä¾‹å¦‚ï¼šæµè§ˆå™¨å¼¹å‡ºæ–°çª—å£çš„åŠŸèƒ½ï¼›ç§»åŠ¨ã€ç¼©æ”¾å’Œå…³é—­æµè§ˆå™¨çª—å£çš„åŠŸèƒ½ï¼›navigator å¯¹è±¡ï¼›location å¯¹è±¡ï¼› screen å¯¹è±¡ï¼›cookies æ”¯æŒï¼›XMLHttpRequest å’Œ IE çš„ ActiveXObject å¯¹è±¡ã€‚BOM ç›´åˆ° HTML5 æ‰æœ‰äº†è§„èŒƒå¯ä»¥éµå®ˆï¼Œåœ¨æ­¤ä¹‹å‰æ¯ä¸ªæµè§ˆå™¨éƒ½æœ‰è‡ªå·±ä¸åŒçš„å®ç°ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="DOM" scheme="https://lz5z.com/tags/DOM/"/>
    
      <category term="BOM" scheme="https://lz5z.com/tags/BOM/"/>
    
  </entry>
  
  <entry>
    <title>Angular åŒå‘ç»‘å®šå®ç°åŸç†</title>
    <link href="https://lz5z.com/Angular%E5%8F%8C%E5%90%91%E7%BB%91%E5%AE%9A%E5%8E%9F%E7%90%86/"/>
    <id>https://lz5z.com/AngularåŒå‘ç»‘å®šåŸç†/</id>
    <published>2016-12-19T21:33:09.000Z</published>
    <updated>2020-04-21T10:23:54.823Z</updated>
    
    <content type="html"><![CDATA[<h1>ä»ä¸€ä¸ª demo è®²èµ·</h1><p>ç”¨ Angular + <a href="http://socket.io" target="_blank" rel="noopener">socket.io</a> åšäº†ä¸€ä¸ªèŠå¤© demoï¼Œæ¶ˆæ¯é€šä¿¡æ²¡æœ‰é—®é¢˜ï¼Œåœ¨ Angular æ•°æ®ç»‘å®šçš„åœ°æ–¹å´æ ½äº†è·Ÿå¤´ï¼šæ˜æ˜ model å·²ç»å‘ç”Ÿäº†æ”¹å˜ï¼Œåœ¨è§†å›¾ä¸Šå°±æ˜¯çœ‹ä¸åˆ°æ›´æ–°ã€‚</p><p>åæ¥ä»”ç»†ç ”ç©¶ï¼Œé€šè¿‡ä½¿ç”¨ â€œ$scope.$apply()â€ è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚</p><p>ä¹‹å‰å¯¹ Angular æ•°æ®åŒå‘ç»‘å®šåªæœ‰ä¸€ä¸ªå¤§æ¦‚çš„å°è±¡ï¼Œå¹¶æ²¡æœ‰æ·±å…¥åœ°äº†è§£ï¼Œæ­£å¥½è¶è¿™ä¸ªæœºä¼šå¥½å¥½å­¦ä¹ ä¸€ä¸‹æ•°æ®ç»‘å®šçš„è¿‡ç¨‹ã€‚</p><a id="more"></a><h2>ç®€åŒ–ä»£ç </h2><p>æœåŠ¡ç«¯ä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">'use strict'</span>;</span><br><span class="line"><span class="keyword">let</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">let</span> app = express();</span><br><span class="line"><span class="keyword">let</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>).Server(app);</span><br><span class="line"><span class="keyword">let</span> io = <span class="built_in">require</span>(<span class="string">'socket.io'</span>)(http);</span><br><span class="line"><span class="keyword">let</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line">app.use(express.static(path.join(__dirname, <span class="string">'public'</span>)));</span><br><span class="line">app.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    res.sendFile(__dirname + <span class="string">'/index.html'</span>);</span><br><span class="line">&#125;);</span><br><span class="line">io.on(<span class="string">'connection'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">socket</span>)</span>&#123;</span><br><span class="line">    <span class="comment">// æ¥æ”¶äº‹ä»¶</span></span><br><span class="line">    socket.on(<span class="string">'chat message'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">msg</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(msg);</span><br><span class="line">        <span class="comment">// å‘é€äº‹ä»¶</span></span><br><span class="line">        io.emit(<span class="string">'chat message'</span>, msg);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">http.listen(<span class="number">3000</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'listening on :3000'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯ä»£ç ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">ng-app</span>=<span class="string">"chatApp"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Socket.IO demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"style.css"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://ajax.googleapis.com/ajax/libs/angularjs/1.6.0/angular.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/socket.io/socket.io.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"main.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">ng-controller</span>=<span class="string">"ChatController"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">"messages"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">ng-repeat</span>=<span class="string">"item in chatMessage"</span>&gt;</span>&#123;&#123;item&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">ng-submit</span>=<span class="string">"submit()"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">input</span> <span class="attr">id</span>=<span class="string">"m"</span> <span class="attr">ng-model</span>=<span class="string">"chatInput"</span> <span class="attr">autocomplete</span>=<span class="string">"off"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span>&gt;</span>Send<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>CSS ä»£ç ç•¥ã€‚</p><p>JavaScript ä»£ç :</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">'use strict'</span>;</span><br><span class="line">angular.module(<span class="string">'chatApp'</span>, [])</span><br><span class="line">    .controller(<span class="string">'ChatController'</span>, [<span class="string">'$scope'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">$scope</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> socket = io();</span><br><span class="line">        $scope.chatMessage = [];</span><br><span class="line">        <span class="comment">// æ¥æ”¶äº‹ä»¶</span></span><br><span class="line">        socket.on(<span class="string">'chat message'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">msg</span>) </span>&#123;</span><br><span class="line">            $scope.chatMessage.push(msg);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        $scope.submit = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">//å‘é€äº‹ä»¶</span></span><br><span class="line">            socket.emit(<span class="string">'chat message'</span>, $scope.chatInput);</span><br><span class="line">            $scope.chatInput = <span class="string">''</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;]);</span><br></pre></td></tr></table></figure><p><a href="https://github.com/Leo555/socket.io-demo" target="_blank" rel="noopener">å®Œæ•´demoåœ°å€</a></p><p><a href="http://socket.io" target="_blank" rel="noopener">socket.io</a> é€šè¿‡ socket.emit() å‘é€äº‹ä»¶ï¼Œé€šè¿‡ socket.on() ç›‘å¬äº‹ä»¶ã€‚</p><p>ä¸Šé¢ä»£ç ä¼¼ä¹æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œå¯æ˜¯è¿è¡Œçš„æ—¶å€™æ€»æ˜¯å‘ç”Ÿè§†å›¾ä¸æ›´æ–°çš„æƒ…å†µã€‚<br>debug å‘ç° $scope.chatMessage çš„å€¼å·²ç»å‘ç”Ÿæ”¹å˜äº†ï¼ŒæŒ‰ç†è¯´ Angular çš„ model ä¸ view æ˜¯åŒå‘ç»‘å®šçš„ï¼Œmodel æ”¹å˜ view ä¹Ÿåº”è¯¥éšä¹‹æ›´æ–°æ‰å¯¹å•Šï¼Œä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§æƒ…å†µå‘¢ï¼Ÿ</p><h2>åˆ†æ</h2><p>$scope.chatMessage å‘ç”Ÿå˜åŒ–åï¼Œæ²¡æœ‰å¼ºåˆ¶ $digest å¾ªç¯ï¼Œç›‘è§† chatMessage çš„ $watch æ²¡æœ‰æ‰§è¡Œï¼Œè€Œæˆ‘ä»¬è‡ªå·±æ‰§è¡Œä¸€æ¬¡ $applyï¼Œé‚£ä¹ˆè¿™äº› $watch å°±ä¼šçœ‹è§è¿™äº›å˜åŒ–ï¼Œç„¶åæ ¹æ®éœ€è¦æ›´æ–° DOMã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;ä»ä¸€ä¸ª demo è®²èµ·&lt;/h1&gt;
&lt;p&gt;ç”¨ Angular + &lt;a href=&quot;http://socket.io&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;socket.io&lt;/a&gt; åšäº†ä¸€ä¸ªèŠå¤© demoï¼Œæ¶ˆæ¯é€šä¿¡æ²¡æœ‰é—®é¢˜ï¼Œåœ¨ Angular æ•°æ®ç»‘å®šçš„åœ°æ–¹å´æ ½äº†è·Ÿå¤´ï¼šæ˜æ˜ model å·²ç»å‘ç”Ÿäº†æ”¹å˜ï¼Œåœ¨è§†å›¾ä¸Šå°±æ˜¯çœ‹ä¸åˆ°æ›´æ–°ã€‚&lt;/p&gt;
&lt;p&gt;åæ¥ä»”ç»†ç ”ç©¶ï¼Œé€šè¿‡ä½¿ç”¨ â€œ$scope.$apply()â€ è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ä¹‹å‰å¯¹ Angular æ•°æ®åŒå‘ç»‘å®šåªæœ‰ä¸€ä¸ªå¤§æ¦‚çš„å°è±¡ï¼Œå¹¶æ²¡æœ‰æ·±å…¥åœ°äº†è§£ï¼Œæ­£å¥½è¶è¿™ä¸ªæœºä¼šå¥½å¥½å­¦ä¹ ä¸€ä¸‹æ•°æ®ç»‘å®šçš„è¿‡ç¨‹ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="https://lz5z.com/tags/JavaScript/"/>
    
      <category term="Angular" scheme="https://lz5z.com/tags/Angular/"/>
    
      <category term="socket.io" scheme="https://lz5z.com/tags/socket-io/"/>
    
      <category term="$digest" scheme="https://lz5z.com/tags/digest/"/>
    
      <category term="$apply" scheme="https://lz5z.com/tags/apply/"/>
    
  </entry>
  
  <entry>
    <title>è·¨åŸŸå®è·µ</title>
    <link href="https://lz5z.com/%E8%B7%A8%E5%9F%9F%E5%AE%9E%E8%B7%B5/"/>
    <id>https://lz5z.com/è·¨åŸŸå®è·µ/</id>
    <published>2016-12-16T01:04:17.000Z</published>
    <updated>2020-04-21T10:23:54.831Z</updated>
    
    <content type="html"><![CDATA[<h1>èƒŒæ™¯</h1><p>æœ€è¿‘åœ¨ ITA å†™äº†ä¸€ä¸ªèŠå¤©æœºå™¨äººçš„ Flask æœåŠ¡ï¼Œè‡ªå·±å†™äº†ä¸€äº› node å•å…ƒæµ‹è¯•è„šæœ¬è·‘æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯æµ‹è¯•çš„åŒå­¦ä¹Ÿæƒ³è¦†ç›–åˆ°æ‰€æœ‰çš„ caseï¼Œäºæ˜¯å°±å¸®å¿™å†™ä¸€ä¸ª html é¡µé¢å»æµ‹è¯•ï¼Œç„¶åå°±é‡åˆ°äº†ä¸‹é¢çš„é—®é¢˜ï¼š</p><blockquote><p>XMLHttpRequest cannot load <a href="http://localhost:8085/predict" target="_blank" rel="noopener">http://localhost:8085/predict</a>. No â€˜Access-Control-Allow-Originâ€™ header is present on the requested resource. Origin â€˜nullâ€™ is therefore not allowed access.</p></blockquote><p>è¿™ä¸ªæ˜¯å…¸å‹çš„è·¨åŸŸé—®é¢˜(è·¨åŸŸæ˜¯æŒ‡ï¼šåè®®ã€åŸŸåã€ç«¯å£æœ‰ä»»ä½•ä¸€ä¸ªä¸åŒï¼Œéƒ½è¢«å½“åšæ˜¯ä¸åŒçš„åŸŸ)ï¼Œæƒ³æƒ³ä¹‹å‰ä¹Ÿäº†è§£è¿‡è·¨åŸŸçš„çŸ¥è¯†ï¼Œç°åœ¨å€Ÿç€è¿™ä¸ªæœºä¼šæ€»ç»“ä¸€ä¸‹äº†ã€‚å…³äº GET è¯·æ±‚çš„è·¨åŸŸï¼Œä½¿ç”¨ JSONP æ˜¯ç›®å‰æœ€å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œå„å¤§æµè§ˆå™¨ä¹ŸåŸºæœ¬éƒ½æ”¯æŒ JSONPï¼Œè€Œ jQueryï¼ŒAngularJS ç­‰å‰ç«¯æ¡†æ¶ä¹Ÿéƒ½é»˜è®¤æ·»åŠ äº†å¯¹ JSONP çš„å°è£…ï¼Œå¹¶ä¸”è¿™æ¬¡é‡åˆ°çš„è·¨åŸŸé—®é¢˜æ˜¯ POST è¯·æ±‚çš„ï¼Œäºæ˜¯æš‚æ—¶å…ˆä¸å†™å…³äº JSONP çš„ç›¸å…³çŸ¥è¯†ã€‚</p><a id="more"></a><h2>ç®€åŒ–ä»£ç </h2><p>æœåŠ¡å™¨ä»£ç :</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    print(<span class="string">'Start server'</span>)</span><br><span class="line">    app = Flask(__name__)</span><br><span class="line">    <span class="comment"># è·¯ç”±</span></span><br><span class="line"><span class="meta">    @app.route('/predict', methods=['POST'])</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">()</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">'result'</span></span><br><span class="line">    app.run(host=<span class="string">'0.0.0.0'</span>, port=<span class="number">8085</span>, debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p>é¡µé¢ä»£ç ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">ng-app</span>=<span class="string">"chatApp"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://ajax.googleapis.com/ajax/libs/angularjs/1.6.0/angular.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./main.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-controller</span>=<span class="string">"ChatController"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">ng-model</span>=<span class="string">"chat"</span> <span class="attr">placeholder</span>=<span class="string">"Enter content here"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">ng-click</span>=<span class="string">"onclick()"</span>&gt;</span>POST<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span> &#123;&#123; result &#125;&#125; <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>â€“ åŸè°…æˆ‘ç”¨ Angular åšé¡µé¢ â˜¹</p><p>main.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">angular.module(<span class="string">'chatApp'</span>, [])</span><br><span class="line">    .controller(<span class="string">'ChatController'</span>, [<span class="string">'$scope'</span>, <span class="string">'$http'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope, $http</span>) </span>&#123;</span><br><span class="line">        $scope.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            $http(&#123;</span><br><span class="line">                method: <span class="string">'POST'</span>,</span><br><span class="line">                url: <span class="string">'http://localhost:8085/predict'</span></span><br><span class="line">            &#125;).then(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">                $scope.result = data;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;]);</span><br></pre></td></tr></table></figure><h2>è§£å†³æ–¹æ¡ˆ</h2><p>è¦æƒ³è§£å†³è·¨åŸŸï¼Œå¿…å…ˆç†è§£è·¨åŸŸã€‚é‚£ä»€ä¹ˆæ˜¯è·¨åŸŸå‘¢ï¼Ÿ<br>å¯¹äº web å¼€å‘æ¥è®²ï¼Œç”±äºæµè§ˆå™¨çš„åŒæºç­–ç•¥ï¼Œæˆ‘ä»¬éœ€è¦ç»å¸¸ä½¿ç”¨ä¸€äº› hack çš„æ–¹æ³•å»è·¨åŸŸè·å–èµ„æºï¼Œç›´åˆ° W3C å‡ºäº†ä¸€ä¸ªæ ‡å‡†ï¼<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS" target="_blank" rel="noopener">CORS</a>ï¼â€œè·¨åŸŸèµ„æºå…±äº«â€ï¼ˆCross-origin resource sharingï¼‰ï¼Œ<br>å®ƒå…è®¸æµè§ˆå™¨å‘è·¨æºæœåŠ¡å™¨ï¼Œå‘å‡º XMLHttpRequest è¯·æ±‚ï¼Œä»è€Œå…‹æœäº† AJAX åªèƒ½åŒæºä½¿ç”¨çš„é™åˆ¶ã€‚</p><p>CORS ä¸ JSONP çš„ä½¿ç”¨ç›®çš„ç›¸åŒï¼Œä½†æ˜¯æ¯” JSONP æ›´å¼ºå¤§ã€‚<br><strong>JSONP åªæ”¯æŒ GET è¯·æ±‚ï¼ŒCORS æ”¯æŒæ‰€æœ‰ç±»å‹çš„ HTTP è¯·æ±‚ã€‚JSONP çš„ä¼˜åŠ¿åœ¨äºæ”¯æŒè€å¼æµè§ˆå™¨ï¼Œä»¥åŠå¯ä»¥å‘ä¸æ”¯æŒ CORS çš„ç½‘ç«™è¯·æ±‚æ•°æ®ã€‚</strong></p><p>CORS è§£å†³æ–¹æ¡ˆï¼š</p><p>(1) æœåŠ¡å™¨ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, Response, request</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    print(<span class="string">'Start server'</span>)</span><br><span class="line">    app = Flask(__name__)</span><br><span class="line">    <span class="comment"># post</span></span><br><span class="line"><span class="meta">    @app.route('/predict', methods=['POST'])</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">()</span>:</span></span><br><span class="line">        <span class="keyword">if</span> request.form.get(<span class="string">'content'</span>) <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            exp = <span class="string">'Missing content'</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            exp = request.form.get(<span class="string">'content'</span>)</span><br><span class="line">        print(exp)</span><br><span class="line">        headers = &#123;<span class="string">"Access-Control-Allow-Origin"</span>: <span class="string">"*"</span>&#125;</span><br><span class="line">        <span class="keyword">return</span> Response(exp, headers=headers)</span><br><span class="line">    <span class="comment"># port=8085</span></span><br><span class="line">    app.run(host=<span class="string">'0.0.0.0'</span>, port=<span class="number">8085</span>, debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p>(2) main.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">angular.module(<span class="string">'chatApp'</span>, [])</span><br><span class="line">    .controller(<span class="string">'ChatController'</span>, [<span class="string">'$scope'</span>, <span class="string">'$http'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope, $http</span>) </span>&#123;</span><br><span class="line">        $scope.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            $http(&#123;</span><br><span class="line">                method: <span class="string">'POST'</span>,</span><br><span class="line">                url: <span class="string">'http://localhost:8085/predict'</span>,</span><br><span class="line">                headers: &#123;</span><br><span class="line">                    <span class="string">'Content-Type'</span>: <span class="string">'application/x-www-form-urlencoded'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                data: <span class="string">'content= '</span> + $scope.chat</span><br><span class="line"></span><br><span class="line">            &#125;).then(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">                $scope.result = data.data;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;]);</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å†æ¬¡å‘é€ Ajax callå°±å¯ä»¥æ‹¿åˆ°ç»“æœäº†:</p><img src="/assets/img/cors-post.png" alt="cors-post"><p>æ³¨æ„åˆ°æœåŠ¡å™¨ç«¯ä»£ç å‘ç”Ÿäº†ä¸€ç‚¹æ”¹åŠ¨ï¼Œé‚£å°±æ˜¯åœ¨Response headerä¸­å¢åŠ äº†ä¸€ä¸ªå‚æ•° â€œAccess-Control-Allow-Originâ€ï¼Œè¡¨ç¤ºæ¥å—æŸåŸŸåçš„è¯·æ±‚ï¼Œâ€œ*â€ è¡¨ç¤ºå…è®¸æ‰€æœ‰çš„è¯·æ±‚ã€‚<br>ä¹Ÿå¯ä»¥ä½¿ç”¨ç¡®å®šçš„å€¼ï¼Œå¦‚ï¼š â€œ<a href="http://api.abc.com" target="_blank" rel="noopener">http://api.abc.com</a>â€ã€‚</p><p>äºæ˜¯ä»£ç ä¸­å¢åŠ  <em><em>headers = {â€œAccess-Control-Allow-Originâ€: &quot;</em>&quot;}</em>* åæœåŠ¡å™¨å°±å¯ä»¥å“åº”æ‰€æœ‰çš„è¯·æ±‚äº†ã€‚</p><p>å†çœ‹ Web ç«¯çš„ä»£ç ï¼Œæˆ‘ä»¬åœ¨è¯·æ±‚å¤´é‡Œé¢æ·»åŠ äº† â€œContent-Typeâ€ï¼Œä¸ºäº†èƒ½å‘æœåŠ¡ç«¯ä¼ é€’æ•°æ®ã€‚è¿™é‡Œä½¿ç”¨çš„ â€œContent-Typeâ€ ä¸º â€œapplication/x-www-form-urlencodedâ€ è¡¨ç¤ºä»¥è¡¨å•æäº¤çš„å½¢å¼ä¼ é€’å‚æ•°ã€‚</p><p><strong>ä¸ºä»€ä¹ˆè¦ç”¨è¡¨å•çš„å½¢å¼æäº¤POSTè¯·æ±‚å‘¢ï¼Ÿ</strong></p><h2>ä¸¤ç§è¯·æ±‚</h2><p>æµè§ˆå™¨å°† CORS è¯·æ±‚åˆ†æˆä¸¤ç±»ï¼šç®€å•è¯·æ±‚ï¼ˆsimple requestï¼‰å’Œéç®€å•è¯·æ±‚ï¼ˆnot-so-simple requestï¼‰ã€‚</p><p>åªè¦åŒæ—¶æ»¡è¶³ä»¥ä¸‹ä¸¤å¤§æ¡ä»¶ï¼Œå°±å±äºç®€å•è¯·æ±‚ã€‚</p><blockquote><p>(1) è¯·æ±‚æ–¹æ³•æ˜¯ä»¥ä¸‹ä¸‰ç§æ–¹æ³•ä¸­çš„ä¸€ä¸ªï¼š</p></blockquote><ul><li><strong>HEAD</strong></li><li><strong>GET</strong></li><li><strong>POST</strong><br>(2) HTTPçš„å¤´ä¿¡æ¯ä¸è¶…å‡ºä»¥ä¸‹å‡ ç§å­—æ®µï¼š</li><li><strong>Accept</strong></li><li><strong>Accept-Language</strong></li><li><strong>Content-Language</strong></li><li><strong>Last-Event-ID</strong></li><li><strong>Content-Type</strong>  å…¶å€¼ä»…é™äº <strong>application/x-www-form-urlencodedã€multipart/form-dataã€text/plain</strong></li></ul><p>ä¸Šæ–‡ä¸­çš„è¯·æ±‚å±äºç®€å•è¯·æ±‚ã€‚</p><h3>ç®€å•è¯·æ±‚ï¼ˆsimple requestï¼‰</h3><p>å¯¹äºç®€å•çš„è·¨åŸŸè¯·æ±‚ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨åœ¨è¯·æ±‚çš„å¤´ä¿¡æ¯åŠ ä¸Š Origin å­—æ®µï¼Œè¡¨ç¤ºæœ¬æ¬¡è¯·æ±‚æ¥è‡ªå“ªä¸ªæºï¼ˆåè®® + åŸŸå + ç«¯å£ï¼‰ï¼ŒæœåŠ¡ç«¯ä¼šè·å–åˆ°è¿™ä¸ªå€¼ï¼Œç„¶ååˆ¤æ–­æ˜¯å¦åŒæ„è¿™æ¬¡è¯·æ±‚å¹¶è¿”å›ã€‚</p><blockquote><p>// è¯·æ±‚<br>GET /cors HTTP/1.1<br>Origin: <a href="http://api.abc.com" target="_blank" rel="noopener">http://api.abc.com</a><br>Host: <a href="http://api.bcd.com" target="_blank" rel="noopener">api.bcd.com</a><br>Accept-Language: en-US<br>Connection: keep-alive<br>User-Agent: Mozilla/5.0â€¦</p></blockquote><p>å¦‚æœæœåŠ¡ç«¯è®¸å¯æœ¬æ¬¡è¯·æ±‚ï¼Œå°±ä¼šåœ¨è¿”å›çš„å¤´ä¿¡æ¯å¤šå‡ºå…³äº <strong>Access-Control</strong> çš„ä¿¡æ¯ï¼Œæ¯”å¦‚ä¸Šè¿°æœåŠ¡å™¨è¿”å›çš„ä¿¡æ¯ï¼š</p><img src="/assets/img/cors-res-header.png" alt="cors-res-header"><h3>éç®€å•è¯·æ±‚ï¼ˆnot-so-simple requestï¼‰</h3><p>éç®€å•è¯·æ±‚æ˜¯é‚£ç§å¯¹æœåŠ¡å™¨æœ‰ç‰¹æ®Šè¦æ±‚çš„è¯·æ±‚ï¼Œæ¯”å¦‚è¯·æ±‚æ–¹æ³•æ˜¯ PUT æˆ– DELETEï¼Œæˆ–è€… Content-Type å­—æ®µçš„ç±»å‹æ˜¯ application/jsonã€‚</p><p>éç®€å•è¯·æ±‚çš„ CORS è¯·æ±‚ï¼Œä¼šåœ¨æ­£å¼é€šä¿¡ä¹‹å‰ï¼Œå¢åŠ ä¸€æ¬¡ HTTP æŸ¥è¯¢è¯·æ±‚ï¼Œç§°ä¸ºâ€œé¢„æ£€â€è¯·æ±‚ï¼ˆpreflightï¼‰ã€‚<br>æµè§ˆå™¨å…ˆè¯¢é—®æœåŠ¡å™¨ï¼Œå½“å‰ç½‘é¡µæ‰€åœ¨çš„åŸŸåæ˜¯å¦åœ¨æœåŠ¡å™¨çš„è®¸å¯åå•ä¹‹ä¸­ï¼Œä»¥åŠå¯ä»¥ä½¿ç”¨å“ªäº› HTTP åŠ¨è¯å’Œå¤´ä¿¡æ¯å­—æ®µã€‚åªæœ‰å¾—åˆ°è‚¯å®šç­”å¤ï¼Œæµè§ˆå™¨æ‰ä¼šå‘å‡ºæ­£å¼çš„ XMLHttpRequest è¯·æ±‚ï¼Œå¦åˆ™å°±æŠ¥é”™ã€‚</p><p>â€œé¢„æ£€â€è¯·æ±‚ç”¨çš„è¯·æ±‚æ–¹æ³•æ˜¯ <strong>OPTIONS</strong>ï¼Œè¡¨ç¤ºè¿™ä¸ªè¯·æ±‚æ˜¯ç”¨æ¥è¯¢é—®çš„ã€‚å¤´ä¿¡æ¯é‡Œé¢ï¼Œå…³é”®å­—æ®µæ˜¯Originï¼Œè¡¨ç¤ºè¯·æ±‚æ¥è‡ªå“ªä¸ªæºã€‚</p><h2>éç®€å•è¯·æ±‚è§£å†³æ–¹æ¡ˆ</h2><p>é¡¹ç›®ä¸­ä½¿ç”¨çš„ Content-Type ä¸º <strong>application/json</strong>ï¼Œå±äºéç®€å•è¯·æ±‚ï¼Œå°†ä¸Šè¿°ç¨‹åºä¿®æ”¹ä¸º</p><p>(1) main.js:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">angular.module(<span class="string">'chatApp'</span>, [])</span><br><span class="line">    .controller(<span class="string">'ChatController'</span>, [<span class="string">'$scope'</span>, <span class="string">'$http'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$scope, $http</span>) </span>&#123;</span><br><span class="line">        $scope.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            $http(&#123;</span><br><span class="line">                method: <span class="string">'POST'</span>,</span><br><span class="line">                url: <span class="string">'http://localhost:8086/predict'</span>,</span><br><span class="line">                headers: &#123;</span><br><span class="line">                    <span class="string">'Content-Type'</span>: <span class="string">'application/json'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                data: <span class="built_in">JSON</span>.stringify(&#123;</span><br><span class="line">                    <span class="string">'content'</span>: $scope.chat</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;).then(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">                $scope.result = data.data;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;]);</span><br></pre></td></tr></table></figure><p>æœåŠ¡å™¨ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, Response, request</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    print(<span class="string">'Start server'</span>)</span><br><span class="line">    app = Flask(__name__)</span><br><span class="line">    <span class="comment"># è·¯ç”±</span></span><br><span class="line"><span class="meta">    @app.route('/predict', methods=['POST', 'OPTIONS'])</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># è¿”å›å¤´</span></span><br><span class="line">        headers = &#123;<span class="string">"Access-Control-Allow-Origin"</span>: <span class="string">"*"</span>,</span><br><span class="line">                   <span class="string">"Access-Control-Allow-Headers"</span>: <span class="string">"Origin, X-Requested-With, Content-Type"</span>,</span><br><span class="line">                   <span class="string">"Access-Control-Allow-Methods"</span>: <span class="string">"POST, PUT, GET, OPTIONS, DELETE"</span>&#125;</span><br><span class="line">        <span class="comment"># preflight</span></span><br><span class="line">        <span class="keyword">if</span> request.method == <span class="string">'OPTIONS'</span>:</span><br><span class="line">            <span class="keyword">return</span> Response(headers=headers)</span><br><span class="line">        <span class="comment"># request</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">'content'</span> <span class="keyword">in</span> request.json:</span><br><span class="line">            exp = request.json.get(<span class="string">'content'</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            exp = <span class="string">'Missing content'</span></span><br><span class="line">        print(exp)</span><br><span class="line">        <span class="keyword">return</span> Response(exp, headers=headers)</span><br><span class="line">    <span class="comment"># run server</span></span><br><span class="line">    app.run(host=<span class="string">'0.0.0.0'</span>, port=<span class="number">8086</span>, debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p>å¯åŠ¨åå‘é€è¯·æ±‚ï¼Œå‘ç°å¯ä»¥è·‘é€šï¼Œä½†æ˜¯è·å–ä¸åˆ°å‚æ•°ï¼ŒåŸå› æ˜¯ä½¿ç”¨ <strong>application/json</strong> çš„å½¢å¼å‘é€ requestï¼Œ å‚æ•°å¹¶æ²¡æœ‰æ”¾åœ¨ form é‡Œé¢ï¼Œè€Œæ˜¯æ”¾åœ¨ request.data é‡Œé¢äº†ã€‚<br>request.data é‡Œé¢ä¸º bytes ç±»å‹çš„æ•°æ®ï¼Œé€šè¿‡ request.json å¯ä»¥è·å–å…¶ dict ç±»å‹ã€‚</p><p>é€šè¿‡ä»¥ä¸Šæ–¹å¼ï¼Œå®Œç¾åœ°è§£å†³äº†å¤æ‚è¯·æ±‚çš„è·¨åŸŸé—®é¢˜ã€‚</p><p>æ‰æ€ªå˜ï¼ï¼ï¼â™‹</p><h2>é—®é¢˜æ‰€åœ¨</h2><p>ä»¥ä¸Šè§£å†³è·¨åŸŸçš„æ–¹å¼ä¸º CORSï¼Œå‡†ç¡®åœ°è¯´ï¼Œè¿™æ˜¯ä¸€ç§æœåŠ¡å™¨ç«¯çš„æŠ€æœ¯ã€‚è€Œç°å®ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå¦‚æœä¸€ä¸ªå‰ç«¯æƒ³è¦ç”¨è¿™ç§æ–¹å¼å®ç°è·¨åŸŸï¼Œä¸çŸ¥é“è¦è·Ÿåç«¯åšå¤šå°‘æ²Ÿé€šï¼Œé‚£æœ‰æ²¡æœ‰çº¯å‰ç«¯çš„è§£å†³æ–¹æ¡ˆå‘¢ï¼Ÿ<br>ä¸”å¬ä¸‹å›åˆ†è§£ã€‚â˜›</p>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;èƒŒæ™¯&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘åœ¨ ITA å†™äº†ä¸€ä¸ªèŠå¤©æœºå™¨äººçš„ Flask æœåŠ¡ï¼Œè‡ªå·±å†™äº†ä¸€äº› node å•å…ƒæµ‹è¯•è„šæœ¬è·‘æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯æµ‹è¯•çš„åŒå­¦ä¹Ÿæƒ³è¦†ç›–åˆ°æ‰€æœ‰çš„ caseï¼Œäºæ˜¯å°±å¸®å¿™å†™ä¸€ä¸ª html é¡µé¢å»æµ‹è¯•ï¼Œç„¶åå°±é‡åˆ°äº†ä¸‹é¢çš„é—®é¢˜ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;XMLHttpRequest cannot load &lt;a href=&quot;http://localhost:8085/predict&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://localhost:8085/predict&lt;/a&gt;. No â€˜Access-Control-Allow-Originâ€™ header is present on the requested resource. Origin â€˜nullâ€™ is therefore not allowed access.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™ä¸ªæ˜¯å…¸å‹çš„è·¨åŸŸé—®é¢˜(è·¨åŸŸæ˜¯æŒ‡ï¼šåè®®ã€åŸŸåã€ç«¯å£æœ‰ä»»ä½•ä¸€ä¸ªä¸åŒï¼Œéƒ½è¢«å½“åšæ˜¯ä¸åŒçš„åŸŸ)ï¼Œæƒ³æƒ³ä¹‹å‰ä¹Ÿäº†è§£è¿‡è·¨åŸŸçš„çŸ¥è¯†ï¼Œç°åœ¨å€Ÿç€è¿™ä¸ªæœºä¼šæ€»ç»“ä¸€ä¸‹äº†ã€‚å…³äº GET è¯·æ±‚çš„è·¨åŸŸï¼Œä½¿ç”¨ JSONP æ˜¯ç›®å‰æœ€å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œå„å¤§æµè§ˆå™¨ä¹ŸåŸºæœ¬éƒ½æ”¯æŒ JSONPï¼Œè€Œ jQueryï¼ŒAngularJS ç­‰å‰ç«¯æ¡†æ¶ä¹Ÿéƒ½é»˜è®¤æ·»åŠ äº†å¯¹ JSONP çš„å°è£…ï¼Œå¹¶ä¸”è¿™æ¬¡é‡åˆ°çš„è·¨åŸŸé—®é¢˜æ˜¯ POST è¯·æ±‚çš„ï¼Œäºæ˜¯æš‚æ—¶å…ˆä¸å†™å…³äº JSONP çš„ç›¸å…³çŸ¥è¯†ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="https://lz5z.com/tags/JavaScript/"/>
    
      <category term="HTTP" scheme="https://lz5z.com/tags/HTTP/"/>
    
      <category term="Flask" scheme="https://lz5z.com/tags/Flask/"/>
    
      <category term="CORS" scheme="https://lz5z.com/tags/CORS/"/>
    
      <category term="è·¨åŸŸ" scheme="https://lz5z.com/tags/%E8%B7%A8%E5%9F%9F/"/>
    
  </entry>
  
  <entry>
    <title>Pandas æ•°æ®å¤„ç†å­¦ä¹ </title>
    <link href="https://lz5z.com/Pandas%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E5%AD%A6%E4%B9%A0/"/>
    <id>https://lz5z.com/Pandasæ•°æ®å¤„ç†å­¦ä¹ /</id>
    <published>2016-12-07T21:07:46.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h1>10åˆ†é’Ÿ Pandas å…¥é—¨</h1><p>Pandas æ˜¯ Python åšæ•°æ®åˆ†ææœ€é‡è¦çš„æ¨¡å—ä¹‹ä¸€ï¼Œæœ¬æ–‡æºè‡ªPandas ä½œè€… Wes McKinney å†™çš„ <a href="http://pandas.pydata.org/pandas-docs/stable/10min.html" target="_blank" rel="noopener">10-minute tour of pandas</a>ã€‚</p><p>é¦–å…ˆå®‰è£… Pandas å’Œç›¸å…³çš„ä¸¤ä¸ªåŒ… numpyã€matplotlib</p><a id="more"></a><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip install pandas</span><br><span class="line">pip install numpy</span><br><span class="line">pip install matplotlib</span><br></pre></td></tr></table></figure><p>å¯¼å…¥ pandasã€numpyã€matplotlib</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br></pre></td></tr></table></figure><h2>å¯¹è±¡åˆ›å»º</h2><p>Series æ˜¯ä¸€ä¸ªåºåˆ—ï¼Œä½¿ç”¨ Pandas åˆ›å»ºä¸€ä¸ªæ•´æ•°ç´¢å¼•çš„åºåˆ—ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = pd.Series([<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,np.nan,<span class="number">6</span>,<span class="number">8</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s</span><br><span class="line"><span class="number">0</span>    <span class="number">1.0</span></span><br><span class="line"><span class="number">1</span>    <span class="number">3.0</span></span><br><span class="line"><span class="number">2</span>    <span class="number">5.0</span></span><br><span class="line"><span class="number">3</span>    NaN</span><br><span class="line"><span class="number">4</span>    <span class="number">6.0</span></span><br><span class="line"><span class="number">5</span>    <span class="number">8.0</span></span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure><p>DataFrame æ˜¯æœ‰å¤šä¸ªåˆ—çš„æ•°æ®è¡¨ï¼Œæ¯ä¸ªåˆ—æ‹¥æœ‰ä¸€ä¸ª labelï¼Œå½“ç„¶ï¼ŒDataFrame ä¹Ÿæœ‰ç´¢å¼•:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>dates = pd.date_range(<span class="string">'20170101'</span>, periods=<span class="number">6</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dates</span><br><span class="line">DatetimeIndex([<span class="string">'2017-01-01'</span>, <span class="string">'2017-01-02'</span>, <span class="string">'2017-01-03'</span>, <span class="string">'2017-01-04'</span>,</span><br><span class="line">               <span class="string">'2017-01-05'</span>, <span class="string">'2017-01-06'</span>],</span><br><span class="line">              dtype=<span class="string">'datetime64[ns]'</span>, freq=<span class="string">'D'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df = pd.DataFrame(np.random.randn(<span class="number">6</span>,<span class="number">4</span>), index=dates, columns=list(<span class="string">'ABCD'</span>))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&gt;&gt;&gt; df.shape</span><br><span class="line">(<span class="number">6</span>, <span class="number">5</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df</span><br><span class="line">                   A         B         C         D</span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-01</span>  <span class="number">0.147072</span>  <span class="number">1.235226</span>  <span class="number">0.143952</span>  <span class="number">0.831411</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-02</span>  <span class="number">0.862293</span> <span class="number">-0.725103</span> <span class="number">-0.104664</span>  <span class="number">1.265863</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-03</span>  <span class="number">0.281511</span>  <span class="number">0.956868</span> <span class="number">-0.741193</span>  <span class="number">0.129071</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-04</span> <span class="number">-0.664475</span>  <span class="number">0.965653</span>  <span class="number">1.522392</span>  <span class="number">1.129707</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-05</span> <span class="number">-1.364532</span> <span class="number">-0.167877</span>  <span class="number">0.078448</span>  <span class="number">0.217550</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">0.717721</span>  <span class="number">0.344734</span> <span class="number">-0.951364</span>  <span class="number">0.362032</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡ä¸€ä¸ªå¯¹è±¡å­—å…¸åˆ›å»º DataFrameï¼Œ dict çš„æ¯ä¸ª value ä¼šè¢«è½¬åŒ–æˆä¸€ä¸ª Seriesï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>df2 = pd.DataFrame(&#123; <span class="string">'A'</span> : <span class="number">1.</span>, </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span> <span class="string">'B'</span> : pd.Timestamp(<span class="string">'20170102'</span>), </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span> <span class="string">'C'</span> : pd.Series(<span class="number">1</span>,index=list(range(<span class="number">4</span>)),dtype=<span class="string">'float32'</span>), </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span> <span class="string">'D'</span> : np.array([<span class="number">3</span>] * <span class="number">4</span>,dtype=<span class="string">'int32'</span>), </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span> <span class="string">'E'</span> : pd.Categorical([<span class="string">"test"</span>,<span class="string">"train"</span>,<span class="string">"test"</span>,<span class="string">"train"</span>]), </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span> <span class="string">'F'</span> : <span class="string">'foo'</span> &#125;)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df2</span><br><span class="line">     A          B    C  D      E    F</span><br><span class="line"><span class="number">0</span>  <span class="number">1.0</span> <span class="number">2017</span><span class="number">-01</span><span class="number">-02</span>  <span class="number">1.0</span>  <span class="number">3</span>   test  foo</span><br><span class="line"><span class="number">1</span>  <span class="number">1.0</span> <span class="number">2017</span><span class="number">-01</span><span class="number">-02</span>  <span class="number">1.0</span>  <span class="number">3</span>  train  foo</span><br><span class="line"><span class="number">2</span>  <span class="number">1.0</span> <span class="number">2017</span><span class="number">-01</span><span class="number">-02</span>  <span class="number">1.0</span>  <span class="number">3</span>   test  foo</span><br><span class="line"><span class="number">3</span>  <span class="number">1.0</span> <span class="number">2017</span><span class="number">-01</span><span class="number">-02</span>  <span class="number">1.0</span>  <span class="number">3</span>  train  foo</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹æ¯åˆ—çš„æ ¼å¼ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>df2.dtypes</span><br><span class="line">A           float64</span><br><span class="line">B    datetime64[ns]</span><br><span class="line">C           float32</span><br><span class="line">D             int32</span><br><span class="line">E          category</span><br><span class="line">F            object</span><br><span class="line">dtype: object</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹æŸä¸€åˆ—çš„å…·ä½“å€¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>df2.C</span><br><span class="line"><span class="number">0</span>    <span class="number">1.0</span></span><br><span class="line"><span class="number">1</span>    <span class="number">1.0</span></span><br><span class="line"><span class="number">2</span>    <span class="number">1.0</span></span><br><span class="line"><span class="number">3</span>    <span class="number">1.0</span></span><br><span class="line">Name: C, dtype: float32</span><br></pre></td></tr></table></figure><h2>æŸ¥çœ‹æ•°æ®</h2><p>ä½¿ç”¨ head() æŸ¥çœ‹ DataFrame å‰å‡ è¡Œï¼› tail() æŸ¥çœ‹åå‡ è¡Œï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.head(<span class="number">3</span>)</span><br><span class="line">                   A         B         C         D</span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-01</span>  <span class="number">0.147072</span>  <span class="number">1.235226</span>  <span class="number">0.143952</span>  <span class="number">0.831411</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-02</span>  <span class="number">0.862293</span> <span class="number">-0.725103</span> <span class="number">-0.104664</span>  <span class="number">1.265863</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-03</span>  <span class="number">0.281511</span>  <span class="number">0.956868</span> <span class="number">-0.741193</span>  <span class="number">0.129071</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.tail(<span class="number">3</span>)</span><br><span class="line">                   A         B         C         D</span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-04</span> <span class="number">-0.664475</span>  <span class="number">0.965653</span>  <span class="number">1.522392</span>  <span class="number">1.129707</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-05</span> <span class="number">-1.364532</span> <span class="number">-0.167877</span>  <span class="number">0.078448</span>  <span class="number">0.217550</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">0.717721</span>  <span class="number">0.344734</span> <span class="number">-0.951364</span>  <span class="number">0.362032</span></span><br></pre></td></tr></table></figure><p>å®é™…ä¸Šï¼ŒDataFrame å†…éƒ¨ç”¨ numpy æ ¼å¼å­˜å‚¨æ•°æ®ã€‚ä½ ä¹Ÿå¯ä»¥å•ç‹¬æŸ¥çœ‹ indexã€columns å’Œ valuesï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.index</span><br><span class="line">DatetimeIndex([<span class="string">'2017-01-01'</span>, <span class="string">'2017-01-02'</span>, <span class="string">'2017-01-03'</span>, <span class="string">'2017-01-04'</span>,</span><br><span class="line">               <span class="string">'2017-01-05'</span>, <span class="string">'2017-01-06'</span>],</span><br><span class="line">              dtype=<span class="string">'datetime64[ns]'</span>, freq=<span class="string">'D'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.columns</span><br><span class="line">Index([<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>], dtype=<span class="string">'object'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.values</span><br><span class="line">array([[ <span class="number">0.14707226</span>,  <span class="number">1.23522557</span>,  <span class="number">0.14395236</span>,  <span class="number">0.83141137</span>],</span><br><span class="line">       [ <span class="number">0.86229302</span>, <span class="number">-0.72510256</span>, <span class="number">-0.10466379</span>,  <span class="number">1.26586314</span>],</span><br><span class="line">       [ <span class="number">0.28151127</span>,  <span class="number">0.95686785</span>, <span class="number">-0.74119266</span>,  <span class="number">0.12907115</span>],</span><br><span class="line">       [<span class="number">-0.66447533</span>,  <span class="number">0.96565318</span>,  <span class="number">1.52239163</span>,  <span class="number">1.12970702</span>],</span><br><span class="line">       [<span class="number">-1.36453175</span>, <span class="number">-0.16787707</span>,  <span class="number">0.07844812</span>,  <span class="number">0.21755034</span>],</span><br><span class="line">       [ <span class="number">0.71772123</span>,  <span class="number">0.34473429</span>, <span class="number">-0.95136372</span>,  <span class="number">0.36203183</span>]])</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ describe() å¯ä»¥å¸®ä½ åšä¸€äº›æ•°æ®çš„æ¦‚è¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.describe()</span><br><span class="line">              A         B         C         D</span><br><span class="line">count  <span class="number">6.000000</span>  <span class="number">6.000000</span>  <span class="number">6.000000</span>  <span class="number">6.000000</span></span><br><span class="line">mean  <span class="number">-0.003402</span>  <span class="number">0.434917</span> <span class="number">-0.008738</span>  <span class="number">0.655939</span></span><br><span class="line">std    <span class="number">0.855916</span>  <span class="number">0.763118</span>  <span class="number">0.872870</span>  <span class="number">0.486500</span></span><br><span class="line">min   <span class="number">-1.364532</span> <span class="number">-0.725103</span> <span class="number">-0.951364</span>  <span class="number">0.129071</span></span><br><span class="line"><span class="number">25</span>%   <span class="number">-0.461588</span> <span class="number">-0.039724</span> <span class="number">-0.582060</span>  <span class="number">0.253671</span></span><br><span class="line"><span class="number">50</span>%    <span class="number">0.214292</span>  <span class="number">0.650801</span> <span class="number">-0.013108</span>  <span class="number">0.596722</span></span><br><span class="line"><span class="number">75</span>%    <span class="number">0.608669</span>  <span class="number">0.963457</span>  <span class="number">0.127576</span>  <span class="number">1.055133</span></span><br><span class="line">max    <span class="number">0.862293</span>  <span class="number">1.235226</span>  <span class="number">1.522392</span>  <span class="number">1.265863</span></span><br></pre></td></tr></table></figure><p>DataFrame çš„çŸ©é˜µè½¬ç½®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.T</span><br></pre></td></tr></table></figure><p>DataFrame æ’åº</p><p>ï¼ˆ1ï¼‰ ä½¿ç”¨ sort_index æŒ‰ç…§ç´¢å¼•æ’åº<br>ascending å‚æ•°é»˜è®¤å€¼ä¸º True<br>axis = 0 æŒ‡çš„æ˜¯å®‰è£…è¡Œæ’åºï¼Œaxis = 1 æ˜¯æŒ‡å®‰è£…åˆ—æ’åºï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.sort_index(axis=<span class="number">1</span>, ascending=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰ ä½¿ç”¨ sort_values æŒ‰ç…§å€¼æ’åº</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.sort_values(by=<span class="string">'B'</span>, ascending=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><h2>é€‰æ‹©</h2><h3>è¡Œ/åˆ—</h3><p>é€‰æ‹©å•ç‹¬çš„åˆ—ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>df[<span class="string">'A'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.A</span><br></pre></td></tr></table></figure><p>åˆ‡ç‰‡ï¼Œä½¿ç”¨[]é€‰æ‹©ç‰¹å®šçš„è¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>df[<span class="number">0</span>:<span class="number">3</span>]</span><br><span class="line">                   A         B         C         D</span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-01</span>  <span class="number">0.147072</span>  <span class="number">1.235226</span>  <span class="number">0.143952</span>  <span class="number">0.831411</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-02</span>  <span class="number">0.862293</span> <span class="number">-0.725103</span> <span class="number">-0.104664</span>  <span class="number">1.265863</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-03</span>  <span class="number">0.281511</span>  <span class="number">0.956868</span> <span class="number">-0.741193</span>  <span class="number">0.129071</span></span><br></pre></td></tr></table></figure><h3>é€šè¿‡ label é€‰æ‹©</h3><p>é€šè¿‡ label é€‰æ‹©(dates[0]=Timestamp(â€˜2017-01-01 00:00:00â€™, offset=â€˜Dâ€™))</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.loc[dates[<span class="number">0</span>]]</span><br><span class="line">A    <span class="number">0.147072</span></span><br><span class="line">B    <span class="number">1.235226</span></span><br><span class="line">C    <span class="number">0.143952</span></span><br><span class="line">D    <span class="number">0.831411</span></span><br></pre></td></tr></table></figure><p>å¤šé€‰ï¼Œã€ŒAï¼šBã€ è¡¨ç¤ºä» A åˆ° B</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.loc[:,[<span class="string">'A'</span>,<span class="string">'B'</span>]]</span><br><span class="line">                   A         B</span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-01</span>  <span class="number">0.147072</span>  <span class="number">1.235226</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-02</span>  <span class="number">0.862293</span> <span class="number">-0.725103</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-03</span>  <span class="number">0.281511</span>  <span class="number">0.956868</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-04</span> <span class="number">-0.664475</span>  <span class="number">0.965653</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-05</span> <span class="number">-1.364532</span> <span class="number">-0.167877</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">0.717721</span>  <span class="number">0.344734</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.loc[<span class="string">'20170102'</span>:<span class="string">'20170104'</span>,[<span class="string">'A'</span>,<span class="string">'B'</span>]]</span><br><span class="line">                   A         B</span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-02</span>  <span class="number">0.862293</span> <span class="number">-0.725103</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-03</span>  <span class="number">0.281511</span>  <span class="number">0.956868</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-04</span> <span class="number">-0.664475</span>  <span class="number">0.965653</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.loc[<span class="string">'20170102'</span>,[<span class="string">'A'</span>,<span class="string">'B'</span>]]</span><br><span class="line">A    <span class="number">0.862293</span></span><br><span class="line">B   <span class="number">-0.725103</span></span><br><span class="line">Name: <span class="number">2017</span><span class="number">-01</span><span class="number">-02</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>, dtype: float64</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.at[dates[<span class="number">0</span>],<span class="string">'A'</span>]</span><br><span class="line"><span class="number">0.14707225966646126</span></span><br></pre></td></tr></table></figure><h3>é€šè¿‡ä¸‹æ ‡é€‰æ‹©</h3><p>é€‰æ‹©ç¬¬å››è¡Œæ‰€æœ‰å…ƒç´ </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.iloc[<span class="number">3</span>]</span><br><span class="line">A   <span class="number">-0.664475</span></span><br><span class="line">B    <span class="number">0.965653</span></span><br><span class="line">C    <span class="number">1.522392</span></span><br><span class="line">D    <span class="number">1.129707</span></span><br></pre></td></tr></table></figure><p>é€‰å‡º3<sub>4è¡Œï¼Œ0</sub>1åˆ—</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.iloc[<span class="number">3</span>:<span class="number">5</span>,<span class="number">0</span>:<span class="number">2</span>]</span><br><span class="line">                   A         B</span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-04</span> <span class="number">-0.664475</span>  <span class="number">0.965653</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-05</span> <span class="number">-1.364532</span> <span class="number">-0.167877</span></span><br></pre></td></tr></table></figure><p>é€‰æ‹©å•ä¸ªå…ƒç´ </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.iloc[<span class="number">1</span>,<span class="number">1</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.iat[<span class="number">1</span>,<span class="number">1</span>]</span><br></pre></td></tr></table></figure><h3>æ¯”è¾ƒè¿ç®—</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>df[df.A &gt; <span class="number">0</span>]</span><br><span class="line">                   A         B         C         D</span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-01</span>  <span class="number">0.147072</span>  <span class="number">1.235226</span>  <span class="number">0.143952</span>  <span class="number">0.831411</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-02</span>  <span class="number">0.862293</span> <span class="number">-0.725103</span> <span class="number">-0.104664</span>  <span class="number">1.265863</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-03</span>  <span class="number">0.281511</span>  <span class="number">0.956868</span> <span class="number">-0.741193</span>  <span class="number">0.129071</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">0.717721</span>  <span class="number">0.344734</span> <span class="number">-0.951364</span>  <span class="number">0.362032</span></span><br></pre></td></tr></table></figure><p>é€‰å‡ºå¤§äº0 çš„å…¨éƒ¨å…ƒç´ ï¼Œæ²¡æœ‰å¡«å……çš„å€¼ç­‰äº NaN</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>df[df &gt; <span class="number">0</span>]</span><br><span class="line">                   A         B         C         D</span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-01</span>  <span class="number">0.147072</span>  <span class="number">1.235226</span>  <span class="number">0.143952</span>  <span class="number">0.831411</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-02</span>  <span class="number">0.862293</span>       NaN       NaN  <span class="number">1.265863</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-03</span>  <span class="number">0.281511</span>  <span class="number">0.956868</span>       NaN  <span class="number">0.129071</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-04</span>       NaN  <span class="number">0.965653</span>  <span class="number">1.522392</span>  <span class="number">1.129707</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-05</span>       NaN       NaN  <span class="number">0.078448</span>  <span class="number">0.217550</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">0.717721</span>  <span class="number">0.344734</span>       NaN  <span class="number">0.362032</span></span><br></pre></td></tr></table></figure><p>isin() å‡½æ•°ï¼šæ˜¯å¦åœ¨é›†åˆä¸­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>df2 = df.copy()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df2[<span class="string">'E'</span>] = [<span class="string">'one'</span>, <span class="string">'one'</span>,<span class="string">'two'</span>,<span class="string">'three'</span>,<span class="string">'four'</span>,<span class="string">'three'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df2</span><br><span class="line">                   A         B         C         D      E</span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-01</span>  <span class="number">0.147072</span>  <span class="number">1.235226</span>  <span class="number">0.143952</span>  <span class="number">0.831411</span>    one</span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-02</span>  <span class="number">0.862293</span> <span class="number">-0.725103</span> <span class="number">-0.104664</span>  <span class="number">1.265863</span>    one</span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-03</span>  <span class="number">0.281511</span>  <span class="number">0.956868</span> <span class="number">-0.741193</span>  <span class="number">0.129071</span>    two</span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-04</span> <span class="number">-0.664475</span>  <span class="number">0.965653</span>  <span class="number">1.522392</span>  <span class="number">1.129707</span>  three</span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-05</span> <span class="number">-1.364532</span> <span class="number">-0.167877</span>  <span class="number">0.078448</span>  <span class="number">0.217550</span>   four</span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">0.717721</span>  <span class="number">0.344734</span> <span class="number">-0.951364</span>  <span class="number">0.362032</span>  three</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df2[df2[<span class="string">'E'</span>].isin([<span class="string">'two'</span>,<span class="string">'four'</span>])]</span><br><span class="line">                   A         B         C         D     E</span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-03</span>  <span class="number">0.281511</span>  <span class="number">0.956868</span> <span class="number">-0.741193</span>  <span class="number">0.129071</span>   two</span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-05</span> <span class="number">-1.364532</span> <span class="number">-0.167877</span>  <span class="number">0.078448</span>  <span class="number">0.217550</span>  four</span><br></pre></td></tr></table></figure><h3>è®¾ç½®</h3><p>æŒ‰ç…§ index ç»™ DataFrame æ·»åŠ æ–°çš„åˆ—ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s1 = pd.Series([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>], index=pd.date_range(<span class="string">'20170102'</span>, periods=<span class="number">6</span>))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s1</span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-02</span>    <span class="number">1</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-03</span>    <span class="number">2</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-04</span>    <span class="number">3</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-05</span>    <span class="number">4</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-06</span>    <span class="number">5</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-07</span>    <span class="number">6</span></span><br><span class="line">Freq: D, dtype: int64</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df[<span class="string">'F'</span>] = s1</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df</span><br><span class="line">                   A         B         C         D    F</span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-01</span>  <span class="number">0.147072</span>  <span class="number">1.235226</span>  <span class="number">0.143952</span>  <span class="number">0.831411</span>  NaN</span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-02</span>  <span class="number">0.862293</span> <span class="number">-0.725103</span> <span class="number">-0.104664</span>  <span class="number">1.265863</span>  <span class="number">1.0</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-03</span>  <span class="number">0.281511</span>  <span class="number">0.956868</span> <span class="number">-0.741193</span>  <span class="number">0.129071</span>  <span class="number">2.0</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-04</span> <span class="number">-0.664475</span>  <span class="number">0.965653</span>  <span class="number">1.522392</span>  <span class="number">1.129707</span>  <span class="number">3.0</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-05</span> <span class="number">-1.364532</span> <span class="number">-0.167877</span>  <span class="number">0.078448</span>  <span class="number">0.217550</span>  <span class="number">4.0</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-06</span>  <span class="number">0.717721</span>  <span class="number">0.344734</span> <span class="number">-0.951364</span>  <span class="number">0.362032</span>  <span class="number">5.0</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡ label è®¾ç½®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.at[dates[<span class="number">0</span>],<span class="string">'A'</span>] = <span class="number">0</span>  </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df[<span class="string">'A'</span>]</span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-01</span>    <span class="number">0.000000</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-02</span>    <span class="number">0.862293</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-03</span>    <span class="number">0.281511</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-04</span>   <span class="number">-0.664475</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-05</span>   <span class="number">-1.364532</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-06</span>    <span class="number">0.717721</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡ä¸‹æ ‡è®¾ç½®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.iat[<span class="number">0</span>,<span class="number">1</span>] = <span class="number">0</span></span><br></pre></td></tr></table></figure><p>ç”¨ numpy æ•°ç»„è®¾ç½®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.loc[:,<span class="string">'D'</span>] = np.array([<span class="number">5</span>] * len(df))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.D</span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-01</span>    <span class="number">5</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-02</span>    <span class="number">5</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-03</span>    <span class="number">5</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-04</span>    <span class="number">5</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-05</span>    <span class="number">5</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-06</span>    <span class="number">5</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ¯”è¾ƒè®¾ç½®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>df2 = df.copy()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df2[df2 &gt; <span class="number">0</span>] = -df2</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df2</span><br><span class="line">                   A         B         C  D    F</span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-01</span>  <span class="number">0.000000</span> <span class="number">-1.000000</span> <span class="number">-0.143952</span> <span class="number">-5</span>  NaN</span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-02</span> <span class="number">-0.862293</span> <span class="number">-0.725103</span> <span class="number">-0.104664</span> <span class="number">-5</span> <span class="number">-1.0</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-03</span> <span class="number">-0.281511</span> <span class="number">-0.956868</span> <span class="number">-0.741193</span> <span class="number">-5</span> <span class="number">-2.0</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-04</span> <span class="number">-0.664475</span> <span class="number">-0.965653</span> <span class="number">-1.522392</span> <span class="number">-5</span> <span class="number">-3.0</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-05</span> <span class="number">-1.364532</span> <span class="number">-0.167877</span> <span class="number">-0.078448</span> <span class="number">-5</span> <span class="number">-4.0</span></span><br><span class="line"><span class="number">2017</span><span class="number">-01</span><span class="number">-06</span> <span class="number">-0.717721</span> <span class="number">-0.344734</span> <span class="number">-0.951364</span> <span class="number">-5</span> <span class="number">-5.0</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;10åˆ†é’Ÿ Pandas å…¥é—¨&lt;/h1&gt;
&lt;p&gt;Pandas æ˜¯ Python åšæ•°æ®åˆ†ææœ€é‡è¦çš„æ¨¡å—ä¹‹ä¸€ï¼Œæœ¬æ–‡æºè‡ªPandas ä½œè€… Wes McKinney å†™çš„ &lt;a href=&quot;http://pandas.pydata.org/pandas-docs/stable/10min.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;10-minute tour of pandas&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆå®‰è£… Pandas å’Œç›¸å…³çš„ä¸¤ä¸ªåŒ… numpyã€matplotlib&lt;/p&gt;
    
    </summary>
    
      <category term="Python" scheme="https://lz5z.com/categories/Python/"/>
    
    
      <category term="Python" scheme="https://lz5z.com/tags/Python/"/>
    
      <category term="Pandas" scheme="https://lz5z.com/tags/Pandas/"/>
    
  </entry>
  
  <entry>
    <title>æ·±å…¥å­¦ä¹  JavaScriptâ€”â€”ç»§æ‰¿</title>
    <link href="https://lz5z.com/JavaScript%E7%BB%A7%E6%89%BF/"/>
    <id>https://lz5z.com/JavaScriptç»§æ‰¿/</id>
    <published>2016-12-05T23:50:08.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h1>ç»§æ‰¿</h1><p>ç»§æ‰¿æ˜¯é¢å‘å¯¹è±¡è¯­è¨€ä¸­æœ€é‡è¦çš„æ¦‚å¿µä¹‹ä¸€ï¼Œè®¸å¤š OO è¯­è¨€éƒ½æ”¯æŒä¸¤ç§ç»§æ‰¿æ–¹å¼ï¼šæ¥å£ç»§æ‰¿å’Œå®ç°ç»§æ‰¿ã€‚æ¥å£ç»§æ‰¿åªç»§æ‰¿æ–¹æ³•ç­¾åï¼Œè€Œå®ç°ç»§æ‰¿åˆ™ç»§æ‰¿å®é™…çš„æ–¹æ³•ã€‚ç”±äº ECMAScript ä¸­æ²¡æœ‰æ–¹æ³•ç­¾åï¼Œæ‰€ä»¥ä¸èƒ½å®ç°æ¥å£ç»§æ‰¿ï¼Œè€Œæ˜¯é€šè¿‡åŸå‹é“¾çš„æ–¹å¼å®Œæˆå®ç°ç»§æ‰¿ã€‚</p><h2>åŸå‹é“¾</h2><p>æ¯ä¸ªæ„é€ å‡½æ•°éƒ½æœ‰ä¸€ä¸ªåŸå‹å¯¹è±¡ï¼ŒåŸå‹å¯¹è±¡åŒ…å«ä¸€ä¸ªæŒ‡å‘æ„é€ å‡½æ•°çš„æŒ‡é’ˆï¼Œè€Œæ‰€æœ‰å®ä¾‹ä¸­éƒ½åŒ…å«ä¸€ä¸ªæŒ‡å‘åŸå‹å¯¹è±¡çš„å†…éƒ¨æŒ‡é’ˆã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå®ç°åŸå‹é“¾çš„åŸºæœ¬æ–¹æ³•ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.property = <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line">SuperType.prototype.getSuperValue = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.property</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.subProperty = <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ç»§æ‰¿äº† SuperType</span></span><br><span class="line">SubType.prototype = <span class="keyword">new</span> SuperType()</span><br><span class="line">SubType.prototype.getSubValue = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.subProperty</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> instance = <span class="keyword">new</span> SubType()</span><br><span class="line"><span class="built_in">console</span>.log(instance.getSuperValue()) <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç å®šä¹‰äº† SuperType å’Œ SubType ä¸¤ç§ç±»å‹ï¼Œæ¯ä¸ªç±»å‹åˆ†åˆ«æœ‰ä¸€ä¸ªå±æ€§å’Œä¸€ä¸ªæ–¹æ³•ï¼ŒSubType é€šè¿‡æ”¹å†™åŸå‹å¯¹è±¡çš„æ–¹å¼å®ç°å¯¹ SuperType çš„ç»§æ‰¿ã€‚åŸæ¥å­˜åœ¨äº SuperType ä¸­çš„å±æ€§å’Œæ–¹æ³•ï¼Œç°åœ¨ä¹Ÿå­˜åœ¨äº SubType.prototype ä¸­ã€‚åœ¨ç¡®ç«‹äº†ç»§æ‰¿å…³ç³»åï¼Œæˆ‘ä»¬ç»™ SubType.prototype åˆæ·»åŠ äº†ä¸€ä¸ªæ–°æ–¹æ³•ï¼Œè¿™ä¸ªä¾‹å­ä¸­çš„å…³ç³»å›¾å¦‚ä¸‹ï¼š</p><img src="/assets/img/js_inherit.png" alt="js_inherit"><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä¿®æ”¹ SubType é»˜è®¤çš„åŸå‹ä¸º SuperType çš„å®ä¾‹ï¼Œæ–°åŸå‹ä¸ä»…å…·æœ‰ä½œä¸ºä¸€ä¸ª SuperType çš„å®ä¾‹æ‰€æ‹¥æœ‰çš„å…¨éƒ¨å±æ€§å’Œæ–¹æ³•ï¼Œè€Œä¸”å…¶å†…éƒ¨è¿˜æœ‰ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘äº† SuperType çš„åŸå‹ã€‚æœ€ç»ˆçš„ç»“æœæ˜¯è¿™æ ·çš„ï¼šinstance æŒ‡å‘äº† SubType çš„åŸå‹ï¼ŒSubType çš„åŸå‹åˆæŒ‡å‘äº† SuperType çš„åŸå‹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">instance.__proto__ === SubType.prototype <span class="comment">// true</span></span><br><span class="line">SubType.prototype.__proto__ === SuperType.prototype <span class="comment">//true</span></span><br><span class="line">instance.__proto__.__proto__ === SuperType.prototype <span class="comment">//true</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1&gt;ç»§æ‰¿&lt;/h1&gt;
&lt;p&gt;ç»§æ‰¿æ˜¯é¢å‘å¯¹è±¡è¯­è¨€ä¸­æœ€é‡è¦çš„æ¦‚å¿µä¹‹ä¸€ï¼Œè®¸å¤š OO è¯­è¨€éƒ½æ”¯æŒä¸¤ç§ç»§æ‰¿æ–¹å¼ï¼šæ¥å£ç»§æ‰¿å’Œå®ç°ç»§æ‰¿ã€‚æ¥å£ç»§æ‰¿åªç»§æ‰¿æ–¹æ³•ç­¾åï¼Œè€Œå®ç°ç»§æ‰¿åˆ™ç»§æ‰¿å®é™…çš„æ–¹æ³•ã€‚ç”±äº ECMAScript ä¸­æ²¡æœ‰æ–¹æ³•ç­¾åï¼Œæ‰€ä»¥ä¸èƒ½å®ç°æ¥å£ç»§æ‰¿ï¼Œè€Œæ˜¯é€šè¿‡åŸå‹é“¾çš„æ–¹å¼å®Œæˆå®ç°ç»§æ‰¿ã€‚&lt;/
      
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="https://lz5z.com/tags/JavaScript/"/>
    
      <category term="é¢å‘å¯¹è±¡" scheme="https://lz5z.com/tags/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/"/>
    
      <category term="Object-Oriented" scheme="https://lz5z.com/tags/Object-Oriented/"/>
    
      <category term="ç»§æ‰¿" scheme="https://lz5z.com/tags/%E7%BB%A7%E6%89%BF/"/>
    
  </entry>
  
  <entry>
    <title>æ·±å…¥å­¦ä¹  JavaScriptâ€”â€”ç†è§£åŸå‹</title>
    <link href="https://lz5z.com/JavaScript-prototype/"/>
    <id>https://lz5z.com/JavaScript-prototype/</id>
    <published>2016-12-02T13:21:53.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h2>ç†è§£åŸå‹å¯¹è±¡</h2><p>åœ¨ JavaScript ä¸­ï¼Œåªè¦åˆ›å»ºäº†æ–°å‡½æ•°ï¼Œéƒ½ä¼šæ ¹æ®ä¸€ç»„ç‰¹å®šçš„è§„åˆ™ä¸ºè¯¥å‡½æ•°åˆ›å»ºä¸€ä¸ª prototype å±æ€§ï¼Œè¿™ä¸ªå±æ€§æŒ‡å‘å‡½æ•°çš„åŸå‹å¯¹è±¡ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰åŸå‹å¯¹è±¡éƒ½ä¼šè‡ªåŠ¨è·å–ä¸€ä¸ª constructorï¼ˆæ„é€ å‡½æ•°ï¼‰å±æ€§ï¼Œè¿™ä¸ªå±æ€§åŒ…å«ä¸€ä¸ªæŒ‡å‘ prototype å±æ€§æ‰€åœ¨å‡½æ•°çš„æŒ‡é’ˆã€‚æ¯”å¦‚ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">Person.prototype.constructor === Person</span><br></pre></td></tr></table></figure><p>é€šè¿‡ constructorï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­ä¸ºåŸå‹å¯¹è±¡æ·»åŠ å…¶ä»–å±æ€§å’Œæ–¹æ³•ã€‚</p><p>åˆ›å»ºè‡ªå®šä¹‰çš„æ„é€ å‡½æ•°ä¹‹åï¼Œå…¶åŸå‹å¯¹è±¡é»˜è®¤åªä¼šå–å¾— constructor å±æ€§ï¼Œå…¶å®ƒå±æ€§å’Œæ–¹æ³•éƒ½æ˜¯ä» Object ç»§æ‰¿è€Œæ¥çš„ã€‚</p><p>å½“è°ƒç”¨æ„é€ å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°å®ä¾‹åï¼Œè¯¥å®ä¾‹çš„å†…éƒ¨å°†åŒ…å«ä¸€ä¸ªæŒ‡é’ˆï¼ˆ[[Prototype]]ï¼‰ï¼ŒæŒ‡å‘æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ï¼Œè¯¥æŒ‡é’ˆåœ¨å¸¸ç”¨çš„æµè§ˆå™¨ä¸­è¢«å®šä¹‰ä¸º <code>__proto__</code>ã€‚éœ€è¦è¯´æ˜çš„ä¸€ç‚¹æ˜¯ï¼Œè¯¥è¿æ¥å­˜åœ¨äºå®ä¾‹å’Œæ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ä¹‹é—´ï¼Œè€Œä¸æ˜¯å­˜åœ¨äºåŸå‹å’Œæ„é€ å‡½æ•°ä¹‹é—´ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> leo = <span class="keyword">new</span> Person()</span><br><span class="line">leo.__proto__ === Person.prototype</span><br></pre></td></tr></table></figure><a id="more"></a><h3>å…³ç³»</h3><p>æ„é€ å‡½æ•°ï¼Œå®ä¾‹ï¼Œprototypeï¼Œ<code>__proto__</code> ä¹‹é—´çš„å…³ç³»å¯ä»¥ç†è§£ä¸ºä¸‹å›¾ï¼š</p><img src="/assets/img/js_prototype.png" alt="js_prototype"><p>æ³¨æ„ï¼š<code>__proto__</code> å¹¶é JS æ ‡å‡†å±æ€§ï¼Œè€Œæ˜¯æµè§ˆå™¨çš„å®ç°ã€‚</p><p>ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºæ„é€ å‡½æ•° Person å’Œå®ä¾‹ leo ä¹‹é—´å¹¶æ²¡æœ‰ç›´æ¥å…³ç³»ï¼Œè€Œæ˜¯é€šè¿‡ Person.prototype åŸå‹å¯¹è±¡è¿›è¡Œå…³è”ã€‚è™½ç„¶å®ä¾‹ä¸­å¹¶ä¸åŒ…å«å±æ€§å’Œæ–¹æ³•ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡è°ƒç”¨ <code>leo.sayName</code> è¿›è¡Œè°ƒç”¨ã€‚åœ¨éæµè§ˆå™¨ç¯å¢ƒæˆ–è€…æµè§ˆå™¨ä¸æ”¯æŒ <code>__proto__</code> çš„ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ isPrototypeOf() æ–¹æ³•æ¥ç¡®å®šå¯¹è±¡ä¹‹é—´æ˜¯å¦å­˜åœ¨è¿™ç§å…³ç³»ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Person.prototype.isPrototypeOf(leo) <span class="comment">// true</span></span><br><span class="line">leo.__proto__ === Person.prototype <span class="comment">// ä¸€äº›æµè§ˆå™¨å¯èƒ½ä¸æ”¯æŒ</span></span><br></pre></td></tr></table></figure><p>ECMAScript5 ä¸­å¢åŠ äº† Object.getPrototypeOf() æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å› [[Prototype]] çš„å€¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.getPrototypeOf(leo) === Person.prototype</span><br></pre></td></tr></table></figure><p>æ¯å½“ä»£ç è¯»å–æŸä¸ªå¯¹è±¡çš„å±æ€§æ—¶ï¼Œéƒ½ä¼šæ‰§è¡Œä¸€æ¬¡æœç´¢ï¼šé¦–å…ˆåˆ¤æ–­å®ä¾‹æ˜¯å¦å…·æœ‰ç»™å®šåå­—çš„å±æ€§ï¼Œå¦‚æœæ²¡æœ‰çš„è¯ï¼Œç»§ç»­æœç´¢å®ä¾‹çš„åŸå‹å¯¹è±¡ã€‚</p><p>åŸå‹å¯¹è±¡ä¸­çš„å±æ€§å¯¹äºå®ä¾‹æ¥è¯´æ˜¯åªè¯»çš„ï¼Œæ¯”å¦‚ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">Person.prototype.name = <span class="string">'JavaScript'</span></span><br><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> Person()</span><br><span class="line"><span class="keyword">let</span> p2 = <span class="keyword">new</span> Person()</span><br><span class="line">p1.name = <span class="string">'CSS'</span></span><br><span class="line"><span class="built_in">console</span>.log(p1.name) <span class="comment">// CSS</span></span><br><span class="line"><span class="built_in">console</span>.log(p2.name) <span class="comment">// JavaScript</span></span><br><span class="line"><span class="keyword">delete</span> p1.name</span><br><span class="line"><span class="built_in">console</span>.log(p1.name) <span class="comment">// JavaScript</span></span><br></pre></td></tr></table></figure><h3>hasOwnProperty() ä¸ in æ“ä½œç¬¦</h3><p>hasOwnProperty å¯ä»¥æ£€æµ‹ä¸€ä¸ªå±æ€§æ˜¯å­˜åœ¨äºå®ä¾‹ä¸­ï¼Œè¿˜æ˜¯å­˜åœ¨äºåŸå‹å¯¹è±¡ä¸­ï¼Œè¿™ä¸ªæ–¹æ³•ç»§æ‰¿è‡ª Object å¯¹è±¡ï¼›æ— è®ºå±æ€§å­˜åœ¨äºå®ä¾‹ä¸­è¿˜æ˜¯åŸå‹ä¸­ï¼Œä½¿ç”¨ in æ“ä½œç¬¦éƒ½èƒ½å¾—åˆ° trueã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">Person.prototype.name = <span class="string">'JavaScript'</span></span><br><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> Person()</span><br><span class="line">p1.hasOwnProperty(<span class="string">'name'</span>) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'name'</span> <span class="keyword">in</span> p1) <span class="comment">// true</span></span><br><span class="line">p1.name = <span class="string">'nobody'</span></span><br><span class="line">p1.hasOwnProperty(<span class="string">'name'</span>) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'name'</span> <span class="keyword">in</span> p1) <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>æ³¨ï¼šES5 ä¸­ Object.getOwnpropertyDescriptor() æ–¹æ³•åªèƒ½ç”¨äºå®ä¾‹å±æ€§ï¼Œè¦å–å¾—åŸå‹å±æ€§çš„æè¿°ç¬¦ï¼Œå¿…é¡»ç›´æ¥åœ¨åŸå‹å¯¹è±¡ä¸Šè°ƒç”¨ Object.getOwnpropertyDescriptor()ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptor(p1, <span class="string">'name'</span>)</span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">//  configurable: true</span></span><br><span class="line"><span class="comment">//  enumerable: true</span></span><br><span class="line"><span class="comment">//  value: "nobody"</span></span><br><span class="line"><span class="comment">//  writable:true</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br></pre></td></tr></table></figure><p>è¦å–å¾—å¯¹è±¡ä¸Šæ‰€æœ‰çš„å¯æšä¸¾çš„å®ä¾‹å±æ€§ï¼Œå¯ä»¥ä½¿ç”¨ Object.keys() æ–¹æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">Person.prototype.name = <span class="string">'JavaScript'</span></span><br><span class="line">Person.prototype.age = <span class="number">18</span></span><br><span class="line">Person.prototype.sayName = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.keys(Person.prototype) <span class="comment">// ["name", "age", "sayName"]</span></span><br><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> Person()</span><br><span class="line"><span class="built_in">Object</span>.keys(p1) <span class="comment">// []</span></span><br><span class="line">p1.name = <span class="string">'JavaScript'</span></span><br><span class="line"><span class="built_in">Object</span>.keys(p1) <span class="comment">// ["name"]</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼ŒObject.keys() æ–¹æ³•åªæšä¸¾å®ä¾‹å±æ€§ï¼Œå¹¶ä¸æšä¸¾åŸå‹å¯¹è±¡ä¸­çš„å±æ€§ï¼Œè€Œä¸” constructor å±æ€§ä¹Ÿæ˜¯ä¸å¯æšä¸¾çš„ã€‚</p><h3>æ›´ç®€å•çš„åŸå‹è¯­æ³•</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">Person.prototype = &#123;</span><br><span class="line">  <span class="keyword">constructor</span>: Person,</span><br><span class="line">  name: 'JavaScript',</span><br><span class="line">  age: 18,</span><br><span class="line">  sayName: function () &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">  &#125;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ç§å†™æ³•å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯é‡è®¾çš„ constructor å±æ€§çš„ [[Enumerable]] ç‰¹æ€§è¢«è®¾ç½®ä¸º trueï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒåŸç”Ÿçš„ constructor å±æ€§æ˜¯ä¸å¯æšä¸¾çš„ã€‚æ‰€ä»¥å¯ä»¥å†™æˆå¦‚ä¸‹æƒ…å†µï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">Person.prototype = &#123;</span><br><span class="line">  name: <span class="string">'JavaScript'</span>,</span><br><span class="line">  age: <span class="number">18</span>,</span><br><span class="line">  sayName: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">  &#125;    </span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Object</span>.definedProperty(Person.prototype, <span class="string">'constructor'</span>, &#123;</span><br><span class="line">  enumerable: <span class="literal">false</span>,</span><br><span class="line">  value: Person</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3>åŸå‹çš„åŠ¨æ€æ€§</h3><p>åœ¨ä¿®æ”¹åŸå‹çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥éšæ—¶ä¸ºåŸå‹æ·»åŠ å±æ€§å’Œæ–¹æ³•ï¼Œä½†æ˜¯å¦‚æœé‡å†™æ•´ä¸ªåŸå‹å¯¹è±¡ï¼Œé‚£æœ‰å¯èƒ½åˆ‡æ–­æ„é€ å‡½æ•°ä¸åŸå‹ä¹‹é—´çš„è”ç³»ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> Person()</span><br><span class="line">Person.prototype = &#123;</span><br><span class="line">  <span class="keyword">constructor</span>: Person,</span><br><span class="line">  name: 'JavaScript',</span><br><span class="line">  age: 18,</span><br><span class="line">  sayName: function () &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">  &#125;        </span><br><span class="line">&#125;</span><br><span class="line">p1.sayName() <span class="comment">// p1.sayName is not a function</span></span><br></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆåœ¨è°ƒç”¨ p1.sayName() çš„æ—¶å€™ä¼šå‘ç”Ÿé”™è¯¯å‘¢ï¼Œå› ä¸º p1 æŒ‡å‘çš„åŸå‹å¯¹è±¡ä¸­å¹¶ä¸åŒ…å« sayName æ–¹æ³•ã€‚</p><p>å…¶å…³ç³»å¯çœ‹ä¸‹å›¾ï¼š</p><img src="/assets/img/js_prototype_new.png" alt="js_prototype_new"><p>é‡å†™åŸå‹å¯¹è±¡åï¼Œåˆ‡æ–­äº†ç°æœ‰åŸå‹ä¸ä»»ä½•ä¹‹å‰å·²ç»å­˜åœ¨çš„å¯¹è±¡å®ä¾‹ä¹‹é—´çš„è”ç³»ï¼Œå®ƒä»¬å¼•ç”¨çš„ä»»ç„¶æ˜¯æœ€åˆçš„åŸå‹ã€‚</p><h3>åŸå‹å¯¹è±¡çš„ç¼ºç‚¹</h3><p>åŸå‹å¯¹è±¡çœç•¥äº†ä¸ºæ„é€ å‡½æ•°ä¼ é€’å‚æ•°è¿™ä¸€ç¯èŠ‚ï¼Œä½¿å¾—æ‰€æœ‰å®ä¾‹åœ¨é»˜è®¤æƒ…å†µä¸‹éƒ½å–å¾—ç›¸åŒçš„å±æ€§å€¼ï¼Œè€Œä¸”åŸå‹ä¸­æ‰€æœ‰çš„å±æ€§æ˜¯è¢«å…¨éƒ¨å®ä¾‹å…±äº«çš„ï¼Œè¿™ç§å…±äº«å¯¹äºå‡½æ•°æ¥è¯´éå¸¸åˆé€‚ï¼Œä½†æ˜¯å¯¹äºå±æ€§å€¼ï¼Œå°¤å…¶æ˜¯å¼•ç”¨ç±»å‹çš„å±æ€§å€¼æ¥è¯´ï¼Œé—®é¢˜å°±æ¯”è¾ƒä¸¥é‡äº†ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">Person.prototype = &#123;</span><br><span class="line">  <span class="keyword">constructor</span>: Person,</span><br><span class="line">  name: 'JavaScript',</span><br><span class="line">  age: 18,</span><br><span class="line">  friends: ['Lily', 'Tony'],</span><br><span class="line">  sayName: function () &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">  &#125;        </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> Person()</span><br><span class="line"><span class="keyword">let</span> p2 = <span class="keyword">new</span> Person()</span><br><span class="line">p1.friends.push(<span class="string">'Jack'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(p2.friends) <span class="comment">//Â ["Lily", "Tony", "Jack"]</span></span><br><span class="line">p1.friends === p2.friends <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹å®ä¾‹ p1 çš„å€¼çš„è¿‡ç¨‹ä¸­ï¼Œp2 çš„å€¼ä¹Ÿè¢«ä¿®æ”¹äº†ã€‚è¿™å°±å¯¼è‡´äº†ä»…ä»…ä½¿ç”¨åŸå‹æ¨¡å¼åˆ›å»ºå¯¹è±¡å­˜åœ¨å¾ˆå¤§çš„é—®é¢˜ã€‚å…·ä½“è§£å†³è¯·æŸ¥çœ‹<a href="https://lz5z.com/JavaScript%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/">æ·±å…¥å­¦ä¹ JavaScriptâ€”â€”é¢å‘å¯¹è±¡</a>ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;ç†è§£åŸå‹å¯¹è±¡&lt;/h2&gt;
&lt;p&gt;åœ¨ JavaScript ä¸­ï¼Œåªè¦åˆ›å»ºäº†æ–°å‡½æ•°ï¼Œéƒ½ä¼šæ ¹æ®ä¸€ç»„ç‰¹å®šçš„è§„åˆ™ä¸ºè¯¥å‡½æ•°åˆ›å»ºä¸€ä¸ª prototype å±æ€§ï¼Œè¿™ä¸ªå±æ€§æŒ‡å‘å‡½æ•°çš„åŸå‹å¯¹è±¡ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰åŸå‹å¯¹è±¡éƒ½ä¼šè‡ªåŠ¨è·å–ä¸€ä¸ª constructorï¼ˆæ„é€ å‡½æ•°ï¼‰å±æ€§ï¼Œè¿™ä¸ªå±æ€§åŒ…å«ä¸€ä¸ªæŒ‡å‘ prototype å±æ€§æ‰€åœ¨å‡½æ•°çš„æŒ‡é’ˆã€‚æ¯”å¦‚ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Person&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Person.prototype.constructor === Person&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;é€šè¿‡ constructorï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­ä¸ºåŸå‹å¯¹è±¡æ·»åŠ å…¶ä»–å±æ€§å’Œæ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;åˆ›å»ºè‡ªå®šä¹‰çš„æ„é€ å‡½æ•°ä¹‹åï¼Œå…¶åŸå‹å¯¹è±¡é»˜è®¤åªä¼šå–å¾— constructor å±æ€§ï¼Œå…¶å®ƒå±æ€§å’Œæ–¹æ³•éƒ½æ˜¯ä» Object ç»§æ‰¿è€Œæ¥çš„ã€‚&lt;/p&gt;
&lt;p&gt;å½“è°ƒç”¨æ„é€ å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°å®ä¾‹åï¼Œè¯¥å®ä¾‹çš„å†…éƒ¨å°†åŒ…å«ä¸€ä¸ªæŒ‡é’ˆï¼ˆ[[Prototype]]ï¼‰ï¼ŒæŒ‡å‘æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ï¼Œè¯¥æŒ‡é’ˆåœ¨å¸¸ç”¨çš„æµè§ˆå™¨ä¸­è¢«å®šä¹‰ä¸º &lt;code&gt;__proto__&lt;/code&gt;ã€‚éœ€è¦è¯´æ˜çš„ä¸€ç‚¹æ˜¯ï¼Œè¯¥è¿æ¥å­˜åœ¨äºå®ä¾‹å’Œæ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ä¹‹é—´ï¼Œè€Œä¸æ˜¯å­˜åœ¨äºåŸå‹å’Œæ„é€ å‡½æ•°ä¹‹é—´ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; leo = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Person()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;leo.__proto__ === Person.prototype&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="https://lz5z.com/tags/JavaScript/"/>
    
      <category term="prototype" scheme="https://lz5z.com/tags/prototype/"/>
    
      <category term="åŸå‹" scheme="https://lz5z.com/tags/%E5%8E%9F%E5%9E%8B/"/>
    
  </entry>
  
  <entry>
    <title>æ·±å…¥å­¦ä¹  JavaScriptâ€”â€”é¢å‘å¯¹è±¡</title>
    <link href="https://lz5z.com/JavaScript%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/"/>
    <id>https://lz5z.com/JavaScripté¢å‘å¯¹è±¡/</id>
    <published>2016-12-01T18:14:29.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h1>JavaScript é¢å‘å¯¹è±¡</h1><p>å‡ ä¹æ‰€æœ‰é¢å‘å¯¹è±¡çš„è¯­è¨€éƒ½æœ‰ä¸€ä¸ªæ ‡å¿—ï¼Œé‚£å°±æ˜¯ç±»ï¼Œé€šè¿‡ç±»åˆ›å»ºå…·æœ‰ç›¸åŒå±æ€§å’Œæ–¹æ³•çš„å¯¹è±¡ã€‚è€Œ ECMAScript ä¸­æ²¡æœ‰ç±»çš„æ¦‚å¿µï¼Œå®ƒæŠŠå¯¹è±¡å®šä¹‰ä¸ºï¼šâ€œæ— åºå±æ€§çš„é›†åˆï¼Œå…¶å±æ€§å¯ä»¥åŒ…å«åŸºæœ¬å€¼ã€å¯¹è±¡æˆ–è€…å‡½æ•°â€ã€‚å³å¯¹è±¡æ˜¯ä¸€ç»„æ²¡æœ‰ç‰¹å®šé¡ºåºçš„å€¼ï¼Œå¯¹è±¡çš„æ¯ä¸ªå±æ€§æˆ–æ–¹æ³•éƒ½æœ‰ä¸€ä¸ªåå­—ï¼Œè€Œè¿™ä¸ªåå­—éƒ½æ˜ å°„åˆ°ä¸€ä¸ªå€¼ã€‚å› æ­¤å¯¹è±¡çš„æœ¬è´¨æ˜¯ä¸€ä¸ª<a href="https://lz5z.com/JavaScript-Object-Hash/">æ•£åˆ—è¡¨</a>ã€‚</p><a id="more"></a><h1>åˆ›å»ºå¯¹è±¡</h1><p>è™½ç„¶ Object æ„é€ å‡½æ•°æˆ–å¯¹è±¡å­—é¢é‡éƒ½å¯ä»¥åˆ›å»ºå•ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯è¿™äº›æ–¹å¼æœ‰ä¸ªæ˜æ˜¾çš„ç¼ºç‚¹ï¼šä½¿ç”¨åŒä¸€ä¸ªæ¥å£åˆ›å»ºå¾ˆå¤šå¯¹è±¡ï¼Œä¼šäº§ç”Ÿå¤§é‡é‡å¤çš„ä»£ç ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå°±å¯ä»¥ä½¿ç”¨å·¥å‚æ¨¡å¼æ¥åˆ›å»ºå¯¹è±¡ã€‚</p><h2>å·¥å‚æ¨¡å¼</h2><p>å·¥å‚æ¨¡å¼ç”¨å‡½æ•°æ¥å°è£…ç‰¹å®šæ¥å£åˆ›å»ºå¯¹è±¡ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createPerson</span>(<span class="params">name, age, job</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> o = <span class="keyword">new</span> <span class="built_in">Object</span>()</span><br><span class="line">    o.name = name</span><br><span class="line">    o.age = age</span><br><span class="line">    o.job = job</span><br><span class="line">    o.sayName = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> o</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> leo = createPerson(<span class="string">'Leo'</span>, <span class="number">18</span>, <span class="string">"Engineer"</span>)</span><br></pre></td></tr></table></figure><p>å·¥å‚æ¨¡å¼è™½ç„¶è§£å†³äº†åˆ›å»ºå¤šä¸ªç›¸ä¼¼å¯¹è±¡çš„é—®é¢˜ï¼Œä½†æ²¡æœ‰è§£å†³å¯¹è±¡è¯†åˆ«çš„é—®é¢˜ï¼ˆå³æ€æ ·çŸ¥é“ä¸€ä¸ªå¯¹è±¡çš„ç±»å‹ï¼‰ã€‚</p><h2>æ„é€ å‡½æ•°æ¨¡å¼</h2><p>ECMAScript ä¸­çš„æ„é€ å‡½æ•°å¯ä»¥ç”¨æ¥åˆ›å»ºç‰¹å®šç±»å‹çš„å¯¹è±¡ï¼Œåƒ Object å’Œ Array çš„åŸç”Ÿçš„æ„é€ å‡½æ•°ï¼Œåœ¨è¿è¡Œæ—¶ä¼šè‡ªåŠ¨å‡ºç°åœ¨æ‰§è¡Œç¯å¢ƒä¸­ã€‚æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥åˆ›å»ºè‡ªå®šä¹‰çš„æ„é€ å‡½æ•°ï¼Œä»è€Œå®šä¹‰è‡ªå®šä¹‰å¯¹è±¡ç±»å‹çš„å±æ€§å’Œæ–¹æ³•ã€‚ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age, job</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name</span><br><span class="line">    <span class="keyword">this</span>.age = age</span><br><span class="line">    <span class="keyword">this</span>.job = job</span><br><span class="line">    <span class="keyword">this</span>.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> leo = <span class="keyword">new</span> Person(<span class="string">'Leo'</span>, <span class="number">18</span>, <span class="string">"Engineer"</span>)</span><br><span class="line"><span class="keyword">let</span> jack = <span class="keyword">new</span> Person(<span class="string">'Jack'</span>, <span class="number">18</span>, <span class="string">"Engineer"</span>)</span><br></pre></td></tr></table></figure><p>æ„é€ å‡½æ•°æ¨¡å¼ä¸å·¥å‚æ¨¡å¼æœ‰ä»¥ä¸‹ä¸åŒï¼š</p><ol><li>æ²¡æœ‰æ˜¾å¼çš„åˆ›å»ºå¯¹è±¡ï¼›</li><li>ç›´æ¥å°†å±æ€§å’Œæ–¹æ³•èµ‹ç»™äº†thiså¯¹è±¡ï¼›</li><li>æ²¡æœ‰returnè¯­å¥ï¼›</li></ol><p>æ„é€ å‡½æ•°åº”è¯¥ä»¥å¤§å†™å­—æ¯å¼€å¤´ï¼Œä½¿ç”¨ new æ“ä½œç¬¦ã€‚new æ“ä½œç¬¦åˆ›å»ºå¯¹è±¡ç»å†ä»¥ä¸‹ 4 ä¸ªæ­¥éª¤ï¼š</p><ol><li>åˆ›å»ºæ–°çš„å¯¹è±¡ï¼›</li><li>å°†æ„é€ å‡½æ•°çš„ä½œç”¨åŸŸèµ‹ç»™æ–°å¯¹è±¡ï¼ˆå› æ­¤ this å°±æŒ‡å‘äº†è¿™ä¸ªæ–°å¯¹è±¡ï¼‰ï¼›</li><li>æ‰§è¡Œæ„é€ å‡½æ•°ä¸­çš„ä»£ç ï¼ˆä¸ºè¿™ä¸ªæ–°å¯¹è±¡æ·»åŠ å±æ€§ï¼‰ï¼›</li><li>è¿”å›æ–°å¯¹è±¡ï¼›</li></ol><p>ç”Ÿæˆçš„å¯¹è±¡ leo ä¸­æœ‰ä¸€ä¸ª constructor å±æ€§ï¼Œè¯¥å±æ€§æŒ‡å‘ Personï¼Œå¹¶ä¸”å¯ä»¥ç”¨ instanceof åšç±»å‹æ£€æµ‹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">leo.constructor === Person <span class="comment">// true</span></span><br><span class="line">leo <span class="keyword">instanceof</span>  <span class="built_in">Object</span> <span class="comment">// true</span></span><br><span class="line">leo <span class="keyword">instanceof</span> Person <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>æ„é€ å‡½æ•°çš„ç¼ºç‚¹åœ¨äºæ¯ä¸ªæ–¹æ³•éƒ½è¦åœ¨æ¯ä¸ªå®ä¾‹ä¸Šé‡æ–°åˆ›å»ºä¸€éã€‚åœ¨å‰é¢ä¾‹å­ä¸­ï¼Œleo å’Œ jack éƒ½æœ‰ä¸€ä¸ªåä¸º sayName çš„æ–¹æ³•ï¼Œä½†æ˜¯è¿™ä¸¤ä¸ªæ–¹æ³•ä¸å±äºåŒä¸€ä¸ªå¯¹è±¡ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬èƒ½ä¸èƒ½å…±äº«ä¸€ä¸ª sayName() æ–¹æ³•ã€‚å¦‚æœæƒ³è¦å®Œæˆè¿™ç§éœ€æ±‚ï¼Œå¤§å¯åƒä¸‹é¢ä»£ç ä¸€æ ·ï¼Œé€šè¿‡æŠŠå‡½æ•°å®šä¹‰è½¬ç§»åˆ°æ„é€ å‡½æ•°çš„å¤–éƒ¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age, job</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name</span><br><span class="line">    <span class="keyword">this</span>.age = age</span><br><span class="line">    <span class="keyword">this</span>.job = job</span><br><span class="line">    <span class="keyword">this</span>.sayName = sayName</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayName</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> leo = <span class="keyword">new</span> Person(<span class="string">'Leo'</span>, <span class="number">18</span>, <span class="string">"Engineer"</span>)</span><br><span class="line"><span class="keyword">let</span> jack = <span class="keyword">new</span> Person(<span class="string">'Jack'</span>, <span class="number">18</span>, <span class="string">"Engineer"</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(leo.sayName === jack.sayName) <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä¾‹å­ä¸­çš„åšæ³•ï¼Œç¡®å®è§£å†³äº†ä¸¤ä¸ªå‡½æ•°åšåŒä¸€ä»¶äº‹çš„é—®é¢˜ï¼Œä½†æ˜¯æ— æ„ä¸­å®šä¹‰äº†å¾ˆå¤šå…¨å±€å‡½æ•°ï¼Œè€Œè¿™äº›å…¨å±€å‡½æ•°ä¸­ç”±äºåŒ…å« â€œthisâ€ å…³é”®å­—ï¼Œåˆåªèƒ½è¢«æŸä¸ªå‡½æ•°è°ƒç”¨ã€‚ä¸ä»…æ±¡æŸ“äº†å…¨å±€ä½œç”¨åŸŸï¼Œè¿˜ä½¿å¾—è¿™ä¸ªè‡ªå®šä¹‰çš„å¼•ç”¨ç±»å‹å®Œå…¨ä¸§å¤±å°è£…æ€§ã€‚å¥½åœ¨è¿™äº›é—®é¢˜éƒ½å¯ä»¥é€šè¿‡åŸå‹æ¨¡å¼è§£å†³ã€‚</p><h2>åŸå‹æ¨¡å¼</h2><p>JavaScript ä¸­åˆ›å»ºçš„æ¯ä¸ªå‡½æ•°éƒ½æœ‰ä¸€ä¸ª prototype å±æ€§ï¼Œè¿™ä¸ªå±æ€§æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œè¿™ä¸ªå¯¹è±¡çš„ç”¨é€”æ˜¯åŒ…å«å¯ä»¥ç”±ç‰¹å®šç±»å‹çš„ <strong>æ‰€æœ‰å®ä¾‹å…±äº«çš„å±æ€§å’Œæ–¹æ³•</strong>ã€‚prototypeæ˜¯é€šè¿‡è°ƒç”¨æ„é€ å‡½æ•°è€Œåˆ›å»ºçš„é‚£ä¸ªå¯¹è±¡å®ä¾‹çš„å¯¹è±¡åŸå‹ï¼Œä½¿ç”¨åŸå‹å¯¹è±¡çš„å¥½å¤„æ˜¯å¯ä»¥è®©æ‰€æœ‰å¯¹è±¡å®ä¾‹å…±äº«å®ƒæ‰€åŒ…å«çš„å±æ€§å’Œæ–¹æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">Person.prototype.name = <span class="string">'Leo'</span></span><br><span class="line">Person.prototype.age = <span class="number">18</span></span><br><span class="line">Person.prototype.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> leo1 = <span class="keyword">new</span> Person</span><br><span class="line"><span class="keyword">let</span> leo2 = <span class="keyword">new</span> Person</span><br><span class="line">leo1.sayName()</span><br><span class="line">leo2.sayName()</span><br></pre></td></tr></table></figure><p>åœ¨æ­¤ï¼Œæˆ‘ä»¬å°† sayName() æ–¹æ³•å’Œæ‰€æœ‰çš„å±æ€§ç›´æ¥æ·»åŠ åˆ°äº† Person çš„ prototype å±æ€§ä¸­ï¼Œæ„é€ å‡½æ•°å˜æˆäº†ç©ºå‡½æ•°ï¼Œè€Œé€šè¿‡ new åˆ›å»ºå‡ºæ¥çš„å¯¹è±¡å…·æœ‰ç›¸åŒçš„å±æ€§å’Œæ–¹æ³•ã€‚ä½†æ˜¯ä¸æ„é€ å‡½æ•°æ¨¡å¼ä¸åŒå¯¹çš„æ˜¯ï¼Œæ–°å¯¹è±¡çš„è¿™äº›å±æ€§å’Œæ–¹æ³•æ˜¯ç”±æ‰€æœ‰çš„å®ä¾‹å…±äº«çš„ï¼Œä¹Ÿå°±æ˜¯è¯´</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">leo1.sayName === leo2.sayName <span class="comment">// true</span></span><br></pre></td></tr></table></figure><h2>ç»„åˆä½¿ç”¨æ„é€ å‡½æ•°æ¨¡å¼å’ŒåŸå‹æ¨¡å¼</h2><p>åˆ›å»ºè‡ªå®šä¹‰å¯¹è±¡æœ€å¸¸è§çš„å½¢å¼å°±æ˜¯ç»„åˆä½¿ç”¨æ„é€ å‡½æ•°æ¨¡å¼å’ŒåŸå‹æ¨¡å¼ï¼Œæ„é€ å‡½æ•°ç”¨äºå®šä¹‰ç±»çš„å®ä¾‹å±æ€§ï¼Œè€ŒåŸå‹æ¨¡å¼ç”¨äºå®šä¹‰å¯¹è±¡çš„å…±äº«å±æ€§ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name</span><br><span class="line">    <span class="keyword">this</span>.age = age</span><br><span class="line">    <span class="keyword">this</span>.friends = []</span><br><span class="line">&#125;</span><br><span class="line">Person.prototype = &#123;</span><br><span class="line">    <span class="keyword">constructor</span>: Person,</span><br><span class="line">    sayName: function() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> leo = <span class="keyword">new</span> Person(<span class="string">'Leo'</span>, <span class="number">18</span>)</span><br><span class="line"><span class="keyword">let</span> jack = <span class="keyword">new</span> Person(<span class="string">'Jack'</span>, <span class="number">18</span>)</span><br><span class="line">leo.friends.push(<span class="string">'Elsa'</span>)</span><br><span class="line">jack.friends.push(<span class="string">'Lucy'</span>)</span><br><span class="line">leo.sayName === jack.sayName <span class="comment">// true</span></span><br><span class="line">jack.friends === leo.friends <span class="comment">// false</span></span><br></pre></td></tr></table></figure><p>å®ä¾‹å±æ€§éƒ½æ˜¯åœ¨æ„é€ å‡½æ•°ä¸­å®šä¹‰çš„ï¼Œè€Œå®ä¾‹å…±äº«å±æ€§ constructor å’Œæ–¹æ³• sayName() åˆ™æ˜¯åœ¨åŸå‹ä¸­å®šä¹‰çš„ã€‚è¿™ç§æ„é€ å‡½æ•°ä¸åŸå‹æ··æˆçš„æ¨¡å¼ï¼Œæ˜¯ç›®å‰ ECMAScript ä¸­ä½¿ç”¨æœ€å¹¿æ³›ã€è®¤åŒåº¦æœ€é«˜çš„ä¸€ç§åˆ›å»ºè‡ªå®šä¹‰å¯¹è±¡çš„æ–¹æ³•ã€‚</p><h2>åŠ¨æ€åŸå‹æ¨¡å¼</h2><p>åŠ¨æ€åŸå‹æ¨¡å¼å°†æ‰€æœ‰ä¿¡æ¯å°è£…åœ¨äº†æ„é€ å‡½æ•°ä¸­ï¼Œè€Œé€šè¿‡æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ–åŸå‹ï¼ˆä»…ç¬¬ä¸€ä¸ªå¯¹è±¡å®ä¾‹åŒ–æ—¶åˆå§‹åŒ–åŸå‹ï¼‰ï¼Œåˆä¿æŒäº†åŒæ—¶ä½¿ç”¨æ„é€ å‡½æ•°å’ŒåŸå‹çš„ä¼˜ç‚¹ã€‚æ¢å¥è¯è¯´ï¼Œå¯ä»¥é€šè¿‡æ£€æŸ¥æŸä¸ªåº”è¯¥å­˜åœ¨çš„æ–¹æ³•æ˜¯å¦æœ‰æ•ˆï¼Œæ¥å†³å®šæ˜¯å¦éœ€è¦åˆå§‹åŒ–åŸå‹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name</span><br><span class="line">    <span class="keyword">this</span>.age = age</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="keyword">this</span>.sayName != <span class="string">'function'</span>) &#123;</span><br><span class="line">        Person.prototype.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> leo = <span class="keyword">new</span> Person(<span class="string">'Leo'</span>, <span class="number">18</span>)</span><br><span class="line">leo.sayName()</span><br></pre></td></tr></table></figure><p>Person æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œé€šè¿‡ new Person() æ¥ç”Ÿæˆå®ä¾‹å¯¹è±¡ã€‚æ¯å½“ä¸€ä¸ª Person çš„å¯¹è±¡ç”Ÿæˆæ—¶ï¼ŒPerson å†…éƒ¨çš„ä»£ç éƒ½ä¼šè¢«è°ƒç”¨ä¸€æ¬¡ã€‚</p><p>å¦‚æœå»æ‰ if çš„è¯ï¼Œä½ æ¯ new ä¸€æ¬¡(å³æ¯å½“ä¸€ä¸ªå®ä¾‹å¯¹è±¡ç”Ÿäº§æ—¶)ï¼Œéƒ½ä¼šé‡æ–°å®šä¹‰ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œç„¶åæŒ‚åˆ° Person.prototype.sayName å±æ€§ä¸Šã€‚è€Œå®é™…ä¸Šï¼Œä½ åªéœ€è¦å®šä¹‰ä¸€æ¬¡å°±å¤Ÿäº†ï¼Œå› ä¸ºæ‰€æœ‰å®ä¾‹éƒ½ä¼šå…±äº«æ­¤å±æ€§çš„ã€‚è€ŒåŠ ä¸Š if åï¼Œåªåœ¨ new ç¬¬ä¸€ä¸ªå®ä¾‹æ—¶æ‰ä¼šå®šä¹‰ sayName æ–¹æ³•ï¼Œä¹‹åå°±ä¸ä¼šäº†ã€‚</p><p>å‡è®¾é™¤äº†sayName æ–¹æ³•å¤–ï¼Œä½ è¿˜å®šä¹‰äº†å¾ˆå¤šå…¶ä»–æ–¹æ³•ï¼Œæ¯”å¦‚ sayByeã€cryã€smile ç­‰ç­‰ã€‚æ­¤æ—¶ä½ åªéœ€è¦æŠŠå®ƒä»¬éƒ½æ”¾åˆ°å¯¹ sayName åˆ¤æ–­çš„ if å—é‡Œé¢å°±å¯ä»¥äº†ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="keyword">this</span>.sayName != <span class="string">"function"</span>) &#123;</span><br><span class="line">    Person.prototype.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;...&#125;</span><br><span class="line">    Person.prototype.sayBye = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;...&#125;</span><br><span class="line">    Person.prototype.cry = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;...&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·ä¸€æ¥ï¼Œè¦ä¹ˆå®ƒä»¬å…¨éƒ½è¿˜æ²¡æœ‰å®šä¹‰(new ç¬¬ä¸€ä¸ªå®ä¾‹æ—¶)ï¼Œè¦ä¹ˆå·²ç»å…¨éƒ½å®šä¹‰äº†(new å…¶ä»–å®ä¾‹å)ï¼Œå³å®ƒä»¬çš„å­˜åœ¨æ€§æ˜¯ä¸€è‡´çš„ï¼Œç”¨åŒä¸€ä¸ªåˆ¤æ–­å°±å¯ä»¥äº†ï¼Œè€Œä¸éœ€è¦åˆ†åˆ«å¯¹å®ƒä»¬è¿›è¡Œåˆ¤æ–­ã€‚</p><p>ä½¿ç”¨åŠ¨å›¾åŸå‹æ¨¡å¼æ—¶ï¼Œä¸èƒ½ä½¿ç”¨å¯¹è±¡å­—é¢é‡é‡å†™åŸå‹ï¼Œå¦‚æœåœ¨å·²ç»åˆ›å»ºå®ä¾‹çš„æƒ…å†µä¸‹é‡å†™åŸå‹ï¼Œä¼šåˆ‡æ–­ç°æœ‰å®ä¾‹å’ŒåŸå‹ä¹‹é—´çš„è”ç³»ã€‚</p><h2>å¯„ç”Ÿæ„é€ å‡½æ•°æ¨¡å¼</h2><p>å¯„ç”Ÿæ„é€ å‡½æ•°çš„åŸºæœ¬æ€æƒ³æ˜¯åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°çš„ä½œç”¨ä»…ä»…æ˜¯å°è£…åˆ›å»ºå¯¹è±¡çš„ä»£ç ï¼Œç„¶åè¿”å›æ–°åˆ›å»ºçš„å¯¹è±¡ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> o = <span class="keyword">new</span> <span class="built_in">Object</span>()</span><br><span class="line">    o.name = name</span><br><span class="line">    o.age = age</span><br><span class="line">    o.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> o</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> leo = <span class="keyword">new</span> Person(<span class="string">'Leo'</span>, <span class="number">18</span>)</span><br><span class="line">leo.sayName()</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒPerson å‡½æ•°åˆ›å»ºäº†ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå¹¶ä»¥ç›¸åº”çš„å±æ€§å’Œæ–¹æ³•åˆå§‹åŒ–è¯¥å¯¹è±¡ï¼Œç„¶åè¿”å›è¿™ä¸ªå¯¹è±¡ã€‚é™¤äº†ä½¿ç”¨ new æ“ä½œç¬¦å¹¶æŠŠä½¿ç”¨çš„åŒ…è£…å‡½æ•°å«åšæ„é€ å‡½æ•°å¤–ï¼Œè¿™ä¸ªæ¨¡å¼è·Ÿå·¥å‚æ¨¡å¼ä¸€æ¨¡ä¸€æ ·ã€‚æ„é€ å‡½æ•°åœ¨ä¸è¿”å›å€¼çš„æƒ…å†µä¸‹ï¼Œé»˜è®¤ä¼šè¿”å›æ–°çš„å¯¹è±¡å®ä¾‹ã€‚</p><p>è¿™ä¸ªæ¨¡å¼åœ¨ç‰¹æ®Šçš„æƒ…å†µä¸‹å¯ä»¥ç”¨æ¥ä¸ºå¯¹è±¡åˆ›å»ºæ„é€ å‡½æ•°ã€‚å‡å¦‚æˆ‘ä»¬æƒ³åˆ›å»ºä¸€ä¸ªå…·æœ‰é¢å¤–æ–¹æ³•çš„ç‰¹æ®Šæ•°ç»„ï¼Œç”±äºä¸èƒ½ç›´æ¥ä¿®æ”¹ Array çš„æ„é€ å‡½æ•°ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨è¿™ç§æ¨¡å¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SpecialArray</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> values = <span class="keyword">new</span> <span class="built_in">Array</span>()</span><br><span class="line">    values.push.apply(values, <span class="built_in">arguments</span>)</span><br><span class="line">    values.toPipedString = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.join(<span class="string">'|'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> values</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> colors = <span class="keyword">new</span> SpecialArray(<span class="string">'red'</span>, <span class="string">'blue'</span>, <span class="string">'green'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(colors.toPipedString()) <span class="comment">// 'red|blue|green'</span></span><br></pre></td></tr></table></figure><p>å…³äºå¯„ç”Ÿæ„é€ å‡½æ•°æ¨¡å¼ï¼Œæœ‰ä¸€ç‚¹éœ€è¦è¯´æ˜ï¼šè¿”å›çš„å¯¹è±¡ä¸æ„é€ å‡½æ•°æˆ–è€…æ„é€ å‡½æ•°çš„åŸå‹å±æ€§ç›´æ¥æ²¡æœ‰å…³ç³»ï¼Œæ‰€ä»¥ä¸èƒ½ä¾èµ– instanceof æ“ä½œç¬¦æ¥ç¡®å®šå¯¹è±¡ç±»å‹ã€‚</p><h2>ç¨³å¦¥æ„é€ å‡½æ•°æ¨¡å¼</h2><p>ç¨³å¦¥å¯¹è±¡ï¼Œæ˜¯æŒ‡æ²¡æœ‰å…¬å…±å±æ€§ï¼Œè€Œä¸”æ–¹æ³•ä¹Ÿä¸å¼•ç”¨ this çš„å¯¹è±¡ï¼Œé€‚åˆåœ¨ä¸€äº›å®‰å…¨ç¯å¢ƒä¸­ï¼ˆç¦ç”¨ this å’Œ newï¼‰ï¼Œæˆ–è€…åœ¨é˜²æ­¢æ•°æ®è¢«å…¶å®ƒåº”ç”¨ç¨‹åºæ”¹åŠ¨æ—¶ä½¿ç”¨ã€‚ç¨³å¦¥æ„é€ å‡½æ•°éµå¾ªä¸å¯„ç”Ÿæ„é€ å‡½æ•°ç±»ä¼¼çš„æ¨¡å¼ï¼Œä½†æ˜¯æœ‰ä¸¤ç‚¹ä¸åŒï¼šä¸€æ˜¯æ–°åˆ›å»ºå¯¹è±¡çš„å®ä¾‹æ–¹æ³•ä¸å¼•ç”¨ thisï¼ŒäºŒæ˜¯ä¸ä½¿ç”¨ new æ“ä½œç¬¦è°ƒç”¨æ„é€ å‡½æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> o = <span class="keyword">new</span> <span class="built_in">Object</span>()</span><br><span class="line">    o.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> o</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> leo = Person(<span class="string">'Leo'</span>, <span class="number">18</span>)</span><br><span class="line">leo.sayName()</span><br></pre></td></tr></table></figure><p>æ³¨æ„åœ¨è¿™ç§æ¨¡å¼åˆ›å»ºçš„å¯¹è±¡ä¸­ï¼Œé™¤äº†ä½¿ç”¨ sayName æ–¹æ³•ä¹‹å¤–ï¼Œæ²¡æœ‰å…¶ä»–åŠæ³•è®¿é—® name å±æ€§ï¼Œå³ä½¿æœ‰å…¶ä»–ä»£ç ç»™è¿™ä¸ªå¯¹è±¡æ·»åŠ å±æ€§æˆ–è€…æ–¹æ³•ï¼Œä¹Ÿä¸å¯èƒ½æœ‰åˆ«çš„åŠæ³•è®¿é—®ä¼ å…¥åˆ°æ„é€ å‡½æ•°ä¸­çš„åŸå§‹æ•°æ®ã€‚</p><p>ä¸å¯„ç”Ÿæ„é€ å‡½æ•°ç±»ä¼¼ï¼Œç¨³å¦¥æ„é€ å‡½æ•°æ¨¡å¼åˆ›å»ºçš„å¯¹è±¡ä¸æ„é€ å‡½æ•°ç›´æ¥ä¹Ÿæ²¡æœ‰ä»€ä¹ˆå…³ç³»ï¼Œæ‰€ä»¥ä¸èƒ½ä¾èµ– instanceof æ“ä½œç¬¦æ¥ç¡®å®šå¯¹è±¡ç±»å‹ã€‚</p><h1>æ€»ç»“</h1><p>ç»„åˆä½¿ç”¨æ„é€ å‡½æ•°æ¨¡å¼å’ŒåŸå‹æ¨¡å¼æ˜¯ç›®å‰ä½¿ç”¨æœ€å¹¿çš„æ–¹æ³•ï¼Œå¦‚æœä¸å¸Œæœ›æ„é€ å‡½æ•°å’ŒåŸå‹ç›¸äº’åˆ†ç¦»çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨åŠ¨æ€åŸå‹æ¨¡å¼ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;JavaScript é¢å‘å¯¹è±¡&lt;/h1&gt;
&lt;p&gt;å‡ ä¹æ‰€æœ‰é¢å‘å¯¹è±¡çš„è¯­è¨€éƒ½æœ‰ä¸€ä¸ªæ ‡å¿—ï¼Œé‚£å°±æ˜¯ç±»ï¼Œé€šè¿‡ç±»åˆ›å»ºå…·æœ‰ç›¸åŒå±æ€§å’Œæ–¹æ³•çš„å¯¹è±¡ã€‚è€Œ ECMAScript ä¸­æ²¡æœ‰ç±»çš„æ¦‚å¿µï¼Œå®ƒæŠŠå¯¹è±¡å®šä¹‰ä¸ºï¼šâ€œæ— åºå±æ€§çš„é›†åˆï¼Œå…¶å±æ€§å¯ä»¥åŒ…å«åŸºæœ¬å€¼ã€å¯¹è±¡æˆ–è€…å‡½æ•°â€ã€‚å³å¯¹è±¡æ˜¯ä¸€ç»„æ²¡æœ‰ç‰¹å®šé¡ºåºçš„å€¼ï¼Œå¯¹è±¡çš„æ¯ä¸ªå±æ€§æˆ–æ–¹æ³•éƒ½æœ‰ä¸€ä¸ªåå­—ï¼Œè€Œè¿™ä¸ªåå­—éƒ½æ˜ å°„åˆ°ä¸€ä¸ªå€¼ã€‚å› æ­¤å¯¹è±¡çš„æœ¬è´¨æ˜¯ä¸€ä¸ª&lt;a href=&quot;https://lz5z.com/JavaScript-Object-Hash/&quot;&gt;æ•£åˆ—è¡¨&lt;/a&gt;ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="https://lz5z.com/tags/JavaScript/"/>
    
      <category term="é¢å‘å¯¹è±¡" scheme="https://lz5z.com/tags/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/"/>
    
      <category term="Object-Oriented" scheme="https://lz5z.com/tags/Object-Oriented/"/>
    
  </entry>
  
  <entry>
    <title>JavaScript å¯¹è±¡ä¸ Hash è¡¨</title>
    <link href="https://lz5z.com/JavaScript-Object-Hash/"/>
    <id>https://lz5z.com/JavaScript-Object-Hash/</id>
    <published>2016-12-01T10:02:04.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h1>ç®€ä»‹</h1><p>å“ˆå¸Œè¡¨(Hash tableï¼Œä¹Ÿå«æ•£åˆ—è¡¨)ï¼Œæ˜¯æ ¹æ®å…³é”®ç å€¼(Key value)è€Œç›´æ¥è¿›è¡Œè®¿é—®çš„æ•°æ®ç»“æ„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒé€šè¿‡æŠŠå…³é”®ç å€¼æ˜ å°„åˆ°è¡¨ä¸­ä¸€ä¸ªä½ç½®æ¥è®¿é—®è®°å½•ï¼Œä»¥åŠ å¿«æŸ¥æ‰¾çš„é€Ÿåº¦ã€‚è¿™ä¸ªæ˜ å°„å‡½æ•°å«åšæ•£åˆ—å‡½æ•°ï¼Œå­˜æ”¾è®°å½•çš„æ•°ç»„å«åšæ•£åˆ—è¡¨ã€‚</p><p>JavaScript ä¸­çš„å¯¹è±¡ä¹Ÿæ˜¯ä»¥ Key-Value çš„å½¢å¼è®¿é—®ï¼Œé‚£ä¹ˆ JavaScript çš„å¯¹è±¡æ˜¯å¦ä»¥ Hash çš„ç»“æ„å­˜å‚¨å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬é¦–å…ˆæ¥çœ‹ä¸€ä¸‹ Hash è¡¨ç»“æ„ã€‚</p><a id="more"></a><h2>Hash è¡¨ç»“æ„</h2><p>æ•°ç»„çš„ç‰¹ç‚¹æ˜¯ï¼šå¯»å€å®¹æ˜“ï¼Œæ’å…¥å’Œåˆ é™¤å›°éš¾ï¼›è€Œé“¾è¡¨çš„ç‰¹ç‚¹æ˜¯ï¼šå¯»å€å›°éš¾ï¼Œæ’å…¥å’Œåˆ é™¤å®¹æ˜“ï¼ŒHash è¡¨ç»¼åˆä¸¤è€…çš„ç‰¹æ€§ï¼Œåšå‡ºä¸€ç§å¯»å€å®¹æ˜“ï¼Œæ’å…¥åˆ é™¤ä¹Ÿå®¹æ˜“çš„æ•°æ®ç»“æ„ã€‚</p><p>ä¸‹å›¾æ˜¯æœ€å¸¸è§çš„ <strong>æ‹‰é“¾æ³•</strong> åšå‡ºçš„ Hash è¡¨</p><img src="/assets/img/hash.jpg" alt="hash"><p>å·¦è¾¹æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„æ¯ä¸ªæˆå‘˜åŒ…æ‹¬ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘ä¸€ä¸ªé“¾è¡¨çš„å¤´ï¼Œå½“ç„¶è¿™ä¸ªé“¾è¡¨å¯èƒ½ä¸ºç©ºï¼Œä¹Ÿå¯èƒ½å…ƒç´ å¾ˆå¤šã€‚æˆ‘ä»¬æ ¹æ®å…ƒç´ çš„ä¸€äº›ç‰¹å¾æŠŠå…ƒç´ åˆ†é…åˆ°ä¸åŒçš„é“¾è¡¨ä¸­å»ï¼Œä¹Ÿæ˜¯æ ¹æ®è¿™äº›ç‰¹å¾ï¼Œæ‰¾åˆ°æ­£ç¡®çš„é“¾è¡¨ï¼Œå†ä»é“¾è¡¨ä¸­æ‰¾å‡ºè¿™ä¸ªå…ƒç´ ã€‚</p><p>å…ƒç´ ç‰¹å¾è½¬å˜ä¸ºæ•°ç»„ä¸‹æ ‡çš„æ–¹æ³•å°±æ˜¯æ•£åˆ—æ³•ã€‚ä¸Šå›¾è¿ç”¨çš„æ–¹æ³•ä¸º <strong>æ•´é™¤æ³•</strong>ï¼Œå…¬å¼ä¸ºï¼š</p><blockquote><p>index = value % 16</p></blockquote><p>hashè¡¨çš„å·¥ä½œåŸç†ï¼š</p><ol><li>ç¬¬ä¸€æ­¥ å…ˆæ ¹æ®ç»™å®šçš„keyå’Œæ•£åˆ—ç®—æ³•å¾—åˆ°å…·ä½“çš„æ•£åˆ—å€¼ï¼Œä¹Ÿå°±æ˜¯å¯¹åº”çš„æ•°ç»„ä¸‹æ ‡ã€‚</li><li>ç¬¬äºŒæ­¥ï¼Œæ ¹æ®æ•°ç»„ä¸‹æ ‡å¾—åˆ°æ­¤ä¸‹æ ‡é‡Œå­˜å‚¨çš„æŒ‡é’ˆï¼Œè‹¥æŒ‡é’ˆä¸ºç©ºï¼Œåˆ™ä¸å­˜åœ¨è¿™æ ·çš„é”®å€¼å¯¹ï¼Œå¦åˆ™æ ¹æ®æ­¤æŒ‡é’ˆå¾—åˆ°æ­¤é“¾å¼æ•°ç»„ã€‚</li><li>éå†æ­¤é“¾å¼æ•°ç»„ï¼Œåˆ†åˆ«å–å‡ºKeyä¸ç»™å®šçš„Keyæ¯”è¾ƒï¼Œè‹¥æ‰¾åˆ°ä¸ç»™å®škeyç›¸ç­‰çš„Keyï¼Œå³åœ¨æ­¤hashè¡¨ä¸­å­˜åœ¨æ­¤è¦æŸ¥æ‰¾çš„&lt;Key,Value&gt;é”®å€¼å¯¹ï¼Œæ­¤åä¾¿å¯ä»¥å¯¹æ­¤é”®å€¼å¯¹è¿›è¡Œç›¸å…³æ“ä½œï¼›è‹¥æ‰¾ä¸åˆ°ï¼Œå³ä¸ºä¸å­˜åœ¨æ­¤é”®å€¼å¯¹ã€‚</li></ol><h1>JavaScript å¯¹è±¡å­˜å‚¨å½¢å¼</h1><h2>JavaScript å¯¹è±¡ Key å­˜å‚¨å½¢å¼</h2><p>åœ¨æˆ‘ä»¬åˆ›å»ºæˆ–è€…è®¿é—®å¯¹è±¡å±æ€§çš„æ—¶å€™ï¼Œå¦‚æœä½¿ç”¨ <strong>å¯¹è±¡.å±æ€§å</strong> çš„æ–¹å¼ï¼Œå±æ€§ååªèƒ½ä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œè€Œä¸”ä¸èƒ½ä»¥æ•°å­—å¼€å¤´ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;&#125;;</span><br><span class="line">obj<span class="number">.2</span> = <span class="number">2</span>;  <span class="comment">//Uncaught SyntaxError: Unexpected number</span></span><br><span class="line">obj<span class="number">.12</span>s = <span class="string">'12s'</span>;  <span class="comment">//Uncaught SyntaxError: Invalid or unexpected token</span></span><br></pre></td></tr></table></figure><p>è€Œä½¿ç”¨å­—é¢é‡çš„å½¢å¼åˆ›å»ºå¯¹è±¡ï¼Œæˆ–è€…ç”¨ <strong>å¯¹è±¡[å±æ€§å]</strong> çš„æ–¹æ³•ï¼Œå´æ²¡æœ‰è¿™æ ·çš„é™åˆ¶:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> o = &#123;&#125;;</span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    x: <span class="number">1</span>,</span><br><span class="line">    <span class="number">2</span>: <span class="number">2</span>,</span><br><span class="line">    o: <span class="string">'object'</span>,</span><br><span class="line">    &#123;<span class="attr">name</span>: <span class="string">'Leo'</span>&#125;: <span class="string">'object'</span></span><br><span class="line">&#125;;</span><br><span class="line">obj[<span class="string">'12s'</span>] = <span class="string">'12s'</span>;</span><br><span class="line">obj[&#123;<span class="attr">name</span>: <span class="string">'Leo'</span>&#125;] = <span class="string">'object'</span>; <span class="comment">//ä½¿ç”¨ å¯¹è±¡[å±æ€§å] çš„æ–¹å¼ç”šè‡³å¯ä»¥æŠŠå¯¹è±¡å½“åšå±æ€§åä¼ å…¥</span></span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ obj é‡Œé¢çš„å±æ€§ <strong>2</strong> æ˜¯ä¸€ä¸ªæ•´æ•°å—ï¼Ÿ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">in</span> obj) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">typeof</span> i, i, obj[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// string 2 2</span></span><br><span class="line"><span class="comment">// string x 1</span></span><br><span class="line"><span class="comment">// string o object</span></span><br><span class="line"><span class="comment">// string 12s 12s</span></span><br><span class="line"><span class="comment">// string [object Object] object</span></span><br></pre></td></tr></table></figure><p>ç”±æ­¤å¯è§ JavaScript ä¸­å¯¹è±¡çš„ Key å‡æ˜¯ string ç±»å‹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(obj[<span class="number">2</span>] === obj[<span class="string">'2'</span>]);  <span class="comment">// true</span></span><br><span class="line">object[<span class="number">2</span>]=<span class="number">3</span>;</span><br><span class="line"><span class="built_in">console</span>.log(object[<span class="string">'2'</span>]);<span class="comment">//3</span></span><br></pre></td></tr></table></figure><p>å¯è§è§£é‡Šå™¨åœ¨è®¿é—® object[2] çš„æ—¶å€™ï¼Œå…ˆå°†æ–¹æ‹¬å·é‡Œé¢çš„ 2 è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œç„¶åå†è®¿é—®ã€‚</p><p>è€Œä½¿ç”¨ obj[{name: â€˜Leoâ€™}] = â€˜objectâ€™ çš„æ—¶å€™ï¼Œä¹Ÿæ˜¯åŒæ ·çš„ï¼Œè§£é‡Šå™¨å…ˆè°ƒç”¨ Objcet.toString æ–¹æ³•æŠŠå¯¹è±¡ {name: â€˜Leoâ€™} è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œç„¶åå†è®¿é—®ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> object = &#123;</span><br><span class="line">  x: <span class="number">1</span>,</span><br><span class="line">  <span class="number">2</span>: <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Object</span>.prototype.toString = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'2'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(object[&#123;<span class="attr">name</span>: <span class="string">'Leo'</span>&#125;]);ã€€ã€€<span class="comment">// 2</span></span><br></pre></td></tr></table></figure><p>ä¸Šè¿°çš„ <strong>object[{name: â€˜Leoâ€™}]</strong> ç›¸å½“äº <strong>object[{name: â€˜Leoâ€™}.toString()]</strong> äº¦ç›¸å½“äº <strong>object[â€˜2â€™]</strong>ï¼Œäºæ˜¯å°±å¾—åˆ°ç»“æœ 2ã€‚</p><p>è¿™é‡Œä¹Ÿé—´æ¥è¯æ˜äº† JavaScript å¯¹è±¡ä¸­ï¼Œæ‰€æœ‰çš„ key éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œå³ä½¿ä½ è®¿é—®çš„æ—¶å€™ä¸æ˜¯å­—ç¬¦ä¸²çš„å½¢å¼ï¼Œè§£é‡Šå™¨ä¹Ÿä¼šå…ˆå°†å…¶è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ã€‚</p><p>å¯æ˜¯æˆ‘ä»¬çŸ¥é“æ•´æ•°å€¼ç›´æ¥è°ƒç”¨ toString æ–¹æ³•æ˜¯ä¼šæŠ¥é”™çš„ï¼Œå› ä¸º JavaScript è§£æå™¨ä¼šè¯•å›¾å°†ç‚¹æ“ä½œç¬¦è§£æä¸ºæµ®ç‚¹æ•°å­—é¢å€¼çš„ä¸€éƒ¨åˆ†ã€‚ä¸è¿‡æœ‰å¾ˆå¤šå˜é€šæ–¹æ³•å¯ä»¥è®©æ•°å­—çš„å­—é¢å€¼çœ‹èµ·æ¥åƒå¯¹è±¡ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2.</span>toString() <span class="comment">// Uncaught SyntaxError: Invalid or unexpected token</span></span><br><span class="line"><span class="comment">//è§£å†³æ–¹æ¡ˆ</span></span><br><span class="line"><span class="number">2.</span>.toString(); <span class="comment">// ç¬¬äºŒä¸ªç‚¹å·å¯ä»¥æ­£å¸¸è§£æ</span></span><br><span class="line"><span class="number">2</span> .toString(); <span class="comment">// æ³¨æ„ç‚¹å·å‰é¢çš„ç©ºæ ¼</span></span><br><span class="line">(<span class="number">2</span>).toString(); <span class="comment">// 2å…ˆè¢«è®¡ç®—</span></span><br></pre></td></tr></table></figure><p>æ‰€ä»¥ JavaScript è§£é‡Šå™¨åº”è¯¥æœ‰å¸®æˆ‘ä»¬åšè¿™ä¸€éƒ¨åˆ†å·¥ä½œã€‚</p><h2>JavaScript å¯¹è±¡ Value å­˜å‚¨å½¢å¼</h2><p>åœ¨JavaScripté«˜çº§ç¨‹åºè®¾è®¡ï¼ˆç¬¬ä¸‰ç‰ˆï¼‰ä¸­ï¼Œæ˜¯è¿™ä¹ˆæè¿°å±æ€§çš„ï¼šå±æ€§åœ¨åˆ›å»ºæ—¶éƒ½å¸¦æœ‰ä¸€äº›ç‰¹å¾å€¼ï¼ŒJavaScriptå¼•æ“é€šè¿‡è¿™äº›ç‰¹å¾å€¼æ¥å®šä¹‰ä»–ä»¬çš„è¡Œä¸ºã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = &#123;&#125;;</span><br><span class="line">person.name = <span class="string">'Leo'</span>;</span><br><span class="line"><span class="keyword">var</span> descriptor=<span class="built_in">Object</span>.getOwnPropertyDescriptor(person,<span class="string">"name"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(descriptor); </span><br><span class="line"><span class="comment">//Object</span></span><br><span class="line"><span class="comment">// configurable: true</span></span><br><span class="line"><span class="comment">// enumerable: true</span></span><br><span class="line"><span class="comment">// value: "Leo"</span></span><br><span class="line"><span class="comment">// writable: true</span></span><br><span class="line"><span class="comment">// __proto__: Object</span></span><br></pre></td></tr></table></figure><p>å¯è§ value çš„æ•°æ®ç±»å‹æ˜¯ç»“æ„ä½“ã€‚</p><h2>JavaScript å¯¹è±¡å­˜å‚¨å½¢å¼</h2><p>åœ¨ JavaScript ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä»»æ„ç»™å¯¹è±¡æ·»åŠ æˆ–è€…åˆ é™¤å±æ€§ï¼Œç”±æ­¤å¯ä»¥æ¨æ–­ï¼Œå¯¹è±¡ä¸æ˜¯ç”±æ•°ç»„ç»“æ„å­˜å‚¨ï¼›é“¾è¡¨è™½ç„¶èƒ½å¤Ÿä»»æ„ä¼¸ç¼©ä½†æ˜¯å…¶æŸ¥è¯¢æ•ˆç‡ä½ä¸‹ï¼Œå› æ­¤ä¹Ÿæ’é™¤é“¾è¡¨ã€‚å¦‚æœç”¨æ ‘ä½œä¸ºå­˜å‚¨ç»“æ„ï¼Œæ•ˆç‡è¾ƒé«˜çš„å¯èƒ½å°±æ˜¯å¹³è¡¡æ ‘äº†ã€‚å¹³è¡¡æ ‘çš„æŸ¥è¯¢æ•ˆç‡è¿˜å¯ä»¥æ¥å—ï¼Œä½†æ˜¯å½“åˆ é™¤å±æ€§çš„æ—¶å€™ï¼Œå¹³è¡¡æ ‘åœ¨è°ƒæ•´çš„æ—¶å€™ä»£ä»·ç›¸æ¯”äº hash è¡¨è¦å¤§å¾ˆå¤šã€‚äºæ˜¯ Hash æˆä¸ºæœ€å¥½çš„é€‰æ‹©ã€‚</p><p>å‡å¦‚æœ‰è¿™ä¹ˆä¸€æ®µä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">id, name, age</span>) </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.id = id;</span><br><span class="line"><span class="keyword">this</span>.name = name;</span><br><span class="line"><span class="keyword">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> num = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">let</span> bol = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">let</span> obj = <span class="keyword">new</span> <span class="built_in">Object</span>;</span><br><span class="line"><span class="keyword">let</span> arr = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>];</span><br><span class="line"><span class="keyword">let</span> person = <span class="keyword">new</span> Person(<span class="number">100</span>, <span class="string">'Leo'</span>, <span class="number">18</span>);</span><br></pre></td></tr></table></figure><p>JavaScript å†…å­˜åˆ†æå›¾å¦‚ä¸‹ï¼š<br><img src="/assets/img/js_obj_mem.png" alt="memory"></p><p>å˜é‡ numã€bolã€str ä¸ºåŸºæœ¬æ•°æ®ç±»å‹ï¼Œå®ƒä»¬çš„å€¼ç›´æ¥å­˜æ”¾åœ¨æ ˆä¸­ã€‚objã€personã€arr ä¸ºå¤åˆæ•°æ®ç±»å‹ï¼Œä»–ä»¬çš„å¼•ç”¨å˜é‡å­˜å‚¨åœ¨æ ˆä¸­ï¼ŒæŒ‡å‘äºå­˜å‚¨åœ¨å †ä¸­çš„å®é™…å¯¹è±¡ã€‚</p><p>åœ¨ JavaScript ä¸­å˜é‡åˆ†ä¸ºåŸºæœ¬ç±»å‹å’Œå¼•ç”¨ç±»å‹ï¼ˆå¯¹è±¡ç±»å‹ï¼‰ï¼Œåˆ†åˆ«å¯¹åº”ç€ä¸¤ç§ä¸åŒçš„å­˜å‚¨æ–¹å¼â€“æ ˆå­˜å‚¨å’Œå †å­˜å‚¨ã€‚</p><p>åŸºæœ¬ç±»å‹ä¸€æ—¦åˆå§‹åŒ–åˆ™å†…å­˜å¤§å°å›ºå®šï¼Œè®¿é—®å˜é‡å°±æ˜¯è®¿é—®å˜é‡çš„å†…å­˜ä¸Šå®é™…çš„æ•°æ®ï¼Œç§°ä¹‹ä¸ºæŒ‰å€¼è®¿é—®ã€‚è€Œå¯¹è±¡ç±»å‹å†…å­˜å¤§å°ä¸å›ºå®šï¼Œæ— æ³•åœ¨æ ˆä¸­ç»´æŠ¤ï¼Œæ‰€ä»¥ JavaScript å°±æŠŠå¯¹è±¡ç±»å‹çš„å˜é‡æ”¾åˆ°å †ä¸­ï¼Œè®©è§£é‡Šå™¨ä¸ºå…¶æŒ‰éœ€åˆ†é…å†…å­˜ï¼Œè€Œé€šè¿‡å¯¹è±¡çš„å¼•ç”¨æŒ‡é’ˆå¯¹å…¶è¿›è¡Œè®¿é—®ï¼Œå› ä¸ºå¯¹è±¡åœ¨å †ä¸­çš„å†…å­˜åœ°å€å¤§å°æ˜¯å›ºå®šçš„ï¼Œå› æ­¤å¯ä»¥å°†å†…å­˜åœ°å€ä¿å­˜åœ¨æ ˆå†…å­˜çš„å¼•ç”¨ä¸­ã€‚è¿™ç§æ–¹å¼ç§°ä¹‹ä¸ºæŒ‰å¼•ç”¨è®¿é—®ã€‚</p><h1>æ€»ç»“</h1><p>åœ¨ JavaScript ä¸­å¯¹è±¡æ˜¯ä»¥ Hash ç»“æ„å­˜å‚¨çš„ï¼Œç”¨ &lt;Key, Value&gt; é”®å€¼å¯¹è¡¨ç¤ºå¯¹è±¡çš„å±æ€§ï¼ŒKey çš„æ•°æ®ç±»å‹ä¸ºå­—ç¬¦ä¸²ï¼ŒValue çš„æ•°æ®ç±»å‹æ˜¯ç»“æ„ä½“ï¼Œå³å¯¹è±¡æ˜¯ä»¥ &lt;String, Object&gt; ç±»å‹çš„ HashMap ç»“æ„å­˜å‚¨çš„ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;ç®€ä»‹&lt;/h1&gt;
&lt;p&gt;å“ˆå¸Œè¡¨(Hash tableï¼Œä¹Ÿå«æ•£åˆ—è¡¨)ï¼Œæ˜¯æ ¹æ®å…³é”®ç å€¼(Key value)è€Œç›´æ¥è¿›è¡Œè®¿é—®çš„æ•°æ®ç»“æ„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒé€šè¿‡æŠŠå…³é”®ç å€¼æ˜ å°„åˆ°è¡¨ä¸­ä¸€ä¸ªä½ç½®æ¥è®¿é—®è®°å½•ï¼Œä»¥åŠ å¿«æŸ¥æ‰¾çš„é€Ÿåº¦ã€‚è¿™ä¸ªæ˜ å°„å‡½æ•°å«åšæ•£åˆ—å‡½æ•°ï¼Œå­˜æ”¾è®°å½•çš„æ•°ç»„å«åšæ•£åˆ—è¡¨ã€‚&lt;/p&gt;
&lt;p&gt;JavaScript ä¸­çš„å¯¹è±¡ä¹Ÿæ˜¯ä»¥ Key-Value çš„å½¢å¼è®¿é—®ï¼Œé‚£ä¹ˆ JavaScript çš„å¯¹è±¡æ˜¯å¦ä»¥ Hash çš„ç»“æ„å­˜å‚¨å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬é¦–å…ˆæ¥çœ‹ä¸€ä¸‹ Hash è¡¨ç»“æ„ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="https://lz5z.com/tags/JavaScript/"/>
    
      <category term="Hash" scheme="https://lz5z.com/tags/Hash/"/>
    
  </entry>
  
  <entry>
    <title>Spark RDD æ“ä½œè¯¦è§£â€”â€”Transformations</title>
    <link href="https://lz5z.com/rdd-operations/"/>
    <id>https://lz5z.com/rdd-operations/</id>
    <published>2016-11-29T15:08:50.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h1>RDD æ“ä½œæœ‰å“ªäº›</h1><p>Spark RDD æ”¯æŒ2ç§ç±»å‹çš„æ“ä½œ: transformations å’Œ actionsã€‚transformationsï¼š ä»å·²ç»å­˜åœ¨çš„æ•°æ®é›†ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®é›†ï¼Œå¦‚ mapã€‚actionsï¼š æ•°æ®é›†ä¸Šè¿›è¡Œè®¡ç®—ä¹‹åè¿”å›ä¸€ä¸ªå€¼ï¼Œå¦‚ reduceã€‚</p><p>åœ¨ Spark ä¸­ï¼Œæ‰€æœ‰çš„ transformations éƒ½æ˜¯ lazy çš„ï¼Œå®ƒä»¬ä¸ä¼šé©¬ä¸Šè®¡ç®—å®ƒä»¬çš„ç»“æœï¼Œè€Œæ˜¯ä»…ä»…è®°å½•è½¬æ¢æ“ä½œæ˜¯åº”ç”¨åˆ°å“ªäº›åŸºç¡€æ•°æ®é›†ä¸Šçš„ï¼Œåªæœ‰å½“ actions è¦è¿”å›ç»“æœçš„æ—¶å€™è®¡ç®—æ‰ä¼šå‘ç”Ÿã€‚</p><a id="more"></a><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸€ä¸ªè½¬æ¢è¿‡çš„ RDD ä¼šåœ¨æ¯æ¬¡æ‰§è¡Œ actions çš„æ—¶å€™é‡æ–°è®¡ç®—ä¸€æ¬¡ã€‚ä½†æ˜¯å¯ä»¥ä½¿ç”¨ persist (æˆ– cache)æ–¹æ³•æŒä¹…åŒ–ä¸€ä¸ª RDD åˆ°å†…å­˜ä¸­ï¼Œè¿™æ ·Spark ä¼šåœ¨é›†ç¾¤ä¸Šä¿å­˜ç›¸å…³çš„å…ƒç´ ï¼Œä¸‹æ¬¡æŸ¥è¯¢çš„æ—¶å€™ä¼šå˜å¾—æ›´å¿«ï¼Œä¹Ÿå¯ä»¥æŒä¹…åŒ– RDD åˆ°ç£ç›˜ï¼Œæˆ–åœ¨å¤šä¸ªèŠ‚ç‚¹é—´å¤åˆ¶ã€‚</p><h2>åŸºç¡€</h2><p>åœ¨ Spark-shell ä¸­è¿è¡Œå¦‚ä¸‹è„šæœ¬</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> lines = sc.textFile(<span class="string">"test.txt"</span>)</span><br><span class="line">scala&gt; <span class="keyword">val</span> lineLengths = lines.map(s =&gt; s.length)</span><br><span class="line">scala&gt; <span class="keyword">val</span> totalLength = lineLengths.reduce((a, b) =&gt; a + b))</span><br><span class="line">totalLength: <span class="type">Int</span> = <span class="number">30</span></span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€æ­¥ï¼š å®šä¹‰å¤–éƒ¨æ–‡ä»¶ RDDï¼Œlines æŒ‡å‘ test.txt æ–‡ä»¶ï¼Œ è¿™ä¸ªæ–‡ä»¶å³æ²¡æœ‰åŠ è½½åˆ°å†…å­˜ä¹Ÿæ²¡æœ‰åšå…¶ä»–çš„æ“ä½œï¼Œæ‰€ä»¥å³ä½¿æ–‡ä»¶ä¸å­˜åœ¨ä¹Ÿä¸ä¼šæŠ¥é”™ã€‚<br>ç¬¬äºŒæ­¥ï¼š å®šä¹‰ lineLengthsï¼Œå®ƒæ˜¯ map è½¬æ¢(transformation)çš„ç»“æœã€‚åŒæ ·ï¼ŒlineLengths ç”±äº lazy æ¨¡å¼ä¹Ÿæ²¡æœ‰ç«‹å³è®¡ç®—ã€‚<br>ç¬¬ä¸‰æ­¥ï¼š reduce æ˜¯ä¸€ä¸ª actionï¼Œ æ‰€ä»¥çœŸæ­£æ‰§è¡Œè¯»æ–‡ä»¶å’Œ map è®¡ç®—æ˜¯åœ¨è¿™ä¸€æ­¥å‘ç”Ÿçš„ã€‚Spark å°†è®¡ç®—åˆ†æˆå¤šä¸ª taskï¼Œå¹¶ä¸”è®©å®ƒä»¬è¿è¡Œåœ¨å¤šå°æœºå™¨ä¸Šã€‚æ¯å°æœºå™¨éƒ½è¿è¡Œè‡ªå·±çš„ map éƒ¨åˆ†å’Œæœ¬åœ° reduce éƒ¨åˆ†ï¼Œæœ€åå°†ç»“æœè¿”å›ç»™é©±åŠ¨ç¨‹åºã€‚</p><p>å¦‚æœæˆ‘ä»¬æƒ³è¦å†æ¬¡ä½¿ç”¨ lineLengthsï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ persist æˆ–è€… cache å°† lineLengths ä¿å­˜åˆ°å†…å­˜ä¸­ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; lineLengths.persist()</span><br><span class="line">scala&gt; lineLengths.collect()</span><br><span class="line">res7: <span class="type">Array</span>[<span class="type">Int</span>] = <span class="type">Array</span>(<span class="number">5</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">7</span>)</span><br></pre></td></tr></table></figure><h1>Transformations</h1><p>Transformations æ˜¯ RDD çš„åŸºæœ¬è½¬æ¢æ“ä½œï¼Œä¸»è¦æ–¹æ³•æœ‰ï¼š mapï¼Œ filterï¼Œ flatMapï¼Œ mapPartitionsï¼Œ mapPartitionsWithIndexï¼Œ sampleï¼Œ unionï¼Œ intersectionï¼Œ distinctï¼Œ groupByKeyï¼Œ reduceByKeyï¼Œ aggregateByKeyï¼Œ sortByKeyï¼Œ joinï¼Œ cogroupï¼Œ cartesianï¼Œ pipeï¼Œ coalesceï¼Œ repartitionã€‚</p><h2>filter(func)</h2><p>filter è¿”å›ä¸€ä¸ªæ–°çš„æ•°æ®é›†ï¼Œä»æºæ•°æ®ä¸­é€‰å‡º func è¿”å› true çš„å…ƒç´ ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> a = sc.parallelize(<span class="number">1</span> to <span class="number">9</span>)</span><br><span class="line">scala&gt; <span class="keyword">val</span> b = a.filter(x =&gt; x &gt; <span class="number">5</span>)</span><br><span class="line">scala&gt; b.collect</span><br><span class="line">res11: <span class="type">Array</span>[<span class="type">Int</span>] = <span class="type">Array</span>(<span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>)</span><br></pre></td></tr></table></figure><h2>flatMap(func)</h2><p>ä¸ map ç±»ä¼¼ï¼ŒåŒºåˆ«æ˜¯åŸ RDD ä¸­çš„å…ƒç´ ç» map å¤„ç†ååªèƒ½ç”Ÿæˆä¸€ä¸ªå…ƒç´ ï¼Œè€Œç» flatmap å¤„ç†åå¯ç”Ÿæˆå¤šä¸ªå…ƒç´ æ¥æ„å»ºæ–° RDDï¼Œ æ‰€ä»¥ func å¿…é¡»è¿”å›ä¸€ä¸ª Seqï¼Œè€Œä¸æ˜¯å•ä¸ª itemã€‚</p><p>ä¸¾ä¾‹ï¼šå¯¹åŸRDDä¸­çš„æ¯ä¸ªå…ƒç´ xäº§ç”Ÿyä¸ªå…ƒç´ ï¼ˆä»1åˆ°yï¼Œyä¸ºå…ƒç´ xçš„å€¼ï¼‰</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> a = sc.parallelize(<span class="number">1</span> to <span class="number">4</span>, <span class="number">2</span>)</span><br><span class="line">scala&gt; <span class="keyword">val</span> b = a.flatMap(x =&gt; <span class="number">1</span> to x)</span><br><span class="line">scala&gt; b.collect</span><br><span class="line">res12: <span class="type">Array</span>[<span class="type">Int</span>] = <span class="type">Array</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br></pre></td></tr></table></figure><h2>mapPartitions(func)</h2><p>mapPartitions æ˜¯ map çš„ä¸€ä¸ªå˜ç§ã€‚map çš„è¾“å…¥å‡½æ•°æ˜¯åº”ç”¨äº RDD ä¸­æ¯ä¸ªå…ƒç´ ï¼Œè€Œ mapPartitions çš„è¾“å…¥å‡½æ•°æ˜¯åº”ç”¨äºæ¯ä¸ªåˆ†åŒºï¼Œä¹Ÿå°±æ˜¯æŠŠæ¯ä¸ªåˆ†åŒºä¸­çš„å†…å®¹ä½œä¸ºæ•´ä½“æ¥å¤„ç†çš„ã€‚<br>å®ƒçš„å‡½æ•°å®šä¹‰ä¸ºï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mapPartitions</span></span>[<span class="type">U</span>](f: (<span class="type">Iterator</span>[<span class="type">T</span>]) =&gt; <span class="type">Iterator</span>[<span class="type">U</span>], preservesPartitioning: <span class="type">Boolean</span> = <span class="literal">false</span>)(<span class="keyword">implicit</span> arg0: <span class="type">ClassTag</span>[<span class="type">U</span>]): <span class="type">RDD</span>[<span class="type">U</span>]</span><br></pre></td></tr></table></figure><p>f å³ä¸ºè¾“å…¥å‡½æ•°ï¼Œå®ƒå¤„ç†æ¯ä¸ªåˆ†åŒºé‡Œé¢çš„å†…å®¹ã€‚æ¯ä¸ªåˆ†åŒºä¸­çš„å†…å®¹å°†ä»¥ Iterator[T] ä¼ é€’ç»™è¾“å…¥å‡½æ•° fï¼Œf çš„è¾“å‡ºç»“æœæ˜¯ Iterator[U]ã€‚æœ€ç»ˆçš„ RDD ç”±æ‰€æœ‰åˆ†åŒºç»è¿‡è¾“å…¥å‡½æ•°å¤„ç†åçš„ç»“æœåˆå¹¶èµ·æ¥çš„ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> rdd = sc.makeRDD(<span class="number">1</span> to <span class="number">5</span>, <span class="number">2</span>)</span><br><span class="line">scala&gt; <span class="keyword">val</span> rdd2 = rdd.mapPartitions(x =&gt; &#123;</span><br><span class="line">     | <span class="keyword">var</span> result = <span class="type">List</span>[<span class="type">Int</span>]()</span><br><span class="line">     | <span class="keyword">var</span> i = <span class="number">0</span></span><br><span class="line">     | <span class="keyword">while</span>(x.hasNext) &#123;</span><br><span class="line">     |   i += x.next</span><br><span class="line">     | &#125;</span><br><span class="line">     | result.::(i).iterator</span><br><span class="line">     |&#125;)</span><br><span class="line">scala&gt; rdd2.collect</span><br><span class="line">res13: <span class="type">Array</span>[<span class="type">Int</span>] = <span class="type">Array</span>(<span class="number">3</span>, <span class="number">12</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; rdd2.partitions.size</span><br><span class="line">res14: <span class="type">Int</span> = <span class="number">2</span></span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ä¾‹å­ä¸­ rdd2 å°† rdd æ¯ä¸ªåˆ†åŒºä¸­çš„æ•°å€¼ç´¯åŠ ã€‚</p><h2>mapPartitionsWithIndex(func)</h2><p>å‡½æ•°å®šä¹‰</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mapPartitionsWithIndex</span></span>[<span class="type">U</span>](f: (<span class="type">Int</span>, <span class="type">Iterator</span>[<span class="type">T</span>]) =&gt; <span class="type">Iterator</span>[<span class="type">U</span>], preservesPartitioning: <span class="type">Boolean</span> = <span class="literal">false</span>)(<span class="keyword">implicit</span> arg0: <span class="type">ClassTag</span>[<span class="type">U</span>]): <span class="type">RDD</span>[<span class="type">U</span>]</span><br></pre></td></tr></table></figure><p>mapPartitionsWithIndex çš„ä½œç”¨ä¸ mapPartitions ç›¸åŒï¼Œä¸è¿‡æä¾›äº†ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºåˆ†åŒºçš„ç´¢å¼•ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> rdd = sc.makeRDD(<span class="number">1</span> to <span class="number">5</span>, <span class="number">2</span>)</span><br><span class="line">scala&gt; <span class="keyword">val</span> rdd2 = rdd.mapPartitionsWithIndex(</span><br><span class="line">     | (x, iter) =&gt; &#123;</span><br><span class="line">     |   <span class="keyword">var</span> result = <span class="type">List</span>[<span class="type">Int</span>]()</span><br><span class="line">     |   <span class="keyword">var</span> i = <span class="number">0</span></span><br><span class="line">     |    <span class="keyword">while</span>(iter.hasNext) &#123;</span><br><span class="line">     |     i += iter.next</span><br><span class="line">     |    &#125;</span><br><span class="line">     |   result.::(x + <span class="string">"|"</span> + i).iterator</span><br><span class="line">     |&#125;)</span><br><span class="line">scala&gt; rdd2.collect</span><br><span class="line">res14: <span class="type">Array</span>[<span class="type">String</span>] = <span class="type">Array</span>(<span class="number">0</span>|<span class="number">3</span>, <span class="number">1</span>|<span class="number">12</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; rdd2.partitions.size</span><br><span class="line">res15: <span class="type">Int</span> = <span class="number">2</span></span><br></pre></td></tr></table></figure><h2>sample(withReplacement, fraction, seed)</h2><h2>union(otherDataset)</h2><p>å‡½æ•°å®šä¹‰ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">union</span></span>(other: <span class="type">RDD</span>[<span class="type">T</span>]): <span class="type">RDD</span>[<span class="type">T</span>]</span><br></pre></td></tr></table></figure><p>è¯¥å‡½æ•°æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯å°†ä¸¤ä¸ª RDD è¿›è¡Œåˆå¹¶ï¼Œä¸å»é‡ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">var</span> rdd1 = sc.makeRDD(<span class="number">1</span> to <span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line">scala&gt; <span class="keyword">var</span> rdd2 = sc.makeRDD(<span class="number">2</span> to <span class="number">3</span>,<span class="number">1</span>)</span><br><span class="line">scala&gt; rdd1.union(rdd2).collect</span><br><span class="line">res18: <span class="type">Array</span>[<span class="type">Int</span>] = <span class="type">Array</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure><h2>intersection(otherDataset)</h2><p>å‡½æ•°å®šä¹‰ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">intersection</span></span>(other: <span class="type">RDD</span>[<span class="type">T</span>]): <span class="type">RDD</span>[<span class="type">T</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">intersection</span></span>(other: <span class="type">RDD</span>[<span class="type">T</span>], numPartitions: <span class="type">Int</span>): <span class="type">RDD</span>[<span class="type">T</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">intersection</span></span>(other: <span class="type">RDD</span>[<span class="type">T</span>], partitioner: <span class="type">Partitioner</span>)(<span class="keyword">implicit</span> ord: <span class="type">Ordering</span>[<span class="type">T</span>] = <span class="literal">null</span>): <span class="type">RDD</span>[<span class="type">T</span>]</span><br></pre></td></tr></table></figure><p>è¯¥å‡½æ•°è¿”å›ä¸¤ä¸ª RDD çš„äº¤é›†ï¼Œå¹¶ä¸”å»é‡ã€‚<br>å‚æ•°numPartitionsæŒ‡å®šè¿”å›çš„RDDçš„åˆ†åŒºæ•°ã€‚<br>å‚æ•°partitionerç”¨äºæŒ‡å®šåˆ†åŒºå‡½æ•°</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">var</span> rdd1 = sc.makeRDD(<span class="number">1</span> to <span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line">scala&gt; rdd1.collect</span><br><span class="line">res19: <span class="type">Array</span>[<span class="type">Int</span>] = <span class="type">Array</span>(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"> </span><br><span class="line">scala&gt; <span class="keyword">var</span> rdd2 = sc.makeRDD(<span class="number">2</span> to <span class="number">3</span>,<span class="number">1</span>)</span><br><span class="line">scala&gt; rdd2.collect</span><br><span class="line">res20: <span class="type">Array</span>[<span class="type">Int</span>] = <span class="type">Array</span>(<span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"> </span><br><span class="line">scala&gt; rdd1.intersection(rdd2).collect</span><br><span class="line">res21: <span class="type">Array</span>[<span class="type">Int</span>] = <span class="type">Array</span>(<span class="number">2</span>)</span><br></pre></td></tr></table></figure><h2>distinct([numTasks])</h2><p>è¿”å›ä¸€ä¸ªæ–°çš„ RDDï¼Œé‡Œé¢åŒ…å«æº RDD ä¸­æ‰€æœ‰çš„ï¼ˆdistinctï¼‰å…ƒç´ ã€‚</p><h2>groupByKey([numTasks])</h2><h2>reduceByKey(func, [numTasks])</h2><h2>aggregateByKey(zeroValue)(seqOp, combOp, [numTasks])</h2><h2>sortByKey([ascending], [numTasks])</h2><h2>join(otherDataset, [numTasks])</h2><h2>cogroup(otherDataset, [numTasks])</h2><h2>cartesian(otherDataset)</h2><h2>pipe(command, [envVars])</h2><h2>coalesce(numPartitions)</h2><h2>repartition(numPartitions)</h2>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;RDD æ“ä½œæœ‰å“ªäº›&lt;/h1&gt;
&lt;p&gt;Spark RDD æ”¯æŒ2ç§ç±»å‹çš„æ“ä½œ: transformations å’Œ actionsã€‚transformationsï¼š ä»å·²ç»å­˜åœ¨çš„æ•°æ®é›†ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®é›†ï¼Œå¦‚ mapã€‚actionsï¼š æ•°æ®é›†ä¸Šè¿›è¡Œè®¡ç®—ä¹‹åè¿”å›ä¸€ä¸ªå€¼ï¼Œå¦‚ reduceã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ Spark ä¸­ï¼Œæ‰€æœ‰çš„ transformations éƒ½æ˜¯ lazy çš„ï¼Œå®ƒä»¬ä¸ä¼šé©¬ä¸Šè®¡ç®—å®ƒä»¬çš„ç»“æœï¼Œè€Œæ˜¯ä»…ä»…è®°å½•è½¬æ¢æ“ä½œæ˜¯åº”ç”¨åˆ°å“ªäº›åŸºç¡€æ•°æ®é›†ä¸Šçš„ï¼Œåªæœ‰å½“ actions è¦è¿”å›ç»“æœçš„æ—¶å€™è®¡ç®—æ‰ä¼šå‘ç”Ÿã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Big Data" scheme="https://lz5z.com/categories/Big-Data/"/>
    
    
      <category term="Spark" scheme="https://lz5z.com/tags/Spark/"/>
    
      <category term="Scala" scheme="https://lz5z.com/tags/Scala/"/>
    
      <category term="RDD" scheme="https://lz5z.com/tags/RDD/"/>
    
      <category term="Transformations" scheme="https://lz5z.com/tags/Transformations/"/>
    
  </entry>
  
  <entry>
    <title>Spark RDD åŸºç¡€</title>
    <link href="https://lz5z.com/Spark-RDD/"/>
    <id>https://lz5z.com/Spark-RDD/</id>
    <published>2016-11-29T11:29:07.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h1>RDD æ˜¯ä»€ä¹ˆï¼Ÿ</h1><img src="/assets/img/spark-stack.png" alt="rdd">[å›¾ç‰‡æ‘˜è‡ª[Spark å®˜ç½‘](http://spark.apache.org/)]<p><a href="http://spark.apache.org/docs/latest/programming-guide.html" target="_blank" rel="noopener">RDD</a> å…¨ç§° <strong>Resilient Distributed Datasets</strong>ï¼Œæ˜¯ Spark ä¸­çš„æŠ½è±¡æ•°æ®ç»“æ„ç±»å‹ï¼Œä»»ä½•æ•°æ®åœ¨Sparkä¸­éƒ½è¢«è¡¨ç¤ºä¸ºRDDã€‚ Spark å»ºç«‹åœ¨ç»Ÿä¸€æŠ½è±¡çš„RDDä¹‹ä¸Šï¼Œä½¿å¾—å®ƒå¯ä»¥ä»¥åŸºæœ¬ä¸€è‡´çš„æ–¹å¼åº”å¯¹ä¸åŒçš„å¤§æ•°æ®å¤„ç†åœºæ™¯ï¼ŒåŒ…æ‹¬MapReduceï¼ŒStreamingï¼ŒSQLï¼ŒMachine Learning ç­‰ã€‚</p><a id="more"></a><p>ç®€å•çš„ç†è§£å°±æ˜¯ RDD å°±æ˜¯ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œä¸è¿‡è¿™ä¸ªæ•°æ®ç»“æ„ä¸­çš„æ•°æ®æ˜¯åˆ†å¸ƒå¼å­˜å‚¨çš„ï¼ŒSpark ä¸­å°è£…äº†å¯¹ RDD çš„å„ç§æ“ä½œï¼Œå¯ä»¥è®©ç”¨æˆ·æ˜¾å¼åœ°å°†æ•°æ®å­˜å‚¨åˆ°ç£ç›˜å’Œå†…å­˜ä¸­ï¼Œå¹¶èƒ½æ§åˆ¶æ•°æ®çš„åˆ†åŒºã€‚</p><h2>RDD ç‰¹æ€§</h2><p>RDD æ˜¯ Spark çš„æ ¸å¿ƒï¼Œä¹Ÿæ˜¯æ•´ä¸ª Spark çš„æ¶æ„åŸºç¡€ã€‚å®ƒçš„ç‰¹æ€§å¯ä»¥æ€»ç»“å¦‚ä¸‹ï¼š</p><ul><li>å®ƒæ˜¯ä¸å˜çš„æ•°æ®ç»“æ„å­˜å‚¨</li><li>å®ƒæ˜¯æ”¯æŒè·¨é›†ç¾¤çš„åˆ†å¸ƒå¼æ•°æ®ç»“æ„</li><li>å¯ä»¥æ ¹æ®æ•°æ®è®°å½•çš„keyå¯¹ç»“æ„è¿›è¡Œåˆ†åŒº</li><li>æä¾›äº†ç²—ç²’åº¦çš„æ“ä½œï¼Œä¸”è¿™äº›æ“ä½œéƒ½æ”¯æŒåˆ†åŒº</li><li>å®ƒå°†æ•°æ®å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œä»è€Œæä¾›äº†ä½å»¶è¿Ÿæ€§</li></ul><h1>åˆ›å»º RDD</h1><p>æœ¬æ–‡ä¸­çš„ä¾‹å­å…¨éƒ¨åŸºäº <a href="http://spark.apache.org/downloads.html" target="_blank" rel="noopener">Spark-shell</a>ï¼Œéœ€è¦çš„è¯·è‡ªè¡Œå®‰è£…ã€‚</p><p>åˆ›å»º RDD ä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯ä½¿ç”¨ SparkContext çš„ <strong>parallelize</strong> æ–¹æ³•åˆ›å»ºå¹¶è¡Œé›†åˆï¼Œè¿˜æœ‰ä¸€ç§æ˜¯é€šè¿‡å¤–éƒ¨å¤–éƒ¨æ•°æ®é›†çš„æ–¹æ³•åˆ›å»ºï¼Œæ¯”å¦‚æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼ŒHDFSï¼ŒHBaseï¼ŒCassandraç­‰ã€‚</p><h2>å¹¶è¡Œé›†åˆ</h2><p>ä½¿ç”¨ parallelize æ–¹æ³•ä»æ™®é€šæ•°ç»„ä¸­åˆ›å»º RDD:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">scala&gt;</span><span class="bash"> val a = sc.parallelize(1 to 9, 3)</span></span><br><span class="line">a: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[0] at parallelize at &lt;console&gt;:21</span><br></pre></td></tr></table></figure><p>parallelize æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯æ•°æ®é›†åˆï¼Œç¬¬äºŒä¸ªæ˜¯åˆ‡ç‰‡çš„ä¸ªæ•°ï¼Œè¡¨ç¤ºå°†æ•°æ®å­˜æ”¾åœ¨å‡ ä¸ªåˆ†åŒºä¸­ã€‚</p><p>ä¸€æ—¦åˆ›å»ºå®Œæˆï¼Œè¿™ä¸ªåˆ†å¸ƒå¼æ•°æ®é›†(a)å°±å¯ä»¥è¢«å¹¶è¡Œæ“ä½œã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨ a.reduce((m, n) =&gt; m + n) å°†è¿™ä¸ªæ•°ç»„ä¸­çš„å…ƒç´ ç›¸åŠ ã€‚ æ›´å¤šçš„æ“ä½œè¯·è§ <a href="https://lz5z.com/rdd-operations">Spark RDD æ“ä½œ</a>ã€‚</p><h2>æœ¬åœ°æ–‡ä»¶</h2><p>æ–‡æœ¬æ–‡ä»¶ RDDs å¯ä»¥ä½¿ç”¨ SparkContext çš„ textFile æ–¹æ³•åˆ›å»ºã€‚ åœ¨è¿™ä¸ªæ–¹æ³•é‡Œä¼ å…¥æ–‡ä»¶çš„ URI (æœºå™¨ä¸Šçš„æœ¬åœ°è·¯å¾„æˆ– hdfs://ï¼Œs3n:// ç­‰)ï¼Œç„¶åå®ƒä¼šå°†æ–‡ä»¶è¯»å–æˆä¸€ä¸ªè¡Œé›†åˆã€‚</p><p>è¯»å–æ–‡ä»¶ test.txt æ¥åˆ›å»ºRDDï¼Œæ–‡ä»¶ä¸­çš„æ¯ä¸€è¡Œå°±æ˜¯RDDä¸­çš„ä¸€ä¸ªå…ƒç´ ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">scala&gt;</span><span class="bash"> val b = sc.textFile(<span class="string">"test.txt"</span>)</span></span><br><span class="line">b: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[2] at textFile at &lt;console&gt;:21</span><br></pre></td></tr></table></figure><p>ä¸€æ—¦åˆ›å»ºå®Œæˆï¼Œ(b) å°±èƒ½åšæ•°æ®é›†æ“ä½œã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„æ–¹å¼ä½¿ç”¨ map å’Œ reduce æ“ä½œå°†æ‰€æœ‰è¡Œçš„é•¿åº¦ç›¸åŠ ï¼š b.map(s =&gt; s.length).reduce((m, n) =&gt; m + n)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">scala&gt;</span><span class="bash"> b.collect</span></span><br><span class="line">res1: Array[String] = Array(Spark, RDD, Transformations, Actions)</span><br><span class="line"></span><br><span class="line"><span class="meta">scala&gt;</span><span class="bash"> b.map(s =&gt; s.length).reduce((m, n) =&gt; m + n))</span></span><br><span class="line">res2: Int = 30</span><br></pre></td></tr></table></figure><h3>Spark è¯»æ–‡ä»¶æ³¨æ„äº‹é¡¹</h3><ol><li><p>å¦‚æœä½¿ç”¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿè·¯å¾„ï¼Œæ–‡ä»¶å¿…é¡»èƒ½åœ¨ worker èŠ‚ç‚¹ä¸Šç”¨ç›¸åŒçš„è·¯å¾„è®¿é—®åˆ°ã€‚è¦ä¹ˆå¤åˆ¶æ–‡ä»¶åˆ°æ‰€æœ‰çš„ worker èŠ‚ç‚¹ï¼Œè¦ä¹ˆä½¿ç”¨ç½‘ç»œçš„æ–¹å¼å…±äº«æ–‡ä»¶ç³»ç»Ÿã€‚</p></li><li><p>æ‰€æœ‰ Spark çš„åŸºäºæ–‡ä»¶çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬ textFileï¼Œèƒ½å¾ˆå¥½åœ°æ”¯æŒæ–‡ä»¶ç›®å½•ï¼Œå‹ç¼©è¿‡çš„æ–‡ä»¶å’Œé€šé…ç¬¦ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨ textFile(&quot;/æ–‡ä»¶ç›®å½•&quot;)ï¼ŒtextFile(&quot;/æ–‡ä»¶*.txt&quot;) å’Œ textFile(&quot;/æ–‡ä»¶ç›®å½•/*.gz&quot;)ã€‚</p></li><li><p>textFile æ–¹æ³•ä¹Ÿå¯ä»¥é€‰æ‹©ç¬¬äºŒä¸ªå¯é€‰å‚æ•°æ¥æ§åˆ¶åˆ‡ç‰‡(slices)çš„æ•°ç›®ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒSpark ä¸ºæ¯ä¸€ä¸ªæ–‡ä»¶å—(HDFS é»˜è®¤æ–‡ä»¶å—å¤§å°æ˜¯ 64M)åˆ›å»ºä¸€ä¸ªåˆ‡ç‰‡(slice)ã€‚ä½†æ˜¯ä½ ä¹Ÿå¯ä»¥é€šè¿‡ä¸€ä¸ªæ›´å¤§çš„å€¼æ¥è®¾ç½®ä¸€ä¸ªæ›´é«˜çš„åˆ‡ç‰‡æ•°ç›®ã€‚æ³¨æ„ï¼Œä½ ä¸èƒ½è®¾ç½®ä¸€ä¸ªå°äºæ–‡ä»¶å—æ•°ç›®çš„åˆ‡ç‰‡å€¼ã€‚</p></li></ol><h3>ScalaAPI å¯¹å…¶å®ƒæ•°æ®æ ¼å¼çš„æ”¯æŒ</h3><ol><li><p>SparkContext.wholeTextFiles è®©ä½ è¯»å–ä¸€ä¸ªåŒ…å«å¤šä¸ªå°æ–‡æœ¬æ–‡ä»¶çš„æ–‡ä»¶ç›®å½•å¹¶ä¸”è¿”å›æ¯ä¸€ä¸ª(filename, content)å¯¹ã€‚ä¸ textFile çš„å·®å¼‚æ˜¯ï¼šå®ƒè®°å½•çš„æ˜¯æ¯ä¸ªæ–‡ä»¶ä¸­çš„æ¯ä¸€è¡Œã€‚</p></li><li><p>å¯¹äº <a href="http://hadoop.apache.org/docs/current/api/org/apache/hadoop/mapred/SequenceFileInputFormat.html" target="_blank" rel="noopener">SequenceFiles</a>ï¼Œå¯ä»¥ä½¿ç”¨ SparkContext çš„ sequenceFile[K, V] æ–¹æ³•åˆ›å»ºï¼ŒK å’Œ V åˆ†åˆ«å¯¹åº”çš„æ˜¯ key å’Œ values çš„ç±»å‹ã€‚åƒ <a href="http://hadoop.apache.org/docs/current/api/org/apache/hadoop/io/IntWritable.html" target="_blank" rel="noopener">IntWritable</a> ä¸ <a href="http://hadoop.apache.org/docs/current/api/org/apache/hadoop/io/Text.html" target="_blank" rel="noopener">Text</a> ä¸€æ ·ï¼Œå®ƒä»¬å¿…é¡»æ˜¯ Hadoop çš„ <a href="http://hadoop.apache.org/docs/current/api/org/apache/hadoop/io/Writable.html" target="_blank" rel="noopener">Writable</a> æ¥å£çš„å­ç±»ã€‚å¦å¤–ï¼Œå¯¹äºå‡ ç§é€šç”¨çš„ Writablesï¼ŒSpark å…è®¸ä½ æŒ‡å®šåŸç”Ÿç±»å‹æ¥æ›¿ä»£ã€‚ä¾‹å¦‚ï¼š sequenceFile[Int, String] å°†ä¼šè‡ªåŠ¨è¯»å– IntWritables å’Œ Textã€‚</p></li><li><p>å¯¹äºå…¶ä»–çš„ Hadoop InputFormatsï¼Œä½ å¯ä»¥ä½¿ç”¨ SparkContext.hadoopRDD æ–¹æ³•ï¼Œå®ƒå¯ä»¥æŒ‡å®šä»»æ„çš„ JobConfï¼Œè¾“å…¥æ ¼å¼(InputFormat)ï¼Œkey ç±»å‹ï¼Œvalues ç±»å‹ã€‚ä½ å¯ä»¥è·Ÿè®¾ç½® Hadoop job ä¸€æ ·çš„æ–¹æ³•è®¾ç½®è¾“å…¥æºã€‚ä½ è¿˜å¯ä»¥åœ¨æ–°çš„ MapReduce æ¥å£(org.apache.hadoop.mapreduce)åŸºç¡€ä¸Šä½¿ç”¨ SparkContext.newAPIHadoopRDD(è¯‘è€…æ³¨ï¼šè€çš„æ¥å£æ˜¯ SparkContext.newHadoopRDD)ã€‚</p></li><li><p>RDD.saveAsObjectFile å’Œ SparkContext.objectFile æ”¯æŒä¿å­˜ä¸€ä¸ªRDDï¼Œä¿å­˜æ ¼å¼æ˜¯ä¸€ä¸ªç®€å•çš„ Java<br>å¯¹è±¡åºåˆ—åŒ–æ ¼å¼ã€‚è¿™æ˜¯ä¸€ç§æ•ˆç‡ä¸é«˜çš„ä¸“æœ‰æ ¼å¼ï¼Œå¦‚ Avroï¼Œå®ƒæä¾›äº†ç®€å•çš„æ–¹æ³•æ¥ä¿å­˜ä»»ä½•ä¸€ä¸ª RDDã€‚</p></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;RDD æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h1&gt;
&lt;img src=&quot;/assets/img/spark-stack.png&quot; alt=&quot;rdd&quot;&gt;
[å›¾ç‰‡æ‘˜è‡ª[Spark å®˜ç½‘](http://spark.apache.org/)]
&lt;p&gt;&lt;a href=&quot;http://spark.apache.org/docs/latest/programming-guide.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;RDD&lt;/a&gt; å…¨ç§° &lt;strong&gt;Resilient Distributed Datasets&lt;/strong&gt;ï¼Œæ˜¯ Spark ä¸­çš„æŠ½è±¡æ•°æ®ç»“æ„ç±»å‹ï¼Œä»»ä½•æ•°æ®åœ¨Sparkä¸­éƒ½è¢«è¡¨ç¤ºä¸ºRDDã€‚ Spark å»ºç«‹åœ¨ç»Ÿä¸€æŠ½è±¡çš„RDDä¹‹ä¸Šï¼Œä½¿å¾—å®ƒå¯ä»¥ä»¥åŸºæœ¬ä¸€è‡´çš„æ–¹å¼åº”å¯¹ä¸åŒçš„å¤§æ•°æ®å¤„ç†åœºæ™¯ï¼ŒåŒ…æ‹¬MapReduceï¼ŒStreamingï¼ŒSQLï¼ŒMachine Learning ç­‰ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Big Data" scheme="https://lz5z.com/categories/Big-Data/"/>
    
    
      <category term="Spark" scheme="https://lz5z.com/tags/Spark/"/>
    
      <category term="Scala" scheme="https://lz5z.com/tags/Scala/"/>
    
      <category term="RDD" scheme="https://lz5z.com/tags/RDD/"/>
    
  </entry>
  
  <entry>
    <title>æ·±å…¥å­¦ä¹  JavaScriptâ€”â€”Object å¯¹è±¡</title>
    <link href="https://lz5z.com/JavaScript%E4%B8%AD%E7%9A%84Object%E5%AF%B9%E8%B1%A1/"/>
    <id>https://lz5z.com/JavaScriptä¸­çš„Objectå¯¹è±¡/</id>
    <published>2016-11-25T15:52:44.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h1>Objectâ€“JavaScriptä¸–ç•Œçš„èµ·æº</h1><p>JavaScriptçš„ä¸–ç•Œä¸­ã€Œä¸€åˆ‡çš†æ˜¯å¯¹è±¡ã€ï¼Œè€Œæ‰€æœ‰å¯¹è±¡çš„èµ·æºå°±æ˜¯ Object å¯¹è±¡ã€‚</p><p>ç¥èªªï¼šã€Œè¦æœ‰å…‰ã€ã€‚å°±æœ‰äº†å…‰ã€‚</p><a id="more"></a><h2>Objectç®€ä»‹</h2><p>JavaScriptä¸­çš„å¯¹è±¡å…¶å®æ˜¯ä¸€ç»„æ•°æ®å’ŒåŠŸèƒ½çš„é›†åˆã€‚æˆ‘ä»¬é€šè¿‡æ‰§è¡Œ new æ“ä½œç¬¦ + <strong>å¯¹è±¡ç±»å‹çš„åç§°</strong>æ¥åˆ›å»ºå¯¹è±¡ã€‚<br>åˆ›å»º Object ç±»å‹çš„å®ä¾‹å¹¶ä¸ºå…¶æ·»åŠ å±æ€§å’Œæ–¹æ³•å°±å¯ä»¥åˆ›å»ºè‡ªå®šä¹‰å¯¹è±¡ï¼ŒObjectæ—¢æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä¹Ÿæ˜¯è‡ªèº«çš„æ„é€ å‡½æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> o = <span class="keyword">new</span> <span class="built_in">Object</span>;  <span class="comment">//å¦‚æœä¸ç»™æ„é€ å‡½æ•°ä¼ é€’å‚æ•°å¯ä»¥çœç•¥åœ†æ‹¬å·ï¼Œä½†ä¸æ¨èè¿™ä¹ˆå†™</span></span><br></pre></td></tr></table></figure><p>ä»…ä»…åˆ›å»º Object å®ä¾‹å¹¶æ²¡æœ‰ä»€ä¹ˆç”¨å¤„ï¼Œä½†å…³é”®æ˜¯ç†è§£ä¸€ä¸ªé‡è¦çš„æ€æƒ³ï¼Œå³åœ¨JavaScriptä¸­ï¼ŒObject ç±»å‹æ˜¯å®ƒæ‰€æœ‰å®ä¾‹çš„åŸºç¡€ï¼Œæ¢å¥è¯è¯´ï¼ŒObjectç±»å‹æ‰€å…·æœ‰çš„ä»»ä½•å±æ€§å’Œæ–¹æ³•åŒæ ·å­˜åœ¨äºæ›´å…·ä½“çš„å¯¹è±¡ä¸­ã€‚</p><h2>Objectå¯¹è±¡å±æ€§</h2><p>Object å¯¹è±¡ä¸€å…±æœ‰ä¸‰ä¸ªå±æ€§ï¼š _<em>proto</em>_, constructor, prototypeã€‚</p><h3>Object._<em>proto</em>_</h3><ol><li>ä¸ºå¯¹è±¡è®¾ç½®åŸå‹</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Rectangle</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> rec = <span class="keyword">new</span> Rectangle();</span><br><span class="line">rec.__proto__ === Rectangle.prototype; <span class="comment">// true</span></span><br><span class="line">rec.__proto__ = <span class="built_in">Object</span>.prototype;</span><br><span class="line">rec.__proto__ === Rectangle.prototype; <span class="comment">//false</span></span><br></pre></td></tr></table></figure><ol start="2"><li>_<em>proto</em>_ å±æ€§å¯ç”¨äºè®¾ç½®å¯¹è±¡çš„åŸå‹</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> proto = &#123; <span class="attr">y</span>: <span class="number">2</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = &#123; <span class="attr">x</span>: <span class="number">10</span> &#125;;</span><br><span class="line">obj.__proto__ = proto;</span><br><span class="line"></span><br><span class="line">proto.y = <span class="number">20</span>;</span><br><span class="line">proto.z = <span class="number">40</span>;</span><br><span class="line"></span><br><span class="line">obj.x === <span class="number">10</span>;  <span class="comment">// true</span></span><br><span class="line">obj.y === <span class="number">20</span>;  <span class="comment">// true</span></span><br><span class="line">obj.z === <span class="number">40</span>;  <span class="comment">// true</span></span><br></pre></td></tr></table></figure><ol start="3"><li>è¿™åªé€‚ç”¨äºå¯æ‰©å±•çš„å¯¹è±¡ï¼Œä¸€ä¸ªä¸å¯æ‰©å±•çš„å¯¹è±¡çš„ _<em>proto</em>_ å±æ€§æ˜¯ä¸å¯å˜çš„</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;&#125;;</span><br><span class="line"><span class="built_in">Object</span>.preventExtensions(obj);</span><br><span class="line"></span><br><span class="line">obj.__proto__ = &#123;&#125;; <span class="comment">// æŠ›å‡ºå¼‚å¸¸TypeError</span></span><br></pre></td></tr></table></figure><h3>Object.constructor</h3><p>æ‰€æœ‰å¯¹è±¡éƒ½ä¼šä»å®ƒçš„åŸå‹ä¸Šç»§æ‰¿ä¸€ä¸ª constructor å±æ€§ï¼Œ constructor å±æ€§æ˜¯ä¿å­˜å½“å‰å¯¹è±¡çš„æ„é€ å‡½æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> o = <span class="keyword">new</span> <span class="built_in">Object</span>; <span class="comment">// æˆ–è€… o = &#123;&#125;</span></span><br><span class="line">o.constructor === <span class="built_in">Object</span>; <span class="comment">// true</span></span><br><span class="line"><span class="keyword">let</span> a = <span class="keyword">new</span> <span class="built_in">Array</span>  <span class="comment">// æˆ–è€… a = []</span></span><br><span class="line">a.constructor === <span class="built_in">Array</span>; <span class="comment">// true</span></span><br><span class="line"><span class="keyword">let</span> n = <span class="keyword">new</span> <span class="built_in">Number</span>(<span class="number">3</span>); <span class="comment">// æˆ–è€… n = 3</span></span><br><span class="line">n.constructor === <span class="built_in">Number</span>; <span class="comment">// true</span></span><br></pre></td></tr></table></figure><h3>Object.prototype</h3><p>Object.prototype å±æ€§è¡¨ç¤ºå¯¹è±¡ Object çš„åŸå‹å¯¹è±¡ï¼Œç”±äºæ‰€æœ‰çš„å¯¹è±¡éƒ½æ˜¯åŸºäº Objectï¼Œæ‰€ä»¥ <strong>æ‰€æœ‰çš„å¯¹è±¡éƒ½ç»§æ‰¿äº†Object.prototypeçš„å±æ€§å’Œæ–¹æ³•</strong>ï¼Œé™¤éè¿™äº›å±æ€§å’Œæ–¹æ³•è¢«å…¶ä»–åŸå‹é“¾æ›´é‡Œå±‚çš„æ”¹åŠ¨æ‰€è¦†ç›–ã€‚</p><ol><li><strong>Object.prototype.hasOwnProperty()</strong></li></ol><p>è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ ï¼Œè¡¨ç¤ºæŸä¸ªå¯¹è±¡æ˜¯å¦å«æœ‰æŒ‡å®šçš„å±æ€§ï¼Œè€Œä¸”æ­¤å±æ€§éåŸå‹é“¾ç»§æ‰¿çš„ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> o = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br><span class="line">o.name = <span class="string">'object'</span>;</span><br><span class="line">o.hasOwnProperty(<span class="string">'name'</span>);             <span class="comment">// true</span></span><br><span class="line">o.hasOwnProperty(<span class="string">'toString'</span>);         <span class="comment">// false</span></span><br><span class="line">o.hasOwnProperty(<span class="string">'hasOwnProperty'</span>);   <span class="comment">// false</span></span><br></pre></td></tr></table></figure><ol start="2"><li><strong>Object.prototype.isPrototypeOf()</strong></li></ol><p>è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæŒ‡å®šçš„å¯¹è±¡æ˜¯å¦åœ¨æœ¬å¯¹è±¡çš„åŸå‹é“¾ä¸­ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Rectangle</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> rec = <span class="keyword">new</span> Rectangle();</span><br><span class="line"></span><br><span class="line">Rectangle.prototype.isPrototypeOf(rec); <span class="comment">// true</span></span><br></pre></td></tr></table></figure><ol start="3"><li><strong>Object.prototype.propertyIsEnumerable()</strong></li></ol><p>åˆ¤æ–­æŒ‡å®šå±æ€§æ˜¯å¦å¯æšä¸¾ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">object.propertyIsEnumerable(proName)</span><br></pre></td></tr></table></figure><p>å¦‚æœ proName å­˜åœ¨äº object ä¸­ï¼Œä¸”å¯ä»¥ä½¿ç”¨ for å¾ªç¯å¯¹å…¶è¿›è¡Œæšä¸¾ï¼Œåˆ™ propertyIsEnumerable æ–¹æ³•è¿”å› trueã€‚å¦‚æœ object ä¸å…·æœ‰æ‰€æŒ‡å®šåç§°çš„å±æ€§æˆ–è€…æ‰€æŒ‡å®šçš„å±æ€§æ˜¯ä¸å¯æšä¸¾çš„ï¼Œåˆ™ propertyIsEnumerable æ–¹æ³•å°†è¿”å› falseã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="string">"apple"</span>, <span class="string">"banana"</span>, <span class="string">"cactus"</span>);</span><br><span class="line">a.propertyIsEnumerable(<span class="number">1</span>); <span class="comment">// trueï¼Œ0-2 éƒ½æ˜¯true</span></span><br><span class="line">a.propertyIsEnumerable(<span class="number">3</span>); <span class="comment">// false</span></span><br></pre></td></tr></table></figure><ol start="4"><li><strong>Object.prototype.toString()</strong></li></ol><p>è¿”å›å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> o = &#123;&#125;;</span><br><span class="line">o.toString() <span class="comment">// "[object Object]"</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç è°ƒç”¨ç©ºå¯¹è±¡çš„ toString æ–¹æ³•ï¼Œç»“æœè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸² <strong>â€œ[object Object]â€</strong>ï¼Œå…¶ä¸­ç¬¬äºŒä¸ªObjectè¡¨ç¤ºè¯¥å€¼çš„æ„é€ å‡½æ•°ï¼Œ<br>å®ä¾‹å¯¹è±¡å¯èƒ½ä¼šè‡ªå®šä¹‰ toString æ–¹æ³•ï¼Œè¦†ç›–æ‰ Object.prototype.toString æ–¹æ³•ã€‚é€šè¿‡å‡½æ•°çš„ call æ–¹æ³•ï¼Œå¯ä»¥åœ¨ä»»æ„å€¼ä¸Šè°ƒç”¨ Object.prototype.toString æ–¹æ³•ï¼Œå¸®åŠ©æˆ‘ä»¬åˆ¤æ–­è¿™ä¸ªå€¼çš„ç±»å‹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="number">0</span>) <span class="comment">// "[object Number]"</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="string">''</span>) <span class="comment">// "[object String]"</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="literal">true</span>) <span class="comment">// "[object Boolean]"</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="literal">undefined</span>) <span class="comment">// "[object Undefined]"</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="literal">null</span>) <span class="comment">// "[object Null]"</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="built_in">Math</span>) <span class="comment">// "[object Math]"</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(&#123;&#125;) <span class="comment">// "[object Object]"</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call([]) <span class="comment">// "[object Array]"</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="built_in">Symbol</span>()) <span class="comment">//"[object Symbol]"</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(<span class="regexp">/./</span>) <span class="comment">//"[object RegExp]"</span></span><br></pre></td></tr></table></figure><ol start="5"><li><strong>Object.prototype.valueOf()</strong></li></ol><p>è¿”å›æŒ‡å®šå¯¹è±¡çš„åŸå§‹å€¼ã€‚valueOf() æ–¹æ³•çš„ä½œç”¨æ˜¯è¿”å›ä¸€ä¸ªå¯¹è±¡çš„â€œå€¼â€ï¼Œé»˜è®¤æƒ…å†µä¸‹è¿”å›å¯¹è±¡æœ¬èº«ã€‚</p><p>valueOfæ–¹æ³•çš„ä¸»è¦ç”¨é€”æ˜¯ï¼ŒJavaScriptè‡ªåŠ¨ç±»å‹è½¬æ¢æ—¶ä¼šé»˜è®¤è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> o = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br><span class="line"><span class="number">1</span> + o <span class="comment">// "1[object Object]"  //é»˜è®¤è°ƒç”¨valueOf()æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//è‡ªå®šä¹‰valueOf() æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.prototype.valueOf = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> + <span class="keyword">new</span> <span class="built_in">Object</span>; <span class="comment">// 3</span></span><br></pre></td></tr></table></figure><h2>Objectå¯¹è±¡æ–¹æ³•</h2><table><thead><tr><th style="text-align:left">å‡½æ•°</th><th style="text-align:left">æè¿°</th></tr></thead><tbody><tr><td style="text-align:left">Object.assign(target, â€¦sources)</td><td style="text-align:left">å°†æ¥è‡ªä¸€ä¸ªæˆ–å¤šä¸ªæºå¯¹è±¡ä¸­çš„å€¼å¤åˆ¶åˆ°ä¸€ä¸ªç›®æ ‡å¯¹è±¡ã€‚</td></tr><tr><td style="text-align:left">Object.create(prototype, descriptors)</td><td style="text-align:left">åˆ›å»ºå…·æœ‰æŒ‡å®šåŸå‹å¹¶å¯é€‰æ‹©åŒ…å«æŒ‡å®šå±æ€§çš„å¯¹è±¡ã€‚</td></tr><tr><td style="text-align:left">Object.defineProperties(obj, props)</td><td style="text-align:left">å°†ä¸€ä¸ªæˆ–å¤šä¸ªå±æ€§æ·»åŠ åˆ°å¯¹è±¡ï¼Œå’Œ/æˆ–ä¿®æ”¹ç°æœ‰å±æ€§çš„ç‰¹æ€§ã€‚</td></tr><tr><td style="text-align:left">Object.defineProperty(obj, prop, descriptor)</td><td style="text-align:left">å°†å±æ€§æ·»åŠ åˆ°å¯¹è±¡ï¼Œæˆ–ä¿®æ”¹ç°æœ‰å±æ€§çš„ç‰¹æ€§ã€‚</td></tr><tr><td style="text-align:left">Object.freeze(obj)</td><td style="text-align:left">é˜²æ­¢ä¿®æ”¹ç°æœ‰å±æ€§çš„ç‰¹æ€§å’Œå€¼ï¼Œå¹¶é˜²æ­¢æ·»åŠ æ–°å±æ€§ã€‚</td></tr><tr><td style="text-align:left">Object.getOwnPropertyDescriptor(obj, prop)</td><td style="text-align:left">è¿”å›æ•°æ®å±æ€§æˆ–è®¿é—®å™¨å±æ€§çš„å®šä¹‰ã€‚</td></tr><tr><td style="text-align:left">Object.getOwnPropertyNames(obj)</td><td style="text-align:left">è¿”å›å¯¹è±¡å±æ€§åŠæ–¹æ³•çš„åç§°ã€‚</td></tr><tr><td style="text-align:left">Object.getOwnPropertySymbols(obj)</td><td style="text-align:left">è¿”å›å¯¹è±¡çš„ç¬¦å·å±æ€§ã€‚</td></tr><tr><td style="text-align:left">Object.getPrototypeOf(obj)</td><td style="text-align:left">è¿”å›å¯¹è±¡çš„åŸå‹ã€‚</td></tr><tr><td style="text-align:left"><a href="http://Object.is" target="_blank" rel="noopener">Object.is</a>(value1, value2)</td><td style="text-align:left">è¿”å›ä¸€ä¸ªå€¼ï¼Œè¯¥å€¼æŒ‡ç¤ºä¸¤ä¸ªå€¼æ˜¯å¦ç›¸åŒã€‚</td></tr><tr><td style="text-align:left">Object.isExtensible(obj)</td><td style="text-align:left">è¿”å›æŒ‡ç¤ºæ˜¯å¦å¯å°†æ–°å±æ€§æ·»åŠ åˆ°å¯¹è±¡çš„å€¼ã€‚</td></tr><tr><td style="text-align:left">Object.isFrozen(obj)</td><td style="text-align:left">å¦‚æœæ— æ³•åœ¨å¯¹è±¡ä¸­ä¿®æ”¹ç°æœ‰å±æ€§çš„ç‰¹æ€§å’Œå€¼ï¼Œå¹¶ä¸”æ— æ³•å°†æ–°å±æ€§æ·»åŠ åˆ°å¯¹è±¡ï¼Œåˆ™è¿”å› trueã€‚</td></tr><tr><td style="text-align:left">Object.seal(obj)</td><td style="text-align:left">é˜²æ­¢ä¿®æ”¹ç°æœ‰å±æ€§çš„ç‰¹æ€§ï¼Œå¹¶é˜²æ­¢æ·»åŠ æ–°å±æ€§ã€‚</td></tr><tr><td style="text-align:left">Object.isSealed(obj)</td><td style="text-align:left">å¦‚æœæ— æ³•åœ¨å¯¹è±¡ä¸­ä¿®æ”¹ç°æœ‰å±æ€§ç‰¹æ€§ï¼Œå¹¶ä¸”æ— æ³•å°†æ–°å±æ€§æ·»åŠ åˆ°å¯¹è±¡ï¼Œåˆ™è¿”å› trueã€‚</td></tr><tr><td style="text-align:left">Object.keys(obj)</td><td style="text-align:left">è¿”å›å¯¹è±¡çš„ <strong>å¯æšä¸¾</strong>å±æ€§å’Œæ–¹æ³•çš„åç§°ã€‚</td></tr><tr><td style="text-align:left">Object.preventExtensions(obj)</td><td style="text-align:left">é˜²æ­¢å‘å¯¹è±¡æ·»åŠ æ–°å±æ€§ã€‚</td></tr><tr><td style="text-align:left">Object.setPrototypeOf(obj, prototype)</td><td style="text-align:left">è®¾ç½®å¯¹è±¡çš„åŸå‹ã€‚</td></tr></tbody></table><hr><h3>Object.assign(target, â€¦sources)</h3><p>Object.assign() æ–¹æ³•å¯ä»¥æŠŠä»»æ„å¤šä¸ªçš„æºå¯¹è±¡è‡ªèº«çš„å¯æšä¸¾å±æ€§æ‹·è´ç»™ç›®æ ‡å¯¹è±¡ï¼Œç„¶åè¿”å›ç›®æ ‡å¯¹è±¡ã€‚</p><p>å¦‚æœå­˜åœ¨åˆ†é…é”™è¯¯ï¼Œæ­¤å‡½æ•°å°†å¼•å‘ TypeErrorï¼Œè¿™å°†ç»ˆæ­¢å¤åˆ¶æ“ä½œã€‚å¦‚æœç›®æ ‡å±æ€§ä¸å¯å†™ï¼Œåˆ™å°†å¼•å‘ TypeErrorã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> first = &#123; <span class="attr">name</span>: <span class="string">"Leo"</span> &#125;;</span><br><span class="line"><span class="keyword">let</span> last = &#123; <span class="attr">lastName</span>: <span class="string">"Li"</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person = <span class="built_in">Object</span>.assign(first, last);</span><br><span class="line"><span class="built_in">console</span>.log(person); <span class="comment">//&#123; name: "Leo", lastName: "Li" &#125; </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> clone = <span class="built_in">Object</span>.assign(&#123;&#125;, person); <span class="comment">//ä½¿ç”¨ Object.assign å…‹éš†å¯¹è±¡ã€‚</span></span><br></pre></td></tr></table></figure><h3>Object.create(prototype, descriptors)</h3><p>åˆ›å»ºä¸€ä¸ªå…·æœ‰æŒ‡å®šåŸå‹ä¸”åŒ…å«æŒ‡å®šå±æ€§çš„å¯¹è±¡ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> newObj = <span class="built_in">Object</span>.create(<span class="literal">null</span>, &#123;</span><br><span class="line">  size: &#123;</span><br><span class="line">    value: <span class="string">"large"</span>,</span><br><span class="line">    enumerable: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  shape: &#123;</span><br><span class="line">    value: <span class="string">"round"</span>,</span><br><span class="line">    enumerable: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(newObj.size); <span class="comment">// large</span></span><br><span class="line"><span class="built_in">console</span>.log(newObj.shape); <span class="comment">// round</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.getPrototypeOf(newObj)); <span class="comment">//null</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨Object.createå®ç°ç±»å¼ç»§æ‰¿</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Shape</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.x = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">this</span>.y = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Shape.prototype.move = <span class="function"><span class="keyword">function</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.x += x;</span><br><span class="line">    <span class="keyword">this</span>.y += y;</span><br><span class="line">    <span class="built_in">console</span>.info(<span class="string">"Shape moved."</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Rectangle - subclass</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Rectangle</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  Shape.call(<span class="keyword">this</span>); <span class="comment">//call super constructor.</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Rectangle.prototype = <span class="built_in">Object</span>.create(Shape.prototype);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> rect = <span class="keyword">new</span> Rectangle();</span><br><span class="line"></span><br><span class="line">rect <span class="keyword">instanceof</span> Rectangle <span class="comment">//true.</span></span><br><span class="line">rect <span class="keyword">instanceof</span> Shape <span class="comment">//true.</span></span><br><span class="line"></span><br><span class="line">rect.move(<span class="number">1</span>, <span class="number">1</span>); <span class="comment">//Outputs, "Shape moved."</span></span><br></pre></td></tr></table></figure><h3>Object.keys(obj)</h3><p>è¿”å›å¯¹è±¡å¯æšä¸¾çš„å±æ€§åç»„æˆçš„æ•°ç»„ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = [<span class="string">"Hello"</span>, <span class="string">"World"</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.keys(a)</span><br><span class="line"><span class="comment">// ["0", "1"]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.getOwnPropertyNames(a)</span><br><span class="line"><span class="comment">// ["0", "1", "length"]</span></span><br></pre></td></tr></table></figure><h3>Object.getOwnPropertyNames(obj)</h3><p>è¿”å›ä¸€ä¸ªç”±æŒ‡å®šå¯¹è±¡çš„æ‰€æœ‰è‡ªèº«å±æ€§çš„å±æ€§åï¼ˆåŒ…æ‹¬ä¸å¯æšä¸¾å±æ€§ï¼‰ç»„æˆçš„æ•°ç»„ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>];</span><br><span class="line"><span class="built_in">Object</span>.getOwnPropertyNames(arr).sort(); <span class="comment">//[ '0', '1', '2', 'length' ]</span></span><br></pre></td></tr></table></figure><h3>Object.getOwnPropertySymbols(obj)</h3><p>è¯¥ç‰¹æ€§å±äº ECMAScript 2015ï¼ˆES6ï¼‰è§„èŒƒã€‚</p><p>Object.getOwnPropertySymbols() æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œè¯¥æ•°ç»„åŒ…å«äº†æŒ‡å®šå¯¹è±¡è‡ªèº«çš„ï¼ˆéç»§æ‰¿çš„ï¼‰æ‰€æœ‰ symbol å±æ€§é”®ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;&#125;;</span><br><span class="line"><span class="keyword">let</span> a = <span class="built_in">Symbol</span>(<span class="string">"a"</span>);</span><br><span class="line"><span class="keyword">let</span> b = <span class="built_in">Symbol</span>.for(<span class="string">"b"</span>);</span><br><span class="line"></span><br><span class="line">obj[a] = <span class="string">"a"</span>;</span><br><span class="line">obj[b] = <span class="string">"b"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> objectSymbols = <span class="built_in">Object</span>.getOwnPropertySymbols(obj);</span><br><span class="line"></span><br><span class="line">objectSymbols.length; <span class="comment">// 2</span></span><br><span class="line">objectSymbols;        <span class="comment">// [Symbol(a), Symbol(b)]</span></span><br><span class="line">objectSymbols[<span class="number">0</span>];     <span class="comment">// Symbol(a)</span></span><br></pre></td></tr></table></figure><h3>å¯¹è±¡é™åˆ¶å‹æ–¹æ³•</h3><p>ES5ä¸­æä¾›äº†ä¸€ç³»åˆ—é™åˆ¶å¯¹è±¡è¢«ä¿®æ”¹çš„æ–¹æ³•ï¼Œç”¨æ¥é˜²æ­¢è¢«æŸäº›å¯¹è±¡è¢«æ— æ„é—´ä¿®æ”¹å¯¼è‡´çš„é”™è¯¯ã€‚æ¯ç§é™åˆ¶ç±»å‹åŒ…å«ä¸€ä¸ªåˆ¤æ–­æ–¹æ³•å’Œä¸€ä¸ªè®¾ç½®æ–¹æ³•ã€‚</p><h4>é˜»æ­¢å¯¹è±¡æ‰©å±•</h4><p>Object.preventExtensions() ç”¨æ¥é™åˆ¶å¯¹è±¡çš„æ‰©å±•ï¼Œè®¾ç½®ä¹‹åï¼Œå¯¹è±¡å°†æ— æ³•æ·»åŠ æ–°å±æ€§ã€‚</p><ol><li>å¯¹è±¡çš„å±æ€§ä¸å¯ç”¨æ‰©å±•ï¼Œä½†æ˜¯å·²å­˜åœ¨çš„å±æ€§å¯ä»¥è¢«åˆ é™¤ã€‚</li><li>æ— æ³•æ·»åŠ æ–°å±æ€§æŒ‡çš„æ˜¯æ— æ³•åœ¨è‡ªèº«ä¸Šæ·»åŠ å±æ€§ï¼Œå¦‚æœæ˜¯åœ¨å¯¹è±¡çš„åŸå‹ä¸Šï¼Œè¿˜æ˜¯å¯ä»¥æ·»åŠ å±æ€§çš„ã€‚</li><li>Object.isExtensible() æ–¹æ³•ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å¯æ‰©å±•ã€‚</li></ol><h4>å°†å¯¹è±¡å¯†å°</h4><p>Object.seal() å¯ä»¥å¯†å°ä¸€ä¸ªå¯¹è±¡å¹¶è¿”å›è¢«å¯†å°çš„å¯¹è±¡ã€‚<br>å¯†å°å¯¹è±¡æ— æ³•æ·»åŠ æˆ–åˆ é™¤å·²æœ‰å±æ€§ï¼Œä¹Ÿæ— æ³•ä¿®æ”¹å±æ€§çš„enumerableï¼Œwritableï¼Œconfigurableï¼Œä½†æ˜¯å¯ä»¥ä¿®æ”¹å±æ€§å€¼ã€‚</p><p>é€šè¿‡ Object.isSealed() åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å¯†å°ã€‚</p><h4>å†»ç»“å¯¹è±¡</h4><p>Object.freeze() æ–¹æ³•ç”¨æ¥å†»ç»“ä¸€ä¸ªå¯¹è±¡ï¼Œè¢«å†»ç»“çš„å¯¹è±¡å°†æ— æ³•æ·»åŠ ï¼Œä¿®æ”¹ï¼Œåˆ é™¤å±æ€§å€¼ï¼Œä¹Ÿæ— æ³•ä¿®æ”¹å±æ€§çš„ç‰¹æ€§å€¼ï¼Œå³è¿™ä¸ªå¯¹è±¡æ— æ³•è¢«ä¿®æ”¹ã€‚è¢«å†»ç»“çš„å¯¹è±¡æ— æ³•åˆ é™¤è‡ªèº«çš„å±æ€§ï¼Œä½†æ˜¯é€šè¿‡å…¶åŸå‹å¯¹è±¡è¿˜æ˜¯å¯ä»¥æ–°å¢å±æ€§çš„ã€‚</p><p>é€šè¿‡ Object.isFrozen() å¯ä»¥ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦è¢«å†»ç»“äº†ã€‚</p><h3>å…¶å®ƒ</h3><p>Object.definePropertiesã€Object.definePropertyã€Object.freezeã€Object.getOwnPropertyDescriptor çš„ç”¨æ³•è¯·å‚è€ƒ<a href="https://lz5z.com/Object.defineProperty%E4%B8%BA%E5%AF%B9%E8%B1%A1%E5%AE%9A%E4%B9%89%E5%B1%9E%E6%80%A7/">ä½¿ç”¨Object.definePropertyä¸ºå¯¹è±¡å®šä¹‰å±æ€§</a>ã€‚</p><h2>æ€»ç»“</h2><p>Object å¯¹è±¡è™½ç„¶å¹³æ—¶æˆ‘ä»¬å¾ˆå°‘ç›´æ¥ç”¨åˆ°ï¼Œä½†æ˜¯å¾ˆå¤šå¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•éƒ½æ˜¯ç”± Object ç»§æ‰¿è€Œæ¥çš„ï¼Œå› æ­¤éå¸¸å…·æœ‰å­¦ä¹ æ„ä¹‰ã€‚<br>è¿™ç¯‡ Blog è™½ç„¶éƒ½æ˜¯ API çº§åˆ«çš„å­¦ä¹ ï¼Œå¯æ˜¯å¾ˆå¤šä¸œè¥¿éƒ½æ˜¯æ¬ ä¸‹çš„æŠ€æœ¯å€ºï¼Œå°±å½“è¡¥è¯¾äº†ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;Objectâ€“JavaScriptä¸–ç•Œçš„èµ·æº&lt;/h1&gt;
&lt;p&gt;JavaScriptçš„ä¸–ç•Œä¸­ã€Œä¸€åˆ‡çš†æ˜¯å¯¹è±¡ã€ï¼Œè€Œæ‰€æœ‰å¯¹è±¡çš„èµ·æºå°±æ˜¯ Object å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;ç¥èªªï¼šã€Œè¦æœ‰å…‰ã€ã€‚å°±æœ‰äº†å…‰ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="https://lz5z.com/tags/JavaScript/"/>
    
      <category term="Object" scheme="https://lz5z.com/tags/Object/"/>
    
  </entry>
  
  <entry>
    <title>æ·±å…¥å­¦ä¹  JavaScriptâ€”â€”é—­åŒ…</title>
    <link href="https://lz5z.com/JavaScript%E9%97%AD%E5%8C%85/"/>
    <id>https://lz5z.com/JavaScripté—­åŒ…/</id>
    <published>2016-11-24T22:39:45.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h1>ä»€ä¹ˆæ˜¯é—­åŒ…ï¼ˆClosureï¼‰</h1><p>â€œå‡½æ•°æŒ‚è½½çˆ¶ç¯å¢ƒçš„æ—¶æœºï¼Œå¦‚æœæ˜¯å®šä¹‰æ—¶å°±æ˜¯é—­åŒ…ï¼Œå¦‚æœæ˜¯æ‰§è¡Œæ—¶å°±ä¸æ˜¯é—­åŒ…ã€‚â€â€”â€”å¬ä¸€ä½å¤§ç¥åŒäº‹è®²çš„ã€‚</p><p>â€œé—­åŒ…æ˜¯æŒ‡é‚£äº›èƒ½å¤Ÿè®¿é—®ç‹¬ç«‹(è‡ªç”±)å˜é‡çš„å‡½æ•° (å˜é‡åœ¨æœ¬åœ°ä½¿ç”¨ï¼Œä½†å®šä¹‰åœ¨ä¸€ä¸ªå°é—­çš„ä½œç”¨åŸŸä¸­)ã€‚æ¢å¥è¯è¯´ï¼Œè¿™äº›å‡½æ•°å¯ä»¥â€œè®°å¿†â€å®ƒè¢«åˆ›å»ºæ—¶å€™çš„ç¯å¢ƒã€‚â€â€”â€”<a href="https://developer.mozilla.org/cn/docs/Web/JavaScript/Closures" target="_blank" rel="noopener">MDN</a></p><p>åˆšå­¦JavaScriptçš„æ—¶å€™çœ‹äº†è¿™äº›å®šä¹‰åæˆ‘å°±å“­äº†ï¼Œè¦æƒ³ç†è§£é—­åŒ…è¿˜æ˜¯è¦çœ‹ä¾‹å­ã€‚</p><a id="more"></a><h2>ä¸¾ä¸ªæ —å­</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> a = <span class="number">1</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">inner</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(a++);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> inner;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> fun = foo();</span><br><span class="line">fun(); <span class="comment">//1</span></span><br><span class="line">fun(); <span class="comment">//2</span></span><br><span class="line">fun = <span class="literal">null</span>; <span class="comment">//aè¢«åƒåœ¾å›æ”¶</span></span><br></pre></td></tr></table></figure><p>å‡½æ•° foo è¿”å›ä¸€ä¸ªå†…éƒ¨å‡½æ•° innerï¼Œæ‰€ä»¥â€œlet fun = foo()â€çš„ç»“æœåº”è¯¥æ˜¯â€œfun = innerâ€ ä¹Ÿå°±æ˜¯ â€œfun = function (){console.log(a++)};â€</p><p>é‚£ä¹ˆå½“æ‰§è¡Œ fun() çš„æ—¶å€™ <strong>a=?</strong>ï¼Œæ˜¾ç„¶åœ¨ fun çš„å¤–éƒ¨ç¯å¢ƒä¸­æ˜¯æ²¡æœ‰ a çš„å®šä¹‰çš„ï¼Œäºæ˜¯å°±å‘ inner å‡½æ•°å®šä¹‰æ—¶å€™çš„çˆ¶ç¯å¢ƒä¸­æ‰¾ <strong>a</strong>ï¼Œæœç„¶åœ¨ foo å‡½æ•°ä¸­æ‰¾åˆ°äº†ã€‚è¿™æ ·å°±å¯ä»¥ç†è§£ä¸Šé¢ç»™å‡ºçš„ç¬¬ä¸€ä¸ªé—­åŒ…çš„å®šä¹‰äº†ï¼šä¸€ä¸ªå‡½æ•°åœ¨æ‰§è¡Œçš„æ—¶å€™ï¼Œå¦‚æœèƒ½æ‹¿åˆ°å®šä¹‰æ—¶å€™çˆ¶ç¯å¢ƒçš„å€¼ï¼Œè¿™æ ·å°±æ˜¯é—­åŒ…ï¼Œåä¹‹åˆ™ä¸æ˜¯é—­åŒ…ã€‚</p><p>é‚£é—­åŒ…ç©¶ç«Ÿæ˜¯ä¸€ä¸ªä»€ä¹ˆä¸œè¥¿å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥æŠŠé—­åŒ…ç†è§£æˆ â€œå‡½æ•° + å‡½æ•°åˆ›å»ºæ—¶çš„ç¯å¢ƒâ€çš„ç»„åˆï¼Œæ¯”å¦‚ä¸Šé¢çš„ inner å‡½æ•° + å˜é‡a å°±æ˜¯ä¸€ä¸ªé—­åŒ…ã€‚</p><h1>é—­åŒ…çš„ç”¨é€”</h1><p>é€šè¿‡ä½¿ç”¨é—­åŒ…ï¼Œæˆ‘ä»¬å¯ä»¥åšå¾ˆå¤šäº‹æƒ…ã€‚</p><ol><li>JavaScripté¢å‘å¯¹è±¡</li><li>æå‡ä»£ç æ•ˆç‡</li><li>ç¼–å†™æ›´ä¼˜é›…çš„ä»£ç </li></ol><h2>åŒ¿åè‡ªæ‰§è¡Œå‡½æ•°ï¼ˆç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼ï¼‰</h2><p>åŒ¿åè‡ªæ‰§è¡Œå‡½æ•°æœ‰ä¸¤ä¸ªä½œç”¨ï¼š</p><ol><li>ä¸æ±¡æŸ“å…¨å±€å˜é‡</li><li>å‡½æ•°æ‰§è¡Œå®Œç«‹åˆ»é‡Šæ”¾åƒåœ¾å›æ”¶</li></ol><p>æ¯”å¦‚æˆ‘ä¸Šé¢æ —å­ä¸­åˆ›å»ºçš„å‡½æ•° foo ä¼šè‡ªåŠ¨ç»‘å®šåˆ°å…¨å±€å˜é‡ä¸­</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.foo()(); <span class="comment">//1</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·æˆ‘ä»¬æ¯æ¬¡åˆ›å»ºä¸€ä¸ªå‡½æ•°éƒ½å¿…é¡»è¦ä½¿ç”¨ const/let/var å»å£°æ˜ä¸€ä¸ªå˜é‡ç­‰äºå‡½æ•°ï¼Œä¸ç„¶å…¨å±€å¯¹è±¡çš„å±æ€§ä¼šè¶Šæ¥è¶Šå¤šï¼Œä»è€Œå½±å“è®¿é—®é€Ÿåº¦(å› ä¸ºå˜é‡çš„å–å€¼æ˜¯éœ€è¦ä»åŸå‹é“¾ä¸Šéå†çš„)ï¼Œè€Œä¸”å¯èƒ½ä¼šå¯¼è‡´å˜é‡å†²çªã€‚</p><h2>ç»“æœç¼“å­˜</h2><p>ç»“æœç¼“å­˜æ˜¯é—­åŒ…èƒ½æ˜¾è‘—æé«˜ç¨‹åºæ•ˆç‡çš„ä¸€ä¸ªç”¨é€”ã€‚å‡å¦‚æœ‰ä¸€ä¸ªå¤„ç†è¿‡ç¨‹å¾ˆè€—æ—¶çš„å‡½æ•°å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ¯æ¬¡å¤„ç†çš„ç»“æœç¼“å­˜èµ·æ¥ï¼Œå½“å†æ¬¡è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œå°±å…ˆä»ç¼“å­˜ä¸­æŸ¥æ‰¾ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> cacheSearch = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> cache = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">search</span>(<span class="params">key</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (key <span class="keyword">in</span> cache) &#123;</span><br><span class="line">            <span class="keyword">return</span> cache[key];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            cache[key] = <span class="string">`Hello <span class="subst">$&#123;key&#125;</span>`</span>; <span class="comment">//å‡å¦‚è¿™æ˜¯ä¸€æ­¥æ¯”è¾ƒå¤æ‚çš„è®¡ç®—</span></span><br><span class="line">            <span class="keyword">return</span> cache[key];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> search;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><h2>å°è£…</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> foo = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> name = <span class="string">'name'</span>; <span class="comment">// â€œé—­åŒ…â€å†…çš„å‡½æ•°å¯ä»¥è®¿é—® name å˜é‡ï¼Œè€Œ name å˜é‡å¯¹äºå¤–éƒ¨å´æ˜¯éšè—çš„</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        getName: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// é€šè¿‡å®šä¹‰çš„æ¥å£æ¥è®¿é—® name</span></span><br><span class="line">            <span class="keyword">return</span> name;</span><br><span class="line">        &#125;,</span><br><span class="line">        setName: <span class="function"><span class="keyword">function</span>(<span class="params">new_name</span>) </span>&#123; <span class="comment">// é€šè¿‡å®šä¹‰çš„æ¥å£æ¥ä¿®æ”¹ name</span></span><br><span class="line">            name = new_name;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line">foo.getName(); <span class="comment">// å¾—åˆ° 'name'</span></span><br><span class="line">foo.setName(<span class="string">'newName'</span>); <span class="comment">// é€šè¿‡å‡½æ•°æ¥å£ï¼Œæˆ‘ä»¬è®¿é—®å¹¶ä¿®æ”¹äº† name å˜é‡</span></span><br><span class="line">foo.getName(); <span class="comment">// å¾—åˆ° 'newName'</span></span><br><span class="line">foo.name; <span class="comment">// Type errorï¼Œè®¿é—®ä¸èƒ½</span></span><br></pre></td></tr></table></figure><h2>å®ç°ç±»å’Œç»§æ‰¿</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> name = <span class="string">'God'</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    getName: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> name;</span><br><span class="line">    &#125;,</span><br><span class="line">    setName: <span class="function"><span class="keyword">function</span>(<span class="params">newName</span>) </span>&#123;</span><br><span class="line">      name = newName;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> Student = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line"><span class="comment">//ç»§æ‰¿è‡ªPerson</span></span><br><span class="line">Student.prototype = <span class="keyword">new</span> Person();</span><br><span class="line"><span class="comment">//æ·»åŠ ç§æœ‰æ–¹æ³•</span></span><br><span class="line">Student.prototype.Say = <span class="function"><span class="keyword">function</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`Hello <span class="subst">$&#123;name&#125;</span>`</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> leo = <span class="keyword">new</span> Student();</span><br><span class="line">leo.setName(<span class="string">'Leo'</span>);</span><br><span class="line">leo.Say(<span class="string">'World'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(leo.getName());</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„ Person æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç”±äº JavaScript â€œæ²¡æœ‰â€ class çš„æ¦‚å¿µï¼ˆæœ‰ class å…³é”®å­—ï¼‰<br>ï¼Œæ‰€ä»¥åœ¨ JavaScript ä¸­ï¼Œnew åé¢è·Ÿçš„æ˜¯æ„é€ å‡½æ•°ã€‚<br>ä¸Šé¢çš„ä»£ç é‡Œé¢å®šä¹‰äº† Student ç»§æ‰¿è‡ª Personï¼Œæ‰€ä»¥æ‹¥æœ‰ getName æ–¹æ³•ï¼Œç„¶åé€šè¿‡prototypeæ·»åŠ è‡ªå·±çš„æ–¹æ³•ã€‚</p><h2>ç»å…¸é¢˜ç›®</h2><p>å®ç°æ¯éš”ä¸€ç§’è¾“å‡ºä¸€ä¸ªé€’å¢çš„æ•°å­—ï¼ˆ0 åˆ° 5ï¼‰</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(i)</span><br><span class="line">    &#125;, i * <span class="number">1000</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢è¿™ç§å†™æ³•æƒ³å¿…å¤§å®¶éƒ½çŸ¥é“ç»“æœæ˜¯ä»€ä¹ˆï¼Œé‚£å°±æ˜¯æ¯éš”ä¸€ç§’è¾“å‡ºä¸€ä¸ª5</p><p>ä½¿ç”¨é—­åŒ…å®ç°è¾“å‡ºæ•°å­—ä¸º 0 åˆ° 5</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">    (<span class="function">(<span class="params">a</span>) =&gt;</span> &#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(a)</span><br><span class="line">        &#125;, a * <span class="number">1000</span>)</span><br><span class="line">    &#125;)(i)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸€ç§ä½¿ç”¨é—­åŒ…çš„æ–¹å¼æ˜¯ä½¿ç”¨ Array çš„ forEach å¾ªç¯ï¼ŒforEach é‡Œçš„æ‰§è¡Œå‡½æ•°ä¹Ÿè¡Œæˆäº†ä¸€ä¸ªé—­åŒ…</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>].forEach(<span class="function">(<span class="params">i</span>) =&gt;</span> &#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(i)</span><br><span class="line">    &#125;, i * <span class="number">1000</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>å½“ç„¶ä½¿ç”¨ ES6 çš„ let æ‰æ˜¯æœ€å¥½çš„é€‰æ‹©</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(i)</span><br><span class="line">    &#125;, i * <span class="number">1000</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2>é—­åŒ…æ€»ç»“</h2><p>é—­åŒ…ä¸‰ä¸ªç‰¹æ€§ï¼š</p><ol><li>å‡½æ•°åµŒå¥—å‡½æ•°</li><li>å‡½æ•°å†…éƒ¨å¯ä»¥å¼•ç”¨å¤–éƒ¨çš„å‚æ•°å’Œå˜é‡</li><li>å‚æ•°å’Œå˜é‡ä¸ä¼šè¢«åƒåœ¾å›æ”¶æœºåˆ¶å›æ”¶</li></ol><p>é—­åŒ…çš„ä¼˜ç‚¹ï¼š</p><ol><li>å¸Œæœ›ä¸€ä¸ªå˜é‡é•¿æœŸé©»æ‰åœ¨å†…å­˜ä¸­</li><li>é¿å…å…¨å±€å˜é‡çš„æ±¡æŸ“</li><li>ç§æœ‰æˆå‘˜çš„å­˜åœ¨</li></ol><p>é—­åŒ…çš„ç¼ºç‚¹ï¼š</p><ol><li>é—­åŒ…çš„ç¼ºç‚¹å°±æ˜¯å¸¸é©»å†…å­˜ï¼Œä¼šå¢å¤§å†…å­˜ä½¿ç”¨é‡ï¼Œä½¿ç”¨ä¸å½“å¾ˆå®¹æ˜“é€ æˆå†…å­˜æ³„éœ²ã€‚</li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;ä»€ä¹ˆæ˜¯é—­åŒ…ï¼ˆClosureï¼‰&lt;/h1&gt;
&lt;p&gt;â€œå‡½æ•°æŒ‚è½½çˆ¶ç¯å¢ƒçš„æ—¶æœºï¼Œå¦‚æœæ˜¯å®šä¹‰æ—¶å°±æ˜¯é—­åŒ…ï¼Œå¦‚æœæ˜¯æ‰§è¡Œæ—¶å°±ä¸æ˜¯é—­åŒ…ã€‚â€â€”â€”å¬ä¸€ä½å¤§ç¥åŒäº‹è®²çš„ã€‚&lt;/p&gt;
&lt;p&gt;â€œé—­åŒ…æ˜¯æŒ‡é‚£äº›èƒ½å¤Ÿè®¿é—®ç‹¬ç«‹(è‡ªç”±)å˜é‡çš„å‡½æ•° (å˜é‡åœ¨æœ¬åœ°ä½¿ç”¨ï¼Œä½†å®šä¹‰åœ¨ä¸€ä¸ªå°é—­çš„ä½œç”¨åŸŸä¸­)ã€‚æ¢å¥è¯è¯´ï¼Œè¿™äº›å‡½æ•°å¯ä»¥â€œè®°å¿†â€å®ƒè¢«åˆ›å»ºæ—¶å€™çš„ç¯å¢ƒã€‚â€â€”â€”&lt;a href=&quot;https://developer.mozilla.org/cn/docs/Web/JavaScript/Closures&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;MDN&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åˆšå­¦JavaScriptçš„æ—¶å€™çœ‹äº†è¿™äº›å®šä¹‰åæˆ‘å°±å“­äº†ï¼Œè¦æƒ³ç†è§£é—­åŒ…è¿˜æ˜¯è¦çœ‹ä¾‹å­ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="https://lz5z.com/tags/JavaScript/"/>
    
      <category term="é—­åŒ…" scheme="https://lz5z.com/tags/%E9%97%AD%E5%8C%85/"/>
    
  </entry>
  
  <entry>
    <title>åœ¨ Hexo ä¸­æ’å…¥éŸ³ä¹ä¸è§†é¢‘</title>
    <link href="https://lz5z.com/Music-Video/"/>
    <id>https://lz5z.com/Music-Video/</id>
    <published>2016-11-22T21:28:11.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h2>ç½‘æ˜“äº‘éŸ³ä¹iframe</h2><p>é¦–å…ˆæ‰“å¼€ç½‘æ˜“äº‘éŸ³ä¹é¦–é¡µæ‰¾åˆ°ä½ æƒ³è¦çš„éŸ³è¯ï¼Œç‚¹å‡» ã€Œç”Ÿæˆå¤–é“¾æ’­æ”¾å™¨ã€</p><img src="/assets/img/hexo_music.png" alt="æˆ‘æ˜¯ä¸€åªçš„å›¾ç‰‡"><p>é€‰æ‹©åˆé€‚çš„å°ºå¯¸åå°†ç”Ÿæˆçš„ iframe æ’ä»¶æˆ–è€… flash æ’ä»¶ä»£ç å¤åˆ¶åˆ° markdown ä¸­å³å¯ã€‚</p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=26085700&auto=0&height=66"></iframe><a id="more"></a><h2>è…¾è®¯è§†é¢‘</h2><iframe frameborder="0" width="640" height="498" src="https://v.qq.com/iframe/player.html?vid=f0022xw9le3&tiny=0&auto=0" allowfullscreen></iframe><h2>ä¼˜é…·è§†é¢‘</h2><p>ä¼˜é…·æš‚æ—¶æ²¡æœ‰ httpsï¼Œè¿™ä¸ªæ¯”è¾ƒè®¨åŒã€‚</p><h2>Bç«™</h2><p>B ç«™çš„è§†é¢‘ï¼Œæ‰¾åˆ°æƒ³è¦åˆ†äº«çš„è§†é¢‘ï¼Œç‚¹å‡»ä¸‹æ–¹çš„åˆ†äº«å³å¯ã€‚</p><p><embed height="415" width="544" quality="high" allowfullscreen="true" type="application/x-shockwave-flash" src="//static.hdslb.com/miniloader.swf" flashvars="aid=18827465&page=1" pluginspage="//www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash"></p>]]></content>
    
    <summary type="html">
    
      &lt;h2&gt;ç½‘æ˜“äº‘éŸ³ä¹iframe&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆæ‰“å¼€ç½‘æ˜“äº‘éŸ³ä¹é¦–é¡µæ‰¾åˆ°ä½ æƒ³è¦çš„éŸ³è¯ï¼Œç‚¹å‡» ã€Œç”Ÿæˆå¤–é“¾æ’­æ”¾å™¨ã€&lt;/p&gt;
&lt;img src=&quot;/assets/img/hexo_music.png&quot; alt=&quot;æˆ‘æ˜¯ä¸€åªçš„å›¾ç‰‡&quot;&gt;
&lt;p&gt;é€‰æ‹©åˆé€‚çš„å°ºå¯¸åå°†ç”Ÿæˆçš„ iframe æ’ä»¶æˆ–è€… flash æ’ä»¶ä»£ç å¤åˆ¶åˆ° markdown ä¸­å³å¯ã€‚&lt;/p&gt;
&lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=&quot;330&quot; height=&quot;86&quot; src=&quot;//music.163.com/outchain/player?type=2&amp;id=26085700&amp;auto=0&amp;height=66&quot;&gt;&lt;/iframe&gt;
    
    </summary>
    
      <category term="Blog" scheme="https://lz5z.com/categories/Blog/"/>
    
    
      <category term="Hexo" scheme="https://lz5z.com/tags/Hexo/"/>
    
      <category term="Music" scheme="https://lz5z.com/tags/Music/"/>
    
      <category term="Video" scheme="https://lz5z.com/tags/Video/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨ Object.defineProperty ä¸ºå¯¹è±¡å®šä¹‰å±æ€§</title>
    <link href="https://lz5z.com/Object.defineProperty%E4%B8%BA%E5%AF%B9%E8%B1%A1%E5%AE%9A%E4%B9%89%E5%B1%9E%E6%80%A7/"/>
    <id>https://lz5z.com/Object.definePropertyä¸ºå¯¹è±¡å®šä¹‰å±æ€§/</id>
    <published>2016-11-21T22:38:27.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h1>å…ˆè¯´å¥é¢˜å¤–è¯</h1><p>ç›®å‰å‰ç«¯å¼€å‘ä¸­æ¯”è¾ƒæµè¡Œçš„ä¸¤ä¸ªæ¡†æ¶ï¼š <a href="https://angularjs.org/" target="_blank" rel="noopener">Angular</a> å’Œ <a href="https://cn.vuejs.org/" target="_blank" rel="noopener">Vue</a> éƒ½é‡‡ç”¨äº†æ•°æ®åŒå‘ç»‘å®šçš„æŠ€æœ¯ã€‚<br>Angular1 ä¸­æ•°æ®åŒå‘ç»‘å®šæ˜¯é€šè¿‡ã€Œè„æ£€æµ‹ã€çš„æ–¹å¼å®ç°ï¼Œæ¯å½“æ•°æ®å‘ç”Ÿå˜æ›´ï¼Œå¯¹æ‰€æœ‰çš„æ•°æ®å’Œè§†å›¾çš„ç»‘å®šå…³ç³»è¿›è¡Œä¸€æ¬¡æ£€æµ‹ï¼Œè¯†åˆ«æ˜¯å¦æœ‰æ•°æ®å‘ç”Ÿäº†å˜åŒ–ä»¥åŠè¿™ä¸ªå˜åŒ–æ˜¯å¦ä¼šå½±å“å…¶å®ƒæ•°æ®çš„å˜åŒ–ï¼Œç„¶åå°†å˜æ›´çš„æ•°æ®å‘é€åˆ°è§†å›¾ï¼Œæ›´æ–°é¡µé¢å±•ç¤ºã€‚</p><p>Vue æ•°æ®åŒå‘ç»‘å®šçš„åŸç†ä¸Angularæœ‰æ‰€ä¸åŒï¼Œç½‘ä¸Šäººç§°ã€Œæ•°æ®åŠ«æŒã€<img src="/assets/img/scary.gif" alt="scary" width="5%">ã€‚Vueä½¿ç”¨çš„æ˜¯ ES5 æä¾›çš„ Object.defineProperty() ç»“åˆå‘å¸ƒè€…-è®¢é˜…è€…æ¨¡å¼ï¼Œé€šè¿‡Object.defineProperty() æ¥åŠ«æŒå„ä¸ªå±æ€§çš„setterï¼Œgetterï¼Œåœ¨æ•°æ®å˜åŠ¨æ—¶å‘å¸ƒæ¶ˆæ¯ç»™è®¢é˜…è€…ï¼Œè§¦å‘ç›¸åº”çš„ç›‘å¬å›è°ƒã€‚</p><a id="more"></a><h1>Object.defineProperty()</h1><h2>å®šä¹‰ä»¥åŠä½¿ç”¨</h2><p>Object.defineProperty() æ–¹æ³•ä¼šç›´æ¥åœ¨ä¸€ä¸ªå¯¹è±¡ä¸Šå®šä¹‰ä¸€ä¸ªæ–°å±æ€§ï¼Œæˆ–è€…ä¿®æ”¹ä¸€ä¸ªå·²ç»å­˜åœ¨çš„å±æ€§ï¼Œ å¹¶è¿”å›è¿™ä¸ªå¯¹è±¡ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹ä¸‹ä¸€èˆ¬ä½¿ç”¨æ–¹æ³•ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> Leo = <span class="built_in">Object</span>.defineProperty(&#123;&#125;, <span class="string">'name'</span>, &#123;</span><br><span class="line">    value: <span class="string">'Leo'</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(Leo.name); <span class="comment">//Leo</span></span><br></pre></td></tr></table></figure><p>å…¶åŸºæœ¬è¯­æ³•è§„åˆ™å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.defineProperty(obj, prop, descriptor)</span><br></pre></td></tr></table></figure><ol><li>obj: éœ€è¦å®šä¹‰å±æ€§çš„å¯¹è±¡ã€‚</li><li>prop: éœ€å®šä¹‰æˆ–ä¿®æ”¹çš„å±æ€§çš„åå­—ã€‚</li><li>descriptor: å°†è¢«å®šä¹‰æˆ–ä¿®æ”¹çš„å±æ€§çš„æè¿°ç¬¦ã€‚</li><li>è¿”å›å€¼: è¿”å›ä¼ å…¥å‡½æ•°çš„å¯¹è±¡ï¼Œå³ç¬¬ä¸€ä¸ªå‚æ•°obj</li></ol><p>æ‰€ä»¥ <strong>Object.defineProperty(obj, â€˜nameâ€™, { value: â€˜Leoâ€™})</strong> ç›¸å½“äº <strong><a href="http://obj.name" target="_blank" rel="noopener">obj.name</a> = â€˜Leoâ€™</strong> æˆ–è€… **obj[â€˜nameâ€™] = â€˜Leoâ€™**å–½ã€‚</p><p>é‚£æˆ‘ä»¬ç›´æ¥ä½¿ç”¨ã€Œå¯¹è±¡.å±æ€§ã€å°±å¥½äº†ï¼Œä¸ºä»€ä¹ˆè¦ç”¨ Object.defineProperty è¿™ä¹ˆå¤æ‚çš„æ–¹æ³•å‘¢ï¼Ÿ</p><h2>Object.defineProperty è§£å†³ä»€ä¹ˆé—®é¢˜</h2><p>å¦‚æœä½ æƒ³å®šä¹‰ä¸€ä¸ªå¯¹è±¡çš„å±æ€§ä¸ºåªè¯»æ€ä¹ˆåŠï¼Ÿ<br>ã€Œå¯¹è±¡.å±æ€§ã€èƒ½åšåˆ°å—ï¼Ÿæ˜¾ç„¶ä¸èƒ½ï¼Object.defineProperty å´å¯ä»¥åšåˆ°ã€‚å› æ­¤ <strong>Object.defineProperty æ–¹æ³•æ˜¯å¯¹å±æ€§æ›´åŠ ç²¾ç¡®çš„å®šä¹‰</strong>ã€‚</p><h3>å±æ€§çš„çŠ¶æ€è®¾ç½®</h3><p>æˆ‘ä»¬å¯ä»¥åœ¨descriptorå‚æ•°ä¸­è®¾ç½®å¦‚ä¸‹å€¼ï¼Œæ¥å®ç°å¯¹å±æ€§çš„æ§åˆ¶ï¼š</p><ul><li>valueï¼šé»˜è®¤ä¸º undefinedã€‚è¯¥å±æ€§çš„å€¼ã€‚</li><li>writableï¼šé»˜è®¤ä¸º falseã€‚è¯¥å±æ€§æ˜¯å¦å¯å†™ï¼Œå¦‚æœè®¾ç½®æˆ falseï¼Œåˆ™ä»»ä½•å¯¹è¯¥å±æ€§æ”¹å†™çš„æ“ä½œéƒ½æ— æ•ˆï¼ˆ<a href="https://lz5z.com/JavaScript%E4%B8%A5%E6%A0%BC%E6%A8%A1%E5%BC%8F/">ä¸¥æ ¼æ¨¡å¼</a>ä¼šæŠ¥é”™ï¼Œæ­£å¸¸æ¨¡å¼åˆ™ä»€ä¹ˆéƒ½ä¸åšï¼‰</li><li>configurableï¼šé»˜è®¤ä¸º falseã€‚å½“ä¸”ä»…å½“è¯¥å±æ€§çš„ configurable ä¸º true æ—¶ï¼Œè¯¥å±æ€§æè¿°ç¬¦æ‰èƒ½å¤Ÿè¢«æ”¹å˜ï¼Œä¹Ÿèƒ½å¤Ÿè¢«åˆ é™¤ã€‚</li><li>enumerableï¼šé»˜è®¤ä¸º falseã€‚å½“ä¸”ä»…å½“è¯¥å±æ€§çš„ enumerable ä¸º true æ—¶ï¼Œè¯¥å±æ€§æ‰èƒ½å¤Ÿå‡ºç°åœ¨å¯¹è±¡çš„æšä¸¾å±æ€§ä¸­ï¼ˆforâ€¦in æˆ–è€… Object.keysï¼‰</li><li>get: é»˜è®¤ä¸º undefinedã€‚ä¸€ä¸ªç»™å±æ€§æä¾› getter çš„æ–¹æ³•ã€‚è¯¥æ–¹æ³•è¿”å›å€¼è¢«ç”¨ä½œå±æ€§å€¼ã€‚</li><li>set: é»˜è®¤ä¸º undefinedã€‚ä¸€ä¸ªç»™å±æ€§æä¾› setter çš„æ–¹æ³•ã€‚è¯¥æ–¹æ³•å°†æ¥å—å”¯ä¸€å‚æ•°ï¼Œå¹¶å°†è¯¥å‚æ•°çš„æ–°å€¼åˆ†é…ç»™è¯¥å±æ€§ã€‚</li></ul><h3>valueã€writable</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> Leo = <span class="built_in">Object</span>.defineProperty(&#123;&#125;, <span class="string">'name'</span>, &#123;</span><br><span class="line">    writable: <span class="literal">true</span>, <span class="comment">//writable ä¸ºtrueçš„æ—¶å€™nameå±æ€§æ‰å¯ä»¥è¢«æ›´æ”¹</span></span><br><span class="line">    value: <span class="string">'Leo'</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">Leo.name = <span class="string">'Jack'</span>; <span class="comment">//strict modeä¸‹ä¿®æ”¹writableä¸ºfalseçš„å±æ€§ä¼šæŠ¥é”™</span></span><br><span class="line"><span class="built_in">console</span>.log(Leo.name);</span><br></pre></td></tr></table></figure><h3>configurable</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> Leo = <span class="built_in">Object</span>.defineProperty(&#123;&#125;, <span class="string">'name'</span>, &#123;</span><br><span class="line">    configurable: <span class="literal">true</span>,</span><br><span class="line">    value: <span class="string">'Leo'</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> Leo.name; <span class="comment">//configurableä¸ºfalseçš„æ—¶å€™åˆ é™¤å±æ€§ä¼šæŠ¥é”™</span></span><br></pre></td></tr></table></figure><p>configurable å‚æ•°ä¸ä»…è´Ÿè´£å±æ€§çš„åˆ é™¤ï¼Œä¹Ÿä¸å±æ€§ä¿®æ”¹æœ‰å…³ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> Leo = <span class="built_in">Object</span>.defineProperty(&#123;&#125;, <span class="string">'name'</span>, &#123;</span><br><span class="line">    configurable: <span class="literal">false</span>,</span><br><span class="line">    value: <span class="string">'Leo'</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(Leo, <span class="string">'name'</span>, &#123;</span><br><span class="line">    configurable: <span class="literal">true</span>, <span class="comment">// Cannot redefine property: name</span></span><br><span class="line">    value: <span class="string">'Jack'</span>, <span class="comment">//Cannot redefine property: name</span></span><br><span class="line">    writable: <span class="literal">true</span>, <span class="comment">//Cannot redefine property: name</span></span><br><span class="line">    enumerable: <span class="literal">true</span> <span class="comment">//Cannot redefine property: name</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>å‡å¦‚ä¸€ä¸ªå±æ€§è¢«å®šä¹‰æˆ configurable ä¸º falseï¼Œåˆ™è¿™ä¸ªå±æ€§æ—¢ä¸èƒ½ä¿®æ”¹å€¼ï¼ˆvalueï¼‰ï¼Œåˆä¸èƒ½ä¿®æ”¹å±æ€§çš„å±æ€§ï¼ˆconfigurableï¼Œwritableï¼Œenumerableï¼‰ï¼›å¦‚æœ configurable ä¸º true å°±å¯ä»¥æ”¾å¿ƒä¿®æ”¹äº†ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> Leo = <span class="built_in">Object</span>.defineProperty(&#123;&#125;, <span class="string">'name'</span>, &#123;</span><br><span class="line">    configurable: <span class="literal">true</span>,</span><br><span class="line">    value: <span class="string">'Leo'</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(Leo, <span class="string">'name'</span>, &#123;</span><br><span class="line">    configurable: <span class="literal">true</span>,</span><br><span class="line">    value: <span class="string">'Jack'</span>,</span><br><span class="line">    writable: <span class="literal">true</span>,</span><br><span class="line">    enumerable: <span class="literal">true</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3>enumerable</h3><p>å±æ€§ç‰¹æ€§ enumerable å®šä¹‰äº†å¯¹è±¡çš„å±æ€§æ˜¯å¦å¯ä»¥åœ¨ forâ€¦in å¾ªç¯å’Œ Object.keys() ä¸­è¢«æšä¸¾ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> o = <span class="built_in">Object</span>.defineProperty(&#123;&#125;, <span class="string">"a"</span>, &#123;<span class="attr">value</span>: <span class="number">1</span>, <span class="attr">enumerable</span>: <span class="literal">true</span>&#125;);</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(o, <span class="string">"b"</span>, &#123;<span class="attr">value</span>: <span class="number">2</span>, <span class="attr">enumerable</span>: <span class="literal">false</span>&#125;);</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(o, <span class="string">"c"</span>, &#123;<span class="attr">value</span>: <span class="number">3</span>&#125;); <span class="comment">// enumerable defaults to false</span></span><br><span class="line">o.d = <span class="number">4</span>; <span class="comment">// å¦‚æœä½¿ç”¨ç›´æ¥èµ‹å€¼çš„æ–¹å¼åˆ›å»ºå¯¹è±¡çš„å±æ€§ï¼Œåˆ™è¿™ä¸ªå±æ€§çš„enumerableä¸ºtrue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">in</span> o) &#123;    </span><br><span class="line">  <span class="built_in">console</span>.log(i); <span class="comment">// "a" "d" </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.keys(o); <span class="comment">// ["a", "d"]</span></span><br><span class="line"></span><br><span class="line">o.propertyIsEnumerable(<span class="string">'a'</span>); <span class="comment">// true</span></span><br><span class="line">o.propertyIsEnumerable(<span class="string">'b'</span>); <span class="comment">// false</span></span><br><span class="line">o.propertyIsEnumerable(<span class="string">'c'</span>); <span class="comment">// false</span></span><br></pre></td></tr></table></figure><h3>getã€set</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> name = <span class="string">'Leo'</span>;</span><br><span class="line"><span class="keyword">let</span> Leo = <span class="built_in">Object</span>.defineProperty(&#123;&#125;, <span class="string">'name'</span>, &#123;</span><br><span class="line">    <span class="keyword">get</span>: function() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'get'</span>);</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">set</span>: function(newName) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'set'</span>);</span><br><span class="line">        name = newName;</span><br><span class="line">    &#125;,</span><br><span class="line">    enumerable: <span class="literal">true</span>,</span><br><span class="line">    configurable: <span class="literal">true</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">Leo.name = <span class="string">'Jack'</span>; <span class="comment">// 'set'</span></span><br><span class="line"><span class="built_in">console</span>.log(Leo.name); <span class="comment">// 'get' 'Jack'</span></span><br></pre></td></tr></table></figure><p>åœ¨å¯¹Leo.nameè¿›è¡Œèµ‹å€¼çš„æ—¶å€™ï¼Œå…¶å®æ˜¯è°ƒç”¨äº†nameçš„setæ–¹æ³•ï¼›è€Œä½¿ç”¨Leo.nameçš„æ—¶å€™åˆ™è°ƒç”¨äº†getæ–¹æ³•ã€‚è¿™å°±æ˜¯Vueæ•°æ®åŒå‘ç»‘å®šçš„åŸç†ï¼šæ¯å½“æ•°æ®å‘ç”Ÿæ”¹å˜ï¼Œå…¶å®æ˜¯è°ƒç”¨äº†setæ–¹æ³•ï¼Œsetæ–¹æ³•é‡Œé¢å‘å¸ƒæ•°æ®å˜åŠ¨çš„æ¶ˆæ¯ç»™è®¢é˜…è€…ï¼Œè§¦å‘ç›¸åº”çš„ç›‘å¬å›è°ƒã€‚</p><p>æ³¨æ„ï¼š å¦‚æœ get æ–¹æ³•ä¸ value åŒæ—¶å‡ºç°ï¼Œä¼šæŠ¥é”™ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> name = <span class="string">'Leo'</span>;</span><br><span class="line"><span class="keyword">let</span> Leo = <span class="built_in">Object</span>.defineProperty(&#123;&#125;, <span class="string">'name'</span>, &#123;</span><br><span class="line">    value: name, <span class="comment">// A property cannot both have accessors and be writable or have a value</span></span><br><span class="line">    <span class="keyword">get</span>: function() &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1>ç›¸å…³çš„æ–¹æ³•</h1><h2>Object.getOwnPropertyDescriptor(obj, prop)</h2><p>Object.getOwnPropertyDescriptor() è¿”å›æŒ‡å®šå¯¹è±¡ä¸Šä¸€ä¸ªè‡ªæœ‰å±æ€§å¯¹åº”çš„å±æ€§æè¿°ç¬¦ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> Leo = <span class="built_in">Object</span>.defineProperty(&#123;&#125;, <span class="string">'name'</span>, &#123;</span><br><span class="line">    value: <span class="string">'Leo'</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.getOwnPropertyDescriptor(Leo, <span class="string">'name'</span>)); </span><br><span class="line"><span class="comment">//&#123; value: 'Leo',</span></span><br><span class="line"><span class="comment">//  writable: false,</span></span><br><span class="line"><span class="comment">//  enumerable: false,</span></span><br><span class="line"><span class="comment">//  configurable: false &#125;</span></span><br></pre></td></tr></table></figure><h2>Object.defineProperties(object, descriptors)</h2><p>Object.defineProperties ä¸ Object.defineProperty ä½œç”¨ç›¸åŒï¼Œä¸è¿‡å¯ä»¥åŒæ—¶å°†å¤šä¸ªå±æ€§æ·»åŠ /ä¿®æ”¹åˆ°å¯¹è±¡ã€‚</p><h2>Object.freeze(obj)</h2><p>Object.freeze() æ–¹æ³•å¯ä»¥å†»ç»“ä¸€ä¸ªå¯¹è±¡ï¼Œå†»ç»“æŒ‡çš„æ˜¯ä¸èƒ½å‘è¿™ä¸ªå¯¹è±¡æ·»åŠ æ–°çš„å±æ€§ï¼Œä¸èƒ½ä¿®æ”¹å…¶å·²æœ‰å±æ€§çš„å€¼ï¼Œä¸èƒ½åˆ é™¤å·²æœ‰å±æ€§ï¼Œä»¥åŠä¸èƒ½ä¿®æ”¹è¯¥å¯¹è±¡å·²æœ‰å±æ€§çš„å¯æšä¸¾æ€§ã€å¯é…ç½®æ€§ã€å¯å†™æ€§ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªå¯¹è±¡æ°¸è¿œæ˜¯ä¸å¯å˜çš„ã€‚è¯¥æ–¹æ³•è¿”å›è¢«å†»ç»“çš„å¯¹è±¡ã€‚</p><h1>æœ€å</h1><p>äº†è§£äº† Object.defineProperty çš„ç”¨æ³•ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å†™ä¸€ä¸ªè‡ªå·±çš„ Vue.js äº†ã€‚æ•¬è¯·æœŸå¾…ã€‚<img src="/assets/img/smiling.png" alt="smiling"></p>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;å…ˆè¯´å¥é¢˜å¤–è¯&lt;/h1&gt;
&lt;p&gt;ç›®å‰å‰ç«¯å¼€å‘ä¸­æ¯”è¾ƒæµè¡Œçš„ä¸¤ä¸ªæ¡†æ¶ï¼š &lt;a href=&quot;https://angularjs.org/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Angular&lt;/a&gt; å’Œ &lt;a href=&quot;https://cn.vuejs.org/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Vue&lt;/a&gt; éƒ½é‡‡ç”¨äº†æ•°æ®åŒå‘ç»‘å®šçš„æŠ€æœ¯ã€‚&lt;br&gt;
Angular1 ä¸­æ•°æ®åŒå‘ç»‘å®šæ˜¯é€šè¿‡ã€Œè„æ£€æµ‹ã€çš„æ–¹å¼å®ç°ï¼Œæ¯å½“æ•°æ®å‘ç”Ÿå˜æ›´ï¼Œå¯¹æ‰€æœ‰çš„æ•°æ®å’Œè§†å›¾çš„ç»‘å®šå…³ç³»è¿›è¡Œä¸€æ¬¡æ£€æµ‹ï¼Œè¯†åˆ«æ˜¯å¦æœ‰æ•°æ®å‘ç”Ÿäº†å˜åŒ–ä»¥åŠè¿™ä¸ªå˜åŒ–æ˜¯å¦ä¼šå½±å“å…¶å®ƒæ•°æ®çš„å˜åŒ–ï¼Œç„¶åå°†å˜æ›´çš„æ•°æ®å‘é€åˆ°è§†å›¾ï¼Œæ›´æ–°é¡µé¢å±•ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;Vue æ•°æ®åŒå‘ç»‘å®šçš„åŸç†ä¸Angularæœ‰æ‰€ä¸åŒï¼Œç½‘ä¸Šäººç§°ã€Œæ•°æ®åŠ«æŒã€&lt;img src=&quot;/assets/img/scary.gif&quot; alt=&quot;scary&quot; width=&quot;5%&quot;&gt;ã€‚Vueä½¿ç”¨çš„æ˜¯ ES5 æä¾›çš„ Object.defineProperty() ç»“åˆå‘å¸ƒè€…-è®¢é˜…è€…æ¨¡å¼ï¼Œé€šè¿‡Object.defineProperty() æ¥åŠ«æŒå„ä¸ªå±æ€§çš„setterï¼Œgetterï¼Œåœ¨æ•°æ®å˜åŠ¨æ—¶å‘å¸ƒæ¶ˆæ¯ç»™è®¢é˜…è€…ï¼Œè§¦å‘ç›¸åº”çš„ç›‘å¬å›è°ƒã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="https://lz5z.com/tags/JavaScript/"/>
    
      <category term="Object" scheme="https://lz5z.com/tags/Object/"/>
    
      <category term="defineProperty" scheme="https://lz5z.com/tags/defineProperty/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨ Travis CI è‡ªåŠ¨éƒ¨ç½² Hexo</title>
    <link href="https://lz5z.com/%E4%BD%BF%E7%94%A8TravisCI%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2Hexo/"/>
    <id>https://lz5z.com/ä½¿ç”¨TravisCIè‡ªåŠ¨éƒ¨ç½²Hexo/</id>
    <published>2016-11-18T10:00:36.000Z</published>
    <updated>2020-04-21T10:23:54.831Z</updated>
    
    <content type="html"><![CDATA[<h1>Travis CI</h1><p><a href="https://travis-ci.org/" target="_blank" rel="noopener">Travis CI</a> æ˜¯ä¸€ä¸ªæŒç»­é›†æˆçš„å¹³å°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶è‡ªåŠ¨æ„å»ºéƒ¨ç½²çš„åŠŸèƒ½å¸®æˆ‘ä»¬ç®€åŒ– Hexo åšå®¢çš„éƒ¨ç½²æµç¨‹ã€‚</p><h2>ä¸ºä»€ä¹ˆè¦ç”¨ Travis CI</h2><p>å› ä¸ºæ‡’ã€‚ <img src="/assets/img/what_can_i_say.jpg" alt="what_can_i_say"></p><p>Hexo éƒ¨ç½² Blog åˆ° GitPage é€šå¸¸éœ€è¦ä¸‰éƒ¨æ›²ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> hexo clean</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> hexo g</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> hexo deploy</span></span><br></pre></td></tr></table></figure><a id="more"></a><p>å¾ˆç®€å•å§ï¼Œä½†æ˜¯å¦‚æœæ˜¯ä¸€ä¸ªæ–°çš„ç¯å¢ƒï¼Œä½ éœ€è¦å®‰è£…ä¸€å¤§å †å·¥å…·å’Œä¾èµ–ï¼Œæ¯”å¦‚è¦è£… Nodeï¼Œè¦è£… Hexoï¼Œè¿˜æœ‰ package.json é‡Œé¢çš„å„ç§ä¾èµ–ï¼Œè™½ç„¶ Npm æä¾›äº†å¼ºå¤§çš„åŒ…ç®¡ç†åŠŸèƒ½ï¼Œä½†æ˜¯æœ‰æ—¶å€™å°±æ˜¯ä¸æ–¹ä¾¿ã€‚</p><p>ä½¿ç”¨ Travisï¼Œä½ åªéœ€è¦æœ¬åœ°æœ‰ä¸€ä¸ª git å°±å¯ä»¥äº†ã€‚</p><p>æ¯å½“ä½  Push ä¸€ä¸ª commit åˆ° Github æ—¶ï¼ŒTravis CI ä¼šæ£€æµ‹åˆ°ä½ çš„æäº¤ï¼Œå¹¶æ ¹æ®é…ç½®æ–‡ä»¶è‡ªåŠ¨è¿è¡Œä¸€äº›å‘½ä»¤ï¼Œé€šå¸¸è¿™äº›å‘½ä»¤ç”¨äºæµ‹è¯•ï¼Œæ„å»ºç­‰ç­‰ã€‚</p><p>é‚£ä¹ˆåœ¨æˆ‘ä»¬çš„éœ€æ±‚ä¸‹ï¼Œå°±å¯ä»¥ç”¨å®ƒè¿è¡Œä¸€äº› hexo deploy -g ä¹‹ç±»çš„å‘½ä»¤ç”¨æ¥è‡ªåŠ¨ç”Ÿæˆã€éƒ¨ç½²æˆ‘ä»¬çš„ç½‘ç«™ã€‚</p><h1>ä½¿ç”¨æ–¹æ³•</h1><p>ä½¿ç”¨ Travis æ„å»º Hexo åªéœ€è¦ä¸‰æ­¥ï¼š</p><ol><li>ç™»å½• Travisï¼Œé…ç½®ä»“åº“</li><li>åœ¨ Travis CI é…ç½® GitHub çš„ Access Token</li><li>Blog æ ¹ç›®å½•ä¸‹é…ç½® .travis.yml</li></ol><h2>é…ç½® Travis ä»“åº“</h2><p>é¦–å…ˆä½¿ç”¨ GitHub è´¦å·ç™»å½•<a href="https://travis-ci.org/" target="_blank" rel="noopener">Travis CI</a>ï¼Œç™»å½•åä¼šè¿›å…¥å¦‚ä¸‹é¡µé¢</p><img src="/assets/img/Travis_main_page.png" alt="æˆ‘æ˜¯ä¸€åªçš„å›¾ç‰‡"><p>ç‚¹å‡»ã€ŒMy Repositoriesã€åé¢çš„ <strong>+</strong>ï¼Œæ·»åŠ è¦è‡ªåŠ¨æ„å»ºçš„ä»“åº“</p><img src="/assets/img/Travis.png" alt="æˆ‘æ˜¯ä¸€åªçš„å›¾ç‰‡"><p>è¿™é‡Œä¼šæ˜¾ç¤ºä½  GitHub ä¸‹æ‰€æœ‰çš„é¡¹ç›®ï¼Œé€‰ä¸­åšå®¢ä»“åº“ï¼Œæˆ‘çš„åšå®¢åœ¨GitHubä¸Šçš„ä»“åº“åå­—å°±å«åš <strong>Blog</strong>ã€‚ç„¶åç‚¹å‡»ä»“åº“åè¿›å…¥ä»“åº“é…ç½®é¡µé¢ã€‚</p><img src="/assets/img/Travis_settings.png" alt="æˆ‘æ˜¯ä¸€åªçš„å›¾ç‰‡"><p>é€‰æ‹© Settingsï¼Œé…ç½®é€‰æ‹©å¦‚ä¸‹ï¼š</p><img src="/assets/img/Travis_general_settings.png" alt="æˆ‘æ˜¯ä¸€åªçš„å›¾ç‰‡"><ul><li>Build only if .travis.yml is presentï¼šæ˜¯åªæœ‰åœ¨ .travis.yml æ–‡ä»¶ä¸­é…ç½®çš„åˆ†æ”¯æ”¹å˜äº†æ‰æ„å»º</li><li>Build pushesï¼šå½“æ¨é€å®Œè¿™ä¸ªåˆ†æ”¯åå¼€å§‹æ„å»º</li></ul><p>è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å·²ç»å¼€å¯è¦æ„å»ºçš„ä»“åº“ï¼Œä½†æ˜¯å¦‚ä½•å°†æ„å»ºå®Œæˆåçš„æ–‡ä»¶æ¨é€åˆ° Github ä¸Šå‘¢ï¼Ÿ</p><h2>GitHub Access Token</h2><p>Github æ”¯æŒä¸€ç§ç‰¹æ®Šçš„ URL æ¥æ‰§è¡Œ push/pull ç­‰ç­‰æ“ä½œï¼Œè€Œä¸éœ€è¦è¾“å…¥ç”¨æˆ·åå¯†ç ã€‚ä½†è¿™éœ€è¦äº‹å…ˆåœ¨ Github ä¸Šåˆ›å»ºä¸€ä¸ª tokenã€‚</p><p>é¦–å…ˆå» GitHub Settings é¡µé¢é€‰æ‹© <a href="https://github.com/settings/tokens" target="_blank" rel="noopener"><strong>Personal access tokens</strong></a>ï¼Œå¦‚æœä½ å·²ç»ç™»å½•äº†ï¼Œç‚¹å‡»é“¾æ¥è¿›å»å³å¯ã€‚</p><img src="/assets/img/Travis_generate_token.png" alt="æˆ‘æ˜¯ä¸€åªçš„å›¾ç‰‡"><p>é€‰æ‹© <strong>Generate new token</strong>ï¼Œé…ç½®å¦‚ä¸‹ï¼š</p><img src="/assets/img/Travis_token.png" alt="æˆ‘æ˜¯ä¸€åªçš„å›¾ç‰‡"><p>ç‚¹å‡»ç»¿è‰²ç¡®è®¤æŒ‰é’®ï¼Œcopy åˆšåˆšç”Ÿæˆçš„ tokenã€‚å›åˆ° Travis Settings é¡µé¢ï¼Œå°†å¤åˆ¶çš„ token åŠ å…¥åˆ°ç¯å¢ƒå˜é‡ï¼Œå¹¶å‘½åä¸º  <strong>GitHub_token</strong>ã€‚</p><img src="/assets/img/Travis_add_token.png" alt="æˆ‘æ˜¯ä¸€åªçš„å›¾ç‰‡"><h2>.travis.yml</h2><p>ä¸Šè¿°æ­¥éª¤å®Œæˆåï¼Œåªéœ€è¦åœ¨ä½  Blog æºä»£ç çš„æ ¹ç›®å½•ä¸‹å¢åŠ ä¸€ä¸ª <strong>.travis.yml</strong> æ–‡ä»¶ï¼Œ<br>æˆ‘çš„æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">language:</span> <span class="string">node_js</span></span><br><span class="line"><span class="attr">node_js:</span> <span class="string">stable</span></span><br><span class="line"></span><br><span class="line"><span class="attr">install:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">npm</span> <span class="string">install</span></span><br><span class="line"></span><br><span class="line"><span class="attr">script:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">hexo</span> <span class="string">clean</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">hexo</span> <span class="string">g</span></span><br><span class="line"></span><br><span class="line"><span class="attr">after_script:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">cd</span> <span class="string">./public</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">git</span> <span class="string">init</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">git</span> <span class="string">config</span> <span class="string">user.name</span> <span class="string">"YOUR GITHUB USER NAME"</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">git</span> <span class="string">config</span> <span class="string">user.email</span> <span class="string">"YOUR GITHUB EMAIL"</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">git</span> <span class="string">add</span> <span class="string">.</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">git</span> <span class="string">commit</span> <span class="string">-m</span> <span class="string">"Update"</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">git</span> <span class="string">push</span> <span class="string">--force</span> <span class="string">--quiet</span> <span class="string">"https://$&#123;GitHub_token&#125;@$&#123;GH_REF&#125;"</span> <span class="string">master:master</span></span><br><span class="line"></span><br><span class="line"><span class="attr">branches:</span></span><br><span class="line">  <span class="attr">only:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">master</span></span><br><span class="line"><span class="attr">env:</span></span><br><span class="line"> <span class="attr">global:</span></span><br><span class="line">   <span class="bullet">-</span> <span class="attr">GH_REF:</span> <span class="string">github.com/Leo555/Leo555.github.io.git</span></span><br></pre></td></tr></table></figure><p>å°†ä¸Šé¢çš„ name å’Œ email è¿˜æœ‰ GH_REF ä¿®æ”¹æˆä½ è‡ªå·±çš„ã€‚</p><p>è¿™é‡Œç”¨ Linux ç¯å¢ƒå˜é‡çš„å¼•ç”¨æ–¹å¼å°† GH_REF å’Œ GitHub_token å…¶å¼•å…¥ git push çš„ urlï¼Œå› æ­¤ push æ–¹æ³•å°±èƒ½é€šè¿‡ GitHub OAuth æˆæƒï¼Œå®Œæˆè‡ªåŠ¨ push çš„åŠŸèƒ½ã€‚</p><p>æ­¤æ—¶å°±ä¸‡äº‹ä¿±å¤‡äº†ã€‚</p><h1>æµ‹è¯•</h1><p>ä½¿ç”¨ Hexo åˆ›å»ºæ–°çš„ Blog æ–‡ä»¶ï¼Œç„¶å push åˆ° GitHub ä¸Šã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> hexo new test.md</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git add .</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git commit -m <span class="string">"add new post test"</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git push origin master</span></span><br></pre></td></tr></table></figure><p>ç„¶åå›åˆ° Travis ä¸»é¡µé¢ï¼Œå‘ç°éƒ¨ç½²å·²ç»å¼€å§‹äº†</p><img src="/assets/img/Travis_deploy.png" alt="æˆ‘æ˜¯ä¸€åªå›¾ç‰‡"><p>åœ¨ä¸‹é¢çš„ log ä¸­å¯ä»¥çœ‹åˆ°éƒ¨ç½²çš„è¯¦ç»†æƒ…å†µã€‚</p><p>åŒ…æ‹¬ <strong>nvm install</strong>ï¼Œ<strong>npm install</strong>ï¼Œ<strong>hexo g</strong> ç­‰å‘½ä»¤éƒ½åœ¨è¿™é‡Œæ‰§è¡Œã€‚</p><h1>æ€»ç»“</h1><p>æœ‰äº†è‡ªåŠ¨éƒ¨ç½²çš„åŠŸèƒ½ï¼Œä»æ­¤ä»¥åå°±å¯ä»¥å°†å…³æ³¨ç‚¹é›†ä¸­åœ¨åšå®¢å†…å®¹ä¸Šï¼Œæ¢äº†å¹³å°å’Œç¯å¢ƒä¹Ÿæ²¡æœ‰ä»»ä½•å½±å“ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;Travis CI&lt;/h1&gt;
&lt;p&gt;&lt;a href=&quot;https://travis-ci.org/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Travis CI&lt;/a&gt; æ˜¯ä¸€ä¸ªæŒç»­é›†æˆçš„å¹³å°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶è‡ªåŠ¨æ„å»ºéƒ¨ç½²çš„åŠŸèƒ½å¸®æˆ‘ä»¬ç®€åŒ– Hexo åšå®¢çš„éƒ¨ç½²æµç¨‹ã€‚&lt;/p&gt;
&lt;h2&gt;ä¸ºä»€ä¹ˆè¦ç”¨ Travis CI&lt;/h2&gt;
&lt;p&gt;å› ä¸ºæ‡’ã€‚ &lt;img src=&quot;/assets/img/what_can_i_say.jpg&quot; alt=&quot;what_can_i_say&quot;&gt;&lt;/p&gt;
&lt;p&gt;Hexo éƒ¨ç½² Blog åˆ° GitPage é€šå¸¸éœ€è¦ä¸‰éƒ¨æ›²ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; hexo clean&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; hexo g&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt; hexo deploy&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Blog" scheme="https://lz5z.com/categories/Blog/"/>
    
    
      <category term="Hexo" scheme="https://lz5z.com/tags/Hexo/"/>
    
      <category term="Travis" scheme="https://lz5z.com/tags/Travis/"/>
    
      <category term="æŒç»­é›†æˆ" scheme="https://lz5z.com/tags/%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90/"/>
    
  </entry>
  
  <entry>
    <title>Node.js ä¸­ child_procss æ¨¡å—</title>
    <link href="https://lz5z.com/Node.js%E4%B8%ADchild_procss%E6%A8%A1%E5%9D%97/"/>
    <id>https://lz5z.com/Node.jsä¸­child_procssæ¨¡å—/</id>
    <published>2016-11-16T20:53:46.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h1>ç®€ä»‹</h1><p>Node.js çš„å•çº¿ç¨‹æ¨¡å‹ç»™äº†å®ƒæ— æ•°çš„èµç¾ï¼Œä¹Ÿå¸¦ç»™å®ƒæ— æ•°çš„è¯Ÿç—…ã€‚å•çº¿ç¨‹æ¨¡å‹ï¼Œè®©å¼€å‘è€…è¿œç¦»äº†çº¿ç¨‹è°ƒåº¦çš„å¤æ‚æ€§ï¼Œä½¿ç”¨äº‹ä»¶é©±åŠ¨ä¹Ÿèƒ½å¼€å‘å‡ºä¸€ä¸ªé«˜å¹¶å‘çš„æœåŠ¡å™¨ï¼›åŒæ ·ä¹Ÿæ˜¯å› ä¸ºå•çº¿ç¨‹ï¼Œè®©CPUå¯†é›†å‹è®¡ç®—åº”ç”¨å®Œå…¨ä¸é€‚ç”¨ã€‚</p><p>Node.js ä¸­å†…å»ºäº†ä¸€ä¸ª <a href="https://nodejs.org/api/child_process.html" target="_blank" rel="noopener">child_process</a>æ¨¡å—ï¼Œå¯ä»¥åœ¨ç¨‹åºä¸­åˆ›å»ºå­è¿›ç¨‹ï¼Œä»è€Œå®ç°å¤šæ ¸å¹¶è¡Œè®¡ç®—ã€‚</p><a id="more"></a><h1><a href="https://nodejs.org/api/child_process.html" target="_blank" rel="noopener">child_process</a></h1><p>child_process æ˜¯ Node.js ä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„æ¨¡å—ï¼Œä¸»è¦åŠŸèƒ½æœ‰ï¼š</p><ol><li>åˆ›å»ºå­è¿›ç¨‹</li><li>ä¸»è¿›ç¨‹ä¸å­è¿›ç¨‹é€šä¿¡</li><li>ä¸»è¿›ç¨‹è¯»å–å­è¿›ç¨‹è¿”å›ç»“æœ</li></ol><p>ä½¿ç”¨ child_process æ¨¡å—åˆ›å»ºè¿›ç¨‹ä¸€å…±æœ‰å…­ç§æ–¹æ³•ï¼ˆNode.js v7.1.0ï¼‰</p><h3>å¼‚æ­¥åˆ›å»ºè¿›ç¨‹</h3><ol><li>child_process.<strong>exec</strong>(command[, options][, callback])</li><li>child_process.<strong>execFile</strong>(file[, args][, options][, callback])</li><li>child_process.<strong>fork</strong>(modulePath[, args][, options])</li><li>child_process.<strong>spawn</strong>(command[, args][, options])</li></ol><h3>åŒæ­¥åˆ›å»ºè¿›ç¨‹</h3><ol><li>child_process.<strong>execFileSync</strong>(file[, args][, options])</li><li>child_process.<strong>execSync</strong>(command[, options])</li><li>child_process.<strong>spawnSync</strong>(command[, args][, options])</li></ol><p>ä»¥å¼‚æ­¥å‡½æ•°ä¸­ spawn æ˜¯æœ€åŸºæœ¬çš„åˆ›å»ºå­è¿›ç¨‹çš„å‡½æ•°ï¼Œå…¶ä»–ä¸‰ä¸ªå¼‚æ­¥å‡½æ•°éƒ½æ˜¯å¯¹ spawn ä¸åŒç¨‹åº¦çš„å°è£…ã€‚spawn åªèƒ½è¿è¡ŒæŒ‡å®šçš„ç¨‹åºï¼Œå‚æ•°éœ€è¦åœ¨åˆ—è¡¨ä¸­ç»™å‡ºï¼Œè€Œ exec å¯ä»¥ç›´æ¥è¿è¡Œå¤æ‚çš„å‘½ä»¤ã€‚</p><h2>spawn()</h2><p>spawnä»å®šä¹‰æ¥çœ‹ï¼Œæœ‰3ä¸ªå‚æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">child_process.spawn(command[, args][, options])</span><br></pre></td></tr></table></figure><ol><li>command: æ‰§è¡Œçš„å‘½ä»¤</li><li>args: å‚æ•°åˆ—è¡¨ï¼Œå¯è¾“å…¥å¤šçš„å‚æ•°</li><li>options: ç¯å¢ƒå˜é‡å¯¹è±¡</li><li>return: è¿”å›ä¸€ä¸ªChildProcess ç±»çš„å®ä¾‹</li></ol><h3>options</h3><blockquote><ol><li>cwd [String] Current working directory of the child process</li></ol></blockquote><ol start="2"><li>env [Object] Environment key-value pairs</li><li>argv0 [String] Explicitly set the value of argv[0] sent to the child process. This will be set to command if not specified.</li><li>stdio [Array] | [String] Childâ€™s stdio configuration. (See options.stdio)</li><li>detached [Boolean] Prepare child to run independently of its parent process. Specific behavior depends on the platform, see options.detached)</li><li>uid [Number] Sets the user identity of the process. (See setuid(2).)</li><li>gid [Number] Sets the group identity of the process. (See setgid(2).)</li><li>shell [Boolean] | [String] If true, runs command inside of a shell. Uses â€˜/bin/shâ€™ on UNIX, and â€˜cmd.exeâ€™ on Windows. A different shell can be specified as a string. The shell should understand the -c switch on UNIX, or /d /s /c on Windows. Defaults to false (no shell).</li></ol><p>spawn æ–¹æ³•åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹æ¥æ‰§è¡Œç‰¹å®šå‘½ä»¤ï¼Œå®ƒæ²¡æœ‰å›è°ƒå‡½æ•°ï¼Œåªèƒ½é€šè¿‡ç›‘å¬äº‹ä»¶ï¼Œæ¥è·å–è¿è¡Œç»“æœã€‚å±äºå¼‚æ­¥æ‰§è¡Œï¼Œé€‚ç”¨äºå­è¿›ç¨‹é•¿æ—¶é—´è¿è¡Œçš„æƒ…å†µã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> child_process = <span class="built_in">require</span>(<span class="string">'child_process'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> path = <span class="string">'.'</span>;</span><br><span class="line"><span class="keyword">let</span> child = child_process.spawn(<span class="string">'ls'</span>, [<span class="string">'-l'</span>, path]);</span><br><span class="line">child.stdout.on(<span class="string">'data'</span>, (data) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'stdout: '</span> + data);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">child.stderr.on(<span class="string">'data'</span>, (data) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'stderr: '</span> + data);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">child.on(<span class="string">'close'</span>, (code) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'child process exited with code '</span> + code);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>spawn æ–¹æ³•é€šè¿‡ stream çš„æ–¹å¼å‘æ•°æ®ä¼ ç»™ä¸»è¿›ç¨‹ï¼Œä»è€Œå®ç°äº†å¤šè¿›ç¨‹ä¹‹é—´çš„æ•°æ®äº¤æ¢ã€‚</p><h2>exec()</h2><p>exec æ–¹æ³•çš„å®šä¹‰å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">child_process.exec(command[, options][, callback])</span><br></pre></td></tr></table></figure><p>exec æ–¹æ³•æ˜¯å¯¹ spawn æ–¹æ³•çš„å°è£…ï¼Œå¢åŠ äº† shell/bash å‘½ä»¤è§£æå’Œå›è°ƒå‡½æ•°ï¼Œæ›´åŠ ç¬¦åˆ JavaScript çš„å‡½æ•°è°ƒç”¨ä¹ æƒ¯ã€‚</p><p>commandå‚æ•°æ˜¯ä¸€ä¸ªå‘½ä»¤å­—ç¬¦ä¸²</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> exec = <span class="built_in">require</span>(<span class="string">'child_process'</span>).exec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> ls = exec(<span class="string">'ls -l'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">error, stdout, stderr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (error) &#123;</span><br><span class="line">    <span class="built_in">console</span>.error(error.stack);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Error code: '</span> + error.code);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'Child Process STDOUT: '</span> + stdout);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>exec æ–¹æ³•ç¬¬äºŒä¸ªå‚æ•°æ˜¯å›è°ƒå‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯å‘ç”Ÿçš„é”™è¯¯ã€æ ‡å‡†è¾“å‡ºçš„æ˜¾ç¤ºç»“æœã€æ ‡å‡†é”™è¯¯çš„æ˜¾ç¤ºç»“æœã€‚</p><p>ç”±äºæ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯éƒ½æ˜¯æµå¯¹è±¡ï¼ˆstreamï¼‰ï¼Œå¯ä»¥ç›‘å¬ data äº‹ä»¶ï¼Œå› æ­¤ä¸Šé¢çš„ä»£ç ä¹Ÿå¯ä»¥å†™æˆä¸‹é¢è¿™æ ·ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> exec = <span class="built_in">require</span>(<span class="string">'child_process'</span>).exec;</span><br><span class="line"><span class="keyword">let</span> child = exec(<span class="string">'ls -l'</span>);</span><br><span class="line"></span><br><span class="line">child.stdout.on(<span class="string">'data'</span>, (data) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'stdout: '</span> + data);</span><br><span class="line">&#125;);</span><br><span class="line">child.stderr.on(<span class="string">'data'</span>, (data) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'stdout: '</span> + data);</span><br><span class="line">&#125;);</span><br><span class="line">child.on(<span class="string">'close'</span>, (code) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'closing code: '</span> + code);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>exec æ–¹æ³•ä¼šç›´æ¥è°ƒç”¨ bashï¼ˆ/bin/shç¨‹åºï¼‰ æ¥è§£é‡Šå‘½ä»¤ï¼Œå¦‚æœç”¨æˆ·è¾“å…¥æ¶æ„ä»£ç ï¼Œå°†ä¼šå¸¦æ¥å®‰å…¨é£é™©ã€‚å› æ­¤ï¼Œåœ¨æœ‰ç”¨æˆ·è¾“å…¥çš„æƒ…å†µä¸‹ï¼Œæœ€å¥½ä¸ä½¿ç”¨ exec æ–¹æ³•ï¼Œè€Œæ˜¯ä½¿ç”¨ execFile æ–¹æ³•ã€‚</p><h2>execFile()</h2><p>execFileçš„å®šä¹‰å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">child_process.execFile(file[, args][, options][, callback])</span><br></pre></td></tr></table></figure><p>execFile å‘½ä»¤æœ‰å››ä¸ªå‚æ•°ï¼Œfile å’Œcallbakc ä¸ºå¿…ä¼ å‚æ•°ï¼Œoptionsã€args ä¸ºå¯é€‰å‚æ•°ï¼š</p><ul><li>file è¦æ‰§è¡Œç¨‹åºçš„æ–‡ä»¶æˆ–å‘½ä»¤åã€‚å­—ç¬¦ä¸²ç±»å‹</li><li>args è¦æ‰§è¡Œç¨‹åºæˆ–å‘½ä»¤çš„å‚æ•°åˆ—è¡¨ã€‚æ•°ç»„ç±»å‹</li><li>options å¯é€‰å‚æ•°å¯¹è±¡ï¼Œä¸execçš„optionså¯¹è±¡ç›¸åŒ</li><li>callback å­è¿›ç¨‹æ‰§è¡Œå®Œæ¯•çš„å›è°ƒå‡½æ•°ã€‚ä¸execçš„callbackå‡½æ•°ç›¸åŒ</li><li>è¿”å›å€¼: ChildProcess å¯¹è±¡</li></ul><p>execFile ä»å¯æ‰§è¡Œç¨‹åºå¯åŠ¨å­è¿›ç¨‹ã€‚ä¸ exec ç›¸æ¯”ï¼ŒexecFile ä¸å¯åŠ¨ç‹¬ç«‹çš„ bash/shellï¼Œå› æ­¤æ›´åŠ è½»é‡çº§ï¼Œä¹Ÿæ›´åŠ å®‰å…¨ã€‚ execFile ä¹Ÿå¯ä»¥ç”¨äºæ‰§è¡Œå‘½ä»¤ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> childProcess = <span class="built_in">require</span>(<span class="string">'child_process'</span>);</span><br><span class="line"><span class="keyword">let</span> path = <span class="string">"."</span>;</span><br><span class="line">childProcess.execFile(<span class="string">'ls'</span>, [<span class="string">'-l'</span>, path], (err, result) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        <span class="built_in">console</span>.error(err);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(result)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆï¼Œä»€ä¹ˆæ—¶å€™ä½¿ç”¨ execï¼Œä»€ä¹ˆæ—¶å€™ä½¿ç”¨ execFile å‘¢ï¼Ÿ</p><p>å¦‚æœå‘½ä»¤å‚æ•°æ˜¯ç”±ç”¨æˆ·æ¥è¾“å…¥çš„ï¼Œå¯¹äº exec å‡½æ•°æ¥è¯´æ˜¯æœ‰å®‰å…¨æ€§é£é™©çš„ï¼Œå› ä¸º Shell ä¼šè¿è¡Œå¤šè¡Œå‘½ä»¤ï¼Œæ¯”å¦‚ â€™ls -l .;pwdï¼Œå¦‚é€—å·åˆ†éš”ï¼Œä¹‹åçš„å‘½ä»¤ä¹Ÿä¼šè¢«ç³»ç»Ÿè¿è¡Œã€‚ä½†ä½¿ç”¨ exeFile å‘½ä»¤æ—¶ï¼Œå‘½ä»¤å’Œå‚æ•°åˆ†æ¥ï¼Œé˜²æ­¢äº†å‚æ•°æ³¨å…¥çš„å®‰å…¨é£é™©ã€‚</p><h2>fork()</h2><p>fork å‡½æ•°ï¼Œç”¨äºåœ¨å­è¿›ç¨‹ä¸­è¿è¡Œçš„æ¨¡å—ï¼Œå¦‚ fork(â€™./son.jsâ€™) ç›¸å½“äº spawn(â€˜nodeâ€™, [â€™./son.jsâ€™]) ã€‚ä¸ spawn æ–¹æ³•ä¸åŒçš„æ˜¯ï¼Œfork ä¼šåœ¨çˆ¶è¿›ç¨‹ä¸å­è¿›ç¨‹ä¹‹é—´ï¼Œå»ºç«‹ä¸€ä¸ªé€šä¿¡ç®¡é“ï¼Œç”¨äºè¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚</p><p>å‡è®¾æœ‰ä¸€ä¸ªä¸»è¿›ç¨‹æ–‡ä»¶ mian.js:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> childProcess = <span class="built_in">require</span>(<span class="string">'child_process'</span>);</span><br><span class="line"><span class="keyword">let</span> son = childProcess.fork(<span class="string">'./son.js'</span>);</span><br><span class="line"></span><br><span class="line">son.on(<span class="string">'message'</span>, (m) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Main Listen: '</span>, m);</span><br><span class="line">&#125;);</span><br><span class="line">son.send(&#123;</span><br><span class="line">    hello: <span class="string">'son'</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>æœ‰ä¸€ä¸ªå­è¿›ç¨‹æ–‡ä»¶ son.js:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">process.on(<span class="string">'message'</span>, (m) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Son Listen:'</span>, m);</span><br><span class="line">&#125;);</span><br><span class="line">process.send(&#123;</span><br><span class="line">    Hello: <span class="string">'main'</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¿è¡Œç¨‹åºï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ node test.js</span><br><span class="line">Son <span class="string">Listen:</span> &#123; <span class="string">hello:</span> <span class="string">'son'</span> &#125;</span><br><span class="line">Main <span class="string">Listen:</span>  &#123; <span class="string">Hello:</span> <span class="string">'main'</span> &#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡ main.js å¯åŠ¨å­è¿›ç¨‹ son.jsï¼Œé€šè¿‡ process åœ¨ä¸¤ä¸ªè¿›ç¨‹ä¹‹é—´ä¼ é€’æ•°æ®ã€‚</p><p>ä½¿ç”¨ child_process.fork() ç”Ÿæˆæ–°è¿›ç¨‹ä¹‹åï¼Œå°±å¯ä»¥ç”¨ son.send(message, [sendHandle]) å‘æ–°è¿›ç¨‹å‘é€æ¶ˆæ¯ï¼Œæ–°è¿›ç¨‹ä¸­é€šè¿‡ç›‘å¬messageäº‹ä»¶ï¼Œæ¥è·å–æ¶ˆæ¯ï¼Œè¿™å°±æ˜¯ä¸»çº¿ç¨‹ä¸å­çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡æ–¹å¼ã€‚</p><h2>Windows</h2><p>åœ¨Windowsä¸Šæ‰§è¡Œä¸€ä¸ª <strong>.bat</strong> æˆ–è€… <strong>.cmd</strong> æ–‡ä»¶çš„æ–¹å¼ç•¥æœ‰ä¸åŒã€‚</p><p>å‡å¦‚æœ‰ä¸€ä¸ªbatæ–‡ä»¶ my.bat</p><h3>spawn</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> spawn = <span class="built_in">require</span>(<span class="string">'child_process'</span>).spawn;</span><br><span class="line"><span class="keyword">const</span> bat = spawn(<span class="string">'cmd.exe'</span>, [<span class="string">'/c'</span>, <span class="string">'my.bat'</span>]);</span><br><span class="line"></span><br><span class="line">bat.stdout.on(<span class="string">'data'</span>, (data) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">bat.stderr.on(<span class="string">'data'</span>, (data) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">bat.on(<span class="string">'exit'</span>, (code) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`Child exited with code <span class="subst">$&#123;code&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3>exec</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> exec = <span class="built_in">require</span>(<span class="string">'child_process'</span>).exec;</span><br><span class="line">exec(<span class="string">'my.bat'</span>, (err, stdout, stderr) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.error(err);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(stdout);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>å¦‚æœæ–‡ä»¶åä¸­æœ‰ç©ºæ ¼ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> bat = spawn(<span class="string">'"my script.cmd"'</span>, [<span class="string">'a'</span>, <span class="string">'b'</span>], &#123; <span class="attr">shell</span>:<span class="literal">true</span> &#125;);</span><br><span class="line"><span class="comment">// or:</span></span><br><span class="line">exec(<span class="string">'"my script.cmd" a b'</span>, (err, stdout, stderr) =&gt; &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;ç®€ä»‹&lt;/h1&gt;
&lt;p&gt;Node.js çš„å•çº¿ç¨‹æ¨¡å‹ç»™äº†å®ƒæ— æ•°çš„èµç¾ï¼Œä¹Ÿå¸¦ç»™å®ƒæ— æ•°çš„è¯Ÿç—…ã€‚å•çº¿ç¨‹æ¨¡å‹ï¼Œè®©å¼€å‘è€…è¿œç¦»äº†çº¿ç¨‹è°ƒåº¦çš„å¤æ‚æ€§ï¼Œä½¿ç”¨äº‹ä»¶é©±åŠ¨ä¹Ÿèƒ½å¼€å‘å‡ºä¸€ä¸ªé«˜å¹¶å‘çš„æœåŠ¡å™¨ï¼›åŒæ ·ä¹Ÿæ˜¯å› ä¸ºå•çº¿ç¨‹ï¼Œè®©CPUå¯†é›†å‹è®¡ç®—åº”ç”¨å®Œå…¨ä¸é€‚ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;Node.js ä¸­å†…å»ºäº†ä¸€ä¸ª &lt;a href=&quot;https://nodejs.org/api/child_process.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;child_process&lt;/a&gt;æ¨¡å—ï¼Œå¯ä»¥åœ¨ç¨‹åºä¸­åˆ›å»ºå­è¿›ç¨‹ï¼Œä»è€Œå®ç°å¤šæ ¸å¹¶è¡Œè®¡ç®—ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="Node" scheme="https://lz5z.com/tags/Node/"/>
    
      <category term="è¿›ç¨‹" scheme="https://lz5z.com/tags/%E8%BF%9B%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>å¿«é€Ÿæ’åºæ€æƒ³è§£å†³æ°´æ¡¶é—®é¢˜</title>
    <link href="https://lz5z.com/QuickSortToKettle/"/>
    <id>https://lz5z.com/QuickSortToKettle/</id>
    <published>2016-11-16T09:41:44.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h1>æ°´æ¡¶é—®é¢˜</h1><img src="/assets/img/Bucket.png" alt="æˆ‘æ˜¯ä¸€åªçš„å›¾ç‰‡"><p>å‡è®¾ç»™ä½ nä¸ªçº¢è‰²çš„æ°´å£¶å’Œnä¸ªè“è‰²çš„æ°´å£¶ã€‚å®ƒä»¬çš„å½¢çŠ¶å’Œå°ºå¯¸éƒ½å„ä¸ç›¸åŒã€‚æ‰€æœ‰çš„çº¢è‰²æ°´å£¶ç››æ°´é‡éƒ½å„ä¸ç›¸åŒï¼Œè“è‰²æ°´å£¶ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ä½†å¯¹äºæ¯ä¸€ä¸ªçº¢è‰²æ°´å£¶æ¥è¯´ï¼Œéƒ½æœ‰ä¸€ä¸ªè“è‰²æ°´å£¶ç››æ°´é‡å’Œå…¶ç›¸åŒï¼›åä¹‹äº¦ç„¶ã€‚<br>ä½ çš„ä»»åŠ¡æ˜¯é…å¯¹å‡ºå…¨éƒ¨ç››æ°´é‡ç›¸åŒçš„çº¢è‰²æ°´å£¶å’Œè“è‰²æ°´å£¶ã€‚ä¸ºæ­¤ï¼Œå¯ä»¥æ‰§è¡Œçš„æ“ä½œä¸ºï¼ŒæŒ‘å‡ºä¸€å¯¹æ°´å£¶ï¼Œä¸€åªçº¢è‰²ä¸€åªè“è‰²ï¼Œå°†çº¢è‰²æ°´å£¶çŒæ»¡æ°´ï¼Œå°†çº¢è‰²æ°´å£¶çš„æ°´å€’å…¥è“è‰²æ°´å£¶ä¸­ï¼Œçœ‹å…¶æ˜¯å¦æ°å¥½çŒæ»¡æ¥åˆ¤æ–­ï¼Œè¿™ä¸ªçº¢è‰²æ°´å£¶çš„ç››æ°´é‡å¤§äºã€å°äºæˆ–ç­‰äºè“è‰²æ°´å£¶ã€‚å‡è®¾è¿™æ ·çš„æ¯”è¾ƒéœ€è¦èŠ±è´¹ä¸€ä¸ªå•ä½æ—¶é—´ã€‚<br>è¯·æ‰¾å‡ºä¸€ç§ç®—æ³•ï¼Œå®ƒèƒ½å¤Ÿç”¨æœ€å°‘çš„æ¯”è¾ƒæ¬¡æ•°æ¥ç¡®å®šæ‰€æœ‰æ°´å£¶çš„é…å¯¹ã€‚<br>æ³¨æ„:ä¸å¯ç›´æ¥æ¯”è¾ƒä¸¤ä¸ªçº¢è‰²æˆ–è€…ä¸¤ä¸ªè“è‰²æ°´å£¶ï¼Œä¸€æ¬¡æ¯”è¾ƒå¿…é¡»å–ä¸€åªçº¢è‰²ä¸€åªè“è‰²ã€‚</p><a id="more"></a><h1>è§£å†³æ–¹æ¡ˆ</h1><h2>å¿«é€Ÿæ’åºæ€æƒ³è§£</h2><p>1.é¦–å…ˆåœ¨é›†åˆä¸­é€‰å–ä¸€ä¸ªå…ƒç´ ä½œä¸º ã€ŒåŸºå‡†ã€ pivot<br>2.å°†é›†åˆä¸­æ‰€æœ‰å…ƒç´ ä¸ã€ŒåŸºå‡†ã€å…ƒç´ è¿›è¡Œå¯¹æ¯”ï¼Œæ‰€æœ‰å°äºã€ŒåŸºå‡†ã€çš„å…ƒç´ ï¼Œéƒ½ç§»åˆ°ã€ŒåŸºå‡†ã€çš„å·¦è¾¹ï¼›æ‰€æœ‰å¤§äºã€ŒåŸºå‡†ã€çš„å…ƒç´ ï¼Œéƒ½ç§»åˆ°ã€ŒåŸºå‡†ã€çš„å³è¾¹ã€‚<br>3.å¯¹ã€ŒåŸºå‡†ã€å…ƒç´ å·¦å³ä¸¤è¾¹çš„é›†åˆï¼Œåˆ†åˆ«è¿›è¡Œä¸Šè¿°ä¸¤æ­¥ï¼Œç›´åˆ°æ‰€æœ‰çš„å­é›†åªå‰©ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚</p><p>ä»£ç æè¿°ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> quickSort = <span class="function"><span class="params">arr</span>=&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (arr.length &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> arr;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> pivotIndex = <span class="built_in">Math</span>.floor(arr.length / <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">let</span> pivot = arr.splice(pivotIndex, <span class="number">1</span>)[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">let</span> left = [], right = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> ai <span class="keyword">of</span> arr) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ai &lt; pivot) &#123;</span><br><span class="line">            left.push(ai);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            right.push(ai);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> quickSort(left).concat([pivot], quickSort(right));</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2>æ°´å£¶é—®é¢˜</h2><p>1.ä¾æ¬¡ä»çº¢è‰²æ°´å£¶ä¸­é€‰å–ä¸€ä¸ªæ°´å£¶ä¸è“è‰²æ°´å£¶é›†åˆå¯¹æ¯”ï¼Œå¯¹æ¯”è¿‡ç¨‹å¦‚ä¸‹ï¼š<br>2.çº¢è‰²æ°´å£¶ä¸æ¯ä¸€ä¸ªè“è‰²æ°´å£¶å¯¹æ¯”ï¼Œç››æ°´é‡å¤§äºçº¢è‰²æ°´å£¶çš„è“æ°´å£¶æ”¾åœ¨å³è¾¹ï¼Œå°äºçš„æ”¾åœ¨å·¦è¾¹ï¼Œæ°´é‡ç›¸ç­‰çš„ä¸ºå½“å‰é›†åˆçš„ ã€ŒåŸºå‡†ã€ å…ƒç´ ã€‚<br>3.å¦‚æœå½“å‰é›†åˆä¸­å·²æœ‰ ã€ŒåŸºå‡†ã€ å…ƒç´ ï¼Œåˆ™æ‹¿çº¢è‰²æ°´å£¶ä¸ã€ŒåŸºå‡†ã€å…ƒç´ å¯¹æ¯”ï¼š çº¢è‰²æ°´å£¶å¤§äºåŸºå‡†å…ƒç´ ï¼Œåˆ™é€‰å–åŸºå‡†å…ƒç´ å³è¾¹çš„é›†åˆé‡å¤ç¬¬äºŒæ­¥; å¦‚æœçº¢è‰²æ°´å£¶å°äºåŸºå‡†å…ƒç´ ï¼Œåˆ™é€‰å–åŸºå‡†å…ƒç´ å·¦è¾¹è¾¹çš„é›†åˆé‡å¤ç¬¬äºŒæ­¥ã€‚</p><h3>ä¸¾ä¸ªæ —å­</h3><p>ç°åœ¨æœ‰çº¢è‰²æ°´å£¶å®¹é‡ä¸ºï¼š [3, 5, 1, 4, 8, 2, 6]<br>è“è‰²æ°´å£¶ï¼š [6, 2, 3, 1, 8, 5, 4]</p><p>ç¬¬ä¸€æ­¥ï¼Œé€‰å–çº¢è‰²æ°´å£¶ä¸­ç¬¬ä¸€ä¸ªæ°´å£¶ 3 è·Ÿè“è‰²æ°´å£¶ä¾æ¬¡å¯¹æ¯”ï¼Œå¤§äº 3 çš„æ”¾å³è¾¹ï¼Œå°äº 3 çš„æ”¾å·¦è¾¹ï¼Œç­‰äº 3 çš„æ°´å£¶ä¸ºå½“å‰é›†åˆçš„ ã€ŒåŸºå‡†ã€ å…ƒç´ ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">2</span>, <span class="number">1</span>, â‘¢, <span class="number">6</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">4</span>]</span><br></pre></td></tr></table></figure><p>ç„¶åé€‰å–çº¢è‰²æ°´å£¶ä¸­çš„ç¬¬äºŒä¸ªæ°´å£¶ 5 ä¸ ã€ŒåŸºå‡†ã€ å…ƒç´ å¯¹æ¯”ï¼Œ5 &gt; 3, å› æ­¤ä½¿ç”¨ç¬¬ä¸€æ­¥çš„æ–¹æ³•ï¼Œæ‹¿ 5 ä¸ ã€ŒåŸºå‡†ã€ å…ƒç´ å³è¾¹çš„å…ƒç´ ä¾æ¬¡å¯¹æ¯”ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">2</span>, <span class="number">1</span>, â‘¢, <span class="number">4</span>, â‘¤, <span class="number">6</span>, <span class="number">8</span>]</span><br></pre></td></tr></table></figure><p>çº¢è‰²ç¬¬ä¸‰ä¸ªæ°´å£¶ä¸º 1ï¼Œ æ‹¿ 1 ä¸ç¬¬ä¸€ä¸ª ã€ŒåŸºå‡†ã€ å…ƒç´ æ¯”è¾ƒï¼Œ 1 &lt; 3, å› æ­¤ä½¿ç”¨ç¬¬ä¸€æ­¥çš„æ–¹æ³•ï¼Œ æ‹¿ 1 ä¸ ã€ŒåŸºå‡†ã€ å…ƒç´ å·¦è¾¹çš„å…ƒç´ ä¾æ¬¡å¯¹æ¯”ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[â‘ , <span class="number">2</span>, â‘¢, <span class="number">4</span>, â‘¤, <span class="number">6</span>, <span class="number">8</span>]</span><br></pre></td></tr></table></figure><p>çº¢è‰²ç¬¬å››ä¸ªæ°´å£¶ä¸º 4ï¼Œ æ‹¿ 4 ä¸ç¬¬ä¸€ä¸ª ã€ŒåŸºå‡†ã€ å…ƒç´ æ¯”è¾ƒï¼Œ 4 &gt; 3, å› æ­¤ä½¿ç”¨ç¬¬ä¸€æ­¥çš„æ–¹æ³•ï¼Œ æ‹¿ 4 ä¸ ã€ŒåŸºå‡†ã€ å…ƒç´ å³è¾¹çš„å…ƒç´ ä¾æ¬¡å¯¹æ¯”ã€‚<br>å³è¾¹å…ƒç´ é›†åˆä¸­åˆæœ‰ ã€ŒåŸºå‡†ã€ å…ƒç´  5 ï¼Œå› æ­¤å…ˆä¸ ã€ŒåŸºå‡†ã€ å…ƒç´ å¯¹æ¯”ï¼Œ 4 &lt; 5ï¼Œ æ‰€ä»¥æ‹¿ 4 ä¸ ã€ŒåŸºå‡†ã€ å…ƒç´ å·¦è¾¹çš„å…ƒç´ ä¾æ¬¡å¯¹æ¯”ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[â‘ , <span class="number">2</span>, â‘¢, â‘£, â‘¤, <span class="number">6</span>, <span class="number">8</span>]</span><br></pre></td></tr></table></figure><p>åé¢çš„é¡ºåºä¸º</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[â‘ , <span class="number">2</span>, â‘¢, â‘£, â‘¤, <span class="number">6</span>, â‘§]</span><br><span class="line"></span><br><span class="line">[â‘ , â‘¡, â‘¢, â‘£, â‘¤, <span class="number">6</span>, â‘§]</span><br><span class="line"></span><br><span class="line">[â‘ , â‘¡, â‘¢, â‘£, â‘¤, â‘¥, â‘§]</span><br></pre></td></tr></table></figure><p>ä»£ç æè¿°ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">'use strict'</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Array</span>.prototype.pivot = <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">const</span> quickMatch = <span class="function">(<span class="params">key, arr</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (arr.length &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;key&#125;</span> matched!`</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (arr.pivot &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        arr.left = <span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line">        arr.right = <span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line">        arr.map(<span class="function"><span class="params">ai</span>=&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (ai &lt; key) &#123;</span><br><span class="line">                arr.left.push(ai);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (ai &gt; key) &#123;</span><br><span class="line">                arr.right.push(ai);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (ai === key) &#123;</span><br><span class="line">                arr.pivot = key;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;key&#125;</span> matched!`</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (key &gt; arr.pivot) &#123;</span><br><span class="line">            quickMatch(key, arr.right);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (key &lt; arr.pivot) &#123;</span><br><span class="line">            quickMatch(key, arr.left);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arrRed = [<span class="number">3</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">6</span>];</span><br><span class="line"><span class="keyword">let</span> arrBlue = [<span class="number">6</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">4</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">of</span> arrRed) &#123;</span><br><span class="line">    quickMatch(key, arrBlue);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>æ€»ç»“</h1><p>è¿™ä¸ªç®—æ³•æœ‰ç‚¹ç±»ä¼¼äºäºŒå‰æ ‘çš„æ€æƒ³ï¼Œå°†çº¢è‰²æ°´å£¶ä¸è“è‰²æ°´å£¶ä¾æ¬¡å¯¹æ¯”çš„æ—¶å€™ï¼Œæ„å»ºè“è‰²æ°´å£¶äºŒå‰æ ‘ï¼Œæ¯ä¸ªäºŒå‰æ ‘çš„æ ¹ç»“ç‚¹ä¸ºçº¢è‰²æ°´å£¶ã€‚å¹³å‡æ—¶é—´å¤æ‚åº¦ä¸ºO(nlgn)ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;æ°´æ¡¶é—®é¢˜&lt;/h1&gt;
&lt;img src=&quot;/assets/img/Bucket.png&quot; alt=&quot;æˆ‘æ˜¯ä¸€åªçš„å›¾ç‰‡&quot;&gt;
&lt;p&gt;å‡è®¾ç»™ä½ nä¸ªçº¢è‰²çš„æ°´å£¶å’Œnä¸ªè“è‰²çš„æ°´å£¶ã€‚å®ƒä»¬çš„å½¢çŠ¶å’Œå°ºå¯¸éƒ½å„ä¸ç›¸åŒã€‚æ‰€æœ‰çš„çº¢è‰²æ°´å£¶ç››æ°´é‡éƒ½å„ä¸ç›¸åŒï¼Œè“è‰²æ°´å£¶ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ä½†å¯¹äºæ¯ä¸€ä¸ªçº¢è‰²æ°´å£¶æ¥è¯´ï¼Œéƒ½æœ‰ä¸€ä¸ªè“è‰²æ°´å£¶ç››æ°´é‡å’Œå…¶ç›¸åŒï¼›åä¹‹äº¦ç„¶ã€‚&lt;br&gt;
ä½ çš„ä»»åŠ¡æ˜¯é…å¯¹å‡ºå…¨éƒ¨ç››æ°´é‡ç›¸åŒçš„çº¢è‰²æ°´å£¶å’Œè“è‰²æ°´å£¶ã€‚ä¸ºæ­¤ï¼Œå¯ä»¥æ‰§è¡Œçš„æ“ä½œä¸ºï¼ŒæŒ‘å‡ºä¸€å¯¹æ°´å£¶ï¼Œä¸€åªçº¢è‰²ä¸€åªè“è‰²ï¼Œå°†çº¢è‰²æ°´å£¶çŒæ»¡æ°´ï¼Œå°†çº¢è‰²æ°´å£¶çš„æ°´å€’å…¥è“è‰²æ°´å£¶ä¸­ï¼Œçœ‹å…¶æ˜¯å¦æ°å¥½çŒæ»¡æ¥åˆ¤æ–­ï¼Œè¿™ä¸ªçº¢è‰²æ°´å£¶çš„ç››æ°´é‡å¤§äºã€å°äºæˆ–ç­‰äºè“è‰²æ°´å£¶ã€‚å‡è®¾è¿™æ ·çš„æ¯”è¾ƒéœ€è¦èŠ±è´¹ä¸€ä¸ªå•ä½æ—¶é—´ã€‚&lt;br&gt;
è¯·æ‰¾å‡ºä¸€ç§ç®—æ³•ï¼Œå®ƒèƒ½å¤Ÿç”¨æœ€å°‘çš„æ¯”è¾ƒæ¬¡æ•°æ¥ç¡®å®šæ‰€æœ‰æ°´å£¶çš„é…å¯¹ã€‚&lt;br&gt;
æ³¨æ„:ä¸å¯ç›´æ¥æ¯”è¾ƒä¸¤ä¸ªçº¢è‰²æˆ–è€…ä¸¤ä¸ªè“è‰²æ°´å£¶ï¼Œä¸€æ¬¡æ¯”è¾ƒå¿…é¡»å–ä¸€åªçº¢è‰²ä¸€åªè“è‰²ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Algorithm" scheme="https://lz5z.com/categories/Algorithm/"/>
    
    
      <category term="JavaScript" scheme="https://lz5z.com/tags/JavaScript/"/>
    
      <category term="Algorithm" scheme="https://lz5z.com/tags/Algorithm/"/>
    
      <category term="å¿«é€Ÿæ’åº" scheme="https://lz5z.com/tags/%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F/"/>
    
      <category term="æ°´æ¡¶é—®é¢˜" scheme="https://lz5z.com/tags/%E6%B0%B4%E6%A1%B6%E9%97%AE%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>HTML5 å‰ç«¯å­˜å‚¨</title>
    <link href="https://lz5z.com/HTML%E5%89%8D%E7%AB%AF%E5%AD%98%E5%82%A8/"/>
    <id>https://lz5z.com/HTMLå‰ç«¯å­˜å‚¨/</id>
    <published>2016-11-16T00:33:38.000Z</published>
    <updated>2020-04-21T10:23:54.823Z</updated>
    
    <content type="html"><![CDATA[<h1>Cookie, LocalStorage ä¸ SessionStorage</h1><h2>åŸºæœ¬æ¦‚å¿µ</h2><p>Cookieï¼ŒæŒ‡æŸäº›ç½‘ç«™ä¸ºäº†è¾¨åˆ«ç”¨æˆ·èº«ä»½è€Œå‚¨å­˜åœ¨ç”¨æˆ·æœ¬åœ°ç»ˆç«¯ï¼ˆClient Sideï¼‰ä¸Šçš„æ•°æ®ï¼ˆé€šå¸¸ç»è¿‡åŠ å¯†ï¼‰ã€‚</p><p>html5 ä¸­çš„ Web Storage åŒ…æ‹¬äº†ä¸¤ç§å­˜å‚¨æ–¹å¼ï¼šsessionStorageå’ŒlocalStorageã€‚</p><p>sessionStorage ç”¨äºæœ¬åœ°å­˜å‚¨ä¸€ä¸ªä¼šè¯ï¼ˆsessionï¼‰ä¸­çš„æ•°æ®ï¼Œè¿™äº›æ•°æ®åªæœ‰åœ¨åŒä¸€ä¸ªä¼šè¯ä¸­çš„é¡µé¢æ‰èƒ½è®¿é—®å¹¶ä¸”å½“ä¼šè¯ç»“æŸåæ•°æ®ä¹Ÿéšä¹‹é”€æ¯ã€‚å› æ­¤ sessionStorage ä¸æ˜¯ä¸€ç§æŒä¹…åŒ–çš„æœ¬åœ°å­˜å‚¨ï¼Œä»…ä»…æ˜¯ä¼šè¯çº§åˆ«çš„å­˜å‚¨ã€‚</p><p>è€Œ localStorage ç”¨äºæŒä¹…åŒ–çš„æœ¬åœ°å­˜å‚¨ï¼Œé™¤éä¸»åŠ¨åˆ é™¤æ•°æ®ï¼Œå¦åˆ™æ•°æ®æ˜¯æ°¸è¿œä¸ä¼šè¿‡æœŸçš„ã€‚æµè§ˆå™¨ä¸­åŒä¸€ä¸ªåŸŸä¸‹çš„çª—å£å¯ä»¥å…±äº« localStorage æ•°æ®ã€‚</p><a id="more"></a><h2>å…¼å®¹æ€§</h2><table><thead><tr><th style="text-align:left">ç‰¹æ€§</th><th style="text-align:center">Chrome</th><th style="text-align:center">Firefox (Gecko)</th><th style="text-align:center">Internet Explorer</th><th style="text-align:center">Opera</th><th style="text-align:center">Safari (WebKit)</th></tr></thead><tbody><tr><td style="text-align:left">localStorage</td><td style="text-align:center">4</td><td style="text-align:center">3.5</td><td style="text-align:center">8</td><td style="text-align:center">10.50</td><td style="text-align:center">4</td></tr><tr><td style="text-align:left">sessionStorage</td><td style="text-align:center">5</td><td style="text-align:center">2</td><td style="text-align:center">8</td><td style="text-align:center">10.50</td><td style="text-align:center">4</td></tr></tbody></table><h2>å·®åˆ«</h2><p>Cookie ä¸€èˆ¬ç”±æœåŠ¡å™¨ç”Ÿæˆï¼Œå¯è®¾ç½®å¤±æ•ˆæ—¶é—´ã€‚å¦‚æœåœ¨æµè§ˆå™¨ç«¯ç”Ÿæˆ Cookieï¼Œé»˜è®¤æ˜¯å…³é—­æµè§ˆå™¨åå¤±æ•ˆã€‚Http é€šä¿¡çš„æ—¶å€™ Cookie çš„ä¿¡æ¯ä¼šä¿å­˜çš„ Http å¤´ä¸­ã€‚<br>localStorage å’Œ sessionStorage ä»…åœ¨å®¢æˆ·ç«¯ï¼ˆå³æµè§ˆå™¨ï¼‰ä¸­ä¿å­˜ï¼Œä¸å‚ä¸å’ŒæœåŠ¡å™¨çš„é€šä¿¡ã€‚</p><h2>åº”ç”¨åœºæ™¯</h2><p>å› ä¸ºæ¯ä¸ª HTTP è¯·æ±‚éƒ½ä¼šå¸¦ç€ Cookie çš„ä¿¡æ¯ï¼Œæ‰€ä»¥ Cookie åº”å½“å°½å¯èƒ½ç²¾ç®€ï¼Œæ¯”è¾ƒå¸¸ç”¨çš„ä¸€ä¸ªåº”ç”¨åœºæ™¯å°±æ˜¯åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»å½•ã€‚é’ˆå¯¹ç™»å½•è¿‡çš„ç”¨æˆ·ï¼ŒæœåŠ¡å™¨ç«¯ä¼šåœ¨ä»–ç™»å½•æ—¶å¾€ Cookie ä¸­æ’å…¥ä¸€æ®µåŠ å¯†è¿‡çš„å”¯ä¸€è¾¨è¯†å•ä¸€ç”¨æˆ·çš„è¾¨è¯†ç ï¼Œä¸‹æ¬¡åªè¦è¯»å–è¿™ä¸ªå€¼å°±å¯ä»¥åˆ¤æ–­å½“å‰ç”¨æˆ·æ˜¯å¦ç™»å½•å•¦ã€‚</p><p>localStorage ä¸»è¦å­˜å‚¨ä¸€äº›æ¯”è¾ƒå¤šçš„æœ¬åœ°æ•°æ®ï¼Œå¦‚ HTML5 å°æ¸¸æˆé‡Œé¢ç”Ÿæˆçš„æ•°æ®ã€‚</p><p>å¦‚æœé‡åˆ°ä¸€äº›å†…å®¹ç‰¹åˆ«å¤šçš„è¡¨å•ï¼Œä¸ºäº†ä¼˜åŒ–ç”¨æˆ·ä½“éªŒï¼Œæˆ‘ä»¬å¯èƒ½è¦æŠŠè¡¨å•é¡µé¢æ‹†åˆ†æˆå¤šä¸ªå­é¡µé¢ï¼Œç„¶åæŒ‰æ­¥éª¤å¼•å¯¼ç”¨æˆ·å¡«å†™ã€‚è¿™æ—¶å€™ sessionStorage çš„ä½œç”¨å°±å‘æŒ¥å‡ºæ¥äº†ã€‚</p><h2>å®‰å…¨æ€§çš„è€ƒè™‘</h2><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸æ˜¯ä»€ä¹ˆæ•°æ®éƒ½é€‚åˆæ”¾åœ¨ Cookieã€localStorage å’Œ sessionStorage ä¸­çš„ã€‚ä½¿ç”¨å®ƒä»¬çš„æ—¶å€™ï¼Œéœ€è¦æ—¶åˆ»æ³¨æ„æ˜¯å¦æœ‰ä»£ç å­˜åœ¨ XSS æ³¨å…¥çš„é£é™©ã€‚å› ä¸ºåªè¦æ‰“å¼€æ§åˆ¶å°ï¼Œä½ å°±éšæ„ä¿®æ”¹å®ƒä»¬çš„å€¼ï¼Œæ‰€ä»¥åƒä¸‡ä¸è¦ç”¨å®ƒä»¬å­˜å‚¨ä½ ç³»ç»Ÿä¸­çš„æ•æ„Ÿæ•°æ®ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;Cookie, LocalStorage ä¸ SessionStorage&lt;/h1&gt;
&lt;h2&gt;åŸºæœ¬æ¦‚å¿µ&lt;/h2&gt;
&lt;p&gt;Cookieï¼ŒæŒ‡æŸäº›ç½‘ç«™ä¸ºäº†è¾¨åˆ«ç”¨æˆ·èº«ä»½è€Œå‚¨å­˜åœ¨ç”¨æˆ·æœ¬åœ°ç»ˆç«¯ï¼ˆClient Sideï¼‰ä¸Šçš„æ•°æ®ï¼ˆé€šå¸¸ç»è¿‡åŠ å¯†ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;html5 ä¸­çš„ Web Storage åŒ…æ‹¬äº†ä¸¤ç§å­˜å‚¨æ–¹å¼ï¼šsessionStorageå’ŒlocalStorageã€‚&lt;/p&gt;
&lt;p&gt;sessionStorage ç”¨äºæœ¬åœ°å­˜å‚¨ä¸€ä¸ªä¼šè¯ï¼ˆsessionï¼‰ä¸­çš„æ•°æ®ï¼Œè¿™äº›æ•°æ®åªæœ‰åœ¨åŒä¸€ä¸ªä¼šè¯ä¸­çš„é¡µé¢æ‰èƒ½è®¿é—®å¹¶ä¸”å½“ä¼šè¯ç»“æŸåæ•°æ®ä¹Ÿéšä¹‹é”€æ¯ã€‚å› æ­¤ sessionStorage ä¸æ˜¯ä¸€ç§æŒä¹…åŒ–çš„æœ¬åœ°å­˜å‚¨ï¼Œä»…ä»…æ˜¯ä¼šè¯çº§åˆ«çš„å­˜å‚¨ã€‚&lt;/p&gt;
&lt;p&gt;è€Œ localStorage ç”¨äºæŒä¹…åŒ–çš„æœ¬åœ°å­˜å‚¨ï¼Œé™¤éä¸»åŠ¨åˆ é™¤æ•°æ®ï¼Œå¦åˆ™æ•°æ®æ˜¯æ°¸è¿œä¸ä¼šè¿‡æœŸçš„ã€‚æµè§ˆå™¨ä¸­åŒä¸€ä¸ªåŸŸä¸‹çš„çª—å£å¯ä»¥å…±äº« localStorage æ•°æ®ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="HTML" scheme="https://lz5z.com/categories/HTML/"/>
    
    
      <category term="JavaScript" scheme="https://lz5z.com/tags/JavaScript/"/>
    
      <category term="HTML5" scheme="https://lz5z.com/tags/HTML5/"/>
    
  </entry>
  
  <entry>
    <title>Pythonä¸€äº›ä¹¦å†™æŠ€å·§</title>
    <link href="https://lz5z.com/Python%E4%B8%80%E4%BA%9B%E4%B9%A6%E5%86%99%E6%8A%80%E5%B7%A7/"/>
    <id>https://lz5z.com/Pythonä¸€äº›ä¹¦å†™æŠ€å·§/</id>
    <published>2016-11-13T21:36:55.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h1>ç®€ä»‹</h1><p>æœ¬æ–‡ä»‹ç»äº†ä¸€äº›å¹³æ—¶ç”¨åˆ°çš„Pythonä¹¦å†™æŠ€å·§ã€‚ä¹‹åä¼šä¸æ–­æ›´æ–°ã€‚<br><img src="/assets/img/python.png" alt="æˆ‘æ˜¯ä¸€åªçš„å›¾ç‰‡" width="20%"></p><a id="more"></a><h2>äº¤æ¢å˜é‡</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="number">6</span></span><br><span class="line">y = <span class="number">5</span></span><br><span class="line"> </span><br><span class="line">x, y = y, x</span><br><span class="line"> </span><br><span class="line">print(x, y) <span class="comment">#5 6</span></span><br></pre></td></tr></table></figure><h2>if è¯­å¥åœ¨è¡Œå†…</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">"Hello"</span>) <span class="keyword">if</span> <span class="literal">True</span> <span class="keyword">else</span> <span class="string">"World"</span> <span class="comment">#Hello</span></span><br></pre></td></tr></table></figure><h2>è¿æ¥</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">b = [<span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">print(a + b) <span class="comment">#[1, 2, 3, 4]</span></span><br><span class="line"> </span><br><span class="line">print(str(<span class="number">1</span>) + <span class="string">" world"</span>) <span class="comment">#1 world</span></span><br><span class="line"> </span><br><span class="line">print(`<span class="number">1</span>` + <span class="string">" world"</span>) <span class="comment">#1 world</span></span><br><span class="line"> </span><br><span class="line">print(<span class="number">1</span>, <span class="string">"world"</span>) <span class="comment">#1 world</span></span><br><span class="line"></span><br><span class="line">print(a, <span class="number">3</span>) <span class="comment">#[1, 2] 3</span></span><br></pre></td></tr></table></figure><h2>é™¤æ³•</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="number">5.0</span>//<span class="number">2</span>) <span class="comment">#2 åœ°æ¿é™¤</span></span><br><span class="line">print(<span class="number">2</span>**<span class="number">5</span>) <span class="comment">#32 2çš„5æ¬¡æ–¹</span></span><br><span class="line"></span><br><span class="line">print(<span class="number">.3</span>/<span class="number">.1</span>) <span class="comment">#2.9999999999999996</span></span><br><span class="line">print(<span class="number">.3</span>//<span class="number">.1</span>) <span class="comment">#2.0</span></span><br></pre></td></tr></table></figure><h2>æ•°å€¼æ¯”è¾ƒ</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="number">2</span></span><br><span class="line"><span class="keyword">if</span> <span class="number">3</span> &gt; x &gt; <span class="number">1</span>:</span><br><span class="line">   print(x) <span class="comment">#2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="number">1</span> &lt; x &gt; <span class="number">0</span>:</span><br><span class="line">   print(x) <span class="comment">#2</span></span><br></pre></td></tr></table></figure><h2>è¿­ä»£åˆ—è¡¨</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">names = (<span class="string">'Jack'</span>,<span class="string">'Leo'</span>,<span class="string">'Sony'</span>)</span><br><span class="line">ages = (<span class="number">2001</span>,<span class="number">2002</span>,<span class="number">2003</span>)</span><br><span class="line"><span class="keyword">for</span> a, n <span class="keyword">in</span> zip(names, ages):</span><br><span class="line">    print(a, n)</span><br><span class="line"><span class="comment">#Jack 2001</span></span><br><span class="line"><span class="comment">#Leo 2002</span></span><br><span class="line"><span class="comment">#Sony 2003</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç´¢å¼•</span></span><br><span class="line"><span class="keyword">for</span> index, a <span class="keyword">in</span> enumerate(names):</span><br><span class="line">    print(index, a)</span><br><span class="line"><span class="comment">#0 Jack</span></span><br><span class="line"><span class="comment">#1 Leo</span></span><br><span class="line"><span class="comment">#2 Sony</span></span><br></pre></td></tr></table></figure><h2>åˆ—è¡¨æ¨å¯¼å¼</h2><p>å·²çŸ¥ä¸€ä¸ªåˆ—è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥ç­›é€‰å‡ºå¶æ•°åˆ—è¡¨æ–¹æ³•ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">numbers = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]</span><br><span class="line">even = []</span><br><span class="line"><span class="keyword">for</span> number <span class="keyword">in</span> numbers:</span><br><span class="line">    <span class="keyword">if</span> number%<span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        even.append(number)</span><br><span class="line"></span><br><span class="line"><span class="comment">#è½¬å˜æˆå¦‚ä¸‹ï¼š</span></span><br><span class="line">even = [number <span class="keyword">for</span> number <span class="keyword">in</span> numbers <span class="keyword">if</span> number%<span class="number">2</span> == <span class="number">0</span>]</span><br></pre></td></tr></table></figure><h2>å­—å…¸æ¨å¯¼</h2><p>å’Œåˆ—è¡¨æ¨å¯¼ç±»ä¼¼ï¼Œå­—å…¸å¯ä»¥åšåŒæ ·çš„å·¥ä½œï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">names = [<span class="string">'Jack'</span>,<span class="string">'Leo'</span>,<span class="string">'Sony'</span>]</span><br><span class="line">people = [&#123;key: value <span class="keyword">for</span> value, key <span class="keyword">in</span> enumerate(names)&#125;]</span><br><span class="line">print(people)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[&#123;<span class="string">'Sony'</span>: <span class="number">2</span>, <span class="string">'Leo'</span>: <span class="number">1</span>, <span class="string">'Jack'</span>: <span class="number">0</span>&#125;]</span><br></pre></td></tr></table></figure><h2>åˆå§‹åŒ–åˆ—è¡¨çš„å€¼</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">items = [<span class="number">0</span>]*<span class="number">3</span></span><br><span class="line">print(items)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br></pre></td></tr></table></figure><h2>åˆ—è¡¨è½¬æ¢ä¸ºå­—ç¬¦ä¸²</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">names = [<span class="string">"Leo"</span>, <span class="string">"Jack"</span>, <span class="string">"Lucy"</span>]</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">", "</span>.join(names)</span></span>)</span><br><span class="line">&gt;&gt;&gt; Leo, Jack, Lucy</span><br></pre></td></tr></table></figure><h2>ä»å­—å…¸ä¸­è·å–å…ƒç´ </h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data = &#123;<span class="string">'user'</span>: <span class="number">1</span>, <span class="string">'name'</span>: <span class="string">'Max'</span>, <span class="string">'age'</span>: <span class="number">4</span>&#125;</span><br><span class="line">is_admin = data.get(<span class="string">'admin'</span>, <span class="literal">False</span>)</span><br><span class="line">print(is_admin)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="literal">False</span></span><br></pre></td></tr></table></figure><h2>åˆ‡ç‰‡</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">x = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]</span><br><span class="line"><span class="comment">#å‰3ä¸ª</span></span><br><span class="line">print(x[:<span class="number">3</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line"><span class="comment">#ä¸­é—´4ä¸ª</span></span><br><span class="line">print(x[<span class="number">1</span>:<span class="number">5</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br><span class="line"><span class="comment">#æœ€å3ä¸ª</span></span><br><span class="line">print(x[<span class="number">-3</span>:])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]</span><br><span class="line"><span class="comment">#å¥‡æ•°é¡¹</span></span><br><span class="line">print(x[::<span class="number">2</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>]</span><br><span class="line"><span class="comment">#å¶æ•°é¡¹</span></span><br><span class="line">print(x[<span class="number">1</span>::<span class="number">2</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>]</span><br></pre></td></tr></table></figure><h2>ä¸€è¡Œä»£ç è§£å†³FizzBuzz</h2><p>æœ‰ä¸€ä¸ªç®€å•çš„ç¼–ç¨‹ç»ƒä¹ å«FizzBuzzï¼Œé—®é¢˜å¼•ç”¨å¦‚ä¸‹ï¼š</p><p>å†™ä¸€ä¸ªç¨‹åºï¼Œæ‰“å°æ•°å­—1åˆ°100ï¼Œ3çš„å€æ•°æ‰“å°â€œFizzâ€æ¥æ›¿æ¢è¿™ä¸ªæ•°ï¼Œ5çš„å€æ•°æ‰“å°â€œBuzzâ€ï¼Œå¯¹äºæ—¢æ˜¯3çš„å€æ•°åˆæ˜¯5çš„å€æ•°çš„æ•°å­—æ‰“å°â€œFizzBuzzâ€ã€‚</p><p>è¿™é‡Œå°±æ˜¯ä¸€ä¸ªç®€çŸ­çš„ï¼Œæœ‰æ„æ€çš„æ–¹æ³•è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">101</span>):print(<span class="string">"fizz"</span>[x%<span class="number">3</span>*<span class="number">4</span>::]+<span class="string">"buzz"</span>[x%<span class="number">5</span>*<span class="number">4</span>::]<span class="keyword">or</span> x)</span><br></pre></td></tr></table></figure><h2>é›†åˆ</h2><p>é™¤äº†pythonå†…ç½®çš„æ•°æ®ç±»å‹å¤–ï¼Œåœ¨collectionæ¨¡å—åŒæ ·è¿˜åŒ…æ‹¬ä¸€äº›ç‰¹åˆ«çš„ç”¨ä¾‹ï¼Œåœ¨æœ‰äº›åœºåˆCounteréå¸¸å®ç”¨ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line">print(Counter(<span class="string">"hello"</span>))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>Counter(&#123;<span class="string">'l'</span>: <span class="number">2</span>, <span class="string">'h'</span>: <span class="number">1</span>, <span class="string">'e'</span>: <span class="number">1</span>, <span class="string">'o'</span>: <span class="number">1</span>&#125;)</span><br></pre></td></tr></table></figure><h2>è¿­ä»£å·¥å…·</h2><p>å’Œcollectionsåº“ä¸€æ ·ï¼Œè¿˜æœ‰ä¸€ä¸ªåº“å«itertoolsï¼Œå¯¹æŸäº›é—®é¢˜çœŸèƒ½é«˜æ•ˆåœ°è§£å†³ã€‚å…¶ä¸­ä¸€ä¸ªç”¨ä¾‹æ˜¯æŸ¥æ‰¾æ‰€æœ‰ç»„åˆï¼Œä»–èƒ½å‘Šè¯‰ä½ åœ¨ä¸€ä¸ªç»„ä¸­å…ƒç´ çš„æ‰€æœ‰ä¸åŒçš„ç»„åˆæ–¹å¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> combinations</span><br><span class="line">names = [<span class="string">"Leo"</span>, <span class="string">"Jack"</span>, <span class="string">"Lucy"</span>]</span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> combinations(names, <span class="number">2</span>):</span><br><span class="line">    print(name)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>(<span class="string">'Leo'</span>, <span class="string">'Jack'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>(<span class="string">'Leo'</span>, <span class="string">'Lucy'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>(<span class="string">'Jack'</span>, <span class="string">'Lucy'</span>)</span><br></pre></td></tr></table></figure><h2>False == True</h2><p>åœ¨Pythonä¸­ï¼ŒTrueå’ŒFalseæ˜¯å…¨å±€å˜é‡ï¼Œå› æ­¤ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">False</span> = <span class="literal">True</span></span><br><span class="line"><span class="keyword">if</span> <span class="literal">False</span>:</span><br><span class="line">   print(<span class="string">"Hello"</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">   print(<span class="string">"World"</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>Hello</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;ç®€ä»‹&lt;/h1&gt;
&lt;p&gt;æœ¬æ–‡ä»‹ç»äº†ä¸€äº›å¹³æ—¶ç”¨åˆ°çš„Pythonä¹¦å†™æŠ€å·§ã€‚ä¹‹åä¼šä¸æ–­æ›´æ–°ã€‚&lt;br&gt;
&lt;img src=&quot;/assets/img/python.png&quot; alt=&quot;æˆ‘æ˜¯ä¸€åªçš„å›¾ç‰‡&quot; width=&quot;20%&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Python" scheme="https://lz5z.com/categories/Python/"/>
    
    
      <category term="Python" scheme="https://lz5z.com/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>æ¢äº†ä¸€ä¸ª Blog ä¸»é¢˜</title>
    <link href="https://lz5z.com/%E6%8D%A2%E4%BA%86%E4%B8%80%E4%B8%AABlog%E4%B8%BB%E9%A2%98/"/>
    <id>https://lz5z.com/æ¢äº†ä¸€ä¸ªBlogä¸»é¢˜/</id>
    <published>2016-11-11T09:17:09.000Z</published>
    <updated>2020-04-21T10:23:54.831Z</updated>
    
    <content type="html"><![CDATA[<h1>yilia</h1><p>å‰å‡ å¤©deployåšå®¢çš„æ—¶å€™ï¼Œå‘ç°æ‰“å¼€blogé¡µé¢æ˜¯ç©ºçš„ï¼Œåªæœ‰headéƒ¨åˆ†æ˜¾ç¤ºå‡ºæ¥äº†ã€‚æ‰“å¼€æ§åˆ¶å°æ’æŸ¥é—®é¢˜ï¼Œå‘ç°hexoä¸»é¢˜é‡Œé¢æœ‰å‡ ä¸ªå¤–éƒ¨ajax callå¤±è´¥ï¼Œå¯¼è‡´æ•´ä¸ªé¡µé¢éƒ½æ²¡æœ‰æ¸²æŸ“å‡ºæ¥ï¼Œè¿™æ˜¯ä¸€ä»¶æ¼ç«çš„äº‹æƒ…ã€‚<img src="/assets/img/angry.png" alt="æˆ‘æ˜¯ä¸€åªç”Ÿæ°”çš„å›¾ç‰‡"></p><p>äºæ˜¯æœæ–­æ¢ä¸»é¢˜ï¼Œå…¶å®å¯¹ä¹‹å‰çš„ä¸»é¢˜è¿˜æ˜¯å¾ˆæ»¡æ„çš„ï¼š ç®€æ´ï¼Œæ¸²æŸ“é€Ÿåº¦ä¹Ÿå¾ˆå¿«ï¼ŒåŠŸèƒ½è™½ç„¶ä¸å¤šï¼Œä½†æ˜¯åŸºæœ¬æ»¡è¶³æˆ‘çš„éœ€æ±‚ã€‚</p><p>è¿™æ¬¡é€‰æ‹©çš„ä¸»é¢˜æ˜¯è…¾è®¯çš„å·¥ç¨‹å¸ˆLittenåˆ¶ä½œçš„ <a href="https://github.com/litten/hexo-theme-yilia" target="_blank" rel="noopener">ã€Œyiliaã€</a></p><p>ã€Œyiliaã€ åŒæ ·æ˜¯æˆ‘å–œæ¬¢çš„ç®€æ´æ ·å¼ï¼Œä½œè€…ç”šè‡³ç§»é™¤äº†æœç´¢æ¡†ã€‚è€Œä¸”å¯¹äºç§»åŠ¨ç«¯çš„ä¼˜åŒ–ä¹Ÿåšå¾—å¾ˆä¸é”™ã€‚</p><a id="more"></a><h1>yotuku</h1><p>ä¹‹å‰Blogé‡Œé¢çš„å›¾ç‰‡ä¸€ç›´éƒ½é€‰æ‹© <a href="http://yotuku.cn/" target="_blank" rel="noopener">ã€Œyotukuã€</a> ç”Ÿæˆåœ¨çº¿å›¾ç‰‡ï¼Œç„¶ååœ¨markdowné‡Œé¢å¼•ç”¨ï¼Œå¦‚æœå›¾ç‰‡å¤§å°æˆ–è€…ä½ç½®ä¸åˆé€‚çš„è¯ï¼Œä¼šåœ¨mdé‡Œé¢æ‰‹å†™ä¸€æ®µhtmlï¼Œè¿™æ ·åšå¾ˆçœäº‹ã€‚</p><p>ä»Šå¤©æ—©ä¸Šçœ‹è‡ªå·±çš„Blogå‘ç°æœ‰å‡ å¼ å›¾ç‰‡æ²¡æœ‰åŠ è½½å‡ºæ¥ï¼Œä»¥ä¸ºæ˜¯æ–°ä¸»é¢˜æ¸²æŸ“çš„é—®é¢˜ï¼Œé‡æ–°deployä»¥åå‘ç°è¿˜æ˜¯æ²¡æœ‰ã€‚çœ‹æ¥ä¸æ˜¯ä¸»é¢˜çš„é”…ã€‚</p><p>ä½¿ç”¨æ§åˆ¶å°å‘ç°</p><img src="/assets/img/ajax_call_failure.png" alt="æˆ‘æ˜¯ä¸€åªå¤±è´¥çš„å›¾ç‰‡"><p>åŸæ¥è¿™å‡ å¼ å›¾ç‰‡éƒ½æ²¡æœ‰æ‹¿åˆ°ï¼Œå·²ç»åœ¨å®˜ç½‘ç•™è¨€ï¼Œå¸Œæœ›èƒ½å¤Ÿè§£å†³ã€‚</p><p>ä¸è¿‡ä½¿ç”¨å…è´¹äº‘æœåŠ¡å­˜å‚¨è‡ªå·±Blogçš„å›¾ç‰‡ç¡®å®ä¸å¤ªå®‰å…¨ï¼Œåƒè¿™æ ·ä¸¢å¤±å›¾ç‰‡çš„è¡Œä¸ºå¯èƒ½ä¼šå¯¼è‡´å‡ å¼ å›¾ç‰‡åŠ è½½ä¸å‡ºæ¥ï¼Œä½†æ˜¯å¦‚æœä»¥åäº‘æœåŠ¡æä¾›å•†æŒ‚æ‰äº†ï¼ˆè¿™é‡Œä¸æ˜¯è¯…å’’yutukuä¸å¥½ï¼Œå¸Œæœ›è¿™æ ·è‰¯å¿ƒä¼ä¸šè¶Šæ¥è¶Šå¥½ï¼‰ï¼Œé‚£è¿™äº›å›¾ç‰‡å²‚ä¸å°±å†ä¹Ÿæ‰¾ä¸åˆ°äº†ã€‚</p><p>è¿˜æ˜¯è€è€å®å®æŠŠå›¾ç‰‡æ”¾åˆ°Blogè·¯å¾„ä¸‹ï¼Œç”¨ç›¸å¯¹åœ°å€å¼•ç”¨å§ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;yilia&lt;/h1&gt;
&lt;p&gt;å‰å‡ å¤©deployåšå®¢çš„æ—¶å€™ï¼Œå‘ç°æ‰“å¼€blogé¡µé¢æ˜¯ç©ºçš„ï¼Œåªæœ‰headéƒ¨åˆ†æ˜¾ç¤ºå‡ºæ¥äº†ã€‚æ‰“å¼€æ§åˆ¶å°æ’æŸ¥é—®é¢˜ï¼Œå‘ç°hexoä¸»é¢˜é‡Œé¢æœ‰å‡ ä¸ªå¤–éƒ¨ajax callå¤±è´¥ï¼Œå¯¼è‡´æ•´ä¸ªé¡µé¢éƒ½æ²¡æœ‰æ¸²æŸ“å‡ºæ¥ï¼Œè¿™æ˜¯ä¸€ä»¶æ¼ç«çš„äº‹æƒ…ã€‚&lt;img src=&quot;/assets/img/angry.png&quot; alt=&quot;æˆ‘æ˜¯ä¸€åªç”Ÿæ°”çš„å›¾ç‰‡&quot;&gt;&lt;/p&gt;
&lt;p&gt;äºæ˜¯æœæ–­æ¢ä¸»é¢˜ï¼Œå…¶å®å¯¹ä¹‹å‰çš„ä¸»é¢˜è¿˜æ˜¯å¾ˆæ»¡æ„çš„ï¼š ç®€æ´ï¼Œæ¸²æŸ“é€Ÿåº¦ä¹Ÿå¾ˆå¿«ï¼ŒåŠŸèƒ½è™½ç„¶ä¸å¤šï¼Œä½†æ˜¯åŸºæœ¬æ»¡è¶³æˆ‘çš„éœ€æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ¬¡é€‰æ‹©çš„ä¸»é¢˜æ˜¯è…¾è®¯çš„å·¥ç¨‹å¸ˆLittenåˆ¶ä½œçš„ &lt;a href=&quot;https://github.com/litten/hexo-theme-yilia&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ã€Œyiliaã€&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ã€Œyiliaã€ åŒæ ·æ˜¯æˆ‘å–œæ¬¢çš„ç®€æ´æ ·å¼ï¼Œä½œè€…ç”šè‡³ç§»é™¤äº†æœç´¢æ¡†ã€‚è€Œä¸”å¯¹äºç§»åŠ¨ç«¯çš„ä¼˜åŒ–ä¹Ÿåšå¾—å¾ˆä¸é”™ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Blog" scheme="https://lz5z.com/categories/Blog/"/>
    
    
      <category term="Hexo" scheme="https://lz5z.com/tags/Hexo/"/>
    
      <category term="Yilia" scheme="https://lz5z.com/tags/Yilia/"/>
    
      <category term="Theme" scheme="https://lz5z.com/tags/Theme/"/>
    
  </entry>
  
  <entry>
    <title>JavaScript ä¸¥æ ¼æ¨¡å¼</title>
    <link href="https://lz5z.com/JavaScript%E4%B8%A5%E6%A0%BC%E6%A8%A1%E5%BC%8F/"/>
    <id>https://lz5z.com/JavaScriptä¸¥æ ¼æ¨¡å¼/</id>
    <published>2016-11-09T12:58:12.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h1>ç®€ä»‹</h1><p>ECMAScript 5 å¼•å…¥äº†ä¸¥æ ¼æ¨¡å¼ï¼ˆstrict modeï¼‰çš„æ¦‚å¿µã€‚ä¸¥æ ¼æ¨¡å¼ä¸ºJavaScriptå®šä¹‰äº†ä¸€ç§ä¸åŒçš„è§£æä¸æ‰§è¡Œæ¨¡å‹ã€‚åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼ŒECMAScript 3ä¸­çš„ä¸€äº›ä¸ç¡®å®šçš„è¡Œä¸ºå°†å¾—åˆ°å¤„ç†ï¼Œè€Œä¸”å¯¹äºæŸäº›ä¸å®‰å…¨çš„æ“ä½œä¹Ÿä¼šæŠ›å‡ºé”™è¯¯ã€‚ï¼ˆ<a href="https://github.com/Leo555/JavaScript/blob/master/books/JavaScript%E9%AB%98%E7%BA%A7%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%EF%BC%88%E7%AC%AC3%E7%89%88%EF%BC%89%E3%80%91%E4%B8%AD%E6%96%87%20%E9%AB%98%E6%B8%85%20%E5%AE%8C%E6%95%B4%20%E8%AF%A6%E7%BB%86%E4%B9%A6%E7%AD%BE%E7%89%88.pdf" target="_blank" rel="noopener">JavaScripté«˜çº§ç¨‹åºè®¾è®¡</a>ï¼‰</p><a id="more"></a><p>è®¾ç«‹ä¸¥æ ¼æ¨¡å¼çš„ç›®çš„ï¼š</p><ol><li>ä¸¥æ ¼æ¨¡å¼ä¼šå°†JavaScripté™·é˜±ç›´æ¥å˜æˆæ˜æ˜¾çš„é”™è¯¯ã€‚</li><li>ä¸¥æ ¼æ¨¡å¼ä¿®æ­£äº†ä¸€äº›å¼•æ“éš¾ä»¥ä¼˜åŒ–çš„é”™è¯¯ã€‚</li><li>åŒæ ·çš„ä»£ç æœ‰äº›æ—¶å€™ä¸¥æ ¼æ¨¡å¼ä¼šæ¯”éä¸¥æ ¼æ¨¡å¼ä¸‹æ›´å¿«ã€‚</li><li>ä¸¥æ ¼æ¨¡å¼ç¦ç”¨äº†ä¸€äº›æœ‰å¯èƒ½åœ¨æœªæ¥ç‰ˆæœ¬ä¸­å®šä¹‰çš„è¯­æ³•ã€‚</li></ol><h1>å¼€å¯ä¸¥æ ¼æ¨¡å¼</h1><p>ä½¿ç”¨ â€˜use strictâ€™; è¿›å…¥ä¸¥æ ¼æ¨¡å¼ã€‚ ä¸¥æ ¼æ¨¡å¼å¯ä»¥åº”ç”¨åˆ°æ•´ä¸ªscriptæ ‡ç­¾æˆ–ä¸ªåˆ«å‡½æ•°ä¸­ã€‚</p><h2>ä¸ºæ•´ä¸ªscriptæ ‡ç­¾å¼€å¯ä¸¥æ ¼æ¨¡å¼</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ•´ä¸ªè¯­å¥éƒ½å¼€å¯ä¸¥æ ¼æ¨¡å¼çš„è¯­æ³•</span></span><br><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'ä¸¥æ ¼æ¨¡å¼script'</span>)</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼š å¦‚æœè¦ä¸ºæ•´ä¸ªscriptå¼€å¯ä¸¥æ ¼æ¨¡å¼ï¼Œâ€˜use strictâ€™; ä¸€å®šè¦æ”¾åœ¨ç¬¬ä¸€è¡Œã€‚ å¦‚æœæ‹…å¿ƒæ–‡ä»¶åˆå¹¶å¸¦æ¥ä¸¥æ ¼æ¨¡å¼ä¸æ­£å¸¸æ¨¡å¼çš„æ··åˆï¼Œå¯ä»¥å°†scriptå†™æˆè‡ªæ‰§è¡Œå‡½æ•°çš„å½¢å¼ã€‚</p><h2>ä¸ºæŸä¸ªå‡½æ•°å¼€å¯ä¸¥æ ¼æ¨¡å¼</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">strict</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="meta">    "use strict"</span>;ã€€ã€€</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"ä¸¥æ ¼æ¨¡å¼å‡½æ•°"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">notStrict</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"æ­£å¸¸æ¨¡å¼å‡½æ•°"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>ä¸¥æ ¼æ¨¡å¼æœ‰å“ªäº›ä¸åŒ</h1><h2>å…¨å±€å˜é‡æ˜¾å¼å£°æ˜</h2><p>åœ¨æ­£å¸¸æ¨¡å¼ä¸‹ï¼Œå¦‚æœä¸€ä¸ªå˜é‡æœªå£°æ˜å°±ç›´æ¥èµ‹å€¼ï¼Œç›¸å½“äºåˆ›å»ºä¸€ä¸ªå…¨å±€å˜é‡ã€‚è¿™ç»™æ–°äººå¼€å‘è€…å¸¦æ¥ä¾¿åˆ©çš„åŒæ—¶ï¼Œç»™æ•´ä¸ªé¡¹ç›®ç•™ä¸‹å·¨å¤§éšæ‚£ã€‚ä¸¥æ ¼æ¨¡å¼å°†è¿™ç§å¤±è¯¯å½“æˆé”™è¯¯ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">'use strict'</span>;</span><br><span class="line">a = <span class="string">'ä¸¥æ ¼æ¨¡å¼'</span>;  <span class="comment">//ReferenceError: a is not defined</span></span><br></pre></td></tr></table></figure><h2>ä¸å†Silently Fail</h2><p>ä¸¥æ ¼æ¨¡å¼ä¼šä½¿å¼•èµ·é™é»˜å¤±è´¥(silently fail,æ³¨:ä¸æŠ¥é”™ä¹Ÿæ²¡æœ‰ä»»ä½•æ•ˆæœ)çš„èµ‹å€¼æ“ä½œæŠ›å‡ºå¼‚å¸¸ã€‚</p><h3>ä¸å¯å˜é‡èµ‹å€¼</h3><p>ä¾‹å¦‚ï¼š NaN æ˜¯ä¸€ä¸ªä¸å¯å†™çš„å…¨å±€å˜é‡. åœ¨æ­£å¸¸æ¨¡å¼ä¸‹, ç»™ NaN èµ‹å€¼ä¸ä¼šäº§ç”Ÿä»»ä½•ä½œç”¨; å¼€å‘è€…ä¹Ÿä¸ä¼šå—åˆ°ä»»ä½•é”™è¯¯åé¦ˆ. ä½†åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹, ç»™ NaN èµ‹å€¼ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">'use strict'</span>;</span><br><span class="line"><span class="literal">NaN</span> = <span class="number">3</span>; <span class="comment">//TypeError: Cannot assign to read only property 'NaN' of #&lt;Object&gt;</span></span><br></pre></td></tr></table></figure><p>ç»™ä¸å¯å†™å±æ€§èµ‹å€¼, ç»™åªè¯»å±æ€§(getter-only)èµ‹å€¼èµ‹å€¼, ç»™ä¸å¯æ‰©å±•å¯¹è±¡(non-extensible object)çš„æ–°å±æ€§èµ‹å€¼) éƒ½ä¼šæŠ›å‡ºå¼‚å¸¸:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»™ä¸å¯å†™å±æ€§èµ‹å€¼</span></span><br><span class="line"><span class="keyword">var</span> obj1 = &#123;&#125;;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj1, <span class="string">"x"</span>, &#123;</span><br><span class="line">    value: <span class="number">42</span>,</span><br><span class="line">    writable: <span class="literal">false</span></span><br><span class="line">&#125;);</span><br><span class="line">obj1.x = <span class="number">9</span>; <span class="comment">// TypeError: Cannot assign to read only property 'x' of #&lt;Object&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»™åªè¯»å±æ€§èµ‹å€¼</span></span><br><span class="line"><span class="keyword">var</span> obj2 = &#123;</span><br><span class="line">    <span class="keyword">get</span> x() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">17</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">obj2.x = <span class="number">5</span>; <span class="comment">// TypeError: Cannot set property x of #&lt;Object&gt; which has only a getter</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»™ä¸å¯æ‰©å±•å¯¹è±¡çš„æ–°å±æ€§èµ‹å€¼</span></span><br><span class="line"><span class="keyword">var</span> fixed = &#123;&#125;;</span><br><span class="line"><span class="built_in">Object</span>.preventExtensions(fixed);</span><br><span class="line">fixed.newProp = <span class="string">"haha"</span>; <span class="comment">// TypeError: Can't add property newProp, object is not extensible</span></span><br></pre></td></tr></table></figure><h3>åˆ é™¤ä¸å¯åˆ é™¤å±æ€§</h3><p>åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹, è¯•å›¾åˆ é™¤ä¸å¯åˆ é™¤çš„å±æ€§æ—¶ä¼šæŠ›å‡ºå¼‚å¸¸(ä¹‹å‰è¿™ç§æ“ä½œä¸ä¼šäº§ç”Ÿä»»ä½•æ•ˆæœ)</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line"><span class="keyword">delete</span> <span class="built_in">Object</span>.prototype; <span class="comment">//TypeError: Cannot delete property 'prototype' of function Object()</span></span><br></pre></td></tr></table></figure><h3>å‚æ•°åå”¯ä¸€</h3><p>ä¸¥æ ¼æ¨¡å¼è¦æ±‚å‡½æ•°çš„å‚æ•°åå”¯ä¸€ã€‚åœ¨æ­£å¸¸æ¨¡å¼ä¸‹, æœ€åä¸€ä¸ªé‡åå‚æ•°åä¼šæ©ç›–ä¹‹å‰çš„é‡åå‚æ•°ã€‚ ä¹‹å‰çš„å‚æ•°ä»ç„¶å¯ä»¥é€šè¿‡ arguments[i] æ¥è®¿é—®ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">a, a, c</span>) </span>&#123; <span class="comment">//SyntaxError: Strict mode function may not have duplicate parameter names</span></span><br><span class="line"><span class="meta">    "use strict"</span>;</span><br><span class="line">    <span class="keyword">return</span> a + b + c;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3>ç¦æ­¢å…«è¿›åˆ¶æ•°å­—è¯­æ³•</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line"><span class="keyword">var</span> sum = <span class="number">015</span> + <span class="comment">// SyntaxError: Octal literals are not allowed in strict mode.</span></span><br><span class="line">          <span class="number">197</span> +</span><br><span class="line">          <span class="number">142</span>;</span><br></pre></td></tr></table></figure><h2>ç®€åŒ–å˜é‡çš„ä½¿ç”¨</h2><h3>ç¦ç”¨ with</h3><p>å…ˆçœ‹ä¸€ä¸ªwithçš„ä¾‹å­ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="number">17</span>;</span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    <span class="comment">//x: 4</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">with</span>(obj) &#123;</span><br><span class="line">    x = <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(x);</span><br></pre></td></tr></table></figure><p>ç»“æœæ˜¯2ï¼Œ withå—å†…xä¸ºå…¨å±€å˜é‡xã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="number">17</span>;</span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    x: <span class="number">4</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">with</span>(obj) &#123;</span><br><span class="line">    x = <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(x);</span><br></pre></td></tr></table></figure><p>ç»“æœæ˜¯17ï¼Œ withå—å†…xä¸ºå˜é‡obj.xã€‚</p><p>æ‰€ä»¥withä¸­å—å†…çš„xç©¶ç«Ÿæ˜¯æŒ‡å…¨å±€å˜é‡xè¿˜æ˜¯obj.xåœ¨è¿è¡Œä¹‹å‰æ˜¯æ— æ³•å¾—çŸ¥çš„ï¼Œè¿™å¯¹ç¼–è¯‘å™¨ä¼˜åŒ–ååˆ†ä¸åˆ©ï¼Œå› æ­¤ä¸¥æ ¼æ¨¡å¼ç¦ç”¨ withã€‚</p><h3>evalä½œç”¨åŸŸ</h3><p>ä¸¥æ ¼æ¨¡å¼ä¸‹çš„ eval ä¸åœ¨ä¸ºä¸Šå±‚èŒƒå›´(surrounding scope,æ³¨:åŒ…å›´evalä»£ç å—çš„èŒƒå›´)å¼•å…¥æ–°å˜é‡ã€‚</p><p>åœ¨æ­£å¸¸æ¨¡å¼ä¸‹,  ä»£ç  eval(â€œvar x;â€) ä¼šç»™ä¸Šå±‚å‡½æ•°(surrounding function)æˆ–è€…å…¨å±€å¼•å…¥ä¸€ä¸ªæ–°çš„å˜é‡ x ã€‚<br>ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œevalè¯­å¥æœ¬èº«å°±æ˜¯ä¸€ä¸ªä½œç”¨åŸŸï¼Œå®ƒæ‰€ç”Ÿæˆçš„å˜é‡åªèƒ½ç”¨äºevalå†…éƒ¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="number">17</span>;</span><br><span class="line"><span class="keyword">var</span> evalX = <span class="built_in">eval</span>(<span class="string">"'use strict'; var x = 32; x"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(x); <span class="comment">//17</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> y = <span class="number">17</span>;</span><br><span class="line"><span class="keyword">var</span> evalY = <span class="built_in">eval</span>(<span class="string">"var y = 32; y"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(y); <span class="comment">//32</span></span><br></pre></td></tr></table></figure><h3>ç¦æ­¢åˆ é™¤å£°æ˜å˜é‡</h3><p>ä¸¥æ ¼æ¨¡å¼ç¦æ­¢åˆ é™¤å£°æ˜å˜é‡ã€‚delete name åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ä¼šå¼•èµ·è¯­æ³•é”™è¯¯</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> x;</span><br><span class="line"><span class="keyword">delete</span> x; <span class="comment">// SyntaxError: Delete of an unqualified identifier in strict mode.</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">eval</span>(<span class="string">"var x; delete x;"</span>); <span class="comment">// SyntaxError</span></span><br></pre></td></tr></table></figure><h2>è®©evalå’Œargumentså˜çš„ç®€å•</h2><h3>ç»‘å®šæˆ–èµ‹å€¼</h3><p>eval å’Œ arguments ä¸èƒ½é€šè¿‡ç¨‹åºè¯­æ³•è¢«ç»‘å®šæˆ–èµ‹å€¼ã€‚ ä»¥ä¸‹çš„æ‰€æœ‰å°è¯•å°†å¼•èµ·è¯­æ³•é”™è¯¯:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line"><span class="built_in">eval</span> = <span class="number">17</span>;</span><br><span class="line"><span class="built_in">arguments</span>++;</span><br><span class="line">++<span class="built_in">eval</span>;</span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    <span class="keyword">set</span> p(arguments) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> <span class="built_in">eval</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;&#125; <span class="keyword">catch</span> (<span class="built_in">arguments</span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">x</span>(<span class="params">eval</span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">arguments</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="keyword">var</span> y = <span class="function"><span class="keyword">function</span> <span class="title">eval</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line"><span class="keyword">var</span> f = <span class="keyword">new</span> <span class="built_in">Function</span>(<span class="string">"arguments"</span>, <span class="string">"'use strict'; return 17;"</span>);</span><br></pre></td></tr></table></figure><h3>argumentså¯¹è±¡</h3><p>argumentså¯¹è±¡ä¸å†è¿½è¸ªå‚æ•°çš„å˜åŒ–</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">a</span>) </span>&#123;</span><br><span class="line"><span class="meta">    "use strict"</span>;</span><br><span class="line">    a = <span class="number">42</span>;</span><br><span class="line">    <span class="keyword">return</span> [a, <span class="built_in">arguments</span>[<span class="number">0</span>]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> pair = f(<span class="number">17</span>);</span><br><span class="line"><span class="built_in">console</span>.assert(pair[<span class="number">0</span>] === <span class="number">42</span>);</span><br><span class="line"><span class="built_in">console</span>.assert(pair[<span class="number">1</span>] === <span class="number">17</span>);</span><br></pre></td></tr></table></figure><h3>ä¸å†æ”¯æŒ arguments.callee</h3><p>æ­£å¸¸æ¨¡å¼ä¸‹ï¼Œarguments.callee æŒ‡å‘å½“å‰æ­£åœ¨æ‰§è¡Œçš„å‡½æ•°ã€‚è¿™ä¸ªä½œç”¨å¾ˆå°ï¼šç›´æ¥ç»™æ‰§è¡Œå‡½æ•°å‘½åå°±å¯ä»¥äº†ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line"><span class="keyword">var</span> f = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="built_in">arguments</span>.callee; &#125;;</span><br><span class="line">f(); <span class="comment">// TypeError: 'caller', 'callee', and 'arguments' properties may not be accessed on strict mode functions or the arguments objects for calls to them</span></span><br></pre></td></tr></table></figure><h2>â€œå®‰å…¨çš„â€ JavaScript</h2><p>ä¸¥æ ¼æ¨¡å¼ä¸‹æ›´å®¹æ˜“å†™å‡ºâ€œå®‰å…¨â€çš„JavaScriptã€‚</p><h3>thiså…³é”®å­—</h3><p>åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹é€šè¿‡thisä¼ é€’ç»™ä¸€ä¸ªå‡½æ•°çš„å€¼ä¸ä¼šè¢«å¼ºåˆ¶è½¬æ¢ä¸ºä¸€ä¸ªå¯¹è±¡ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;ã€€ã€€ã€€ã€€</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>);ã€€ã€€</span><br><span class="line">&#125;ã€€</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params"></span>) </span>&#123;ã€€ã€€ã€€ã€€</span><br><span class="line"><span class="meta">    "use strict"</span>;ã€€ã€€ã€€ã€€</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">f.bind(<span class="number">3</span>)();  <span class="comment">//[Number: 3]</span></span><br><span class="line">f1.bind(<span class="number">3</span>)();  <span class="comment">//3</span></span><br></pre></td></tr></table></figure><p>å¯¹ä¸€ä¸ªæ™®é€šçš„å‡½æ•°æ¥è¯´ï¼Œthisæ€»ä¼šæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼šä¸ç®¡è°ƒç”¨æ—¶thiså®ƒæœ¬æ¥å°±æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼›è¿˜æ˜¯ç”¨å¸ƒå°”å€¼ï¼Œå­—ç¬¦ä¸²æˆ–è€…æ•°å­—è°ƒç”¨å‡½æ•°æ—¶å‡½æ•°é‡Œé¢è¢«å°è£…æˆå¯¹è±¡çš„thisï¼›è¿˜æ˜¯ä½¿ç”¨undefinedæˆ–è€…nullè°ƒç”¨å‡½æ•°æ—¶thisä»£è¡¨çš„å…¨å±€å¯¹è±¡ï¼ˆä½¿ç”¨call, applyæˆ–è€…bindæ–¹æ³•æ¥æŒ‡å®šä¸€ä¸ªç¡®å®šçš„thisï¼‰ã€‚</p><p>è¿™ç§è‡ªåŠ¨è½¬åŒ–ä¸ºå¯¹è±¡çš„è¿‡ç¨‹ä¸ä»…æ˜¯ä¸€ç§æ€§èƒ½ä¸Šçš„æŸè€—ï¼ŒåŒæ—¶åœ¨æµè§ˆå™¨ä¸­æš´éœ²å‡ºå…¨å±€å¯¹è±¡ä¹Ÿä¼šæˆä¸ºå®‰å…¨éšæ‚£ã€‚</p><p>æ‰€ä»¥å¯¹äºä¸€ä¸ªå¼€å¯ä¸¥æ ¼æ¨¡å¼çš„å‡½æ•°ï¼ŒæŒ‡å®šçš„thisä¸å†è¢«å°è£…ä¸ºå¯¹è±¡ï¼Œè€Œä¸”å¦‚æœæ²¡æœ‰æŒ‡å®šthisçš„è¯å®ƒå€¼æ˜¯undefinedã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="keyword">this</span>; &#125;</span><br><span class="line">assert(fun() === <span class="literal">undefined</span>);</span><br><span class="line">assert(fun.call(<span class="number">2</span>) === <span class="number">2</span>);</span><br><span class="line">assert(fun.apply(<span class="literal">null</span>) === <span class="literal">null</span>);</span><br><span class="line">assert(fun.call(<span class="literal">undefined</span>) === <span class="literal">undefined</span>);</span><br><span class="line">assert(fun.bind(<span class="literal">true</span>)() === <span class="literal">true</span>);</span><br></pre></td></tr></table></figure><h2>ä¸ºæœªæ¥çš„ECMAScriptç‰ˆæœ¬é“ºå¹³é“è·¯</h2><h3>ä¿ç•™çš„å…³é”®å­—</h3><p>åœ¨ä¸¥æ ¼æ¨¡å¼ä¸­ä¸€éƒ¨åˆ†å­—ç¬¦å˜æˆäº†ä¿ç•™çš„å…³é”®å­—ã€‚è¿™äº›å­—ç¬¦åŒ…æ‹¬implements, interface, let, package, private, protected, public,<br>staticå’Œyieldã€‚åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œä½ ä¸èƒ½å†ç”¨è¿™äº›åå­—ä½œä¸ºå˜é‡åæˆ–è€…å½¢å‚åã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">package</span>(<span class="params">protected</span>) // !!!</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">    "use strict"</span>;</span><br><span class="line">    <span class="keyword">var</span> implements; <span class="comment">// !!!</span></span><br><span class="line"></span><br><span class="line">    interface: <span class="comment">// !!!</span></span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span> interface; <span class="comment">// !!!</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">private</span>(<span class="params"></span>) </span>&#123;&#125; <span class="comment">// !!!</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun</span>(<span class="params">static</span>) </span>&#123;</span><br><span class="line"><span class="meta">    'use strict'</span>;</span><br><span class="line">&#125; <span class="comment">// !!!</span></span><br></pre></td></tr></table></figure><h3>å‡½æ•°å£°æ˜</h3><p>ä¸¥æ ¼æ¨¡å¼åªå…è®¸åœ¨å…¨å±€ä½œç”¨åŸŸæˆ–å‡½æ•°ä½œç”¨åŸŸçš„é¡¶å±‚å£°æ˜å‡½æ•°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸å…è®¸åœ¨éå‡½æ•°çš„ä»£ç å—å†…å£°æ˜å‡½æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="literal">true</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123; &#125; <span class="comment">// !!! è¯­æ³•é”™è¯¯</span></span><br><span class="line">  f();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">f2</span>(<span class="params"></span>) </span>&#123; &#125; <span class="comment">// !!! è¯­æ³•é”™è¯¯</span></span><br><span class="line">  f2();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">baz</span>(<span class="params"></span>) // åˆæ³•</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">eit</span>(<span class="params"></span>) </span>&#123; &#125; <span class="comment">// åŒæ ·åˆæ³•</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>æ€»ç»“</h1><p>ä¸¥æ ¼æ¨¡å¼è™½ç„¶é™åˆ¶äº†ä¸€éƒ¨åˆ†JavaScriptä¹¦å†™å’Œè¿è¡Œçš„è‡ªç”±ï¼Œä½†æ˜¯éšç€JavaScriptåœ¨æ›´å¤§çš„å·¥ç¨‹ä¸­æ‰®æ¼”æ›´é‡è¦çš„è§’è‰²ï¼Œè§„èŒƒåŒ–æ˜¯å¿…ç»ä¹‹è·¯ã€‚</p><h1>å‚è€ƒé“¾æ¥</h1><ul><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Strict_mode" target="_blank" rel="noopener">MDNä¸¥æ ¼æ¨¡å¼</a></li><li><a href="http://www.ruanyifeng.com/blog/2013/01/javascript_strict_mode.html" target="_blank" rel="noopener">Javascript ä¸¥æ ¼æ¨¡å¼è¯¦è§£</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;ç®€ä»‹&lt;/h1&gt;
&lt;p&gt;ECMAScript 5 å¼•å…¥äº†ä¸¥æ ¼æ¨¡å¼ï¼ˆstrict modeï¼‰çš„æ¦‚å¿µã€‚ä¸¥æ ¼æ¨¡å¼ä¸ºJavaScriptå®šä¹‰äº†ä¸€ç§ä¸åŒçš„è§£æä¸æ‰§è¡Œæ¨¡å‹ã€‚åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼ŒECMAScript 3ä¸­çš„ä¸€äº›ä¸ç¡®å®šçš„è¡Œä¸ºå°†å¾—åˆ°å¤„ç†ï¼Œè€Œä¸”å¯¹äºæŸäº›ä¸å®‰å…¨çš„æ“ä½œä¹Ÿä¼šæŠ›å‡ºé”™è¯¯ã€‚ï¼ˆ&lt;a href=&quot;https://github.com/Leo555/JavaScript/blob/master/books/JavaScript%E9%AB%98%E7%BA%A7%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%EF%BC%88%E7%AC%AC3%E7%89%88%EF%BC%89%E3%80%91%E4%B8%AD%E6%96%87%20%E9%AB%98%E6%B8%85%20%E5%AE%8C%E6%95%B4%20%E8%AF%A6%E7%BB%86%E4%B9%A6%E7%AD%BE%E7%89%88.pdf&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;JavaScripté«˜çº§ç¨‹åºè®¾è®¡&lt;/a&gt;ï¼‰&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="https://lz5z.com/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>JavaScript é€’å½’ä¼˜åŒ–</title>
    <link href="https://lz5z.com/JavaScript%E9%80%92%E5%BD%92%E4%BC%98%E5%8C%96/"/>
    <id>https://lz5z.com/JavaScripté€’å½’ä¼˜åŒ–/</id>
    <published>2016-11-03T00:35:34.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h1>èƒŒæ™¯</h1><p>åœ¨ä¹‹å‰çš„é¡¹ç›® <strong>Regional Guideline</strong> ä¸­ï¼Œæœ‰ä¸€ä¸ªæ“ä½œç‚¹å‡» Ext æ ‘çš„ä¸€ä¸ªç»“ç‚¹ï¼Œå±•å¼€è¿™ä¸ªç»“ç‚¹çš„å…¨éƒ¨å­æ ‘ï¼ˆæ ‘çš„æ·±åº¦æœªçŸ¥ï¼‰ï¼Œåˆšå¼€å§‹çœ‹åˆ° TreeNode ä¸­æœ‰ä¸€ä¸ªåä¸º expand çš„ Public Methodï¼Œ å…¶APIå¦‚ä¸‹ï¼š</p><p><img src="http://i1.piimg.com/567571/c1346477e1e277a6.png" alt><br>[å…¬å¸ä½¿ç”¨çš„ç‰ˆæœ¬ä¸ºExtJS 3.3]</p><a id="more"></a><p>ç®€å•æ˜äº†ï¼Œexpand ç¬¬ä¸€ä¸ªå‚æ•° deep æ˜¯ä¸€ä¸ª Boolean å‹å‚æ•°ï¼Œå¦‚æœä¸ºtrueçš„è¯ï¼Œå°±å±•å¼€å½“å‰ç»“ç‚¹ä»¥åŠå­ç»“ç‚¹çš„æ‰€æœ‰å­ç»“ç‚¹ã€‚</p><p>äºæ˜¯æ²¡æœ‰å¤šåŠ æ€è€ƒå°±ç”¨äº†ã€‚åœ¨å¼€å‘æµ‹è¯•ç¯èŠ‚ä¸€ç›´æ²¡æœ‰å‡ºç°ä»€ä¹ˆé—®é¢˜ï¼Œå¯æ˜¯åˆ°äº† Production æµ‹è¯•ï¼Œå¸®å¿™æµ‹è¯•çš„åŒå­¦å‘ç°ï¼š åœ¨æ“ä½œæ ‘çš„æ—¶å€™ï¼Œæœ‰æ—¶å€™æµè§ˆå™¨ä¼šå´©æºƒã€‚åˆšå¼€å§‹ä»¥ä¸ºæ˜¯ç‰¹æ®Šæƒ…å†µï¼Œæµè§ˆå™¨é—®é¢˜ä¹‹ç±»çš„ï¼Œæ²¡æœ‰åœ¨æ„ã€‚å¯æ˜¯ä¸æ–­åœ°æµ‹è¯•å‘ç°æµè§ˆå™¨å´©æºƒçš„æƒ…å†µæ˜¯å¯å¤ç°çš„ï¼Œå°±æ˜¯åœ¨æŸå‡ ä¸ªå›ºå®šçš„æ ‘å±•å¼€çš„æ—¶å€™ä¼šå‡ºç°è¿™ä¸ªé—®é¢˜ã€‚å¯è§è¿™ä¸æ˜¯æµè§ˆå™¨çš„é—®é¢˜ï¼Œæ˜¯æˆ‘ä»£ç çš„é—®é¢˜ã€‚</p><p>æ’æŸ¥ä»£ç ï¼Œå‘ç°è¿™ä¸ª expand æ–¹æ³•ä¼¼ä¹æ˜¯ç½ªé­ç¥¸é¦–ã€‚æŸ¥çœ‹ExtJSæºç ï¼Œæœç„¶æ˜¯è¿™ä¸ªå®¶ä¼™çš„é—®é¢˜ï¼ŒåŸæ¥è¿™ä¸ªå‡½æ•°ä½¿ç”¨é€’å½’çš„æ–¹å¼å»å±•å¼€æ‰€æœ‰çš„å­ç»“ç‚¹ï¼Œè€Œå½“å­ç»“ç‚¹æ¯”è¾ƒå¤šçš„æ—¶å€™ï¼Œå†…å­˜å’ŒCPUçš„æ¶ˆè€—å˜å¾—éå¸¸å¤§ï¼Œäºæ˜¯æµè§ˆå™¨å°±å´©æºƒäº†ã€‚</p><h1>åˆ†æé—®é¢˜</h1><p>é¦–å…ˆæŸ¥çœ‹ ExtJS æºç ï¼Œ TreeNode ä¸­çš„ expand æ–¹æ³•çš„æºç å¦‚ä¸‹</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Expand this node.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Boolean&#125;</span> </span>deep (optional) True to expand all children as well</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Boolean&#125;</span> </span>anim (optional) false to cancel the default animation</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Function&#125;</span> </span>callback (optional) A callback to be called when</span></span><br><span class="line"><span class="comment"> * expanding this node completes (does not wait for deep expand to complete).</span></span><br><span class="line"><span class="comment"> * Called with 1 parameter, this node.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Object&#125;</span> </span>scope (optional) The scope (this reference) in which the callback is executed. Defaults to this TreeNode.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">expand : <span class="function"><span class="keyword">function</span>(<span class="params">deep, anim, callback, scope</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">this</span>.expanded)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.fireEvent(<span class="string">'beforeexpand'</span>, <span class="keyword">this</span>, deep, anim) === <span class="literal">false</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">this</span>.childrenRendered)&#123;</span><br><span class="line">            <span class="keyword">this</span>.renderChildren();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.expanded = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">this</span>.isHiddenRoot() &amp;&amp; (<span class="keyword">this</span>.getOwnerTree().animate &amp;&amp; anim !== <span class="literal">false</span>) || anim)&#123;</span><br><span class="line">            <span class="keyword">this</span>.ui.animExpand(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                <span class="keyword">this</span>.fireEvent(<span class="string">'expand'</span>, <span class="keyword">this</span>);</span><br><span class="line">                <span class="keyword">this</span>.runCallback(callback, scope || <span class="keyword">this</span>, [<span class="keyword">this</span>]);</span><br><span class="line">                <span class="keyword">if</span>(deep === <span class="literal">true</span>)&#123;</span><br><span class="line">                    <span class="keyword">this</span>.expandChildNodes(<span class="literal">true</span>, <span class="literal">true</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;.createDelegate(<span class="keyword">this</span>));</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.ui.expand();</span><br><span class="line">            <span class="keyword">this</span>.fireEvent(<span class="string">'expand'</span>, <span class="keyword">this</span>);</span><br><span class="line">            <span class="keyword">this</span>.runCallback(callback, scope || <span class="keyword">this</span>, [<span class="keyword">this</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">       <span class="keyword">this</span>.runCallback(callback, scope || <span class="keyword">this</span>, [<span class="keyword">this</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(deep === <span class="literal">true</span>)&#123;</span><br><span class="line">        <span class="keyword">this</span>.expandChildNodes(<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>expandChildNodes çš„æºç å¦‚ä¸‹</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Expand all child nodes</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Boolean&#125;</span> </span>deep (optional) true if the child nodes should also expand their child nodes</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">expandChildNodes : <span class="function"><span class="keyword">function</span>(<span class="params">deep, anim</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> cs = <span class="keyword">this</span>.childNodes,</span><br><span class="line">        i,</span><br><span class="line">        len = cs.length;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">            cs[i].expand(deep, anim);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹è°ƒç”¨å…³ç³»ï¼Œå‘ç° expand æ–¹æ³•å¦‚æœä¼ å‚ deep = true çš„è¯ä¼šè°ƒç”¨ expandChildNodes æ–¹æ³•å»å±•å¼€å½“å‰ç»“ç‚¹çš„å­ç»“ç‚¹ï¼Œè€Œ expandChildNodes æ–¹æ³•åˆè°ƒç”¨ expand  æ–¹æ³•é€ä¸ªå±•å¼€å­ç»“ç‚¹çš„æ‰€æœ‰å­ç»“ç‚¹ã€‚ è¿™æ ·å°±å˜æˆäº†é€’å½’ã€‚</p><h2>è¯´è¯´é€’å½’</h2><p>å‡è®¾æœ‰ä¸€ä¸ªæ±‚å’Œå‡½æ•°sumï¼š sum(n) = âˆ‘ k</p><h3>å¾ªç¯</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> result = n;</span><br><span class="line">  <span class="keyword">while</span> (n &gt; <span class="number">1</span>) &#123;</span><br><span class="line">    result += --n;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾ªç¯è‡ªç„¶æ˜¯é€Ÿåº¦å’Œæ€§èƒ½æœ€å¥½çš„ï¼Œä½†æ˜¯åœ¨ç¼–å†™å¤æ‚çš„ä»£ç æ—¶ï¼Œå¾ªç¯ä»£ç çš„æ•°å­¦æè¿°æ€§ä¸å¤Ÿå¼ºã€‚</p><h3>æ™®é€šé€’å½’</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (n === <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> n + sum(--n);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä¸Šè¿°é€’å½’çš„æ–¹å¼å¯ä»¥è¯´æ˜¯å°†ä»£ç ä¸æ•°å­¦æè¿°å®Œç¾ç»“åˆï¼Œä»¥ä¸Šä»£ç ç»™ä¸€ä¸ªå®Œå…¨ä¸æ‡‚ç¼–ç¨‹çš„äººä¹Ÿçœ‹å¾—æ‡‚ã€‚</p><p>ä½†æ˜¯æˆ‘ä»¬åˆ†æå…¶è®¡ç®—è¿‡ç¨‹ï¼Œæ¯”å¦‚è®¡ç®—sum(5)çš„æ—¶å€™ï¼Œå…¶è®¡ç®—è¿‡ç¨‹æ˜¯è¿™æ ·çš„:</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sum(<span class="number">5</span>)</span><br><span class="line">(<span class="number">5</span> + sum(<span class="number">4</span>))</span><br><span class="line">(<span class="number">5</span> + (<span class="number">4</span> + sum(<span class="number">3</span>)))</span><br><span class="line">(<span class="number">5</span> + (<span class="number">4</span> + (<span class="number">3</span> + sum(<span class="number">2</span>))))</span><br><span class="line">(<span class="number">5</span> + (<span class="number">4</span> + (<span class="number">3</span> + (<span class="number">2</span> + sum(<span class="number">1</span>)))))</span><br><span class="line">(<span class="number">5</span> + (<span class="number">4</span> + (<span class="number">3</span> + (<span class="number">2</span> + <span class="number">1</span>))))</span><br><span class="line">(<span class="number">5</span> + (<span class="number">4</span> + (<span class="number">3</span> + (<span class="number">3</span>))))</span><br><span class="line">(<span class="number">5</span> + (<span class="number">4</span> + (<span class="number">6</span>))</span><br><span class="line">(<span class="number">5</span> + <span class="number">10</span>)</span><br><span class="line"><span class="number">15</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·çš„è®¡ç®—æœ‰ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬çŸ¥é“çº¿ç¨‹åœ¨æ‰§è¡Œä»£ç çš„æ—¶å€™ï¼Œè®¡ç®—æœºä¼šåˆ†é…ä¸€å®šå¤§å°çš„æ ˆç©ºé—´ï¼Œæ¯æ¬¡æ–¹æ³•è°ƒç”¨æ—¶éƒ½ä¼šåœ¨æ ˆé‡Œå‚¨å­˜ä¸€å®šä¿¡æ¯ï¼ˆå¦‚å‚æ•°ã€å±€éƒ¨å˜é‡ã€è¿”å›åœ°å€ã€è°ƒç”¨ä½ç½®ç­‰ç­‰ï¼‰ï¼Œè¿™äº›ä¿¡æ¯ä¼šå ç”¨ä¸€å®šç©ºé—´ï¼Œæˆåƒä¸Šä¸‡ä¸ªæ­¤ç±»ç©ºé—´ç´¯ç§¯èµ·æ¥ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ ˆæº¢å‡ºã€‚</p><h3>å°¾é€’å½’</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">x, total = <span class="number">0</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x === <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> x + total;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum(--x, x + total);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è®¡ç®— sum(5)çš„æ—¶å€™ï¼Œå…¶è¿‡ç¨‹æ˜¯è¿™æ ·çš„:</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">sum</span><span class="params">(<span class="number">5</span>, <span class="number">0</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">sum</span><span class="params">(<span class="number">4</span>, <span class="number">5</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">sum</span><span class="params">(<span class="number">3</span>, <span class="number">9</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">sum</span><span class="params">(<span class="number">2</span>, <span class="number">12</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">sum</span><span class="params">(<span class="number">1</span>, <span class="number">14</span>)</span></span></span><br><span class="line"><span class="number">15</span></span><br></pre></td></tr></table></figure><p>sum() å‡½æ•°å¤šäº†ä¸€ä¸ª total å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°è®°å½•åœ¨é€’å½’è°ƒç”¨æ—¶ä¸Šä¸€æ¬¡è®¡ç®—çš„ç»“æœï¼Œå¹¶å°†å…¶ä¼ å…¥ä¸‹ä¸€æ¬¡é€’å½’è°ƒç”¨ä¸­ã€‚æ¯ä¸€æ¬¡å‡½æ•°è°ƒç”¨éƒ½å‘ç”Ÿåœ¨å‡½æ•°æœ€åä¸€æ­¥æ“ä½œï¼Œæ‰€ä»¥ä¸éœ€è¦ä¿ç•™å¤–å±‚å‡½æ•°çš„è°ƒç”¨è®°å½•ï¼Œå› ä¸ºè°ƒç”¨ä½ç½®ã€å†…éƒ¨å˜é‡ç­‰ä¿¡æ¯éƒ½ä¸ä¼šå†ç”¨åˆ°äº†ï¼Œåªè¦ç›´æ¥ç”¨å†…å±‚å‡½æ•°çš„è°ƒç”¨è®°å½•ï¼Œå–ä»£å¤–å±‚å‡½æ•°çš„è°ƒç”¨è®°å½•å°±å¯ä»¥äº†ã€‚</p><p>å‡½æ•°åœ¨å°¾éƒ¨è°ƒç”¨è‡ªèº«ï¼Œå°±ç§°ä¸ºå°¾é€’å½’ã€‚</p><p>å°¾é€’å½’çš„æœ¬è´¨ï¼Œå…¶å®æ˜¯å°†é€’å½’æ–¹æ³•ä¸­çš„éœ€è¦çš„â€œæ‰€æœ‰çŠ¶æ€â€é€šè¿‡æ–¹æ³•çš„å‚æ•°ä¼ å…¥ä¸‹ä¸€æ¬¡è°ƒç”¨ä¸­ã€‚</p><p>ä¸æ™®é€šé€’å½’ç›¸æ¯”ï¼Œç”±äºå°¾é€’å½’çš„è°ƒç”¨å¤„äºæ–¹æ³•çš„æœ€åï¼Œå› æ­¤æ–¹æ³•ä¹‹å‰æ‰€ç§¯ç´¯ä¸‹çš„å„ç§çŠ¶æ€å¯¹äºé€’å½’è°ƒç”¨ç»“æœå·²ç»æ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œå› æ­¤å®Œå…¨å¯ä»¥æŠŠæœ¬æ¬¡æ–¹æ³•ä¸­ç•™åœ¨å †æ ˆä¸­çš„æ•°æ®å®Œå…¨æ¸…é™¤ï¼ŒæŠŠç©ºé—´è®©ç»™æœ€åçš„é€’å½’è°ƒç”¨ã€‚è¿™æ ·çš„ä¼˜åŒ–ä½¿å¾—é€’å½’ä¸ä¼šåœ¨è°ƒç”¨å †æ ˆä¸Šäº§ç”Ÿå †ç§¯ï¼Œæ„å‘³ç€å³ä½¿æ˜¯â€œæ— é™â€é€’å½’ä¹Ÿä¸ä¼šè®©å †æ ˆæº¢å‡ºã€‚è¿™ä¾¿æ˜¯å°¾é€’å½’çš„ä¼˜åŠ¿ã€‚</p><h2>ES6 å¯¹å°¾é€’å½’çš„æ”¯æŒ</h2><p>ES6 ä¸­å°†ä¼šèµ„ç£zÄ«cÃ­å°¾é€’å½’ä¼˜åŒ–ï¼Œé€šè¿‡å°¾é€’å½’ä¼˜åŒ–ï¼ŒJavaScript ä»£ç åœ¨è§£é‡Šæˆæœºå™¨ç çš„æ—¶å€™ï¼Œä¼šå°†å°¾é€’å½’å‡½æ•°è§£é‡Šæˆ while å‡½æ•°ï¼Œè¾¾åˆ°å†™çš„æ—¶å€™è¡¨è¾¾æ€§å¼ºï¼Œè¿è¡Œçš„æ—¶å€™é€Ÿåº¦é«˜çš„æ•ˆæœã€‚</p><p>ä¸‹é¢æ¥çœ‹ Babel ç¼–è¯‘çš„æ•ˆæœï¼Œå°†ä¸Šè¿°ä¸ºé€’å½’çš„ sum å‡½æ•°ç¼–è¯‘åå¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">_x2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> _arguments = <span class="built_in">arguments</span>;</span><br><span class="line">    <span class="keyword">var</span> _again = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    _function: <span class="keyword">while</span> (_again) &#123;</span><br><span class="line">        <span class="keyword">var</span> x = _x2;</span><br><span class="line">        _again = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">var</span> total = _arguments.length &lt;= <span class="number">1</span> || _arguments[<span class="number">1</span>] === <span class="literal">undefined</span> ? <span class="number">0</span> : _arguments[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (x === <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> x + total;</span><br><span class="line">        &#125;</span><br><span class="line">        _arguments = [_x2 = --x, x + total];</span><br><span class="line">        _again = <span class="literal">true</span>;</span><br><span class="line">        total = <span class="literal">undefined</span>;</span><br><span class="line">        <span class="keyword">continue</span> _function;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2>ä¸¥æ ¼æ¨¡å¼</h2><p>ES6çš„å°¾é€’å½’ä¼˜åŒ–åªåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹å¼€å¯ï¼Œæ­£å¸¸æ¨¡å¼æ˜¯æ— æ•ˆçš„ã€‚<br>è¿™æ˜¯å› ä¸ºåœ¨æ­£å¸¸æ¨¡å¼ä¸‹ï¼Œå‡½æ•°å†…éƒ¨æœ‰ä¸¤ä¸ªå˜é‡ï¼Œå¯ä»¥è·Ÿè¸ªå‡½æ•°çš„è°ƒç”¨æ ˆã€‚</p><pre><code>* argumentsï¼šè¿”å›è°ƒç”¨æ—¶å‡½æ•°çš„å‚æ•°ã€‚* func.callerï¼šè¿”å›è°ƒç”¨å½“å‰å‡½æ•°çš„é‚£ä¸ªå‡½æ•°ã€‚</code></pre><p>å°¾è°ƒç”¨ä¼˜åŒ–å‘ç”Ÿæ—¶ï¼Œå‡½æ•°çš„è°ƒç”¨æ ˆä¼šæ”¹å†™ï¼Œå› æ­¤ä¸Šé¢ä¸¤ä¸ªå˜é‡å°±ä¼šå¤±çœŸã€‚ä¸¥æ ¼æ¨¡å¼ç¦ç”¨è¿™ä¸¤ä¸ªå˜é‡ï¼Œæ‰€ä»¥å°¾è°ƒç”¨æ¨¡å¼ä»…åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ç”Ÿæ•ˆã€‚</p><h1>è§£å†³é—®é¢˜</h1><p>å›åˆ°æœ€æ—©çš„é—®é¢˜ï¼Œå¦‚ä½•é«˜æ•ˆåœ°å±•å¼€ä¸€æ£µä¸çŸ¥æ·±æµ…çš„æ ‘ï¼Ÿ</p><p>å½“æ—¶å¹¶æ²¡æœ‰å°¾é€’å½’æ–¹é¢çš„çŸ¥è¯†ï¼Œè€Œä¸”æ”¹ Ext æºç ä¹Ÿä¸æ˜¯é‚£ä¹ˆæ–¹ä¾¿ï¼Œäºæ˜¯é€šè¿‡ Google çŸ¥é“äº†ä¸€ä¸ªæ¯”è¾ƒå¥½çš„è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨æ ˆä»£æ›¿é€’å½’ã€‚</p><p>æ€ä¹ˆåšå‘¢ï¼Ÿ</p><p>è¦å±•å¼€ä¸€æ£µæ ‘ï¼Œé¦–å…ˆå°†æ ‘çš„æ ¹ç»“ç‚¹å…¥æ ˆï¼Œç„¶åä¸€ä¸ªèŠ‚ç‚¹ä¸€ä¸ªèŠ‚ç‚¹å‡ºæ ˆï¼Œæ¯æ¬¡å‡ºæ ˆåï¼Œå°†å‡ºæ ˆèŠ‚ç‚¹çš„æ‰€æœ‰å­èŠ‚ç‚¹å…¥æ ˆï¼Œä»¥æ­¤è¾¾åˆ°éå†ä¸€é¢—æ ‘çš„æ•ˆæœã€‚å‡ºæ ˆçš„è¿‡ç¨‹ä¸­é€ä¸€å±•å¼€å½“å‰èŠ‚ç‚¹çš„å­—ç»“ç‚¹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">expandAllChildNodes: <span class="function"><span class="keyword">function</span>(<span class="params">node</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> nodeStack = [];</span><br><span class="line">    nodeStack.push(node);</span><br><span class="line">    <span class="keyword">while</span> (nodeStack.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> nodeTop = nodeStack.pop();</span><br><span class="line">        <span class="keyword">if</span> (nodeTop.hasChildNodes()) &#123;</span><br><span class="line">            nodeTop.expand();</span><br><span class="line">            nodeStack = nodeStack.concat(nodeTop.childNodes);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ–¹æ³•å°†é€’å½’è½¬åŒ–ä¸ºæ ˆï¼Œå¯è¯»æ€§ä¹Ÿä¸æ˜¯å¾ˆå·®ï¼Œç®—æ˜¯ä¸€ä¸ªä¸é”™çš„è§£å†³æ–¹æ¡ˆã€‚æµ‹è¯•å‘ç°ä¹‹å‰å‡ ä¸ªå¯¼è‡´æµè§ˆå™¨å´©æºƒçš„æ ‘éƒ½å¯ä»¥å®Œç¾å±•å¼€ï¼ŒO(âˆ©_âˆ©)O~~ã€‚</p><h1>æ€»ç»“</h1><p>é€’å½’æœ¬è´¨ä¸Šæ˜¯ä¸€ç§å¾ªç¯æ“ä½œã€‚çº¯ç²¹çš„å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€æ²¡æœ‰å¾ªç¯æ“ä½œå‘½ä»¤ï¼Œæ‰€æœ‰çš„å¾ªç¯éƒ½ç”¨é€’å½’å®ç°ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå°¾é€’å½’å¯¹è¿™äº›è¯­è¨€æå…¶é‡è¦ã€‚</p><p>å¾ªç¯ä»£è¡¨ç€é«˜æ•ˆï¼Œé€’å½’ä»£è¡¨ç€æ˜“è¯»ï¼Œå¦‚æœèƒ½å°†é€’å½’æ–¹ä¾¿åœ°è½¬åŒ–ä¸ºå¾ªç¯æ˜¯æƒ³å¿…é‚£æ˜¯æå¥½çš„ï¼Œå¯æ˜¯å¦‚æœè½¬åŒ–ä¸æ˜¯é‚£ä¹ˆæ–¹ä¾¿çš„è¯ï¼Œå°½é‡ä½¿ç”¨å°¾é€’å½’ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;èƒŒæ™¯&lt;/h1&gt;
&lt;p&gt;åœ¨ä¹‹å‰çš„é¡¹ç›® &lt;strong&gt;Regional Guideline&lt;/strong&gt; ä¸­ï¼Œæœ‰ä¸€ä¸ªæ“ä½œç‚¹å‡» Ext æ ‘çš„ä¸€ä¸ªç»“ç‚¹ï¼Œå±•å¼€è¿™ä¸ªç»“ç‚¹çš„å…¨éƒ¨å­æ ‘ï¼ˆæ ‘çš„æ·±åº¦æœªçŸ¥ï¼‰ï¼Œåˆšå¼€å§‹çœ‹åˆ° TreeNode ä¸­æœ‰ä¸€ä¸ªåä¸º expand çš„ Public Methodï¼Œ å…¶APIå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://i1.piimg.com/567571/c1346477e1e277a6.png&quot; alt&gt;&lt;br&gt;
[å…¬å¸ä½¿ç”¨çš„ç‰ˆæœ¬ä¸ºExtJS 3.3]&lt;/p&gt;
    
    </summary>
    
      <category term="Algorithm" scheme="https://lz5z.com/categories/Algorithm/"/>
    
    
      <category term="JavaScript" scheme="https://lz5z.com/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>JavaScript å¼‚æ­¥è§£å†³æ–¹æ¡ˆ async/await</title>
    <link href="https://lz5z.com/JavaScript%E5%BC%82%E6%AD%A5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/"/>
    <id>https://lz5z.com/JavaScriptå¼‚æ­¥è§£å†³æ–¹æ¡ˆ/</id>
    <published>2016-11-01T22:54:01.000Z</published>
    <updated>2020-04-21T10:23:54.827Z</updated>
    
    <content type="html"><![CDATA[<h1>ç®€ä»‹</h1><p>å¼‚æ­¥æ“ä½œä¸€ç›´éƒ½æ˜¯ JavaScript ä¸­ä¸€ä¸ªæ¯”è¾ƒéº»çƒ¦çš„äº‹æƒ…ï¼Œä»æœ€æ—©çš„ callback hellï¼Œåˆ°TJå¤§ç¥çš„ coï¼Œå†åˆ° Promise å¯¹è±¡ï¼Œç„¶åES6ä¸­çš„ Generator å‡½æ•°ï¼Œæ¯æ¬¡éƒ½æœ‰æ‰€æ”¹è¿›ï¼Œä½†éƒ½ä¸æ˜¯é‚£ä¹ˆå½»åº•ï¼Œè€Œä¸”ç†è§£èµ·æ¥æ€»æ˜¯å¾ˆå¤æ‚ã€‚</p><p>ç›´åˆ° async/await å‡ºç°ï¼Œè®©å†™å¼‚æ­¥çš„äººæ ¹æœ¬ä¸ç”¨å…³å¿ƒå®ƒæ˜¯ä¸æ˜¯å¼‚æ­¥ï¼Œå¯ä»¥è¯´æ˜¯ç›®å‰æœ€å¥½çš„ JavaScript å¼‚æ­¥è§£å†³æ–¹æ¡ˆã€‚</p><a id="more"></a><p>ECMAScript 2016(ES7) ä¸­å·²ç»ç¡®å®šæ”¯æŒ async/awaitï¼Œé‚£æˆ‘ä»¬æ€ä¹ˆèƒ½å¤Ÿè½åå‘¢ï¼Ÿ</p><p>æœ¬æ–‡æ˜¯ async/await çš„å­¦ä¹ ç¬”è®°ï¼Œæ¶µç›–åŸºæœ¬ç”¨æ³•ä»¥åŠä¸€äº›å° demoã€‚</p><h2>async å‡½æ•°æ˜¯ä»€ä¹ˆ</h2><p>é˜®ä¸€å³°çš„ Blog <a href="http://www.ruanyifeng.com/blog/2015/05/async.html" target="_blank" rel="noopener">async å‡½æ•°çš„å«ä¹‰å’Œç”¨æ³•</a>, å¯¹asyncçš„å®šä¹‰ä¸€è¯­ä¸­çš„ï¼š<strong>async å‡½æ•°å°±æ˜¯ Generator å‡½æ•°çš„è¯­æ³•ç³–ã€‚</strong></p><p>å‡å¦‚æœ‰ä¸€ä¸ªGeneratorå‡½æ•°ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">'use strict'</span>;</span><br><span class="line"><span class="keyword">const</span> f = <span class="function">(<span class="params">time</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve</span>) </span>&#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            resolve(time);</span><br><span class="line">        &#125;, time);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> gen = <span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> f1 = <span class="keyword">yield</span> f(<span class="number">1000</span>);</span><br><span class="line">    <span class="keyword">const</span> f2 = <span class="keyword">yield</span> f(<span class="number">2000</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>è°ƒç”¨æ–¹æ³•:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> generator = gen();</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> ret = generator.next();</span><br><span class="line">ret.value.then(<span class="function">(<span class="params">data</span>)=&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data);</span><br><span class="line">    <span class="keyword">let</span> ret1 = generator.next(data);</span><br><span class="line">    ret1.value.then(<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">        generator.next(data);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>å°† gen å‡½æ•°å†™æˆ async å‡½æ•°ï¼Œå°±æ˜¯ä¸‹é¢è¿™æ ·:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> asyncF = <span class="keyword">async</span>(<span class="function"><span class="params">()</span>=&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> f1 = <span class="keyword">await</span>(f(<span class="number">1000</span>));</span><br><span class="line">    <span class="keyword">let</span> f2 = <span class="keyword">await</span>(f(<span class="number">2000</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¸€æ¯”è¾ƒå°±ä¼šå‘ç°ï¼Œasync å‡½æ•°å°±æ˜¯å°† Generator å‡½æ•°çš„æ˜Ÿå·ï¼ˆ*ï¼‰æ›¿æ¢æˆ asyncï¼Œå°† yield æ›¿æ¢æˆ awaitï¼Œä»…æ­¤è€Œå·²ã€‚</p><h3>è¯´æ˜</h3><p>ç”±äºç›®å‰çš„å¤§éƒ¨åˆ†æµè§ˆå™¨å’Œ NodeJS ç¯å¢ƒè¿˜ä¸æ”¯æŒ async/awaitï¼Œæ‰€ä»¥æœ¬æ–‡ç¨‹åºå€ŸåŠ© â€œasyncawaitâ€ å®ç°ï¼Œéœ€è¦é¢å¤–å®‰è£…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npm install asyncawait</span></span><br></pre></td></tr></table></figure><p>å½“ç„¶å¦‚æœä½ å¯¹ babel æ¯”è¾ƒç†Ÿæ‚‰çš„è¯ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ babel å°† async/await ç¼–è¯‘ä¸º ES5ï¼Œå°±å¯ç›´æ¥è¿è¡Œäº†ã€‚</p><h2>async/await ä½¿ç”¨è§„åˆ™</h2><ul><li>async è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªasyncå‡½æ•°ï¼Œawaitåªèƒ½ç”¨åœ¨è¿™ä¸ªå‡½æ•°é‡Œé¢ã€‚</li><li>await å¦‚æœåé¢æ˜¯å¼‚æ­¥å‡½æ•°ï¼Œè·Ÿåœ¨åé¢çš„åº”è¯¥æ˜¯ä¸€ä¸ªPromiseå¯¹è±¡ã€‚</li><li>await è¡¨ç¤ºåœ¨è¿™é‡Œç­‰å¾…Promiseè¿”å›ç»“æœäº†ï¼Œå†ç»§ç»­æ‰§è¡Œã€‚</li></ul><h2>è·å¾—è¿”å›å€¼</h2><p>å¯ä»¥çœ‹åˆ°ä½¿ç”¨ Generator çš„æ—¶å€™è·å–è¿”å›å€¼å¿…é¡»ä½¿ç”¨ .then() æ–¹æ³•ï¼Œè€Œä½¿ç”¨ async/await å°±ç®€å•å¾ˆå¤šï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">'use strict'</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="keyword">async</span> = <span class="built_in">require</span>(<span class="string">'asyncawait/async'</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="keyword">await</span> = <span class="built_in">require</span>(<span class="string">'asyncawait/await'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> f = <span class="function">(<span class="params">time</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve</span>) </span>&#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            resolve(time);</span><br><span class="line">        &#125;, time);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span>(<span class="function"><span class="params">()</span>=&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> f1 = <span class="keyword">await</span>(f(<span class="number">1000</span>));</span><br><span class="line">    <span class="built_in">console</span>.log(f1);</span><br><span class="line">    <span class="keyword">let</span> f2 = <span class="keyword">await</span>(f(<span class="number">2000</span>));</span><br><span class="line">    <span class="built_in">console</span>.log(f2);</span><br><span class="line">&#125;))();</span><br></pre></td></tr></table></figure><p>await ç­‰å¾…çš„è™½ç„¶æ˜¯ promise å¯¹è±¡ï¼Œä½†ä¸å¿…å†™ä½¿ç”¨ .then()ï¼Œä¹Ÿå¯ä»¥å¾—åˆ°è¿”å›å€¼ã€‚</p><h2>æ•æ‰å¼‚å¸¸</h2><p>æ—¢ç„¶ .then() ä¸ç”¨å†™äº†ï¼Œé‚£ .catch()ä¹Ÿä¸ç”¨å†™ï¼Œå¯ä»¥ç›´æ¥ç”¨æ ‡å‡†çš„try<br>catchè¯­æ³•æ•æ‰é”™è¯¯</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> f = <span class="function">(<span class="params">time</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'error'</span>));</span><br><span class="line">        &#125;, time);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span>(<span class="function"><span class="params">()</span>=&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">await</span>(f(<span class="number">3000</span>));</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(err.message); <span class="comment">// è¿™é‡Œæ•æ‰åˆ°é”™è¯¯ `error`</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;))();</span><br></pre></td></tr></table></figure><p>await å‘½ä»¤åé¢çš„ Promise å¯¹è±¡ï¼Œè¿è¡Œç»“æœå¯èƒ½æ˜¯ rejectedï¼Œæ‰€ä»¥æœ€å¥½æŠŠ await å‘½ä»¤æ”¾åœ¨ tryâ€¦catch ä»£ç å—ä¸­</p><h2>å¾ªç¯ä½¿ç”¨ await</h2><p>await æœ€å¥½ç”¨çš„åœ°æ–¹æ˜¯å¯ä»¥å†™åœ¨ for å¾ªç¯é‡Œé¢ï¼Œè¿™æ˜¯Promiseæ— æ³•åšåˆ°çš„ï¼Œä½¿å¾— async/await çœ‹èµ·æ¥æ›´åƒæ˜¯åŒæ­¥ä»£ç </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> f = <span class="function">(<span class="params">time</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve</span>) </span>&#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            resolve(time);</span><br><span class="line">        &#125;, time);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br><span class="line">(<span class="keyword">async</span>(<span class="function"><span class="params">()</span>=&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt;= <span class="number">10</span>; i++) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`å½“å‰æ˜¯ç¬¬<span class="subst">$&#123;i&#125;</span>æ¬¡ç­‰å¾…..`</span>);</span><br><span class="line">        <span class="keyword">await</span>(f(<span class="number">1000</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;))();</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h1&gt;ç®€ä»‹&lt;/h1&gt;
&lt;p&gt;å¼‚æ­¥æ“ä½œä¸€ç›´éƒ½æ˜¯ JavaScript ä¸­ä¸€ä¸ªæ¯”è¾ƒéº»çƒ¦çš„äº‹æƒ…ï¼Œä»æœ€æ—©çš„ callback hellï¼Œåˆ°TJå¤§ç¥çš„ coï¼Œå†åˆ° Promise å¯¹è±¡ï¼Œç„¶åES6ä¸­çš„ Generator å‡½æ•°ï¼Œæ¯æ¬¡éƒ½æœ‰æ‰€æ”¹è¿›ï¼Œä½†éƒ½ä¸æ˜¯é‚£ä¹ˆå½»åº•ï¼Œè€Œä¸”ç†è§£èµ·æ¥æ€»æ˜¯å¾ˆå¤æ‚ã€‚&lt;/p&gt;
&lt;p&gt;ç›´åˆ° async/await å‡ºç°ï¼Œè®©å†™å¼‚æ­¥çš„äººæ ¹æœ¬ä¸ç”¨å…³å¿ƒå®ƒæ˜¯ä¸æ˜¯å¼‚æ­¥ï¼Œå¯ä»¥è¯´æ˜¯ç›®å‰æœ€å¥½çš„ JavaScript å¼‚æ­¥è§£å†³æ–¹æ¡ˆã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="https://lz5z.com/categories/JavaScript/"/>
    
    
      <category term="Node" scheme="https://lz5z.com/tags/Node/"/>
    
      <category term="ES7" scheme="https://lz5z.com/tags/ES7/"/>
    
      <category term="async" scheme="https://lz5z.com/tags/async/"/>
    
  </entry>
  
</feed>
